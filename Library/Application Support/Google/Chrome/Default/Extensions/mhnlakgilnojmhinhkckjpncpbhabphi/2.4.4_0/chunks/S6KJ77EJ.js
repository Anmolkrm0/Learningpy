import{a as E}from"./CML227OB.js";import{h as _}from"./AAMCXCLO.js";var k=(o,c=!1)=>o?(o.search(/^http[s]?:\/\//)==-1&&(o="https://"+o),c&&(o=o.replace(/\.(json)+$/i,"")),o):"";var S=o=>new RegExp(/^(((ht|f)tps?):\/\/)?([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/).test(o),R=o=>{if(!o)return"";try{let c=/^(?:https?:\/\/)?(?:www\.)?((?:(?!www\.|\.).)+\.[-a-zA-Z0-9.]+)/gm,e=o.match(c);return(e?e[0]:"").toLowerCase()}catch{return o}},b=(o,c=16)=>{let e=R(o)||`${o?.toLowerCase()}.com`;return`https://www.google.com/s2/favicons?sz=${c}&domain_url=${e}`};var U=o=>{try{let e=new URL(o).pathname.split(".").pop()||"";return!!["doc","xls","ppt","pdf","zip","rar","apk"].includes(e)}catch{return!1}};function $({html:o,searchEngine:c}){try{return L(o,c).filter(f=>U(f.url)?!1:f.url&&(f.body||f.title))}catch{return[]}}function m(o){let c=o.match(/RU=([^/]+)/);return c&&c[1]?decodeURIComponent(c[1]):o}var L=(o,c)=>{try{let e=E.load(o),l=[];switch(c){case"google":{let f=e("#search #rso > div");f.length===1?(e("#rso #kp-wp-tab-overview:not([style])").length>0&&e('#rso #kp-wp-tab-overview:not([style]) div[class*="K7khPe"]').each((t,n)=>{let r=e(n),i=r.find("a > h3"),a=i.closest("a"),d=r.find("div.MUxGbd").text();if(!d){let v=r.find("div[style]").filter((w,C)=>!!e(C)?.attr("style")?.includes("-webkit-line-clamp"));d=e(v[0]).text().trim()}let u=i.next(),h=m(a.attr("href")??""),p=u?.children()?.last()?.children()?.first()?.text(),x=i.text();x&&l.push({title:x,body:d||x,url:h,from:p,favicon:u?.find("img")?.attr("src")})}),e("#search #rso > div a[data-ved]").filter((t,n)=>!!e(n).find("div[role=heading]").text()).each((t,n)=>{let r=e(n),i=r.find("div[role=heading]"),a=i.text(),d=i.next().text(),u=i.prev(),h=m(r.attr("href")??"");l.push({title:a,body:d||a,url:h,from:u.text(),favicon:u.find("img")?.attr("src")})})):f.filter((s,t)=>!!e(t).find("a > h3").text()).each((s,t)=>{let n=e(t),r=n.find("a > h3"),i=r.closest("a"),a=n.find("div.MUxGbd").text();if(a||(a=i?.parent()?.parent()?.parent().next().text().trim()),a||(a=i?.parent()?.parent()?.parent().next().next().text().trim()),!a){let x=n.find("div[style]").filter((v,w)=>!!e(w)?.attr("style")?.includes("-webkit-line-clamp"));a=e(x[0]).text().trim()}let d=r.text(),u=r.next(),h=m(i.attr("href")??""),p=u?.children()?.last()?.children()?.first()?.text();l.push({title:d,body:a||d,url:h,from:p,favicon:u?.find("img")?.attr("src")})});break}case"bing":{e("ol#b_results li.b_algo").each((f,s)=>{let t=e(s),n=t.find("h2 > a"),r=t.find(".b_algoSlug").text();r||(r=t.find(".b_wikiRichcard .tab-content").text().trim()),l.push({title:n.text()??"",body:r??"",url:m(n.attr("href")??""),from:t.find("a .tptt").text(),favicon:t.find("img.rms_img").attr("src")})});break}case"baidu":{e("div#content_left div[class^=result]").each((f,s)=>{let t=e(s),n=t.find("h3"),r=n.find("a"),i=t.find("div[class*=description_]").text();i||(i=t.find(".op_dict_content").text()),i||(i=t.find("div[class*=basis-info_]").text()),i||(i=t.find(".c-color-text").text()),i||(i=n.next().next().text());let a=t.find("a[class^=siteLink]");l.push({title:n.text(),body:i??"",url:m(r.attr("href")??""),from:a.text(),favicon:a.find("img")?.attr("src")})});break}case"duckduckgo":{e("ol.react-results--main li[data-layout=organic]").each((f,s)=>{let t=e(s),n=t.find("h2 > a"),r=t.find("a[data-testid=result-extras-url-link]"),i=r.parent(),a=m(n.attr("href")??"");l.push({title:n.text(),body:t.find("div[data-result=snippet]").text(),url:a,from:g(a)||r.children().first().text(),favicon:i.find("a > img")?.attr("src")})});break}case"yahoo":{e('.algo:not([class*="ad"])').each((f,s)=>{let t=e(s),n=t.find("h3.title a"),r=m(n.attr("href")??""),i=n.find("span").text().split(" \u203A ");l.push({title:n.attr("aria-label")??"",body:t.find(".compText").text(),url:r,from:g(r)||i[0]})});break}case"naver":{e("ul.lst_total > li.bx").each((f,s)=>{let t=e(s),n=t.find("a.link_tit");(!n||n.length<=0)&&(n=t.find("a.total_tit"));let r=m(n.attr("href")??""),i=t.find("a.thumb img").attr("src");l.push({title:n.text(),body:t.find(".dsc_txt").text(),url:r,from:g(r),favicon:i})});break}case"yandex":{e(".content__left ul.serp-list > li.serp-item").each((f,s)=>{let t=e(s),n=t.find("a.organic__url"),r=m(n.attr("href")??""),a=t.find(".Favicon-Icon").css("background-image")?.slice(5).slice(0,-2);l.push({title:n.text(),body:t.find(".organic__content-wrapper").text(),url:r,favicon:a,from:g(r)})});break}case"sogou":{e(".results div.vrwrap").each((f,s)=>{let t=e(s),n=t.find("h3.vr-title a"),r=t.find(".text-layout").text();r||(r=t.find(".word-result").text()),r||(r=t.find(".space-txt").text());let i=m(n.attr("href")??"");i=i.startsWith("/")?location.origin+i:i;let d=t.find(".citeurl").text().replace(/\n\s*/g,"").split("-").find(h=>{try{let p=h.trim().replace("...","");return p.includes("/")&&(p=p.split("/")[0]),S(p)}catch{return!1}}),u=g(d||"");l.push({title:n.text(),body:r,url:i,from:u,favicon:b(u)})});break}case"brave":{e("#results > .snippet[data-type=web]").each((f,s)=>{let t=e(s),n=t.find(".snippet-title"),r=n.text(),i=n.closest("a"),a=t.find("img.favicon").attr("src");r||(n=t.find("a > div.url"),r=n.text(),i=n.closest("a"));let d=t.find(".snippet-content").text();d||(d=t.find(".snippet-description").text());let h=t.find(".snippet-url").children().first().text();t.attr("id")==="discussions"&&(r=t.find(".question > p.title").text(),d=t.find(".faq-a").text(),i=t.find("a.source").first(),h=t.find("img.forum-name").text());let p=m(i.attr("href")??"");l.push({title:r,body:d,url:p,favicon:a,from:h})});break}default:return[]}return l=l.map(f=>{let s={...f};return s.from||(s.from=g(s.url)),s.from&&(s.from=s.from.replace(/\.[^.]*$/,"")),!s.favicon&&s.url&&(s.favicon=b(s.url)),s.from=y(s.from),s.body=y(s.body),s.title=y(s.title),s}),l}catch{return[]}};function y(o){return o.trim().replace(/\n/g,"")||""}function g(o){try{let c=k(o.trim().replace(/.../g,"")),l=new URL(c).host.split(".");return l.length>=3?l[1]:l[0]}catch{return o}}var W=async o=>{let e=await new _({runtime:"shortcut"}).postMessage({event:"ShortCuts_getContentOfSearchEngine",data:{URL:o}}),{status:l,html:f}=e.data||{};return{status:l,html:f}};export{$ as a,W as b};
