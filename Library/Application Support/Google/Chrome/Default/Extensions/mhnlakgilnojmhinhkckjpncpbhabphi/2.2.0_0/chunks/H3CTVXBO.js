import{a as kt}from"./EFAAWHBD.js";import{a as Rt}from"./QZ23CPMF.js";import{a as Ft}from"./PRTVLPOH.js";import{a as Ia}from"./BP4AX5SK.js";import{a as Ot,b as Ve,c as Dt,d as Vt,e as Gt,h as Ut}from"./HZY6G6NS.js";import"./NUBBX6Y3.js";import"./XGYN32GS.js";import{c as Lt,f as Nt,i as Bt,l as Ht}from"./Z3L7RW5H.js";import{g as re}from"./5QUJ6DKB.js";import"./FHOPNJBR.js";import"./4H6XCDWT.js";import{f as X}from"./ZLWHHAAC.js";import"./KV6T5ANA.js";import"./4M75FOZX.js";import"./WJHHHIFF.js";import{b as Tt,d as At,h as It,i as Mt,j as _e,k as wt}from"./COTWV3FC.js";import{a as Et}from"./MJNORM6I.js";import"./HSAMI7BK.js";import"./CGGBDVKK.js";import"./NFYTNHAT.js";import"./HXPONVFL.js";import"./CUWLSLUX.js";import"./CZZ5V5WB.js";import{a as Pt}from"./VEFNH7NE.js";import{a as Aa}from"./TDJEIFOF.js";import{a as de}from"./UWBZO3WW.js";import"./4NAB6M5G.js";import"./Y2WDTCYS.js";import{a as Ea}from"./AVRUINLW.js";import{$a as He,Ab as xt,W as ft,Y as bt,_ as _t,b as it,c as Q,d as ct,da as ht,q as be,s as M,ta as vt,u as mt,ua as Ct,v as Ta,w as dt}from"./QXSPNHGD.js";import{h as Se}from"./3NC6GYYS.js";import"./5O7EG2CD.js";import{c as fe}from"./SBPSCB6O.js";import{w as pt}from"./4565WM6X.js";import"./RBZSLUSE.js";import"./BJ4XCQYH.js";import"./RPTTQXMU.js";import"./ZDOLJC6M.js";import"./L33QHTPD.js";import"./EYWU5WEI.js";import{i as oe,j as ge}from"./773OEKYN.js";import{f as lt,h as st}from"./LLMPFG5R.js";import{c as ae}from"./ZSF23SB7.js";import{d as De,g as ut}from"./SH2AV755.js";import"./SMO67HIN.js";import{a as L}from"./PGNR3OFA.js";import"./5EASWQBS.js";import{d as R}from"./BEC6NYYF.js";import{a as x,b as Be,u as W}from"./JUQUTDV2.js";import"./H3PWEBSP.js";import"./QZNWBGPK.js";import{j as Oe}from"./QZVUH6Z4.js";import"./6NCLE6FY.js";import{c as gt,ea as yt,q as St}from"./XNIWJ77D.js";import"./6LS5XNTR.js";import"./7ADITARJ.js";import"./WWJM5EAZ.js";import"./GDFPIX4S.js";import"./SJ3MEPLB.js";import"./3X42KLOD.js";import{E as ot,K as Ne,L as rt,M as nt,a as le,c as xa,k as se,s as at}from"./MT7GI5KY.js";import{c as F}from"./QPPETRF6.js";import{c as Le,f as te,s as tt}from"./BIAAAE54.js";import{M as Z,N as et}from"./T463YMPS.js";import{D as Je,F as $e,P as Ze,U as me,e as j,f as Ke,g as je,i as Ye,j as Qe,k as Xe,p as pe}from"./LZHALC2F.js";import{a as O}from"./64D36THL.js";import{a as ya}from"./3JX3VARJ.js";import{c as ke,f as C}from"./PQ35KENF.js";var zt=ke(he=>{"use strict";var Ma=Be();Object.defineProperty(he,"__esModule",{value:!0});he.default=void 0;var Pa=Ma(De()),wa=Oe(),ka=(0,Pa.default)((0,wa.jsx)("path",{d:"m19 8-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"}),"Cached");he.default=ka});var Qt=ke(ve=>{"use strict";var Da=Be();Object.defineProperty(ve,"__esModule",{value:!0});ve.default=void 0;var Ha=Da(De()),Va=Oe(),Ga=(0,Ha.default)((0,Va.jsx)("path",{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"}),"UnfoldLess");ve.default=Ga});var Xt=ke(Ce=>{"use strict";var Ra=Be();Object.defineProperty(Ce,"__esModule",{value:!0});Ce.default=void 0;var Ua=Ra(De()),Fa=Oe(),za=(0,Ua.default)((0,Fa.jsx)("path",{d:"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z"}),"UnfoldMore");Ce.default=za});var ne=C(O());var s=C(O());var da=C(zt());var ga=C(Ia());var P=C(O());var Wt=C(At());var Oa=t=>{let{onSendMessage:e}=t,{t:a}=F(["common","client"]),{currentMaxInputLength:r,isError:i}=It("chatBoxInputMediator"),[n,c]=(0,P.useState)(""),u=j(Q),o=P.default.useRef(null),m=(0,P.useRef)(!1),T=(0,P.useRef)({});return(0,P.useEffect)(()=>{let g=(f,b)=>{b&&(T.current=b),f.startsWith("``NO_HISTORY_&#``\n")&&(f=f.replace("``NO_HISTORY_&#``\n",""),m.current=!0),c(f)};return He("chatBoxInputMediator").subscribe(g),()=>{He("chatBoxInputMediator").unsubscribe(g)}},[]),(0,P.useEffect)(()=>{m.current=!1,T.current={}},[u.loading]),P.default.createElement(x,{ref:o,p:1,pt:0,direction:"row",alignItems:"center",spacing:1,width:"100%"},P.default.createElement(W,{component:"span",color:i?"rgb(239, 83, 80)":"text.secondary",fontSize:12,fontFamily:"Roboto,RobotoDraft,Helvetica,Arial,sans-serif!important"},u.loading?0:Le(n.length,0),"/",Le(r,0)),P.default.createElement(L,{component:"div",display:"flex",width:0,flex:1,alignItems:"center",justifyContent:"end",gap:1},!Qe&&!u.loading&&P.default.createElement(kt,{onBeforeShowContextMenu:()=>({template:n||" ",target:te()?.querySelector(`#${pe}`)?.parentElement||o.current})}),P.default.createElement(ge,{title:a("client:sidebar__button__send_to_ai"),TooltipProps:{description:"\u23CE"},sx:{minWidth:"unset",p:1},disableElevation:!0,variant:"contained",disabled:u.loading,onClick:()=>{e&&e(n,{includeHistory:!m.current,meta:T.current}),T.current={},m.current=!1}},u.loading?P.default.createElement(fe,{size:16}):P.default.createElement(Wt.default,{sx:{fontSize:"16px"}}))))},qt=Oa;var N=C(O()),La=(t,e,a)=>{let r=(0,N.useRef)(null),i=(0,N.useRef)(null),[n,c]=(0,N.useState)(1),[u]=(0,N.useState)(a?.buffer||10),o=a?.buffer||0,m=(0,N.useCallback)(()=>{if(r.current&&r.current.disconnect(),t.current){let b=t.current,I=null,S=()=>{I&&window.clearTimeout(I);let h=b.children[o];if(h){let G=U=>{U[0].isIntersecting&&g()};r.current=new IntersectionObserver(G),i.current=h,r.current.observe(h)}else I=window.setTimeout(()=>{S()},1e3)};S()}},[o]),T=(0,N.useCallback)(()=>{let b=t.current;if(r.current&&b){i.current&&r.current.unobserve(i.current);let I=b.children[o];I&&r.current.observe(I)}},[t,o]),g=(0,N.useCallback)(()=>{c(b=>++b)},[]),f=(0,N.useMemo)(()=>u===-1?e:e.slice(-(n*u)),[e,n,u]);return(0,N.useEffect)(()=>{T()},[f]),(0,N.useEffect)(()=>(e.length>u&&t.current&&m(),()=>{r.current&&r.current.disconnect()}),[m,e,u,t]),{slicedMessageList:f,loadMore:g,changePageNumber:(0,N.useCallback)(b=>c(b),[])}},Kt=La;var v=C(O());var Na=t=>{let{onClick:e,disabledMainButton:a}=t,{currentSidebarConversationType:r}=M(),{t:i}=F(["common","client"]),[n,c]=(0,v.useState)(!1),u=()=>{c(!1),setTimeout(()=>{e&&e("focus")},100)};return v.default.createElement(L,{sx:{position:"absolute",left:0,bottom:0,width:40,height:40}},v.default.createElement(Ot,{ariaLabel:"SpeedDial controlled open",sx:{position:"absolute",left:0,bottom:"0","& > button":{width:40,height:40}},FabProps:{sx:{"& + div":{marginBottom:"-40px!important",paddingBottom:"48px!important"}}},icon:v.default.createElement(L,{component:"div",onClick:()=>{if(a){e&&e("focus");return}e&&e("new")}},v.default.createElement(oe,{placement:"left",title:i(r==="Summary"?"client:sidebar__tabs__summary__action_btn__title":"client:sidebar__tabs__chat__action_btn__title")},v.default.createElement(x,{p:1,alignItems:"center",justifyContent:"center",component:"div"},v.default.createElement(lt,{sx:{color:"#fff",fontSize:"24px"}}))))},v.default.createElement(Ve,{icon:v.default.createElement(ae,{href:$e+"/prompts",target:"_blank",color:"text.secondary"},v.default.createElement(L,{component:"div",onClick:o=>{o.stopPropagation()}},v.default.createElement(oe,{placement:"left",title:i("client:sidebar__speed_dial__one_click_prompts__button")},v.default.createElement(x,{p:1,alignItems:"center",justifyContent:"center",component:"div"},v.default.createElement(st,{sx:{fontSize:"24px",color:"primary.main"}}))))),tooltipTitle:""}),v.default.createElement(Ve,{icon:v.default.createElement(L,{component:"div",onClick:()=>{c(!0)}},v.default.createElement(oe,{placement:"left",title:i("client:sidebar__speed_dial__restart_extension__button")},v.default.createElement(x,{p:1,alignItems:"center",justifyContent:"center",component:"div"},v.default.createElement(Se,{icon:"Restart",sx:{fontSize:"24px"}})))),tooltipTitle:""})),v.default.createElement(Lt,{open:n,onClose:()=>{u()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},v.default.createElement(Nt,{id:"alert-dialog-title"},i("client:sidebar__speed_dial__restart_extension__tooltip__title")),v.default.createElement(Bt,null,v.default.createElement(Dt,{id:"alert-dialog-description"},i("client:sidebar__speed_dial__restart_extension__tooltip__description1"),v.default.createElement("br",null),i("client:sidebar__speed_dial__restart_extension__tooltip__description2"))),v.default.createElement(Ht,null,v.default.createElement(R,{sx:{},variant:"outlined",onClick:()=>{u()}},i("common:cancel")),v.default.createElement(R,{color:"primary",variant:"contained",onClick:()=>{e&&e("restart"),u()},autoFocus:!0},i("client:sidebar__speed_dial__restart_extension__tooltip__confirm")))))},jt=Na;var H=C(O());var Ba=t=>{let{sx:e}=t,{currentSidebarConversationType:a}=M(),r=j(me),[i,n]=H.default.useState(null),c=(0,H.useRef)(null),u=(0,H.useRef)(!1),o=(0,H.useRef)(!1),m=f=>{o.current||n(f.currentTarget)},T=()=>{n(null)},g=!!i;return(0,H.useMemo)(()=>a!=="Chat"?null:H.default.createElement(L,{id:"max-ai__ai-provider-floating-button",sx:{width:"44px",height:"44px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",border:"1px solid #EBEBEB",cursor:"pointer",borderColor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"#EBEBEB",bgcolor:f=>f.palette.mode==="dark"?"#333":"#fff",boxShadow:"0px 0px 0.5px 0px rgba(0, 0, 0, 0.40), 0px 1px 3px 0px rgba(0, 0, 0, 0.09), 0px 4px 8px 0px rgba(0, 0, 0, 0.09);",...e},"aria-owns":g?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:f=>{c.current&&clearTimeout(c.current),u.current=!0,c.current=setTimeout(()=>{u.current=!1},700),m(f)},onMouseLeave:()=>{T(),o.current=!1}},H.default.createElement(ct,{aiProviderType:r.sidebarSettings?.common?.currentAIProvider||"USE_CHAT_GPT_PLUS"}),H.default.createElement(pt,{open:g,anchorEl:i,id:"mouse-over-popover",anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},disableScrollLock:!0,PaperProps:{sx:{ml:de()?0:"8px"}}},H.default.createElement(dt.default,{onClickAway:f=>{let b=te()?.querySelector("#MaxAIProviderSelectorCard");if(b){let I=b.getBoundingClientRect(),S=f.clientX,h=f.clientY;if(S>I.left&&S<I.right&&h>I.top&&h<I.bottom)return;T()}}},H.default.createElement(L,{onMouseEnter:m,onMouseLeave:T},H.default.createElement(vt,{closeAble:!0,onClose:()=>{u.current||(o.current=!0,T())}}))))),[r.sidebarSettings?.common?.currentAIProvider,g,a])},Yt=Ba;var V=C(O());var E=C(O());var Jt=C(Qt()),$t=C(Xt());var Wa=()=>{let{currentSidebarAIProvider:t,currentSidebarConversationId:e,currentSidebarConversationType:a,currentSidebarConversation:r,sidebarSettings:i}=M(),n=j(me),c=j(Q),[u]=Ke(it),[o,m]=(0,E.useState)(!0),T=(0,E.useMemo)(()=>{let g=Z(r);return g&&(g.messages=[]),g},[r]);return E.default.createElement(x,{sx:{position:"absolute",top:"0",maxWidth:o?"400px":"32px",maxHeight:o?"unset":"32px",overflowX:"auto",zIndex:1,bgcolor:"background.paper",color:"text.primary",right:"100%",border:"1px solid",borderColor:"customColor.borderColor",borderRadius:"4px","& > pre, & > p":{p:0,m:0,fontSize:"12px"}}},o?E.default.createElement(R,{variant:"contained",sx:{width:32,height:32,minWidth:"unset",position:"absolute",top:0,right:0,p:1},onClick:()=>m(!1)},E.default.createElement(Jt.default,null)):E.default.createElement(R,{variant:"contained",sx:{width:32,height:32,minWidth:"unset",position:"absolute",top:0,right:0,p:1},onClick:()=>m(!0)},E.default.createElement($t.default,null)),E.default.createElement(x,{direction:"row",spacing:1},E.default.createElement(R,{onClick:async g=>{await nt()}},"Reset OnBoarding")),E.default.createElement("p",null,"authStatus: ",u.status),E.default.createElement("p",null,"loading: ",c.loading?"loading":"done"),E.default.createElement("p",null,"currentSidebarConversationType: ",a),E.default.createElement("p",null,"currentSidebarAIProvider: ",t),E.default.createElement("p",null,"currentSidebarConversationId: ",e),E.default.createElement("pre",null,JSON.stringify(T,null,2)),E.default.createElement("pre",null,JSON.stringify(i,null,2)),E.default.createElement("pre",null,JSON.stringify(n.thirdProviderSettings,null,2)))},Zt=Wa;var qa=[{label:"client:sidebar__tabs__chat__title",tooltip:()=>"client:sidebar__tabs__chat__tooltip",value:"Chat"},{label:"client:sidebar__tabs__summary__title",tooltip:()=>{switch(ft()){case"DEFAULT_EMAIL_SUMMARY":return"client:sidebar__tabs__summary__tooltip__default_email";case"PAGE_SUMMARY":return"client:sidebar__tabs__summary__tooltip__page";case"PDF_CRX_SUMMARY":return"client:sidebar__tabs__summary__tooltip__pdf_crx";case"YOUTUBE_VIDEO_SUMMARY":return"client:sidebar__tabs__summary__tooltip__youtube_video";default:return"client:sidebar__tabs__summary__tooltip__page"}},value:"Summary"},{label:"client:sidebar__tabs__search__title",tooltip:()=>"client:sidebar__tabs__search__tooltip",value:"Search"}],Ka=()=>{let{t}=F(["common","client"]),{currentSidebarConversationType:e,updateSidebarConversationType:a}=M(),r=j(Q);(0,V.useEffect)(()=>{let n=c=>{let u=c?.detail?.type;u&&a(u)};return window.addEventListener("MaxAISwitchSidebarTab",n),()=>{window.removeEventListener("MaxAISwitchSidebarTab",n)}});let i=(0,V.useMemo)(()=>qa.filter(n=>!(n.value==="Summary"&&de())),[]);return V.default.createElement(V.default.Fragment,null,V.default.createElement(x,{direction:"row",height:36,alignItems:"center",width:"100%",borderBottom:"1px solid",borderColor:"customColor.borderColor",bgcolor:"background.paper",sx:{position:"sticky",top:0,zIndex:1}},V.default.createElement(Vt,{sx:{minHeight:"36px","& .use-chat-gpt-ai--MuiButtonBase-root":{height:"36px",minHeight:"36px",p:1}},value:e,onChange:async(n,c)=>{a(c)},textColor:"inherit",indicatorColor:"primary"},i.map(n=>V.default.createElement(Gt,{disabled:r.loading,key:n.value,value:n.value,label:V.default.createElement(oe,{title:t(n.tooltip?.())},V.default.createElement(W,{fontSize:"14px",color:"text.primary","data-testid":"max-ai__summary-tab"},t(n.label)))})))),V.default.createElement(Rt,null,V.default.createElement(Zt,null)))},ea=Ka;var _=C(O());var ia=C(Aa());var la=C(At());var Ae=C(O());var ye=C(O()),Ge=[{label:"Default",value:""},{value:"Academic",label:"Academic"},{value:"Analytical",label:"Analytical"},{value:"Argumentative",label:"Argumentative"},{value:"Conversational",label:"Conversational"},{value:"Creative",label:"Creative"},{value:"Critical",label:"Critical"},{value:"Descriptive",label:"Descriptive"},{value:"Epigrammatic",label:"Epigrammatic"},{value:"Epistolary",label:"Epistolary"},{value:"Expository",label:"Expository"},{value:"Informative",label:"Informative"},{value:"Instructive",label:"Instructive"},{value:"Journalistic",label:"Journalistic"},{value:"Metaphorical",label:"Metaphorical"},{value:"Narrative",label:"Narrative"},{value:"Persuasive",label:"Persuasive"},{value:"Poetic",label:"Poetic"},{value:"Satirical",label:"Satirical"},{value:"Technical",label:"Technical"}];function ja(t,{inputValue:e}){return t.filter(a=>{let r=a.label.toLowerCase(),i=a.value.toLowerCase(),n=e.toLowerCase();return r.includes(n)||i.includes(n)})}var ta=t=>{let{label:e="Writing style",defaultValue:a="",onChange:r=o=>{},placeholder:i,sx:n}=t,[c,u]=ye.default.useState(()=>Ge.find(o=>o.value===a)||Ge[0]);return ye.default.createElement(re,{componentsProps:{popper:{style:{width:160}}},placeholder:i,disableClearable:!0,value:c,size:"small",sx:{width:160,...n},autoHighlight:!0,getOptionLabel:o=>o.label,options:Ge,onChange:(o,m)=>{u(m),r(m.value)},filterOptions:ja,renderInput:o=>ye.default.createElement(X,{...o,label:e,InputLabelProps:{sx:{fontSize:"16px"},...o.InputLabelProps},inputProps:{sx:{fontSize:"16px"},...o.inputProps,autoComplete:"new-password"}})})};var xe=C(O()),Re=[{language_code:"uk",value:"Ukrainian",label:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},{language_code:"so",value:"Somali",label:"Af Soomaali"},{language_code:"af",value:"Afrikaans",label:"Afrikaans"},{language_code:"az",value:"Azerbaijani",label:"Az\u0259rbaycan dili"},{language_code:"id",value:"Indonesian",label:"Bahasa Indonesia"},{language_code:"ms-MY",value:"Malaysian Malay",label:"Bahasa Malaysia"},{language_code:"ms",value:"Malay",label:"Bahasa Melayu"},{language_code:"jv",value:"Javanese",label:"Basa Jawa"},{language_code:"su",value:"Sundanese",label:"Basa Sunda"},{language_code:"bs",value:"Bosnian",label:"Bosanski jezik"},{language_code:"ca",value:"Catalan",label:"Catal\xE0"},{language_code:"cs",value:"Czech",label:"\u010Ce\u0161tina"},{language_code:"ny",value:"Chichewa",label:"Chichewa"},{language_code:"cy",value:"Welsh",label:"Cymraeg"},{language_code:"da",value:"Danish",label:"Dansk"},{language_code:"de",value:"German",label:"Deutsch"},{language_code:"et",value:"Estonian",label:"Eesti keel"},{language_code:"en",value:"English",label:"English"},{language_code:"en-GB",value:"English (UK)",label:"English (UK)"},{language_code:"en-US",value:"English (US)",label:"English (US)"},{language_code:"es",value:"Spanish",label:"Espa\xF1ol"},{language_code:"eo",value:"Esperanto",label:"Esperanto"},{language_code:"eu",value:"Basque",label:"Euskara"},{language_code:"fr",value:"French",label:"Fran\xE7ais"},{language_code:"ga",value:"Irish",label:"Gaeilge"},{language_code:"gl",value:"Galician",label:"Galego"},{language_code:"hr",value:"Croatian",label:"Hrvatski jezik"},{language_code:"xh",value:"Xhosa",label:"isiXhosa"},{language_code:"zu",value:"Zulu",label:"isiZulu"},{language_code:"is",value:"Icelandic",label:"\xCDslenska"},{language_code:"it",value:"Italian",label:"Italiano"},{language_code:"sw",value:"Swahili",label:"Kiswahili"},{language_code:"ht",value:"Haitian Creole",label:"Krey\xF2l Ayisyen"},{language_code:"ku",value:"Kurdish",label:"Kurd\xEE"},{language_code:"la",value:"Latin",label:"Lat\u012Bna"},{language_code:"lv",value:"Latvian",label:"Latvie\u0161u valoda"},{language_code:"lb",value:"Luxembourgish",label:"L\xEBtzebuergesch"},{language_code:"lt",value:"Lithuanian",label:"Lietuvi\u0173 kalba"},{language_code:"hu",value:"Hungarian",label:"Magyar"},{language_code:"mg",value:"Malagasy",label:"Malagasy"},{language_code:"mt",value:"Maltese",label:"Malti"},{language_code:"mi",value:"Maori",label:"M\u0101ori"},{language_code:"nl",value:"Dutch",label:"Nederlands"},{language_code:"no",value:"Norwegian",label:"Norsk"},{language_code:"uz",value:"Uzbek",label:"O'zbek tili"},{language_code:"pl",value:"Polish",label:"Polski"},{language_code:"pt",value:"Portuguese",label:"Portugu\xEAs"},{language_code:"ro",value:"Romanian",label:"Rom\xE2n\u0103"},{language_code:"st",value:"Sesotho",label:"Sesotho"},{language_code:"sq",value:"Albanian",label:"Shqip"},{language_code:"sk",value:"Slovak",label:"Sloven\u010Dina"},{language_code:"sl",value:"Slovenian",label:"Sloven\u0161\u010Dina"},{language_code:"fi",value:"Finnish",label:"Suomi"},{language_code:"sv",value:"Swedish",label:"Svenska"},{language_code:"tl",value:"Tagalog",label:"Tagalog"},{language_code:"tt",value:"Tatar",label:"Tatar\xE7a"},{language_code:"tr",value:"Turkish",label:"T\xFCrk\xE7e"},{language_code:"vi",value:"Vietnamese",label:"Vi\u1EC7t ng\u1EEF"},{language_code:"yo",value:"Yoruba",label:"Yor\xF9b\xE1"},{language_code:"el",value:"Greek",label:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC"},{language_code:"be",value:"Belarusian",label:"\u0411\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F \u043C\u043E\u0432\u0430"},{language_code:"bg",value:"Bulgarian",label:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438 \u0435\u0437\u0438\u043A"},{language_code:"ky",value:"Kyrgyz",label:"\u041A\u044B\u0440"},{language_code:"kk",value:"Kazakh",label:"\u049A\u0430\u0437\u0430\u049B \u0442\u0456\u043B\u0456"},{language_code:"mk",value:"Macedonian",label:"\u041C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438 \u0458\u0430\u0437\u0438\u043A"},{language_code:"mn",value:"Mongolian",label:"\u041C\u043E\u043D\u0433\u043E\u043B \u0445\u044D\u043B"},{language_code:"ru",value:"Russian",label:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},{language_code:"sr",value:"Serbian",label:"\u0421\u0440\u043F\u0441\u043A\u0438 \u0458\u0435\u0437\u0438\u043A"},{language_code:"tg",value:"Tajik",label:"\u0422\u043E\u04B7\u0438\u043A\u04E3"},{language_code:"ka",value:"Georgian",label:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8"},{language_code:"hy",value:"Armenian",label:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576"},{language_code:"yi",value:"Yiddish",label:"\u05D9\u05D9\u05B4\u05D3\u05D9\u05E9"},{language_code:"he",value:"Hebrew",label:"\u05E2\u05D1\u05E8\u05D9\u05EA"},{language_code:"ug",value:"Uyghur",label:"\u0626\u06C7\u064A\u063A\u06C7\u0631\u0686\u06D5"},{language_code:"ur",value:"Urdu",label:"\u0627\u0631\u062F\u0648"},{language_code:"ar",value:"Arabic",label:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},{language_code:"ps",value:"Pashto",label:"\u067E\u069A\u062A\u0648"},{language_code:"fa",value:"Persian",label:"\u0641\u0627\u0631\u0633\u06CC"},{language_code:"ne",value:"Nepali",label:"\u0928\u0947\u092A\u093E\u0932\u0940"},{language_code:"mr",value:"Marathi",label:"\u092E\u0930\u093E\u0920\u0940"},{language_code:"hi",value:"Hindi",label:"\u0939\u093F\u0928\u094D\u0926\u0940"},{language_code:"bn",value:"Bengali",label:"\u09AC\u09BE\u0982\u09B2\u09BE"},{language_code:"pa",value:"Punjabi",label:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40"},{language_code:"gu",value:"Gujarati",label:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0"},{language_code:"or",value:"Oriya",label:"\u0B13\u0B21\u0B3C\u0B3F\u0B06"},{language_code:"ta",value:"Tamil",label:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD"},{language_code:"te",value:"Telugu",label:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},{language_code:"kn",value:"Kannada",label:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1"},{language_code:"ml",value:"Malayalam",label:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02"},{language_code:"si",value:"Sinhala",label:"\u0DC3\u0DD2\u0D82\u0DC4\u0DBD"},{language_code:"th",value:"Thai",label:"\u0E44\u0E17\u0E22"},{language_code:"lo",value:"Lao",label:"\u0E9E\u0EB2\u0EAA\u0EB2\u0EA5\u0EB2\u0EA7"},{language_code:"my",value:"Burmese",label:"\u1017\u1019\u102C\u1005\u102C"},{language_code:"km",value:"Khmer",label:"\u1797\u17B6\u179F\u17B6\u1781\u17D2\u1798\u17C2\u179A"},{language_code:"ko",value:"Korean",label:"\uD55C\uAD6D\uC5B4"},{language_code:"zh",value:"Chinese",label:"\u4E2D\u6587"},{language_code:"zh-TW",value:"Traditional Chinese",label:"\u7E41\u9AD4\u4E2D\u6587"},{language_code:"ja",value:"Japanese",label:"\u65E5\u672C\u8A9E"}];function Ya(t,{inputValue:e}){return t.filter(a=>{let r=a.label.toLowerCase(),i=a.value.toLowerCase(),n=e.toLowerCase();return r.includes(n)||i.includes(n)})}var aa=t=>{let{label:e="Output language",defaultValue:a="",onChange:r=o=>{},placeholder:i,sx:n}=t,[c,u]=xe.default.useState(()=>Re.find(o=>o.value===a)||Re[0]);return xe.default.createElement(re,{componentsProps:{popper:{style:{width:160}}},placeholder:i,disableClearable:!0,value:c,size:"small",sx:{width:160,...n},autoHighlight:!0,getOptionLabel:o=>o.label,options:Re,onChange:(o,m)=>{u(m),r(m.value)},filterOptions:Ya,renderInput:o=>xe.default.createElement(X,{...o,label:e,InputLabelProps:{sx:{fontSize:"16px"},...o.InputLabelProps},inputProps:{sx:{fontSize:"16px"},...o.inputProps}})})};var Te=C(O());var Ue=[{label:"Default",value:""},{label:"Authoritative",value:"Authoritative"},{label:"Casual",value:"Casual"},{label:"Clinical",value:"Clinical"},{label:"Cold",value:"Cold"},{label:"Confident",value:"Confident"},{label:"Cynical",value:"Cynical"},{label:"Emotional",value:"Emotional"},{label:"Empathetic",value:"Empathetic"},{label:"Formal",value:"Formal"},{label:"Friendly",value:"Friendly"},{label:"Humorous",value:"Humorous"},{label:"Informal",value:"Informal"},{label:"Ironic",value:"Ironic"},{label:"Optimistic",value:"Optimistic"},{label:"Pessimistic",value:"Pessimistic"},{label:"Playful",value:"Playful"},{label:"Professional",value:"Professional"},{label:"Sarcastic",value:"Sarcastic"},{label:"Serious",value:"Serious"},{label:"Straightforward",value:"Straightforward"},{label:"Sympathetic",value:"Sympathetic"},{label:"Tentative",value:"Tentative"},{label:"Warm",value:"Warm"}];function Qa(t,{inputValue:e}){return t.filter(a=>{let r=a.label.toLowerCase(),i=a.value.toLowerCase(),n=e.toLowerCase();return r.includes(n)||i.includes(n)})}var oa=t=>{let{label:e="Tone",defaultValue:a="",onChange:r=o=>{},placeholder:i,sx:n}=t,[c,u]=Te.default.useState(()=>Ue.find(o=>o.value===a)||Ue[0]);return Te.default.createElement(re,{componentsProps:{popper:{style:{width:160}}},placeholder:i,disableClearable:!0,value:c,size:"small",sx:{width:160,...n},autoHighlight:!0,getOptionLabel:o=>o.label,options:Ue,onChange:(o,m)=>{u(m),r(m.value)},filterOptions:Qa,renderInput:o=>Te.default.createElement(X,{...o,label:e,InputLabelProps:{sx:{fontSize:"16px"},...o.InputLabelProps},inputProps:{sx:{fontSize:"16px"},...o.inputProps,autoComplete:"new-password"}})})};var Xa=t=>{let{systemVariableSelectKey:e,...a}=t;switch(e){case"AI_RESPONSE_WRITING_STYLE":return Ae.default.createElement(ta,{...a});case"AI_RESPONSE_LANGUAGE":return Ae.default.createElement(aa,{...a});case"AI_RESPONSE_TONE":return Ae.default.createElement(oa,{...a});default:return null}},ra=Xa;var Fe=C(ya()),Ee="CHROME_EXTENSION_SET_VARIABLES_MODAL_SELECT_KEY",ze=async()=>{let t=await Fe.default.storage.local.get(Ee);try{return t[Ee]?JSON.parse(t[Ee]):{}}catch{return{}}},na=async(t,e)=>{try{let a=await ze();return a[t]=e,await Fe.default.storage.local.set({[Ee]:JSON.stringify(a)}),!0}catch{return!1}};var Ja=t=>{let{title:e,variables:a,systemVariables:r,modelKey:i,onShow:n,onClose:c}=t,{setShortCuts:u,runShortCuts:o,loading:m}=_e(),{currentSidebarConversationType:T}=M(),{t:g}=F(["common","client"]),[f,b]=(0,_.useState)(!1),[I,S]=(0,_.useState)(!1),[h,G]=(0,_.useState)(null),U=(0,_.useRef)(),[z,q]=(0,_.useState)([]),[w,$]=(0,_.useState)({}),ue=async p=>{z.forEach(d=>{d.resolve({data:Z(w),type:p?"cancel":"close",success:!1})}),$({}),b(!1),c?.()},ie=async p=>{if(se(p)){let d=U.current?.querySelectorAll("textarea[id]")?.[p+1];if(d){d.focus();return}}if(h?.waitForUserAction)z.forEach(d=>{d.resolve({data:Z(w),type:"confirm",success:!0})});else{let d=Z(w);if($({}),b(!1),c?.(),h?.template){let y=w?.TEMPLATE||h?.template||"",k="";d.AI_RESPONSE_TONE!=="Default"&&d.AI_RESPONSE_WRITING_STYLE!=="Default"?k=`

Please write in {{AI_RESPONSE_TONE}} tone, {{AI_RESPONSE_WRITING_STYLE}} writing style, using {{AI_RESPONSE_LANGUAGE}}.`:d.AI_RESPONSE_TONE!=="Default"?k=`

Please write in {{AI_RESPONSE_TONE}} tone, using {{AI_RESPONSE_LANGUAGE}}.`:d.AI_RESPONSE_WRITING_STYLE!=="Default"?k=`

Please write in {{AI_RESPONSE_WRITING_STYLE}} writing style, using {{AI_RESPONSE_LANGUAGE}}.`:k=`

Please write using {{AI_RESPONSE_LANGUAGE}}.`,y+=`

---`+k;let l=[];l.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:d}}),l.push({type:"RENDER_TEMPLATE",parameters:{template:y}}),Xe?l.push({type:"ASK_CHATGPT",parameters:{template:"{{LAST_ACTION_OUTPUT}}",AskChatGPTActionType:"ASK_CHAT_GPT_WITH_PREFIX",AskChatGPTActionMeta:{contextMenu:{id:h.contextMenuId||le(),droppable:!1,parent:le(),text:h.title,data:{editable:!1,type:"shortcuts",actions:[]}}}}}):l.push({type:"ASK_CHATGPT",parameters:{template:"{{LAST_ACTION_OUTPUT}}"}}),await u(l),await o()}}},K=(0,_.useMemo)(()=>{let p={},d=a||h?.variables||[],y=r||h?.systemVariables||[],k=e||h?.title||"",l=[],A=[];d.forEach(D=>{D.valueType==="Select"&&!D.hidden&&l.push(D),D.valueType==="Text"&&!D.hidden&&A.push(D),p[D.VariableName]=D.defaultValue}),y.forEach(D=>{p[D.VariableName]=D.defaultValue});let B=l.length+y.length,Ie=window.innerHeight*.6,Me=36,ce=Math.ceil(B/3),We=ce*48+(ce-1)*16,Pe=A.length,_a=(Pe-1)*16,ha=16*3,va=Ie-Me-We-_a-ha,Ca=Math.floor(va/24/Pe)-1;return ze().then(D=>{let qe=Object.keys(p);qe.length!==0&&(qe.forEach(we=>{D[we]!==void 0&&(p[we]=D[we])}),$(p))}),{currentTitle:k,currentSelectTotalCount:B,currentSystemVariables:y,selectTypeVariables:l,textTypeVariables:A,maxTextareaMaxRows:Ca}},[a,e,r,i,h]);return ot(()=>{Tt.receive("SetVariablesModal",p=>new Promise((d,y)=>{p.task==="open"&&p.config?.modelKey===i&&(b(!1),setTimeout(()=>{G(p.config),p.config.waitForUserAction?q([{resolve:d,reject:y}]):d({data:Z(w),type:"confirm",success:!0}),n?.(),b(!0)},0))}))}),(0,_.useEffect)(()=>{S(T!=="Chat")},[T]),(0,_.useEffect)(()=>{if(f)if(I)c?.();else{let p=()=>{let d=Array.from(U.current?.querySelectorAll("textarea")||[]).find(y=>y.value==="");d?d.focus():U.current?.querySelector("textarea")?.focus()};setTimeout(()=>{p()},0),setTimeout(()=>{p()},100),n?.()}else S(!1)},[f,I]),!f||I||Object.keys(w).length===0?null:_.default.createElement(x,{borderRadius:"8px",border:"1px solid",borderColor:"customColor.borderColor",sx:{width:"100%",p:1,gap:1},maxHeight:"60vh",onKeyPressCapture:p=>{p.stopPropagation()},onKeyPress:p=>{p.stopPropagation()}},_.default.createElement(x,{height:36,direction:"row",alignItems:"start",justifyContent:"space-between"},_.default.createElement(L,{component:"div",sx:{borderRadius:"4px",p:"4px 8px",bgcolor:"rgba(0, 0, 0, 0.87)"}},_.default.createElement(W,{fontSize:"14px",color:"#fff",fontWeight:600},K.currentTitle)),_.default.createElement(ut,{onClick:async()=>await ue(!0),sx:{position:"relative",top:"-8px",right:"-8px"}},_.default.createElement(ia.default,{sx:{fontSize:"24px"}}))),_.default.createElement(x,{flexWrap:"wrap",direction:"row",sx:{gap:"16px"}},K.currentSystemVariables.map((p,d)=>{let y=$a(d,K.currentSelectTotalCount);return _.default.createElement(ra,{systemVariableSelectKey:p.VariableName,key:p.VariableName,defaultValue:w[p.VariableName]||"",onChange:async k=>{await na(p.VariableName,k),$(l=>({...l,[p.VariableName]:k}))},sx:{width:y}})})),_.default.createElement(x,{gap:2,paddingTop:1,ref:U},K.textTypeVariables.map((p,d)=>_.default.createElement(X,{size:"small",key:p.VariableName,label:p.label,value:w[p.VariableName]||"",onChange:y=>{let k=y.target.value;$(l=>({...l,[p.VariableName]:k}))},onKeyDown:async y=>{y.key==="Enter"&&!y.shiftKey?(y.stopPropagation(),y.preventDefault(),await ie(d)):y.stopPropagation()},InputProps:{sx:{fontSize:"16px"}},InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:p.placeholder,minRows:Math.min(K.maxTextareaMaxRows,2),maxRows:K.maxTextareaMaxRows}))),_.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"end",gap:1},_.default.createElement(R,{sx:{height:"32px"},onClick:async()=>await ue(!0),variant:"secondary"},g("common:cancel")),_.default.createElement(ge,{title:g("client:sidebar__button__send_to_ai"),TooltipProps:{description:"\u23CE"},disabled:m,onClick:async()=>await ie(),variant:"contained",color:"primary",sx:{width:"32px",height:"32px",minWidth:"unset"}},m?_.default.createElement(fe,{size:16,sx:{fontSize:"inherit",color:"#fff"}}):_.default.createElement(la.default,{sx:{fontSize:"16px"}}))))},$a=(t,e)=>{let a=e%3,r=(e-a)/3;if(t<r*3)return"calc(33.33% - (2/3)*16px)";switch(a){case 1:if(t===e-1)return"100%";break;case 2:if(t>=e-2)return"calc(50% - 8px)";break}return null},sa=Ja;var Y=C(O());var ee=C(O());var Za=()=>{let t="Email & social media assistants in one click.";return ee.default.createElement(W,{width:"100%",component:"div",fontSize:12,color:"text.secondary",sx:{display:"flex",alignItems:"center",justifyContent:"end"}},ee.default.createElement(W,{fontSize:"inherit",color:"inherit",width:0,flex:1,textAlign:"right",noWrap:!0},ee.default.createElement(ae,{fontSize:"inherit",color:"inherit",href:Ze,target:"_blank",sx:{textDecoration:"underline!important"}},ee.default.createElement("span",null,"MaxAI.me v"),ee.default.createElement("span",null,`${Ye}`),ee.default.createElement("span",null,` - ${t}`))))},ua=Za;var ca=C(Ea()),{getOS:eo}=new ca.UAParser,to=()=>{let{width:t,scrollWidth:e}=Ft(),{t:a}=F(["common"]),[r,i]=(0,Y.useState)(!1);return(0,Y.useEffect)(()=>{if(se(e)&&se(t)&&e>t){if(eo().name==="Mac OS")return;i(!0)}},[t,e]),Y.default.createElement(x,{direction:"row",alignItems:"center",sx:{width:"100%"},spacing:2,justifyContent:"space-between",pb:r?2:0},Y.default.createElement(W,{sx:{flexShrink:0},fontSize:12},Y.default.createElement(ae,{color:"text.primary",sx:{cursor:"pointer"},underline:"always",target:"_blank",href:Je},a("common:contact_us"))),Y.default.createElement(ua,null))},pa=to;var ma=s.default.lazy(()=>import("./LO3BV4RZ.js")),ao=t=>{let{sx:e,aiAvatar:a,userAvatar:r,onCopy:i,onQuestionUpdate:n,editAble:c=!0,insertAble:u=!0,reGenerateAble:o=!0,onReGenerate:m,onStopGenerate:T,onSendMessage:g,writingMessage:f,messages:b,onRetry:I,onReset:S,loading:h}=t,[G,U]=(0,s.useState)(!1),{t:z}=F(["common","client"]),q=(0,s.useRef)(null),w=(0,s.useRef)(null),[$,ue]=s.default.useState(!1),{slicedMessageList:ie,changePageNumber:K}=Kt(w,b),{currentSidebarConversationType:p}=M(),d=(0,s.useRef)(!0),y=(0,s.useCallback)((l,A)=>{K(1),g&&g(l,A)},[g,K]);(0,s.useEffect)(()=>{let l=q.current;if(!l)return;let B=at(Ie=>{if(Ie.deltaY<0){d.current=!1;return}let Me=l.scrollTop,ce=l.scrollHeight;l.clientHeight+Me>=ce&&(d.current=!0)},100);return l.addEventListener("wheel",B),()=>l.removeEventListener("wheel",B)},[]),(0,s.useEffect)(()=>{let l=q.current;d.current&&l&&l.scrollTo(0,l.scrollHeight)},[f]);let k=(0,s.useRef)("");return(0,s.useEffect)(()=>{if(b.length>0){ue(b[b.length-1].type==="ai");for(let l=b.length-1;l>=0;l--){let A=b[l];if(A){let B=q.current;k.current&&k.current!==A.messageId?(d.current=!0,setTimeout(()=>{B&&B.scrollTo(0,B.scrollHeight)},0)):(d.current=!0,setTimeout(()=>{B&&B.scrollTo(0,B.scrollHeight)},0)),k.current=A.messageId;break}}}},[b]),(0,s.useEffect)(()=>{let l=()=>{let A=q.current;A&&(d.current&&A.scrollTo(0,A.scrollHeight),setTimeout(()=>{d.current&&A.scrollTo(0,A.scrollHeight)},1e3))};return l(),window.addEventListener("focus",l),()=>window.removeEventListener("focus",l)},[]),s.default.createElement(x,{position:"relative",borderTop:"1px solid",borderColor:"customColor.borderColor",sx:{height:0,flex:1,"& .MuiButton-root":{textTransform:"none"},...e}},s.default.createElement(L,{ref:q,flex:1,height:0,sx:{textAlign:"left",overflowY:"auto"}},s.default.createElement(ea,null),s.default.createElement(L,{ref:w},s.default.createElement(Pt,null,ie.map((l,A)=>s.default.createElement(ma,{className:`use-chat-gpt-ai__message-item use-chat-gpt-ai__message-item--${l.type}`,insertAble:u,replaceAble:!0,message:l,aiAvatar:a,editAble:c,userAvatar:r,useChatGPTAble:!0,key:l.messageId+"_sidebar_chat_message_"+String(A),onSave:B=>{n&&n(l.messageId,B)},onRetry:I,onCopy:i})),f&&s.default.createElement(ma,{className:"use-chat-gpt-ai__writing-message-item",replaceAble:!1,insertAble:!1,message:f,useChatGPTAble:!1,aiAvatar:a,editAble:!1,userAvatar:r})))),s.default.createElement(x,{className:"use-chat-gpt-ai__chat-box__input-box",position:"relative",mt:"auto",justifyContent:"center",alignItems:"center",minHeight:60,spacing:1,p:1,flexShrink:0},s.default.createElement(x,{width:"100%",alignItems:"center",justifyContent:"center"},s.default.createElement(L,{sx:{width:"100%"},component:"div",display:"flex",width:0,flex:1,alignItems:"center",justifyContent:"center",gap:1,mb:1,position:"relative"},s.default.createElement(jt,{disabledMainButton:h,onClick:async l=>{if(l==="focus"){let A=te()?.querySelector(`#${pe}`);A&&A.focus()}else l==="new"?S&&S():l==="restart"&&await tt()}}),s.default.createElement(Yt,{sx:{position:"absolute",bottom:0,right:0}}),!h&&ie.length>0&&s.default.createElement(s.default.Fragment,null,o&&s.default.createElement(R,{disableElevation:!0,startIcon:s.default.createElement(da.default,null),variant:"outlined",disabled:h,onClick:()=>{m&&m()}},z("client:sidebar__button__regenerate")),$&&p!=="Search"&&s.default.createElement(R,{disableElevation:!0,startIcon:s.default.createElement(Se,{icon:"FastForward"}),variant:"outlined",disabled:h,onClick:()=>{y&&y("Continue",{includeHistory:!0,regenerate:!1})}},z("client:sidebar__button__continue"))),h&&s.default.createElement(R,{sx:{mb:1},disableElevation:!0,variant:"outlined",startIcon:s.default.createElement(ga.default,null),onClick:()=>{T&&T()}},z("client:sidebar__button__stop_generating"))),s.default.createElement(sa,{onClose:()=>{U(!1)},onShow:()=>U(!0),modelKey:"Sidebar"}),s.default.createElement(Mt,{sx:{minHeight:G?0:80,height:G?"0!important":"unset",visibility:G?"hidden":"visible"},stopPropagation:!0,loading:h,expandNode:s.default.createElement(wt,{direction:"column",size:"small"}),onEnter:y},s.default.createElement(qt,{onSendMessage:y}))),s.default.createElement(pa,null)))},fa=ao;var J=C(O());var ba=C(xa());var oo=`You are a research expert who is good at coming up with the perfect search query to help find answers to any question. Your task is to think of the most effective search query for the following question delimited by <question></question>:

<question>
{{current_question}}
</question>

The question is the final one in a series of previous questions and answers. Here are the earlier questions listed in the order they were asked, from the very first to the one before the final question, delimited by <previous_questions></previous_questions>:
<previous_questions>
{{previous_questions}}
</previous_questions>

For your reference, today's date is {{CURRENT_DATE}}.

Output the search query without additional context, explanation, or extra wording, just the search query itself. Don't use any punctuation, especially no quotes or backticks, around the search query.`,ro=t=>{let e=oo;e=e.replaceAll("{{CURRENT_DATE}}",(0,ba.default)().format("YYYY-MM-DD HH:mm:ss"));let a=t[t.length-1],r=t.slice(0,-1);e=e.replaceAll("{{current_question}}",a);let i="";return r.forEach((n,c)=>{i+=`${c+1}) ${n}${c<r.length-1?`
`:""}`}),e=e.replaceAll("{{previous_questions}}",i),e},no=async t=>{let e=gt;if(!e)return t;e=e.replaceAll("{query}",t),e=e.replace("{web_results}","{{PAGE_CONTENT}}"),e=e.replaceAll("{current_date}","{{CURRENT_DATE}}");let a=await yt();return a.userSettings?.language&&(e=e+`
Respond in ${a.userSettings?.language}`),e},io=()=>{let{currentSidebarConversationId:t,currentSidebarConversationType:e,currentSidebarConversationMessages:a}=M(),r=je(Q),i=_t(),{currentUserPlan:n}=mt(),{setShortCuts:c,runShortCuts:u}=_e(""),[o,m]=(0,J.useState)([]),{createConversation:T}=ht(),g=(0,J.useRef)(!1),f=(0,J.useMemo)(()=>a.filter(S=>S.type==="ai").map(S=>S?.originalMessage?.metadata?.title||S.text||""),[a]),b=async S=>{if(!g.current){await Ne("ON_BOARDING_RECORD_AI_PROVIDER_HAS_AUTH_USE_CHAT_GPT_PLUS",!0),r(h=>({...h,loading:!0}));try{let h=await T();if(r(w=>({...w,loading:!1})),n.name!=="pro"){let w=Number((await rt()).ON_BOARDING_RECORD_SEARCH_FREE_TRIAL_TIMES)||0;if(w>0)await Ne("ON_BOARDING_RECORD_SEARCH_FREE_TRIAL_TIMES",w-1);else{await be("add",h,0,[St(i.SIDEBAR_SEARCH_WITH_AI)]),bt("show","SIDEBAR_SEARCH_WITH_AI");return}}let G=S,U="",z=S.match(/\/site:(\S+)/);z&&(U=z[1],G=S.replace(z[0],"")),G=Et(G,{trim:!0,noQuotes:!0,noCommand:!0});let q=[{type:"DATE",parameters:{DateActionMode:"Current Date",DateFormatStyle:"YYYY-MM-DD HH:mm:ss"}},{type:"SET_VARIABLE",parameters:{VariableName:"CURRENT_DATE"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:le(),text:"",originalMessage:{metadata:{title:S,quickSearch:[{title:"Understanding question",status:"loading",icon:"CheckCircle"}]}}}}},{type:"SET_VARIABLE",parameters:{VariableName:"AI_RESPONSE_MESSAGE_ID"}},{type:"ASK_CHATGPT",parameters:{template:ro(f.concat(G)),AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",AskChatGPTActionMeta:{messageVisibleText:S,contextMenu:{id:"b481731b-19e3-4713-8f0b-81fd7b2d5169",droppable:!1,parent:"",text:"[Search] smart query",data:{editable:!1,type:"shortcuts",actions:[]}}},AskChatGPTWithHistory:!0}},{type:"TEXT_HANDLER",parameters:{ActionTextHandleParameters:{trim:!0,noQuotes:!0,noCommand:!0}}},{type:"SET_VARIABLE",parameters:{VariableName:"SMART_SEARCH_QUERY"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{metadata:{quickSearch:[{title:"Understanding question",status:"complete",icon:"CheckCircle"},{title:"Searching web",status:"loading",icon:"Search",value:"{{SMART_SEARCH_QUERY}}"}],sources:{status:"loading",links:[]}},content:{contentType:"text",text:""}}}}},{type:"GET_CONTENTS_OF_SEARCH_ENGINE",parameters:{URLSearchEngine:"google",URLSearchEngineParams:{q:"{{SMART_SEARCH_QUERY}}",region:"",limit:"6",btf:"",nojs:"1",ei:"UTF-8",csp:"1",site:U}}},{type:"SET_VARIABLE",parameters:{VariableName:"SEARCH_SOURCES"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{metadata:{title:S,quickSearch:[{title:"Understanding question",status:"complete",icon:"CheckCircle"},{title:"Searching web",status:"complete",icon:"Search",value:"{{SMART_SEARCH_QUERY}}"}],sources:{status:"complete",links:"{{SEARCH_SOURCES}}"}}}}}},{type:"RENDER_TEMPLATE",parameters:{template:"{{SEARCH_SOURCES}}"}},{type:"WEBGPT_SEARCH_RESULTS_EXPAND",parameters:{SummarizeActionType:"NO_SUMMARIZE"}},{type:"SET_VARIABLE",parameters:{VariableName:"PAGE_CONTENT"}},{type:"ASK_CHATGPT",parameters:{AskChatGPTWithHistory:!0,AskChatGPTInsertMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",AskChatGPTActionMeta:{messageVisibleText:S,searchSources:"{{SEARCH_SOURCES}}",contextMenu:{id:"73361add-2d6a-4bf3-b2a7-5097551653e7",droppable:!1,parent:"",text:"[Search] answer",data:{editable:!1,type:"shortcuts",actions:[]}}},template:await no(G)}}];m(q)}catch{}}},I=async()=>{try{if(t){let S=f[f.length-1];S?(await be("delete",t,1,[]),await b(S)):await be("delete",t,9999,[])}}catch{}};return(0,J.useEffect)(()=>{o.length>0&&!g.current&&e==="Search"&&t&&(g.current=!0,c(o)?u().then().catch().finally(()=>{g.current=!1,m([])}):(m([]),g.current=!1))},[u,m,e,t,o]),{createSearchWithAI:b,regenerateSearchWithAI:I}},Sa=io;var lo=()=>{let{currentSidebarConversationType:t}=M(),{createSearchWithAI:e,regenerateSearchWithAI:a}=Sa(),{sendQuestion:r,conversation:i,reGenerate:n,retryMessage:c,stopGenerateMessage:u,resetConversation:o}=xt(""),{currentSidebarConversationMessages:m}=M();return(0,ne.useEffect)(()=>{et()},[]),ne.default.createElement(x,{flex:1,height:0,position:"relative"},ne.default.createElement(Ct,null),ne.default.createElement(fa,{editAble:!1,insertAble:!1,onSendMessage:async(T,g)=>{t==="Search"?await e(T):await r({question:T},{...g,regenerate:!1,includeHistory:g.includeHistory===!0})},writingMessage:i.writingMessage,messages:m,loading:i.loading,title:"Chat Draft",onRetry:c,onReGenerate:async()=>{t==="Search"?await a():await n()},onStopGenerate:u,onReset:o}))},Ci=lo;export{Ci as default};
