import"../../chunks/PQ35KENF.js";var m="MAX_AI_CHAT_GPT_MESSAGE_KEY",d=class{constructor(){this.pendingPromises=[];window.addEventListener("message",async e=>{if(e.data?.event===m&&e.data?.type==="arkoseToken"){let t=await this.generate();window.postMessage({event:m,type:"arkoseTokenResponse",data:{taskId:e.data?.data?.taskId,token:t}})}})}useArkoseSetupEnforcement(e){this.enforcement=e,window.useArkoseSetupEnforcementgpt4(new Proxy(e,{get:(t,n,a)=>n==="setConfig"?o=>{this.config=o;let i=o.onCompleted;o.onCompleted=r=>{i(r),this.pendingPromises.forEach(s=>{s.resolve(r.token)}),this.pendingPromises=[]};let c=o.onFailed;return o.onFailed=r=>{c(r),this.pendingPromises.forEach(s=>{s.reject(new Error("Failed to generate arkose token"))})},Reflect.get(t,n,a)(o)}:Reflect.get(t,n,a)})),window.useArkoseSetupEnforcementgpt35(new Proxy(e,{get:(t,n,a)=>n==="setConfig"?o=>{this.config=o;let i=o.onCompleted;o.onCompleted=r=>{i(r),this.pendingPromises.forEach(s=>{s.resolve(r.token)}),this.pendingPromises=[]};let c=o.onFailed;return o.onFailed=r=>{c(r),this.pendingPromises.forEach(s=>{s.reject(new Error("Failed to generate arkose token"))})},Reflect.get(t,n,a)(o)}:Reflect.get(t,n,a)}))}injectScript(e){let t=window;t.useArkoseSetupEnforcement2=this.useArkoseSetupEnforcement.bind(this);let n=document.createElement("script");n.src=e,n.async=!0,n.defer=!0,n.setAttribute("data-callback","useArkoseSetupEnforcement2"),document.body.appendChild(n)}async loadConfig(){let e=document.querySelector("#prompt-textarea")||document.querySelector("textarea");if(e){e.focus(),e.select();let t=!1;for(;!t;)document.execCommand("insertText",!1,"a"),await new Promise(n=>setTimeout(n,1e3)),t=!!this.config}return e.select(),document.execCommand("Delete",!1,""),!0}async run(){let e=document.querySelector("#prompt-textarea")||document.querySelector("textarea");e&&(e.focus(),e.select(),document.execCommand("Delete",!1,""),await new Promise(t=>setTimeout(t,2e3)),document.execCommand("insertText",!1,"a"),await new Promise(t=>setTimeout(t,2e3)),document.execCommand("Delete",!1,""))}async generate(){if(this.enforcement)return new Promise(async(e,t)=>{this.pendingPromises=[{resolve:e,reject:t}],this.config||await this.loadConfig(),await this.run()})}},u=new d;var l=document.querySelector("script[data-arkose]")?.getAttribute("data-arkose");l&&u.injectScript(l);
