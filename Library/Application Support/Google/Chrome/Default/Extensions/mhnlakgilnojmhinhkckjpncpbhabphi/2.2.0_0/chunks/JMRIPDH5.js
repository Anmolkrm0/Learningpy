import{c as Dt}from"./PQ35KENF.js";var At=Dt((nt,rt)=>{var _t=()=>{let ie=document.activeElement;if(ie?.tagName==="INPUT"||ie?.tagName==="TEXTAREA"||ie?.getAttribute?.("contenteditable")==="true"){let De=ie.getAttribute("type");return!(De&&De!=="text")}},tt=[/https:\/\/www.google.*/,"https://www.baidu.com","https://www.naver.com"].some(ie=>typeof ie=="string"?ie===window.location.origin:ie.test(window.location.origin))||_t();(function(ie,De){typeof define=="function"&&define.amd?define(ie):typeof rt<"u"&&typeof nt=="object"?rt.exports=ie():De.rangy=ie()})(function(){var ie="object",De="function",Be="undefined",mt=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],Rt=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],Ct=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],Nt=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function Ne(i,u){var c=typeof i[u];return c==De||!!(c==ie&&i[u])||c=="unknown"}function Ye(i,u){return!!(typeof i[u]==ie&&i[u])}function it(i,u){return typeof i[u]!=Be}function qe(i){return function(u,c){for(var p=c.length;p--;)if(!i(u,c[p]))return!1;return!0}}var Qe=qe(Ne),Et=qe(Ye),Ke=qe(it);function at(i){return i&&Qe(i,Nt)&&Ke(i,Ct)}function ot(i){return Ye(i,"body")?i.body:i.getElementsByTagName("body")[0]}var St=[].forEach?function(i,u){i.forEach(u)}:function(i,u){for(var c=0,p=i.length;c<p;++c)u(i[c],c)},He={},Ee=typeof window!=Be&&typeof document!=Be,Se={isHostMethod:Ne,isHostObject:Ye,isHostProperty:it,areHostMethods:Qe,areHostObjects:Et,areHostProperties:Ke,isTextRange:at,getBody:ot,forEach:St},P={version:"1.3.1",initialized:!1,isBrowser:Ee,supported:!0,util:Se,features:{},modules:He,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==Be?!0:rangyAutoInitialize}};function ke(i){typeof console!=Be&&Ne(console,"log")}function st(i,u){Ee&&u?alert(i):ke(i)}function _e(i){P.initialized=!0,P.supported=!1,st("Rangy is not supported in this environment. Reason: "+i,P.config.alertOnFail)}P.fail=_e;function yt(i){st("Rangy warning: "+i,P.config.alertOnWarn)}P.warn=yt;var Ve;({}).hasOwnProperty?(Se.extend=Ve=function(i,u,c){var p,R;for(var D in u)u.hasOwnProperty(D)&&(p=i[D],R=u[D],c&&p!==null&&typeof p=="object"&&R!==null&&typeof R=="object"&&Ve(p,R,!0),i[D]=R);return u.hasOwnProperty("toString")&&(i.toString=u.toString),i},Se.createOptions=function(i,u){var c={};return Ve(c,u),i&&Ve(c,i),c}):_e("hasOwnProperty not supported"),Ee||_e("Rangy can only run in a browser"),function(){var i;if(Ee){var u=document.createElement("div");u.appendChild(document.createElement("span"));var c=[].slice;try{c.call(u.childNodes,0)[0].nodeType==1&&(i=function(p){return c.call(p,0)})}catch{}}i||(i=function(p){for(var R=[],D=0,w=p.length;D<w;++D)R[D]=p[D];return R}),Se.toArray=i}();var ze;Ee&&(Ne(document,"addEventListener")?ze=function(i,u,c){i.addEventListener(u,c,!1)}:Ne(document,"attachEvent")?ze=function(i,u,c){i.attachEvent("on"+u,c)}:_e("Document does not have required addEventListener or attachEvent method"),Se.addListener=ze);var ct=[];function ft(i){return i.message||i.description||String(i)}function Xe(){if(!(!Ee||P.initialized)){var i,u=!1,c=!1;Ne(document,"createRange")&&(tt?u=!0:(i=document.createRange(),Qe(i,Rt)&&Ke(i,mt)&&(u=!0)));var p=ot(document);if(!p||p.nodeName.toLowerCase()!="body"){_e("No body element found");return}if(p&&Ne(p,"createTextRange")&&(tt?c=!0:(i=p.createTextRange(),at(i)&&(c=!0))),!u&&!c){_e("Neither Range nor TextRange are available");return}P.initialized=!0,P.features={implementsDomRange:u,implementsTextRange:c};var R,D;for(var w in He)(R=He[w])instanceof Ue&&R.init(R,P);for(var Q=0,Z=ct.length;Q<Z;++Q)try{}catch(J){D="Rangy init listener threw an exception. Continuing. Detail: "+ft(J),ke(D)}}}function ut(i,u,c){c&&(i+=" in module "+c.name),P.warn("DEPRECATED: "+i+" is deprecated. Please use "+u+" instead.")}function lt(i,u,c,p){i[u]=function(){return ut(u,c,p),i[c].apply(i,Se.toArray(arguments))}}Se.deprecationNotice=ut,Se.createAliasForDeprecatedMethod=lt,P.init=Xe,P.addInitListener=function(i){P.initialized?i(P):ct.push(i)};var Ze=[];P.addShimListener=function(i){Ze.push(i)};function wt(i){i=i||window,Xe();for(var u=0,c=Ze.length;u<c;++u)Ze[u](i)}Ee&&(P.shim=P.createMissingNativeApi=wt,lt(P,"createMissingNativeApi","shim"));function Ue(i,u,c){this.name=i,this.dependencies=u,this.initialized=!1,this.supported=!1,this.initializer=c}Ue.prototype={init:function(){for(var i=this.dependencies||[],u=0,c=i.length,p,R;u<c;++u){if(R=i[u],p=He[R],!p||!(p instanceof Ue))throw new Error("required module '"+R+"' not found");if(p.init(),!p.supported)throw new Error("required module '"+R+"' not supported")}this.initializer(this)},fail:function(i){throw this.initialized=!0,this.supported=!1,new Error(i)},warn:function(i){P.warn("Module "+this.name+": "+i)},deprecationNotice:function(i,u){P.warn("DEPRECATED: "+i+" in module "+this.name+" is deprecated. Please use "+u+" instead")},createError:function(i){return new Error("Error in Rangy "+this.name+" module: "+i)}};function dt(i,u,c){var p=new Ue(i,u,function(R){if(!R.initialized){R.initialized=!0;try{c(P,R),R.supported=!0}catch(w){var D="Module '"+i+"' failed to load: "+ft(w);ke(D),w.stack&&ke(w.stack)}}});return He[i]=p,p}P.createModule=function(i){var u,c;arguments.length==2?(u=arguments[1],c=[]):(u=arguments[2],c=arguments[1]);var p=dt(i,c,u);P.initialized&&P.supported&&p.init()},P.createCoreModule=function(i,u,c){dt(i,u,c)};function ht(){}P.RangePrototype=ht,P.rangePrototype=new ht;function Tt(){}P.selectionPrototype=new Tt,P.createCoreModule("DomUtil",[],function(i,u){var c="undefined",p=i.util,R=p.getBody;p.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||u.fail("document missing a Node creation method"),p.isHostMethod(document,"getElementsByTagName")||u.fail("document missing getElementsByTagName method");var D=document.createElement("div");p.areHostMethods(D,["insertBefore","appendChild","cloneNode"])||u.fail("Incomplete Element implementation"),p.isHostProperty(D,"innerHTML")||u.fail("Element is missing innerHTML property");var w=document.createTextNode("test");p.areHostMethods(w,["splitText","deleteData","insertData","appendData","cloneNode"])||u.fail("Incomplete Text Node implementation");var Q=function(a,h){for(var O=a.length;O--;)if(a[O]===h)return!0;return!1};function Z(a){var h;return typeof a.namespaceURI==c||(h=a.namespaceURI)===null||h=="http://www.w3.org/1999/xhtml"}function J(a){var h=a.parentNode;return h.nodeType==1?h:null}function z(a){for(var h=0;a=a.previousSibling;)++h;return h}function de(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function ae(a,h){var O=[],E;for(E=a;E;E=E.parentNode)O.push(E);for(E=h;E;E=E.parentNode)if(Q(O,E))return E;return null}function K(a,h,O){for(var E=O?h:h.parentNode;E;){if(E===a)return!0;E=E.parentNode}return!1}function ne(a,h){return K(a,h,!0)}function G(a,h,O){for(var E,X=O?a:a.parentNode;X;){if(E=X.parentNode,E===h)return X;X=E}return null}function fe(a){var h=a.nodeType;return h==3||h==4||h==8}function l(a){if(!a)return!1;var h=a.nodeType;return h==3||h==8}function B(a,h){var O=h.nextSibling,E=h.parentNode;return O?E.insertBefore(a,O):E.appendChild(a),a}function C(a,h,O){var E=a.cloneNode(!1);if(E.deleteData(0,h),a.deleteData(h,a.length-h),B(E,a),O)for(var X=0,k;k=O[X++];)k.node==a&&k.offset>h?(k.node=E,k.offset-=h):k.node==a.parentNode&&k.offset>z(a)&&++k.offset;return E}function W(a){if(a.nodeType==9)return a;if(typeof a.ownerDocument!=c)return a.ownerDocument;if(typeof a.document!=c)return a.document;if(a.parentNode)return W(a.parentNode);throw u.createError("getDocument: no document found for node")}function q(a){var h=W(a);if(typeof h.defaultView!=c)return h.defaultView;if(typeof h.parentWindow!=c)return h.parentWindow;throw u.createError("Cannot get a window object for node")}function H(a){if(typeof a.contentDocument!=c)return a.contentDocument;if(typeof a.contentWindow!=c)return a.contentWindow.document;throw u.createError("getIframeDocument: No Document object found for iframe element")}function _(a){if(typeof a.contentWindow!=c)return a.contentWindow;if(typeof a.contentDocument!=c)return a.contentDocument.defaultView;throw u.createError("getIframeWindow: No Window object found for iframe element")}function Y(a){return a&&p.isHostMethod(a,"setTimeout")&&p.isHostObject(a,"document")}function F(a,h,O){var E;if(a?p.isHostProperty(a,"nodeType")?E=a.nodeType==1&&a.tagName.toLowerCase()=="iframe"?H(a):W(a):Y(a)&&(E=a.document):E=document,!E)throw h.createError(O+"(): Parameter must be a Window object or DOM node");return E}function L(a){for(var h;h=a.parentNode;)a=h;return a}function he(a,h,O,E){var X,k,me,ve,se;if(a==O)return h===E?0:h<E?-1:1;if(X=G(O,a,!0))return h<=z(X)?-1:1;if(X=G(a,O,!0))return z(X)<E?-1:1;if(k=ae(a,O),!k)throw new Error("comparePoints error: nodes have no common ancestor");if(me=a===k?k:G(a,k,!0),ve=O===k?k:G(O,k,!0),me===ve)throw u.createError("comparePoints got to case 4 and childA and childB are the same!");for(se=k.firstChild;se;){if(se===me)return-1;if(se===ve)return 1;se=se.nextSibling}}var v=!1;function S(a){var h;try{return h=a.parentNode,!1}catch{return!0}}(function(){var a=document.createElement("b");a.innerHTML="1";var h=a.firstChild;a.innerHTML="<br />",v=S(h),i.features.crashyTextNodes=v})();function b(a){if(!a)return"[No node]";if(v&&S(a))return"[Broken node]";if(fe(a))return'"'+a.data+'"';if(a.nodeType==1){var h=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+h+">[index:"+z(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return a.nodeName}function U(a){for(var h=W(a).createDocumentFragment(),O;O=a.firstChild;)h.appendChild(O);return h}var j;typeof window.getComputedStyle!=c?j=function(a,h){return q(a).getComputedStyle(a,null)[h]}:typeof document.documentElement.currentStyle!=c?j=function(a,h){return a.currentStyle?a.currentStyle[h]:""}:u.fail("No means of obtaining computed style properties found");function ge(a,h,O){var E=R(a),X=a.createElement("div");X.contentEditable=""+!!O,h&&(X.innerHTML=h);var k=E.firstChild;return k?E.insertBefore(X,k):E.appendChild(X),X}function oe(a){return a.parentNode.removeChild(a)}function ee(a){this.root=a,this._next=a}ee.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next,h,O;if(this._current)if(h=a.firstChild,h)this._next=h;else{for(O=null;a!==this.root&&!(O=a.nextSibling);)a=a.parentNode;this._next=O}return this._current},detach:function(){this._current=this._next=this.root=null}};function te(a){return new ee(a)}function re(a,h){this.node=a,this.offset=h}re.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+b(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function ue(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}ue.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},ue.prototype.toString=function(){return this.message},i.dom={arrayContains:Q,isHtmlNamespace:Z,parentElement:J,getNodeIndex:z,getNodeLength:de,getCommonAncestor:ae,isAncestorOf:K,isOrIsAncestorOf:ne,getClosestAncestorIn:G,isCharacterDataNode:fe,isTextOrCommentNode:l,insertAfter:B,splitDataNode:C,getDocument:W,getWindow:q,getIframeWindow:_,getIframeDocument:H,getBody:R,isWindow:Y,getContentDocument:F,getRootContainer:L,comparePoints:he,isBrokenNode:S,inspectNode:b,getComputedStyleProperty:j,createTestElement:ge,removeNode:oe,fragmentFromNodeChildren:U,createIterator:te,DomPosition:re},i.DOMException=ue}),P.createCoreModule("DomRange",["DomUtil"],function(i,u){var c=i.dom,p=i.util,R=c.DomPosition,D=i.DOMException,w=c.isCharacterDataNode,Q=c.getNodeIndex,Z=c.isOrIsAncestorOf,J=c.getDocument,z=c.comparePoints,de=c.splitDataNode,ae=c.getClosestAncestorIn,K=c.getNodeLength,ne=c.arrayContains,G=c.getRootContainer,fe=i.features.crashyTextNodes,l=c.removeNode;function B(t,n){return t.nodeType!=3&&(Z(t,n.startContainer)||Z(t,n.endContainer))}function C(t){return t.document||J(t.startContainer)}function W(t){return G(t.startContainer)}function q(t){return new R(t.parentNode,Q(t))}function H(t){return new R(t.parentNode,Q(t)+1)}function _(t,n,o){var d=t.nodeType==11?t.firstChild:t;return w(n)?o==n.length?c.insertAfter(t,n):n.parentNode.insertBefore(t,o==0?n:de(n,o)):o>=n.childNodes.length?n.appendChild(t):n.insertBefore(t,n.childNodes[o]),d}function Y(t,n,o){if(V(t),V(n),C(n)!=C(t))throw new D("WRONG_DOCUMENT_ERR");var d=z(t.startContainer,t.startOffset,n.endContainer,n.endOffset),N=z(t.endContainer,t.endOffset,n.startContainer,n.startOffset);return o?d<=0&&N>=0:d<0&&N>0}function F(t){for(var n,o,d=C(t.range).createDocumentFragment(),N;o=t.next();){if(n=t.isPartiallySelectedSubtree(),o=o.cloneNode(!n),n&&(N=t.getSubtreeIterator(),o.appendChild(F(N)),N.detach()),o.nodeType==10)throw new D("HIERARCHY_REQUEST_ERR");d.appendChild(o)}return d}function L(t,n,o){var d,N;o=o||{stop:!1};for(var I,f;I=t.next();)if(t.isPartiallySelectedSubtree()){if(n(I)===!1){o.stop=!0;return}else if(f=t.getSubtreeIterator(),L(f,n,o),f.detach(),o.stop)return}else for(d=c.createIterator(I);N=d.next();)if(n(N)===!1){o.stop=!0;return}}function he(t){for(var n;t.next();)t.isPartiallySelectedSubtree()?(n=t.getSubtreeIterator(),he(n),n.detach()):t.remove()}function v(t){for(var n,o=C(t.range).createDocumentFragment(),d;n=t.next();){if(t.isPartiallySelectedSubtree()?(n=n.cloneNode(!1),d=t.getSubtreeIterator(),n.appendChild(v(d)),d.detach()):t.remove(),n.nodeType==10)throw new D("HIERARCHY_REQUEST_ERR");o.appendChild(n)}return o}function S(t,n,o){var d=!!(n&&n.length),N,I=!!o;d&&(N=new RegExp("^("+n.join("|")+")$"));var f=[];return L(new U(t,!1),function(m){if(!(d&&!N.test(m.nodeType))&&!(I&&!o(m))){var y=t.startContainer;if(!(m==y&&w(y)&&t.startOffset==y.length)){var x=t.endContainer;m==x&&w(x)&&t.endOffset==0||f.push(m)}}}),f}function b(t){var n=typeof t.getName>"u"?"Range":t.getName();return"["+n+"("+c.inspectNode(t.startContainer)+":"+t.startOffset+", "+c.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function U(t,n){if(this.range=t,this.clonePartiallySelectedTextNodes=n,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var o=t.commonAncestorContainer;this.sc===this.ec&&w(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===o&&!w(this.sc)?this.sc.childNodes[this.so]:ae(this.sc,o,!0),this._last=this.ec===o&&!w(this.ec)?this.ec.childNodes[this.eo-1]:ae(this.ec,o,!0))}}U.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,w(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t=this._current,n,o;w(t)&&(t===this.sc||t===this.ec)?(n=t===this.sc?this.so:0,o=t===this.ec?this.eo:t.length,n!=o&&t.deleteData(n,o-n)):t.parentNode&&l(t)},isPartiallySelectedSubtree:function(){var t=this._current;return B(t,this.range)},getSubtreeIterator:function(){var t;if(this.isSingleCharacterDataNode)t=this.range.cloneRange(),t.collapse(!1);else{t=new $(C(this.range));var n=this._current,o=n,d=0,N=n,I=K(n);Z(n,this.sc)&&(o=this.sc,d=this.so),Z(n,this.ec)&&(N=this.ec,I=this.eo),M(t,o,d,N,I)}return new U(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var j=[1,3,4,5,7,8,10],ge=[2,9,11],oe=[5,6,10,12],ee=[1,3,4,5,7,8,10,11],te=[1,3,4,5,7,8];function re(t){return function(n,o){for(var d,N=o?n:n.parentNode;N;){if(d=N.nodeType,ne(t,d))return N;N=N.parentNode}return null}}var ue=re([9,11]),a=re(oe),h=re([6,10,12]),O=re([1]);function E(t,n){if(h(t,n))throw new D("INVALID_NODE_TYPE_ERR")}function X(t,n){if(!ne(n,t.nodeType))throw new D("INVALID_NODE_TYPE_ERR")}function k(t,n){if(n<0||n>(w(t)?t.length:t.childNodes.length))throw new D("INDEX_SIZE_ERR")}function me(t,n){if(ue(t,!0)!==ue(n,!0))throw new D("WRONG_DOCUMENT_ERR")}function ve(t){if(a(t,!0))throw new D("NO_MODIFICATION_ALLOWED_ERR")}function se(t,n){if(!t)throw new D(n)}function be(t,n){return n<=(w(t)?t.length:t.childNodes.length)}function we(t){return!!t.startContainer&&!!t.endContainer&&!(fe&&(c.isBrokenNode(t.startContainer)||c.isBrokenNode(t.endContainer)))&&G(t.startContainer)==G(t.endContainer)&&be(t.startContainer,t.startOffset)&&be(t.endContainer,t.endOffset)}function V(t){if(!we(t))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+t.inspect()+")")}var Me=document.createElement("style"),Ce=!1;try{Me.innerHTML="<b>x</b>",Ce=Me.firstChild.nodeType==3}catch{}i.features.htmlParsingConforms=Ce;var Le=Ce?function(t){var n=this.startContainer,o=J(n);if(!n)throw new D("INVALID_STATE_ERR");var d=null;return n.nodeType==1?d=n:w(n)&&(d=c.parentElement(n)),d===null||d.nodeName=="HTML"&&c.isHtmlNamespace(J(d).documentElement)&&c.isHtmlNamespace(d)?d=o.createElement("body"):d=d.cloneNode(!1),d.innerHTML=t,c.fragmentFromNodeChildren(d)}:function(t){var n=C(this),o=n.createElement("body");return o.innerHTML=t,c.fragmentFromNodeChildren(o)};function Ae(t,n){V(t);var o=t.startContainer,d=t.startOffset,N=t.endContainer,I=t.endOffset,f=o===N;w(N)&&I>0&&I<N.length&&de(N,I,n),w(o)&&d>0&&d<o.length&&(o=de(o,d,n),f?(I-=d,N=o):N==o.parentNode&&I>=Q(o)&&I++,d=0),t.setStartAndEnd(o,d,N,I)}function A(t){V(t);var n=t.commonAncestorContainer.parentNode.cloneNode(!1);return n.appendChild(t.cloneContents()),n.innerHTML}var xe=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],Ie=0,Te=1,Ge=2,ye=3,Oe=0,We=1,Fe=2,Pe=3;p.extend(i.rangePrototype,{compareBoundaryPoints:function(t,n){V(this),me(this.startContainer,n.startContainer);var o,d,N,I,f=t==ye||t==Ie?"start":"end",m=t==Te||t==Ie?"start":"end";return o=this[f+"Container"],d=this[f+"Offset"],N=n[m+"Container"],I=n[m+"Offset"],z(o,d,N,I)},insertNode:function(t){if(V(this),X(t,ee),ve(this.startContainer),Z(t,this.startContainer))throw new D("HIERARCHY_REQUEST_ERR");var n=_(t,this.startContainer,this.startOffset);this.setStartBefore(n)},cloneContents:function(){V(this);var t,n;if(this.collapsed)return C(this).createDocumentFragment();if(this.startContainer===this.endContainer&&w(this.startContainer))return t=this.startContainer.cloneNode(!0),t.data=t.data.slice(this.startOffset,this.endOffset),n=C(this).createDocumentFragment(),n.appendChild(t),n;var o=new U(this,!0);return t=F(o),o.detach(),t},canSurroundContents:function(){V(this),ve(this.startContainer),ve(this.endContainer);var t=new U(this,!0),n=t._first&&B(t._first,this)||t._last&&B(t._last,this);return t.detach(),!n},surroundContents:function(t){if(X(t,te),!this.canSurroundContents())throw new D("INVALID_STATE_ERR");var n=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);_(t,this.startContainer,this.startOffset),t.appendChild(n),this.selectNode(t)},cloneRange:function(){V(this);for(var t=new $(C(this)),n=xe.length,o;n--;)o=xe[n],t[o]=this[o];return t},toString:function(){V(this);var t=this.startContainer;if(t===this.endContainer&&w(t))return t.nodeType==3||t.nodeType==4?t.data.slice(this.startOffset,this.endOffset):"";var n=[],o=new U(this,!0);return L(o,function(d){(d.nodeType==3||d.nodeType==4)&&n.push(d.data)}),o.detach(),n.join("")},compareNode:function(t){V(this);var n=t.parentNode,o=Q(t);if(!n)throw new D("NOT_FOUND_ERR");var d=this.comparePoint(n,o),N=this.comparePoint(n,o+1);return d<0?N>0?Fe:Oe:N>0?We:Pe},comparePoint:function(t,n){return V(this),se(t,"HIERARCHY_REQUEST_ERR"),me(t,this.startContainer),z(t,n,this.startContainer,this.startOffset)<0?-1:z(t,n,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Le,toHtml:function(){return A(this)},intersectsNode:function(t,n){if(V(this),G(t)!=W(this))return!1;var o=t.parentNode,d=Q(t);if(!o)return!0;var N=z(o,d,this.endContainer,this.endOffset),I=z(o,d+1,this.startContainer,this.startOffset);return n?N<=0&&I>=0:N<0&&I>0},isPointInRange:function(t,n){return V(this),se(t,"HIERARCHY_REQUEST_ERR"),me(t,this.startContainer),z(t,n,this.startContainer,this.startOffset)>=0&&z(t,n,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return Y(this,t,!1)},intersectsOrTouchesRange:function(t){return Y(this,t,!0)},intersection:function(t){if(this.intersectsRange(t)){var n=z(this.startContainer,this.startOffset,t.startContainer,t.startOffset),o=z(this.endContainer,this.endOffset,t.endContainer,t.endOffset),d=this.cloneRange();return n==-1&&d.setStart(t.startContainer,t.startOffset),o==1&&d.setEnd(t.endContainer,t.endOffset),d}return null},union:function(t){if(this.intersectsOrTouchesRange(t)){var n=this.cloneRange();return z(t.startContainer,t.startOffset,this.startContainer,this.startOffset)==-1&&n.setStart(t.startContainer,t.startOffset),z(t.endContainer,t.endOffset,this.endContainer,this.endOffset)==1&&n.setEnd(t.endContainer,t.endOffset),n}else throw new D("Ranges do not intersect")},containsNode:function(t,n){return n?this.intersectsNode(t,!1):this.compareNode(t)==Pe},containsNodeContents:function(t){return this.comparePoint(t,0)>=0&&this.comparePoint(t,K(t))<=0},containsRange:function(t){var n=this.intersection(t);return n!==null&&t.equals(n)},containsNodeText:function(t){var n=this.cloneRange();n.selectNode(t);var o=n.getNodes([3]);if(o.length>0){n.setStart(o[0],0);var d=o.pop();return n.setEnd(d,d.length),this.containsRange(n)}else return this.containsNodeContents(t)},getNodes:function(t,n){return V(this),S(this,t,n)},getDocument:function(){return C(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(t){var n=C(this),o=i.createRange(n);t=t||c.getBody(n),o.selectNodeContents(t);var d=this.intersection(o),N=0,I=0;return d&&(o.setEnd(d.startContainer,d.startOffset),N=o.toString().length,I=N+d.toString().length),{start:N,end:I,containerNode:t}},moveToBookmark:function(t){var n=t.containerNode,o=0;this.setStart(n,0),this.collapse(!0);for(var d=[n],N,I=!1,f=!1,m,y,x;!f&&(N=d.pop());)if(N.nodeType==3)m=o+N.length,!I&&t.start>=o&&t.start<=m&&(this.setStart(N,t.start-o),I=!0),I&&t.end>=o&&t.end<=m&&(this.setEnd(N,t.end-o),f=!0),o=m;else for(x=N.childNodes,y=x.length;y--;)d.push(x[y])},getName:function(){return"DomRange"},equals:function(t){return $.rangesEqual(this,t)},isValid:function(){return we(this)},inspect:function(){return b(this)},detach:function(){}});function e(t){t.START_TO_START=Ie,t.START_TO_END=Te,t.END_TO_END=Ge,t.END_TO_START=ye,t.NODE_BEFORE=Oe,t.NODE_AFTER=We,t.NODE_BEFORE_AND_AFTER=Fe,t.NODE_INSIDE=Pe}function r(t){e(t),e(t.prototype)}function s(t,n){return function(){V(this);var o=this.startContainer,d=this.startOffset,N=this.commonAncestorContainer,I=new U(this,!0),f,m;o!==N&&(f=ae(o,N,!0),m=H(f),o=m.node,d=m.offset),L(I,ve),I.reset();var y=t(I);return I.detach(),n(this,o,d,o,d),y}}function g(t,n){function o(f,m){return function(y){X(y,j),X(G(y),ge);var x=(f?q:H)(y);(m?d:N)(this,x.node,x.offset)}}function d(f,m,y){var x=f.endContainer,ce=f.endOffset;(m!==f.startContainer||y!==f.startOffset)&&((G(m)!=G(x)||z(m,y,x,ce)==1)&&(x=m,ce=y),n(f,m,y,x,ce))}function N(f,m,y){var x=f.startContainer,ce=f.startOffset;(m!==f.endContainer||y!==f.endOffset)&&((G(m)!=G(x)||z(m,y,x,ce)==-1)&&(x=m,ce=y),n(f,x,ce,m,y))}var I=function(){};I.prototype=i.rangePrototype,t.prototype=new I,p.extend(t.prototype,{setStart:function(f,m){E(f,!0),k(f,m),d(this,f,m)},setEnd:function(f,m){E(f,!0),k(f,m),N(this,f,m)},setStartAndEnd:function(){var f=arguments,m=f[0],y=f[1],x=m,ce=y;switch(f.length){case 3:ce=f[2];break;case 4:x=f[2],ce=f[3];break}E(m,!0),k(m,y),E(x,!0),k(x,ce),n(this,m,y,x,ce)},setBoundary:function(f,m,y){this["set"+(y?"Start":"End")](f,m)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(f){V(this),f?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(f){E(f,!0),n(this,f,0,f,K(f))},selectNode:function(f){E(f,!1),X(f,j);var m=q(f),y=H(f);n(this,m.node,m.offset,y.node,y.offset)},extractContents:s(v,n),deleteContents:s(he,n),canSurroundContents:function(){V(this),ve(this.startContainer),ve(this.endContainer);var f=new U(this,!0),m=f._first&&B(f._first,this)||f._last&&B(f._last,this);return f.detach(),!m},splitBoundaries:function(){Ae(this)},splitBoundariesPreservingPositions:function(f){Ae(this,f)},normalizeBoundaries:function(){V(this);var f=this.startContainer,m=this.startOffset,y=this.endContainer,x=this.endOffset,ce=function(le){var Re=le.nextSibling;Re&&Re.nodeType==le.nodeType&&(y=le,x=le.length,le.appendData(Re.data),l(Re))},vt=function(le){var Re=le.previousSibling;if(Re&&Re.nodeType==le.nodeType){f=le;var Ot=le.length;if(m=Re.length,le.insertData(0,Re.data),l(Re),f==y)x+=m,y=f;else if(y==le.parentNode){var pt=Q(le);x==pt?(y=le,x=Ot):x>pt&&x--}}},$e=!0,pe;if(w(y))x==y.length?ce(y):x==0&&(pe=y.previousSibling,pe&&pe.nodeType==y.nodeType&&(x=pe.length,f==y&&($e=!1),pe.appendData(y.data),l(y),y=pe));else{if(x>0){var Je=y.childNodes[x-1];Je&&w(Je)&&ce(Je)}$e=!this.collapsed}if($e){if(w(f))m==0?vt(f):m==f.length&&(pe=f.nextSibling,pe&&pe.nodeType==f.nodeType&&(y==pe&&(y=f,x+=f.length),f.appendData(pe.data),l(pe)));else if(m<f.childNodes.length){var et=f.childNodes[m];et&&w(et)&&vt(et)}}else f=y,m=x;n(this,f,m,y,x)},collapseToPoint:function(f,m){E(f,!0),k(f,m),this.setStartAndEnd(f,m)},parentElement:function(){V(this);var f=this.commonAncestorContainer;return f?O(this.commonAncestorContainer,!0):null}}),r(t)}function T(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:c.getCommonAncestor(t.startContainer,t.endContainer)}function M(t,n,o,d,N){t.startContainer=n,t.startOffset=o,t.endContainer=d,t.endOffset=N,t.document=c.getDocument(n),T(t)}function $(t){M(this,t,0,t,0)}g($,M),p.extend($,{rangeProperties:xe,RangeIterator:U,copyComparisonConstants:r,createPrototypeRange:g,inspect:b,toHtml:A,getRangeDocument:C,rangesEqual:function(t,n){return t.startContainer===n.startContainer&&t.startOffset===n.startOffset&&t.endContainer===n.endContainer&&t.endOffset===n.endOffset}}),i.DomRange=$}),P.createCoreModule("WrappedRange",["DomRange"],function(i,u){var c,p,R=i.dom,D=i.util,w=R.DomPosition,Q=i.DomRange,Z=R.getBody,J=R.getContentDocument,z=R.isCharacterDataNode;if(i.features.implementsDomRange&&function(){var l,B=Q.rangeProperties;function C(v){for(var S=B.length,b;S--;)b=B[S],v[b]=v.nativeRange[b];v.collapsed=v.startContainer===v.endContainer&&v.startOffset===v.endOffset}function W(v,S,b,U,j){var ge=v.startContainer!==S||v.startOffset!=b,oe=v.endContainer!==U||v.endOffset!=j,ee=!v.equals(v.nativeRange);(ge||oe||ee)&&(v.setEnd(U,j),v.setStart(S,b))}var q;c=function(v){if(!v)throw u.createError("WrappedRange: Range must be specified");this.nativeRange=v,C(this)},Q.createPrototypeRange(c,W),l=c.prototype,l.selectNode=function(v){this.nativeRange.selectNode(v),C(this)},l.cloneContents=function(){return this.nativeRange.cloneContents()},l.surroundContents=function(v){this.nativeRange.surroundContents(v),C(this)},l.collapse=function(v){this.nativeRange.collapse(v),C(this)},l.cloneRange=function(){return new c(this.nativeRange.cloneRange())},l.refresh=function(){C(this)},l.toString=function(){return this.nativeRange.toString()};var H=document.createTextNode("test");Z(document).appendChild(H);var _=document.createRange();_.setStart(H,0),_.setEnd(H,0);try{_.setStart(H,1),l.setStart=function(v,S){this.nativeRange.setStart(v,S),C(this)},l.setEnd=function(v,S){this.nativeRange.setEnd(v,S),C(this)},q=function(v){return function(S){this.nativeRange[v](S),C(this)}}}catch{l.setStart=function(S,b){try{this.nativeRange.setStart(S,b)}catch{this.nativeRange.setEnd(S,b),this.nativeRange.setStart(S,b)}C(this)},l.setEnd=function(S,b){try{this.nativeRange.setEnd(S,b)}catch{this.nativeRange.setStart(S,b),this.nativeRange.setEnd(S,b)}C(this)},q=function(S,b){return function(U){try{this.nativeRange[S](U)}catch{this.nativeRange[b](U),this.nativeRange[S](U)}C(this)}}}l.setStartBefore=q("setStartBefore","setEndBefore"),l.setStartAfter=q("setStartAfter","setEndAfter"),l.setEndBefore=q("setEndBefore","setStartBefore"),l.setEndAfter=q("setEndAfter","setStartAfter"),l.selectNodeContents=function(v){this.setStartAndEnd(v,0,R.getNodeLength(v))},_.selectNodeContents(H),_.setEnd(H,3);var Y=document.createRange();Y.selectNodeContents(H),Y.setEnd(H,4),Y.setStart(H,2),_.compareBoundaryPoints(_.START_TO_END,Y)==-1&&_.compareBoundaryPoints(_.END_TO_START,Y)==1?l.compareBoundaryPoints=function(v,S){return S=S.nativeRange||S,v==S.START_TO_END?v=S.END_TO_START:v==S.END_TO_START&&(v=S.START_TO_END),this.nativeRange.compareBoundaryPoints(v,S)}:l.compareBoundaryPoints=function(v,S){return this.nativeRange.compareBoundaryPoints(v,S.nativeRange||S)};var F=document.createElement("div");F.innerHTML="123";var L=F.firstChild,he=Z(document);he.appendChild(F),_.setStart(L,1),_.setEnd(L,2),_.deleteContents(),L.data=="13"&&(l.deleteContents=function(){this.nativeRange.deleteContents(),C(this)},l.extractContents=function(){var v=this.nativeRange.extractContents();return C(this),v}),he.removeChild(F),he=null,D.isHostMethod(_,"createContextualFragment")&&(l.createContextualFragment=function(v){return this.nativeRange.createContextualFragment(v)}),Z(document).removeChild(H),l.getName=function(){return"WrappedRange"},i.WrappedRange=c,i.createNativeRange=function(v){return v=J(v,u,"createNativeRange"),v.createRange()}}(),i.features.implementsTextRange){var de=function(l){var B=l.parentElement(),C=l.duplicate();C.collapse(!0);var W=C.parentElement();C=l.duplicate(),C.collapse(!1);var q=C.parentElement(),H=W==q?W:R.getCommonAncestor(W,q);return H==B?H:R.getCommonAncestor(B,H)},ae=function(l){return l.compareEndPoints("StartToEnd",l)==0},K=function(l,B,C,W,q){var H=l.duplicate();H.collapse(C);var _=H.parentElement();if(R.isOrIsAncestorOf(B,_)||(_=B),!_.canHaveHTML){var Y=new w(_.parentNode,R.getNodeIndex(_));return{boundaryPosition:Y,nodeInfo:{nodeIndex:Y.offset,containerElement:Y.node}}}var F=R.getDocument(_).createElement("span");F.parentNode&&R.removeNode(F);for(var L,he=C?"StartToStart":"StartToEnd",v,S,b,U,j=q&&q.containerElement==_?q.nodeIndex:0,ge=_.childNodes.length,oe=ge,ee=oe;ee==ge?_.appendChild(F):_.insertBefore(F,_.childNodes[ee]),H.moveToElementText(F),L=H.compareEndPoints(he,l),!(L==0||j==oe);){if(L==-1){if(oe==j+1)break;j=ee}else oe=oe==j+1?j:ee;ee=Math.floor((j+oe)/2),_.removeChild(F)}if(U=F.nextSibling,L==-1&&U&&z(U)){H.setEndPoint(C?"EndToStart":"EndToEnd",l);var te;if(/[\r\n]/.test(U.data)){var re=H.duplicate(),ue=re.text.replace(/\r\n/g,"\r").length;for(te=re.moveStart("character",ue);(L=re.compareEndPoints("StartToEnd",re))==-1;)te++,re.moveStart("character",1)}else te=H.text.length;b=new w(U,te)}else v=(W||!C)&&F.previousSibling,S=(W||C)&&F.nextSibling,S&&z(S)?b=new w(S,0):v&&z(v)?b=new w(v,v.data.length):b=new w(_,R.getNodeIndex(F));return R.removeNode(F),{boundaryPosition:b,nodeInfo:{nodeIndex:ee,containerElement:_}}},ne=function(l,B){var C,W,q=l.offset,H=R.getDocument(l.node),_,Y,F=Z(H).createTextRange(),L=z(l.node);return L?(C=l.node,W=C.parentNode):(Y=l.node.childNodes,C=q<Y.length?Y[q]:null,W=l.node),_=H.createElement("span"),_.innerHTML="&#feff;",C?W.insertBefore(_,C):W.appendChild(_),F.moveToElementText(_),F.collapse(!B),W.removeChild(_),L&&F[B?"moveStart":"moveEnd"]("character",q),F};p=function(l){this.textRange=l,this.refresh()},p.prototype=new Q(document),p.prototype.refresh=function(){var l,B,C,W=de(this.textRange);ae(this.textRange)?B=l=K(this.textRange,W,!0,!0).boundaryPosition:(C=K(this.textRange,W,!0,!1),l=C.boundaryPosition,B=K(this.textRange,W,!1,!1,C.nodeInfo).boundaryPosition),this.setStart(l.node,l.offset),this.setEnd(B.node,B.offset)},p.prototype.getName=function(){return"WrappedTextRange"},Q.copyComparisonConstants(p);var G=function(l){if(l.collapsed)return ne(new w(l.startContainer,l.startOffset),!0);var B=ne(new w(l.startContainer,l.startOffset),!0),C=ne(new w(l.endContainer,l.endOffset),!1),W=Z(Q.getRangeDocument(l)).createTextRange();return W.setEndPoint("StartToStart",B),W.setEndPoint("EndToEnd",C),W};if(p.rangeToTextRange=G,p.prototype.toTextRange=function(){return G(this)},i.WrappedTextRange=p,!i.features.implementsDomRange||i.config.preferTextRange){var fe=function(l){return l("return this;")()}(Function);typeof fe.Range>"u"&&(fe.Range=p),i.createNativeRange=function(l){return l=J(l,u,"createNativeRange"),Z(l).createTextRange()},i.WrappedRange=p}}i.createRange=function(l){return l=J(l,u,"createRange"),new i.WrappedRange(i.createNativeRange(l))},i.createRangyRange=function(l){return l=J(l,u,"createRangyRange"),new Q(l)},D.createAliasForDeprecatedMethod(i,"createIframeRange","createRange"),D.createAliasForDeprecatedMethod(i,"createIframeRangyRange","createRangyRange"),i.addShimListener(function(l){var B=l.document;typeof B.createRange>"u"&&(B.createRange=function(){return i.createRange(B)}),B=l=null})}),P.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(i,u){i.config.checkSelectionRanges=!0;var c="boolean",p="number",R=i.dom,D=i.util,w=D.isHostMethod,Q=i.DomRange,Z=i.WrappedRange,J=i.DOMException,z=R.DomPosition,de,ae,K=i.features,ne="Control",G=R.getDocument,fe=R.getBody,l=Q.rangesEqual;function B(e){return typeof e=="string"?/^backward(s)?$/i.test(e):!!e}function C(e,r){if(e){if(R.isWindow(e))return e;if(e instanceof V)return e.win;var s=R.getContentDocument(e,u,r);return R.getWindow(s)}else return window}function W(e){return C(e,"getWinSelection").getSelection()}function q(e){return C(e,"getDocSelection").document.selection}function H(e){var r=!1;return e.anchorNode&&(r=R.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1),r}var _=w(window,"getSelection"),Y=D.isHostObject(document,"selection");K.implementsWinGetSelection=_,K.implementsDocSelection=Y;var F=Y&&(!_||i.config.preferTextRange);if(F)de=q,i.isSelectionValid=function(e){var r=C(e,"isSelectionValid").document,s=r.selection;return s.type!="None"||G(s.createRange().parentElement())==r};else if(_)de=W,i.isSelectionValid=function(){return!0};else return u.fail("Neither document.selection or window.getSelection() detected."),!1;i.getNativeSelection=de;var L=de();if(!L)return u.fail("Native selection was null (possibly issue 138?)"),!1;var he=i.createNativeRange(document),v=fe(document),S=D.areHostProperties(L,["anchorNode","focusNode","anchorOffset","focusOffset"]);K.selectionHasAnchorAndFocus=S;var b=w(L,"extend");K.selectionHasExtend=b;var U=w(L,"setBaseAndExtent");K.selectionHasSetBaseAndExtent=U;var j=typeof L.rangeCount==p;K.selectionHasRangeCount=j;var ge=!1,oe=!0,ee=b?function(e,r){var s=Q.getRangeDocument(r),g=i.createRange(s);g.collapseToPoint(r.endContainer,r.endOffset),e.addRange(E(g)),e.extend(r.startContainer,r.startOffset)}:null;D.areHostMethods(L,["addRange","getRangeAt","removeAllRanges"])&&typeof L.rangeCount==p&&K.implementsDomRange&&function(){var e=window.getSelection();if(e&&!tt){for(var r=e.rangeCount,s=r>1,g=[],T=H(e),M=0;M<r;++M)g[M]=e.getRangeAt(M);var $=R.createTestElement(document,"",!1),t=$.appendChild(document.createTextNode("\xA0\xA0\xA0")),n=document.createRange();if(n.setStart(t,1),n.collapse(!0),e.removeAllRanges(),e.addRange(n),oe=e.rangeCount==1,e.removeAllRanges(),!s){var o=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(o&&parseInt(o[1])>=36)ge=!1;else{var d=n.cloneRange();n.setStart(t,0),d.setEnd(t,3),d.setStart(t,2),e.addRange(n),e.addRange(d),ge=e.rangeCount==2}}for(R.removeNode($),e.removeAllRanges(),M=0;M<r;++M)M==0&&T?ee?ee(e,g[M]):(i.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(g[M])):e.addRange(g[M])}}(),K.selectionSupportsMultipleRanges=ge,K.collapsedNonEditableSelectionsSupported=oe;var te=!1,re;v&&w(v,"createControlRange")&&(re=v.createControlRange(),D.areHostProperties(re,["item","add"])&&(te=!0)),K.implementsControlRange=te,S?ae=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:ae=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};function ue(e,r,s){var g=s?"end":"start",T=s?"start":"end";e.anchorNode=r[g+"Container"],e.anchorOffset=r[g+"Offset"],e.focusNode=r[T+"Container"],e.focusOffset=r[T+"Offset"]}function a(e){var r=e.nativeSelection;e.anchorNode=r.anchorNode,e.anchorOffset=r.anchorOffset,e.focusNode=r.focusNode,e.focusOffset=r.focusOffset}function h(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0,O(e)}function O(e){e.type=e.rangeCount==0?"None":ae(e)?"Caret":"Range"}function E(e){var r;return e instanceof Q?(r=i.createNativeRange(e.getDocument()),r.setEnd(e.endContainer,e.endOffset),r.setStart(e.startContainer,e.startOffset)):e instanceof Z?r=e.nativeRange:K.implementsDomRange&&e instanceof R.getWindow(e.startContainer).Range&&(r=e),r}function X(e){if(!e.length||e[0].nodeType!=1)return!1;for(var r=1,s=e.length;r<s;++r)if(!R.isAncestorOf(e[0],e[r]))return!1;return!0}function k(e){var r=e.getNodes();if(!X(r))throw u.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return r[0]}function me(e){return!!e&&typeof e.text<"u"}function ve(e,r){var s=new Z(r);e._ranges=[s],ue(e,s,!1),e.rangeCount=1,e.isCollapsed=s.collapsed,O(e)}function se(e){if(e._ranges.length=0,e.docSelection.type=="None")h(e);else{var r=e.docSelection.createRange();if(me(r))ve(e,r);else{e.rangeCount=r.length;for(var s,g=G(r.item(0)),T=0;T<e.rangeCount;++T)s=i.createRange(g),s.selectNode(r.item(T)),e._ranges.push(s);e.isCollapsed=e.rangeCount==1&&e._ranges[0].collapsed,ue(e,e._ranges[e.rangeCount-1],!1),O(e)}}}function be(e,r){for(var s=e.docSelection.createRange(),g=k(r),T=G(s.item(0)),M=fe(T).createControlRange(),$=0,t=s.length;$<t;++$)M.add(s.item($));try{M.add(g)}catch{throw u.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}M.select(),se(e)}var we;w(L,"getRangeAt")?we=function(e,r){try{return e.getRangeAt(r)}catch{return null}}:S&&(we=function(e){var r=G(e.anchorNode),s=i.createRange(r);return s.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),s.collapsed!==this.isCollapsed&&s.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),s});function V(e,r,s){this.nativeSelection=e,this.docSelection=r,this._ranges=[],this.win=s,this.refresh()}V.prototype=i.selectionPrototype;function Me(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0,O(e)}var Ce=[];function Le(e,r){for(var s=Ce.length,g,T;s--;)if(g=Ce[s],T=g.selection,r=="deleteAll")Me(T);else if(g.win==e)return r=="delete"?(Ce.splice(s,1),!0):T;return r=="deleteAll"&&(Ce.length=0),null}var Ae=function(e){if(e&&e instanceof V)return e.refresh(),e;e=C(e,"getNativeSelection");var r=Le(e),s=de(e),g=Y?q(e):null;return r?(r.nativeSelection=s,r.docSelection=g,r.refresh()):(r=new V(s,g,e),Ce.push({win:e,selection:r})),r};i.getSelection=Ae,D.createAliasForDeprecatedMethod(i,"getIframeSelection","getSelection");var A=V.prototype;function xe(e,r){for(var s=G(r[0].startContainer),g=fe(s).createControlRange(),T=0,M,$=r.length;T<$;++T){M=k(r[T]);try{g.add(M)}catch{throw u.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}g.select(),se(e)}if(!F&&S&&D.areHostMethods(L,["removeAllRanges","addRange"])){A.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),h(this)};var Ie=function(e,r){ee(e.nativeSelection,r),e.refresh()};j?A.addRange=function(e,r){if(te&&Y&&this.docSelection.type==ne)be(this,e);else if(B(r)&&b)Ie(this,e);else{var s;ge?s=this.rangeCount:(this.removeAllRanges(),s=0);var g=E(e).cloneRange();try{this.nativeSelection.addRange(g)}catch{}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==s+1){if(i.config.checkSelectionRanges){var T=we(this.nativeSelection,this.rangeCount-1);T&&!l(T,e)&&(e=new Z(T))}this._ranges[this.rangeCount-1]=e,ue(this,e,ye(this.nativeSelection)),this.isCollapsed=ae(this),O(this)}else this.refresh()}}:A.addRange=function(e,r){B(r)&&b?Ie(this,e):(this.nativeSelection.addRange(E(e)),this.refresh())},A.setRanges=function(e){if(te&&Y&&e.length>1)xe(this,e);else{this.removeAllRanges();for(var r=0,s=e.length;r<s;++r)this.addRange(e[r])}}}else if(w(L,"empty")&&w(he,"select")&&te&&F)A.removeAllRanges=function(){try{if(this.docSelection.empty(),this.docSelection.type!="None"){var e;if(this.anchorNode)e=G(this.anchorNode);else if(this.docSelection.type==ne){var r=this.docSelection.createRange();r.length&&(e=G(r.item(0)))}if(e){var s=fe(e).createTextRange();s.select(),this.docSelection.empty()}}}catch{}h(this)},A.addRange=function(e){this.docSelection.type==ne?be(this,e):(i.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,ue(this,e,!1),O(this))},A.setRanges=function(e){this.removeAllRanges();var r=e.length;r>1?xe(this,e):r&&this.addRange(e[0])};else return u.fail("No means of selecting a Range or TextRange was found"),!1;A.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new J("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var Te;if(F)Te=function(e){var r;i.isSelectionValid(e.win)?r=e.docSelection.createRange():(r=fe(e.win.document).createTextRange(),r.collapse(!0)),e.docSelection.type==ne?se(e):me(r)?ve(e,r):h(e)};else if(w(L,"getRangeAt")&&typeof L.rangeCount==p)Te=function(e){if(te&&Y&&e.docSelection.type==ne)se(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var r=0,s=e.rangeCount;r<s;++r)e._ranges[r]=new i.WrappedRange(e.nativeSelection.getRangeAt(r));ue(e,e._ranges[e.rangeCount-1],ye(e.nativeSelection)),e.isCollapsed=ae(e),O(e)}else h(e)};else if(S&&typeof L.isCollapsed==c&&typeof he.collapsed==c&&K.implementsDomRange)Te=function(e){var r,s=e.nativeSelection;s.anchorNode?(r=we(s,0),e._ranges=[r],e.rangeCount=1,a(e),e.isCollapsed=ae(e),O(e)):h(e)};else return u.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;A.refresh=function(e){var r=e?this._ranges.slice(0):null,s=this.anchorNode,g=this.anchorOffset;if(Te(this),e){var T=r.length;if(T!=this._ranges.length||this.anchorNode!=s||this.anchorOffset!=g)return!0;for(;T--;)if(!l(r[T],this._ranges[T]))return!0;return!1}};var Ge=function(e,r){var s=e.getAllRanges();e.removeAllRanges();for(var g=0,T=s.length;g<T;++g)l(r,s[g])||e.addRange(s[g]);e.rangeCount||h(e)};te&&Y?A.removeRange=function(e){if(this.docSelection.type==ne){for(var r=this.docSelection.createRange(),s=k(e),g=G(r.item(0)),T=fe(g).createControlRange(),M,$=!1,t=0,n=r.length;t<n;++t)M=r.item(t),M!==s||$?T.add(r.item(t)):$=!0;T.select(),se(this)}else Ge(this,e)}:A.removeRange=function(e){Ge(this,e)};var ye;!F&&S&&K.implementsDomRange?(ye=H,A.isBackward=function(){return ye(this)}):ye=A.isBackward=function(){return!1},A.isBackwards=A.isBackward,A.toString=function(){for(var e=[],r=0,s=this.rangeCount;r<s;++r)e[r]=""+this._ranges[r];return e.join("")};function Oe(e,r){if(e.win.document!=G(r))throw new J("WRONG_DOCUMENT_ERR")}function We(e,r){if(r<0||r>(R.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new J("INDEX_SIZE_ERR")}A.collapse=function(e,r){Oe(this,e);var s=i.createRange(e);s.collapseToPoint(e,r),this.setSingleRange(s),this.isCollapsed=!0},A.collapseToStart=function(){if(this.rangeCount){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)}else throw new J("INVALID_STATE_ERR")},A.collapseToEnd=function(){if(this.rangeCount){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)}else throw new J("INVALID_STATE_ERR")},A.selectAllChildren=function(e){Oe(this,e);var r=i.createRange(e);r.selectNodeContents(e),this.setSingleRange(r)},U?A.setBaseAndExtent=function(e,r,s,g){this.nativeSelection.setBaseAndExtent(e,r,s,g),this.refresh()}:b&&(A.setBaseAndExtent=function(e,r,s,g){We(e,r),We(s,g),Oe(this,e),Oe(this,s);var T=i.createRange(node),M=R.comparePoints(e,r,s,g)==-1;M?T.setStartAndEnd(s,g,e,r):T.setStartAndEnd(e,r,s,g),this.setSingleRange(T,M)}),A.deleteFromDocument=function(){if(te&&Y&&this.docSelection.type==ne){for(var e=this.docSelection.createRange(),r;e.length;)r=e.item(0),e.remove(r),R.removeNode(r);this.refresh()}else if(this.rangeCount){var s=this.getAllRanges();if(s.length){this.removeAllRanges();for(var g=0,T=s.length;g<T;++g)s[g].deleteContents();this.addRange(s[T-1])}}},A.eachRange=function(e,r){for(var s=0,g=this._ranges.length;s<g;++s)if(e(this.getRangeAt(s)))return r},A.getAllRanges=function(){var e=[];return this.eachRange(function(r){e.push(r)}),e},A.setSingleRange=function(e,r){this.removeAllRanges(),this.addRange(e,r)},A.callMethodOnEachRange=function(e,r){var s=[];return this.eachRange(function(g){s.push(g[e].apply(g,r||[]))}),s};function Fe(e){return function(r,s){var g;this.rangeCount?(g=this.getRangeAt(0),g["set"+(e?"Start":"End")](r,s)):(g=i.createRange(this.win.document),g.setStartAndEnd(r,s)),this.setSingleRange(g,this.isBackward())}}A.setStart=Fe(!0),A.setEnd=Fe(!1),i.rangePrototype.select=function(e){Ae(this.getDocument()).setSingleRange(this,e)},A.changeEachRange=function(e){var r=[],s=this.isBackward();this.eachRange(function(g){e(g),r.push(g)}),this.removeAllRanges(),s&&r.length==1?this.addRange(r[0],"backward"):this.setRanges(r)},A.containsNode=function(e,r){return this.eachRange(function(s){return s.containsNode(e,r)},!0)||!1},A.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},A.moveToBookmark=function(e){for(var r=[],s=0,g,T;g=e.rangeBookmarks[s++];)T=i.createRange(this.win),T.moveToBookmark(g),r.push(T);e.backward?this.setSingleRange(r[0],"backward"):this.setRanges(r)},A.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},A.restoreRanges=function(e){this.removeAllRanges();for(var r=0,s;s=e.ranges[r];++r)this.addRange(s,e.backward&&r==0)},A.toHtml=function(){var e=[];return this.eachRange(function(r){e.push(Q.toHtml(r))}),e.join("")},K.implementsTextRange&&(A.getNativeTextRange=function(){var e,r;if(e=this.docSelection){var s=e.createRange();if(me(s))return s;throw u.createError("getNativeTextRange: selection is a control selection")}else{if(this.rangeCount>0)return i.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw u.createError("getNativeTextRange: selection contains no range")}});function Pe(e){var r=[],s=new z(e.anchorNode,e.anchorOffset),g=new z(e.focusNode,e.focusOffset),T=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount<"u")for(var M=0,$=e.rangeCount;M<$;++M)r[M]=Q.inspect(e.getRangeAt(M));return"["+T+"(Ranges: "+r.join(", ")+")(anchor: "+s.inspect()+", focus: "+g.inspect()+"]"}A.getName=function(){return"WrappedSelection"},A.inspect=function(){return Pe(this)},A.detach=function(){Le(this.win,"delete"),Me(this)},V.detachAll=function(){Le(null,"deleteAll")},V.inspect=Pe,V.isDirectionBackward=B,i.Selection=V,i.selectionPrototype=A,i.addShimListener(function(e){typeof e.getSelection>"u"&&(e.getSelection=function(){return Ae(e)}),e=null})});var gt=!1,je=function(i){gt||(gt=!0,!P.initialized&&P.config.autoInitialize&&Xe())};return Ee&&(document.readyState=="complete"?je():(Ne(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",je,!1),ze(window,"load",je))),P},nt)});export{At as a};
