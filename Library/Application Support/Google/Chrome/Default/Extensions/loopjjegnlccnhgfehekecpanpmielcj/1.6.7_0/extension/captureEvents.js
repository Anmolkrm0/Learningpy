var idAttr=document.querySelector(".id"),classAttr=document.querySelector(".class"),nameAttr=document.querySelector(".name"),placeholder=document.querySelector(".placeholder"),textXpath=document.querySelector(".textXpath"),checkboxes=document.querySelectorAll(".chooseAttr"),tablePlaceholder=document.querySelector(".tablePlaceholder"),copyAllSteps=document.querySelector(".copyAllButton"),copyAllData=document.querySelector(".copyAllData"),copyAllExpRes=document.querySelector(".copyAllExpRes"),copyAllXpath=
document.querySelector(".copyAllXpath"),copyAllCss=document.querySelector(".copyAllCss"),fileName=document.querySelector("#downloadFileName input"),recordButton=document.getElementById("record"),recordIcon=document.getElementById("recordIcon"),element=document.getElementById("records-grid"),helperText=document.getElementById("helperText"),save_btn=document.getElementById("save_btn"),toggleElement=document.getElementById("inputToggle"),xpathInput=document.getElementById("xpathInput"),clearTestCase=
document.getElementById("clearTestCase"),alwaysTop=document.getElementById("alwaysTop"),pauseBtnToolTip=document.querySelector(".pauseBtn.toolTip"),toggleToolTip=document.querySelector(".toggle.toolTip");let platform="";var email=document.getElementById("email"),pass=document.getElementById("password"),company=document.getElementById("company"),registerBtn=document.getElementById("submit_btn"),spanLogin=document.getElementById("login");let authenticated=!1;var screenToggler=document.getElementById("screenshotToggle");
screenToggler.classList.add("active");screenToggler.classList.remove("inactive");let screenshootEnabled=!0,screenDataColumnChecked=!0,isthereAnImage=!1,actualImage,stepsArray=[];var OS=window.navigator.userAgent.includes("Mac")?"mac":"windows";let imagesArray=[],limitReached=!1,countryName=null;if(Intl){let a=Intl.DateTimeFormat().resolvedOptions().timeZone.split("/");countryName=COUNTRIES[a[a.length-1]]}
var isOpera=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),isFirefox="undefined"!==typeof InstallTrigger,isSafari=/constructor/i.test(window.HTMLElement)||function(a){return"[object SafariRemoteNotification]"===a.toString()}(!window.safari||"undefined"!==typeof safari&&safari.pushNotification),isEdge=-1<window.navigator.userAgent.indexOf("Edg/")?!0:!1,isChrome=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime),reviewLink=document.querySelector(".review-link"),
browserType=chrome,modal=document.getElementById("myModal"),modalImg=document.getElementById("img01");isChrome&&(platform="chrome");isFirefox&&(reviewLink.setAttribute("href","https://addons.mozilla.org/en-US/firefox/addon/testcase-studio/"),browserType=chrome,platform="firefox");isOpera&&(reviewLink.setAttribute("href","https://addons.opera.com/en-gb/extensions/details/testcase-studio/"),platform="opera");isEdge&&(platform="edge",reviewLink.setAttribute("href","https://microsoftedge.microsoft.com/addons/detail/testcase-studio/jdglgpgchkgiciogpolofelfdfkdgfcg"));
const API_URL="https://shubads.testcasehub.net/",EXT_ID="3",TOP_EXT_ID="11",OFFER_EXT_ID="https://shubads.testcasehub.net/"===API_URL?13:7;var recording=!0,steps=[],xpathText="",senderId="",attrArr="[, withid,withclass,withname,withplaceholder,withtext]",interval=null,userEmail="Anonymous";let systemInfoContainer=document.querySelector("#system-information th"),systemInfoCopyBtn=document.querySelector(".copy-sys-info"),timezone="UTC",now="";const monthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");
function displaySystemInformation(){now=new Date;timezone=now.toLocaleDateString(void 0,{day:"2-digit",timeZoneName:"short"}).substring(4);systemInfoContainer.innerHTML+=`<span>OS: </span> ${sys.os.family||""} ${sys.os.version||""} <span class="dividor">|</span> <span>Browser: </span> ${sys.name||""} ${sys.version.split(".")[0]||""} <span class="dividor">|</span> <span>Resolution: </span> ${window.screen.availWidth}x${window.screen.availHeight} <span class="dividor">|</span> <span>Time: </span> ${now.getDate()} ${monthNames[now.getMonth()]} ${now.getFullYear()} / ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}  ${timezone}`}
displaySystemInformation();
systemInfoCopyBtn.addEventListener("click",()=>{navigator.clipboard.writeText(`OS: ${sys.os.family||""} ${sys.os.version||""} | Browser: ${sys.name||""} ${sys.version.split(".")[0]||""} | Resolution: ${window.screen.availWidth}x${window.screen.availHeight} | Time: ${now.getDate()} ${monthNames[now.getMonth()]} ${now.getFullYear()} / ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}  ${timezone}`);systemInfoCopyBtn.children[0].classList.remove("hideElement");setTimeout(()=>{systemInfoCopyBtn.children[0].classList.add("hideElement")},
300)});let queue=[];
const newStep=(a,b)=>{screenshootEnabled&&0!==a.data.indexOf("Press Enter")?chrome.runtime.sendMessage({message:"take screenshoot"},c=>{queue.forEach(d=>{0!==d.data.indexOf("Press Enter")?(steps.length||steps.push({step:"Open website",relXpath:"",relCss:"",dataText:d.URL,planeLabel:d.URL,passwordValue:"",expRes:"",screenImage:c.imgSrc}),steps.push({step:d.data,relXpath:d.relXpath,relCss:d.relCss,dataText:d.dataText,passwordValue:d.passwordValue,planeLabel:d.planeLabel,expRes:"",screenImage:c.imgSrc})):
(steps.length||steps.push({step:"Open website",relXpath:"",relCss:"",dataText:d.URL,passwordValue:"",planeLabel:d.URL,expRes:""}),steps.push({step:d.data,relXpath:d.relXpath,relCss:d.relCss,dataText:d.dataText,passwordValue:d.passwordValue,planeLabel:d.planeLabel,expRes:""}));authenticated&&displayRows();b({msg:"done"})});queue=[]}):queue[0]===a&&(steps.length||steps.push({step:"Open website",relXpath:"",relCss:"",dataText:a.URL,passwordValue:"",planeLabel:a.URL,expRes:""}),steps.push({step:a.data,
relXpath:a.relXpath,relCss:a.relCss,dataText:a.dataText,passwordValue:a.passwordValue,planeLabel:a.planeLabel,expRes:""}),authenticated&&displayRows(),b({msg:"done"}),queue.shift())};
chrome.runtime.onMessage.addListener(async function(a,b,c){senderId=b.tab&&b.tab.id;a&&"windowEvent"===a.type&&recording&&"Click on aTag"!==a.data&&(queue.push(a),browserType.storage.local.get(["screenDataColumn"],function(d){"checked"==d.screenDataColumn&&(screenDataColumnChecked=!0)}),newStep(a,c));a&&"recorderAttr"===a.type&&setAttr(a.data);a&&"verification"===a.type&&recording&&senderId&&browserType.tabs.sendMessage(senderId,{openStudio:!0})});
var dataDisplay,expResultDisplay,xpathDisplay,cssDisplay="";function safeDisplay(a){a=a.replace(/</,"&lt;");a=a.replace(/>/,"&gt;");a=a.replace("/","&#x2F;");a=a.replace("[","&#91;");a=a.replace("]","&#93;");return a=a.replace("'","&#39;")}
function displayRows(){element.innerHTML=null;document.querySelector(".tablePlaceholder").style.display="none";var a=!!toggleElement.classList.contains("active");dataDisplay=dataColumnCheckbox.checked?"":"dataDisplay";expResultDisplay=expResultColumnCheckbox.checked?"":"expResultDisplay";xpathDisplay=xpathColumnCheckbox.checked?"":"xpathDisplay";cssDisplay=cssSelectorColumnCheckbox.checked?"":"cssDisplay";if(steps&&steps.length){50!=steps.length||limitReached||(chrome.runtime.sendMessage({message:"limit reached"}),
limitReached=!0);command="";cssCommand="";if(a&&xpathInput.value&&xpathInput.value.toLowerCase().includes("xpathvalue"))for(let c=0;c<steps.length;c++){var b=cssCommand=a=command="";let d=!1;steps[c].relXpath&&steps[c].relXpath.length&&(command=xpathInput.value.replace(/xpathvalue/i,steps[c].relXpath),a=xpathInput.value.replace(/xpathvalue/i,`${steps[c].relXpath}`));steps[c].relCss&&steps[c].relCss.length&&(cssCommand=xpathInput.value.replace(/xpathvalue/i,steps[c].relCss),b=xpathInput.value.replace(/xpathvalue/i,
`${steps[c].relCss}`),b=b.includes("By.xpath")?b.replace("By.xpath","By.cssSelector"):b.includes("By(xpath")?b.replace("By(xpath","By(cssSelector"):b.includes("ByXPath")?b.replace("ByXPath","ByCssSelector"):b.includes("cy.xpath")?b.replace("cy.xpath","cy.get"):b.replace("cy.Xpath","cy.get"));xpathInput.value&&xpathInput.value.toLowerCase().includes("labelvalue")&&(d=!0);element.innerHTML=screenDataColumnChecked?element.innerHTML+`
                <tr class="tableRow">
                    <td class='fixedColumns'>
                        <div class='tableData'>${c+1}</div>
                    </td>
                    <td class='stepColumn'>
                        <div title="${safeDisplay(steps[c].step)}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData allSteps'>${safeDisplay(steps[c].step)}</div>
                    </td>
                    <td title="${steps[c].dataText}" class='dataColumn ${dataDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData dataCol'>${steps[c].dataText}</div>
                    </td>
                    <td class='expResColumn ${expResultDisplay}'>
                        <div class="tableData expRes" autocomplete="off"  autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="enter your expected result here">${steps[c].expRes}</div>
                    </td>
                    <td class='xpathColumn ${xpathDisplay}'>
                       <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="${command}" class="tableData xpathData">${a}</div>
                    </td>
                    <td class='cssColumn ${cssDisplay}'>
                       <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class="tableData cssData">${b}</div>
                    </td>
                     <td class='screenshotColumn'>
                       <button  class='btn_screen' > <img class='screens' src='${steps[c].screenImage}' alt='undefined'  ></button> 
                    </td>
                    <td class="actionCol">
                        <button id='addStep'></button>
                        <button id='delButton'></button>
                    </td>
                </tr>
                `:element.innerHTML+`
                <tr class="tableRow">
                    <td class='fixedColumns'>
                        <div class='tableData'>${c+1}</div>
                    </td>
                    <td class='stepColumn'>
                        <div title="${safeDisplay(steps[c].step)}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData allSteps'>${safeDisplay(steps[c].step)}</div>
                    </td>
                    <td title="${steps[c].dataText}" class='dataColumn ${dataDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData dataCol'>${steps[c].dataText}</div>
                    </td>
                    <td class='expResColumn ${expResultDisplay}'>
                        <div class="tableData expRes" autocomplete="off"  autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="enter your expected result here">${steps[c].expRes}</div>
                    </td>
                    <td class='xpathColumn ${xpathDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="${command}" class="tableData xpathData">${a}</div>
                    </td>
                    <td class='cssColumn ${cssDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class="tableData cssData">${b}</div>
                    </td>
                    <td class="actionCol">
                        <button id='addStep'></button>
                        <button id='delButton'></button>
                    </td>
                </tr>
                `;d&&(document.querySelector(`#label-${c}`).textContent=a.replace(/labelvalue/i,toCamelCase(steps[c].planeLabel)))}else for(a=0;a<steps.length;a++)element.innerHTML=screenDataColumnChecked?element.innerHTML+`
                <tr class="tableRow">
                    <td class='fixedColumns'>
                        <div class='tableData'>${a+1}</div>
                    </td>
                    <td class='stepColumn'>
                        <div title="${safeDisplay(steps[a].step)}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData allSteps'>${safeDisplay(steps[a].step)}</div>
                    </td>
                    <td title="${steps[a].dataText}" class='dataColumn ${dataDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData dataCol'>${steps[a].dataText}</div>
                    </td>
                    <td class='expResColumn ${expResultDisplay}'>
                        <div class="tableData expRes" autocomplete="off"  autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="enter your expected result here">${steps[a].expRes}</div>
                    </td>
                    <td class='xpathColumn ${xpathDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="${steps[a].relXpath}" class="tableData xpathData xpathColor">${steps[a].relXpath}</div>
                    </td>
                    <td class='cssColumn ${cssDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class="tableData cssData xpathColor">${steps[a].relCss}</div>
                    </td>
                     <td class='screenshotColumn'>
                       <button  class='btn_screen' > <img class='screens' src='${steps[a].screenImage}' alt='undefined'  ></button> 
                    </td>
                    <td class="actionCol">
                        <button id='addStep'></button>
                        <button id='delButton'></button>
                    </td>
                </tr>
                `:element.innerHTML+`
                <tr class="tableRow">
                    <td class='fixedColumns'>
                        <div class='tableData'>${a+1}</div>
                    </td>
                    <td class='stepColumn'>
                        <div title="${safeDisplay(steps[a].step)}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData allSteps'>${safeDisplay(steps[a].step)}</div>
                    </td>
                    <td title="${steps[a].dataText}" class='dataColumn ${dataDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class='tableData dataCol'>${steps[a].dataText}</div>
                    </td>
                    <td class='expResColumn ${expResultDisplay}'>
                        <div class="tableData expRes" autocomplete="off"  autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="enter your expected result here">${steps[a].expRes}</div>
                    </td>
                    <td class='xpathColumn ${xpathDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" title="${steps[a].relXpath}" class="tableData xpathData xpathColor">${steps[a].relXpath}</div>
                    </td>
                    <td class='cssColumn ${cssDisplay}'>
                        <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" class="tableData cssData xpathColor">${steps[a].relCss}</div>
                    </td>
                    <td class="actionCol">
                        <button id='addStep'></button>
                        <button id='delButton'></button>
                    </td>
                </tr>
                `;addEventListenerToImages()}clickCell();0==steps.length&&(document.querySelector(".tablePlaceholder").style.display="")}function toCamelCase(a){return a.replace(/_/g," ").replace(/\s(.)/g,function(b){return b.toUpperCase()}).replace(/\s/g,"").replace(/^(.)/,function(b){return b.toLowerCase()})}
function clickCell(){for(var a=document.getElementById("records-grid").rows,b=0;b<a.length;b++)a[b].cells[7].childNodes[3].addEventListener("click",function(c){c=this.parentNode.parentNode.rowIndex;steps.splice(c-1,1);document.getElementById("records-grid").rows[c-1].remove();addEventListenerToImages()}),a[b].cells[7].childNodes[1].addEventListener("click",function(c){steps.splice(this.parentNode.parentNode.rowIndex,0,{step:"",dataText:"",expRes:"",relXpath:"",relCss:""});displayRows()}),a[b].childNodes[3].addEventListener("input",
function(c){c.data?(steps[this.parentNode.rowIndex-1].step=this.innerText,this.childNodes[1].classList.remove("removeOutline")):this.childNodes[1].classList.add("removeOutline")}),a[b].childNodes[5].addEventListener("input",function(c){c.data?(steps[this.parentNode.rowIndex-1].dataText=this.innerText,this.childNodes[1].classList.remove("removeOutline")):this.childNodes[1].classList.add("removeOutline")}),a[b].childNodes[7].addEventListener("input",function(c){c.data?(steps[this.parentNode.rowIndex-
1].expRes=this.innerText,this.childNodes[1].classList.remove("removeOutline")):this.childNodes[1].classList.add("removeOutline")}),a[b].childNodes[9].addEventListener("input",function(c){c.data?(steps[this.parentNode.rowIndex-1].relXpath=this.innerText,this.childNodes[1].classList.remove("removeOutline")):this.childNodes[1].classList.add("removeOutline")}),a[b].childNodes[11].addEventListener("input",function(c){c.data?(steps[this.parentNode.rowIndex-1].relCss=this.innerText,this.childNodes[1].classList.remove("removeOutline")):
this.childNodes[1].classList.add("removeOutline")})}
toggleElement.addEventListener("click",function(){let a=document.querySelector(".inputFeildContainer"),b=document.querySelector("#updatetitle");this.classList.contains("active")?(this.classList.remove("active"),this.classList.add("inactive"),xpathInput.classList.add("hidden"),xpathInput.classList.remove("show"),toggleToolTip.textContent="Click to set driver command",helperText.innerText="Add custom driver command",a.classList.remove("showElement"),a.classList.add("remove"),b.title="Click to copy all xpaths"):
(this.classList.remove("inactive"),this.classList.add("active"),toggleToolTip.textContent="Click to disable command",xpathInput.classList.add("show"),xpathInput.classList.remove("hidden"),helperText.innerText="",a.classList.add("showElement"),a.classList.remove("remove"),b.title="Click to copy all commands");displayRows()});
recordButton.addEventListener("click",function(a){recording?(recording=!1,recordIcon.style.backgroundImage="url(../../icons/pause_black.svg)",recordIcon.style.animation="none",pauseBtnToolTip.textContent="Click to start recording.",senderId&&browserType.tabs.sendMessage(senderId,{stopRecording:!0})):(recording=!0,recordIcon.style.animation="blinker 1.0s cubic-bezier(.5, 0, 1, 1) infinite alternate",recordIcon.style.backgroundImage="url(../../icons/tcStudio_redDot.svg)",pauseBtnToolTip.textContent=
"Click to stop recording.",senderId&&browserType.tabs.sendMessage(senderId,{openStudio:!0}))});fileName.addEventListener("keyup",async a=>{if(13===(a.which||a.keyCode)&&"what is my sh_id"===a.target.value){var b=await browserType.storage.local.get(["ext_uniq_id"]);if(b.ext_uniq_id){const c=document.createElement("div");c.classList.add("extension__id__wrapper");c.innerHTML=`
                    <div class="extension__id">
                        <div class="extension__id__close"></div>
                        <h4>Your unique sh_id</h4>
                        <div class="extension__id__container">
                            <input type="text" name="extension-id" id="extension-id" value="${b.ext_uniq_id}" readOnly />
                            <div class="extension__id__copy">
                                <div class="icon"></div>
                            </div>
                        </div>
                    </div>
                `;let d=c.querySelector("#extension-id");b=c.querySelector(".extension__id__close");let e=c.querySelector(".extension__id__copy");b.addEventListener("click",()=>c.remove());e.addEventListener("click",async()=>{d.select();document.execCommand("Copy");e.style.backgroundColor="#ffe0a6";setTimeout(()=>e.style.backgroundColor="#ffffff",300)});document.body.appendChild(c);a.target.value=""}}});
let upgradeContainer=document.querySelector("#upgrade-popup"),upgradeConfirmBtn=document.querySelector("#upgrade-confirm"),upgradeCancelBtn=document.querySelector("#upgrade-cancel"),uiBlockAdsSettings;upgradeConfirmBtn.addEventListener("click",()=>{upgradeContainer.classList.add("hideElement")});upgradeCancelBtn.addEventListener("click",()=>{upgradeContainer.classList.add("hideElement")});fetch(`${API_URL}settings/ui_block_ads`).then(a=>a.json()).then(a=>{uiBlockAdsSettings=a.filter(b=>"tcs"===b.extension)[0]});
save_btn.addEventListener("click",function(a){trackEvent("download");1===uiBlockAdsSettings.active?browserType.storage.local.get(["save_count"],f=>{if(void 0===f.save_count||null===f.save_count)return browserType.storage.local.set({save_count:0});f.save_count>=uiBlockAdsSettings.nb_actions-1?(upgradeContainer.classList.remove("hideElement"),upgradeContainer.querySelector(".upgrade__popup__message").innerText=uiBlockAdsSettings.message,browserType.storage.local.set({save_count:0})):browserType.storage.local.set({save_count:f.save_count+
1})}):browserType.storage.local.set({save_count:0});a=toggleToolTip.textContent.includes("Click to set driver command")?"XPath":"Command";if(steps&&steps.length){a=[["Step","Data","Exp Result",a,"cssSelector"]];let f=document.querySelectorAll(".allSteps"),g=document.querySelectorAll(".dataCol"),l=document.querySelectorAll(".expRes"),m=document.querySelectorAll(".xpathData"),n=document.querySelectorAll(".cssData");var b=steps.map((h,k)=>({step:f[k].innerText,dataText:g[k].innerText,expRes:l[k].innerText,
relXpath:m[k].innerText,relCss:n[k].innerText}));b=b.map(h=>[h.step,h.dataText,h.expRes,h.relXpath,h.relCss]);a=a.concat(b);var c=fileName.value.replace(/\s/g,"");b=g[0].innerText.replace(/.+\/\/|www.|\..+/g,"");var d=getFormattedTime();c=c?c:b+"-"+d;exportDataInToExcel(a,c);var e=new JSZip;steps.forEach((h,k)=>{if(h.screenImage){isthereAnImage=!0;var p=h.screenImage.replace("data:image/jpeg;base64,","");e.file(k+1+"-"+h.step.replaceAll('"',"")+".jpg",p,{base64:!0})}});isthereAnImage&&screenDataColumnChecked&&
e.generateAsync({type:"blob"}).then(function(h){saveAs(h,c+"_screenshots")})}else showSnackbar("No data to save")});
function exportDataInToExcel(a,b){var c=new Date;let d=`OS: ${sys.os.family||""} ${sys.os.version||""} | Browser: ${sys.name||""} ${sys.version.split(".")[0]||""} | Resolution: ${window.screen.availWidth}x${window.screen.availHeight} | Time: ${c.getDate()} ${monthNames[c.getMonth()]} ${c.getFullYear()} / ${c.getHours()}:${c.getMinutes()}:${c.getSeconds()}  ${timezone}\n`;var e=window.navigator.userAgent.includes("Windows");Object.keys(a).forEach(function(f){var g=1;dataColumnCheckbox.checked?g+=1:
a[f].splice(g,1);expResultColumnCheckbox.checked?g+=1:a[f].splice(g,1);xpathColumnCheckbox.checked?g+=1:a[f].splice(g,1);cssSelectorColumnCheckbox.checked||a[f].splice(g,1)});a.forEach(function(f){d+=e?f.join(","):f.join("\t");d+="\n"});c=window.document.createElement("a");c.href=window.URL.createObjectURL(new Blob([d],{type:"data:application/vnd.ms-excel;base64,"}));c.download=e?b+".csv":b+".xls";document.body.appendChild(c);c.click()}function getPageUrl(){return window.location.hostname}
function getFormattedTime(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate(),e=a.getHours(),f=a.getMinutes();a=a.getSeconds();return b+"-"+c+"-"+d+"-"+e+"-"+f+"-"+a}function showSnackbar(a){let b=document.querySelector("#snackbar");b.innerText=a;b.className="show";setTimeout(function(){b.className=b.className.replace("show","")},2E3)}
xpathInput.addEventListener("keyup",function(a){xpathText=a.target.value;if(13==a.keyCode){if(!this.value.toLowerCase().includes("xpathvalue")){this.classList.add("wrongXpath");showSnackbar("xpathValue keyword should be there in the command.");return}displayRows();updateCPAttr()}this.value.toLowerCase().includes("xpathvalue")?this.value.toLowerCase().includes("xpathvalue")&&this.classList.remove("wrongXpath"):this.classList.add("wrongXpath")});
window.onload=function(a){trackEvent("open extension");authenticated=!0;tablePlaceholder.innerText="1. Now start your testing.\r\n2. All actions will be converted in english sentence here.\r\n3. For each step unique selector will be generated.\r\n4. Turn on the driver command & set as per requirement to generate command.\r\n5. Download the test case or copy all steps.\r\n6. You can update the file name before exporting it.";browserType.tabs.query({}).then(b=>{b.forEach(async c=>{try{await browserType.tabs.sendMessage(c.id,
{openStudio:!0})}catch(d){}})})};window.onbeforeunload=function(a){browserType.tabs.query({}).then(b=>{b.forEach(async c=>{await browserType.tabs.sendMessage(c.id,{closed:!0})})});window.removeEventListener("beforeunload")};function notifyMe(a,b){"granted"===Notification.permission&&((new Notification("TestCase Studio",{icon:"../../icons/tcStudio_black.svg",body:b})).onclick=function(){window.focus()})}
clearTestCase.addEventListener("click",function(a){document.querySelector(".tablePlaceholder").style.display="";element.innerHTML=null;steps=[];limitReached=!1});copyAllSteps.addEventListener("click",function(){trackEvent("copy steps");copyAllRowsToClipboard(".allSteps")});copyAllData.addEventListener("click",function(){trackEvent("copy data");copyAllRowsToClipboard(".dataCol")});copyAllExpRes.addEventListener("click",function(){trackEvent("copy exp result");copyAllRowsToClipboard(".expRes")});
copyAllXpath.addEventListener("click",function(){trackEvent("copy Xpath");copyAllRowsToClipboard(".xpathData")});copyAllCss.addEventListener("click",function(){trackEvent("copy CSS selector");copyAllRowsToClipboard(".cssData")});
function copyAllRowsToClipboard(a){let b=document.createElement("textarea");b.id="t";b.style.height=0;document.body.appendChild(b);a=document.querySelectorAll(a);for(var c=0;c<a.length;c++)b.value=b.value+"\n"+a[c].innerText;document.querySelector("#t").select();document.execCommand("copy");document.body.removeChild(b)}
function attributeChoicesOption(){attrArr=`,${idAttr.checked?"withid":"withoutid"},${classAttr.checked?"withclass":"withoutclass"},${nameAttr.checked?"withname":"withoutname"},${placeholder.checked?"withplaceholder":"withoutplaceholder"},${textXpath.checked?"withtext":"withouttext"}`;browserType.tabs.sendMessage(senderId,{attrArray:attrArr})}checkboxes.forEach(a=>{a.addEventListener("click",function(){attributeChoicesOption();updateCPAttr()})});
function setAttr(a){idAttr.checked=a.idChecked;classAttr.checked=a.classChecked;nameAttr.checked=a.nameChecked;placeholder.checked=a.placeholderChecked;textXpath.checked=a.textChecked}function updateCPAttr(){browserType.tabs.sendMessage(senderId,{name:"updateCPAttr",data:{idChecked:idAttr.checked,classChecked:classAttr.checked,nameChecked:nameAttr.checked,placeholderChecked:placeholder.checked,textChecked:textXpath.checked}})}
var attributeFilter=document.querySelector(".attributeFilter"),attrFilterBtn=document.querySelector(".attrFilterBtn");
attrFilterBtn.addEventListener("click",function(a){""===attributeFilter.style.display||"none"===attributeFilter.style.display?(browserType.storage.local.set({studioAttributeFilter:"active"},function(){}),attributeFilter.style.display="flex",attrFilterBtn.classList.remove("inactive"),attrFilterBtn.classList.add("active")):(browserType.storage.local.set({studioAttributeFilter:"inactive"},function(){}),attributeFilter.style.display="none",attrFilterBtn.classList.remove("active"),attrFilterBtn.classList.add("inactive"))});
browserType.storage.local.get(["studioAttributeFilter"],function(a){"active"==a.studioAttributeFilter&&(attributeFilter.style.display="flex",attrFilterBtn.classList.remove("inactive"),attrFilterBtn.classList.add("active"))});var columns=document.querySelector(".columns"),uiConfigBtn=document.querySelector(".uiConfigBtn");uiConfigBtn.addEventListener("click",function(a){columns.style.display=""===columns.style.display||"none"===columns.style.display?"flex":"none"});
var dataColumnCheckbox=document.querySelector(".chooseColumns.data"),dataHeader=document.querySelector("#dataHeader");dataColumnCheckbox.addEventListener("click",function(){var a=document.querySelectorAll(".dataColumn");dataColumnCheckbox.checked?(dataHeader.style.display="table-cell",showAllElements(a),browserType.storage.local.set({dataColumn:"checked"},function(){})):(dataHeader.style.display="none",hideAllElements(a),browserType.storage.local.set({dataColumn:"unchecked"},function(){}))});
browserType.storage.local.get(["dataColumn"],function(a){a.dataColumn&&"checked"!=a.dataColumn&&(dataHeader.style.display="none",dataColumnCheckbox.checked=!1)});var expResultColumnCheckbox=document.querySelector(".chooseColumns.expResult"),expResultHeader=document.querySelector("#expResHeader");
expResultColumnCheckbox.addEventListener("click",function(){var a=document.querySelectorAll(".expResColumn");expResultColumnCheckbox.checked?(expResultHeader.style.display="table-cell",showAllElements(a),browserType.storage.local.set({expResColumn:"checked"},function(){})):(expResultHeader.style.display="none",hideAllElements(a),browserType.storage.local.set({expResColumn:"unchecked"},function(){}))});
browserType.storage.local.get(["expResColumn"],function(a){a.expResColumn&&"checked"!=a.expResColumn&&(expResultHeader.style.display="none",expResultColumnCheckbox.checked=!1)});var xpathColumnCheckbox=document.querySelector(".chooseColumns.xpath"),xpathHeader=document.querySelector("#xpathHeader");
xpathColumnCheckbox.addEventListener("click",function(){var a=document.querySelectorAll(".xpathColumn");xpathColumnCheckbox.checked?(xpathHeader.style.display="table-cell",showAllElements(a),browserType.storage.local.set({xpathDataColumn:"checked"},function(){})):(xpathHeader.style.display="none",hideAllElements(a),browserType.storage.local.set({xpathDataColumn:"unchecked"},function(){}))});
browserType.storage.local.get(["xpathDataColumn"],function(a){a.xpathDataColumn&&"checked"!=a.xpathDataColumn&&(xpathHeader.style.display="none",xpathColumnCheckbox.checked=!1)});var cssSelectorColumnCheckbox=document.querySelector(".chooseColumns.cssSelector"),cssSelectorHeader=document.querySelector("#cssSelectorHeader");
cssSelectorColumnCheckbox.addEventListener("click",function(){var a=document.querySelectorAll(".cssColumn");cssSelectorColumnCheckbox.checked?(cssSelectorHeader.style.display="table-cell",showAllElements(a),browserType.storage.local.set({cssDataColumn:"checked"},function(){})):(cssSelectorHeader.style.display="none",hideAllElements(a),browserType.storage.local.set({cssDataColumn:"unchecked"},function(){}))});
browserType.storage.local.get(["cssDataColumn"],function(a){a.cssDataColumn&&"checked"!=a.cssDataColumn&&(cssSelectorHeader.style.display="none",cssSelectorColumnCheckbox.checked=!1)});function hideAllElements(a){a.forEach(function(b){b.style.display="none"})}function showAllElements(a){a.forEach(function(b){b.style.display="table-cell"})}window.onclick=function(a){a.target.className.includes("tableData")&&(a.target.style.textOverflow="initial")};
document.getElementById("execute_btn").addEventListener("click",function(){trackEvent("execute test on testrigor");if(steps&&steps.length){var a=document.querySelector(".testRigorLink"),b=steps[1].step;b.includes("icon")&&(b=b.replace(" icon",""));b="Press"==b.slice(0,5)?b.replace("Press","type"):b;for(var c="https://app.testrigor.com/external-test?url="+encodeURIComponent(steps[0].dataText)+"&steps="+b,d=2;d<steps.length;d++)b=steps[d].step,steps[d].dataText.includes("******")&&(b=b.replaceAll("******",
steps[d].passwordValue)),b.includes("icon")&&(b=b.replace(" icon","")),b="Press"==b.slice(0,5)?b.replace("Press","type"):b,c=c+"%0A"+b;a.setAttribute("href",c+"&reference=selectorshub&utm_source=selectorshub&utm_medium=tcs")}else showSnackbar("No steps to execute.")});var country,city;function trackEvent(a){"string"!==typeof a&&fetch(`${API_URL}analytics/ads/track`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}
function setCookies(){const a=Math.floor(Date.now()/1E3)+63072E4;chrome.cookies.set({url:"https://selectorshub.com",name:"TestCase Studio authentication",value:"true",secure:!0,expirationDate:a});document.getElementById("register_form").style.display="none";tablePlaceholder.innerText="1. Now start your testing.\r\n2. All actions will be converted in english sentence here.\r\n3. For each step unique selector will be generated.\r\n4. Turn on the driver command & set as per requirement to generate command.\r\n5. Download the test case or copy all steps.\r\n6. You can update the file name before exporting it."}
var span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};screenToggler.addEventListener("click",function(){screenshootEnabled=!screenshootEnabled;this.classList.contains("active")?(this.classList.remove("active"),this.classList.add("inactive"),document.querySelectorAll(".screens").style.display="none"):(this.classList.add("active"),this.classList.remove("inactive"))});
var screenShotsCheckbox=document.querySelector(".chooseColumns.Screenshoot"),screenshotHeader=document.querySelector("#screenshotHeader");
screenShotsCheckbox.addEventListener("click",function(){var a=document.querySelectorAll(".btn_screen");screenShotsCheckbox.checked?(screenshotHeader.style.display="table-cell",showAllElements(a),browserType.storage.local.set({screenDataColumn:"checked"},function(){}),screenDataColumnChecked=!0):(screenshotHeader.style.display="none",hideAllElements(a),browserType.storage.local.set({screenDataColumn:"unchecked"},function(){}),screenDataColumnChecked=!1);displayRows()});
browserType.storage.local.get(["screenDataColumn"],function(a){a.screenDataColumn&&"checked"!=a.screenDataColumn&&(screenshotHeader.style.display="none",screenDataColumnChecked=screenShotsCheckbox.checked=!1)});
document.querySelector("#next").addEventListener("click",function(){document.querySelector("#previous").style.visibility="visible";try{actualImage<=imagesArray.length-1&&(modalImg.src=imagesArray[actualImage+1].firstElementChild.src,document.querySelector(".screen_name").innerHTML=actualImage+2+"- "+stepsArray[actualImage+1].firstElementChild.innerHTML,actualImage++,actualImage==imagesArray.length-1&&(this.style.visibility="hidden"))}catch(a){}});
document.querySelector("#previous").addEventListener("click",function(){document.querySelector("#next").style.visibility="visible";0<actualImage&&(modalImg.src=imagesArray[actualImage-1].firstElementChild.src,document.querySelector(".screen_name").innerHTML=actualImage+"- "+stepsArray[actualImage-1].firstElementChild.innerHTML,actualImage--,0==actualImage&&(this.style.visibility="hidden"))});
function addEventListenerToImages(){imagesArray=Array.from(document.querySelectorAll(".btn_screen")).filter((a,b)=>a.firstElementChild.src.includes("undefined")?!1:!0);stepsArray=Array.from(document.querySelectorAll(".stepColumn")).filter((a,b)=>a.parentElement.querySelector(".screenshotColumn")&&!a.parentElement.querySelector(".screenshotColumn").firstElementChild.firstElementChild.src.includes("undefined")?!0:!1);imagesArray.forEach((a,b)=>{a.addEventListener("click",function(){a.firstElementChild.src.includes("undefined")||
(modal.style.display="block");document.querySelector("#next").style.visibility="visible";document.querySelector("#previous").style.visibility="visible";modalImg.src=a.querySelector("img").src;actualImage=b;document.querySelector(".screen_name").innerHTML=actualImage+1+"- "+stepsArray[actualImage].firstElementChild.innerHTML;0==b&&(document.querySelector("#previous").style.visibility="hidden");b==imagesArray.length-1&&(document.querySelector("#next").style.visibility="hidden")})})}
document.addEventListener("keydown",a=>{"none"!=document.querySelector(".modal").style.display&&("37"==a.keyCode&&document.querySelector("#previous").click(),"39"==a.keyCode&&document.querySelector("#next").click())});let adsText=document.querySelector(".ads__text"),adsContainer=document.querySelector(".ads__container"),adsViewer=document.querySelector(".ads__viewer"),dummyVariable="";
const buildAdText=(a,b)=>{const c=[];dummyVariable=a;b.forEach((e,f)=>{let g=dummyVariable.split("");g.splice(e.position+7*f,0,"__img__");dummyVariable=g.join("")});a=document.createElement("span");a.innerText=dummyVariable;c.push(a);let d=0;c.forEach(e=>{let f=e.innerText;for(;-1!==e.innerText.indexOf("__img__");)f=f.replace("__img__",`<img src="${b[d].imgURL}" />`),e.innerText=e.innerText.replace("__img__",""),d++;e.innerHTML=f});return c};
let offerAdsContainer=document.querySelector("#offer-countdown-ads"),offerText=document.querySelector(".offer__text"),offerCountdown=document.querySelector(".offer__countdown"),offerAdsViewerPrevBtn=document.querySelector(".offer__navigate__prev__btn"),offerAdsViewerNextBtn=document.querySelector(".offer__navigate__next__btn"),offerInterval=null;
const updateOfferContent=(a,b,c)=>{if(a){if(offerText.classList.remove("hideElement"),offerCountdown.classList.remove("hideElement"),offerText.innerText=b,a=Date.now(),a=c-a,!(0>a)){a=Math.floor(a/1E3);b=Math.floor(a/60);var d=Math.floor(b/60);offerCountdown.innerText=`${Math.floor(d/24)}d : ${d%24}hr : ${b%60}m : ${a%60}s`;offerInterval&&clearInterval(offerInterval);offerInterval=setInterval(()=>{var e=Date.now();e=Math.floor((c-e)/1E3);let f=Math.floor(e/60),g=Math.floor(f/60);offerCountdown.innerText=
`${Math.floor(g/24)}d : ${g%24}hr : ${f%60}m : ${e%60}s`},1E3)}}else offerText.classList.add("hideElement"),offerCountdown.classList.add("hideElement")};let offerAdsWrapper=document.querySelector(".offer__ads__container");
const appendAd=({id:a,ad:b,link:c,images:d,background_color:e,extensions:f,text_color:g,border_color:l,display_time:m,type:n,action:h})=>{d=buildAdText(b,d);const k=document.createElement("a");k.href=c;k.id=`ad__${a}`;k.className="ad__template";k.setAttribute("target","_blank");k.setAttribute("data-display-time",m);k.setAttribute("title",b);k.style.backgroundColor=e;k.style.border="1px solid "+l;k.innerHTML+=`
        <div class="status__block" style="${n?`display: block; background-color: ${n.color};`:"display: none;"}">${n?.name}</div>
        <div class="ad__text" style="display: flex; alignItems: center;">
            <div style="color: ${g}"></div>
        </div>
        <div class="ad__btn" style="background-color: ${h.background_color}">
            <div class="btn">
            <p style="color: ${h.text_color};">${h.name}</p>
                <div class="btn__icon">
                    <img src="${h.icon_url}" />
                </div>
            </div>
            </div>
    `;let p=k.querySelector(".ad__text > div");k.addEventListener("click",async()=>{let q=await browserType.storage.local.get(["ext_uniq_id"]);trackEvent({extension:EXT_ID,events:[{user_uniq_id:q.ext_uniq_id,location:countryName,type:`ext__ads:${a}:clicks`}]})});d.forEach(q=>{p.appendChild(q)});f.includes(OFFER_EXT_ID.toString())?offerAdsWrapper.appendChild(k):adsContainer.appendChild(k)};
let currentIndex=1,_ads,tIntervals=[],tInterval=null,tStartTime=0,tTimeRest=0,tIsPaused=!1,currentOfferIndex=1,offerIntervals=[],offerAdsInterval=null,offerStartTime=0,offerTimeRest=0,offerIsPaused=!1;
const applyInterval=a=>{const b=adsContainer.querySelectorAll(".ad__template");tIntervals.forEach(c=>clearInterval(c));tIntervals=[];tInterval=setInterval(()=>{if(b[currentIndex]){tStartTime=Date.now();let c=adsContainer.querySelector(".ad__template.translate__left");b[currentIndex].classList.remove("no__transition");c.querySelector(".ad__text > div").style.animation="none";c.classList.add("hide__left");b[currentIndex].classList.add("translate__left");if(b[currentIndex].clientWidth>=adsContainer.clientWidth){let e=
document.querySelector("#animation-style"),f=`
                        @keyframes scrollText {
                            from{
                                transform: translateX(${b[currentIndex].querySelector(".ad__text").clientWidth+30}px);
                            }
                            to{
                                transform: translateX(-102%);
                            }
                        }`;e.innerHTML=f;b[currentIndex].querySelector(".ad__text > div").style.animation="scrollText 30s linear infinite"}let d=setTimeout(()=>{c.classList.add("no__transition");c.classList.remove("hide__left");c.classList.remove("translate__left");clearTimeout(d);clearInterval(tInterval);tStartTime=0;const e=b[currentIndex].id.replace("ad__",""),f=_ads.filter(g=>g.id===e)[0];currentIndex===b.length-1?currentIndex=0:currentIndex++;tStartTime=Date.now();applyInterval(1E3*f.display_time)},
300)}},a);tIntervals.push(tInterval)},applyOfferInterval=a=>{const b=offerAdsWrapper.querySelectorAll(".ad__template");offerIntervals.forEach(c=>clearInterval(c));offerIntervals=[];offerAdsInterval=setInterval(()=>{if(b[currentOfferIndex]){offerStartTime=Date.now();let c=offerAdsWrapper.querySelector(".ad__template.translate__left");b[currentOfferIndex].classList.remove("no__transition");c.querySelector(".ad__text > div").style.animation="none";c.classList.add("hide__left");b[currentOfferIndex].classList.add("translate__left");
if(b[currentOfferIndex].offsetWidth>=offerAdsWrapper.offsetWidth){let e=document.querySelector("#animation-style-offer"),f=`
                        @keyframes offerScrollText {
                            from{
                                transform: translateX(${b[currentOfferIndex].querySelector(".ad__text").clientWidth+30}px);
                            }
                            to{
                                transform: translateX(-102%);
                            }
                        }`;e.innerHTML=f;b[currentOfferIndex].querySelector(".ad__text > div").style.animation="offerScrollText 30s linear infinite"}let d=setTimeout(()=>{c.classList.add("no__transition");c.classList.remove("hide__left");c.classList.remove("translate__left");clearTimeout(d);clearInterval(offerAdsInterval);offerStartTime=0;const e=b[currentOfferIndex].id.replace("ad__",""),f=_ads.filter(g=>g.id===e)[0];updateOfferContent(f.offer_countdown_enabled,f.offer_countdown_text,f.offer_countdown_end_at);
currentOfferIndex===b.length-1?currentOfferIndex=0:currentOfferIndex++;offerStartTime=Date.now();applyOfferInterval(1E3*f.display_time)},300)}},a);offerIntervals.push(offerAdsInterval)};let adsViewerPrevBtn=document.querySelector(".navigate__prev__btn"),adsViewerNextBtn=document.querySelector(".navigate__next__btn");adsViewerPrevBtn.addEventListener("click",()=>{let a=adsContainer.querySelectorAll(".ad__template");currentIndex-=2;0>currentIndex&&(currentIndex=a.length+currentIndex);applyInterval(400)});
adsViewerNextBtn.addEventListener("click",()=>{applyInterval(400)});offerAdsViewerPrevBtn.addEventListener("click",()=>{let a=offerAdsWrapper.querySelectorAll(".ad__template");const b=a[currentOfferIndex].id.replace("ad__",""),c=_ads.filter(d=>d.id===b)[0];updateOfferContent(c.offer_countdown_enabled,c.offer_countdown_text,c.offer_countdown_end_at);currentOfferIndex-=2;0>currentOfferIndex&&(currentOfferIndex=a.length+currentOfferIndex);applyOfferInterval(400)});
offerAdsViewerNextBtn.addEventListener("click",()=>{const a=offerAdsWrapper.querySelectorAll(".ad__template")[currentOfferIndex].id.replace("ad__",""),b=_ads.filter(c=>c.id===a)[0];updateOfferContent(b.offer_countdown_enabled,b.offer_countdown_text,b.offer_countdown_end_at);applyOfferInterval(400)});const displayAds=a=>{clearInterval(tInterval);clearInterval(offerAdsInterval);offerStartTime=tStartTime=0;_ads=a;a.forEach((b,c)=>appendAd(b,c))};let adsSection=document.querySelector(".right__section");
browserType.storage.local.get(["ext_uniq_id"],a=>{fetch(`${API_URL}whitelist/${a.ext_uniq_id||""}`).then(b=>b.json()).then(b=>{let c=!0,d=!0;b.ipExists&&(c=!b.object.ads_types.includes("ext__ads"),d=!b.object.ads_types.includes("links__ads"));c&&fetch(`${API_URL}ad?published=true&extensions=${EXT_ID},${OFFER_EXT_ID}&mode=ext__ads&browsers=${platform}&excluded_countries=${countryName.toLowerCase()}`).then(e=>e.json()).then(e=>{if(0<e.ads.length){let l=e.ads.filter(m=>m.extensions.includes(OFFER_EXT_ID.toString()));
1===l.length&&(l[0].offer_countdown_enabled||(offerAdsContainer.style.border="none"),offerAdsContainer.classList.remove("hideElement"),adsViewerPrevBtn.classList.add("hideElement"),adsViewerNextBtn.classList.add("hideElement"));0<l.length?(adsSection.classList.remove("hideElement"),offerAdsContainer.classList.remove("hideElement"),updateOfferContent(l[0].offer_countdown_enabled,l[0].offer_countdown_text,l[0].offer_countdown_end_at)):offerAdsContainer.classList.add("hideElement");displayAds(e.ads);
if(0<e.ads.filter(m=>!m.extensions.includes(OFFER_EXT_ID.toString())).length&&e.ads[0].link){var f=adsContainer.querySelectorAll(".ad__template");currentIndex=1;f[0].classList.add("translate__left");var g=f[0].querySelector(".ad__text");let m=document.querySelector("#animation-style");f[0].clientWidth>=adsContainer.clientWidth&&(m.innerHTML=`
                                @keyframes scrollText {
                                    from{
                                        transform: translateX(${g.clientWidth+30}px);
                                    }
                                    to{
                                        transform: translateX(-102%);
                                    }
                                }`,f[0].querySelector(".ad__text > div").style.animation="scrollText 30s linear infinite");tStartTime=Date.now();applyInterval(1E3*e.ads[0].display_time);f.forEach(n=>{n.addEventListener("mouseenter",()=>{tIsPaused||(n.children[1].children[0].style.animationPlayState="paused",clearInterval(tInterval),tTimeRest=Date.now()-tStartTime,tIsPaused=!0)});n.addEventListener("mouseleave",()=>{if(tIsPaused){n.children[1].children[0].style.animationPlayState="running";var h=n.getAttribute("data-display-time");
if(h=parseInt(h))tStartTime=Date.now()-tTimeRest,applyInterval(1E3*h-tTimeRest),tIsPaused=!1}})})}0<l.length&&(e=offerAdsWrapper.querySelectorAll(".ad__template"),currentOfferIndex=1,e[0].classList.add("translate__left"),f=e[0].querySelector(".ad__text"),g=document.querySelector("#animation-style-offer"),e[0].offsetWidth>=offerAdsWrapper.offsetWidth&&(g.innerHTML=`
                                @keyframes offerScrollText {
                                    from{
                                        transform: translateX(${f.clientWidth+30}px);
                                    }
                                    to{
                                        transform: translateX(-102%);
                                    }
                                }`,e[0].querySelector(".ad__text > div").style.animation="offerScrollText 30s linear infinite"),offerStartTime=Date.now(),applyOfferInterval(1E3*l[0].display_time),e.forEach(m=>{m.addEventListener("mouseenter",()=>{offerIsPaused||(m.children[1].children[0].style.animationPlayState="paused",clearInterval(offerAdsInterval),offerTimeRest=Date.now()-offerStartTime,offerIsPaused=!0)});m.addEventListener("mouseleave",()=>{if(offerIsPaused){m.children[1].children[0].style.animationPlayState=
"running";var n=m.getAttribute("data-display-time");if(n=parseInt(n))offerStartTime=Date.now()-offerTimeRest,applyOfferInterval(1E3*n-offerTimeRest),offerIsPaused=!1}})}))}}).catch(e=>console.log(e));d&&fetch(`${API_URL}ad?published=true&extensions=${EXT_ID}&mode=links__ads&browsers=${platform}&excluded_countries=${countryName.toLowerCase()}`).then(e=>e.json()).then(e=>{e=e.ads.filter(f=>"on__uninstall"===f.type);browserType.runtime.setUninstallURL(0<e.length?e[0].link:"https://selectorshub.com/testcase-studio/uninstall-tcs/")}).catch(e=>
console.log(e))})});let topAdsContainer=document.querySelector(".top_ads__container"),topAdsViewer=document.querySelector(".top_ads__viewer"),top_currentIndex=1,_top_ads,top_tIntervals=[],top_tInterval=null,top_tStartTime=0,top_tTimeRest=0,top_tIsPaused=!1;
const topAppendAd=({id:a,ad:b,link:c,images:d,background_color:e,text_color:f,border_color:g,display_time:l,type:m,action:n})=>{d=buildAdText(b,d);const h=document.createElement("a");h.href=c;h.id=`top_ad__${a}`;h.className="top_ad__template";h.setAttribute("target","_blank");h.setAttribute("top_data-display-time",l);h.setAttribute("top_title",b);h.style.backgroundColor=e;h.style.border="1px solid "+g;h.innerHTML+=`
        <div class="top_status__block" style="${m?`display: block; background-color: ${m.color};`:"display: none;"}">${m?.name}</div>
        <div class="top_ad__text" style="display: flex; alignItems: center;">
            <div style="color: ${f}"></div>
        </div>
        <div class="top_ad__btn" style="background-color: ${n.background_color}">
            <div class="top_btn">
            <p style="color: ${n.text_color};">${n.name}</p>
                <div class="top_btn__icon">
                    <img src="${n.icon_url}" />
                </div>
            </div>
            </div>
    `;let k=h.querySelector(".top_ad__text > div");h.addEventListener("click",async()=>{let p=await browserType.storage.local.get(["ext_uniq_id"]);trackEvent({extension:TOP_EXT_ID,events:[{user_uniq_id:p.ext_uniq_id,location:countryName,type:`ext__ads:${a}:clicks`}]})});d.forEach(p=>{k.appendChild(p)});topAdsContainer.appendChild(h)},topApplyInterval=a=>{const b=document.querySelectorAll(".top_ad__template");top_tIntervals.forEach(c=>clearInterval(c));top_tIntervals=[];top_tInterval=setInterval(()=>
{if(b[top_currentIndex]){top_tStartTime=Date.now();let c=document.querySelector(".top_ad__template.top_translate__left");b[top_currentIndex].classList.remove("top_no__transition");c.querySelector(".top_ad__text > div").style.animation="none";c.classList.add("top_hide__left");b[top_currentIndex].classList.add("top_translate__left");if(b[top_currentIndex].clientWidth>=topAdsContainer.clientWidth){let e=document.querySelector("#animation-style"),f=`
                        @keyframes scrollText {
                            from{
                                transform: translateX(${b[top_currentIndex].querySelector(".top_ad__text").clientWidth+30}px);
                            }
                            to{
                                transform: translateX(-102%);
                            }
                        }`;e.innerHTML=f;b[top_currentIndex].querySelector(".top_ad__text > div").style.animation="scrollText 30s linear infinite"}let d=setTimeout(()=>{c.classList.add("top_no__transition");c.classList.remove("top_hide__left");c.classList.remove("top_translate__left");clearTimeout(d);clearInterval(top_tInterval);top_tStartTime=0;const e=b[currentIndex].id.replace("top_ad__",""),f=top_ads.filter(g=>g.id===e)[0];top_currentIndex===b.length-1?top_currentIndex=0:top_currentIndex++;top_tStartTime=
Date.now();topApplyInterval(1E3*f.display_time)},300)}},a);top_tIntervals.push(top_tInterval)};let topAdsViewerPrevBtn=document.querySelector(".top_navigate__prev__btn"),topAdsViewerNextBtn=document.querySelector(".top_navigate__next__btn");topAdsViewerPrevBtn.addEventListener("click",()=>{let a=document.querySelectorAll(".top_ad__template");top_currentIndex-=2;0>top_currentIndex&&(top_currentIndex=a.length+top_currentIndex);topApplyInterval(400,"prev")});
topAdsViewerNextBtn.addEventListener("click",()=>{topApplyInterval(400,"next")});const topDisplayAds=a=>{clearInterval(top_tInterval);top_tStartTime=0;top_ads=a;a.forEach((b,c)=>topAppendAd(b,c))};
browserType.storage.local.get(["ext_uniq_id"],a=>{fetch(`${API_URL}whitelist/${a.ext_uniq_id||""}`).then(b=>b.json()).then(b=>{let c=!0;b.ipExists&&(c=!b.object.ads_types.includes("ext__ads"),b.object.ads_types.includes("links__ads"));c&&fetch(`${API_URL}ad?published=true&extensions=${TOP_EXT_ID}&mode=ext__ads&browsers=${platform}&excluded_countries=${countryName.toLowerCase()}`).then(d=>d.json()).then(d=>{if(0<d.ads.length&&d.ads[0].link){topDisplayAds(d.ads);const e=document.querySelectorAll(".top_ad__template");
currentIndex=1;e[0].classList.add("top_translate__left");let f=e[0].querySelector(".top_ad__text"),g=document.querySelector("#animation-style");e[0].clientWidth>=topAdsContainer.clientWidth&&(g.innerHTML=`
                                @keyframes scrollText {
                                    from{
                                        transform: translateX(${f.clientWidth+30}px);
                                    }
                                    to{
                                        transform: translateX(-102%);
                                    }
                                }`,e[0].querySelector(".top_ad__text > div").style.animation="scrollText 30s linear infinite");tStartTime=Date.now();topApplyInterval(1E3*d.ads[0].display_time);e.forEach(l=>{l.addEventListener("mouseenter",()=>{top_tIsPaused||(l.children[1].children[0].style.animationPlayState="paused",clearInterval(top_tInterval),top_tTimeRest=Date.now()-top_tStartTime,top_tIsPaused=!0)});l.addEventListener("mouseleave",()=>{if(top_tIsPaused){l.children[1].children[0].style.animationPlayState=
"running";var m=l.getAttribute("data-display-time");if(m=parseInt(m))top_tStartTime=Date.now()-top_tTimeRest,topApplyInterval(1E3*m-top_tTimeRest),top_tIsPaused=!1}})})}}).catch(d=>console.log(d))})});
const changeFooterStyles=a=>{let b=document.querySelector(".infoBlock"),c=document.querySelector(".requestHeader.pro"),d=document.querySelector(".requestHeader.review-link"),e=document.querySelector(".ads__info__icon"),f=document.querySelector(".changelog"),g=f.previousElementSibling,l=document.querySelectorAll(".ads__navigation__btn"),m=document.querySelector(".ads__viewer"),n=document.querySelector(".popup__actions__container"),h=document.querySelector(".theme-toggle");"popup"===a?(l.forEach(k=>
k.classList.add("ads__navigation__btn__popup")),b.classList.add("infoBlockPopUp"),m.classList.add("ads__viewer__popup"),c.classList.add("hideElement"),d.classList.add("hideElement"),f.classList.add("hideElement"),e.classList.add("hideElement"),g.classList.add("hideElement"),h.classList.add("hideElement"),n.classList.remove("hideElement")):(l.forEach(k=>k.classList.remove("ads__navigation__btn__popup")),b.classList.remove("infoBlockPopUp"),m.classList.remove("ads__viewer__popup"),c.classList.remove("hideElement"),
d.classList.remove("hideElement"),f.classList.remove("hideElement"),e.classList.remove("hideElement"),g.classList.remove("hideElement"),h.classList.remove("hideElement"),n.classList.add("hideElement"))};let keepAdsBtn=document.querySelector(".popup__action.keep__ads");keepAdsBtn.addEventListener("click",()=>{changeFooterStyles("footer")});
browserType.storage.local.get(["popup_ads_sessions"],({popup_ads_sessions:a})=>{void 0===a?browserType.storage.local.set({popup_ads_sessions:{count:0,popped:!1}}):browserType.storage.local.set({popup_ads_sessions:{count:a.count+1,popped:a.popped}});fetch(`${API_URL}settings/ads_popup`).then(b=>b.json()).then(b=>{b=b.filter(f=>"tcs"===f.extension)[0];let {active:c,time_control:d,sessions:e}=b;1===c&&(1===e&&(a?.popped||setTimeout(()=>{changeFooterStyles("popup");browserType.storage.local.set({popup_ads_sessions:{count:0,
popped:!1}})},1E3*d)),a?.count<e-1?a?.popped||setTimeout(()=>{changeFooterStyles("popup");browserType.storage.local.set({popup_ads_sessions:{count:a.count+1,popped:!0}})},1E3*d):browserType.storage.local.set({popup_ads_sessions:{count:0,popped:!1}}))})});
browserType.storage.local.get(["license_ad_timestamp"],async({license_ad_timestamp:a})=>{var b=await fetch(`${API_URL}settings/license_ads`);if((b=(400>b.status?await b.json():[]).filter(c=>"tcs"===c.extension)[0])&&1===b.active&&(Date.now()-a>864E5*b.every||!a)){let c=document.querySelector("#license-popup");a=document.querySelector(".accept__block label");let d=document.querySelector("a.license__accept"),e=document.querySelector(".upgrade__block label"),f=document.querySelector("a.license__upgrade"),
g=document.querySelector("#accept-input"),l=document.querySelector("#upgrade-input");a.innerText=b.accept_message;e.innerText=b.upgrade_message;f.href=b.link;c.classList.remove("hideElement");g.addEventListener("change",()=>{g.checked&&(d.classList.remove("disabled"),f.classList.add("disabled"))});l.addEventListener("change",()=>{l.checked&&(d.classList.add("disabled"),f.classList.remove("disabled"))});d.addEventListener("click",()=>{c.classList.add("hideElement");browserType.storage.local.set({license_ad_timestamp:Date.now()})});
f.addEventListener("click",()=>{c.classList.add("hideElement");browserType.storage.local.set({license_ad_timestamp:Date.now()})})}});let timeout;
function createImageContainer({id:a,display_time:b,link:c,image_url:d},e=!1){let f=document.createElement("a");f.href=c;f.setAttribute("target","_blank");f.setAttribute("data-dt",b);f.classList.add("image__link");e&&f.classList.add("displayed");f.innerHTML=`<img src="${API_URL.slice(0,-1)+d}" alt="${c}" /> `;f.addEventListener("click",async()=>{let g=await browserType.storage.local.get(["ext_uniq_id"]);trackEvent({extension:EXT_ID,events:[{user_uniq_id:g.ext_uniq_id,location:countryName,type:`image__ads:${a}:clicks`}]})});
return f}function displayPrevAd(){clearTimeout(timeout);var a=document.querySelector(".image__link.displayed");a.classList.remove("displayed");a.previousElementSibling?(a.previousElementSibling.classList.add("displayed"),a=a.previousElementSibling.getAttribute("data-dt")):(a.parentElement.lastElementChild.classList.add("displayed"),a=a.parentElement.lastElementChild.getAttribute("data-dt"));timeout=setTimeout(displayNextAd,1E3*a)}
function displayNextAd(){clearTimeout(timeout);var a=document.querySelector(".image__link.displayed");a.classList.remove("displayed");a.nextElementSibling?(a.nextElementSibling.classList.add("displayed"),a=a.nextElementSibling.getAttribute("data-dt")):(a.parentElement.firstElementChild.classList.add("displayed"),a=a.parentElement.firstElementChild.getAttribute("data-dt"));timeout=setTimeout(displayNextAd,1E3*a)}let prevBtn=document.querySelector(".prev__ad__img"),nextBtn=document.querySelector(".next__ad__img");
prevBtn.addEventListener("click",displayPrevAd);nextBtn.addEventListener("click",displayNextAd);
fetch(`${API_URL}ad?published=true&extensions=${EXT_ID}&mode=image__ads&browsers=${platform}&excluded_countries=${countryName.toLowerCase()}`).then(a=>a.json()).then(async a=>{if(0<a.ads.length){adsSection.classList.remove("hideElement");let b=document.querySelector("#image-ads");b.classList.remove("hideElement");let c=b.querySelector(".images__container");a.ads.forEach((d,e)=>{let f=createImageContainer(d,0===e);c.appendChild(f);0===e&&(timeout=setTimeout(displayNextAd,1E3*d.display_time))})}}).catch(()=>
{});
