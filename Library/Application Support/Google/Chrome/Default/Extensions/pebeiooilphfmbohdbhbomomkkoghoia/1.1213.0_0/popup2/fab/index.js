(function(e){function t(t){var i=t[0];var r=t[1];var a=t[2];var c,l,u=0,p=[];for(;u<i.length;u++){l=i[u];if(Object.prototype.hasOwnProperty.call(o,l)&&o[l]){p.push(o[l][0])}o[l]=0}for(c in r){if(Object.prototype.hasOwnProperty.call(r,c)){e[c]=r[c]}}if(d)d(t);while(p.length){p.shift()()}n.push.apply(n,a||[]);return s()}function s(){var e;for(var t=0;t<n.length;t++){var s=n[t];var i=true;for(var r=1;r<s.length;r++){var c=s[r];if(o[c]!==0)i=false}if(i){n.splice(t--,1);e=a(a.s=s[0])}}return e}var i={};var o={1:0};var n=[];function r(e){return a.p+""+({0:"vendors~lazyPako~playbackTreeBuilder",2:"playbackTreeBuilder",4:"vendors~playbackTreeBuilder"}[e]||e)+".js"}function a(t){if(i[t]){return i[t].exports}var s=i[t]={i:t,l:false,exports:{}};e[t].call(s.exports,s,s.exports,a);s.l=true;return s.exports}a.e=function e(t){var s=[];var i=o[t];if(i!==0){if(i){s.push(i[2])}else{var n=new Promise((function(e,s){i=o[t]=[e,s]}));s.push(i[2]=n);var c=document.createElement("script");var l;c.charset="utf-8";c.timeout=120;if(a.nc){c.setAttribute("nonce",a.nc)}c.src=r(t);var u=new Error;l=function(e){c.onerror=c.onload=null;clearTimeout(d);var s=o[t];if(s!==0){if(s){var i=e&&(e.type==="load"?"missing":e.type);var n=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+i+": "+n+")";u.name="ChunkLoadError";u.type=i;u.request=n;s[1](u)}o[t]=undefined}};var d=setTimeout((function(){l({type:"timeout",target:c})}),12e4);c.onerror=c.onload=l;document.head.appendChild(c)}}return Promise.all(s)};a.m=e;a.c=i;a.d=function(e,t,s){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:s})}};a.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};a.t=function(e,t){if(t&1)e=a(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var s=Object.create(null);a.r(s);Object.defineProperty(s,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s};a.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};a.d(t,"a",t);return t};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="";a.oe=function(e){console.error(e);throw e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[];var l=c.push.bind(c);c.push=t;c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;n.push([317,3]);return s()})([,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.tooltipText=t.SHARED_STEP_DISABLED_REASON=t.TEST_RESULT=t.RUNNER_STATUS=t.TEST_STATUS=t.mockNetworkStorage=t.sharedStepsFriendlyNames=t.serverResponses=t.locateBannerMode=t.ITERATION_METHODS=t.HOOK=t.improveLocatorDiff=t.window=t.user=t.testStatus=t.test=t.tab=t.stepStatus=t.stepResult=t.socketEventTypes=t.scenario=t.recording=t.recaptcha=t.playback=t.plans=t.plan=t.locators=t.localStorage=t.localPlayback=t.host=t.grids=t.gridTypes=t.frame=t.exportScopes=t.error=t.defaults=t.company=t.bugim=t.assignTypes=t.applitools=t.KEYS=t.AUT=t.RECORD_BUTTON_ID=t.MASTER_BRANCH=t.TESTIM_EXTENSION_ID=t.commonConstants=t.FOLDER_CHILD_TYPES=t.MOBILE_RUN_SKIP_REASON=t.MINUTE_IN_MS=t.SECOND_IN_MS=void 0;t.SIGNUP_COUNTRY_KEY=t.SECRET_CREDENTIAL_MASK=t.MOBILE_GRID_UI=t.MOBILE_GRID_API=t.MOBILE_SKIP_REASON_MAP=t.INPUT_TYPES=t.KEY_BINDING_LAYERS=t.DEBUGGER=t.globalSelectors=t.MOBILE_SOCKET_EVENTS_TYPES=t.MOBILE_APP_MIME_TYPES=t.MOBILE_APP_FILE_TYPES=t.mobile=void 0;const i=s(110);t.SECOND_IN_MS=1e3;t.MINUTE_IN_MS=60*t.SECOND_IN_MS;const o=1366;const n=768;const r={GRID_TYPE_LOCAL:"local",GRID_TYPE_TESTIM_HYBRID:"testimHybrid",GRID_TYPE_TESTIM:"testim",GRID_TYPE_TESTIM_ENTERPRISE:"testimEnterprise",GRID_TYPE_TESTIM_DF:"testimDF",GRID_TYPE_LAMBDA_TEST:"testimLambdaTest",GRID_TYPE_HEADSPIN:"testimHeadspin",GRID_TYPE_BROWSERSTACK:"browserstack",GRID_TYPE_SAUCELABS:"saucelabs",GRID_TYPE_LAMBDATEST:"lambdaTest",GRID_TYPE_TESTIM_TDC:"testimTDC",GRID_TYPE_TESTIM_TVC:"testimTVC",GRID_TYPE_P_CLOUDY:"pcloudy"};t.MOBILE_RUN_SKIP_REASON={APP_FROM_DEVICE:"app-from-device",VIRTUAL_BUILD:"virtual-build"};const a={TESTIM_EXTENSION_ID:"pebeiooilphfmbohdbhbomomkkoghoia",MASTER_BRANCH:"master",RECORD_BUTTON_ID:"recordButton",defaults:{FAKE_CODE_USER_TOKEN:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6InhNaFRnV2JhVnY4Mk5yd0Zha2UiLCJpYXQiOjE1ODI4MjQ1MzQsImV4cCI6MTU4MjgyODEzNH0.Z58qS1nNsIoecuRU-RTfGIZZTEumaMy09UQe4ixbJWo",FAKE_CODE_USER_ID:"xMhTgWbaVv82NrwFake",FAKE_CODE_PROJECT_ID:"CHMRBxJ3WhpvyTGFake",FAKE_CODE_COMPANY_ID:"BCGb2yggS42UqnzFake",ADMIN_DEFAULT_PROJECT_ID:"zVMJIuYWllNybCyUcdQI",DEMO_PROJECT_ID:"GYXR2qZC",DEMO_COMPANY_ID:"y36w0N2f4GxNoqDc",TTA_SFDC_DEMO_PROJECT_ID:"WPZPXX3rnCpFZOSFPzYi",TTA_SFDC_DEMO_TOUR_TEST_ID:"cn7ezr0TbdWGwiFf",TTA_SFDC_DEMO_COMPANY_ID:"NxPdK6XlPtKtZjSDNZAk",SMALL_SCREEN:{width:o,height:n},DEFAULT_PAGE_URL:"https://app.testim.io/welcome.html"},user:{LOGIN:"user-login",LOGOUT:"user-logout",SESSION_INACTIVE:"user-session-inactive",UNASSIGNED_USER:"Unassigned"},plans:{FREE:"free",TRIAL:"trial",ENTERPRISE:"enterprise",STARTUP:"startup",ESSENTIALS:"essentials"},window:{OPEN_WINDOW:"open-window",OPEN_LOCAL_RUN_WINDOW:"open-local-run-window",FRAME_COMPLETED:"window:frame_completed",TAB_ACTIVATED:"window:tab_activated",TAB_FOCUS_CHANGED:"window:tab_focus_changed"},host:{EXTENSION_INSTALLED:"does-extension-exist",EXTENSION_UPDATE_EXISTS:"update-exists",EXTENSION_DO_UPDATE:"force-update-extension",EXTENSION_PING:"extension-ping",AUT_PORT:"TestimAUT",CONSOLE_PORT:"TestimConsole",EXTENSION_SRV_PORT:"TestimExtensionSrv",ERROR:"error",GET_LOCATOR:"get-locator",GET_LOCATOR_RESULT:"get-locator-result",HTTP_REQUEST:"http-request",RESPONSE:"response",SESSION_STARTED:"session-started",SET_PROJECT:"host:set-project",UPDATE_PROJECT_DEFAULTS:"host:update-project-defaults",START_SESSION:"start-session",PORT_REGISTERED:"port-registered",CONNECTED:"host:connected",CONNECTED_ACK:"host:connected_ack",SET_COMPANY:"host:set-company",INSTALLED:"host:installed",OPEN_EXTENSION_MANAGER:"host:open-extension-manager",GET_ACTIVE_TAB:"host:get-active-tab",GET_LAST_ACTIVE_TAB:"host:get-last-active-tab",USER_CANCELLED_INSTALLATION:"extension:user-cancelled-installation",DEV_EXTENSION_VERSION:"0.10.23",ANALYTICS_TRACK:"host:analytics-track",SET_RECORDING_CONFIGURATION:"host:SET_RECORDING_CONFIGURATION",EXTENSION_LAB_FEATURES_CHANGED:"host:lab-features-changed",DEVICE_MIRRORING_PORT:"DEVICE_MIRRORING"},bugim:{ADD_ANNOTATE_STEP:"bugim:add-annotate-step",ANALYTICS_TRACK:"bugim:analytics-track",ANNOTATE:"bugim:annotate",CAPTURE_SCREENSHOT:"bugim:capture-screenshot",CLOSE_BUGIM:"bugim:close-bugim",CURRENT_DATA:"bugim:current-data",DISCARD_ISSUE:"bugim:discard-issue",FAB_IS_ON:"bugim:fab-is-on",LOGGER:"bugim:logger",LOGIN_DATA:"bugim:login-data",PROJECT_ID:"bugim:project-id",PUBLISH_SUCCESS:"bugim:publish-success",RECORD:"bugim:record",RECORD_BUG:"bugim:record-bug",RECORD_COMPLETED:"bugim:record-completed",RECORD_START_TIME:"bugim:record-start-time",REQUEST_ANNOTATE:"bugim:request-annotate",RESTART_CAPTURE_SCREENSHOT:"bugim:restart-capture-screenshot",RESTART_RECORD_BUG:"bugim:restart-record-bug",SAVE_TEST:"bugim:save-test",SET_CURRENT_DATA:"bugim:set-current-data",TEST_DATA:"bugim:test-data",UPLOAD_BASE64_AS_BLOB:"bugim:upload-base64-as-blob",VIDEO_RECORDING_START:"bugim:video-recording-start"},localStorage:{SAVE:"save-to-local-storage",GET:"get-from-local-storage"},localPlayback:{STEP_RESULT_UPDATED:"local-step-result-updated",SETUP_STEP_RESULT_UPDATED:"local-setup-step-result-updated",TEST_RESULT_UPDATED:"test-result-updated",RUN_CONFIG_PARAMS_RESULT:"local-run-config-params-result-updated",STEP_ADDED:"local-step-added",STEP_UPDATED:"local-step-updated",TEST_UPDATED:"local-test-updated",TEST_CONFIG_UPDATED:"local-test-config-updated",TEST_ENDED:"local-test-ended",SEND_API_REQUEST:"send-api-request",ABORT_EXECUTION:"abort-execution"},playback:{DONE:"playback:done",RESULT:"playback:result",SETUP_DONE:"playback:setup_finished",SETUP_STEP:"playback:setup",START:"playback:start",STEP:"playback:step",SHUTDOWN:"playback:shutdown"},recording:{NEW_DOWNLOAD_ITEM:"new-download-item"},scenario:{SHARED_STEP_REVISION_CHANGED:"shared-step-revision-changed",PLAYING:"scenario:playing",ADD_BREAKPOINT:"add-breakpoint",REMOVE_BREAKPOINT:"remove-breakpoint",ADD_SHARED_STEP:"add-shared-step",ADD_STEP:"add-step",ADD_ACCESSIBILITY_PAGE_VALIDATION_STEP:"add-accessibility-page-validation-step",APP_LOGIN:"app-login",APP_LOGOUT:"app-logout",SET_TMA_APPIUM_URLS:"set_TMA_APPIUM_urls",CANCEL_GET_ELEMENT:"cancel-get-element",CAPTURE_SCREENSHOT:"capture-screenshot",DELETE_STEP:"delete-step",GET_LOCATOR:"get-locator",HIGHLIGHT_LOCATE_STEP:"highlight-locate-step",IS_INCOGNITO_ALLOWED:"is-incognito-allowed",IS_FILE_SCHEME_ACCESS_ALLOWED:"is-file-scheme-access-allowed",PAUSE_PLAY:"pause-play",PLAY_STEP:"play-step",PROJECT_SELECTED:"project-selected",PROJECT_CHANGED:"project-changed",BRANCH_CHANGE:"branch-change",BRANCH_CREATED:"branch-created",CURRENT_BRANCH_UPDATE:"current-branch-update",BRANCH_CHANGED:"branch-changed",BRANCH_DELETED:"branch-deleted",BRANCH_REVIEW_REQUIRED_CHANGE:"branch-review-required-change",PROJECTS_LOADED:"projects-loaded",PURGE_LAST_STEP_DATA:"purge-last-step-data",REMOVE_ALL_BREAKPOINTS:"remove-all-breakpoints",RUN_FROM_HERE:"run-from-here",OPEN_AUT:"open-aut",START_RECORDING:"start-recording",TOGGLE_HIGHLIGHT_MOBILE:"toggle-highlight-mobile",FOCUS_MAIN_TAB:"focus-main-tab",NO_TABS_IN_SESSION:"no-tabs-in-session",CREATED_TAB_IN_SESSION:"created-tab-in-session",STOP_PLAY:"stop-play",STOP_RECORDING:"stop-recording",TEST_STOPPED:"test-stopped",TOGGLE_PLAY:"toggle-play",PLAY_WITHOUT_DEBUG:"play-without-debug",PLAY_CODELESS_LOCAL:"play-codeless-local",UPDATE_STEP:"update-step",UPDATE_TEST_MANUALLY:"update-test-manually",SET_BASE_URL_MANUALLY:"set-base-url-manually",ADD_SHARED_STEP_MANUALLY:"add-shared-step-manually",ADD_GROUP_MANUALLY:"add-group-manually",ADD_STEP_MANUALLY:"add-step-manually",UPDATE_STEP_MANUALLY:"update-step-manually",UPDATE_LOCATE_STEP_MANUALLY:"update-locate-step-manually",UPDATE_FORCE_VISIBILITY_MANUALLY:"update-force-visibility-manually",ADD_CONDITION_STEP_MANUALLY:"add-condition-step-manually",DELETE_STEP_MANUALLY:"delete-step-manually",TEST_SAVED:"test:saved",COMPANY_SELECTED:"company-selected",COMPANY_CHANGED:"company-changed",CONDITION_STEP:i.ConditionType.CUSTOM,RESIZE_WINDOW_STEP:"resize-window",SHARED_STEP_INSTANCE:"shared-step-instance",CHECK_AGENT_CONNECTION:"check-agent-connection",CONDITION_DEFAULT_FAILED_TIMEOUT:500,CONDITION_DEFAULT_PASSED_TIMEOUT:500},stepResult:{SETUP_TIMEOUT:"setup-timeout",HTML_ATTRIBUTE_NOT_FOUND:"html-attribute-not-found",HTML_ATTRIBUTE_COMPARE_FAILURE:"html-attribute-compare-failure",UNKNOWN_MOBILE_ATTRIBUTE:"unknown-mobile-attribute",CSS_PROPERTY_NOT_FOUND:"css-prop-not-found",CSS_PROPERTY_COMPARE_FAILURE:"css-prop-compare-failure",ELEMENT_NOT_FOUND:"element-not-found",CONTEXT_ELEMENT_NOT_FOUND:"context-element-not-found",ELEMENT_NOT_VISIBLE:"element-not-visible",ELEMENT_VISIBLE:"element-visible",FAILED_OPACITY:"failed-opacity",FRAME_NOT_VISIBLE:"frame-not-visible",VISIBILITY_IS_HIDDEN:"visibility-is-hidden",ELEMENT_OUTSIDE_OF_VIEWPORT:"element-outside-of-viewport",ELEMENT_HAS_ZERO_HEIGHT_OR_WIDTH:"element-has-zero-height-or-width",GENERIC_ELEMENT_HIDDEN:"element-hidden",ELEMENT_SCORE_BELOW_THRESHOLD:"element-score-below-threshold",EVALUATE_EXPRESSION_EXCEPTION:"evaluate-expression-exception",INVALID_NODE_PACKAGE:"invalid-node-package",NODE_PACKAGE_EXCEPTION:"node-package-exception",FRAME_NOT_FOUND:"frame-not-found",TAB_NOT_FOUND:"tab-not-found",INVALID_TEST_VERSION:"invalid-test-version",INTERNAL_ERROR_IN_AUT:"internal-error-in-aut",STOPPED:"stopped",ABORTED:"aborted",JS_ASSERTION_FAILED:"js-assertion-failed",JS_RESULT_MAX_SIZE_EXCEEDED:"js-result-max-size-exceeded",JS_INVALID_PARAMETER:"js-invalid-parameter",PIXEL_VALIDATION_FAILURE:"pixel-validation-failure",PIXEL_VALIDATION_ENV_FAILURE:"pixel-validation-env-failure",PIXEL_VALIDATION_INCORRECT_CREDENTIALS:"pixel-validation-incorrect-credentials",PORT_NOT_FOUND:"port-not-found",CHECKBOX_VALIDATION_FAILURE:"checkbox-validation-failure",CHECKBOX_VALIDATION_ELEMENTS_FAILURE:"checkbox-validation-elements-failure",TEXT_COMPARE_FAILURE:"text-compare-failure",GET_COOKIE_FAILURE:"get-cookie-failure",DEBUG_LAB_FEATURE_FAILURE:"debug-lab-feature-failure",RESIZE_WINDOW_FAILURE:"resize-window-failure",TEXT_ACTION_FAILURE:"text-action-failure",SPECIAL_KEY_ACTION_FAILURE:"special-key-action-failure",WHEEL_ACTION_FAILURE:"wheel-action-failure",EXTRACT_TEXT_FAILURE:"extract-text-failure",NAVIGATION_FAILURE:"navigation-failure",SCROLL_ACTION_FAILURE:"scroll-action-failure",IOS_LOCATE_FAILURE:"ios-locate-failure",ANDROID_LOCATE_FAILURE:"android-locate-failure",UNKNOWN_ERROR:"unknown-error",CAPTURE_SCREENSHOT_FAILURE:"capture-screenshot-failure",UNWRAPPED_AUT_REJECT:"aut-injected-code-exception",CONTEXT_ELEMENT_TIMEOUT:"context-element-timeout",GET_TAB_TIMEOUT:"get-tab-timeout",GET_FRAME_TIMEOUT:"get-frame-timeout",GET_TOP_FRAME_TIMEOUT:"get-top-frame-timeout",LOCATE_TIMEOUT:"locate-timeout",ACTION_TIMEOUT:"action-timeout",ACTION_EXCEPTION:"action-exception",ACCESSIBILITY_VALIDATION_EXCEPTION:"accessibility-validation-exception",ACCESSIBILITY_VALIDATION_VIOLATIONS:"accessibility-validation-violations",API_FAILURE:"api-failure",MAX_ITERATIONS_EXCEEDED:"max iterations exceeded",COULD_NOT_GET_BROWSER:"tests-could-not-get-browser",BROWSER_TYPE_NOT_SUPPORTED:"browser-type-not-supported",PAGE_NOT_AVAILABLE:"page-not-available",JS_SYNTAX_ERROR:"js-syntax-error",AGENT_CONNECTION_ERROR:"agent-connection-error",COULDNT_SET_COOKIE:"couldnt-set-cookie",MISSING_COOKIE_NAME:"missing-cookie-name",MISSING_COOKIE_VALUE:"missing-cookie-value",MISSING_COOKIE_NAME_AND_VALUE:"missing-cookie-name-and-value",SELECTOR_EVALUATION_FAILURE:"selector-evaluation-failure",LOAD_FILE:"load-file",FILE_SIZE_LIMIT:"file-size-limit",DOWNLOAD_INTERRUPTED:"download-interrupted",FILE_DANGEROUS:"file-dangerous",DOWNLOAD_TIMEOUT_BEFORE_START:"download-timeout-before-start",DOWNLOAD_TIMEOUT_BEFORE_FINISHED:"download-timeout-before-finished",INVALID_DOWNLOAD_STATE:"download-invalid-state",EMAIL_FAILURE:"email-failure",EMAIL_NOT_FOUND:"email-not-found",INVALID_EMAIL:"invalid-email-address",EMAIL_GENERATE_FAILURE:"email-generate-failure",API_REQUEST_NETWORK_ERROR:"api-network-error",FILTERED_EMAIL_NOT_FOUND:"filtered-email-not-found",INBOX_EMPTY:"inbox-empty",SALESFORCE_STEP_INPUT_ERROR:"salesforce-step-input-error",SALESFORCE_APEX_FAILURE:"salesforce-apex-failure",SALESFORCE_APEX_COMPILE_ERROR:"apex-compile-error",SALESFORCE_APEX_RUNTIME_ERROR:"apex-runtime-error",MFA_RETRIEVE_ERROR:"mfa-retrieve-error"},AUT:{TESTIM_FRAME_ID:"testim-frame-id",HIGHLIGHT_LOCATOR:"highlight-locator",END_LOCATOR:"end-locator",CANCEL_LOCATOR:"cancel-locator",REGISTERD:"aut-registerd",REGISTERED:"aut-registered",LOCATOR:"locator",CLOSE_POPUP:"aut-frame:close-popup",OPEN_POPUP:"aut-frame:open-popup",SET_MESSAGE:"aut-frame:set-message",SET_MESSAGE_RESPONSE:"aut-frame:set-message-response",GO_TO_EDITOR:"aut-frame:go-to-editor",AUT_FRAME_LOADED:"aut-frame:loaded",KEY_STATE_CHANGE:"aut:key-state-change",CONTEXT_SELECTION_MODE:"context-selection-mode",UPDATE_SELECTED_ELEMENT_TEXT:"aut:update-text",TESTIM_AUT_FRAME_PORT_NAME:"TestimFrameInAUT",STOP_RECORDING_AND_RETURN_TO_EDITOR:"aut-frame:stop-recording-and-go-to-editor",STOP_SUGGESTIONS:"aut-frame:stop-suggestions",REPORT_STEPS_COUNT:"aut:report-steps-count",SEND_GROUP_SUGGESTIONS:"aut:send-group-suggestions",SELECT_GROUP_SUGGESTIONS:"aut:select-group-suggestions",SELECT_GROUP_SUGGESTIONS_DONE:"aut:select-group-suggestions-done",SUGGESTED_GROUP_PLAYBACK:"aut:suggested-group-playback",SHOW_OVERLAY:"aut:show-overlay",HIDE_OVERLAY:"aut:hide-overlay",SET_RECORDING_CONFIGURATION:"aut:set-recording-configuration",INTERNAL_LOG_PREFIX:"__internalTestimLog__:",REGISTER_SCOPE:"register-switchboard-scope"},frame:{ADDED:"frame:added",NOT_INITIATED:"frame:not-initiated"},tab:{ADDED:"tab:added",SESSION_TABS_UPDATED:"tab:session-tabs-updated",GET_ZOOM:"tab:get-zoom-level"},labFeatures:{PROJECT_LAB_FEATURES_CHANGED:"labfeatures:project-changed",PROJECT_LAB_FEATURES_LOADED:"labfeatures:project-loaded"},plan:{PLAN_SELECTED:"plan:selected"},test:{DEFAULT_TEST_NAME:"untitled test",LOADED:"test:loaded",DESKTOP_WEB:"desktopWeb",MOBILE_WEB:"mobileWeb",ANDROID:"android",IOS:"ios",HIDDEN_PARAM:"TST_HIDDEN_PARAM",PARAMS_METADATA_FIELD:"*metadata"},testStatus:{STOPPED:"stopped",PAUSED:"paused",RUNNING:"running",COMPLETED:"completed",PENDING:"pending"},notification:{SHOW_NOTIFICATION:"notification:show-notification",FAILED_STEP:"notification:failed-step"},mobileWeb:{MOBILE_WEB_DEBUGGER_HEADER_SPACING:70,MOBILE_WEB_DEBUGGER_HEADER_VERTICAL_SPACING_WINDOWS:16},mobile:{INIT_DEVICE:"init-device",TAKE_SCREEN_SHOT:"screen-shot",OPEN_APP:"mobile:open-app",MOBILE_SESSION_ABORTED:"mobile:session-aborted",REMOVE_SELECTED_DEVICE:"mobile:remove-selected-device",MISSING_NAME:"Missing application name"},MOBILE_SKIP_REASON_MAP:{[t.MOBILE_RUN_SKIP_REASON.APP_FROM_DEVICE]:"Skipped, the selected app is from device",[t.MOBILE_RUN_SKIP_REASON.VIRTUAL_BUILD]:"Skipped, the selected app has been compiled for virtual device"},stepStatus:{WHILELOOP_DONE:"whileloop-done",WHILELOOP_RUNNING:"whileloop-running",COMPLETED:"completed",RUNNING:"running"},SHARED_STEP_DISABLED_REASON:{PAYING_CUSTOMERS_ONLY:"This step is available for paying customers only",FEATURE_NOT_INCLUDED_IN_PLAN:"This step is not included in this plan",APPLITOOLS_NOT_CONNECTED:"This step requires configuring the Applitools integration"},warning:{VALIDATE_TEXT_ON_ELEMENT_SELECTION:"The selected element does not contain text.\n If you meant to select the object with text, try to reselect the inner element."},error:{MESSAGE_LENGTH_EXCEEDED_MAX_LENGTH_ERROR_MESSAGE:"Message length exceeded maximum allowed length.",CIRCULAR_SCENARIO_DETECTED:"circular-scenario-detected",NOT_ON_CHROME:"not-on-chrome",NO_APP_TO_CHOOSE_AN_ELEMENT_FROM:"No app to choose an element from.",PASSWORD_COMPLEX_ERROR:"Password must be 8 characters long and contain at least one digit, one symbol and no spaces.",REQUEST_TIMED_OUT:"There was a connection error in the API request to the server.",QUOTA_EXECUTION_BLOCKED:"You have reached the limit of runs for the billing month"},company:{DEFAULT_STORAGE_BASE_URL:"https://testimstatic.blob.core.windows.net",DEFAULT_STORAGE_TYPE:"cloudinary"},grids:{testim:"Testim grid",[r.GRID_TYPE_TESTIM_HYBRID]:"Testim HA grid",[r.GRID_TYPE_TESTIM_ENTERPRISE]:"Testim enterprise grid",[r.GRID_TYPE_TESTIM_DF]:"Testim df grid",[r.GRID_TYPE_LAMBDA_TEST]:"Testim grid (LT)",[r.GRID_TYPE_HEADSPIN]:"Testim Headspin Mobile",[r.GRID_TYPE_TESTIM_TDC]:"Tricentis Device Cloud",[r.GRID_TYPE_TESTIM_TVC]:"Virtual Mobile Grid",[r.GRID_TYPE_P_CLOUDY]:"pCloudy",local:"Custom grid",saucelabs:"Saucelabs",browserstack:"Browserstack",lambdaTest:"LambdaTest"},gridTypes:r,gridHosts:{FREE_GRID_TESTIM:"trial-grid.testim.io"},assignTypes:{REASSIGN:"assignTypes:REASSIGN",ASSIGN:"assignTypes:ASSIGN",IMPROVE:"assignTypes:IMPROVE"},recaptcha:{PUBLIC_KEY:"6LcJr2oUAAAAAO7zoza-re23OxzO-9oT5CMwHPJw"},exportScopes:{LOCAL:"local",TEST:"test",GLOBAL:"global"},KEYS:{enter:13,escape:27,left:37,up:38,right:39,down:40,space:32,backspace:8,comma:188,tab:9,shift:16,ctrl:17,alt:18,meta:93},socketEventTypes:{CONNECT:"connect",RECONNECT:"reconnect",DISCONNECT:"disconnect",ERROR:"error",STEP_RESULT:"update-step-result",SETUP_STEP_RESULT:"update-setup-step-result",TEST_RESULT_CREATED:"test-result-created",TEST_RESULT_UPDATED:"test-result-updated",RUN_CONFIG_PARAMS_RESULT:"update-run-config-params-result",RUN_RESULT_CREATED:"run-result-created",RUN_RESULT_UPDATED:"run-result-updated",STEP_ADDED:"step-added",STEP_UPDATED:"step-updated",TEST_UPDATED:"test-updated",TEST_CONFIG_UPDATED:"test-config-updated",REMOTE_STEP_SAVED:"remote-step-saved",TMS_MAPPING_IN_PROGRESS:"InProgress",TMS_MAPPING_COMPLETED:"Completed"},locators:{TESTIM_ID_FIELD_NAME:"testim_dom_element_id",DYNAMIC_PARENT_FIELD_NAME:"testim_dynamic_parent",DYNAMIC_CHILD_FIELD_NAME:"testim_dynamic_child",TESTIM_FRAME_ID:"testim_frame_id",TESTIM_SHADOW_ROOT_ID:"testim_shadow_root_id",EMPTY_RESULT:"emptyResult",CONTEXT_ATTR:"testim-context-element-id",CONTEXT_POINTER_ATTR:"testim-context-element-pointer",EMPTY_RESULT_ID:-1,MAX_TEXT_CONTENT_LENGTH:30,MAX_INNER_TEXT_LENGTH:500,MINIMAL_SCORE_THRESHOLD:.01,SCORE_THRESHOLDS:{VERY_LOW:.01,LOW:.2,MEDIUM:.4,HIGH:.6,VERY_HIGH:.8,STRICT:1},strategy:{SELECTOR:"selector",LOCATOR:"locator"}},globalSelectors:{editorAddStep:"ReactVirtualized__Grid__innerScrollContainer"},serverResponses:{UNKNOWN_ERROR:"unknown",USER_EXISTS_ERROR:"user-exists",USER_DISABLED_ERROR:"user-disabled",USER_EXISTS_DIFFERENT_PROVIDER_ERROR:"user-exists-different-provider",NOT_WORK_EMAIL:"not-work-email",EMAIL_NOT_FOUND:"email-not-found",INVALID_EMAIL:"invalid-email",WEAK_PASSWORD:"weak-password",WRONG_PASSWORD:"wrong-password",USER_SSO_FORCED:"user-sso-forced",MAX_RESET_PASSWORD:"max-reset-password",MARKETO_SIGNUP_EXISTS:"marketo-signup-exists"},HOOK:{HANDLER:{BEFORE_TEST:"beforeTest",BEFORE_STEP:"beforeStep",AFTER_STEP:"afterStep",AFTER_TEST:"afterTest"},SHORT_LABEL:{beforeTest:"before test",afterTest:"after test",beforeStep:"before step",afterStep:"after step"},LABEL:{beforeTest:"Before test handler",afterTest:"After test handler",beforeStep:"Before each step handler",afterStep:"After each step handler"},FAIL_PREFIX:{beforeTest:"Failed on before test hook",afterTest:"Failed on after test hook",beforeStep:"Failed on before step hook",afterStep:"Failed on after step hook"},CONDITION:{ALWAYS:"always",SUCCESS:"success",FAILURE:"failure"},CONDITIONED:["afterTest","afterStep"]},ITERATION_METHODS:{DOM_INDEX_AT_RUN:"dom-index-at-run",DOM_ATTR_IDENTITY:"dom-attr-identity"},improveLocatorDiff:{sameElement:"sameElement",differentElement:"differentElement",onlyImprovedFound:"onlyImprovedFound",onlyOriginalFound:"onlyOriginalFound",bothDidntFind:"bothDidntFind",lowerScore:"lowerScore",higherScore:"higherScore",sameScore:"sameScore"},locateBannerMode:{LOCAL_NEWER:"showLocalLocatorNewerBanner"},FILTERED_INCOMING_PARAMS:["_stepInternalData","_stepInternalParam","_stepData","*metadata","TESTIM_ITERATOR"],AUT_JS_CODE_STEP_TYPES:["validation-code-step","wait-for-code-step","action-code-step","network-validation-step","email-validation-step","api-validation","api-action"],sharedStepsFriendlyNames:{__default_CLI:"Custom CLI validation",__default:"Custom step","user-code":"Custom step","action-code-step":"Custom action","api-action":"API action","api-validation":"API validation","cli-action-code-step":"CLI action","cli-validation-code-step":"CLI validation","cli-validation-download-file":"Validate Download","cli-wait-for-code-step":"Wait for CLI validation","cli-wait-for-download-file":"Wait for download","email-validation-step":"Validate Email","network-validation-step":"Network validation","validation-code-step":"Custom validation","wait-for-code-step":"Wait for custom validation","salesforce-apex-action":"Salesforce Apex Action","accessibility-validation-shared-step":"Accessibility Validation",group:"Group","marketplace-wrapper":"","execute-driver-script":"Custom Action"},mockNetworkStorage:{PATH:"mock-network",HAR_FILE_DIRECTORY:"har-file",MAPPING_FILE_DIRECTORY:"mapping-file"},documentationUrls:{BASE_URL:"https://help.testim.io/docs",ACTION_CODE_STEP:"https://help.testim.io/docs/custom-code#creating-a-custom-action",API_ACTION_STEP:"https://help.testim.io/docs/api-testing#api-action",API_VALIDATION_STEP:"https://help.testim.io/docs/api-testing#api-validation",CHECKBOX_VALIDATION_STEP:"https://help.testim.io/docs/checkbox-and-radio-button-validation",CSS_PROPERTY_VALIDATION_STEP:"https://help.testim.io/docs/css-property-validation",CREATE_MOBILE_TEST:"https://help.testim.io/docs/recording-a-mobile-test",CREATE_WEB_TEST:"https://help.testim.io/docs/creating-your-first-codeless-test",CLI_ACTION_CODE_STEP:"https://help.testim.io/docs/cli-actions#creating-a-cli-action",CLI_VALIDATION_CODE_STEP:"https://help.testim.io/docs/cli-actions#creating-a-cli-action",CLI_WAIT_FOR_CODE_STEP:"https://help.testim.io/docs/cli-actions#creating-a-cli-action",EMAIL_VALIDATION_STEP:"https://help.testim.io/docs/email-validation",ELEMENT_ACCESSIBILITY_STEP:"https://help.testim.io/docs/element-accessibility-validation",ELEMENT_VISIBLE_STEP:"https://help.testim.io/docs/validation#element-visible",EXTRACT_TEXT_STEP:"https://help.testim.io/docs/extract-text",GENERATE_DATE_STEP:"https://help.testim.io/docs/generating-a-date",GENERATE_EMAIL_STEP:"https://help.testim.io/docs/email-validation#randomly-generated-temporary-email-addresses",GENERATE_RANDOM_VALUE_STEP:"https://help.testim.io/docs/generating-a-random-value",GET_COOKIES_STEP:"https://help.testim.io/docs/cookies",GROUPS:"https://help.testim.io/docs/groups",HOVER_STEP:"https://help.testim.io/docs/hover-step",HTML_ATTRIBUTE_VALIDATION_STEP:"https://help.testim.io/docs/html-attribute-validation",FILE_UPLOAD_STEP:"https://help.testim.io/docs/file-upload-step",NAVIGATION_STEP:"https://help.testim.io/docs/navigation",NETWORK_VALIDATION_STEP:"https://help.testim.io/docs/add-network-validation",PAGE_ACCESSIBILITY_STEP:"https://help.testim.io/docs/accessibility-validations",PIXEL_VALIDATION_STEP:"https://help.testim.io/docs/pixel-validation-and-pixel-wait-for#how-to-add-pixel-validation",PIXEL_WAIT_FOR_STEP:"https://help.testim.io/docs/pixel-validation-and-pixel-wait-for#how-to-add-pixel-wait-for",REFRESH_STEP:"https://help.testim.io/docs/refresh-page",SET_COOKIES_STEP:"https://help.testim.io/docs/cookies",SCROLL_STEP:"https://help.testim.io/docs/scroll",SLEEP_STEP:"https://help.testim.io/docs/wait-for#sleep",TEXT_VALIDATION_STEP:"https://help.testim.io/docs/validation#element-text",VALIDATION_CODE_STEP:"https://help.testim.io/docs/custom-code#creating-a-custom-validation",WAIT_FOR_STEP:"https://help.testim.io/docs/wait-for",WAIT_FOR_TEXT_STEP:"https://help.testim.io/docs/wait-for#wait-for-element-text",WAIT_FOR_CODE_STEP:"https://help.testim.io/docs/wait-for#custom-wait-for",SALESFORCE_AUTO_LOGIN_STEP:"https://help.testim.io/docs/salesforce-auto-login-step",SALESFORCE_APEX_STEP:"https://help.testim.io/docs/salesforce-apex-action-step",CI_INTEGRATION:"https://help.testim.io/docs/integrate-testim-to-your-ci",DASHBOARD:"https://help.testim.io/docs/dashboard",AUTO_IMPROVE:"https://help.testim.io/docs/locators-auto-improve",HIGH_SPEED:"https://help.testim.io/docs/turbo-mode",TEST_CONFIG:"https://help.testim.io/docs/how-to-record-a-test#test-configuration-parameters",TESTIM_MOBILE:"https://help.testim.io/docs/creating-your-first-mobile-test-in-testim-visual-editor-edited",TESTIM_MOBILE_APPS:"https://help.testim.io/docs/mobile-apps",TESTIM_MOBILE_AGENT:"https://help.testim.io/docs/configure-tricentis-mobile-agent"},sfdcDocumentationUrls:{BASE_URL:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce",DASHBOARD:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce/content/testops/insights.htm",CREATE_WEB_TEST:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce/content/gettingstarted/create_salesforce_test.htm",CI_INTEGRATION:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce/content/integrations/ci_integrations.htm",SALESFORCE_PERSONA:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce/content/gettingstarted/create_manage_profiles.htm",SALESFORCE_MFA:"https://help.testim.io/docs/salesforce-auto-login-step#setting-up-mfa",COPADO_INTEGRATION:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce/content/integrations/copado_integration.htm",GEARSET_INTEGRATION:"https://documentation.tricentis.com/tricentis_test_automation_for_salesforce/content/integrations/gearset_integration.htm"},tricentisUrls:{SUPPORT_HUB:"https://support-hub.tricentis.com/",REQUEST_DEMO:"https://www.tricentis.com/software-testing-tool-trial-demo/test-automation-salesforce-demo",ACADEMY_YOUTUBE_PLAYLIST:"https://www.youtube.com/playlist?list=PL_mckFOFnjHkbCjJ8-hIyEYhn-tVaI85i"},TEST_STATUS:{ACTIVE:"active",QUARANTINE:"quarantine",DRAFT:"draft",EVALUATING:"evaluating"},TEST_RESULT:{PASSED:"Passed",FAILED:"Failed",QUEUED:"Queued",RUNNING:"Running",ABORTED:"Aborted",TIMEOUT:"Timeout",SKIPPED:"Skipped"},RUNNER_STATUS:{FINISHED:"FINISHED",QUEUED:"QUEUED",RUNNING:"RUNNING",ABORTED:"ABORTED",TIMEOUT:"TIMEOUT",SKIPPED:"SKIPPED"},PREFERENCES_ENTRIES:{TEST_LIST:"testList",SHARED_STEPS:"sharedSteps",EXECUTION_LIST:"executionList",TEST_RUN_LIST:"testRunList",SCHEDULER_LIST:"schedulerList",CONFIG_LIST:"configList",TEST_OPS_DASHBOARD:"testOpsDashboard"},EMAIL_VALIDATION_TYPE:{CODELESS:"codeless",CODED:"coded"},applitools:{CLOSE_BATCH:"applitools:close-batch"},integrations:{trelloStorageKey:"trelloToken"},tooltipText:{demoProject:"You have view-only access",payingCustomerChangeStatus:"Editing test's status isn't supported in the free plan",saveViewOnlyOnPinnedBranch:"Only enabled for Pinned Branch",reconnectSfdcEnvironmentTooltip:"Connection to environment lost. Reconnect"},MOBILE_APP_FILE_TYPES:{ANDROID:"apk",IOS:"ipa",IOS_SIMULATOR:"app",NATIVE_IOS_SIMULATOR:"app.zip"},MOBILE_APP_MIME_TYPES:{ANDROID:"application/vnd.android.package-archive",IOS:"application/octet-stream"},MARKETO_FORMS:{TTA_SFDC:"https://www.tricentis.com/software-testing-tool-trial-demo/test-automation-salesforce-trial",TESTIM:"https://www.testim.io/try-testim/"},MOBILE_SOCKET_EVENTS_TYPES:{DEVICE_CONNECTED:"DEVICE_CONNECTED",DEVICE_DISCONNECTED:"DEVICE_DISCONNECTED",LOCAL_STATE_CHANGED:"LOCAL_STATE_CHANGED",CLOUD_STATE_CHANGE:"CLOUD_STATE_CHANGE"},SFDC_COMMON:{PRODUCTION_LOGIN_URL:"https://login.salesforce.com",SANDBOX_LOGIN_URL:"https://test.salesforce.com"},PRODUCT_URLS:{TESTIM_CONTACT_US:"https://www.testim.io/contact-us/",TESTIM_PRICING:"https://www.testim.io/pricing/",TTA_SFDC_CONTACT_US:"https://www.tricentis.com/contact-us",TTA_SFDC_PRICING:"https://www.tricentis.com/products/test-automation-salesforce/pricing"},DEBUGGER:{STEP_INTO:"stepInto",STEP_OUT:"stepOut",STEP_OVER:"stepOver",PAUSE:"pause",CONTINUE:"continue"},KEY_BINDING_LAYERS:{RUN:"run"},TEST_QUOTA_TYPE:{WEB:"web",MOBILE:"mobile"},INPUT_TYPES:{MOUSE:"mouse",KEYBOARD:"keyboard"},MOBILE_GRID_API:{TDC:"api.tricentis.headspin.io",HEADSPIN:"api-dev.headspin.io"},MOBILE_GRID_UI:{TDC:"https://tdc.tricentis-cloud.com",HEADSPIN:"https://ui.headspin.io"},TMS_PROVIDERS:{TTM4J:"ttm4j",TESTRAIL:"testrail",QTEST:"qtest",XRAY:"xray"},AUTH_PROVIDERS:{PASSWORD:"password",GITHUB:"github.com",GOOGLE:"google.com",SALESFORCE:"salesforce.com",OKTA:"okta"},TEXT_EXTRACTION_TYPE:{FROM:"from",TO:"to",BETWEEN:"between",REGEX:"regex"}};var c;(function(e){e["TEST"]="test";e["FOLDER"]="folder";e["SHARED_STEP"]="sharedStep"})(c||(t.FOLDER_CHILD_TYPES=c={}));t.commonConstants=a;t.TESTIM_EXTENSION_ID=a.TESTIM_EXTENSION_ID;t.MASTER_BRANCH=a.MASTER_BRANCH;t.RECORD_BUTTON_ID=a.RECORD_BUTTON_ID;t.AUT=a.AUT;t.KEYS=a.KEYS;t.applitools=a.applitools;t.assignTypes=a.assignTypes;t.bugim=a.bugim;t.company=a.company;t.defaults=a.defaults;t.error=a.error;t.exportScopes=a.exportScopes;t.frame=a.frame;t.gridTypes=a.gridTypes;t.grids=a.grids;t.host=a.host;t.localPlayback=a.localPlayback;t.localStorage=a.localStorage;t.locators=a.locators;t.plan=a.plan;t.plans=a.plans;t.playback=a.playback;t.recaptcha=a.recaptcha;t.recording=a.recording;t.scenario=a.scenario;t.socketEventTypes=a.socketEventTypes;t.stepResult=a.stepResult;t.stepStatus=a.stepStatus;t.tab=a.tab;t.test=a.test;t.testStatus=a.testStatus;t.user=a.user;t.window=a.window;t.improveLocatorDiff=a.improveLocatorDiff;t.HOOK=a.HOOK;t.ITERATION_METHODS=a.ITERATION_METHODS;t.locateBannerMode=a.locateBannerMode;t.serverResponses=a.serverResponses;t.sharedStepsFriendlyNames=a.sharedStepsFriendlyNames;t.mockNetworkStorage=a.mockNetworkStorage;t.TEST_STATUS=a.TEST_STATUS;t.RUNNER_STATUS=a.RUNNER_STATUS;t.TEST_RESULT=a.TEST_RESULT;t.SHARED_STEP_DISABLED_REASON=a.SHARED_STEP_DISABLED_REASON;t.tooltipText=a.tooltipText;t.mobile=a.mobile;t.MOBILE_APP_FILE_TYPES=a.MOBILE_APP_FILE_TYPES;t.MOBILE_APP_MIME_TYPES=a.MOBILE_APP_MIME_TYPES;t.MOBILE_SOCKET_EVENTS_TYPES=a.MOBILE_SOCKET_EVENTS_TYPES;t.globalSelectors=a.globalSelectors;t.DEBUGGER=a.DEBUGGER;t.KEY_BINDING_LAYERS=a.KEY_BINDING_LAYERS;t.INPUT_TYPES=a.INPUT_TYPES;t.MOBILE_SKIP_REASON_MAP=a.MOBILE_SKIP_REASON_MAP;t.MOBILE_GRID_API=a.MOBILE_GRID_API;t.MOBILE_GRID_UI=a.MOBILE_GRID_UI;t.SECRET_CREDENTIAL_MASK="*******";t.SIGNUP_COUNTRY_KEY="signupCountry"},,function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.Logger=void 0;const i=s(6);const o=s(54);const n=s(97);const r=50;const a=2e3;let c=[];let l=[];const u="d0eb01da-f966-1663-63c6-8871225d7c39";const d="testim";const p=e.env.isClickimEditor?"clickim-editor":"clickim";const h="https://api.coralogix.com/api/v1/logs";let f=true;const m={};const g=()=>{if(c.length>0){C(c,u);c=[]}if(l.length>0){C(l,u);l=[]}};const v=setInterval(g,a);function S(e,t){if(false){}const s=Object.assign({type:"Log",message:e,timestamp:Date.now()},t);l.push(s);if(l.length>r){g()}}function y(t,s,i,o){if(false){}const n={type:s,message:t,loggerName:o,timestamp:Date.now(),app:e.env.isMobileMirror&&"MobileMirror"||e.env.isClickimEditor&&"Editor"||"Extension"};if(false){}if(true){const e={release:true,branch:"production"};Object.assign(n,e)}if(true){const e={app:"CI"};Object.assign(n,e)}Object.assign(n,i);c.push(n);if(c.length>r){g()}}const b={Debug:1,Verbose:2,Log:3,Warn:4,Error:5,Exception:6};let _="Log";try{_=o.injectorUtils.isNode()&&e.env.LOGGER_LEVEL||typeof localStorage!=="undefined"&&localStorage.getItem("testim_log_level")||"Log";if(!(_ in b)){_="Log"}}catch{}let T=false;try{T=typeof localStorage!=="undefined"&&_.toLowerCase()==="verbose"}catch{}const E=o.injectorUtils.isNode()&&parseInt(e.env.LOGGER_CONSOLE||"0",10);const I=T||E;function C(e,t){const s=e.map((e=>({timestamp:e.timestamp,severity:b[e.type],text:JSON.stringify(e),category:e.app,className:e.loggerName})));const i={privateKey:t,applicationName:d,subsystemName:p,logEntries:s};try{const e=new XMLHttpRequest;e.open("POST",h,true);e.setRequestHeader("Content-type","application/json; charset=UTF-8");e.send(JSON.stringify(i))}catch(e){}}class D{static setGlobalInfo(e){Object.assign(m,e)}static setGlobalInfoGetter(e,t){Object.defineProperty(m,e,{get:t})}static getGlobalInfo(){return m}static getLogger(e){return new D(e)}static clearLoggerInterval(){clearInterval(v)}constructor(e){this.name=e;this.info={}}static disable(){f=false}static enable(){f=true}static replaceErrors(e,t){if(t instanceof n.TypedHttpError){return i.pick(t,"status","message","stack","timedout")}if(t instanceof Error){return i.pick(t,Object.getOwnPropertyNames(t))}return t}report(e,t,s){if(!f){return}s=Array.apply([],s);s=s.map((e=>{if(typeof e==="object"){return JSON.stringify(e,D.replaceErrors)}return e}));if(b[e]>=b[_]){const t=Object.assign({},D.getGlobalInfo(),this.info);y(s.join(" "),e,t,this.name)}if(I){t.apply(console,s)}}setInfo(e){Object.assign(this.info,e||{})}debug(...e){this.report("Debug",console.debug,e)}verbose(...e){this.report("Verbose",console.info,e)}log(...e){this.report("Log",console.log,e)}warn(...e){this.report("Warn",console.warn,e)}error(...e){this.report("Error",console.error,e)}exception(...e){this.report("Exception",console.error,e)}logAnalytics(e,t){if(!f){return}S(e,t)}}t.Logger=D}).call(this,s(35))},function(e,t,s){"use strict";s.r(t);s.d(t,"utils",(function(){return g}));var i=s(289);var o=s.n(i);var n=s(109);var r=s.n(n);var a=s(290);var c=s.n(a);var l=s(94);var u=s.n(l);var d=s(177);var p=s.n(d);var h=s(54);var f=s.n(h);s.d(t,"TimeoutError",(function(){return n["TimeoutError"]}));var m=Math.pow;const g={get servicesUrl(){return l["servicesUrlGetter"]()}};function v(e){return e&&e instanceof window.Window}function S(e){return e&&typeof e==="object"&&!e.nodeType&&!v(e)}function y(e){return e!==null&&e instanceof Object&&!Array.isArray(e)&&!(e instanceof Date)}function b(e,t){let s;let i;let o;let n;let r;let a;let c;let l;const u=typeof t;let d;const p=arguments.length;const h=e.deep;const f=e.own;if(t===null||u!=="object"&&u!=="function"){t={}}for(d=2;d<p;d++){s=arguments[d];if(s){for(i in s){o=i;n=t[o];r=s[o];l=f&&!Object.hasOwn(s,o)||(t===r||void 0===r);if(!l){a=Array.isArray(r);if(h&&r&&(a||S(r))){if(a){a=false;c=n&&Array.isArray(n)?n:[]}else{c=n&&S(n)?n:{}}t[o]=b(e,c,r)}else{try{t[o]=r}catch(e){}}}}}}return t}function _(e){const t=typeof e;let s=0;const i={own:true};if(t==="boolean"){i.deep=e;s=1}const o=Array.prototype.slice.call(arguments,s);o.splice(0,0,i);return b.apply(null,o)}function T(e,t){t=t!==false;const s=typeof e;if(s==="undefined"||e===null){return e}if(s!=="object"){return e}if(e instanceof Date){return new Date(e)}if(e instanceof Array){return t?e.map((e=>T(e,t))):e.slice(0,e.length)}return t?Object.keys(e).reduce(((s,i)=>{s[i]=T(e[i],t);return s}),{}):Object.clone(e)}g.isNone=function e(t){return t===void 0||t===null};g.mergeObjects=function e(t,s){if(Array.isArray(t)&&Array.isArray(s)){return t.concat(s)}if(!y(s)||!y(t)){return t}const i=Object.keys(s);return i.reduce(((t,i)=>{const o=s[i];if(t.hasOwnProperty(i)&&y(o)&&y(t[i])){e(t[i],o)}else if(Array.isArray(o)&&Array.isArray(t[i])){t[i]=t[i].concat(o)}else{t[i]=T(o)}return t}),t)};g.isSelectionSupportedOnElement=function(e){const t=["text","search","url","telephone","password"];return e.tagName==="INPUT"&&t.includes(e.type.toLowerCase())};g.selectTextInside=function(e,t,s){if(this.isSelectionSupportedOnElement(e)){e.setSelectionRange(t,s)}};g.selectAllTextInside=function(e){const t=e.value;if(t){this.selectTextInside(e,0,t.length)}};g.sanitize=function(e,t=new Set){if(e===void 0){return null}if(t.has(e)){return e}if(Array.isArray(e)){t.add(e);return e.map((e=>g.sanitize(e,t)))}if(y(e)){t.add(e);return Object.keys(e).reduce(((s,i)=>{if(g.isLegalName(i)){s[i]=g.sanitize(e[i],t)}return s}),{})}return e};let E=1;g.isMinimalDragDistance=function(e,t){const s=30;return Math.hypot(e.x-t.x,e.y-t.y)>=s};g.isObject=y;g.extendWithOptions=b;g.extend=_;g.clone=T;g.nextId=function(){return E++};g.getStorage=function(){return this.hasStorage()?window.localStorage:{getItem(){return null},setItem(){},removeItem(){},clear(){},key(){return null},length:0}};g.isWithinTargetRect=function(e,t,s){return d["isWithinTargetRect"](e,t,s)};g.isWithinBounds=function(e,t,s){return d["isWithinBounds"](e,t,s)};g.compareOrMatch=function(e,t){if(typeof t!=="string"){throw new Error("The second argument must be a string")}return g.isRegExp(e)?new RegExp(e).test(t.trim()):g.compareTexts(String(e),t)};g.isUiVerificationStep=function(e){return["simple-ui-verification","wait-for-simple-ui-verification"].includes(e)};g.isSfdcStep=function({type:e}={type:""}){return e.startsWith("sfdc-")};g.randNumberAtLengthOf=e=>Math.floor(Math.random()*m(10,e||1));g.getNewPathForParamInStep=(e,t)=>{if(e){if(e.includes(t)){return e}return`${e}:${t}`}return`${t}`};g.isTurboMode=e=>["turbomode","highspeed"].includes(e==null?void 0:e.toLowerCase());g.isInvalidTestTimeout=e=>{const t=3*60*60;return e<1||e>t};Object.assign(g,h["injectorUtils"],i,n,a,l)},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.useLocalStoreWithInjectedDependencies=t.useDependencyInjector=t.DependencyInjectionProvider=t.DIContext=void 0;const i=s(4);const o=s(0);const n=s(9);const r=s(7);const a=r.Logger.getLogger("di-provider");t.DIContext=(0,o.createContext)({container:null});const c=e=>(0,i.jsx)(t.DIContext.Provider,{value:{container:e.container},children:e.children});t.DependencyInjectionProvider=c;t.DependencyInjectionProvider.displayName="DependencyInjectionProvider";function l(e){const{container:s}=(0,o.useContext)(t.DIContext);if(!s){throw new Error("useDependencyInjector missing DI container in context")}return s.get(e)}t.useDependencyInjector=l;function u(e){const{container:s}=(0,o.useContext)(t.DIContext);if(!s){throw new Error("useLocalStoreWithInjectedDependencies missing DI container in context")}const i=(0,o.useMemo)((()=>{const t=Reflect.getMetadata(n.METADATA_KEY.DESIGN_PARAM_TYPES,e)||[];const i=t.map(((e,i)=>{try{return s.get(e)}catch(s){const o=`Failed to find dependency for: ${e.name}, param index:${i}, dependencyClasses: ${String(t)}`;if(false){}else{a.exception(o,s)}return undefined}}));return new e(...i)}),[e,s]);(0,o.useEffect)((()=>()=>{var e,t;return(t=(e=i).dispose)===null||t===void 0?void 0:t.call(e)}),[i]);return i}t.useLocalStoreWithInjectedDependencies=u},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimBaseApi=void 0;const i=s(77);const o=s(8);const n=s(5);const r=s(7);const a=s(145);const c=s(42);const l=s(2);const u=r.Logger.getLogger("base-api-logger");class d{constructor(e=new a.CallOrderScheduler){this.callOrderScheduler=e}changeTestimBaseUrl(e){this.baseUrl=e}get(e,t,s={},o=2,n=1e3){return(0,i.default)((()=>this.request((()=>this.rawGet(e,t,{...this.getAuthHeader(),...s}))).catch((e=>{if(e&&e.status===401){return}throw e}))),{retries:o,minTimeout:n})}getAuthHeader(){const e=this.authenticationManager;if(!e.loginData){return{}}return{Authorization:`Bearer ${e.loginData.token}`,refreshtoken:e.loginData.refreshToken||""}}refreshToken(e,t){return this.rawPostJson("/auth/refreshToken",{token:e,refreshToken:t})}getNewToken(e){if(e===null||e===void 0?void 0:e.refreshToken){if(this.pendingRefreshTokenPromise){return this.pendingRefreshTokenPromise}const t=this.refreshToken(e.token||"",e.refreshToken).catch((e=>{u.error("failed to call refresh token, logout",e);this.authenticationManager.logout(n.commonConstants.user.SESSION_INACTIVE)}));this.pendingRefreshTokenPromise=t;t.finally((()=>delete this.pendingRefreshTokenPromise));return t}if(o.utils.isNode()){return Promise.reject(new Error("failed to refresh token"))}u.log("getNewToken",{expires:e===null||e===void 0?void 0:e.tokenExpIn,doesLoginDataExist:Boolean(e),doesRefreshTokenExist:Boolean(e===null||e===void 0?void 0:e.refreshToken),doesTokenExist:Boolean(e===null||e===void 0?void 0:e.token)});return Promise.reject(new i.AbortError(new Error("failed to refresh token")))}getToken(){return(0,l.untracked)((async()=>{const e=this.authenticationManager;const{loginData:t}=e;const s=t===null||t===void 0?void 0:t.token;if(s&&e.isTokenAlive()){return s}const o=await(0,i.default)((()=>this.getNewToken(t)),{retries:2});const{token:n,refreshToken:r}=o;if(n||r){e.updateDataOnRefreshToken(o);return n}throw new Error("refresh token data is invalid")}))}async refreshTokenOnExp(e){const t=await this.getToken();return await e({token:t})}async request(e){try{return await this.refreshTokenOnExp(e)}catch(e){if(e.status===401){u.error("got 401, logout",e);this.authenticationManager.logout()}throw e}}rawHead(e,t={},s){return c.httpRequest.head(this.baseUrl+e,t,s)}rawPostJson(e,t,s={},i,o,n){return c.httpRequest.postJson(this.baseUrl+e,t,s,i,o,n)}rawPutJson(e,t,s={},i,o){return c.httpRequest.putJson(this.baseUrl+e,t,s,i,o)}rawGet(e,t,s={}){return c.httpRequest.get(this.baseUrl+e,t,s)}rawGetJson(e,t={}){return c.httpRequest.getJson(this.baseUrl+e,t)}urlContainsFakeProjectId(e){return e&&(e.includes(`/${n.commonConstants.defaults.FAKE_CODE_PROJECT_ID}`)||e.includes(`projectId=${n.commonConstants.defaults.FAKE_CODE_PROJECT_ID}`))}getJson(e,t,s=2,o=1e3,n=true){const r=()=>this.rawGetJson(e,t||this.getAuthHeader());const a=()=>this.request(r).catch((e=>{if(n&&e&&e.status===401){return}throw e}));if(this.urlContainsFakeProjectId(e)){return r()}return(0,i.default)(a,{retries:s,minTimeout:o})}putJson(e,t,s,i){const o=()=>this.rawPutJson(e,t,this.getAuthHeader(),s,i);if((t===null||t===void 0?void 0:t.projectId)===n.commonConstants.defaults.FAKE_CODE_PROJECT_ID||this.urlContainsFakeProjectId(e)){return o()}return this.request(o)}head(e,t){const s=()=>this.rawHead(e,this.getAuthHeader(),t);if(this.urlContainsFakeProjectId(e)){return s()}return this.request(s)}postJson(e,t,s,i,o){const r=()=>this.rawPostJson(e,t,this.getAuthHeader(),s,i,o);if((t===null||t===void 0?void 0:t.projectId)===n.commonConstants.defaults.FAKE_CODE_PROJECT_ID||this.urlContainsFakeProjectId(e)){return r()}return this.request(r)}deleteJson(e,t){return this.request((()=>c.httpRequest.delete(this.baseUrl+e,t,this.getAuthHeader())))}postFormData(e,t,s,i={},o,n){return this.request((()=>c.httpRequest.postFormData(this.baseUrl+e,t,s,{...this.getAuthHeader(),...i},o,n)))}postFormDataWithRetries(e,t,s,o=2,n=1e3,r={},a,c){return(0,i.default)((()=>this.postFormData(e,t,s,r,a,c)),{retries:o,minTimeout:n})}postFormDataWithProgress(e,t,s,o=2,n=1e3,r={},a,l,u){return(0,i.default)((()=>c.httpRequest.postFormDataWithProgress(this.baseUrl+e,t,s,{...this.getAuthHeader(),...r},a,l,u)),{retries:o,minTimeout:n})}waitUntilAllStartsWithKeysFulfilled(e){return this.callOrderScheduler.waitUntilAllStartsWithKeysFulfilled(e)}updateAndRetry(e,t,s=600){return this.callOrderScheduler.schedule(e,{key:t||"",retry:true,retries:s,minTimeout:3e3})}}t.TestimBaseApi=d},function(e,t,s){"use strict";(function(e,i){var o=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var n=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.FeatureFlagsService=t.LabFeatureFlag=void 0;const r=s(6);const a=s(2);const c=s(7);const l=s(8);const u=s(33);const d=c.Logger.getLogger("FeatureFlagsService");const p=1e4;let h={Flag:class e{isEnabled(){return false}},Variant:class e{getValue(){return undefined}},Configuration:class Configuration{},setup(){},register(){},setCustomStringProperty(){},setCustomBooleanProperty(){},showOverrides(){}};if(!(e===null||e===void 0?void 0:false)){h=s(342)}const f=["labs","disabled","enabled"];class m extends h.Variant{constructor(e="disabled"){super(e,f)}getValue(){const e=super.getValue();if(!f.includes(e)){d.warn('unexpected value for lab feature flag. Falling back to value "labs"',{featureFlagName:this.name,value:e});return"labs"}return e}}t.LabFeatureFlag=m;const g=a.observable.object({targetingObservable:0});class v extends h.Flag{isEnabled(){const e=g.targetingObservable;return super.isEnabled()}}class S extends u.EventEmitter{get targetingObservable(){return g.targetingObservable}set targetingObservable(e){g.targetingObservable=e}constructor(){super();this.debouncedTargetingChangeUpdate=r.debounce((()=>this.targetingObservable++),120);this.flags={testKeybordShortcutUI:new h.Flag,showNonUniqueSelectors:new h.Flag,showFoundElementTooltip:new h.Flag,showAuryc:new h.Flag,recordNetworkEffects:new h.Flag,recordNthOfTypeWithChildLocators:new h.Flag,showTestVisualizationMigrated:new m("labs"),useNewWS:new h.Flag,alwaysSaveDoms:new h.Flag,disableEdgeVisibilityChecks:new h.Flag,allowDOMSavingOnMac:new h.Flag,propagateChildLogs:new v,fullPageScreenshotStep:new h.Flag,supportChat:new h.Variant("intercom",["intercom","zendesk","off"]),loadLocatorFromCollection:new h.Flag,useLocatorFromCollection:new h.Flag,importCustomTestDataMaxCols:new h.Configuration(50),showGranularGraph:new h.Configuration(500),locateDiffRatioWarning:new h.Configuration(.8,{freeze:"untilLaunch"}),maximumJsResultSize:new h.Configuration(2e3*1024),showCompareLastSuccessfulRun:new h.Flag,enableGroupHooks:new h.Flag,enableSendDownloadFileUsingS3:new h.Flag,uploadCDPFileWhenNoHar:new h.Flag,showAdvancedCloneOptions:new h.Flag,mobileWebOpenTabAsPopup:new h.Flag,allowFragmentNavigation:new h.Flag,useNewParameterMode:new h.Flag,enableFullFocusableTest:new h.Flag,attachDebuggerOnRecord:new h.Flag,throwOnConditionSyntaxError:new h.Flag,attemptToRecoverFromTabRedirects:new h.Flag,addTestsWizard:new h.Flag,recordingMessage:new h.Flag,preventSharedStepSameName:new h.Flag,showRemoteLocalRunsToggle:new h.Flag,collectJSCoverage:new h.Flag,newProductTour:new h.Flag,dispatchMoveAfterDebuggerAttach:new h.Flag,loadTestUseBranchMap:new h.Flag,slackClientId:new h.Variant("5076786919.191811168726",["5076786919.191811168726","5076786919.1234031510752"]),showArchivedProjects:new h.Flag,enableOverrideMouseOffset:new h.Flag,revertFrameNativeClickPoller:new h.Flag,overrideAzureStorageUrl:new h.Flag,debugLabFeatureForTestimDevsMigrated:new m("disabled"),uploadRecImageToStorage:new h.Flag,exportRunsFromServer:new h.Flag,lookbackWindowSize:new h.Configuration(5),showRevisionTree:new h.Flag,generateRandomFieldStep:new h.Flag,allowSuggestionExecution:new h.Flag,migrateCloudinaryAssets:new h.Flag,localRunnerBgEvents:new h.Flag,remoteBranches:new h.Flag,recordUploadToDocumentFragment:new h.Flag,showPayingProjectOnly:new h.Flag,useFullParentPathForChildSelectors:new h.Flag,enableAutoImproveMarking:new h.Flag,demoAutoImprove:new h.Flag,networkBodyCapture:new h.Flag,experimentalPreCodeCompilation:new h.Flag(true),serializeConsoleLogObjects:new h.Flag,newReportFilters:new m("labs"),autoCheckoutQuickForks:new h.Flag(true),allowDownloadResultScreenshots:new h.Flag,runFreeGridOnDeviceFarm:new h.Flag,multipleOwners:new h.Flag,sharedStepDirectNavigationMigrated:new m("labs"),enableTeamProductivity:new h.Flag,schedulerWebhookNotification:new m,OnboardingUpgrade:new h.Flag,showRoleModalSelection:new h.Flag,allowGroupIterationUsingIndex:new h.Flag,shouldEnableAutoImprove:new m("disabled"),apiStepOmitCookiesOption:new h.Flag,highSpeedMode:new m,experimentalAsyncCustomCode:new h.Flag,useAccessibilityStepAsShared:new h.Flag,skipTour3Tests:new h.Flag,useCDPScreencast:new h.Flag,lockedSharedSteps:new h.Flag,PREnhancements:new m,allowPublishingToMarketplace:new h.Flag,showMarketplaceItems:new h.Flag,allowMfaStep:new h.Flag,usageExampleImprovements:new h.Flag,salesForceSelectrorFix:new h.Flag,customTagScore:new h.Flag,signInWithAzureSSO:new h.Flag,disableGroupReplace:new h.Flag,useHashForStepParamUpload:new h.Flag,showDynamicScrollCheckbox:new h.Flag,useNewTestimGuide:new h.Flag,gitHubActionSnippet:new h.Flag,testPlanInScheduler:new h.Flag,testLibrarySort:new h.Flag,displayTemporaryEmails:new h.Flag,showMergeCodeDiff:new h.Flag,displayMergeChangedProperty:new h.Flag,salesforceSfdc:new h.Flag,addFileToAPI:new h.Flag,cmdClickOpenNewTab:new h.Flag,adminListView:new h.Flag,adminBackOffice:new h.Flag,cutEditorArtifacts:new h.Flag,verboseNewTestLogs:new h.Flag,ignoreMissingClickOffsetVisibleCheck:new h.Flag,bulkUserRemoval:new h.Flag,saveFilteringPreferences:new h.Flag,forceFromSurfaceScreenshots:new h.Flag(true),replaceSuperagentWithFetch:new h.Flag,disableLiveStepsSuggestions:new h.Flag,enableHooksPresentation:new h.Flag,forceMarketoSignup:new h.Flag,highlightHoveredMobileElement:new h.Flag,navigateInNewTab:new h.Flag,addVisitedUrlsToTestResult:new h.Flag,checkDeviceStatus:new h.Flag,displaySwipeDuration:new h.Flag,deviceMirrorControlBar:new h.Flag,saveMobilePlaybackDataToS3:new h.Flag,locateMobileElementsUsingDom:new h.Flag(true),locateMobileElementsUsingImage:new h.Flag(true),locateMobileElementsUsingClosestText:new h.Flag(true),locateMobileElementsUsingContentDesc:new h.Flag(true),locateMobileElementsUsingML:new h.Flag,webLitSupport:new h.Flag,multiProjectUsageReportMobile:new h.Flag,showMobileEvaluateExpressionOnSelectors:new h.Flag,shoutoutChangelog:new h.Flag,appNewAppDebugScheme:new h.Flag,showTestDataMergeCodeDiff:new h.Flag,saveEditorContextOnBranchChange:new h.Flag,hideRemoteRunOnQuotaExceeded:new h.Flag,appDebugHelperWindows:new h.Flag,hideKeyboardStep:new h.Flag,useLinkedomToParseHtml:new h.Flag,resizablePropertyPanel:new v,solveStepFailingIfConditionFrameNotFound:new h.Flag,hookDrillReadOnly:new v,createProjectSelfService:new v,executeDriverStep:new v,sfdcSampleTests:new v,enableAutoSwipeToLocateElement:new h.Flag,mobileTestRunLogs:new h.Flag(false),codeJSDebugActivities:new h.Flag,dontCaptureNetworkLogs:new h.Flag,showOverrideTimeoutFromEditor:new h.Flag,emailAndProjectSelectionSignupFlow:new v,remotePerformanceSession:new v,showSharedResourceWarning:new h.Flag,nativeClickConfig:new v,ttm4jTestCaseBulkOperation:new v,signInWithOkta:new v,useContextFrameHandler:new h.Flag,shouldShowL2cToggle:new h.Flag,showLocalMobileCliTab:new v,sfdcInternalTestStep:new h.Flag,autoOpenDebugHelperPanels:new v,sfdcDocumentValidationStep:new h.Flag,gainsightForTTA4SF:new h.Flag,dontWrapUnwrapLoginData:new h.Flag,showMobileMlLocateOptions:new h.Flag,locateOnImageIfElemNotFoundByML:new h.Flag,mobileOpenKeyboardOnSetText:new h.Flag,exportLocalEditorRunsCSV:new h.Flag,mobileCloseKeyboardOnSetTextInIos:new h.Flag,mobileCaptureScreenshotBeforeActionInRecord:new h.Flag,dontLimitMobileAppSize:new h.Flag,codelessEmailValidation:new h.Flag,skipCheckingLongDragSteps:new h.Flag,showApplicationTypeMobileAppsColumn:new v,customerErrorSuffix:new v,enablePCloudyGrid:new h.Flag,mobileAppsRedesign:new v,hideDriverInCustomCode:new v,helpAssistantBeta:new v,mobileAllowRunningSuiteFromEditor:new v,mobileRelativeTapBasedOnRecordedSize:new h.Flag,helpAssistantDisclaimerLink:new h.Configuration("https://help.testim.io/docs"),redirectLoggedInUsersFromSigninAndSignup:new h.Flag,enableDockerDebugMode:new h.Flag,enableTvcDeviceRecording:new h.Flag,useLocalImageManipulator:new h.Flag};let e;this._waitForFetched=new Promise((t=>{e=e=>{if(e.errorDetails){d.error("rox fetch has error details",e.errorDetails)}return t(e)}}));const t={httpsAgent:undefined,httpAgent:undefined,configurationFetchedHandler:t=>e(t),analytics:{flushAt:20}};if(l.utils.isNode()&&i.proxyUri&&i.ProxyAgent){t.httpsAgent=new i.ProxyAgent(i.proxyUri);t.httpAgent=new i.ProxyAgent(i.proxyUri)}try{h.register("default",this.flags)}catch(e){d.log("multiple flags instance loaded",e)}if(false){}if(true){h.setup("5b5560729601aa6484276518",t)}this.setGitBranch()}setStringCustomProperty(e,t){var s;h.setCustomStringProperty(e,t);(s=h.unfreeze)===null||s===void 0?void 0:s.call(h);this.debouncedTargetingChangeUpdate()}setBooleanCustomProperty(e,t){var s;h.setCustomBooleanProperty(e,t);(s=h.unfreeze)===null||s===void 0?void 0:s.call(h);this.debouncedTargetingChangeUpdate()}setProjectId(e){this.setStringCustomProperty("projectId",e)}setProjectType(e){this.setStringCustomProperty("projectType",e)}setCompanyId(e){this.setStringCustomProperty("companyId",e)}setPlanType(e){this.setStringCustomProperty("planType",e)}setIsPOC(e){this.setBooleanCustomProperty("isPOC",e)}setIsStartUp(e){this.setBooleanCustomProperty("isStartUp",e)}setCompanyProductType(e){this.setStringCustomProperty("productType",e)}setEmail(e){this.setStringCustomProperty("email",e)}setGitBranch(){this.setStringCustomProperty("gitBranch","undefined")}setPlaybackTestId(e){this.setStringCustomProperty("playbackTestId",e)}isAdmin(e){this.setBooleanCustomProperty("isAdmin",e)}showOverrides(){h.showOverrides()}async fetch(){if(!this._waitForFetched){return}try{await l.utils.promiseTimeout(this._waitForFetched,p);if(false){}}catch(e){d.error("failed to get feature flag status",e)}}}t.FeatureFlagsService=S;o([a.computed,n("design:type",Object),n("design:paramtypes",[Object])],S.prototype,"targetingObservable",null);const y=new S;t.default=y}).call(this,s(35),s(36))},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p;Object.defineProperty(t,"__esModule",{value:true});t.ProjectsService=void 0;const h=s(6);const f=s(9);const m=s(2);const g=s(8);const v=s(7);const S=s(21);const y=s(144);const b=s(14);const _=s(39);const T=s(33);const E=s(409);const I=s(38);const C=s(22);const D=s(5);const O=s(115);const A=s(27);const j=s(63);const w=s(48);const R=s(29);const P=v.Logger.getLogger("ProjectsService");const x="testim_projectId";const M=100;const N=300;let F=class e extends T.EventEmitter{constructor(e,t,s,i,o,n,r,a){super();this.analyticsService=e;this.analyticsSystemsService=t;this.featureFlagsService=s;this.companiesService=i;this.authenticationManager=o;this.testimServices=n;this.notificationDisplayService=r;this.editedTestStore=a;this.fullyLoadedProjects=new m.ObservableMap;this._currentProjectId="";this.explicitUpdateCompanyProjects=0;this.projects=new Map;this.debouncedSearch=h.debounce(((e,t)=>this.testimServices.project.searchProjects(e,M,this.featureFlagsService.flags.showArchivedProjects.isEnabled()).then(t)),N);this._previousProjectId="";o.on(D.commonConstants.scenario.APP_LOGOUT,(()=>this.onLogout()));o.on(D.commonConstants.scenario.APP_LOGIN,(()=>this.onLogin()));this._reset()}get previousProjectId(){return this._previousProjectId}get projectId(){return this._currentProjectId}get defaultAppId(){return this.projectDefaults.defaultAppId}get areProjectsLoaded(){const{uid:e}=this.authenticationManager.getLoggedUserInfo();return Boolean(e&&this.projects.size)}get projectType(){var e;return(e=this.currentProject)===null||e===void 0?void 0:e.type}get allowAutoImproveWhenReadonly(){return Boolean(this.projectDefaults.autoImproveReadOnly)}get projectEditorUiType(){var e;return((e=this.currentProject)===null||e===void 0?void 0:e.editorProjectType)||"automate"}get isDemo(){return(0,O.isDemoProjectId)(this._currentProjectId)}get defaultDemoProjectId(){return this.companiesService.defaultDemoProjectId}get isDemoOrReadOnly(){return!this.authenticationManager.isSuperAdmin&&(this.isDemo||this.companiesService.currentUserIsCompanyReadOnly)}get demoTooltip(){if(this.isDemoOrReadOnly){return D.commonConstants.tooltipText.demoProject}return undefined}async createNewProject({projectName:e,type:t}){const{id:s}=await this.testimServices.project.create(this.companiesService.companyId,e,t);if(this.companiesService.isTtaForSalesforceApp){await this.testimServices.project.saveDefaultUrl(s,D.commonConstants.SFDC_COMMON.PRODUCTION_LOGIN_URL);await this.saveDebugPanelStatus("closed",s);const e=await this.testimServices.testConfig.getConfigList(s);const t=e.find((e=>e.name==="WXGA 1280x800"));if(t){await this.testimServices.project.saveDefaultConfig(s,t.id)}}await this.updateCompanyProjects()}async searchProjects(e){e=e.toLowerCase().trim();if(!e){return[]}return await new Promise((t=>{this.debouncedSearch(e,t)}))}get isMobileWeb(){return this.projectType===D.commonConstants.test.MOBILE_WEB}get isAndroid(){return this.projectType===D.commonConstants.test.ANDROID}get isIos(){return this.projectType===D.commonConstants.test.IOS}get isMobile(){return this.isAndroid||this.isIos}get isDesktopWeb(){return this.projectType===D.commonConstants.test.DESKTOP_WEB}get isWeb(){return this.isDesktopWeb||this.isMobileWeb}get currentProject(){return this.fullyLoadedProjects.get(this._currentProjectId)}get projectName(){var e;return(e=this.currentProject)===null||e===void 0?void 0:e.name}setLastProject(e){if(!e||e===D.commonConstants.defaults.FAKE_CODE_PROJECT_ID){return}g.utils.getStorage().setItem(x,e)}onLogin(){return this.loadUserProjects()}onLogout(){this._reset();g.utils.getStorage().removeItem(x);const e=new E.KeyValueStore;e.set("projects",[])}_onProjectsLoad(e){const t=(e,t)=>e.name.localeCompare(t.name);const s=this.featureFlagsService.flags.showArchivedProjects.isEnabled();this.projects=new Map(h.chain(e).filter(Boolean).filter((e=>Boolean(e.name&&(s||!e.isArchived)))).sort(t).keyBy("id").toPairs().value());this.analyticsService.identify({"user-project-type":"automate"});this.trigger(D.commonConstants.scenario.PROJECTS_LOADED)}isInAllowedProjects(e){return e&&(this.authenticationManager.isAdmin||this.projects.has(e))}async renameProject(e){await this.testimServices.project.rename(this.projectId,e);const t=this.currentProject;this.trigger(D.commonConstants.scenario.PROJECTS_LOADED);if(t){t.name=e;await this.selectProject(t.id)}}async renameProjects(e){if(this.featureFlagsService.flags.emailAndProjectSelectionSignupFlow.isEnabled()&&!this.companiesService.isTtaForSalesforceApp){const t=this.userProjects.filter((e=>e.id!==D.commonConstants.defaults.DEMO_PROJECT_ID&&e.id!==D.commonConstants.defaults.TTA_SFDC_DEMO_PROJECT_ID));const s=t=>{if(t.type==="android"){t.name=`${e}'s Project Android`}else if(t.type==="ios"){t.name=`${e}'s Project iOS`}else{t.name=e}return t};const i=t.map(s);await Promise.all(i.map((e=>this.testimServices.project.rename(e.id,e.name))))}else{await this.testimServices.project.rename(this.projectId,e)}const t=this.currentProject;this.trigger(D.commonConstants.scenario.PROJECTS_LOADED);if(t){t.name=e;await this.selectProject(t.id)}}get ciToken(){var e,t;return(t=(e=this.currentProject)===null||e===void 0?void 0:e.ci)===null||t===void 0?void 0:t.token}async saveDefaultApp(e){await this.testimServices.project.saveDefaultApp(this.projectId,e);const t=this.currentProject;if(t){t.defaults||(t.defaults={});t.defaults.defaultAppId=e}}async saveDefaultUrl(e){await this.testimServices.project.saveDefaultUrl(this.projectId,e);const t=this.currentProject;if(t){t.defaults||(t.defaults={});t.defaults.startUrl=e}}async saveDebugPanelStatus(e,t){const s=t||this.projectId;await this.testimServices.project.saveDebugPanelStatus(s,e);const i=this.currentProject;if(i&&i.id===s){i.defaults||(i.defaults={});i.defaults.debugPanelStatus=e}}async saveProjectDefaults(e){await this.testimServices.project.saveDefaults(this.projectId,e);const t=this.currentProject;if(t){t.defaults=Object.assign(t.defaults||{},e)}}get projectDefaults(){var e;return((e=this.currentProject)===null||e===void 0?void 0:e.defaults)||{}}get defaultProjectUrl(){return this.projectDefaults.startUrl}getDebugPanelStatus(){return this.projectDefaults.debugPanelStatus}get shouldLoadProjectsListLean(){return this.authenticationManager.isAdmin}async loadUserProjects({bypassCache:e=false}={}){const{uid:t}=this.authenticationManager.getLoggedUserInfo();const s=async()=>{if(this.authenticationManager.isAdmin&&!e&&!this.shouldLoadProjectsListLean){const e=new E.KeyValueStore;const s=this.testimServices.company.getProjects(t);s.then((e=>{if(e&&e.length>100){const t=new E.KeyValueStore;t.set("projects",e)}}));return e.get("projects").then((e=>{if(e&&e.length>=1){return e}return s}))}return await this.testimServices.company.getProjects(t)};const i=await s();this._onProjectsLoad(i)}get defaultBaseUrl(){if(this.isMobile){return undefined}return this.defaultProjectUrl}async selectProject(e){var t;if(e===this._currentProjectId){return}if(this.shouldLoadProjectsListLean&&!this.projects.has(e)){try{const t=await this.testimServices.project.getProject(e);this.projects.set(e,t)}catch(t){P.error("error loading project",{projectId:e,err:t})}}const{companyId:s}=this.projects.get(e)||{};const i=this.companiesService.companyId||this.companiesService.getCompanyIdFromStorage()||((t=this.companiesService.userCompanies[0])===null||t===void 0?void 0:t.id);const o=Boolean(this.authenticationManager.isAdmin||!(0,O.isDemoCompanyId)(s));const n=o?s:i;if(n&&this.companiesService.companyId!==n){await this.companiesService.selectCompany(n)}(0,m.runInAction)((()=>{const t=this._currentProjectId?D.commonConstants.scenario.PROJECT_CHANGED:D.commonConstants.scenario.PROJECT_SELECTED;this._previousProjectId=this._currentProjectId;this._currentProjectId=e;const s=this.projects.get(e);v.Logger.setGlobalInfo({projectId:e,projectType:s===null||s===void 0?void 0:s.type});if(s){this.fullyLoadedProjects.set(e,s);this.featureFlagsService.setProjectType(s.type);this.analyticsService.setProjectData(s)}this.setLastProject(e);this.featureFlagsService.setProjectId(e);this.trigger(t,this.currentProject);this.analyticsSystemsService.trackSelectProject(e);this.editedTestStore.test=null;this.editedTestStore.device=null}))}selectFakeProjectForCodePage(){const e=D.commonConstants.defaults.FAKE_CODE_PROJECT_ID;const t={id:e,name:"fake",type:D.commonConstants.test.DESKTOP_WEB,defaults:{}};this.projects=new Map([[e,t]]);this.fullyLoadedProjects.set(e,t);this._currentProjectId=e;this.trigger(D.commonConstants.scenario.PROJECT_SELECTED,this.currentProject);this.analyticsSystemsService.trackSelectProject(e)}isOwner({excludeCompanyOwner:e=false}={}){const t=this.currentProject;return(e?["owner"]:["owner","company-owner"]).includes((t===null||t===void 0?void 0:t.role)||"")}async savePullRequestSettings(e,t){const s=this.currentProject;if(!this.authenticationManager.isAdmin&&!this.isOwner()||!s){return undefined}s[e]=t;return await this.testimServices.project.savePullRequestSettings(this.projectId,e,t)}async updateAutoComplete(e){try{await this.testimServices.project.updateAutoComplete({projectId:this.projectId,autoComplete:e});const t=this.currentProject;if(t){t.defaults||(t.defaults={});t.defaults.autoComplete=e}}catch(e){P.error("failed to update auto-complete settings",{err:e});this.notificationDisplayService.sendNotification("failed to update auto-complete settings")}}async updateAllowAutoImproveReadOnly(e){try{this.analyticsService.track("auto-improve-toggle",{state:e?"on":"off"});await this.testimServices.project.updateAutoImproveReadOnly({projectId:this.projectId,autoImproveReadOnly:e});const t=this.currentProject;if(t){t.defaults||(t.defaults={});t.defaults.autoImproveReadOnly=e}}catch(e){P.error("failed to update auto-improve settings",{err:e});this.notificationDisplayService.sendNotification("failed to update auto-improve settings")}}async updateProjectEditorType(e,t){await this.testimServices.project.updateProjectEditorType(e,t)}async updateCompanyProjects(){if(!this.shouldLoadProjectsListLean){this._reset();await this.loadUserProjects({bypassCache:true})}else{await this.companiesService.updateCompanyProjects(this.companiesService.companyId)}this.explicitUpdateCompanyProjects++}get userProjects(){return Array.from(this.projects.values())}get currentCompanyProjectsNoDemo(){const e=this.companiesService.companyId;h.noop(this.explicitUpdateCompanyProjects);return(0,A.fromPromise)((async()=>this.shouldLoadProjectsListLean?await this.companiesService.getCompanyProjects(e):new Map(h.chain(this.userProjects).filter({companyId:e}).keyBy("id").toPairs().value()))())}get currentCompanyProjects(){const e=this.currentCompanyProjectsNoDemo;return(0,A.fromPromise)((async()=>{const t=new Map(await e);const s=this.projects.get(this.companiesService.defaultDemoProjectId);if(s){t.set(s.id,s)}return t})())}get projectsWithOwnerRole(){const e=this.companiesService.adminPrivilegesForCurrentCompany!=="none";const t=this.companiesService.currentUserIsCompanyOwner;const s=e||t;const i=s?this.currentCompanyProjectsNoDemo:this.currentCompanyProjects;return(0,A.fromPromise)((async()=>{if(s){return await i}return new Map([...await i].filter((([,e])=>{var t;return["owner","company-owner"].includes((t=e.role)!==null&&t!==void 0?t:"")})))})())}get projectIdFromStorage(){return g.utils.getStorage().getItem(x)}updateReportSettings(e){const t=this.projectId;return this.testimServices.project.updateReportSettings({projectId:t,reportSettings:e})}getReportSettings(){const e=this.projectId;return this.testimServices.project.getReportSettings(e)}async saveHiddenParams(e){await this.testimServices.project.saveHiddenParams(this.projectId,e);const t=this.currentProject;if(t){t.defaults||(t.defaults={});t.defaults.hiddenParams=e}}async callAutoImprove(e){const t=this.projectId;try{await this.testimServices.autoImprove.autoImproveTest(t,e);this.notificationDisplayService.sendNotification("test was auto-improved");return true}catch(s){P.error("error auto imptroving",{projectId:t,testId:e,err:s});this.notificationDisplayService.sendNotification("test auto-improved failed");return false}}isProjectBlocked(e){return false}_reset(){this.projects.clear();this.fullyLoadedProjects.clear();this._currentProjectId="";this._previousProjectId=""}};t.ProjectsService=F;i([m.observable,o("design:type",Object)],F.prototype,"_currentProjectId",void 0);i([m.observable,o("design:type",Object)],F.prototype,"explicitUpdateCompanyProjects",void 0);i([m.observable.ref,o("design:type",Object)],F.prototype,"projects",void 0);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"areProjectsLoaded",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"projectType",null);i([m.computed,o("design:type",Boolean),o("design:paramtypes",[])],F.prototype,"allowAutoImproveWhenReadonly",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"defaultDemoProjectId",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"isMobileWeb",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"isAndroid",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"isIos",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"isMobile",null);i([m.computed,o("design:type",Array),o("design:paramtypes",[])],F.prototype,"userProjects",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"currentCompanyProjectsNoDemo",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"currentCompanyProjects",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],F.prototype,"projectsWithOwnerRole",null);i([m.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],F.prototype,"_reset",null);t.ProjectsService=F=i([(0,f.injectable)(),(0,w.exposeGlobally)("projectsService"),o("design:paramtypes",[typeof(n=typeof S.AnalyticsService!=="undefined"&&S.AnalyticsService)==="function"?n:Object,typeof(r=typeof y.AnalyticsSystemsService!=="undefined"&&y.AnalyticsSystemsService)==="function"?r:Object,typeof(a=typeof b.FeatureFlagsService!=="undefined"&&b.FeatureFlagsService)==="function"?a:Object,typeof(c=typeof _.CompaniesService!=="undefined"&&_.CompaniesService)==="function"?c:Object,typeof(l=typeof I.AuthenticationService!=="undefined"&&I.AuthenticationService)==="function"?l:Object,typeof(u=typeof C.TestimServicesApi!=="undefined"&&C.TestimServicesApi)==="function"?u:Object,typeof(d=typeof j.NotificationDisplayService!=="undefined"&&j.NotificationDisplayService)==="function"?d:Object,typeof(p=typeof R.EditedTestStore!=="undefined"&&R.EditedTestStore)==="function"?p:Object])],F)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(442),t)},,,,function(e,t,s){"use strict";var i;Object.defineProperty(t,"__esModule",{value:true});t.downloadFile=t.getSlackLoginUrl=t.openPopupAndWait=t.openNewPopupWindow=t.copyToClipboard=t.isInEditor=t.stepPathTemplate=t.testPathTemplate=t.isPlaygroundModeState=t.isEditorForceMode=t.isPlaygroundState=t.processSigInWithEmailAndPasswordErrorMessage=t.processSignErrorForMessage=t.useHorizontalCollapse=t.useMeasuredBoundingRect=t.useAsyncLayoutEffect=t.useAsyncEffect=t.useClickOutside=void 0;const o=s(0);const n=s(7);const r=s(5);const a=s(8);const c=n.Logger.getLogger("componentsUtils");const l=["click"];const u=[];function d({callback:e,activate:t,events:s=l,eventListenerOptions:i=true,onlyOnce:n=true,ignoredElements:r=u}){const a=(0,o.useRef)(null);(0,o.useEffect)((()=>{const o=t=>{const s=[...r,a].some((e=>{var s;return(s=e.current)===null||s===void 0?void 0:s.contains(t.target)}));if(s){return}if(n){c()}e(t)};function c(){s.forEach((e=>document.removeEventListener(e,o,i)))}if(t){s.forEach((e=>document.addEventListener(e,o,i)))}else{c()}return()=>c()}),[t,s,e,i,n,r]);return a}t.useClickOutside=d;function p(e,t,s){(0,o.useEffect)((()=>{let s;let i=true;const o=e((()=>i));Promise.resolve(o).then((e=>{s=e}));return()=>{i=false;if(typeof t==="function"){t(s)}}}),typeof t==="function"?s:t)}t.useAsyncEffect=p;function h(e,t,s){(0,o.useLayoutEffect)((()=>{let s;let i=true;const o=e((()=>i));Promise.resolve(o).then((e=>{s=e}));return()=>{i=false;if(typeof t==="function"){t(s)}}}),typeof t==="function"?s:t)}t.useAsyncLayoutEffect=h;const f=e=>{const[t,s]=(0,o.useState)(new DOMRect);(0,o.useEffect)((()=>{const t=()=>{const t=e.current?e.current.getBoundingClientRect():new DOMRect;s(t)};const i=new ResizeObserver((()=>t()));if(e.current){i.observe(e.current)}t();return()=>i.disconnect()}),[e]);return{boundingRect:t}};t.useMeasuredBoundingRect=f;const m=({requiredContentWidthPx:e})=>{const[s,i]=(0,o.useState)(false);const n=(0,o.useRef)(null);const{boundingRect:r}=(0,t.useMeasuredBoundingRect)(n);(0,o.useEffect)((()=>{const t=r.width;i(t+1<e)}),[r,e]);return{isCollapsed:s,containerRef:n}};t.useHorizontalCollapse=m;const g=e=>{const t=e===null||e===void 0?void 0:e.code;if(t===r.serverResponses.USER_EXISTS_ERROR){return"An account for this email already exists."}if(t===r.serverResponses.USER_EXISTS_DIFFERENT_PROVIDER_ERROR){return"You already signed up with a different method."}if(t===r.serverResponses.NOT_WORK_EMAIL){return"Signup failed. Personal emails are not supported."}if(t===r.serverResponses.USER_DISABLED_ERROR){return"The account for this email id disabled."}c.error("Failed to login with provider",t,e);return"Please try again later."};t.processSignErrorForMessage=g;const v=e=>{const t=e===null||e===void 0?void 0:e.code;if(t===r.serverResponses.USER_SSO_FORCED){return"You already signed up with a different method."}c.error("Failed to login with email and password",t,e);return"The email and/or password entered are incorrect."};t.processSigInWithEmailAndPasswordErrorMessage=v;const S=(e={})=>{const{embedMode:t,exportPlaywright:s,exportPuppeteer:i,projectId:o}=e;return Boolean(t||s||i)||o===r.commonConstants.defaults.FAKE_CODE_PROJECT_ID};t.isPlaygroundState=S;t.isEditorForceMode=typeof window!=="undefined"&&(((i=window.location)===null||i===void 0?void 0:i.host)==="force.testim.io"&&!localStorage.getItem("disableEditorForceMode")||Boolean(localStorage.getItem("editorForceMode")));const y=e=>(0,t.isPlaygroundState)(e.params);t.isPlaygroundModeState=y;t.testPathTemplate="/project/:projectId/branch/:branch/test/:testId";t.stepPathTemplate="/project/:projectId/branch/:branch/test/:testId/step/:stepId";const b=e=>e.startsWith(t.testPathTemplate);t.isInEditor=b;const _=e=>{const t=document.createElement("textarea");t.value=e;t.style.position="fixed";document.body.appendChild(t);t.focus();t.select();document.execCommand("copy");document.body.removeChild(t)};t.copyToClipboard=_;const T=(e="",t,s)=>{const i=(window.screen.availHeight-s)/2;const o=(window.screen.availWidth-t)/2;const n={width:t,height:s,top:i>0?i:0,left:o>0?o:0,location:true,resizable:true,statusbar:true,toolbar:false};const r=Object.entries(n).map((([e,t])=>`${e}=${Number(t)}`)).join(",");const a=window.open(e,"_blank",r);if(a){try{a.focus()}catch(e){c.warn("Caught error while trying to focus on new window",{error:e})}}return a};t.openNewPopupWindow=T;const E=async(e,s=500,i=600,o)=>{const n=120*1e3;const r=(0,t.openNewPopupWindow)(e,s,i);let c;let l;let u=true;const d=new Promise(((e,t)=>{c=t=>{u=false;e(t)};l=e=>{u=false;t(e)}}));const p=e=>{if(e.data&&u&&(!o||e.data.eventId===o)){if(e.data.success){c(e.data)}else{l(e.data)}if(r){r.close()}}};const h=setInterval(f,1e3);function f(){if((r===null||r===void 0?void 0:r.closed)&&u){l(new Error("popup-closed"))}}window.addEventListener("message",p);try{return await a.utils.promiseTimeout(d,n)}finally{clearInterval(h);window.removeEventListener("message",p)}};t.openPopupAndWait=E;const I=(e,t="5076786919.191811168726")=>{const s="https://slack.com/oauth/v2/authorize";const i="channels:read,chat:write,chat:write.public,groups:read";return`${s}?client_id=${t}&scope=${i}&state=${e}`};t.getSlackLoginUrl=I;const C=(e,t,s,i)=>{if(i){i.stopPropagation();i.preventDefault()}const o=document.createElement("a");o.download=e;o.href=t;o.rel="noopener noreferrer";o.type=s;window.isOurOwnDownload=true;setTimeout((()=>{window.isOurOwnDownload=false}),1);o.click()};t.downloadFile=C},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r;Object.defineProperty(t,"__esModule",{value:true});t.AnalyticsService=t.zendeskWidget=void 0;const a=s(9);const c=s(7);const l=s(14);const u=s(26);const d=s(20);const p=s(42);const h=s(48);const f=c.Logger.getLogger("analytics-service");const m={OFF:"off",INTERCOM:"intercom",ZENDESK:"zendesk"};const g=Boolean(typeof window!=="undefined"&&new URL(window.location.href).searchParams.get("disableSegment"));if(true&&!g){if(false){}else if(true){s(352)}}t.zendeskWidget={get isLoaded(){return Boolean(window.zE)},hide:()=>{var e;(e=window.zE)===null||e===void 0?void 0:e.call(window,"webWidget","hide")},show:()=>{var e;(e=window.zE)===null||e===void 0?void 0:e.call(window,"webWidget","show")},open:()=>{var e;(e=window.zE)===null||e===void 0?void 0:e.call(window,"webWidget","open")},onClose:e=>{var t;(t=window.zE)===null||t===void 0?void 0:t.call(window,"webWidget:on","close",e)},onOpen:e=>{var t;(t=window.zE)===null||t===void 0?void 0:t.call(window,"webWidget:on","open",e)},chat:{addTags:e=>{var t;(t=window.zE)===null||t===void 0?void 0:t.call(window,"webWidget","chat:addTags",...e)},send:e=>{var t;(t=window.zE)===null||t===void 0?void 0:t.call(window,"webWidget","chat:send",e)},onEnd:e=>{var t;(t=window.zE)===null||t===void 0?void 0:t.call(window,"webWidget:on","chat:end",e)},end:()=>{var e;(e=window.zE)===null||e===void 0?void 0:e.call(window,"webWidget","chat:end")}}};let v=class e{constructor(e,t){this.featureFlagsService=e;this.urlState=t;this.hasExtension=false;this.NAVIGATE_NEW_TAB_EVENT="selected-navigate-new-tab";if(true&&window.analytics){window.analytics.ready((()=>{window.analytics.debug(false);this.migrateToZendeskChat()}))}}initialize(){return this.urlState.history.listen((({action:e,location:t})=>{if(e==="REPLACE"){return}if(this.userInfo){this.page(t.pathname,document.referrer,t.search,window.location.href)}else{this.sendGAPageView(document.title,t.pathname+t.search)}}))}get chat(){this.featureFlagsService.flags.supportChat.unfreeze();return this.featureFlagsService.flags.supportChat.getValue()}get isZendeskChat(){const e=this.featureFlagsService.targetingObservable;return this.chat===m.ZENDESK}shutDownIntercom(e=5){window===null||window===void 0?void 0:window.Intercom("update",{hide_default_launcher:true});if(e>=0){setTimeout((()=>this.shutDownIntercom(e-1)),300*e)}}shutDownZendesk(){if(!t.zendeskWidget.isLoaded){return}t.zendeskWidget.hide();f.log("zendesk chat is disabled")}showZendesk(e=5){if(!t.zendeskWidget.isLoaded){if(e>0){setTimeout((()=>this.showZendesk(e-1)),1e3)}return}t.zendeskWidget.show();f.log("zendesk chat is enabled")}get shouldShutDownIntercom(){return this.chat!==m.INTERCOM}get shouldShutDownZendesk(){return this.chat!==m.ZENDESK}migrateToZendeskChat(){const e=(0,d.isPlaygroundModeState)(this.urlState);if(e||this.chat!==m.INTERCOM){this.shutDownIntercom()}if(e||this.chat!==m.ZENDESK){this.shutDownZendesk();return}if(!t.zendeskWidget.isLoaded){window.zESettings={webWidget:{zIndex:29}};const e=document.createElement("script");e.setAttribute("id","ze-snippet");e.src="https://static.zdassets.com/ekr/snippet.js?key=82f576ee-a98b-4f6b-9822-2955769e1135";document.head.appendChild(e)}else{this.showZendesk()}this.identifyZendesk()}identifyZendesk(e=5){if(!t.zendeskWidget.isLoaded||!this.userInfo){if(e>0){setTimeout((()=>this.identifyZendesk(e-1)),1e3)}return}window.zE("webWidget","identify",{name:this.userInfo.name,email:this.userInfo.email,organization:this.userInfo.companyName});window.zE("webWidget","prefill",{name:{value:this.userInfo.name},email:{value:this.userInfo.email},phone:{value:this.userInfo.phone}})}isAnalyticsDisabled(){var e;const t=(e=this.userInfo)===null||e===void 0?void 0:e.email;return false||t==="ui@testim.io"}sendGAWebsite(e){if(this.isAnalyticsDisabled()){return}let t="https://www.google-analytics.com/collect?v=1&t=event&ni=1&ec=All&ea=[EVENT_ACTION]&ev=0&cid=[CID]&tid=UA-66644665-1";if(window.ga&&typeof window.ga==="function"){window.ga((s=>{const i=s.get("clientId");t=t.replace("[CID]",i);t=t.replace("[EVENT_ACTION]",e);p.httpRequest.get(t)}))}}sendGAPageView(e,t){if(this.isAnalyticsDisabled()){return}if(window.ga&&typeof window.ga==="function"){window.ga("send","pageview",{title:e,page:t})}}setProjectData(e){const{id:t,name:s,type:i}=e;this._currentProjectId=t;this._currentProjectName=s;this._currentProjectType=i;if(this._pendingTrackSignupEvent){this.userSignedUp(this._pendingTrackSignupEvent);delete this._pendingTrackSignupEvent}}setCompanyData({companyId:e,companyName:t,ucid:s,userInfo:i}){this._currentCompanyId=e;this._currentCompanyName=t;this._currentCompanyUCID=s;this._currentCompanyPlanType=i.company.planType;this._currentCompanyPlanExpiration=i.company.planExpiration;this.identify(i)}setIsStartupPlan(e){this._currentIsStartupPlan=e}setCompanyProductType(e){this._currentCompanyProductType=e}setCurrentBranchName(e){this._currentBranchName=e}setPinnedBranchName(e){this._pinnedBranchName=e}identify(e){this.userInfo=e;if(this.isAnalyticsDisabled()){return}try{window.analytics.alias(e.userId);window.analytics.identify(e.userId,Object.assign({},e,{account_created:true}));this.migrateToZendeskChat()}catch(e){f.log("failed to call analytics identify",e)}}page(e,s,i,o){if(this.isAnalyticsDisabled()){return}try{window.analytics.page({path:e,referrer:s,search:i,url:o});if(this.shouldShutDownIntercom){this.shutDownIntercom()}if(this.shouldShutDownZendesk){this.shutDownZendesk()}}catch(e){f.log("failed to call analytics page",e)}if(t.zendeskWidget.isLoaded){window.zE("webWidget","updatePath",{url:o})}}track(e,t={}){if(this.isAnalyticsDisabled()){return}try{t||(t={});t.projectId=this._currentProjectId;t.projectName=this._currentProjectName;t.projectType=this._currentProjectType;t.ucid=this._currentCompanyUCID;t.companyId=this._currentCompanyId;t.companyName=this._currentCompanyName;t.companyPlan=this._currentCompanyPlanType;t.companyPlanExpiration=this._currentCompanyPlanExpiration;t.startupPlan=this._currentIsStartupPlan;t.companyProductType=this._currentCompanyProductType;t.currentBranchName=this._currentBranchName;t.pinnedBranchName=this._pinnedBranchName;t.timestamp=new Date;window.analytics.track(e,t)}catch(e){f.log("failed to call analytics track",e)}}userLoggedIn(e,t){this.identify(e);if(t){this.userSignedUp(e)}this.track("editor-login",{...e,isNew:t})}userLoggedOut(){if(this.isAnalyticsDisabled()){return}if(window.analytics){window.analytics.reset()}if(t.zendeskWidget.isLoaded){window.zE("webWidget","logout")}this.userInfo=null}userInvited(e){this.track("user-invited",e)}userSignedUp(e){if(!this._currentProjectId){this._pendingTrackSignupEvent=e;return undefined}e.testimExtensionInstalled=this.hasExtension;this.sendGAWebsite("editor-sign-up");return undefined}setExtensionInstalled(e){this.hasExtension=e}runScenario(e){this.track("editor-run-scenario",e)}stepVideoOpened(e){this.track("step-video-opened",e)}selectedNavigateNewTab(e){this.track(this.NAVIGATE_NEW_TAB_EVENT,e)}testCreated(e){this.track("editor-test-created",e)}stepAddedFromMenu(e){this.track("add-step-from-menu",{stepType:e.replace(/android-|ios-/,"")})}testSaved(e){this.track("editor-test-saved",{id:e.id,isNew:e===null||e===void 0?void 0:e.areAllStepsNew()})}testSavedWithResizeAsFirstStep(e){this.track("resize-second-step",e)}testSavedOldVersion(e){this.track("editor-test-saved-old-version",e)}testRecord(e){this.track("editor-test-record",e)}testRun(e){this.track("editor-test-run",e)}testStopped(e){this.track("editor-test-stop",e)}testDebug(e){this.track("editor-test-debug",e)}reportTestFailed(e){this.track("editor-test-failed",e)}reportTestSuccess(e){this.track("editor-test-success",e)}helpDialogOpened(e,t,s){this.track("editor-help-dialog-opened",{resultId:e,id:t,errorType:s})}extInstallSucceeded(){this.track("ext-install-succeeded")}extInstallFailed(){this.track("ext-install-failed")}choosePlan(e){this.track("choose-plan",{plan:e})}subscriptionCreated(e){this.track("subscription-created",{plan:e});this.sendGAWebsite("subscription-created")}subscriptionCanceled(){this.track("subscription-canceled")}clickOnForkBranch(){this.track("click-on-fork-branch")}createNewBranch(e){this.track("create-new-branch",e)}schedulerCreated(e){this.track("scheduler-created",e)}schedulerDeleted(e){this.track("scheduler-deleted",e)}schedulerDisabled(e){this.track("scheduler-disabled",e)}schedulerEnabled(e){this.track("scheduler-enabled",e)}schedulerRun(e){this.track("scheduler-run",e)}testPlanCreated(e){this.track("test-plan-created",e)}testPlanDeleted(e){this.track("test-plan-deleted",e)}invalidConfig(e){this.track("invalid-config-run",e)}testHistorySearch(e){this.track("test-history-search",e)}reportTestsCount(e){if(this.isAnalyticsDisabled()){return}window.analytics.group(this._currentProjectId,{tests_count:e,name:this._currentProjectName})}toggleLabelEditor(){this.track("toggle-label-editor")}toggleLabelTestList(){this.track("toggle-label-test-list")}openedConsoleLog(){this.track("opened-console-log")}showPhoneVerification(){this.track("show-phone-verification")}phoneVerified(){this.track("phone-verified")}openSeeOldRevisions(){this.track("open-see-old-revisions")}viewRevision(e){this.track("view-revision",{revisionId:e})}companyPageOpened(){this.track("company-page-opened")}editorNotificationEvent(e,t){this.track(`editor-notification-${e}`,t)}improveElement(e){this.track("improve-element",e)}reassignElement(e){this.track("reassign-element",e)}viewLocators(e){this.track("view-locators",e)}locatorContextToggle(e){this.track("locator-context-toggle",e)}exportedData(e){this.track("export-button-clicked",e)}stepWarningTooltip(e){this.track("step-warning-tooltip-link-clicked",{tooltipLink:e})}userCheckedAutoGroup(e){this.track("user-checked-auto-group",e)}userAutoGrouped(){this.track("user-clicked-ok-auto-group")}userClickedOnTest(e){this.track("editor-existingtest-enter",{...e,isNewTab:e.openType==="newTab",isModal:e.openType==="modal"})}};t.AnalyticsService=v;t.AnalyticsService=v=i([(0,a.injectable)(),(0,h.exposeGlobally)("analyticsService"),o("design:paramtypes",[typeof(n=typeof l.FeatureFlagsService!=="undefined"&&l.FeatureFlagsService)==="function"?n:Object,typeof(r=typeof u.UrlStateService!=="undefined"&&u.UrlStateService)==="function"?r:Object])],v)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.TestimServicesApi=void 0;const r=s(8);const a=s(9);const c=s(38);const l=s(13);const u=s(355);const d=s(356);const p=s(357);const h=s(358);const f=s(359);const m=s(360);const g=s(361);const v=s(362);const S=s(145);const y=s(363);const b=s(364);const _=s(365);const T=s(366);const E=s(367);const I=s(368);const C=s(369);const D=s(370);const O=s(371);const A=s(372);const j=s(373);const w=s(374);const R=s(375);const P=s(376);const x=s(377);const M=s(378);const N=s(379);const F=s(380);const L=s(381);const k=s(382);const B=s(383);const U=s(384);const G=s(385);const V=s(386);const H=s(387);const $=s(388);const W=s(389);const J=s(390);const Y=s(391);const z=s(392);const q=s(393);const X=s(394);const Z=s(395);const Q=s(396);const K=s(397);const ee=s(398);const te=s(399);const se=s(400);const ie=s(401);const oe=s(402);const ne=s(403);const re=s(404);const ae=s(405);const ce=s(406);function le(){if(false){}return r.utils.getServicesUrl()}let ue=class e{constructor(e){this.authenticationManager=e;this.callOrderScheduler=new S.CallOrderScheduler;this.user=new _.TestimUserApi(this.callOrderScheduler);this.scheduler=new L.TestimSchedulerApi(this.callOrderScheduler);this.test=new f.TestimTestApi(this.callOrderScheduler);this.project=new Y.TestimProjectApi(this.callOrderScheduler);this.secrets=new K.SecretsApi(this.callOrderScheduler);this.applitools=new U.TestimApplitoolsApi(this.callOrderScheduler);this.slack=new E.TestimSlackApi(this.callOrderScheduler);this.slackBugTracker=new X.TestimSlackBugTracker(this.callOrderScheduler);this.plan=new B.TestimPlanApi(this.callOrderScheduler);this.execution=new I.TestimExecutionApi(this.callOrderScheduler);this.label=new J.TestimLabelApi(this.callOrderScheduler);this.step=new u.TestimStepApi(this.callOrderScheduler);this.testConfig=new w.TestimTestConfigApi(this.callOrderScheduler);this.branch=new V.TestimBranchApi(this.callOrderScheduler);this.testPlan=new C.TestimTestPlanApi(this.callOrderScheduler);this.suite=new p.TestimSuiteApi(this.callOrderScheduler);this.integration=new W.TestimIntegrationApi(this.callOrderScheduler);this.auth=new G.TestimAuthApi(this.callOrderScheduler);this.sharedSteps=new M.TestimSharedStepApi(this.callOrderScheduler);this.company=new H.TestimCompanyApi(this.callOrderScheduler);this.remote=new g.TestimRemoteApi(this.callOrderScheduler);this.tms=new y.TestimTmsApi(this.callOrderScheduler);this.report=new R.TestimReportApi(this.callOrderScheduler);this.grid=new k.TestimGridApi(this.callOrderScheduler);this.realData=new O.TestimRealDataApi(this.callOrderScheduler);this.emailValidation=new $.TestimEmailValidationApi(this.callOrderScheduler);this.result=new d.TestimResultsApi(this.callOrderScheduler);this.remoteStep=new z.TestimRemoteStepApi(this.callOrderScheduler);this.storage=new h.TestimStorageApi(this.callOrderScheduler);this.locators=new m.TestimLocatorsApi(this.callOrderScheduler);this.analyticsSystems=new v.TestimAnalyticsSystemsApi(this.callOrderScheduler);this.suggestions=new T.TestimSuggestionsApi(this.callOrderScheduler);this.autoGroup=new b.TestimAutoGroupingApi(this.callOrderScheduler);this.auditLog=new D.TestimAuditLogApi(this.callOrderScheduler);this.labFeatures=new A.TestimLabFeaturesApi(this.callOrderScheduler);this.publicApiKeysManagementApi=new j.PublicApiKeysManagementApi(this.callOrderScheduler);this.utilityApis=new P.UtilityApis(this.callOrderScheduler);this.folder=new x.TestimFolderApi(this.callOrderScheduler);this.remoteBranch=new N.TestimRemoteBranch(this.callOrderScheduler);this.pullRequest=new F.TestimPullRequestApi(this.callOrderScheduler);this.dashboard=new q.TestimDashboardApi(this.callOrderScheduler);this.autoImprove=new Z.TestimAutoImproveApi(this.callOrderScheduler);this.marketplace=new Q.TestimMarketplaceApi(this.callOrderScheduler);this.dropbear=new ee.TestimDropbearApi(this.callOrderScheduler);this.adminManagement=new te.TestimAdminManagementApi(this.callOrderScheduler);this.adminTools=new se.TestimAdminToolsApi(this.callOrderScheduler);this.mobileApp=new ie.TestimMobileAppApi(this.callOrderScheduler);this.tmaVersions=new oe.TestimTmaVersionsApi(this.callOrderScheduler);this.tdc=new ne.TestimTdcApi(this.callOrderScheduler);this.tvc=new re.TestimTvcApi(this.callOrderScheduler);this.textract=new ae.TestimTextractApi(this.callOrderScheduler);this.assistant=new ce.TestimAssistant(this.callOrderScheduler);this.changeBaseUrl(le(),{updateStorage:false})}changeBaseUrl(e,{updateStorage:t=true}={}){this.testimServerBaseUrl=e;for(const t of Object.values(this)){if(t instanceof l.TestimBaseApi){t.changeTestimBaseUrl(e);t.authenticationManager=this.authenticationManager}}if(false){}}getCurrentToken(){return this.authenticationManager.getToken()}};t.TestimServicesApi=ue;t.TestimServicesApi=ue=i([(0,a.injectable)(),o("design:paramtypes",[typeof(n=typeof c.AuthenticationService!=="undefined"&&c.AuthenticationService)==="function"?n:Object])],ue)},,,,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.UrlStateService=void 0;const d=s(6);const p=s(9);const h=s(2);const f=s(41);const m=s(288);const g=e=>{var t,s;if((s=(t=e===null||e===void 0?void 0:e.props)===null||t===void 0?void 0:t.value)===null||s===void 0?void 0:s.outlet){return g(e.props.value.outlet)}return e.props.value.matches.map((e=>{var t;const s=(t=e.route.path)===null||t===void 0?void 0:t.replace("/*","/");return(s===null||s===void 0?void 0:s.endsWith("/"))?s.substring(0,s.length-1):s})).filter(Boolean).join("/")};let v=class e{constructor(){this.history=false?undefined:(0,f.createHashHistory)();this.navigationHistory=[];this.routes=[];this.location=this.history.location;this.action=this.history.action;this.history.listen(this.onUrlChange.bind(this))}onUrlChange({location:e,action:t}){const s={params:{...this.params},template:this.pathTemplate};this.location=e;this.action=t;if(this.navigationHistory.length>100){this.navigationHistory.shift()}this.navigationHistory.unshift({fromParams:s.params,action:t,fromTemplate:s.template,toParams:{...this.params}})}setup({routes:e}){this.routes=e}get routerMatches(){var e;return(0,m.matchRoutes)(this.routes,{pathname:(e=this.location.pathname)!==null&&e!==void 0?e:"/"})||[]}get routerOutlet(){return(0,m.renderMatches)(this.routerMatches)}get pathTemplate(){return this.routerOutlet?g(this.routerOutlet):""}get hooksParams(){const e=this.searchParams.hook;const t=this.searchParams.hookedStepId;return{hook:e,hookedStepId:t}}setupNavigationFunction(e){this.navigate=e}get pathParams(){var e,t;return(t=(e=this.routerMatches[this.routerMatches.length-1])===null||e===void 0?void 0:e.params)!==null&&t!==void 0?t:{}}get searchParams(){return Object.fromEntries((0,m.createSearchParams)(this.location.search))}get params(){return{...this.pathParams,...this.searchParams}}go(e,t){if(!this.navigate&&typeof e==="string"){window.location.href=e;return}if(typeof e==="string"&&e.startsWith("#/")){e=e.substring(1)}if(typeof e==="number"){this.navigate(e)}else{this.navigate(e,t)}}updateParams(e,t){const s=Object.keys(e).reduce(((t,s)=>{const i=Array.isArray(e[s])?e[s].join(";"):e[s];if(!i){delete t[s]}else{t[s]=i}return t}),{...this.params});const i=(0,m.createSearchParams)(d.omit(s,Object.keys(this.pathParams)));const o=(0,m.generatePath)(this.pathTemplate,d.mapValues(s,encodeURIComponent));const n=Array.from(i).length>0;this.go(`${o}${n?`?${i.toString()}`:""}`,t)}};t.UrlStateService=v;i([h.observable.ref,o("design:type",Array)],v.prototype,"routes",void 0);i([h.observable.ref,o("design:type",typeof(n=typeof f.Location!=="undefined"&&f.Location)==="function"?n:Object)],v.prototype,"location",void 0);i([h.observable.ref,o("design:type",typeof(r=typeof f.Action!=="undefined"&&f.Action)==="function"?r:Object)],v.prototype,"action",void 0);i([h.action,o("design:type",Function),o("design:paramtypes",[typeof(a=typeof f.Update!=="undefined"&&f.Update)==="function"?a:Object]),o("design:returntype",void 0)],v.prototype,"onUrlChange",null);i([h.computed,o("design:type",Object),o("design:paramtypes",[])],v.prototype,"routerMatches",null);i([h.computed,o("design:type",Object),o("design:paramtypes",[])],v.prototype,"routerOutlet",null);i([h.computed,o("design:type",String),o("design:paramtypes",[])],v.prototype,"pathTemplate",null);i([h.computed,o("design:type",Object),o("design:paramtypes",[])],v.prototype,"hooksParams",null);i([h.computed.struct,o("design:type",typeof(c=typeof Params!=="undefined"&&Params)==="function"?c:Object),o("design:paramtypes",[])],v.prototype,"pathParams",null);i([h.computed.struct,o("design:type",typeof(l=typeof Params!=="undefined"&&Params)==="function"?l:Object),o("design:paramtypes",[])],v.prototype,"searchParams",null);i([h.computed.struct,o("design:type",typeof(u=typeof Params!=="undefined"&&Params)==="function"?u:Object),o("design:paramtypes",[])],v.prototype,"params",null);t.UrlStateService=v=i([(0,p.injectable)(),o("design:paramtypes",[])],v)},,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.ModalService=t.Toast=t.Modal=void 0;const n=s(2);const r=s(9);const a=s(8);class c{constructor(e,t,s){this.Component=e;this.props=t;this.close=s;this.id=a.utils.guid();this.promise=new Promise((e=>{this.resolve=e}))}}t.Modal=c;class l{constructor(e,t,s){this.Component=e;this.props=t;this.removeToast=s;this.id=a.utils.guid();this.animationContainer={shouldClose:false};this.promise=new Promise((e=>{this.resolve=e}))}close(){this.animationContainer.shouldClose=true}}t.Toast=l;i([n.observable,o("design:type",Object)],l.prototype,"animationContainer",void 0);let u=class e{constructor(){this.modalInstances=new Map;this.toastInstancesLeft=new Map;this.toastInstancesRight=new Map}openModal(e,t={}){var s,i;(i=(s=document.activeElement)===null||s===void 0?void 0:s.blur)===null||i===void 0?void 0:i.call(s);const o=new c(e,t,(e=>{o.resolve(e);this.modalInstances.delete(o.id)}));this.modalInstances.set(o.id,o);return o}openToast(e,t={}){const s=new l(e,t,(e=>{s.resolve(e);this.toastInstancesLeft.delete(s.id)}));if(t.position==="right"){this.toastInstancesRight.set(s.id,s)}else{this.toastInstancesLeft.set(s.id,s)}return s}hasOpenModals(){return this.modalInstances.size>0}openFormModal(e){const t=s(120).FormModal;const i=this.openModal(t,e);return i}};t.ModalService=u;i([n.observable.shallow,o("design:type",Object)],u.prototype,"modalInstances",void 0);i([n.observable.shallow,o("design:type",Object)],u.prototype,"toastInstancesLeft",void 0);i([n.observable.shallow,o("design:type",Object)],u.prototype,"toastInstancesRight",void 0);t.ModalService=u=i([(0,r.injectable)()],u)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.EditedTestStore=void 0;const d=s(193);const p=s(7);const h=s(8);const f=s(116);const m=s(2);const g=s(27);const v=s(72);const S=s(87);const y=s(201);const b=s(38);const _=s(21);const E=s(203);const I=s(78);const C=s(5);const D=s(9);const O=s(33);const A=s(60);const j=s(202);const w=s(91);const R=s(48);const P=p.Logger.getLogger("test-data-service");function x(e,t,s){const i=e.allowOverridingBaseUrl;return e.type==="navigation"&&i&&t.type==="scenario"&&(s===0||t.steps.length===0)}function M(e,t,s){return e.type==="resize-window"&&t.type==="scenario"&&(s===0||t.steps.length===0)}let N=class e extends O.EventEmitter{constructor(e,t){super();this.analyticsService=t;this.test=null;this.markAutoImprovedSteps=false;this.device=null;this.stepAdditionLoaderPosition=new m.ObservableMap;this._hasSharedStepsViewingOlderRevisions=(0,g.computedFn)((e=>{if(e instanceof w.SharedStepInstance){if(!e.isLatestVersion){return true}return this._hasSharedStepsViewingOlderRevisions(e.sharedStepClass)}return e instanceof S.GroupStep&&e.steps.some((e=>this._hasSharedStepsViewingOlderRevisions(e)))}));this.toggleMarkAutoImprovedSteps=()=>this.markAutoImprovedSteps=!this.markAutoImprovedSteps;this.isStepAutoImproved=(0,g.computedFn)((e=>{if(!this.markAutoImprovedSteps||!(e instanceof v.Step)){return false}if(this._isAutoImproved(e)||this._isAutoImproved(e.getStepContent())){return true}return false}));this._isAutoImproved=(0,g.computedFn)((e=>{var t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v;if(!e){return false}if((i=(s=(t=e.element)===null||t===void 0?void 0:t.elementLocator)===null||s===void 0?void 0:s.metadata)===null||i===void 0?void 0:i.autoImprove){return true}if((r=(n=(o=e.toElement)===null||o===void 0?void 0:o.elementLocator)===null||n===void 0?void 0:n.metadata)===null||r===void 0?void 0:r.autoImprove){return true}if((l=(c=(a=e.locatorContext)===null||a===void 0?void 0:a.elementLocator)===null||c===void 0?void 0:c.metadata)===null||l===void 0?void 0:l.autoImprove){return true}if(((u=e.scrollToElement)===null||u===void 0?void 0:u.targetId)==="scrollToElement"&&((p=(d=e.scrollToElement.elementLocator)===null||d===void 0?void 0:d.metadata)===null||p===void 0?void 0:p.autoImprove)){return true}if((m=(f=(h=e.submitElement)===null||h===void 0?void 0:h.elementLocator)===null||f===void 0?void 0:f.metadata)===null||m===void 0?void 0:m.autoImprove){return true}if(this._isAutoImproved(e.condition)){return true}if(this._isAutoImproved(e.whileLoop)){return true}const y=e.getStepContent();if(y instanceof S.GroupStep){return y.steps.some((e=>this._isAutoImproved(e)))}if(e.parameterValues){const t=e.parameterValues.filter((e=>e.type==="locate"));for(const e of t){if((v=(g=e.elementLocator)===null||g===void 0?void 0:g.metadata)===null||v===void 0?void 0:v.isAutoImproved){return true}}}return false}));e.on(C.commonConstants.scenario.APP_LOGOUT,(()=>this.reset()))}get scenario(){var e;return(e=this.test)===null||e===void 0?void 0:e.scenario}get testConfig(){var e;return(e=this.test)===null||e===void 0?void 0:e.testConfig}get testId(){var e;return(e=this.test)===null||e===void 0?void 0:e.id}get testName(){var e;return((e=this.test)===null||e===void 0?void 0:e.name)||C.commonConstants.test.DEFAULT_TEST_NAME}get currentBaseUrl(){var e;return(e=this.testConfig)===null||e===void 0?void 0:e.baseUrl}get currentBaseUrlWithFallback(){var e;return((e=this.test)===null||e===void 0?void 0:e.baseUrl)||this.currentBaseUrl}get baseUrlOrApplicationName(){var e;return((e=this.test)===null||e===void 0?void 0:e.isMobile)&&this.currentAppName||this.currentBaseUrlWithFallback}get currentAppName(){var e;const t=C.commonConstants.mobile.MISSING_NAME;return((e=this.scenario)===null||e===void 0?void 0:e.appName)||t}get currentAppVersion(){var e,t,s;return((s=(t=(e=this.scenario)===null||e===void 0?void 0:e.nativeApp)===null||t===void 0?void 0:t.appMetadata)===null||s===void 0?void 0:s.version)||""}get applicationBuildType(){var e,t;const s=(t=(e=this.scenario)===null||e===void 0?void 0:e.nativeApp)===null||t===void 0?void 0:t.filePath;if(!s){return""}if(s.endsWith(".ipa")){return"Physical build"}if(s.endsWith(".app")){return"Virtual build"}return""}get shouldTestBeSaved(){if(!this.test||!this.scenario){return false}const e=Boolean(this.scenario.isNew&&this.scenario.steps.length);if(e){return true}return!this.scenario.isNew&&Boolean(this.scenario.findStepByProperty("isDirty",true))}reset(){this.test=null}deleteSteps(e){for(const t of e){if((t===null||t===void 0?void 0:t.parentStep)instanceof S.GroupStep){t.parentStep.removeStep(t.id)}this._trackSfdc("delete",t)}this.trigger(C.commonConstants.scenario.DELETE_STEP)}addStepLoaderAtPosition(e,t){if(e===undefined){return}if(!this.stepAdditionLoaderPosition.has(t)){this.stepAdditionLoaderPosition.set(t,new m.ObservableSet)}this.stepAdditionLoaderPosition.get(t).add(e)}removeStepLoaderAtPosition(e,t){var s;(s=this.stepAdditionLoaderPosition.get(t))===null||s===void 0?void 0:s.delete(e)}updateStep(e,t){const s=this.updateStepInAction(e,t);this.trigger(C.commonConstants.scenario.UPDATE_STEP,s);return s}updateStepInAction(e,t){return e.update(t)}updateStepById(e,t){var s,i,o;const n=(s=this.scenario)===null||s===void 0?void 0:s.findStepById(e,true);if(n){return this.updateStep(n,t)}if(this.testConfig&&t.screenImage&&((i=this.scenario)===null||i===void 0?void 0:i.steps.length)===0){this.testConfig.screenImage=t.screenImage}else if(((o=this.testConfig)===null||o===void 0?void 0:o.isContainResizeWindowStep(e))&&t.innerHeight&&t.innerWidth){this.testConfig.update({resolution:{width:t.innerWidth,height:t.innerHeight}})}return undefined}addStep(e,t,s){var i,o,n;this._trackSfdc("add",e);const r=t?(i=this.scenario)===null||i===void 0?void 0:i.findStepById(t,true):this.scenario;if(!(r===null||r===void 0?void 0:r.getStepContent().isGroupStep)){P.error(`cannot insert step into parent ${t}`);return undefined}if(x(e,r,s)){const t=h.utils.removeLeadAndTrailingQuotes(e.expression);(o=this.test)===null||o===void 0?void 0:o.update({baseUrl:t});(n=this.test)===null||n===void 0?void 0:n.scenario.update({baseUrl:t});return r}if(this.testConfig&&M(e,r,s)&&this.testConfig.name===I.DEFAULT_CONFIG_NAME){this.testConfig.update({resizeWindowStep:e});this.testConfig.update({resolution:{width:e.innerWidth,height:e.innerHeight}});return r}const a=e instanceof v.Step?e:A.stepBuilder.buildStepFromData(e);r.getStepContent().addStep(a,s);this.trigger(C.commonConstants.scenario.ADD_STEP,a);return a}setNewTestWithDefault(e,t,s,i,o,n,r,a){var c,l;const u=(c=e===null||e===void 0?void 0:e.uid)!==null&&c!==void 0?c:"";const d=(l=(e===null||e===void 0?void 0:e.name)||(e===null||e===void 0?void 0:e.email))!==null&&l!==void 0?l:"Unknown";const p=new E.Scenario;p.update({testOwnerUserId:u,testStatus:"draft",baseUrl:t});const h=new j.CustomTestData;const m=new f.RevisionList;m.createNewRevision(d,u,p.id,i,n,"");const g=new y.Test(r,i,o,m.getSerializedObject(),[],s,null,true,u,null,null,null,null,h,null,t,a);g.scenario=p;this.test=g;return this.test}createNewTest(e,t,s,i,o,n,r,a,c){const l=new I.TestConfig({resolution:t,os:i});return this.setNewTestWithDefault(e,s,l,o,n,r,a,c)}setTestFromFromData(e){this.test=d.buildFromTestBundle(e)}updateTestConfiguration(e){var t,s;if(e.id===((t=this.testConfig)===null||t===void 0?void 0:t.id)){this.testConfig.update(e)}else if(this.test){if(!this.test.baseUrl){this.test.update({baseUrl:this.test.testConfig.baseUrl})}this.test.testConfig=I.TestConfig.createFromData(e)}return(s=this.testConfig)===null||s===void 0?void 0:s.getSerializableObject()}get isLatestVersion(){var e;const t=(e=this.test)===null||e===void 0?void 0:e.revisions;if(!t){return true}return t.isLatestVersion()}get hasSharedStepsViewingOlderRevisions(){try{if(!this.scenario)return false;return this.scenario.steps.some((e=>this._hasSharedStepsViewingOlderRevisions(e)))}catch(e){return false}}updateTestAndTrigger(e={}){if(!this.test){return}Object.assign(this.test,e);this.trigger(C.commonConstants.scenario.UPDATE_TEST_MANUALLY)}assignMockNetworkOptions(e){if(!this.scenario){return}this.scenario.update({mockNetworkOptions:{...this.scenario.mockNetworkOptions,...e}})}get isMockNetworkAvailable(){var e;const t=(e=this.scenario)===null||e===void 0?void 0:e.mockNetworkOptions;return Boolean((t===null||t===void 0?void 0:t.customHarFileLocation)||(t===null||t===void 0?void 0:t.recordedHarFileLocation)||(t===null||t===void 0?void 0:t.harFileLocationForPlayback)||(t===null||t===void 0?void 0:t.customMappingFileLocation))}_trackSfdc(e,t){if(t.type==="sfdc-recorded-step"&&"recordedData"in t){this.analyticsService.track(`${e}-sfdc-recorded-step`,{testId:this.testId,recordedDataType:t.recordedData.type})}else if(t.type.startsWith("sfdc")&&"sfdcData"in t){this.analyticsService.track(`${e}-sfdc-step`,{testId:this.testId,stepType:t.type})}}};t.EditedTestStore=N;i([m.observable.ref,o("design:type",Object)],N.prototype,"test",void 0);i([m.observable.ref,o("design:type",Object)],N.prototype,"markAutoImprovedSteps",void 0);i([m.observable.ref,o("design:type",Object)],N.prototype,"device",void 0);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"scenario",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"testConfig",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"testId",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"testName",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"currentBaseUrl",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"currentBaseUrlWithFallback",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"baseUrlOrApplicationName",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"currentAppName",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"currentAppVersion",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"applicationBuildType",null);i([m.action,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],N.prototype,"deleteSteps",null);i([m.action,o("design:type",Function),o("design:paramtypes",[Number,String]),o("design:returntype",void 0)],N.prototype,"addStepLoaderAtPosition",null);i([m.action,o("design:type",Function),o("design:paramtypes",[Number,String]),o("design:returntype",void 0)],N.prototype,"removeStepLoaderAtPosition",null);i([m.action,o("design:type",Function),o("design:paramtypes",[typeof(c=typeof T!=="undefined"&&T)==="function"?c:Object,typeof(l=typeof h.PartialPickNonFunctionProperties!=="undefined"&&h.PartialPickNonFunctionProperties)==="function"?l:Object]),o("design:returntype",typeof(u=typeof T!=="undefined"&&T)==="function"?u:Object)],N.prototype,"updateStepInAction",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"isLatestVersion",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"hasSharedStepsViewingOlderRevisions",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"isMockNetworkAvailable",null);i([m.action,o("design:type",Object)],N.prototype,"toggleMarkAutoImprovedSteps",void 0);t.EditedTestStore=N=i([(0,D.injectable)(),(0,R.exposeGlobally)("editedTestStore"),o("design:paramtypes",[typeof(n=typeof b.AuthenticationService!=="undefined"&&b.AuthenticationService)==="function"?n:Object,typeof(r=typeof _.AnalyticsService!=="undefined"&&_.AnalyticsService)==="function"?r:Object])],N)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseModal=t.Backdrop=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(70);const a=s(0);const c=s(16);const l=s(20);const u=e=>e.onSubmit?(0,i.jsx)("form",{onSubmit:e.onSubmit,children:e.children}):(0,i.jsx)(o.Fragment,{children:e.children});u.displayName="MaybeForm";const d=e=>{const[t,s]=(0,a.useState)(typeof e.freezeHeight==="boolean"?undefined:Number(e.freezeHeight));const c=(0,a.useRef)(null);(0,a.useEffect)((()=>{if(e.onEscape){const t=t=>{if(t.key==="Escape"){e.onEscape()}};document.addEventListener("keydown",t,{capture:true});return()=>document.removeEventListener("keydown",t,{capture:true})}return undefined}),[]);(0,a.useLayoutEffect)((()=>{if(c.current&&e.freezeHeight===true){s(c.current.getBoundingClientRect().height)}}),[]);if(!e.backdrop){return(0,i.jsx)(o.Fragment,{children:e.children})}const l=e.freezeHeight?(0,i.jsx)("div",{ref:c,style:{height:t},children:e.children}):e.children;return(0,i.jsx)("div",{className:(0,n.default)(r.default.modalContainer,e.containerClassName),style:{zIndex:e.zIndex},children:l})};t.Backdrop=d;t.Backdrop.displayName="Backdrop";const p=e=>{var s,o;const a=(0,l.useClickOutside)({callback:()=>e.closeModal(),activate:Boolean(e.closeOnClickOutside)});const{showHeaderIcon:d=true}=e;return(0,i.jsx)(t.Backdrop,{backdrop:e.backdrop,freezeHeight:e.freezeHeight,onEscape:e.closeOnEscape?e.closeModal:undefined,containerClassName:e.containerClassName,zIndex:e.zIndex,children:(0,i.jsx)("div",{ref:a,className:(0,n.default)(r.default.modal,(s=e.className)!==null&&s!==void 0?s:""),children:(0,i.jsxs)(u,{onSubmit:e.onSubmit,children:[e.header?(0,i.jsxs)("div",{className:(0,n.default)(r.default.header,(o=e.headerClassName)!==null&&o!==void 0?o:""),children:[e.header," ",d&&(0,i.jsx)(c.Icon,{onClick:()=>e.closeModal(),icon:"close-thin",className:r.default.close})]}):"",e.subHeader&&!e.hideSubHeader?(0,i.jsx)("div",{className:(0,n.default)(r.default.subHeader,e.subHeaderClassName),children:e.subHeader}):"",(0,i.jsx)("div",{className:(0,n.default)(r.default.body,e.bodyClassName),children:e.children}),e.footer?(0,i.jsx)("div",{className:r.default.footer,children:e.footer}):""]})})})};t.BaseModal=p;t.BaseModal.displayName="BaseModal";t.BaseModal.defaultProps={freezeHeight:false,closeOnEscape:true,backdrop:true}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(454),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(459),t)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.EventEmitter=void 0;s(113);const o=s(6);const n=s(9);let r=class e{constructor(){this.eventListeners=new Map}listenersByEvent(e,t){const s=this.eventListeners;e||(e="");if(t&&!s.has(e)){s.set(e,[])}return s.get(e)}cleanup(){const e=this.eventListeners;e.forEach(((t,s)=>{if(!t.length){e.delete(s)}}))}on(e,t,s,i){if(!e){window.console.error("cannot register to empty event")}else if(Array.isArray(e)){e.forEach((e=>this.on(e,t,s)))}else if(typeof t==="function"){const o=this.listenersByEvent(e,true);o.push({scope:s,callback:t,options:i})}else{window.console.error("events mixin addListener: bad callback",t)}return this}off(e,t){if(!e&&!t){return this}if(!t&&typeof e==="object"&&!Array.isArray(e)){t=e;e=null}if(Array.isArray(e)){e.forEach((e=>this.off(e,t)));return this}function s(e){return e&&(!t||e.scope===t||e.callback===t)}this.eventListeners.forEach(((t,i)=>{if(!e||e===i){o.remove(t,s)}}));this.cleanup();return this}removeAllListeners(){this.eventListeners.clear();return this}trigger(e,...t){const s=this.listenersByEvent(e);if(!(s===null||s===void 0?void 0:s.length)){return}const i=s.slice();const n=[];i.forEach((e=>{var s;e.callback.apply(e.scope,t);if(((s=e.options)===null||s===void 0?void 0:s.count)&&--e.options.count<=0){n.push(e)}}));if(n.length){n.forEach((e=>o.remove(s,(t=>t===e))));this.cleanup()}}once(e,t,s,i){i||(i={});i.count=1;return this.on(e,t,s,i)}};t.EventEmitter=r;t.EventEmitter=r=i([(0,n.injectable)()],r)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b;Object.defineProperty(t,"__esModule",{value:true});t.BranchesService=void 0;const _=s(6);const T=s(9);const E=s(2);const I=s(49);const C=s(26);const D=s(15);const O=s(21);const A=s(63);const j=s(8);const w=s(7);const R=s(33);const P=s(97);const x=s(22);const M=s(20);const N=s(159);const F=s(14);const L=s(51);const k=s(38);const B=s(5);const U=s(146);const G=s(45);const V=s(67);const H=s(28);const $=s(798);const W=B.commonConstants.scenario;const J=w.Logger.getLogger("branch-service");const Y="testim_branch";let z=class e extends R.EventEmitter{constructor(e,t,s,i,o,n,r,a,c,l,u){super();this.projectsService=e;this.analyticsService=t;this.testimServices=s;this.urlState=i;this.userService=o;this.modalService=n;this.featureFlagsService=r;this.featureAvailabilityService=a;this.labFeaturesService=c;this.notificationDisplayService=l;this.authenticationManager=u;this._lastBranch=null;this.currentBranch=null;this.branchList={};this._currentBranchRevisions={};this._pinnedBranch="";this._shouldLoadPinnedBranch=false;this._branchChangedInEditorContext=false;this._isListInitialized=false;this._projectMissingBranches=false;this.isCheckingOutBranch=false;e.on(W.PROJECT_CHANGED,(e=>this.onProjectChange(e,true)));e.on(W.PROJECT_SELECTED,(e=>this.onProjectChange(e)));u.on(W.APP_LOGOUT,(()=>this.onLogout()));this.reset();this.setLastBranch(j.utils.getStorage().getItem(Y));this._resetIsReadyState()}reset(){this.resetProjectData();if(this.projectsService.projectId){this.onProjectChange()}}resetProjectData(){this.branchList={};this._currentBranchRevisions={};this._pinnedBranch=""}_resetIsReadyState(){this.resetProjectData();this._lastBranch=null;this._isListInitialized=false;this._waitForBranchListReady=new Promise((e=>{this._resolveBranchListReady=e}))}_adjustPrAndReadOnlySettings(){if(!this.authenticationManager.isLoggedIn()||this.projectsService.isDemo){return}const e=this.featureAvailabilityService.isPullRequestsEnabled;if((this.readonlyBranches.has(B.MASTER_BRANCH)||this.branchesRequiringPullRequests.has(B.MASTER_BRANCH))&&!e&&!this.projectsService.isDemoOrReadOnly){J.log(`PR feature is set to ${e}, disabling PRs and read-only master`);this.setReadOnly(B.MASTER_BRANCH,false);this.setRequirePullRequests(B.MASTER_BRANCH,false)}}async waitForBranchForkComplete(e,t=1e3*60*5){const s=this.projectsService.projectId;let i="progress";const o=Date.now();while(i==="progress"){if(Date.now()>=o+t){throw new Error("Async branch fork has timed out")}i=(await this.testimServices.branch.getBranchForkStatus(s,e)).status;if(i==="progress"){await j.utils.delay(5e3)}}if(i==="failed"){throw new Error("failed forking branch")}}waitForBranchesReady(){return this._waitForBranchListReady}isBranchExists(e){return Boolean(this.branchList[e])}async waitForBranch(e){if(this.isBranchExists(e)){return}await j.utils.delay(250);await this.waitForBranch(e)}getNextBranchName(e){let t=0;while(t<100){const s=t===0?`Copy of "${e}"`:`Copy (${t}) of "${e}"`;if(this.getInvalidBranchNameReason(s)===""){return s}t+=1}return""}getInvalidBranchNameReason(e){if(!(e===null||e===void 0?void 0:e.trim())){return"Branch name cannot be empty"}if(this.isBranchExists(e)){return this.getBranchList()[e].isArchived?`Branch ${e} is archived.`:`Branch ${e} already exists.`}return""}assertNewBranchName(e){const t=this.getInvalidBranchNameReason(e);if(t){throw new Error(t)}}async createNewBranch(e,{shouldUpdateURL:t}={shouldUpdateURL:true}){const s=async()=>{await this.checkoutBranch(e);this.urlState.updateParams({branch:e})};const i=this.projectsService.projectId;const o=this.branch;const n=Date.now();const r=this.modalService.openToast($.ForkBranchToast,{branchName:e,type:"progress"});try{await this.testimServices.branch.create(i,o,e);this.analyticsService.createNewBranch({newBranchName:o});J.log("branch forking started",{name:e,projectId:i,baseBranch:o});await this.waitForBranchForkComplete(e);const r=Date.now()-n<=1e3*5;await this.loadBranchesData();this.trigger(W.BRANCH_CREATED);let a="complete";const c=t&&r&&this.featureFlagsService.flags.autoCheckoutQuickForks.isEnabled();if(c){a="quick-complete";await s()}this.modalService.openToast($.ForkBranchToast,{branchName:e,onCheckout:s,type:a})}catch(t){this.modalService.openToast($.ForkBranchToast,{branchName:e,type:"failed"});J.error("failed forking branch",{name:e,projectId:i,baseBranch:o,err:t})}finally{r===null||r===void 0?void 0:r.close()}}async refreshBranch(e){this.currentBranch=null;await this.checkoutBranch(e)}async checkoutBranch(e){if(this.isCheckingOutBranch){return}this.isCheckingOutBranch=true;queueMicrotask((()=>{this.isCheckingOutBranch=false}));const t=this.currentBranch;if(!e||t===e){return}this.currentBranch=e;this.analyticsService.setCurrentBranchName(e);this.analyticsService.track("change-branch",{currentBranchName:t,newBranchName:e});if(!this.isBranchExists(e)){await this.waitForBranchesReady();this.checkoutBranch(this.currentBranch||B.MASTER_BRANCH);return}const s=this.projectsService.projectId;try{J.log("checked out branch",{branchName:e,projectId:s});this.setBranchRevisions();this.setLastBranch(this.currentBranch);this.trigger(W.BRANCH_CHANGE,e,t);this.showCheckoutNotification(e,t);this._isListInitialized=true}catch(t){J.error("failed checking out branch",{branchName:e,projectId:s,err:t})}}showCheckoutNotification(e,t){if(Object.keys(this.branchList).length>1&&(t||e!==B.MASTER_BRANCH)){this.notificationDisplayService.sendNotification(`checkout branch ${e}`)}}isListInitialized(){return this._isListInitialized}async isItemInBranch(e){await this._waitForCurrentBranchRevisions;return Boolean(this._currentBranchRevisions[e])}get branchChangedInEditorContext(){return this._branchChangedInEditorContext}get currentBranchRevision(){return this._currentBranchRevisions}get pinnedBranch(){return this._pinnedBranch}get shouldLoadPinnedBranch(){return this._shouldLoadPinnedBranch}get pullRequestBranches(){var e;return(e=this.projectsService.currentProject)===null||e===void 0?void 0:e.pullRequestBranches}get branchesRequiringPullRequests(){var e;return new Set((e=this.pullRequestBranches)===null||e===void 0?void 0:e.list)}get readonlyBranches(){var e,t;return new Set((t=(e=this.projectsService.currentProject)===null||e===void 0?void 0:e.readonlyBranches)===null||t===void 0?void 0:t.list)}setBranchChangedInEditorContext(e){this._branchChangedInEditorContext=e}setShouldLoadPinBranch(e){this._shouldLoadPinnedBranch=e}setBranchRevisions(){const e=this.projectsService.projectId;if(!this.currentBranch){return}this._currentBranchRevisions={};this._waitForCurrentBranchRevisions=this.testimServices.branch.getRevisions(e,this.currentBranch).then((e=>{this._currentBranchRevisions=e}))}saveLatestRevision(e,t){this._currentBranchRevisions[e]=t}async deleteBranch(e){await this.updateBranchData(e,{isArchived:true});await this.loadBranchesData();if(e===this.pinnedBranch){await this.pinBranch(B.MASTER_BRANCH)}this.analyticsService.track("delete-existing-branch",{selectedBranchName:e});this.trigger(W.BRANCH_DELETED,e)}async undeleteBranch(e){await this.updateBranchData(e,{isArchived:false});return await this.loadBranchesData()}async setRequirePullRequests(e,t){J.log(`setting ${e} require pull requests to ${t}`);await this.updateBranchData(e,{requirePullRequest:t});return await this.loadBranchesData()}async setReadOnly(e,t){J.log(`setting ${e} read only to ${t}`);await this.updateBranchData(e,{isReadOnly:t});return await this.loadBranchesData()}async checkoutPinnedBranch(){await this.waitForBranchesReady();await this.checkoutBranch(this.pinnedBranch);this.setShouldLoadPinBranch(false)}async pinBranch(e,t){const s=this.projectsService.projectId;const i=this.userService.getPreferences();if(typeof t==="boolean"){_.set(i,"dialogs.disablePinModalWarning",t)}_.set(i,`pinnedBranchesByProjectId.${s}`,e);this.analyticsService.track("pin-branch",{selectedBranchName:e});try{await this.userService.savePreferences(i);this.setPinnedBranch(s);J.log("branch marked as pinned",{name:e,projectId:s})}catch(t){J.error("failed to pin branch",{name:e,projectId:s,err:t});throw t}}updateBranchData(e,t){return this.testimServices.branch.update(this.projectsService.projectId,e,t)}async showApplitoolsMergeFailedDialog({conflictsUrl:e,text:t}){const s=await this.modalService.openModal(G.MessageModal,{title:"Merge failed (Resolve Conflicts)",body:t,okText:"Open Applitools",cancelText:"Cancel"}).promise;if(!s){return}const i=window.open(e,"_blank","noopener");if(i){try{i.focus()}catch(e){}}}async mergeBranch(e,t,s,i,o,n=this.branch){var r,a,c,l,u,d;const p=this.projectsService.projectId;const h=this.userService.getUserId();try{const r=await this.testimServices.branch.merge(p,n,e,h,t,s,i,o);J.log("merged branch",{sourceBranch:e,targetBranch:n});if(o){this.modalService.openToast(V.Toast,{children:`Branch ${e} successfully deleted`,timeout:4e3,icon:{backgroundType:"success",type:"V"}})}await this.processAfterBranchMerge(n,r);return true}catch(t){if(t instanceof P.TypedHttpError&&((r=t.response)===null||r===void 0?void 0:r.code)==="delete-branch-failed"){this.modalService.openToast(V.Toast,{children:`failed to delete branch ${e}`,timeout:7e3,icon:{backgroundType:"error",type:"failed"}});await this.processAfterBranchMerge(n,t.response.branchRevisions);return true}J.error("failed merging branch",{sourceBranch:e,targetBranch:n,projectId:p,err:t});if(((a=t.response)===null||a===void 0?void 0:a.text)&&((c=t.response)===null||c===void 0?void 0:c.conflictsUrl)){await this.showApplitoolsMergeFailedDialog(t.response)}else{this.notificationDisplayService.sendNotification(((l=t.response)===null||l===void 0?void 0:l.message)||"An error in the merge process occurred, please contact Testim support",{type:"error"})}throw new Error(((u=t.response)===null||u===void 0?void 0:u.message)||((d=t.response)===null||d===void 0?void 0:d.text))}}async processAfterBranchMerge(e,t){if(e!==this.branch){return}this._currentBranchRevisions=t;L.sharedStepSingleton.invalidateCachedData();await this.refreshBranchData(e);this.trigger(W.CURRENT_BRANCH_UPDATE,this.branch)}get branch(){return this.currentBranch||B.MASTER_BRANCH}getBranchList(){return this.branchList}get activeBranches(){return Object.values(this.branchList).filter((e=>!e.isArchived))}getBranchData(e){return this.branchList[e]||null}get mainBranch(){return this.getBranchData(B.MASTER_BRANCH)}getBranchReadOnlyData(e){var t,s;let i;if(this.labFeaturesService.isFeatureAvailableForProject("PREnhancements")){i=this.readonlyBranches.has(e)||Boolean((t=this.getBranchData(e))===null||t===void 0?void 0:t.isReadOnly)}else{i=Boolean((s=this.getBranchData(e))===null||s===void 0?void 0:s.isReadOnly)}return{isBranchReadOnly:i,branchReadOnlyMessage:i?`${e} is read only, in order to perform changes, fork to a new branch`:""}}get branchReadOnlyMessage(){return this.getBranchReadOnlyData(this.branch).branchReadOnlyMessage}getCurrentBranchReadOnlyData(){return this.getBranchReadOnlyData(this.branch)}get isBranchReadOnly(){return this.getCurrentBranchReadOnlyData().isBranchReadOnly}async refreshBranchData(e){if(!this.branchList){throw new Error("this can only be called after everything is loaded")}const t=await this.testimServices.branch.getBranchData(this.projectsService.projectId,e);this.branchList[e]=t}async loadBranchesData(e){let t=await this.testimServices.branch.getBranchesData(this.projectsService.projectId);this._projectMissingBranches=Object.keys(t).length===0;if(this._projectMissingBranches){t={master:{name:B.MASTER_BRANCH}}}this.setBranchList(t);this.setPinnedBranch(this.projectsService.projectId);this.setShouldLoadPinBranch(!!e);this._resolveBranchListReady()}setBranchList(e){this.branchList=e}onProjectChange(e,t=false){const s=e===null||e===void 0?void 0:e.id;const i=(0,M.isPlaygroundModeState)(this.urlState);this.setShouldLoadPinBranch(false);if(s===B.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&i){this.branchList={master:{name:B.MASTER_BRANCH}};this.currentBranch=B.MASTER_BRANCH;this._resolveBranchListReady();return}J.log(`project selected: ${s}`);if(t){this._resetIsReadyState()}this.loadBranchesData(t);this.setBranchRevisions();this._adjustPrAndReadOnlySettings()}setPinnedBranch(e){var t,s,i,o;const n=(s=(t=this.userService.getPreferences())===null||t===void 0?void 0:t.pinnedBranchesByProjectId)===null||s===void 0?void 0:s[e];this._pinnedBranch=n&&((o=(i=this.branchList)===null||i===void 0?void 0:i[n])===null||o===void 0?void 0:o.isArchived)===false?n:B.MASTER_BRANCH;this.analyticsService.setPinnedBranchName(this._pinnedBranch)}setLastBranch(e){if(!e){return}j.utils.getStorage().setItem(Y,e);this._lastBranch=e}getLastBranch(){return this._lastBranch}onLogout(){this.currentBranch=null;this._resetIsReadyState();j.utils.getStorage().removeItem(Y)}};t.BranchesService=z;i([E.observable,o("design:type",Object)],z.prototype,"_lastBranch",void 0);i([E.observable,o("design:type",Object)],z.prototype,"currentBranch",void 0);i([E.observable.shallow,o("design:type",typeof(g=typeof BranchList!=="undefined"&&BranchList)==="function"?g:Object)],z.prototype,"branchList",void 0);i([E.observable,o("design:type",typeof(v=typeof BranchRevisions!=="undefined"&&BranchRevisions)==="function"?v:Object)],z.prototype,"_currentBranchRevisions",void 0);i([E.observable,o("design:type",Object)],z.prototype,"_pinnedBranch",void 0);i([E.observable,o("design:type",Object)],z.prototype,"_shouldLoadPinnedBranch",void 0);i([E.observable,o("design:type",Object)],z.prototype,"_branchChangedInEditorContext",void 0);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"branchChangedInEditorContext",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"currentBranchRevision",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"pinnedBranch",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"shouldLoadPinnedBranch",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"pullRequestBranches",null);i([E.computed,o("design:type",typeof(S=typeof Set!=="undefined"&&Set)==="function"?S:Object),o("design:paramtypes",[])],z.prototype,"branchesRequiringPullRequests",null);i([E.computed,o("design:type",typeof(y=typeof Set!=="undefined"&&Set)==="function"?y:Object),o("design:paramtypes",[])],z.prototype,"readonlyBranches",null);i([E.action,o("design:type",Function),o("design:paramtypes",[Boolean]),o("design:returntype",void 0)],z.prototype,"setBranchChangedInEditorContext",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"branch",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"activeBranches",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"mainBranch",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"branchReadOnlyMessage",null);i([E.computed,o("design:type",Object),o("design:paramtypes",[])],z.prototype,"isBranchReadOnly",null);i([E.action,o("design:type",Function),o("design:paramtypes",[typeof(b=typeof Record!=="undefined"&&Record)==="function"?b:Object]),o("design:returntype",void 0)],z.prototype,"setBranchList",null);t.BranchesService=z=i([(0,T.injectable)(),o("design:paramtypes",[typeof(n=typeof D.ProjectsService!=="undefined"&&D.ProjectsService)==="function"?n:Object,typeof(r=typeof O.AnalyticsService!=="undefined"&&O.AnalyticsService)==="function"?r:Object,typeof(a=typeof x.TestimServicesApi!=="undefined"&&x.TestimServicesApi)==="function"?a:Object,typeof(c=typeof C.UrlStateService!=="undefined"&&C.UrlStateService)==="function"?c:Object,typeof(l=typeof I.UserService!=="undefined"&&I.UserService)==="function"?l:Object,typeof(u=typeof H.ModalService!=="undefined"&&H.ModalService)==="function"?u:Object,typeof(d=typeof F.FeatureFlagsService!=="undefined"&&F.FeatureFlagsService)==="function"?d:Object,typeof(p=typeof U.FeatureAvailabilityService!=="undefined"&&U.FeatureAvailabilityService)==="function"?p:Object,typeof(h=typeof N.LabFeaturesService!=="undefined"&&N.LabFeaturesService)==="function"?h:Object,typeof(f=typeof A.NotificationDisplayService!=="undefined"&&A.NotificationDisplayService)==="function"?f:Object,typeof(m=typeof k.AuthenticationService!=="undefined"&&k.AuthenticationService)==="function"?m:Object])],z)},,,function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(470),t)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.AuthenticationService=void 0;const r=s(6);const a=s(354);const c=s(7);const l=s(8);const u=s(5);const d=s(33);const p=s(9);const h=s(14);const f=s(2);const m=c.Logger.getLogger("auth-manager");const g=5*60*1e3;let v=class e extends d.EventEmitter{constructor(e){super();this.featureFlagService=e;this._loginData=null}get isAdmin(){var e;return this.isLoggedIn()&&Boolean((e=this.getLoggedUserInfo().adminSettings)===null||e===void 0?void 0:e.isAdmin)}get isSuperAdmin(){const{isAdmin:e,adminGroup:t,companyAllowPrivileges:s,companyBlockList:i,defaultAdminPrivileges:o}=this.getLoggedUserInfo().adminSettings||{};return this.isLoggedIn()&&Boolean(e)&&r.isEmpty(s)&&r.isEmpty(i)&&t===undefined&&!["readOnly","none"].includes(o)}get loginData(){if(this._loginData){return this._loginData}const e=l.utils.getStorage().getItem("loginData");try{return JSON.parse(e||"")}catch{return null}}logout(e=""){this._loginData=null;this.trigger(u.commonConstants.scenario.APP_LOGOUT,{logoutReason:e});l.utils.getStorage().removeItem("loginData");l.utils.getStorage().removeItem("isNewUser")}jwtDecode(e){if(e){try{return(0,a.default)(e)}catch(e){m.warn("failed to decode token",e);return{}}}return{}}setRefreshToken(e){const t=this._loginData;if(t){t.refreshToken=e;this._loginData=t;this.setCachedLoginData(this._loginData)}}setLoginData(e){const t=e?this.jwtDecode(e.token):{};this._loginData=t&&Object.assign({},e,{tokenExpIn:(t.exp||1)*1e3});this.setCachedLoginData(this._loginData)}login(e){var t,s,i,o,n,r;if(!e.uid){this.logout();return}Object.assign(e,{adminSettings:{isAdmin:Boolean((t=e.adminSettings)===null||t===void 0?void 0:t.isAdmin),adminGroup:(s=e.adminSettings)===null||s===void 0?void 0:s.adminGroup,defaultAdminPrivileges:(i=e.adminSettings)===null||i===void 0?void 0:i.defaultAdminPrivileges,companyAllowPrivileges:(o=e.adminSettings)===null||o===void 0?void 0:o.companyAllowPrivileges,companyBlockList:(n=e.adminSettings)===null||n===void 0?void 0:n.companyBlockList}});this.setLoginData(e);this.featureFlagService.setEmail(e.email);this.featureFlagService.isAdmin((r=e.adminSettings)===null||r===void 0?void 0:r.isAdmin);this.trigger(u.commonConstants.scenario.APP_LOGIN,e)}updateDataOnRefreshToken(e){var t;m.log("updateDataOnRefreshToken",{isLoggedIn:this.isLoggedIn(),doesDataExist:Boolean(e),doesTokenExist:Boolean(e===null||e===void 0?void 0:e.token)});if(!this.isLoggedIn()){return}const s=this.jwtDecode(e.token);const i=Object.assign({},this._loginData,{token:e.token,refreshToken:e.refreshToken||((t=this._loginData)===null||t===void 0?void 0:t.refreshToken),tokenExpIn:(s.exp||1)*1e3});this.setCachedLoginData(i);this._loginData=i}isLoggedIn(){return this.isLoginDataExist()}isTokenAlive(e=this.loginData,t=g){return(e===null||e===void 0?void 0:e.tokenExpIn)&&(e===null||e===void 0?void 0:e.tokenExpIn)>Date.now()+t}setCachedLoginData(e){const t=r.clone(e);t.isNew=false;if(t&&t.uid===u.commonConstants.defaults.FAKE_CODE_USER_ID){return}l.utils.getStorage().setItem("loginData",JSON.stringify(t))}updatePreferences(e){if(this.isLoginDataExist(this._loginData)){this._loginData.preferences=e;this.setCachedLoginData(this._loginData)}}updateRole(e){if(this.isLoginDataExist(this._loginData)&&!r.isEmpty(e)){this._loginData.role=e;this.setCachedLoginData(this._loginData)}}updateName(e){if(this.isLoginDataExist(this._loginData)&&e){this._loginData.name=e;this.setCachedLoginData(this._loginData)}}updatePhoneNumber(e){if(this.isLoginDataExist(this._loginData)&&e){this._loginData.phoneNumber=e;this.setCachedLoginData(this._loginData)}}getBasicUserInfo(){const e=this._loginData;return{uid:(e===null||e===void 0?void 0:e.uid)||null}}getToken(){var e;return(e=this._loginData)===null||e===void 0?void 0:e.token}getRefreshToken(){var e;return(e=this._loginData)===null||e===void 0?void 0:e.refreshToken}getLoggedUserInfo(){var e,t,s,i,o;const n=this._loginData;if(this.featureFlagService.flags.dontWrapUnwrapLoginData.isEnabled()){return n||{}}if(r.isEmpty(n)){return{uid:null,email:null,error:"not logged in"}}return{email:n.email||"",name:n.name||"",uid:n.uid,phone:n.phoneNumber||"",token:n.token,isNew:n.isNew,provider:n.provider||"google.com",preferences:n.preferences||{},photoURL:n.photoURL,role:n.role,adminSettings:{isAdmin:Boolean((e=n.adminSettings)===null||e===void 0?void 0:e.isAdmin),adminGroup:(t=n.adminSettings)===null||t===void 0?void 0:t.adminGroup,defaultAdminPrivileges:(s=n.adminSettings)===null||s===void 0?void 0:s.defaultAdminPrivileges,companyAllowPrivileges:(i=n.adminSettings)===null||i===void 0?void 0:i.companyAllowPrivileges,companyBlockList:(o=n.adminSettings)===null||o===void 0?void 0:o.companyBlockList}}}isLoginDataExist(e=this._loginData){return!r.isEmpty(e)}};t.AuthenticationService=v;i([f.observable,o("design:type",Object)],v.prototype,"_loginData",void 0);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],v.prototype,"isAdmin",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],v.prototype,"isSuperAdmin",null);t.AuthenticationService=v=i([(0,p.injectable)(),o("design:paramtypes",[typeof(n=typeof h.FeatureFlagsService!=="undefined"&&h.FeatureFlagsService)==="function"?n:Object])],v)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v;Object.defineProperty(t,"__esModule",{value:true});t.CompaniesService=void 0;const S=s(6);const y=s(98);const b=s(187);const _=s(22);const T=s(407);const E=s(192);const I=s(33);const C=s(5);const D=s(8);const O=s(2);const A=s(14);const j=s(38);const w=s(21);const R=s(9);const P=s(144);const x=s(7);const M=s(26);const N=s(27);const F=s(146);const L=s(408);const k=s(48);const B=s(63);y.extend(b);const U=x.Logger.getLogger("companies_service");const G="testim_companyId";const V="project";const H=100;const $=300;const W=["tta-crm.tricentis.com","tta-crm.tricentis.local"];let J=class e extends I.EventEmitter{constructor(e,t,s,i,o,n,r,a){super();this.testimServices=e;this.featureFlagsService=t;this.featureAvailabilityService=s;this.authenticationManager=i;this.urlStateService=o;this.analyticsService=n;this.analyticsSystemsService=r;this.notificationDisplayService=a;this._companies=new Map;this.adminLoadCache=new Map;this.companyProjectsCache=new Map;this.companyProjectsPromises=new Map;this.debouncedSearch=S.debounce(((e,t,s)=>this.testimServices.company.searchCompanies(e,H,t!==null&&t!==void 0?t:this.featureFlagsService.flags.showArchivedProjects.isEnabled()).then(s)),$);this.reset();this.authenticationManager.on(C.commonConstants.scenario.APP_LOGOUT,(()=>this.onLogout()));(0,O.reaction)((()=>this.companiesToLoad),(e=>{if(e){this.companiesLoaded=(0,N.fromPromise)(this.loadCompanies(e))}}))}get currentCompany(){if(!this._currentCompanyId){return{}}return this._companies.get(this._currentCompanyId)||{}}set currentCompany(e){this._companies.set(this._currentCompanyId,e)}get areCompaniesLoaded(){return Boolean(this.companiesToLoad&&this._companies.size&&this.companiesLoaded.state!=="pending")||this._currentCompanyId===C.commonConstants.defaults.FAKE_CODE_COMPANY_ID}get tdcLicense(){return this.currentCompany.tdcLicense}get tvcLicense(){return this.currentCompany.tvcLicense}get hasTDCTrial(){var e;return Boolean((e=this.tdcLicense)===null||e===void 0?void 0:e.isTrial)}get hasTVCTrial(){var e;return Boolean((e=this.tvcLicense)===null||e===void 0?void 0:e.startedAt)}get testimLicense(){return this.currentCompany.l2cLicense}get hasTestimTrial(){var e;return this.doesFollowL2c&&Boolean(!((e=this.testimLicense)===null||e===void 0?void 0:e.isPaid))}onLogout(){this.reset();D.utils.getStorage().removeItem(G)}reset(){this._currentCompanyId="";this._companies.clear();this.adminLoadCache.clear();this.companyProjectsCache.clear()}setLastCompanyId(e){if(!e||e===C.commonConstants.defaults.FAKE_CODE_COMPANY_ID){return}D.utils.getStorage().setItem(G,e)}getCompanyIdFromStorage(){return D.utils.getStorage().getItem(G)}isInCompanies(e){return Boolean(e&&this._companies.has(e))}updateCurrentCompany(e){this._companies.set(e.id,e)}get companiesToLoad(){const{uid:e}=this.authenticationManager.getLoggedUserInfo();const{companyId:t,projectId:s}=this.urlStateService.params;if(!e||e===C.commonConstants.defaults.FAKE_CODE_USER_ID){return null}if(this.authenticationManager.isAdmin&&(t||s)){return{projectId:s,companyId:t}}return{uid:e}}async adminLoadCompaniesIfNeeded({companyId:e,projectId:t}){var s;if(!this.authenticationManager.isAdmin){return}let i;if(t&&!this.adminLoadCache.has(`${V}:${t}`)){i=await this.testimServices.company.getCompanyByProjectId(t)}if(e&&!this._companies.has(e)){i=await this.testimServices.company.getCompany(e)}if(i){(s=i===null||i===void 0?void 0:i.projects)===null||s===void 0?void 0:s.forEach((e=>this.adminLoadCache.set(`${V}:${e}`,[i])));this._companies.set(i.id,i)}}async searchCompanies(e,t){e=e.toLowerCase().trim();if(!e){return[]}return await new Promise((s=>{this.debouncedSearch(e,t,s)}))}async loadCompanies({uid:e,projectId:t,companyId:s}){await this.adminLoadCompaniesIfNeeded({companyId:s,projectId:t});if(e){const t=await this.testimServices.company.getCompanies(e);t.forEach((e=>this._companies.set(e.id,e)))}}get userCompanies(){return Array.from(this._companies.values())}get companyId(){return this._currentCompanyId}get isTtaForSalesforceApp(){return this.currentCompanyProductType===L.TESTIM_PRODUCT_TYPE.TTA_SFDC}get defaultDemoProjectId(){return this.isTtaForSalesforceApp?C.commonConstants.defaults.TTA_SFDC_DEMO_PROJECT_ID:C.commonConstants.defaults.DEMO_PROJECT_ID}get currentCompanyProductType(){var e;const{ttaForSalesforce:t}=((e=this.currentCompany.plan)===null||e===void 0?void 0:e.premiumFeatures)||{};if(t)return L.TESTIM_PRODUCT_TYPE.TTA_SFDC;const s=localStorage.getItem("testim_product_type");if((0,L.isTestimProductType)(s))return s;const i=localStorage.ttaDev==="true"&&!true;if(i||W.includes(window.location.host))return L.TESTIM_PRODUCT_TYPE.TTA_SFDC;return L.TESTIM_PRODUCT_TYPE.AUTOMATE}get isEssentialsPlan(){const e=this.companyTailoredPlan;if(e){return Boolean(e.isEssentials)}return false}async renameCompany(e){await this.testimServices.company.rename(this.companyId,e);this.currentCompany={...this.currentCompany,name:e}}get companyName(){var e;return((e=this.currentCompany)===null||e===void 0?void 0:e.name)||""}get companyUCID(){var e;return((e=this.currentCompany)===null||e===void 0?void 0:e.ucid)||""}setCompanyUCID(e){this.currentCompany.ucid=e}setCompanyFollowL2c(e){this.currentCompany.followL2CPlan=e}get doesFollowL2c(){return Boolean(this.currentCompany.followL2CPlan)}get activePlan(){var e;return((e=this.currentCompany)===null||e===void 0?void 0:e.activePlan)||{plan:"free"}}getDocs(e){const t=this.isTtaForSalesforceApp?"sfdcDocumentationUrls":"documentationUrls";return C.commonConstants[t][e]}get isOnPrem(){return this.currentCompany.onprem||false}get storageType(){return this.currentCompany.storageType||C.commonConstants.company.DEFAULT_STORAGE_TYPE}get storageBaseUrl(){return this.currentCompany.storageBaseUrl||C.commonConstants.company.DEFAULT_STORAGE_BASE_URL}get currentUserIsCompanyOwner(){return this.currentCompany.role==="owner"}get currentUserCompanyRole(){return this.currentCompany.role}get currentUserIsCompanyReadOnly(){return this.currentCompany.role==="read-only"||this.adminPrivilegesForCurrentCompany==="readOnly"}async addOwner(e){if(!e){return undefined}return this.testimServices.company.addOwner(this.companyId,e)}async removeOwner(e){if(!e){return undefined}return this.testimServices.company.removeOwner(this.companyId,e)}async replaceUserAsOwner(e,t){if(!e||!t||e===t){return}await this.testimServices.company.replaceOwner(this.companyId,t,e);const{uid:s}=this.authenticationManager.getLoggedUserInfo();if(s===e){this.currentCompany={...this.currentCompany,role:"editor"}}}get companyPlanType(){const e=this.currentCompany.activePlan||{plan:"free"};if(e.plan==="free"){const t=this.getTrialPlanRemainingTime(e)>0;return t?"trial":"free"}return"pro"}userAnalyticsDataAndCompany(){const e=this.companyName;const t=this.companyUCID;const s=this.authenticationManager.loginData;const i=this.activePlan;const o=i.expiredAt||i.expiredAT;const n=this.companyPlanType;const r=o?y.utc(o):"No Expiration Set";if(!s){U.warn("missing userInfo")}return{userId:s===null||s===void 0?void 0:s.uid,name:s===null||s===void 0?void 0:s.name,email:s===null||s===void 0?void 0:s.email,phone:s===null||s===void 0?void 0:s.phone,provider:s===null||s===void 0?void 0:s.provider,role:s===null||s===void 0?void 0:s.role,companyId:this.currentCompany.id,companyName:e,companyPlan:n,company:{id:this.currentCompany.id,name:e,ucid:t,plan:n,planType:n,isPoc:i.isPoc,isStartUp:i.isStartUp,planExpiration:r,createdAt:this.currentCompany.createdAt}}}get companyTailoredPlan(){return this.currentCompany.tailoredPlan||false}getMarketingInfoIfNeeded(){const e=this.analyticsSystemsService.getUrlParams();if(!e.hasParams){return{}}this.analyticsSystemsService.resetUrlParams();return{utm_campaign:e.utmCampaign,utm_content:e.utmContent,utm_medium:e.utmMedium,utm_source:e.utmSource,utm_term:e.utmTerm,referrer:e.referrer}}async waitForCompanyLoaded(e){await(0,O.when)((()=>this.areCompaniesLoaded));await this.adminLoadCompaniesIfNeeded({companyId:e});await(0,O.when)((()=>this._companies.has(e)))}async selectCompany(e){if(!e||this._currentCompanyId===e){return}await this.waitForCompanyLoaded(e);const t=this._companies.get(e);let s=C.commonConstants.scenario.COMPANY_CHANGED;if(!this._currentCompanyId){s=C.commonConstants.scenario.COMPANY_SELECTED}this._currentCompanyId=e;const i=this.userAnalyticsDataAndCompany();this.featureFlagsService.setCompanyId(e);const o=this.companyPlanType;this.featureFlagsService.setPlanType(o);this.featureAvailabilityService.setPlanType(o);this.featureFlagsService.setIsPOC(Boolean(this.activePlan.isPoc));this.featureFlagsService.setIsStartUp(Boolean(this.activePlan.isStartUp));this.featureFlagsService.setCompanyProductType(this.currentCompanyProductType);this.trigger(s,t);this.setLastCompanyId(e);this.analyticsService.setCompanyData({ucid:this.companyUCID,companyId:e,companyName:this.companyName,userInfo:i});this.analyticsSystemsService.setCurrentCompany(t);this.analyticsService.setIsStartupPlan(Boolean(this.activePlan.isStartUp));this.analyticsService.setCompanyProductType(this.currentCompanyProductType);try{const e=!this.featureFlagsService.flags.showAuryc.isEnabled();const t=()=>{if(e){window.auryc.pause()}else{window.auryc.resume()}};if(window.auryc){t()}else if(window.aurycReadyCb){window.aurycReadyCb.push(t)}const s=1e3*60*60;const i=4;setTimeout((()=>window.auryc&&window.auryc.pause()),s*i)}catch(e){U.error("error from Auryc try-catch block",e)}}selectFakeCompanyForCodePage(){const e=C.commonConstants.defaults.FAKE_CODE_COMPANY_ID;this._currentCompanyId=e;const t={id:e,name:"fake",ucid:"fake_ucid",createdAt:1570958468365,plan:{plan:"free"},activePlan:{plan:"free"},onprem:false,sso:undefined,tailoredPlan:undefined,storageType:C.commonConstants.company.DEFAULT_STORAGE_TYPE,storageBaseUrl:C.commonConstants.company.DEFAULT_STORAGE_BASE_URL,role:"editor"};this._companies=new Map([[e,t]]);this.trigger(C.commonConstants.scenario.COMPANY_SELECTED,t)}isInFreePlan(){return this.companyPlanType==="free"}isPayingPlan(){const e=this.companyPlanType;return e==="pro"}get isInTrialPlanIgnoringExpiryTime(){const e=this.currentCompany.plan||{plan:"free"};return Boolean(e.plan==="free"&&this.getPlanExpireAt(e))}getRemainingTime(e){let t=e-Date.now();t=t<0?0:t;return Math.ceil(t/(1e3*60*60*24))}getPlanExpireAt(e){return e.expireAt||e.expireAT}getTrialPlanRemainingTime(e=this.activePlan){const t=this.getPlanExpireAt(e);return t?this.getRemainingTime(t):0}get getFeatureOnTrial(){var e;const t=Object.entries(((e=this.currentCompany.plan)===null||e===void 0?void 0:e.premiumFeatures)||{}).find((([,e])=>typeof e==="object"&&e.expireAt>Date.now()));return t?{name:t[0],expireAt:t[1].expireAt}:undefined}getCompanySSO(){return this.currentCompany.sso||{isEnabled:false,isForced:false}}async setCompanySSO(e,t){const s=await this.testimServices.company.setCompanySSO(this.companyId,e,t);this.currentCompany={...this.currentCompany,sso:s}}async getCompanyProjects(e){if(e&&!this.companyProjectsCache.has(e)){const t=this.companyProjectsPromises.get(e)||this.testimServices.company.getCompanyProjects(e);this.companyProjectsPromises.set(e,t);const s=await t;this.companyProjectsPromises.delete(e);this.companyProjectsCache.set(e,new Map(S.chain(s).keyBy("id").toPairs().value()))}return this.companyProjectsCache.get(e)||new Map}async updateCompanyProjects(e){this.companyProjectsCache.delete(e);return this.getCompanyProjects(e)}get adminPrivilegesForCurrentCompany(){var e;if(!this.authenticationManager.isAdmin){return"none"}if(this.authenticationManager.isSuperAdmin){return"readWrite"}const{adminGroup:t,companyAllowPrivileges:s={},companyBlockList:i=[],defaultAdminPrivileges:o="readWrite"}=this.authenticationManager.getLoggedUserInfo().adminSettings||{};const n=this.companyId;if(i.includes(n)){return"none"}const r=S.isEmpty(s);if(r&&t===undefined){return o}const a=s[n];const c=((e=this.activePlan.premiumFeatures)===null||e===void 0?void 0:e.ttaForSalesforce)?"sfdc":"testim";const l=t===undefined||c===t;const u=typeof(a===null||a===void 0?void 0:a.expiry)==="number"&&y(a.expiry).isBefore(y());if(a&&!u){return a.role}if(!l){return"none"}return o}async extendL2CTrial(e,t){const s=this.companyId;try{await this.testimServices.company.extendL2CTrial(s,e,t);this.notificationDisplayService.sendNotification("Trial extended successfully, please refresh the page")}catch(e){const t=e.response||"Failed to extend trial, please try again later";this.notificationDisplayService.sendNotification(t)}}};t.CompaniesService=J;i([O.observable,o("design:type",String)],J.prototype,"_currentCompanyId",void 0);i([O.observable.shallow,o("design:type",Object)],J.prototype,"_companies",void 0);i([O.computed,o("design:type",typeof(h=typeof T.Company!=="undefined"&&T.Company)==="function"?h:Object),o("design:paramtypes",[typeof(f=typeof T.Company!=="undefined"&&T.Company)==="function"?f:Object])],J.prototype,"currentCompany",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"areCompaniesLoaded",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"tdcLicense",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"tvcLicense",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"hasTDCTrial",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"hasTVCTrial",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"testimLicense",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"hasTestimTrial",null);i([O.action.bound,o("design:type",Function),o("design:paramtypes",[typeof(m=typeof T.Company!=="undefined"&&T.Company)==="function"?m:Object]),o("design:returntype",void 0)],J.prototype,"updateCurrentCompany",null);i([O.computed.struct,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"companiesToLoad",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"userCompanies",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"companyId",null);i([O.computed,o("design:type",Boolean),o("design:paramtypes",[])],J.prototype,"isTtaForSalesforceApp",null);i([O.computed,o("design:type",String),o("design:paramtypes",[])],J.prototype,"defaultDemoProjectId",null);i([O.computed,o("design:type",typeof(g=typeof L.TestimProductType!=="undefined"&&L.TestimProductType)==="function"?g:Object),o("design:paramtypes",[])],J.prototype,"currentCompanyProductType",null);i([O.computed,o("design:type",Boolean),o("design:paramtypes",[])],J.prototype,"isEssentialsPlan",null);i([O.computed,o("design:type",Boolean),o("design:paramtypes",[])],J.prototype,"doesFollowL2c",null);i([O.computed,o("design:type",typeof(v=typeof E.Plan!=="undefined"&&E.Plan)==="function"?v:Object),o("design:paramtypes",[])],J.prototype,"activePlan",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"getFeatureOnTrial",null);i([O.computed,o("design:type",Object),o("design:paramtypes",[])],J.prototype,"adminPrivilegesForCurrentCompany",null);t.CompaniesService=J=i([(0,R.injectable)(),(0,k.exposeGlobally)("companiesService"),o("design:paramtypes",[typeof(n=typeof _.TestimServicesApi!=="undefined"&&_.TestimServicesApi)==="function"?n:Object,typeof(r=typeof A.FeatureFlagsService!=="undefined"&&A.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof F.FeatureAvailabilityService!=="undefined"&&F.FeatureAvailabilityService)==="function"?a:Object,typeof(c=typeof j.AuthenticationService!=="undefined"&&j.AuthenticationService)==="function"?c:Object,typeof(l=typeof M.UrlStateService!=="undefined"&&M.UrlStateService)==="function"?l:Object,typeof(u=typeof w.AnalyticsService!=="undefined"&&w.AnalyticsService)==="function"?u:Object,typeof(d=typeof P.AnalyticsSystemsService!=="undefined"&&P.AnalyticsSystemsService)==="function"?d:Object,typeof(p=typeof B.NotificationDisplayService!=="undefined"&&B.NotificationDisplayService)==="function"?p:Object])],J)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(477),t)},,function(e,t,s){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:true});t.httpRequest=void 0;const o=s(6);const n=s(332);const r=s(77);const a=s(8);const c=s(14);const l=s(61);const u=s(7);const d=s(97);const p=s(344);const h=u.Logger.getLogger("httpRequest");const f=l.container.get(c.FeatureFlagsService);const m=s(345);const g=new m({ratePer:100,concurrent:20});const v=(0,p.throttleFunction)(fetch,{callsNum:20,delayMs:100});function S(){if(a.utils.isNode()&&e.caFileContent){return e.caFileContent}return undefined}function y(){if(!a.utils.isNode()){return undefined}if(!n.Request.prototype.proxy&&e.SuperagentProxy){e.SuperagentProxy(n)}if(e.proxyUri){return e.proxyUri}return undefined}function b(){var t,i;if(a.utils.isNode()&&e.proxyUri){const n=s(297);const r=n.parse(e.proxyUri);const a=S();if(!o.isEmpty(a)&&/https/.test((t=r.protocol)!==null&&t!==void 0?t:"")){r.ca=a;return(i=e.HttpsProxyAgent)===null||i===void 0?void 0:i.call(e,r)}return new e.ProxyAgent(e.proxyUri)}return undefined}function _(e,t,s){if(a.utils.isNode()){return i.from(e,"base64")}t||(t="");s||(s=512);const o=atob(e);const n=[];for(let e=0;e<o.length;e+=s){const t=o.slice(e,e+s);const i=new Array(t.length);for(let e=0;e<t.length;e++){i[e]=t.charCodeAt(e)}const r=new Uint8Array(i);n.push(r)}return new Blob(n,{type:t})}function T(e,t,s,i,r={},a,c,l,u,p){function h(){switch(t){case"DELETE":return n.del(e);case"POST":return n.post(e);case"HEAD":return n.head(e);case"PUT":return n.put(e);case"GET":return n.get(e);default:throw new Error(`invalid request method: ${t}`)}}const f=h();f.use(g.plugin());const m=()=>f.abort();p===null||p===void 0?void 0:p.addEventListener("abort",m);if(o.isNumber(a)){f.timeout(a)}if(o.isNumber(u)){f.retry(u)}if(s&&!r["Content-Type"]){r["Content-Type"]=s}if(r["Content-Type"]==="multipart/form-data"){delete r["Content-Type"]}if(!o.isEmpty(r)){f.set(r)}if(!o.isEmpty(S())){f.ca(S())}if(!o.isEmpty(y())){f.proxy(y())}if(!o.isEmpty(l)){f.responseType(l)}if(i){if(s==="multipart/form-data"){f.field(i)}else{f.send(i)}}if(c&&Object.keys(c).length>0&&s==="multipart/form-data"){Object.keys(c).forEach((e=>{const{fileName:t,mimeType:s,file:i}=c[e];const o=i instanceof Blob?t:{filename:t,contentType:s};f.attach(e,i,o)}))}return f.then((e=>e.body||e.text)).catch((s=>{var i,o;throw new d.TypedHttpError({err:s,response:((i=s.response)===null||i===void 0?void 0:i.body)||((o=s.response)===null||o===void 0?void 0:o.text),method:t,url:e,timedout:f.timedout})})).finally((()=>{p===null||p===void 0?void 0:p.removeEventListener("abort",m)}))}const E="timeout";const I="Content-Type";function C(e,t,s,i,n={},a,c,l,u,p){const f={method:t,body:i||undefined,headers:new Headers(n)};const m=new AbortController;const g=(...e)=>m.abort(...e);try{p===null||p===void 0?void 0:p.addEventListener("abort",g);f.signal=m.signal;if(s&&!f.headers.has(I)){f.headers.set(I,s)}if(f.headers.get(I)==="multipart/form-data"){f.headers.delete(I)}f.agent=b();if(/json|multipart\/form-data/i.test(s||"")){f.body=typeof i==="string"?i:JSON.stringify(i)}if(t.toLocaleLowerCase()==="get"){delete f.body}const e=Object.keys(c||{});if(c&&e.length>0&&s==="multipart/form-data"){let t=new FormData;if(i instanceof FormData){t=i}else if(o.isObject(i)){Object.entries(i).forEach((([e,s])=>{t.append(e,s)}))}e.forEach((e=>{const{fileName:s,mimeType:i,file:o}=c[e];let n;if(o instanceof Blob){if(o.type!==i){n=o.slice(0,o.size,i)}else{n=o}}else{n=new Blob([o],{type:i})}t.append(e,n,s)}));f.body=t}}catch(o){h.error("Failed to build fetch request",{error:o,arguments:{url:e,method:t,contentType:s,body:i,headers:n,timeout:a,files:c,responseType:l,retry:u,abortSignal:p}});throw o}const S=async e=>{const t=await(e===null||e===void 0?void 0:e.text());if(!t){return t}try{return JSON.parse(t)}catch(e){return t}};let y;if(a){y=setTimeout((()=>{m.abort(E)}),a)}const _=async()=>(0,r.default)((async()=>{try{const s=await v(e,f);if(!s.ok){const i=m.signal.reason===E;const o=await S(s);throw new d.TypedHttpError({err:s,response:o,method:t,url:e,timedout:i})}return s}catch(e){if(e.name==="AbortError"){throw new r.AbortError(e.message)}throw e}}),{onFailedAttempt:t=>{h.log(`Failed request to ${e} with error: ${t.message} - retrying ${t.retriesLeft} more times`)},retries:u||0,factor:1});return _().then((e=>{if(!e.ok){throw e}const t={json:()=>e.json(),text:()=>e.text(),blob:()=>e.blob(),default:()=>{var t;const s=(t=e.headers.get(I))!==null&&t!==void 0?t:"";if(/json/i.test(s)){return e.json()}return e.text()}};return t[l||"default"]()})).catch((async s=>{if(s instanceof d.TypedHttpError){throw s}const i=m.signal.reason===E;const o=await S(s instanceof Response?s:undefined);throw new d.TypedHttpError({err:s,response:o,method:t,url:e,timedout:i})})).finally((()=>{p===null||p===void 0?void 0:p.removeEventListener("abort",g);clearTimeout(y)}))}const D=(...e)=>{const t=f.flags.replaceSuperagentWithFetch.isEnabled();if(t){return C(...e)}return T(...e)};t.httpRequest={head(e,t,s){return D(e,"HEAD",null,null,t,s)},getBlob(e,t,s){return D(e,"GET",t,null,s,null,null,"blob")},get(e,t,s){return D(e,"GET",t,null,s)},getJson(e,t,s){return D(e,"GET","application/json",null,t,undefined,undefined,undefined,undefined,s)},put(e,t,s){return D(e,"PUT",t,s)},putJson(e,t,s,i,o){return D(e,"PUT","application/json",t,s,i,undefined,undefined,o)},postJson(e,t,s,i,o,n){return D(e,"POST","application/json",t,s,i,undefined,undefined,o,n)},postForm(e,t,s,i){const o=Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&");return D(e,"POST","application/x-www-form-urlencoded",o,s,i)},postFormData(e,t,s,i,o,n){return D(e,"POST","multipart/form-data",t,i,o,s,undefined,undefined,n)},postFormDataWithProgress(e,t,s,i,o,n,r){const a=new XMLHttpRequest;a.open("POST",e);a.upload.addEventListener("progress",(e=>{r===null||r===void 0?void 0:r(e)}));Object.keys(i||{}).forEach((e=>{a.setRequestHeader(e,i[e])}));const c=new FormData;Object.entries(s||{}).forEach((([e,t])=>{c.append(e,t.file,t.fileName)}));const l=new Promise(((e,t)=>{function s(){t(Object.assign(new Error("POST formData with progress failed"),{status:a.status,statusText:a.statusText}))}a.onload=()=>{var t;if([0,200,201].includes(a.status)){if((t=a.getResponseHeader("content-type"))===null||t===void 0?void 0:t.startsWith("application/json")){e(JSON.parse(a.response));return}e(a.response);return}s()};a.onerror=()=>{s()}}));a.timeout=o||0;n===null||n===void 0?void 0:n.addEventListener("abort",(()=>{a.abort()}));a.send(c);return l},uploadBase64AsBlob(e,t,s,i,o){return this.postFormData(e,{name:s,file:_(t,i),filename:s},null,o)},putBase64AsBlob(e,t,s,o){const n=_(t,s);o["content-length"]=n.size||i.byteLength(n);return D(e,"PUT",s,n,o)},delete(e,t,s){return D(e,"DELETE","application/json",t,s)}}}).call(this,s(36),s(65).Buffer)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.testimServices=t.testimServicesSingleton=void 0;const i=s(22);const o=s(61);t.testimServicesSingleton=o.container.get(i.TestimServicesApi);t.testimServices=t.testimServicesSingleton;if(false){}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(480),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(485),t)},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.exposeGlobally=void 0;const i=new Map;function o(){if(typeof window==="undefined"){return}const{UIContainer:e}=s(88);Array.from(i.entries()).forEach((([t,s])=>{const o=typeof s==="function"&&/^\s*class\s+/.test(s.toString());if(o){i.set(t,e.get(s))}}));window.DIProvider=i}function n(e){return function(t){i.set(e,t);const s=typeof window!=="undefined"&&(window===null||window===void 0?void 0:window.DIProvider);if(s){queueMicrotask((()=>{o()}))}}}t.exposeGlobally=n;queueMicrotask((()=>{o()}))},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g;Object.defineProperty(t,"__esModule",{value:true});t.UserService=t.SCHEDULER_SUGGESTIONS_INITIAL_COUNT=void 0;const v=s(6);const S=s(66);const y=s(70);const b=s(27);const _=s(9);const T=s(8);const E=s(7);const I=s(33);const C=s(5);const D=s(43);const O=s(429);const A=s(38);const j=s(21);const w=s(144);const R=s(63);const P=s(14);const x=s(73);const M=s(20);const N=s(15);const F=s(39);const L=s(2);const k=s(51);const B=s(45);const U=s(28);const G=s(26);const V=s(48);const H=s(797);const $=E.Logger.getLogger("user.srv");t.SCHEDULER_SUGGESTIONS_INITIAL_COUNT=3;let W=class e extends I.EventEmitter{constructor(e,t,s,i,o,n,r,a,c){super();this.authenticationManager=e;this.analyticsService=t;this.analyticsSystemsService=s;this.projectsService=i;this.companiesService=o;this.notificationDisplayService=n;this.modalService=r;this.urlStateService=a;this.featureFlagsService=c;this.isLogoutInProgress=false;this.logout=async()=>{const e=this.authenticationManager.getRefreshToken();const t=this.getUserId();try{await T.utils.promiseTimeout(D.testimServicesSingleton.auth.signout(t,e),5e3)}catch(e){$.error("failed to logout",e)}this.authManagerLogout();this.trigger(C.commonConstants.user.LOGOUT);this.notificationDisplayService.sendNotification("Goodbye!",{autoHide:true});this.analyticsService.userLoggedOut()};e.on(C.commonConstants.scenario.APP_LOGOUT,(e=>this.onLogout(e)))}get projectUsers(){const e=this.projectsService.projectId;const t=this.companiesService.companyId;if(!e||!t){return b.fromPromise.resolve([])}return(0,b.fromPromise)(D.testimServicesSingleton.project.getUsers(e,t),b.fromPromise.resolve([]))}get projectUsersOrEmptyDefault(){return this.projectUsers.state==="fulfilled"?this.projectUsers.value:[]}get projectUsersMapOrEmptyDefault(){return v.keyBy(this.projectUsersOrEmptyDefault,"id")}getLoggedUserInfo(){return this.authenticationManager.getLoggedUserInfo()}async onLogout({logoutReason:e}){const t=e===C.commonConstants.user.SESSION_INACTIVE;const s=()=>{const e=t?window.location.hash:"";this.isLogoutInProgress=false;if(M.isEditorForceMode){window.location.href="http://services.testim.io/auth/salesforce";return}this.urlStateService.go(S.signin(e))};if(!t||M.isEditorForceMode){s();return}if(this.isLogoutInProgress){return}this.isLogoutInProgress=true;try{await this.modalService.openModal(B.MessageModal,{body:"Your session has timed out due to inactivity",title:"session timed out",okText:"log in",className:y.default.smallModalLargeButton,textAlign:"left"}).promise}finally{s()}}async _onLoginCompleted(e,t,s=""){if(!e){throw new Error("no login")}const{uid:i,name:o,email:n,phone:r,provider:a,role:c}=this.getLoggedUserInfo();E.Logger.setGlobalInfo({user:{uid:i,email:n}});k.sharedStepSingleton.setUserInfo(e);this.analyticsService.identify({userId:i,name:o,email:n,phone:r,provider:a,role:c});this.analyticsSystemsService.setCurrentUser(i!==null&&i!==void 0?i:"",n!==null&&n!==void 0?n:"",o!==null&&o!==void 0?o:"");try{await this.loadUserPreferencesFromServer()}catch(e){$.warn("failed to load user preferences")}this.trigger(C.commonConstants.user.LOGIN,{loginData:this.authenticationManager.loginData,returnUrl:s,isUserLoggedInManually:t});return e}getUserData(){return this.authenticationManager.loginData}isNewUser(){const e=this.getUserData();return!!(e===null||e===void 0?void 0:e.createdAt)&&Date.now()-e.createdAt<1e3*60*60*24}selectFakeUserForCodePage(){const e=C.commonConstants.defaults.FAKE_CODE_USER_ID;const t="fake.email@testim.io";const s="Fake Code User";const i={token:C.commonConstants.defaults.FAKE_CODE_USER_TOKEN,refreshToken:T.utils.guid(),tokenExpIn:Date.now()+1e3*60*60*24*365,uid:e,email:t,name:s,provider:"password",adminSettings:{isAdmin:false},preferences:{}};this.authenticationManager.setLoginData(i);k.sharedStepSingleton.setUserInfo(i);this.trigger(C.commonConstants.user.LOGIN,{loginData:this.authenticationManager.loginData})}async signInWithPopup(e,t,s,i,o=false,n="",r="testim"){const a=T.utils.guid();const c=`${T.utils.getServicesUrl()}${e}?eventId=${a}&allowPersonalEmail=${o}&productType=${r}`;const l=await(0,M.openPopupAndWait)(c,t,s,a);await this.authManagerLogin(l,i,n);return this.setIsNewUser(l)}googleLogin({allowPersonalEmail:e=false,returnUrl:t="",isUserLoggedInManually:s=false,productType:i="testim"}){return this.signInWithPopup("/auth/google",500,620,s,e,t,i)}oktaLogin({allowPersonalEmail:e=false,returnUrl:t="",isUserLoggedInManually:s=false,productType:i="testim"}){return this.signInWithPopup("/auth/okta",380,640,s,e,t,i)}githubLogin({allowPersonalEmail:e=false,returnUrl:t="",isUserLoggedInManually:s=false,productType:i="testim"}){return this.signInWithPopup("/auth/github",515,680,s,e,t,i)}tryToCreateUser(e,t,s){return D.testimServicesSingleton.auth.tryToCreateUser(e,t,s)}async signInWithEmailPasswordAndCaptcha(e,t,s,i,o=false){const n=await D.testimServicesSingleton.auth.signin(e,t,s);return await this.authManagerLogin(n,o,i)}async authSSO(e){const t=await D.testimServicesSingleton.auth.authSSO(e);return await this.authManagerLogin(t)}signinSSO(e){return D.testimServicesSingleton.auth.signinSSO(e)}validateUserSSO(e){return D.testimServicesSingleton.auth.validateUserSSO(e)}signoutSSO(){this.authManagerLogout();this.trigger(C.commonConstants.user.LOGOUT);this.notificationDisplayService.sendNotification("Goodbye!",{autoHide:true});this.analyticsService.userLoggedOut()}isNew(){return T.utils.getStorage().getItem("isNewUser")==="true"}setIsNewUser(e){const{isNew:t}=e;T.utils.getStorage().setItem("isNewUser",t?"true":"false");return e}async createUser({name:e,email:t,password:s,allowPersonalEmail:i=false,returnUrl:o="",isFromMarketo:n=false}){const r=await D.testimServicesSingleton.auth.signup({name:e,email:t,password:s,allowPersonalEmail:i,metadata:{isFromMarketo:n}});await this.authManagerLogin(r,true,o);return this.setIsNewUser(r)}async loginFromCache(){const e=new Promise((e=>{this.authenticationManager.once(C.commonConstants.scenario.APP_LOGIN,e)}));const t=await H.authenticationFromCache.loginFromCache();await e;return this._onLoginCompleted(t)}isLoggedIn(){return this.authenticationManager.isLoggedIn()}authManagerLogout(){this.authenticationManager.logout()}async authManagerLogin(e,t,s=""){const i=new Promise((e=>{this.authenticationManager.once(C.commonConstants.scenario.APP_LOGIN,e)}));this.authenticationManager.login(e);await i;return this._onLoginCompleted(e,t,s)}async savePreferences(e){const t=this.getUserId();if(t===C.commonConstants.defaults.FAKE_CODE_USER_ID){return undefined}if(t){this.authenticationManager.updatePreferences(e);return await D.testimServicesSingleton.user.updatePreferences(t,e)}throw new Error("failed to find user id to update preferences")}isDeveloper(){const e=this.getUserRole();return O.DEVELOPER_ROLES.includes(e)}isManager(){const e=this.getUserRole();return O.MANAGER_ROLES.includes(e)}isAdmin(){return this.authenticationManager.isAdmin}get isSuperAdmin(){return this.authenticationManager.isSuperAdmin}get canLockSharedSteps(){return this.companiesService.adminPrivilegesForCurrentCompany==="readWrite"||this.projectsService.isOwner()}getUserRole(){return this.getLoggedUserInfo().role}getUserId(){return this.getLoggedUserInfo().uid}getUserName(){return this.getLoggedUserInfo().name}getUserEmail(){let e=this.getLoggedUserInfo().email;if(this.getProvider()==="salesforce.com"&&(e===null||e===void 0?void 0:e.startsWith("sf:"))){e=e.substring(3)}return e}tryToGetUserCompanyFromEmail(){var e;const t=(e=this.getLoggedUserInfo().email)===null||e===void 0?void 0:e.split("@")[1];return(t===null||t===void 0?void 0:t.split(".")[0])||""}getUserProvider(){return H.authenticationFromCache.getCachedLoginData().provider}getImage(){return this.getLoggedUserInfo().photoURL}getProvider(){return this.getLoggedUserInfo().provider}getPreferences(){return this.getLoggedUserInfo().preferences||{}}showPostSignupForm(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.showPostSignupForm}isUsernameEditable(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.showPostSignupUsername}isCompanyNameEditablePostSignup(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.canEditCompanyNamePostSignup}showTestsWizard(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.showTestsWizard}showUserRoleModal(){const e=this.getPreferences();if(v.has(e,"showUserRolePage")){return false}return v.isEmpty(this.getLoggedUserInfo().role)}showUserRolePage(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.showUserRolePage}get showWebMobileSelectionPage(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.showWebMobileSelectionPage}get needEmailConfirmation(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.needEmailConfirmation}get hasBeenInvited(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.hasBeenInvited}isTrialModalDisabled(){const e=this.getPreferences();return e===null||e===void 0?void 0:e.disabledTrialModal}getProductTours(){const e=this.getPreferences();e.productTours||(e.productTours={});return e.productTours}getGuideTasks(){const e=this.getPreferences();return(e===null||e===void 0?void 0:e.guideTasks)||{}}shouldShowFreeGridRunWarningModal(){return!this.getPreferences().disableFreeGridRunWarningModal}getGuideTask(e){return this.getGuideTasks()[e]}getProductTour(e){return this.getProductTours()[e]}async completeProductTour(e){if(!e){return}const t=this.getPreferences();const s=this.getProductTours();s[e]=false;t.productTours=s;try{await this.savePreferences(t)}catch(t){$.error(`failed to update tour start ${e}`,t)}}async updateGuideTasksCompleted(){try{const e=this.getPreferences();e.guideTasksCompleted=true;await this.savePreferences(e)}catch(e){$.error("failed to update guide tasks completed",e)}}hasCompletedSfdcDemoTours(){const e=this.getPreferences();return(e===null||e===void 0?void 0:e.hasCompletedSfdcDemoTours)||false}hasCompletedSfdcCreateSampleTestTour(){const e=this.getPreferences();return(e===null||e===void 0?void 0:e.hasCompletedSfdcCreateSampleTestTour)||false}async updateCompletedSfdcDemoTours(){try{const e=this.getPreferences();e.hasCompletedSfdcDemoTours=true;await this.savePreferences(e)}catch(e){$.error("failed to update demo tours completed",e)}}async updateCompletedSfdcCreateSampleTestTour(){try{const e=this.getPreferences();e.hasCompletedSfdcCreateSampleTestTour=true;await this.savePreferences(e)}catch(e){$.error("failed to update create sample tests tour completed",e)}}async disableTrialModal(){try{const e=this.getPreferences();e.disabledTrialModal=true;await this.savePreferences(e)}catch(e){$.error("failed to update disabled trial modal",e)}}async loadUserPreferencesFromServer(){const e=await D.testimServicesSingleton.user.getPreferences();this.authenticationManager.updatePreferences(e)}async updateGuideTasks(e){if(!e){return}const t=this.getPreferences();const s=this.getGuideTasks();if(s[e]){return}s[e]=true;t.guideTasks=s;try{await this.savePreferences(t)}catch(t){$.error(`failed to update guide tasks ${e}`,t)}}updatePhoneNumber(e){const t=this.getUserId();this.authenticationManager.updatePhoneNumber(e);return D.testimServicesSingleton.user.updatePhoneNumber(t,e)}updateName(e){const t=this.getUserId();this.authenticationManager.updateName(e);return D.testimServicesSingleton.user.updateName(t,e)}updateRole(e){const t=this.getUserId();this.authenticationManager.updateRole(e);return D.testimServicesSingleton.user.updateRole(t,e)}getInitShowTestsWizard(){return this.isCompanyNameEditablePostSignup()?this.featureFlagsService.flags.addTestsWizard.isEnabled():false}updateShowUserRolePage(){const e=this.getPreferences();if(this.featureFlagsService.flags.emailAndProjectSelectionSignupFlow.isEnabled()){if(this.hasBeenInvited){e.showWebMobileSelectionPage=false}else{e.showWebMobileSelectionPage=true}}else{e.showTestsWizard=this.getInitShowTestsWizard()}e.showUserRolePage=false;return this.savePreferences(e)}updateShowWebMobileSelectionPage(){const e=this.getPreferences();if(!this.featureFlagsService.flags.emailAndProjectSelectionSignupFlow.isEnabled()){e.showTestsWizard=this.getInitShowTestsWizard()}e.showWebMobileSelectionPage=false;return this.savePreferences(e)}updatePreferencesPostSignup(){const e=this.getPreferences();e.showPostSignupForm=false;e.schedulerSuggestionsCount=t.SCHEDULER_SUGGESTIONS_INITIAL_COUNT;e.showUserRolePage=true;e.showTestsWizard=undefined;return this.savePreferences(e)}getTourKeys(){const e=Object.keys(x.TOURS);if(!this.featureFlagsService.flags.useNewTestimGuide.isEnabled()){return e.filter((e=>e!==x.TOUR_NAMES.TESTIM_GUIDE))}return e}updatePreferencesTestsWizard(){const e=this.getPreferences();e.showTestsWizard=false;if(this.featureFlagsService.flags.newProductTour.isEnabled()){e.productTours=this.getTourKeys().reduce(((e,t)=>{e[t]=true;return e}),{})}return this.savePreferences(e)}async prepareUsersTours(e){if(e){await this.updatePreferencesTestsWizard()}}async turnOffAllFirstTestTours(){const e=[x.TOUR_NAMES.FIRST_TEST,x.TOUR_NAMES.SECOND_TEST,x.TOUR_NAMES.FIRST_GROUP,x.TOUR_NAMES.START_RECORDING,x.TOUR_NAMES.START_PLAYING,x.TOUR_NAMES.NEW_TEST,x.TOUR_NAMES.SAVE_TEST];await Promise.all(e.map((e=>this.completeProductTour(e))))}setSchedulerSuggestionsCount(e){const t=this.getPreferences();t.schedulerSuggestionsCount=e;return this.savePreferences(t)}setDarkMode(e){const t=this.getPreferences();t.darkMode=e;return this.savePreferences(t)}};t.UserService=W;i([(0,L.computed)({keepAlive:true}),o("design:type",typeof(f=typeof b.IPromiseBasedObservable!=="undefined"&&b.IPromiseBasedObservable)==="function"?f:Object),o("design:paramtypes",[])],W.prototype,"projectUsers",null);i([L.computed,o("design:type",typeof(m=typeof ProjectUserList!=="undefined"&&ProjectUserList)==="function"?m:Object),o("design:paramtypes",[])],W.prototype,"projectUsersOrEmptyDefault",null);i([L.computed,o("design:type",typeof(g=typeof Record!=="undefined"&&Record)==="function"?g:Object),o("design:paramtypes",[])],W.prototype,"projectUsersMapOrEmptyDefault",null);i([L.computed,o("design:type",Object),o("design:paramtypes",[])],W.prototype,"isSuperAdmin",null);i([L.computed,o("design:type",Boolean),o("design:paramtypes",[])],W.prototype,"showWebMobileSelectionPage",null);i([L.computed,o("design:type",Boolean),o("design:paramtypes",[])],W.prototype,"needEmailConfirmation",null);i([L.computed,o("design:type",Boolean),o("design:paramtypes",[])],W.prototype,"hasBeenInvited",null);t.UserService=W=i([(0,_.injectable)(),(0,V.exposeGlobally)("userService"),o("design:paramtypes",[typeof(n=typeof A.AuthenticationService!=="undefined"&&A.AuthenticationService)==="function"?n:Object,typeof(r=typeof j.AnalyticsService!=="undefined"&&j.AnalyticsService)==="function"?r:Object,typeof(a=typeof w.AnalyticsSystemsService!=="undefined"&&w.AnalyticsSystemsService)==="function"?a:Object,typeof(c=typeof N.ProjectsService!=="undefined"&&N.ProjectsService)==="function"?c:Object,typeof(l=typeof F.CompaniesService!=="undefined"&&F.CompaniesService)==="function"?l:Object,typeof(u=typeof R.NotificationDisplayService!=="undefined"&&R.NotificationDisplayService)==="function"?u:Object,typeof(d=typeof U.ModalService!=="undefined"&&U.ModalService)==="function"?d:Object,typeof(p=typeof G.UrlStateService!=="undefined"&&G.UrlStateService)==="function"?p:Object,typeof(h=typeof P.FeatureFlagsService!=="undefined"&&P.FeatureFlagsService)==="function"?h:Object])],W)},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.sharedStepSingleton=void 0;const i=s(422);t.sharedStepSingleton=new i.SharedStepService},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(150),t);o(s(445),t);o(s(446),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.shimSafeQuerySelector=t.locatorBuilderUtils=void 0;const i=s(54);const o=s(5);const n=s(425);const{TESTIM_ID_FIELD_NAME:r,DYNAMIC_PARENT_FIELD_NAME:a,DYNAMIC_CHILD_FIELD_NAME:c,TESTIM_FRAME_ID:l,EMPTY_RESULT:u,CONTEXT_ATTR:d,CONTEXT_POINTER_ATTR:p,EMPTY_RESULT_ID:h,MAX_TEXT_CONTENT_LENGTH:f,MAX_INNER_TEXT_LENGTH:m,MINIMAL_SCORE_THRESHOLD:g,TESTIM_SHADOW_ROOT_ID:v}=o.locators;const S=["NthChildSelector","NthTagSelector","AndroidNthChildSelector","IosNthChildSelector"];class y{constructor(){this.TESTIM_ID_FIELD_NAME=r;this.DYNAMIC_PARENT_FIELD_NAME=a;this.DYNAMIC_CHILD_FIELD_NAME=c;this.TESTIM_FRAME_ID=l;this.EMPTY_RESULT=u;this.CONTEXT_ATTR=d;this.CONTEXT_POINTER_ATTR=p;this.EMPTY_RESULT_ID=h;this.MAX_TEXT_CONTENT_LENGTH=f;this.MAX_INNER_TEXT_LENGTH=m;this.MINIMAL_SCORE_THRESHOLD=g;this.TESTIM_SHADOW_ROOT_ID=v;this.getSelector=function e(t){return`[${r}='${t}']`};this.getCSSSelector=function e(t){if(!t){return""}const s=[];function i(e){if(typeof CSS!=="undefined"&&CSS&&typeof CSS.escape==="function"){return CSS.escape(e)}return e}let o;if((typeof window==="undefined"||window.location.protocol==="chrome-extension:")&&t.parentElement){o=t.parentElement.closest("[testim_shadow_root_id]")}let n=t;for(let e=n.parentNode;e&&o!==n;n=e,e=n.parentNode){if(!("tagName"in n)){break}const o=typeof n.tagName==="string"?n.tagName.toLowerCase():"*";const r=e.children||Array.prototype.filter.call(e.childNodes,(e=>e.nodeType===1));const a=Array.prototype.indexOf.call(r,n)+1;if(n===t){const e=n.id?`#${i(n.id)}`:"";const t=Array.prototype.map.call(n.classList||[],(e=>`.${i(e)}`)).join("");s.unshift(`${o}${t}${e}:nth-child(${a})`)}else{s.unshift(`${o}:nth-child(${a})`)}}return`${s.join(" > ")}`};this.getTestimInternalAttributes=function e(){return[r,a,l,d,p,c,v]};this.dynamicParentKeyValueMatchingAttributes=function e(){return["hidden","aria-hidden","aria-disabled","role","autocomplete","type"]};this.isTestimInternalAttribute=function e(t){return this.getTestimInternalAttributes().includes(t)};this.getTestimId=function e(t){if(this.isEmptyResult(t)){return h}if(!t||typeof t!=="object"||typeof t.getAttribute!=="function"){return h}return t.getAttribute(r)};this.calcTestimId=function e(t){if(!t||t===u){return h}if(!t||typeof t!=="object"||typeof t.getAttribute!=="function"){return h}return t.getAttribute(r)};this.isEmptyResultId=function e(t){return Number(t)===h};this.isEmptyResult=function e(t){return!t||t===u||typeof t!=="string"&&this.isEmptyResultId(t.testimId)};this.isNthSelectorResult=function e(t){return S.includes(t.selectorType)};this.isNthSelector=function e(t){return S.includes(t.type)};this.isNone=function e(t){return t===undefined||t===null};this.isEmptyTextSelector=function e(t){const s=()=>this.isInnerTextSelectorType(t.type);const i=()=>!t.directInnerText||t.directInnerText.toString().trim()==="";return s()&&i()};this.isTextContentSelectorType=function e(t){return t==="TextContentSelector"};this.isInnerTextSelectorType=function e(t){return["AndroidInnerTextSelector","IosInnerTextSelector","InnerTextSelector"].includes(t)};this.getInnerTextSelector=function e(t){return t.selectors.find((e=>this.isInnerTextSelectorType(e.type)))};this.isShadowRoot=function e(t){return t.constructor.name==="ShadowRoot"};this.getElementsPath=function e(t,s,i=this.isShadowRoot){let o=s;const n=[o];while(o!==t&&o.parentElement){o=o.parentElement;if(i(o)){o=o.host}n.unshift(o)}return n};this.isNetAppSvgTitleInTextIssue=function e(t){return t.tagName==="title"&&t.parentNode.tagName==="text"&&(typeof SVGElement!=="undefined"&&t instanceof SVGElement||t.ownerSVGElement!==undefined)};this.getDirectInnerText=function e(t){if(this.isNetAppSvgTitleInTextIssue(t)){return""}return Array.prototype.filter.call(t.childNodes||[],(e=>e.nodeName==="#text")).map((e=>e.nodeValue)).join(" ")};this.domElementToStr=function e(t){if(this.isEmptyResult(t)){return u}return i.injectorUtils.getElementTags(t,[r])};this.serializeLocators=function e(t){const s=t.getDocument().getElementLocators();const i=s.map((e=>{const t=e.serialize();t.selectors.forEach((e=>{e.parentsLocators=e.parentsLocators.map((e=>s.indexOf(e)))}));return t}));return{document:i,index:s.indexOf(t)}};this.shimSafeQuerySelector=n.shimSafeQuerySelector}}t.locatorBuilderUtils=new y;t.shimSafeQuerySelector=n.shimSafeQuerySelector},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.injectorUtils=void 0;const{guid:i}=s(303);const o={13:"",27:"Esc",9:"Tab",33:"Page Up",34:"Page Down",35:"End",36:"Home",45:"Ins",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};t.injectorUtils={TESTIM_VISIBILITY:"testim_visibility",toHashCode:e=>{const t=e.toString();let s=0;let i;let o;if(t.length===0){return s}for(i=0;i<t.length;i++){o=t.charCodeAt(i);s=(s<<5)-s+o;s&=s}return s},isContentEditable:e=>e.contentEditable==="true",getElementLabel:e=>{var t,s;const i=(s=(t=e.labels)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.innerText;return e.placeholder||i||e.getAttribute("name")||e.title||e.alt||e.innerText||""},isTextInputElement:e=>t.injectorUtils.isTextElement(e)&&!t.injectorUtils.isFileInput(e),isFileInput:e=>e.tagName==="INPUT"&&e.type==="file",isTextElement:e=>{const t=e.tagName;return t==="INPUT"||t==="TEXTAREA"},getElementTags:(e,s=[])=>{const i=e.cloneNode();const o=t.injectorUtils.getTagName(i);s.forEach((e=>i.removeAttribute(e)));if(i.innerHTML){return`${i.outerHTML.slice(0,i.outerHTML.lastIndexOf(i.innerHTML))}</${o}>`}return i.outerHTML},getElementTextContent:(e,s,i)=>{i||(i={});i.isSvgElement||(i.isSvgElement=n);const o=e=>{e.querySelectorAll("TITLE").forEach((e=>e.parentElement.removeChild(e)));return e};if(t.injectorUtils.isTextElement(e)){return e.value}if(i.isSvgElement(e)){let i=e;if(e.querySelectorAll("TITLE").length>0){i=o(e.cloneNode(true))}return t.injectorUtils.getFixedTextContent(i,s)}return t.injectorUtils.getFixedTextContent(e,s)},getFixedTextContent:(e,s)=>{if(s&&Array.prototype.some.call(e.children,(e=>e.hidden))){const s=e.cloneNode(true);const i=Array.prototype.filter.call(s.children,(e=>e.hidden));i.forEach((e=>{s.removeChild(e)}));return s.textContent?t.injectorUtils.replaceNewLines(s.textContent):""}return e.textContent?t.injectorUtils.replaceNewLines(e.textContent):""},replaceNewLines:e=>e.replace(/(\r\n|\n|\r)/gm,""),getEscapeCssChars:()=>/[\!\"\$\%\&\'\(\)\*\+\,\.\/\:\;\<\=\>\?\@\[\]\^\`\{\|\}\~\#]/g,escapeClass:e=>typeof e==="string"?e.replace(t.injectorUtils.getEscapeCssChars(),"\\$&"):e,escapeID:e=>typeof e==="string"?e.replace(t.injectorUtils.getEscapeCssChars(),"\\\\$&"):e,get escapeIDV2(){return t.injectorUtils.escapeClass},guid:i,getSpecialKeyFromKeyCode:e=>o[e],binarySearch:(e,t)=>{let s=0;let i=t.length;while(s<i){const o=Math.floor((s+i)/2);if(e(t[o])){i=o}else{s=o+1}}return i===t.length?null:i},isRegExp:e=>{if(typeof e==="number"){return false}if(typeof e==="string"){return/^\/[^/]+\/[gimuy]*$/.test(e)||e.startsWith("/")&&e.endsWith("/")}if(e instanceof RegExp){return true}return false},getRegExp:e=>{if(!t.injectorUtils.isRegExp(e)){return undefined}const s=e.match(/[gimuy]*$/)[0];const i=e.match(/^\/([^/]*)\/[gimuy]*$/)[1];return new RegExp(i,s)},clearWhiteSpaces:e=>e.replace(/\s+/g," ").trim(),compareTexts:(e,s)=>{if(typeof e!=="string"||typeof s!=="string"){return false}return t.injectorUtils.clearWhiteSpaces(e)===t.injectorUtils.clearWhiteSpaces(s)},isNode:()=>typeof e!=="undefined"&&{}.toString.call(e)==="[object global]",calcTestimAttributes:e=>{const t=o("iframe");const s=o("frame");const i=t.concat(s);i.forEach((e=>{const t=window.getComputedStyle(e);const s=e.getBoundingClientRect();if(t.opacity==="0"||t.visibility==="hidden"||s.width===0||s.height===0||n(r(document,e))){e.setAttribute("testim_visibility","not-shown")}else{e.setAttribute("testim_visibility","shown")}}));function o(t){return Array.apply(null,e.querySelectorAll(document,t))}function n(e){return e.some((e=>window.getComputedStyle(e).display==="none"))}function r(e,t){const s=[];while(t&&t!==e.documentElement){s.push(t);t=t.parentElement}return s}},getTagName:(e,t)=>{if(!(e===null||e===void 0?void 0:e.tagName)){return""}if(typeof e.tagName==="string"){return t?e.tagName:e.tagName.toLowerCase()}if(typeof e.nodeName==="string"){return t?e.nodeName:e.nodeName.toLowerCase()}const s=e.ownerDocument.defaultView;if(s){try{const i=Object.getOwnPropertyDescriptor(s.Element.prototype,"tagName");const o=i.get.call(e);if(o){return t?o:o.toLowerCase()}}catch(e){return""}}return""},dragEventTypes:["drag","dragstart","drop","dragenter","dragend"],isNativeFunction:e=>{if(!(e===null||e===void 0?void 0:e.toString)){return false}return e.toString().includes("[native code]")}};function n(e){if(typeof SVGElement!=="undefined"){return e instanceof SVGElement}return e.ownerSVGElement!==undefined}}).call(this,s(36))},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.PremiumFeaturesService=t.DEFAULT_RESULT_RETENTION=void 0;const l=s(98);const u=s(9);const d=s(22);const p=s(39);const h=s(5);const f=s(192);const m=s(14);const g=s(2);const v=s(531);t.DEFAULT_RESULT_RETENTION=30;const S=12;let y=class e{constructor(e,t,s){this.companiesService=e;this.featureFlagsService=t;this.testimServices=s;this._billingStartDates={};this.getCompanyProjects=async()=>await this.companiesService.getCompanyProjects(this.companiesService.companyId)}get premiumFeatures(){return this.companiesService.activePlan.premiumFeatures||{}}get maxRemoteRuns(){const e=this.premiumFeatures;return e.maxMonthlyExecutions||1}get maxRemoteMobileRuns(){const e=this.premiumFeatures;return e.maxMonthlyMobileExecutions||1}get maxUsersAllowed(){var e;return(e=this.premiumFeatures.maxUser)!==null&&e!==void 0?e:1}async getCurrentUserCount(){const e=this.companiesService.companyId;if(!e||e===h.commonConstants.defaults.FAKE_CODE_COMPANY_ID){return 1}return this.testimServices.company.getUsersCount(this.companiesService.companyId)}getCurrentTestCount(){return this.testimServices.company.getTestsCount(this.companiesService.companyId)}getCurrentTestCountByType(e){return this.testimServices.company.getTestsCountByType(this.companiesService.companyId,e)}canUseApplitools(){return Boolean(this.premiumFeatures.applitools)}canUseSSO(){return Boolean(this.premiumFeatures.singleSignIn)}canUseCliAction(){return Boolean(this.premiumFeatures.cliAction)}canUseFileDownload(){return Boolean(this.premiumFeatures.fileDownload)}canUseBranches(){return Boolean(this.premiumFeatures.branches)}canUseEmailValidation(){return Boolean(this.premiumFeatures.emailValidation)}get canUseTunnel(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.tunnel)}return true}canUseTurboMode(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.runInTurboMode)}return Boolean(this.premiumFeatures.runInTurboMode===undefined?true:this.premiumFeatures.runInTurboMode)}canUseAccessibilitySteps(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.accessabilityStep)}return!this.companiesService.isInFreePlan()&&this.premiumFeatures.accessabilityStep===undefined?true:this.premiumFeatures.accessabilityStep}canUseAutoCompleteSuggestions(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.autoCompleteSuggestions)}return Boolean(!this.companiesService.isInFreePlan()&&this.premiumFeatures.autoCompleteSuggestions===undefined?true:this.premiumFeatures.autoCompleteSuggestions)}canUsePullRequests(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.pullRequests)}return Boolean(!this.companiesService.isInFreePlan()&&this.premiumFeatures.pullRequests===undefined?true:this.premiumFeatures.pullRequests)}canUseReadOnlyBranch(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.readOnlyBranch)}return Boolean(!this.companiesService.isInFreePlan()&&this.premiumFeatures.readOnlyBranch===undefined?true:this.premiumFeatures.readOnlyBranch)}canUseDedupAndGroupingSuggestions(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.dedupAndGroupingSuggest)}return Boolean(!this.companiesService.isInFreePlan()&&this.premiumFeatures.dedupAndGroupingSuggest===undefined?true:this.premiumFeatures.dedupAndGroupingSuggest)}canExportAsCsv(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.exportAsCsv)}return Boolean(!this.companiesService.isInFreePlan()&&this.premiumFeatures.exportAsCsv===undefined?true:this.premiumFeatures.exportAsCsv)}canUseAuditLog(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.activityAuditLogs)}return!this.companiesService.isInFreePlan()&&this.premiumFeatures.activityAuditLogs===undefined?true:this.premiumFeatures.activityAuditLogs}canUseRemoteBranches(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.remoteBranches)}return Boolean(this.premiumFeatures.remoteBranches===undefined?true:this.premiumFeatures.remoteBranches)}canUseTestimApi(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.publicApiAccess)}return this.companiesService.isPayingPlan()}get canUseIntegrations(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.integrations)}return true}get canUseTestOwner(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.testOwner)}return this.companiesService.isPayingPlan()}get canUseHiddenParameters(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.hideSecretVariables)}return true}get canUseManagerialReports(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.managerialReports)}return true}get canUseMockNetworkResponses(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.mockNetworkResponses)}return true}get canUseApiSteps(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.apiStep)}return!this.companiesService.isInFreePlan()}get canUseNetworkValidationStep(){if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.networkValidationStep)}return true}get canUseContextualHelpAssistant(){const e=this.companiesService.isTtaForSalesforceApp;const t=this.companiesService.companyPlanType==="pro";return!e&&t}getMaxPermanentEmail(){const e=this.premiumFeatures.maxPermanentEmail;return e!==undefined?e:4}get isTtaSfdcEnabled(){var e,t;if(this.companiesService.doesFollowL2c){return Boolean(this.premiumFeatures.ttaForSalesforce)}const s=this.featureFlagsService.targetingObservable;return this.featureFlagsService.flags.salesforceSfdc.isEnabled()&&Boolean((t=(e=this.companiesService.currentCompany.plan)===null||e===void 0?void 0:e.premiumFeatures)===null||t===void 0?void 0:t.ttaForSalesforce)}async getBillingStartDate(){const e=this.companiesService.companyId;if(this._billingStartDates[e]){return this._billingStartDates[e]}const t=await this.testimServices.plan.getBillingStartDate(this.companiesService.companyId);this._billingStartDates[e]=Number(t);return Number(t)}async getRunsCount(){const e=await this.getBillingStartDate();return this.testimServices.execution.count(this.companiesService.companyId,e)}async getRunsCountByType(e){const t=await this.getBillingStartDate();return await this.testimServices.execution.countByType(this.companiesService.companyId,t,e)}async getBillingIntervals(){const e=await this.getBillingStartDate();const t=l(e).utc().startOf("day");const s=t.clone().add(1,"month").endOf("day");const i=[t.valueOf(),s.valueOf()];for(let e=1;e<S;e++){const s=t.clone().subtract(e,"month");i.unshift(s.valueOf())}return i}async getYearlyReport(e,t){const s=await this.getBillingIntervals();const i=[];s.forEach(((o,n)=>{if(n<S){i.push(e(this.companiesService.companyId,s[n],s[n+1],t))}}));return Promise.all(i)}async getYearlyRunsCountByProjectType(e){return await this.getYearlyReport(this.testimServices.execution.countByDatesByProjectType,e)}async getYearlyRunsCountByProject(){return this.getYearlyReport(this.testimServices.execution.countByDatesByProject)}async getYearlyRunsCount(){return this.getYearlyReport(this.testimServices.execution.countByDates)}async isUserCountExceedingQuota(){const e=await this.getCurrentUserCount();return e>this.maxUsersAllowed}getPremiumStepTypes(){return{all:v.PREMIUM_STEP_TYPES,applitools:v.APPLITOOLS_STEP_TYPES,configurable:v.CONFIGURABLE_PREMIUM_STEP_TYPES,nonConfigurable:v.NON_CONFIGURABLE_PREMIUM_STEP_TYPES}}};t.PremiumFeaturesService=y;i([g.computed,o("design:type",typeof(c=typeof f.PremiumFeatures!=="undefined"&&f.PremiumFeatures)==="function"?c:Object),o("design:paramtypes",[])],y.prototype,"premiumFeatures",null);i([g.computed,o("design:type",Boolean),o("design:paramtypes",[])],y.prototype,"canUseTunnel",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseIntegrations",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseTestOwner",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseHiddenParameters",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseManagerialReports",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseMockNetworkResponses",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseApiSteps",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseNetworkValidationStep",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"canUseContextualHelpAssistant",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"isTtaSfdcEnabled",null);t.PremiumFeaturesService=y=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof p.CompaniesService!=="undefined"&&p.CompaniesService)==="function"?n:Object,typeof(r=typeof m.FeatureFlagsService!=="undefined"&&m.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof d.TestimServicesApi!=="undefined"&&d.TestimServicesApi)==="function"?a:Object])],y)},function(e,t,s){"use strict";s.r(t);t["default"]={sharedResourceWarningBanner:"styles_sharedResourceWarningBanner_1srca_RDb25maWct",modal:"styles_modal_2-rha_RDb25maWct",back:"styles_back_2BHTE_RDb25maWct",modalBody:"styles_modalBody_2uu14_RDb25maWct",advanced:"styles_advanced_3s2Lz_RDb25maWct",sharedResourceWarningBannerAdvancedView:"styles_sharedResourceWarningBannerAdvancedView_3DH-m_RDb25maWct",errorSubheader:"styles_errorSubheader_2JMAM_RDb25maWct",mobileModal:"styles_mobileModal_37VXc_RDb25maWct",loader:"styles_loader_3sapC_RDb25maWct",loaderWrapper:"styles_loaderWrapper_1z-j4_RDb25maWct",textComment:"styles_textComment_n8XrM_RDb25maWct",dropDownItem:"styles_dropDownItem_18qmt_RDb25maWct",icon:"styles_icon_Hawk8_RDb25maWct",resolution:"styles_resolution_1nZdR_RDb25maWct",separator:"styles_separator_3HgPH_RDb25maWct",subHeader:"styles_subHeader_3fw80_RDb25maWct",collapsibleSection:"styles_collapsibleSection_37WGn_RDb25maWct",isOpen:"styles_isOpen_3YPSp_RDb25maWct",sectionHeader:"styles_sectionHeader_3waO7_RDb25maWct",sectionContent:"styles_sectionContent_2T8Xl_RDb25maWct",reduceMargin:"styles_reduceMargin_1uiMP_RDb25maWct",environmentRow:"styles_environmentRow_2gp4M_RDb25maWct",spacer:"styles_spacer_1Th2a_RDb25maWct",form:"styles_form_3EbL6_RDb25maWct",formLabel:"styles_formLabel_2J2TK_RDb25maWct",enlargedCheckbox:"styles_enlargedCheckbox_11PfW_RDb25maWct",nativeEventsSection:"styles_nativeEventsSection_10P36_RDb25maWct",reduceMarginBottom:"styles_reduceMarginBottom_35WH__RDb25maWct",fullLabel:"styles_fullLabel_1pF73_RDb25maWct",radioLabel:"styles_radioLabel_3sNEv_RDb25maWct",warning:"styles_warning_1xJvj_RDb25maWct",propertyPanel:"styles_propertyPanel_2Zqc8_RDb25maWct",resolutionInput:"styles_resolutionInput_2Qd2B_RDb25maWct",resolutionX:"styles_resolutionX_2qpQ9_RDb25maWct",dropdownContainer:"styles_dropdownContainer_1ZMzk_RDb25maWct",applitoolsSectionInput:"styles_applitoolsSectionInput_u2Z1P_RDb25maWct"}},,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.stepBuilder=void 0;const i=s(6);const o=s(8);const n=s(183);const r=s(421);const a=o.utils.guid;function c(e,t){const s=(0,r.getStepClass)(t);if(!s){throw new Error(`Could not find a class for type '${t}'`)}return new s(e,t)}class l{migrateEvaluateText(e){if(e.type==="evaluate-text"){e.type="evaluate-expression";e.subType=n.expressionSubType.EXPRESSION}return e}migrateEvaluateExpressionOfText(e){if(e.type==="evaluate-expression"&&e.subType===n.expressionSubType.TEXT){e.subType=n.expressionSubType.EXPRESSION;e.expression=o.utils.escapeText(e.expression)}return e}migrateElementValidationForceVisibility(e){const t=["element-validation","wait-for-element-validation"];if(t.includes(e.type)&&e.element&&typeof e.element.forceVisibility!=="boolean"){e.element.forceVisibility=true}return e}migrateScriptElementParameterForceVisibility(e){(e.parameterValues||[]).forEach((t=>{if(e.subType!=="elementText"&&t.type==="locate"){t.forceVisibility=false}}));return e}migrateElementTextWithTextAndNoExpression(e){if(e.type==="text"&&e.text&&!e.expression){delete e.text}return e}migrateNavigationStep(e){if(e.type==="navigation"&&e.url&&!e.expression){e.expression=o.utils.escapeText(e.url);delete e.url}return e}migratePixelValidationStep(e,t){var s;if(!o.utils.isUiVerificationStep(e.type)){return e}const{applitoolsData:i}=e;const n=(i===null||i===void 0?void 0:i.matchLevel)&&i.overrideTestApplitoolsSettings===undefined&&parseFloat(i._version||i.version)<2;if(n){i.overrideTestApplitoolsSettings=true}if(t===null||t===void 0?void 0:t.newApplitoolsTestId){const t={id:o.utils.guid(),count:0};e.applitoolsTestId=t;(s=e).applitoolsData||(s.applitoolsData={});e.applitoolsData.testId=t}return e}softStepDataMigration(e,t){const s=[this.migrateEvaluateText,this.migrateElementValidationForceVisibility,this.migrateEvaluateExpressionOfText,this.migrateElementTextWithTextAndNoExpression,this.migrateNavigationStep,this.migrateScriptElementParameterForceVisibility,this.migratePixelValidationStep];return s.reduce(((e,s)=>s(e,t)),e)}buildStepFromData(e,t={}){var s;const o=e.type;if(!o){return null}e=this.softStepDataMigration(e,t);const n=t.id||!t.newId&&e.id||a();const r=c(n,o);const l=Object.assign({},t,{dirty:false});e.location||(e.location=t.location||"");e.condition=e.condition?this.buildStepFromData(e.condition,l):undefined;e.whileLoop=e.whileLoop?this.buildStepFromData(e.whileLoop,l):undefined;r.update(e);if(t.dirty===false){r.resetDirty()}if(r.isGroupStep){const o=((s=e.steps)===null||s===void 0?void 0:s.filter(i.isObject))||[];o.forEach((e=>{const s=i.cloneDeep(t);const o=this.buildStepFromData(e,s);r.addStep(o)}))}return r}}t.stepBuilder=new l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.container=void 0;s(113);const i=s(9);const o=s(14);t.container=new i.Container({autoBindInjectable:true,defaultScope:"Singleton"});t.container.bind(o.FeatureFlagsService).toConstantValue(o.default)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.hostServiceFactory=t.HostService=void 0;const l=s(9);const u=s(5);const d=s(15);const p=s(26);const h=s(117);const f=s(163);const m=s(20);const g=s(88);const v=s(2);let S=class e{constructor(e,t){var s,i,o;const{PROJECT_SELECTED:n,PROJECT_CHANGED:r}=u.commonConstants.scenario;e.on([n,r],(()=>this.onProjectChange()));const a=(0,m.isPlaygroundModeState)(t);if(((s=t.params)===null||s===void 0?void 0:s.attachTabId)||a){this.switchToHost(f.EditorHostService)}if(typeof window!=="undefined"&&(((i=window===null||window===void 0?void 0:window.location)===null||i===void 0?void 0:i.origin)===`chrome-extension://${u.commonConstants.TESTIM_EXTENSION_ID}`||((o=window===null||window===void 0?void 0:window.location)===null||o===void 0?void 0:o.search.includes("fabOrigin")))){this.switchToHost(h.BaseHostService)}}onProjectChange(){this.switchToHost(f.EditorHostService)}destroyActiveHost(){if(this.activeHost){this.activeHost.destroy()}}switchToHost(e){if(this.activeHost instanceof e){return}this.destroyActiveHost();this.activeHost=g.UIContainer.get(e)}};t.HostService=S;i([v.observable.ref,o("design:type",Object)],S.prototype,"activeHost",void 0);t.HostService=S=i([(0,l.injectable)(),o("design:paramtypes",[typeof(n=typeof d.ProjectsService!=="undefined"&&d.ProjectsService)==="function"?n:Object,typeof(r=typeof p.UrlStateService!=="undefined"&&p.UrlStateService)==="function"?r:Object])],S);const y=e=>{const t=e.container.get(S);const s={activeHost:new Proxy({},{get(e,s){return t.activeHost[s]},set(e,s,i){return Reflect.set(t.activeHost,s,i)}})};return(e={})=>e.useProxy?s:t};t.hostServiceFactory=y},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.NotificationDisplayService=t.NotificationDisplayName=void 0;const o=s(33);const n=s(5);const r=s(9);var a;(function(e){e["MAIN_DISPLAY"]="display:main";e["WAIT_DISPLAY"]="display:wait";e["CLOSE_NOTIFICATION"]="notification:close";e["EDITOR_NOTIFICATION"]="editor:notification"})(a||(t.NotificationDisplayName=a={}));let c=class e extends o.EventEmitter{get EDITOR_NOTIFICATION(){return a.EDITOR_NOTIFICATION}get MAIN_DISPLAY(){return a.MAIN_DISPLAY}get WAIT_DISPLAY(){return a.WAIT_DISPLAY}get CLOSE_NOTIFICATION(){return a.CLOSE_NOTIFICATION}sendNotification(e,t,s,i=a.MAIN_DISPLAY){if(e instanceof Error){e=e.message}if(e===n.commonConstants.error.NO_APP_TO_CHOOSE_AN_ELEMENT_FROM){i=a.EDITOR_NOTIFICATION}this.trigger(i,e,t);this._onCancel=s}closeNotification(){if(this._onCancel){this._onCancel()}}removeNotifications(e){this._onCancel=undefined;this.trigger(this.CLOSE_NOTIFICATION,e)}};t.NotificationDisplayService=c;t.NotificationDisplayService=c=i([(0,r.injectable)()],c)},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.RelativeSelector=void 0;const i=s(54);const o=s(53);const n=s(7);const r=s(242);const a=s(243);const c=s(2);const l=n.Logger.getLogger("relative-selector");class u{constructor(e,t={}){e=e||{};this.metaData=t;this.type=this.getType();this.isUsed=e.isUsed!==false;this.dom=e.dom||(typeof document==="undefined"?null:document);this.selfScore=Object.hasOwn(e,"selfScore")?Number(e.selfScore):null;this.parentsLocators=Object.hasOwn(e,"parentsLocators")?e.parentsLocators:[];this.correctStreak=Object.hasOwn(e,"correctStreak")?parseInt(e.correctStreak,10):0;this.wrongStreak=Object.hasOwn(e,"wrongStreak")?parseInt(e.wrongStreak,10):0;this.chosenParent=Object.hasOwn(e,"chosenParent")?e.chosenParent:null;this.foundElements=Object.hasOwn(e,"foundElements")?e.foundElements:null;this.isAutomap=Object.hasOwn(e,"isAutomap")?e.isAutomap:false;this.setSelfScore(e.selfScore||this.computeInitialScore(e))}_isValueEdited(e){if(!e){return false}return!(e.startsWith("'")&&e.endsWith("'"))&&!(e.startsWith('"')&&e.endsWith('"'))}isEdited(){return false}getType(){throw new Error("getType() not implemented")}computeInitialScore(e){return 0}getMatcherDescriptor(){return{}}updateMappedProperty(e,t){}evaluateComputedProperties(e){}decreaseSelectorScore(e,t){const s=this.getSelfScore();const i=Math.max((1-t*e)*s,0);this.setSelfScore(i)}increaseSelectorScore(e,t){const s=this.getSelfScore();const i=Math.min((1+t*e)*s,1);this.setSelfScore(i)}mergeSelector(e,t,s,...i){const o=this.equals(e);if(o){this.wrongStreak=0;this.correctStreak=e.correctStreak+1;this.increaseSelectorScore(this.correctStreak,t)}else{this.correctStreak=0;this.wrongStreak=e.wrongStreak+1;this.decreaseSelectorScore(this.wrongStreak,s)}this.isUsed&&(this.isUsed=e.isUsed);this.isAutomap&&(this.isAutomap=e.isAutomap)}setSelfScore(e){const t=Number(e).toFixed(2);this.selfScore=Number(t)}getSelfScore(){throw new Error("getSelfScore() not implemented")}getDisplayName(){throw new Error("getDisplayName() not implemented")}getDisplayValue(){throw new Error("getDisplayValue() not implemented")}isEditable(){return false}getEditablePropertiesObject(){return{}}isSelectorValid(e){return false}isMatchable(){return this.isUsed}_matches(e){return true}matches(e){return this.type===e.type&&this._matches(e)}_equals(e){return true}equals(e){return this.matches(e)&&this._equals(e)}findElements(e){throw new Error("findElements() not implemented")}_updateQueryResultObject(e,t,s,i){const n=o.locatorBuilderUtils.calcTestimId(e);const a=i[n];const c=a?a.parentScore:-1;if(!a||a.score<t){i[n]=new r.QueryResult({testimElementDomId:n,element:e,score:t,parentScore:Math.max(c,s.score),parentIndex:s.locateResult.locatorIndex,relativeParent:s.locateResult.element,relativeParentTestimDomId:s.id})}return i}_locateAllParents(){const e=[];for(const t of this.parentsLocators){const s=t.locate();t.forceCalcScore();const i=o.locatorBuilderUtils.calcTestimId(s.element);if(!o.locatorBuilderUtils.isEmptyResultId(i)){e.push({id:i,locateResult:s,score:t.score,locator:t})}}return e}_locateAndGetQueryResults(e,t){const s=e.reduce(((e,s,i)=>{let o;try{o=this.findElements(s.locator)}catch(e){o=[];if(e.message.includes("unknown pseudo-class selector")||e.message.includes("is not a valid selector")){l.warn(`Exception in ${this.type}.findElements (parentIndex: ${i})`,{errorMessage:e.message})}else{l.error(`Exception in ${this.type}.findElements (parentIndex: ${i})`,{error:e})}}const n=t*Number(s.score)/o.length;return o.reduce(((e,t)=>this._updateQueryResultObject(t,n,s,e)),e)}),{});return Object.keys(s).map((e=>s[e]))}buildQueryResults(e,t,s,i){if(s.length===0){const e={testimElementDomId:o.locatorBuilderUtils.EMPTY_RESULT_ID,element:o.locatorBuilderUtils.EMPTY_RESULT,parentScore:this.getMaxParentScore(),score:t*this.getMaxParentScore()};s.push(new r.QueryResult(e))}const n=this._enrichResultSelectorResultData(s);const c={queryResults:s,displayName:this.getDisplayName(),displayValue:this.getDisplayValue(),foundElements:s.map((e=>({id:e.testimElementDomId,score:e.score}))),foundParentsIds:e.map((e=>e.id)),selectorType:this.type,time:i,selector:this};const l=Object.assign(c,n);const u=new a.SelectorResult(l);this.resultCache=u;return u}_enrichResultSelectorResultData(e){return{}}locate(){if(this.resultCache){return this.resultCache}const e=this.getSelfScore();const t=this._locateAllParents();const s=Date.now();const i=this._locateAndGetQueryResults(t,e);return this.buildQueryResults(t,e,i,Date.now()-s)}getMaxParentScore(){if(this.parentsLocators.length===0){return 1}return Math.max(...this.parentsLocators.map((e=>e.getScore())))}getScore(){if(!o.locatorBuilderUtils.isNone(this.score)){return this.score}const e=this.getSelfScore();const t=this.getMaxParentScore();const s=e*t;this.score=this.getFinalScore(s);return s}isUnique(){return this.parentsLocators.length>0}getUniqueParentIndex(e,t){return i.injectorUtils.binarySearch((t=>this.isUniqueOnRecord(e,t)),t)}isUniqueOnRecord(e,t){try{const s=this.findElements(t);return s.length===1&&s[0]===e}catch(e){return false}}update(e,t){if(this.isUniqueOnRecord(e,t[0])){this.parentsLocators=t.slice(0)}else{const s=this.getUniqueParentIndex(e,t);this.parentsLocators=typeof s==="number"?t.slice(s):[]}return this}getFinalScore(e){e=Math.min(e,1);return e.toFixed(2)}serialize(){return{parentsLocators:this.parentsLocators,isUsed:this.isUsed,correctStreak:this.correctStreak,wrongStreak:this.wrongStreak,selfScore:this.selfScore,isAutomap:this.isAutomap,type:this.getType()}}}t.RelativeSelector=u;if(e.env.isClickimEditor){(0,c.decorate)(u,{isUsed:c.observable.ref,foundElements:c.observable.ref,isAutomap:c.observable.ref,isDisabled:c.observable.ref})}}).call(this,s(35))},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.emailInbox=t.emailService=t.auditLog=t.autoGrouping=t.mobileApp=t.deviceManagement=t.mobileApps=t.brokenTests=t.testRuns=t.execution=t.executions=t.configs=t.schedulers=t.plan=t.plans=t.labels=t.suite=t.suiteList=t.testAdvancedLogsViewer=t.testNetworkLogsViewer=t.stepScreenshotsViewer=t.stepViewer=t.testOnSpecificRevision=t.testResultWithStepPath=t.testWithStepPath=t.testResult=t.testData=t.sharedStepUsageList=t.sharedStepsFolder=t.sharedStepList=t.testsFolder=t.testList=t.projectInsights=t.test=t.pullRequestComments=t.pullRequest=t.pullRequests=t.projectSettings=t.automateBase=t.projectGeneralReports=t.companyReports=t.companySSO=t.companyTeam=t.companyProjects=t.companyPlans=t.companyGrids=t.companyBase=t.projectBranchBase=t.projectBase=t.signin=void 0;t.admin=t.projectTeam=t.stepFromSharedStepPath=void 0;const i=s(6);const o=s(5);const n=e=>`/signin${e?`?returnUrl=${encodeURIComponent(e)}`:""}`;t.signin=n;const r=e=>{e=i.pickBy(e,(e=>e!==undefined&&e!==null&&e!==""));if(i.isEmpty(e)){return""}return`?${new URLSearchParams(e).toString()}`.replace(/\+/g,"%20")};const a=({embedMode:e,exportPlaywright:t,exportPuppeteer:s,exportSelenium:i,exportStyle:o}={})=>({embedMode:e,exportPlaywright:t,exportPuppeteer:s,exportSelenium:i,exportStyle:o});const c=({hook:e,hookedStepId:t}={})=>({hook:e,hookedStepId:t});const l=e=>`#/project/${e}`;t.projectBase=l;const u=(e,s=o.MASTER_BRANCH)=>`${(0,t.projectBase)(e)}/branch/${encodeURIComponent(s)}`;t.projectBranchBase=u;const d=e=>`#/company/${e}`;t.companyBase=d;const p=e=>`${(0,t.companyBase)(e)}/grids`;t.companyGrids=p;const h=e=>`${(0,t.companyBase)(e)}/plans`;t.companyPlans=h;const f=e=>`${(0,t.companyBase)(e)}/projects`;t.companyProjects=f;const m=e=>`${(0,t.companyBase)(e)}/team`;t.companyTeam=m;const g=e=>`${(0,t.companyBase)(e)}/sso`;t.companySSO=g;const v=e=>`${(0,t.companyBase)(e)}/reports${r({period:"Last 7 Days"})}`;t.companyReports=v;const S=(e,s)=>`${(0,t.projectBranchBase)(e,s)}/runs/reports/general${r({period:"Last 7 Days"})}`;t.projectGeneralReports=S;const y=(e,s)=>`${(0,t.projectBranchBase)(e,s)}/automate`;t.automateBase=y;const b=(e,s,i)=>`${(0,t.projectBase)(e)}/settings${s?"/":""}${s}${r({tab:i})}`;t.projectSettings=b;const _=(e,s,i)=>`${(0,t.automateBase)(e,s)}/pullrequests/${r(i)}`;t.pullRequests=_;const T=(e,s,i)=>`${(0,t.automateBase)(e,s)}/pullrequests/view/${i}`;t.pullRequest=T;const E=(e,s,i)=>`${(0,t.pullRequest)(e,s,i)}/comments`;t.pullRequestComments=E;const I=(e,s,i,o,n,c)=>`${(0,t.projectBranchBase)(e,s)}/test/${i}${r({"selected-steps":o,"parent-folder-id":n,...a(c)})}`;t.test=I;const C=(e,s,i="dashboard")=>`${(0,t.projectBranchBase)(e,s)}/insights${i?"/":""}${i}`;t.projectInsights=C;const D=(e,s,i={})=>`${(0,t.automateBase)(e,s)}/tests${r(i)}`;t.testList=D;const O=(e,s,i)=>`${(0,t.testList)(e,s)}/${i}`;t.testsFolder=O;const A=(e,s)=>`${(0,t.automateBase)(e,s)}/sharedSteps`;t.sharedStepList=A;const j=(e,s,i)=>`${(0,t.sharedStepList)(e,s)}/${i}`;t.sharedStepsFolder=j;const w=(e,s,i)=>`${(0,t.testList)(e,s)}/${r({sharedStep:i})}`;t.sharedStepUsageList=w;const R=(e,s,i,o,n)=>`${(0,t.test)(e,s,i)}/data${r({"parent-folder-id":n,"result-id":o})}`;t.testData=R;const P=(e,s,i,o,n,c)=>`${(0,t.test)(e,s,i)}${r({"parent-folder-id":c,"result-id":o,...a(n)})}`;t.testResult=P;const x=(e,s,i,o,n)=>`${(0,t.test)(e,s,i)}/step/${o}${r({path:n})}`;t.testWithStepPath=x;const M=(e,s,i,o,n,l,u,d,p,h)=>`${(0,t.test)(e,s,i)}/step/${o}${r({"result-id":l,"iteration-id":u,"shared-step-instance":d,path:n,...a(p),...c(p),"selected-steps":h})}`;t.testResultWithStepPath=M;const N=(e,s,i,o,n)=>`${(0,t.test)(e,s,i)}${r({"result-id":"","iteration-id":"","revision-id":o,"shared-step-instance":"",path:"",sharedStepRevisionId:n})}`;t.testOnSpecificRevision=N;const F=(e,s,i,o,n,l,u,d,p,h)=>`${(0,t.test)(e,s,i)}/step/${o}/viewer/${h}${r({"result-id":l,"iteration-id":u,"shared-step-instance":d,path:n,...a(p),...c(p)})}`;t.stepViewer=F;const L=(e,s,i,o,n,r,a,c,l)=>(0,t.stepViewer)(e,s,i,o,n,r,a,c,l,"screenshots");t.stepScreenshotsViewer=L;const k=(e,s,i,o,n,c)=>`${(0,t.test)(e,s,i)}/har-viewer${r({tabOrder:n,"result-id":o,...a(c)})}`;t.testNetworkLogsViewer=k;const B=(e,s,i,o,n,c)=>`${(0,t.test)(s,i,o)}/${e}${r({"result-id":n,...a(c)})}`;t.testAdvancedLogsViewer=B;const U=(e,s)=>`${(0,t.automateBase)(e,s)}/suites`;t.suiteList=U;const G=(e,s,i)=>`${(0,t.automateBase)(e,s)}/suites/${i}`;t.suite=G;const V=(e,s)=>`${(0,t.automateBase)(e,s)}/labels`;t.labels=V;const H=(e,s,i)=>`${(0,t.automateBase)(e,s)}/plans${i?"/":""}${r({search:i})}`;t.plans=H;const $=(e,s,i)=>`${(0,t.automateBase)(e,s)}/plans/${i}`;t.plan=$;const W=(e,s,i)=>`${(0,t.projectBranchBase)(e,s)}/runs/schedulers${r({search:i})}`;t.schedulers=W;const J=(e,s)=>`${(0,t.projectBranchBase)(e,s)}/runs/configs`;t.configs=J;const Y=(e,s,i)=>`${(0,t.projectBranchBase)(e,s)}/runs${i?"/suites":""}${r(i)}`;t.executions=Y;const z=(e,s,i,o)=>`${(0,t.projectBranchBase)(e,s)}/runs/suites/${i}${r(o)}`;t.execution=z;const q=(e,s,i,o)=>`${(0,t.projectBranchBase)(e,s)}/runs/tests${r({testId:i,...o})}`;t.testRuns=q;const X=(e,s,i)=>`${(0,t.projectBranchBase)(e,s)}/runs/broken-tests${r({period:i})}`;t.brokenTests=X;const Z=e=>`${(0,t.projectBase)(e)}/mobile-apps`;t.mobileApps=Z;const Q=(e,s="")=>`${(0,t.projectBase)(e)}/device-management${s&&`/${s}`}`;t.deviceManagement=Q;const K=(e,s)=>`${(0,t.projectBase)(e)}/mobile-app/${s}`;t.mobileApp=K;const ee=e=>`${(0,t.projectBase)(e)}/autogroup`;t.autoGrouping=ee;const te=(e,s={})=>`${(0,t.companyBase)(e)}/audit-log${r(s)}`;t.auditLog=te;const se=e=>`${(0,t.projectBase)(e)}/settings/email`;t.emailService=se;const ie=(e,s,i)=>`${(0,t.projectBranchBase)(e,s)}/email-inbox?email=${i}`;t.emailInbox=ie;const oe=({projectId:e,branch:s,testId:i,sharedStepId:o})=>{const n=new URLSearchParams({sharedStepId:o,"selected-steps":o});return`${(0,t.projectBranchBase)(e,s)}/test/${i}?${n.toString()}`};t.stepFromSharedStepPath=oe;const ne=e=>`${(0,t.projectBase)(e)}/users`;t.projectTeam=ne;const re=(e,s="")=>`${(0,t.projectBase)(e)}/admin${s?"/":""}${s}`;t.admin=re},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(224),t)},,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.BugimDataStore=void 0;const o=s(9);const n=window.localStorage;let r=class e{constructor(){this.listeners=new Map;this.values=new Map}callSubscribers(e){var t;(t=this.listeners.get(e))===null||t===void 0?void 0:t.forEach((t=>t(this.get(e))))}setPersistent(e,t){n.setItem(e,JSON.stringify(t));this.callSubscribers(e)}getPersistent(e){var t;let s={};try{s=JSON.parse((t=n.getItem(e))!==null&&t!==void 0?t:"")}catch(e){return{}}return s}set(e,t){this.values.set(e,t);this.callSubscribers(e)}get(e){return this.values.get(e)}remove(e){this.values.delete(e);n.removeItem(e)}subscribe(e,t){if(!this.listeners.has(e)){this.listeners.set(e,[])}const s=this.listeners.get(e);s.push(t);this.listeners.set(e,s)}unsubscribe(e,t){if(!this.listeners.has(e)){this.listeners.set(e,[])}const s=this.listeners.get(e).filter((e=>e!==t));this.listeners.set(e,s)}clean(){this.remove("annotateImage");this.remove("screenshotImage");this.remove("currentIssue")}setAnnotateImage(e){this.set("annotateImage",e)}getAnnotateImage(){return this.get("annotateImage")}setScreenshotImage(e){this.set("screenshotImage",e)}getScreenshotImage(){return this.get("screenshotImage")}setStepCount(e){this.set("stepCount",e)}getStepCount(){return this.get("stepCount")}setLoginData(e){this.set("loginData",e)}getLoginData(){return this.get("loginData")}getUserId(){var e;return(e=this.getLoginData())===null||e===void 0?void 0:e.uid}getRecordStartTime(){return this.get("RecordStartTime")}setRecordStartTime(e){this.set("RecordStartTime",e)}setBugtracker(e){this.setPersistent("bugtracker",e)}getBugtracker(){return this.getPersistent("bugtracker")}setLastIssue(e){this.set("lastIssue",e)}getLastIssue(){return this.get("lastIssue")}setCurrentIssue(e){this.set("currentIssue",e)}getCurrentIssue(){return this.get("currentIssue")}setTimer(e){this.set("timer",e)}getTimer(){return this.get("timer")}setVideoUrl(e){this.set("video-url",e)}getVideoUrl(){return this.get("video-url")}setProjectId(e){if(this.getProjectId()!==e){this.setPersistent("projectId",{projectId:e})}}getProjectId(){var e;return(e=this.getPersistent("projectId"))===null||e===void 0?void 0:e.projectId}setTest(e){this.set("test",e)}getTest(){return this.get("test")}};t.BugimDataStore=r;t.BugimDataStore=r=i([(0,o.injectable)()],r)},function(e,t,s){"use strict";s.r(t);t["default"]={"modal-container":"modals_modal-container_21yiS_1tb2RhbHMt",modalContainer:"modals_modal-container_21yiS_1tb2RhbHMt","small-modal-large-button":"modals_small-modal-large-button_1ve1T_1tb2RhbHMt",smallModalLargeButton:"modals_small-modal-large-button_1ve1T_1tb2RhbHMt","headless-modal":"modals_headless-modal_35BiI_1tb2RhbHMt",headlessModal:"modals_headless-modal_35BiI_1tb2RhbHMt",close:"modals_close_3ZVcO_1tb2RhbHMt","modal-content":"modals_modal-content_10Gxb_1tb2RhbHMt",modalContent:"modals_modal-content_10Gxb_1tb2RhbHMt","black-mode":"modals_black-mode_35PxC_1tb2RhbHMt",blackMode:"modals_black-mode_35PxC_1tb2RhbHMt",modal:"modals_modal_2Righ_1tb2RhbHMt",header:"modals_header_iUaSk_1tb2RhbHMt",subHeader:"modals_subHeader_3-dJr_1tb2RhbHMt",body:"modals_body_2dy3__1tb2RhbHMt","Modal-subtitle":"modals_Modal-subtitle_1WB8g_1tb2RhbHMt",modalSubtitle:"modals_Modal-subtitle_1WB8g_1tb2RhbHMt","Modal-section":"modals_Modal-section_1UsNX_1tb2RhbHMt",modalSection:"modals_Modal-section_1UsNX_1tb2RhbHMt","text-align-left":"modals_text-align-left_3aHa0_1tb2RhbHMt",textAlignLeft:"modals_text-align-left_3aHa0_1tb2RhbHMt",textAlignCenter:"modals_textAlignCenter_3ycxs_1tb2RhbHMt",footer:"modals_footer_1aZeN_1tb2RhbHMt",fullPageModal:"modals_fullPageModal_2jyQc_1tb2RhbHMt",title:"modals_title_2zv40_1tb2RhbHMt","title-text":"modals_title-text_1-ev3_1tb2RhbHMt",titleText:"modals_title-text_1-ev3_1tb2RhbHMt",buttons:"modals_buttons_1SQIJ_1tb2RhbHMt",selected:"modals_selected_3_IEK_1tb2RhbHMt",page:"modals_page_19Lzf_1tb2RhbHMt","form-modal-label":"modals_form-modal-label_3Ugyi_1tb2RhbHMt",formModalLabel:"modals_form-modal-label_3Ugyi_1tb2RhbHMt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.BugtrackerManager=void 0;const c=s(2);const l=s(9);const u=s(274);const d=s(818);const p=s(281);const h=s(284);const f=s(62);const m=s(69);const g=s(14);const v={Jira:d.JiraBugtracker,Trello:h.TrelloBugtracker,Slack:p.SlackBugtracker,GitHub:u.GitHubBugtracker};const S={name:"Jira",url:""};let y=class e{constructor(e,t,s){this.hostService=e;this.bugimDataStore=t;this.featureFlagsService=s;const i=this.bugimDataStore.getBugtracker();if(i===null||i===void 0?void 0:i.name){this.currentBugtracker=this.createBugtracker(i)}}setCurrent(e=S){if(this.isConfigSameAsCurrent(e)){return}this.bugimDataStore.setBugtracker(e);this.currentBugtracker=this.createBugtracker(e)}getDefaultBugtracker(){return this.createBugtracker(S)}createBugtracker(e=S){const t=e.name;return v[t]?new v[t](e,this.hostService.activeHost,this.bugimDataStore,this.featureFlagsService):this.getDefaultBugtracker()}isConfigSameAsCurrent(e){return this.currentBugtracker&&e.name===this.currentBugtracker.config.name&&e.url===this.currentBugtracker.config.url}};t.BugtrackerManager=y;i([c.observable.ref,o("design:type",Object)],y.prototype,"currentBugtracker",void 0);t.BugtrackerManager=y=i([(0,l.injectable)(),o("design:paramtypes",[typeof(n=typeof f.HostService!=="undefined"&&f.HostService)==="function"?n:Object,typeof(r=typeof m.BugimDataStore!=="undefined"&&m.BugimDataStore)==="function"?r:Object,typeof(a=typeof g.FeatureFlagsService!=="undefined"&&g.FeatureFlagsService)==="function"?a:Object])],y)},function(e,t,s){"use strict";(function(e){var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.Step=void 0;const r=s(5);const a=s(183);const c=s(110);const l=s(423);const u=s(8);const d=s(2);class p{constructor(e,t){this._isDirty=false;this._isNew=true;this.causedEffects={network:[],mutations:[]};this.isUpdating=false;this.location="";this.name=null;this.originalStepId=null;this.overrideWaitForVisibility=false;this.previousStepId=null;this.quirks={};this.targetId=null;this.label=null;this.userDefinedError=null;this.preStepDelay=0;this.stepTimeout=0;this.stopOnError=true;this.treatAsWarning=false;this.usePreStepDelay=false;this.useStepTimeout=false;this.screenImage=null;this.screenImageHighlight=null;this.tabInfo=null;this.targetName=null;Object.defineProperties(this,{id:{value:e||u.utils.guid(),enumerable:true,writable:true},type:{value:t||"unknown",enumerable:true,writable:false,configurable:false},parentStep:{value:null,enumerable:false,writable:true},version:{get:this.getVersion,enumerable:true}})}hasNativeEventsOption(){return false}hasAutoScrollOption(){return false}hasTimeoutOverrideOption(){return false}useCurrentTab(){return false}getIcon(){return"action"}getThumbnailElement(){return null}getStepPreview(){return this.name}getDisplayName(){return`${this.type} step`}shouldSkipWaitForVisibility(){return this.overrideWaitForVisibility}getElementLocatorsWithTypes(){return this.element?[{element:this.element,type:"element"}]:[]}getElementLocators(){return this.getElementLocatorsWithTypes().map((e=>e.element))}isOptionalLocator(e){return false}update(e){if(this.isChanged(e)){this.setDirty()}return this._update(e)}isChanged(e){return Object.keys(e).some((t=>e[t]!==this[t]))}getSerializableObject(e){var t,s;const i=(t=this.condition)===null||t===void 0?void 0:t.getSerializableObject();const o=(s=this.whileLoop)===null||s===void 0?void 0:s.getSerializableObject();return{type:this.type,id:this.id,label:this.label,stopOnError:this.stopOnError,treatAsWarning:this.treatAsWarning,stepTimeout:this.stepTimeout,useStepTimeout:this.useStepTimeout,preStepDelay:this.preStepDelay,usePreStepDelay:this.usePreStepDelay,location:this.location,targetName:this.targetName,name:this.name,targetId:this.targetId,screenImage:this.screenImage||"",screenImageHighlight:this.screenImageHighlight,quirks:this.quirks,userDefinedError:this.userDefinedError,tabInfo:this.tabInfo,previousStepId:this.previousStepId,version:this.getStepVersion(),description:this.getDisplayName(),condition:i,whileLoop:o,isTabOpener:this.isTabOpener,isNavigationTrigger:this.isNavigationTrigger,originalStepId:this.originalStepId,autoScroll:this.autoScroll,causedEffects:this.causedEffects,overrideWaitForVisibility:this.overrideWaitForVisibility,...(e===null||e===void 0?void 0:e.addDirtyFlag)&&{isDirty:this.isDirty},...(e===null||e===void 0?void 0:e.addIsNewFlag)&&{isNew:this.isNew},...(e===null||e===void 0?void 0:e.full)&&{isUpdating:this.isUpdating,_isDirty:false},...Object.hasOwn(this,"nativeEvents")&&this.hasNativeEventsOption()&&{nativeEvents:this.nativeEvents},...Object.hasOwn(this,"wasImproved")&&{wasImproved:this.wasImproved},...Object.hasOwn(this,"secrets")&&{secrets:this.secrets},...this.locatorIds&&{locatorIds:this.locatorIds}}}getSerializableSaveObject(e){return this.getSerializableObject(e)}getStopOnError(){return typeof this.stopOnError==="boolean"?this.stopOnError:true}getTreatAsWarning(){return!!this.treatAsWarning}_update(e){if(!e){return this}if(e.quirks){this.quirks=Object.assign(this.quirks,e.quirks)}if(e.targetName){this.targetName=String(e.targetName).trim()}if(e.name){this.name=String(e.name).trim()}if(e.tabInfo){this.tabInfo=e.tabInfo}if(Object.hasOwn(e,"overrideWaitForVisibility")){this.overrideWaitForVisibility=e.overrideWaitForVisibility}if(e.previousStepId){this.previousStepId=e.previousStepId}if(e.originalStepId){this.originalStepId=e.originalStepId}if(e.targetId){this.targetId=String(e.targetId).trim()}if(e.location){this.location=e.location}if(typeof e.label==="string"){this.label=e.label}if(e.stopOnError!==undefined){this.stopOnError=e.stopOnError}if(e.treatAsWarning!==undefined){this.treatAsWarning=e.treatAsWarning}if(e.screenImage){this.screenImage=e.screenImage}if(e.screenImageHighlight){const t=e.screenImageHighlight;this.screenImageHighlight={height:t.height&&Math.round(t.height),width:t.width&&Math.round(t.width),left:t.left&&Math.round(t.left),top:t.top&&Math.round(t.top),pixelRatio:t.pixelRatio}}if(e.removeScreenImageHighlight){this.screenImageHighlight=null}if(typeof e.stepTimeout==="number"){this.stepTimeout=e.stepTimeout}if(typeof e.useStepTimeout==="boolean"){this.useStepTimeout=e.useStepTimeout}if(typeof e.preStepDelay==="number"&&e.preStepDelay>=0){this.preStepDelay=e.preStepDelay}if(typeof e.usePreStepDelay==="boolean"){this.usePreStepDelay=e.usePreStepDelay}if(typeof e.isUpdating==="boolean"){this.isUpdating=e.isUpdating}if(typeof e._isDirty==="boolean"){this._isDirty=e._isDirty}if(typeof e.autoScroll==="boolean"&&this.hasAutoScrollOption()){this.autoScroll=e.autoScroll}if(e.condition){if(this.condition){this.condition.update(e.condition)}else{this.condition=e.condition;this.condition.parentStep=this}}if(e.removeCondition){this.condition=undefined}if(e.whileLoop){if(this.whileLoop){this.whileLoop.update(e.whileLoop)}else{this.whileLoop=e.whileLoop;this.whileLoop.parentStep=this}}if(e.removeWhileLoop){this.whileLoop=undefined}if(typeof e.isTabOpener==="boolean"){this.isTabOpener=e.isTabOpener}if(typeof e.isNavigationTrigger==="boolean"){this.isNavigationTrigger=e.isNavigationTrigger}if(e.version){this._version=e.version}if(Object.hasOwn(e,"nativeEvents")){this.nativeEvents=e.nativeEvents}if(Object.hasOwn(e,"wasImproved")){this.wasImproved=e.wasImproved}if(Object.hasOwn(e,"network")){this.causedEffects.network.push(e.network)}if(Object.hasOwn(e,"secrets")){this.secrets=e.secrets}if(e.locatorIds){this.locatorIds=e.locatorIds}if(e.hasOwnProperty("userDefinedError")){this.userDefinedError=e.userDefinedError}return this}getStepPath(e,t=[]){var s,i;if(!e)throw new Error("stepPath wasn't passed stepId");if(this.id===e){return t.concat([this.id])}if(((s=this.getStepCondition())===null||s===void 0?void 0:s.id)===e||((i=this.getStepWhileLoop())===null||i===void 0?void 0:i.id)===e){return t.concat([this.id]).concat([e])}return null}getSerializablePlaybackObject(){return this.getSerializableObject()}getScreenImage(){return this.screenImage}getScreenImageHighlight(){return this.screenImageHighlight}getStepVersion(){return this._version||this.version}getVersion(){return"1.2.0"}setDirty(){var e;if(this._isDirty){return}this._isDirty=true;(e=this.parentStep)===null||e===void 0?void 0:e.setDirty()}get ignoreTopFrame(){return false}get ignoreFrameRetries(){return false}get hasRealChanges(){return this._isDirty}resetDirty(e){if(e&&!e.has(this)){return}if(this.condition){this.condition.resetDirty()}if(this.whileLoop){this.whileLoop.resetDirty()}this._isDirty=false}setNew(){this._isNew=true}resetNew(e){if(e&&!e.has(this)){return}this._isNew=false}getType(){return this.type}getStepContent(){return this}getStepCondition(){return this.getStepContent()?this.getStepContent().condition:null}getStepWhileLoop(){return this.getStepContent()?this.getStepContent().whileLoop:null}getPostCodeStep(){return this.getStepContent()?this.getStepContent().postCode:null}getTargetElementLabel(e){return""}getCompletedValue(e){var t;const s=e.success;const i=this.isVerificationStep()&&((t=e===null||e===void 0?void 0:e.eyesResult)===null||t===void 0?void 0:t.isNew);const o=e.treatAsWarning&&(i||s===false);if(o||this.isPassWithWarning(e)){return"partial"}return s}showButtonFailureReason(){return Boolean(this.hasResult()&&this.result.reason&&this.result.success!==true)}hasResult(){return Boolean(this.result&&this.isComplete!==undefined)}isPassWithWarning(e){const t=e.success;return!!(t&&t!=="skipped"&&e.reason)}setHiddenParamsResult(e=this.result){e.incomingParams=(0,l.maskHiddenParams)(e.incomingParams);if(e.outgoingParams){e.outgoingParams.global=(0,l.maskHiddenParams)(e.outgoingParams.global);e.outgoingParams.test=(0,l.maskHiddenParams)(e.outgoingParams.test);e.outgoingParams.local=(0,l.maskHiddenParams)(e.outgoingParams.local)}}setResult(e){var t;this.setHiddenParamsResult(e);if(e.isHookResult&&e.reason){const s=r.commonConstants.HOOK.FAIL_PREFIX[e.hookType];if(!((t=e.reason)===null||t===void 0?void 0:t.startsWith(s))){e.reason=`${s}: ${e.reason}`}}this.result=e;if(this.condition){this.condition.result=e}else if(this.getStepContent().condition&&this.isSharedStepInstance()){this.conditionResult=e}}reset(e=0){this.result=undefined}isVerificationStep(){return false}isScrollStep(){return false}getFirstRetryMinimalThreshold(){return.7}getFriendlyName(){return r.commonConstants.sharedStepsFriendlyNames[this.type]||r.commonConstants.sharedStepsFriendlyNames.__default}getTestimDocsUrl(){return undefined}getPropertiesDescription(e,t,s){const i=this.getTreatAsWarning();const o=this.getStopOnError();let n="Mark error & stop";if(i){n="Mark warning & continue"}else if(!o){n="Mark error & continue"}const r={[c.ConditionType.ALWAYS]:"Always Run",[c.ConditionType.ELEMENT]:{[a.conditionSubType.IS_VISIBLE]:"Element is visible",[a.conditionSubType.IS_NOT_VISIBLE]:"Element is not visible",[a.conditionSubType.ELEMENT_TEXT]:"Element Text"},[c.ConditionType.CUSTOM]:"Custom",[c.ConditionType.NEVER]:"Never (skip)"};const l=this.getStepCondition();const u=(l===null||l===void 0?void 0:l.type)===c.ConditionType.ELEMENT?r[c.ConditionType.ELEMENT][l.subType]:r[(l===null||l===void 0?void 0:l.type)||c.ConditionType.ALWAYS];const d=[{key:"stepCondition",name:"When to run step",value:u},{key:"whenStepFails",name:"When this step fails",value:n}];if(this.hasTimeoutOverrideOption()){d.push({key:"overrideOption",name:"Override timeout",value:this.useStepTimeout?this.stepTimeout:false})}return d}isSharedStepInstance(){return this.type==="shared-step-instance"}static buildFrameLocatorStepData(e){if(e.isTopFrame||e.isAndroid||e.isIos){return[]}if(e.frameLocators){return e.frameLocators.map((e=>({elementLocator:e.elementLocator,selector:e.selector,isShadowed:e.isShadowed,type:"locate",testimFrameId:e.testimFrameId})))}return null}get isGroupStep(){return false}get isDirty(){return this._isDirty}get isNew(){return this._isNew}get displayName(){return this.label||this.getDisplayName()}stepTitleHandlers(){return this.displayName}get stepTitle(){return this.stepTitleHandlers()||this.displayName}get isRunning(){var e,t,s;const{WHILELOOP_DONE:i,RUNNING:o}=r.commonConstants.stepStatus;return((e=this.result)===null||e===void 0?void 0:e.status)===o&&!this.getStepContent().whileLoop||((t=this.result)===null||t===void 0?void 0:t.status)===i&&!((s=this.result)===null||s===void 0?void 0:s.whileLoopEvaluated)}get isComplete(){const{WHILELOOP_DONE:e,COMPLETED:t}=r.commonConstants.stepStatus;const{result:s}=this;if((s===null||s===void 0?void 0:s.status)===t||(s===null||s===void 0?void 0:s.status)===e&&(s===null||s===void 0?void 0:s.whileLoopEvaluated)){return this.getCompletedValue(s)}return undefined}get passWithWarning(){const{WHILELOOP_DONE:e,COMPLETED:t}=r.commonConstants.stepStatus;const{result:s}=this;if((s===null||s===void 0?void 0:s.status)===t||(s===null||s===void 0?void 0:s.status)===e&&(s===null||s===void 0?void 0:s.whileLoopEvaluated)){return this.isPassWithWarning(s)}return undefined}}t.Step=p;i([d.observable,o("design:type",Boolean)],p.prototype,"autoScroll",void 0);i([d.observable,o("design:type",String)],p.prototype,"exportScope",void 0);i([d.observable,o("design:type",Object)],p.prototype,"label",void 0);i([d.observable,o("design:type",Object)],p.prototype,"userDefinedError",void 0);i([d.observable,o("design:type",Boolean)],p.prototype,"nativeEvents",void 0);i([d.observable,o("design:type",Number)],p.prototype,"preStepDelay",void 0);i([d.observable,o("design:type",typeof(n=typeof Record!=="undefined"&&Record)==="function"?n:Object)],p.prototype,"secrets",void 0);i([d.observable,o("design:type",Number)],p.prototype,"stepTimeout",void 0);i([d.observable,o("design:type",Boolean)],p.prototype,"stopOnError",void 0);i([d.observable,o("design:type",Boolean)],p.prototype,"treatAsWarning",void 0);i([d.observable,o("design:type",Boolean)],p.prototype,"usePreStepDelay",void 0);i([d.observable,o("design:type",Boolean)],p.prototype,"useStepTimeout",void 0);i([d.observable.deep,o("design:type",Object)],p.prototype,"result",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"condition",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"element",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"screenImage",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"screenImageHighlight",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"tabInfo",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"targetName",void 0);i([d.observable.ref,o("design:type",Object)],p.prototype,"whileLoop",void 0);i([d.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],p.prototype,"setHiddenParamsResult",null);i([d.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],p.prototype,"setResult",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],p.prototype,"stepTitle",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],p.prototype,"isRunning",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],p.prototype,"isComplete",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],p.prototype,"passWithWarning",null);if(e.env.isClickimEditor||false){(0,d.decorate)(p,{name:d.observable.ref})}}).call(this,s(35))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TOURS=t.TOUR_NAMES=t.FirstTourMessages=void 0;const i=s(4);const o=s(430);const n=s(431);const r=s(432);const a=s(433);const c=s(206);const l=s(148);const u=s(434);const d=s(435);const p=s(207);const h=s(149);const f=s(436);const m=s(208);const g=s(437);const v=s(209);const S=s(438);const y=s(670);const b=s(5);const _={message:()=>(0,i.jsx)(i.Fragment,{children:"Click here to start recording your test"}),selector:`.${m.default.recordButton}`,extraTooltipStyles:{marginTop:"33px",width:"186px"},leftBackgroundDiff:{width:-2,left:0,top:0},bottomBackgroundDiff:{width:2,left:-2,top:0},topBackgroundDiff:{width:2,left:-2,height:0,top:0}};t.FirstTourMessages={isFirstUser:()=>(0,i.jsx)(i.Fragment,{children:"Double-click here to setup your first test"}),notFirstUser:()=>(0,i.jsx)(i.Fragment,{children:"Click here to add a test"})};t.TOUR_NAMES={FIRST_TEST:"first-test",SECOND_TEST:"second-test",FIRST_GROUP:"first-group",THREE_WAY_MERGE_CONFLICT_ROW:"first-3way-merge-conflict-row",THREE_WAY_MERGE_CONFIRM:"first-3way-merge-confirm",THREE_WAY_MERGE_SHARED_STEP:"first-3way-shared-step",START_RECORDING:"start-recording",START_RECORDING_GROUP_WIZARD:"start-recording-group-wizard",START_PLAYING:"start-playing",SEE_ERROR:"see-error",NEW_TEST:"new-test",SAVE_TEST:"save-test",LOCATORS_VIDEO:"locators-video",LOCATORS:"locators",DEVELOPERS:"DEVELOPERS",TESTIM_GUIDE:"testim-guide",CI_PLATFORM:"ci-platform",CI_DOCS:"ci-docs",...y.SFDC_TOUR_NAMES};t.TOURS={[t.TOUR_NAMES.FIRST_TEST]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Double-click here to setup your first test"}),direction:"bottom",trigger:"dblclick",selector:"",extraTooltipStyles:{}}],autoStop:true,relaunchOnRefresh:true},[t.TOUR_NAMES.THREE_WAY_MERGE_CONFLICT_ROW]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Choose the step from source/target that you want to merge"}),selector:"",placeAboveModals:true,backdrop:false}],autoStop:true,relaunchOnRefresh:false},[t.TOUR_NAMES.THREE_WAY_MERGE_CONFIRM]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"All conflicts have been resolved"}),selector:"",placeAboveModals:true,backdrop:false}],autoStop:true,relaunchOnRefresh:false},[t.TOUR_NAMES.THREE_WAY_MERGE_SHARED_STEP]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Choose the shared steps properties from source/target"}),selector:"",placeAboveModals:true,direction:"bottomRight",backdrop:false}],autoStop:true,relaunchOnRefresh:false},[t.TOUR_NAMES.FIRST_GROUP]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Double click to enter the group and start recording your first test"}),selector:`.${o.default.scenarioEditorMainSteps} > .${r.default.stepPair}:nth-child(2) > .${r.default.stepWrapper}`,trigger:"dblclick",leftBackgroundDiff:{width:-23,left:0,top:0},rightBackgroundDiff:{left:23,top:0},bottomBackgroundDiff:{width:46,left:-23,top:0},topBackgroundDiff:{width:46,left:-23,height:0,top:0}},_],autoStop:true,relaunchOnRefresh:false},[t.TOUR_NAMES.START_RECORDING_GROUP_WIZARD]:{steps:[_],autoStop:true,relaunchOnRefresh:false},[t.TOUR_NAMES.START_RECORDING]:{steps:[_],autoStop:false,relaunchOnRefresh:true},[t.TOUR_NAMES.START_PLAYING]:{steps:[{image:v.default,message:()=>(0,i.jsx)(i.Fragment,{children:"Click play to run your test"}),selector:`.${c.default.mainPlayButton}`,backdrop:true,extraTooltipStyles:{marginTop:"20px",width:"222px"}}],autoStop:true},[t.TOUR_NAMES.SEE_ERROR]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Click to view screenshot of error"}),selector:`.${a.default.seeErrorContainer} > span`,backdrop:false,extraTooltipStyles:{marginTop:"10px",width:"140px"}},{message:()=>(0,i.jsx)(i.Fragment,{children:"Click here to see your previous step"}),selector:`.stepViewerTabs > .${g.default.stepViewerPrev}`,backdrop:false,direction:"right"}],autoStop:true},[t.TOUR_NAMES.SAVE_TEST]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Don't forget to save your changes"}),selector:`.${m.default.saveButton}:not([disabled])`,backdrop:false,extraTooltipStyles:{marginTop:"25px",width:"187px"},direction:"bottomRight"}],autoStop:true},[t.TOUR_NAMES.SECOND_TEST]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Click here to start your second test"}),selector:".icon-background.f-col-center.Test.list",direction:"right",backdrop:false,extraTooltipStyles:{width:"176px"}},{message:()=>(0,i.jsx)(i.Fragment,{children:"Double-click here to enter your second test"}),trigger:"dblclick",selector:`.${p.default.container} .${p.default.row}:nth-child(2)`,extraTooltipStyles:{marginTop:"25px",width:"220px"}}],autoStop:true},[t.TOUR_NAMES.NEW_TEST]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Click here to create your second test"}),selector:`.${l.default.right} > .${l.default.buttons} > button`,backdrop:false,extraTooltipStyles:{width:"189px"},direction:"bottom"}],autoStop:true},[t.TOUR_NAMES.CI_PLATFORM]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Please select a platform"}),selector:`.${u.default.dropdowns} > label:nth-child(1) > div`,backdrop:false,direction:"bottomRight"}],autoStop:false},[t.TOUR_NAMES.CI_DOCS]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"See our guide for setting up your CI"}),selector:`.${d.default.codeInstructions} a`,backdrop:false,direction:"right",extraTooltipStyles:{width:"176px",marginLeft:"30px"}}],autoStop:true},[t.TOUR_NAMES.LOCATORS_VIDEO]:{steps:[{message:S.ManagerTour,selector:`.${h.default.appHeader}`,containerClassName:f.default.tooltipContainer,tooltipClassName:f.default.tooltip,backdrop:false}],autoStop:false,relaunchOnRefresh:true},[t.TOUR_NAMES.LOCATORS]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Hover and click on view locators"}),selector:"step-target-panel-thumbnail-react",backdrop:false,direction:"left"}],autoStop:true},[t.TOUR_NAMES.DEVELOPERS]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Customize your test with flexible, code-based steps"}),selector:`.${b.globalSelectors.editorAddStep}`,trigger:"click",extraTooltipStyles:{width:"222px",pointerEvents:"all"},noTip:true,closeOnEscape:true,closeOnClickOutside:true,backdrop:false}],autoStop:true},[t.TOUR_NAMES.TESTIM_GUIDE]:{steps:[{message:()=>(0,i.jsx)(i.Fragment,{children:"Learn how to use Testim"}),selector:`.${n.default.mainContainer} button`,extraTooltipStyles:{width:"225px"},trigger:"click",backdrop:false}],autoStop:true,relaunchOnRefresh:false},...y.SFDC_TOURS}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(475),t)},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SelectorParamEvaluationError=t.scriptFormat=t.displayFormat=void 0;const i=s(5);function o(e,t){if(typeof t==="string")return t;return e}t.displayFormat=o;function n(e,t){if(typeof t==="string")return t;return`'${e}'`}t.scriptFormat=n;class r extends Error{constructor(e){super(e.message);this.errorType=i.commonConstants.stepResult.SELECTOR_EVALUATION_FAILURE;this.innerError=e;Object.setPrototypeOf(this,r.prototype)}}t.SelectorParamEvaluationError=r},,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.TestConfig=t.defaults=t.DEFAULT_CONFIG_NAME=void 0;const n=s(8);const r=s(5);const a=s(142);const c=s(2);const l=30*60*1e3;t.DEFAULT_CONFIG_NAME="untitled configuration";t.defaults={name:t.DEFAULT_CONFIG_NAME,os:typeof window!=="undefined"&&window.navigator?window.navigator.platform:"os not set",osVersion:"",resolution:r.commonConstants.defaults.SMALL_SCREEN,browser:n.utils.browserName(),stepDelay:200,retryTimeout:250,hooks:{},backgroundTimeout:1e3,stepTimeout:3e4,setupStepTimeout:1e4,baseUrl:null,screenImage:null,show:true,resizeWindowStep:null,isMobileWeb:false,isMobile:false,mobileEmulation:null,applitoolsEnvironments:[],applitoolsMatchLevel:a.APPLITOOLS_DEFAULT_MATCH_LEVEL,applitoolsRCA:false,applitoolsDiffs:false,applitoolsConcurrency:5,applitoolsStepTimeout:l,nativeApp:null,mobile:null,nativeEvents:"inherit"};const u=Object.keys(t.defaults);class d{constructor(e){this.type="setup";this.isDirty=false;e=n.utils.extend({},t.defaults,e);this.name=t.DEFAULT_CONFIG_NAME;this.sfdcCredential=e.sfdcCredential;this.update(e);Object.defineProperties(this,{id:{value:e.id||n.utils.guid(),enumerable:true,writable:false},version:{get:this.getVersion,enumerable:true}})}update(e){u.forEach((t=>{if(Object.hasOwn(e,t)){const s=e[t];if(s!==undefined){this[t]=n.utils.clone(s)}}}))}isContainResizeWindowStep(e){return this.resizeWindowStep&&this.resizeWindowStep.id===e}getType(){return"setup"}getFriendlyName(){return"Test configuration"}isScrollStep(){return false}getStepCondition(){return null}getScreenImageHighlight(){return null}getStopOnError(){return null}getTreatAsWarning(){return null}getScreenImage(){return this.screenImage}hasResult(){return Boolean(this.result)}getStepWhileLoop(){return null}getSerializableObject(){var e,t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E,I,C;return{name:(e=this.name)!==null&&e!==void 0?e:null,os:(t=this.os)!==null&&t!==void 0?t:null,osVersion:(s=this.osVersion)!==null&&s!==void 0?s:null,resolution:(i=this.resolution)!==null&&i!==void 0?i:null,browser:(o=this.browser)!==null&&o!==void 0?o:null,stepDelay:(n=this.stepDelay)!==null&&n!==void 0?n:null,retryTimeout:(r=this.retryTimeout)!==null&&r!==void 0?r:null,hooks:(a=this.hooks)!==null&&a!==void 0?a:null,backgroundTimeout:(c=this.backgroundTimeout)!==null&&c!==void 0?c:null,stepTimeout:(l=this.stepTimeout)!==null&&l!==void 0?l:null,setupStepTimeout:(u=this.setupStepTimeout)!==null&&u!==void 0?u:null,baseUrl:(d=this.baseUrl)!==null&&d!==void 0?d:null,screenImage:(p=this.screenImage)!==null&&p!==void 0?p:null,show:(h=this.show)!==null&&h!==void 0?h:null,isMobileWeb:(f=this.isMobileWeb)!==null&&f!==void 0?f:null,isMobile:(m=this.isMobile)!==null&&m!==void 0?m:null,mobileEmulation:(g=this.mobileEmulation)!==null&&g!==void 0?g:null,applitoolsEnvironments:(v=this.applitoolsEnvironments)!==null&&v!==void 0?v:null,applitoolsMatchLevel:(S=this.applitoolsMatchLevel)!==null&&S!==void 0?S:null,applitoolsRCA:(y=this.applitoolsRCA)!==null&&y!==void 0?y:null,applitoolsDiffs:(b=this.applitoolsDiffs)!==null&&b!==void 0?b:null,applitoolsConcurrency:(_=this.applitoolsConcurrency)!==null&&_!==void 0?_:null,applitoolsStepTimeout:(T=this.applitoolsStepTimeout)!==null&&T!==void 0?T:null,nativeApp:(E=this.nativeApp)!==null&&E!==void 0?E:null,sfdcCredential:(I=this.sfdcCredential)!==null&&I!==void 0?I:"",id:this.id,version:this.getVersion(),mobile:(C=this.mobile)!==null&&C!==void 0?C:null,nativeEvents:this.nativeEvents}}getVersion(){return"1.0.0"}static createFromData(e){return new d(e||{})}get displayName(){return"Setup"}}t.TestConfig=d;i([c.observable,o("design:type",Object)],d.prototype,"nativeEvents",void 0);i([c.observable,o("design:type",Object)],d.prototype,"isComplete",void 0);i([c.observable,o("design:type",Boolean)],d.prototype,"isRunning",void 0);i([c.observable,o("design:type",String)],d.prototype,"name",void 0);i([c.observable,o("design:type",Object)],d.prototype,"resolution",void 0);i([c.observable.ref,o("design:type",Object)],d.prototype,"result",void 0);i([c.observable.ref,o("design:type",Object)],d.prototype,"screenImage",void 0)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;var r;var a,c,l,u,d,p,h,f,m,g;Object.defineProperty(t,"__esModule",{value:true});t.ExtensionService=t.openInstallExtensionTab=t.INSTALL_EXTENSION_REFRESH_COOKIE=t.TESTIM_APPSTORE_URL=void 0;const v=s(118);const S=s(427);const y=s(428);const b=s(9);const _=s(8);const T=s(7);const E=s(205);const I=s(5);const C=s(33);const D=s(21);const O=s(38);const A=s(15);const j=s(34);const w=s(49);const R=s(39);const P=s(55);const x=s(28);const M=s(128);const N=s(271);const F=s(26);const L=s(20);const k=s(801);const B=s(804);const{browser:U}=v;const G=T.Logger.getLogger("extension-service");const V="This browser is not supported.";const H=(U===null||U===void 0?void 0:U.runtime)!==undefined;const $=1e4;const W=20;t.TESTIM_APPSTORE_URL=`https://chrome.google.com/webstore/detail/testim-editor/${I.commonConstants.TESTIM_EXTENSION_ID}`;t.INSTALL_EXTENSION_REFRESH_COOKIE="isInstallingExtension";const J=()=>{var e;(e=window.open(t.TESTIM_APPSTORE_URL,"_blank","noopener"))===null||e===void 0?void 0:e.focus()};t.openInstallExtensionTab=J;const Y=((n=B.AppConfigManager.appConfig)===null||n===void 0?void 0:n.EXTENSION_ID)||I.commonConstants.TESTIM_EXTENSION_ID;let z=r=class e extends C.EventEmitter{get extensionFeatures(){return r._extensionFeatures}constructor(e,t,s,i,o,n,a,c,l,u){super();this.projectsService=e;this.analyticsService=t;this.authenticationManager=s;this.branchesService=i;this.userService=o;this.companiesService=n;this.restrictToChrome=a;this.premiumFeaturesService=c;this.modalService=l;this.urlState=u;this.openPort=r.openPort;this.send=r.send;this.hasUpdate=false;this._port=null;this.connect().catch((()=>null));this.listenToEvents()}get hasPort(){return Boolean(this._port)}static async openPort(e,t=W,s=$){if(!H){throw new Error(V)}return new Promise(((i,o)=>{let n=null;const a=e=>{if((e===null||e===void 0?void 0:e.command)===I.commonConstants.host.PORT_REGISTERED){this._extensionVersion=e?e.version:undefined;if(e.reportLocalResults){r._extensionFeatures.reportLocalResults=true}if(n){n.onMessage.removeListener(a)}if(this._connectInterval){clearInterval(this._connectInterval);this._connectInterval=undefined}i(n)}};const c=()=>{if(t--<=0){if(this._connectInterval){clearInterval(this._connectInterval)}this._connectInterval=null;return o(new Error("Extension Connect Out of retries"))}try{if(n){n.onMessage.removeListener(a)}n=U.runtime.connect(Y,{name:e});n.onMessage.addListener(a)}catch(e){G.error("While trying to connect to port",e,I.commonConstants.host.CONSOLE_PORT);return o(new Error(`While trying to connect to port:${e.message}`))}return undefined};c();this._connectInterval=window.setInterval((()=>c()),s)}))}static async send(e,t){if(H){return U.runtime.sendMessageAsync(Y,e,{})}return t}onLogin(){return this.send({type:I.commonConstants.scenario.APP_LOGIN,data:this.authenticationManager.loginData})}onLabFeaturesChanged(e){return this.send({type:I.commonConstants.host.EXTENSION_LAB_FEATURES_CHANGED,data:{projectId:e}})}onProjectChange(){return this.send({type:I.commonConstants.host.SET_PROJECT,data:{projectType:this.projectsService.projectType,projectId:this.projectsService.projectId,servicesUrl:_.utils.getServicesUrl(),agentBaseUrl:_.utils.getTestimBaseAgentUrl(),isMobileWeb:this.projectsService.isMobileWeb,premiumFeatures:this.premiumFeaturesService.premiumFeatures,clickimBaseUrl:_.utils.getClickimBaseUrl()}})}onReceivedUpdate(){this.hasUpdate=true}onBranchChange(){return this.send({type:I.commonConstants.scenario.BRANCH_CHANGED,data:{branch:this.branchesService.branch}})}listenToEvents(){if(!H){return}const{PROJECT_SELECTED:e,PROJECT_CHANGED:t,COMPANY_CHANGED:s,COMPANY_SELECTED:i,BRANCH_CHANGE:o}=I.commonConstants.scenario;const{LOGIN:n,LOGOUT:r}=I.commonConstants.user;const a=()=>{this.send({type:I.commonConstants.scenario.APP_LOGOUT})};const c=()=>{const e={type:I.commonConstants.host.SET_COMPANY,data:{companyId:this.companiesService.companyId,planType:this.companiesService.companyPlanType,isPOC:this.companiesService.activePlan.isPoc,isStartUp:this.companiesService.activePlan.isStartUp,onprem:this.companiesService.isOnPrem,storageType:this.companiesService.storageType,storageBaseUrl:this.companiesService.storageBaseUrl,premiumFeatures:this.premiumFeaturesService.premiumFeatures}};this.send(e)};this.projectsService.on([e,t],this.onProjectChange.bind(this));this.companiesService.on([i,s],c);this.userService.on(r,a);this.branchesService.on(o,this.onBranchChange.bind(this));this.userService.on(n,this.onLogin.bind(this))}onDisconnect(){this._port=null;this.connect().catch((()=>null))}async doesExtensionExist(){if(this._port){return true}if(!H){this._doesExtensionExist=false;this.analyticsService.setExtensionInstalled(false)}if(typeof this._doesExtensionExist==="boolean"){this.analyticsService.setExtensionInstalled(this._doesExtensionExist);return this._doesExtensionExist}const e=await U.runtime.sendMessageAsync(Y,{type:I.commonConstants.host.EXTENSION_INSTALLED});this._doesExtensionExist=Boolean(e);this._extensionVersion=e===null||e===void 0?void 0:e.version;this.analyticsService.setExtensionInstalled(this._doesExtensionExist);return this._doesExtensionExist}async pingExtension(){if(!this._port){return false}if(!H){return false}if(!this._doesExtensionExist){return false}return _.utils.promiseTimeout(U.runtime.sendMessageAsync(Y,{type:I.commonConstants.host.EXTENSION_PING}),3e4,new Error("ping timeout"))}async connect(e,t){if(!H){throw new Error(V)}if(this._port){return this._port}const s=await this.openPort(I.commonConstants.host.CONSOLE_PORT,e,t);this._port=s;s===null||s===void 0?void 0:s.onDisconnect.addListener((()=>this.onDisconnect()));this._doesExtensionExist=true;this.analyticsService.setExtensionInstalled(true);return s}onExtensionInstalled(){this.onLogin();this.onProjectChange();this.onBranchChange();this.trigger(I.commonConstants.host.INSTALLED)}async extensionInstallationFlow(e=true){const t=(0,L.isPlaygroundModeState)(this.urlState);this.analyticsService.track(t?"playground-chrome-extension":"extension-popup-open");const s=this.modalService.openModal(N.InstallExtensionModal,{blackMode:t}).promise.then((()=>{this.analyticsService.track(t?"playground-chrome-extension-closed":"extension-popup-closed");throw new E.CancellationError(I.commonConstants.host.USER_CANCELLED_INSTALLATION)}));return Promise.race([this.pollForInstalled().then((()=>{if(e){window.location.reload();throw new E.CancellationError(I.commonConstants.host.USER_CANCELLED_INSTALLATION)}})),s])}async pollForInstalled(){await Promise.resolve(this.restrictToChrome.restrict());await this.connect(360,500);this.analyticsService.extInstallSucceeded();this.onExtensionInstalled()}async validateInExtension(e=true){let t;try{t=await this.doesExtensionExist()}catch(e){t=false}if(!t){await this.extensionInstallationFlow(e);return{extensionInstalled:true}}return{extensionInstalled:false}}requestIncognito(){return this.modalService.openModal(k.ChromePermissionsModal,{image:S.default,permissionName:"in incognito",title:"Run in incognito mode"}).promise}requestFileAccess(){return this.modalService.openModal(k.ChromePermissionsModal,{image:y.default,message:"This test contains a Download step which requires access to file URLs. ",permissionName:"access to file URLs",title:"Allow access to file URLs"}).promise}commenceUpdate(){this.send({type:I.commonConstants.host.EXTENSION_DO_UPDATE})}};t.ExtensionService=z;z._extensionFeatures={reportLocalResults:false};t.ExtensionService=z=r=i([(0,b.injectable)(),o("design:paramtypes",[typeof(a=typeof A.ProjectsService!=="undefined"&&A.ProjectsService)==="function"?a:Object,typeof(c=typeof D.AnalyticsService!=="undefined"&&D.AnalyticsService)==="function"?c:Object,typeof(l=typeof O.AuthenticationService!=="undefined"&&O.AuthenticationService)==="function"?l:Object,typeof(u=typeof j.BranchesService!=="undefined"&&j.BranchesService)==="function"?u:Object,typeof(d=typeof w.UserService!=="undefined"&&w.UserService)==="function"?d:Object,typeof(p=typeof R.CompaniesService!=="undefined"&&R.CompaniesService)==="function"?p:Object,typeof(h=typeof M.RestrictToChrome!=="undefined"&&M.RestrictToChrome)==="function"?h:Object,typeof(f=typeof P.PremiumFeaturesService!=="undefined"&&P.PremiumFeaturesService)==="function"?f:Object,typeof(m=typeof x.ModalService!=="undefined"&&x.ModalService)==="function"?m:Object,typeof(g=typeof F.UrlStateService!=="undefined"&&F.UrlStateService)==="function"?g:Object])],z)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m;Object.defineProperty(t,"__esModule",{value:true});t.EditorSelectionService=void 0;const g=s(6);const v=s(81);const S=s(9);const y=s(5);const b=s(29);const _=s(72);const T=s(119);const E=s(87);const I=s(26);const C=s(2);const D=s(28);const O=s(45);const A=s(8);const j=s(61);const w=s(20);const R=s(48);let P=class e{constructor(e,t,i,o){this.editedTestStore=e;this.modalService=t;this.urlState=i;this.selectedSteps=C.observable.map();this.isSetupSelected=false;o.addCommandBinding("edit","select next",(()=>this.selectNextStep()));o.addCommandBinding(y.commonConstants.KEY_BINDING_LAYERS.RUN,"select next",(()=>this.selectNextStep()));o.addCommandBinding("edit","select prev",(()=>this.selectPrevStep()));o.addCommandBinding(y.commonConstants.KEY_BINDING_LAYERS.RUN,"select prev",(()=>this.selectPrevStep()));Promise.resolve().then((()=>s(84))).then((({RecordingStore:e})=>{this.recordingStore=j.container.get(e)}))}async deleteSelection(){var e;if(this.urlState.params.stepId){const t=(e=this.editedTestStore.scenario)===null||e===void 0?void 0:e.findStepById(this.urlState.params.stepId,true);if(!t||!t.getStepContent().isGroupStep)return}if(this.modalService.hasOpenModals()){return}if(this.currentSelection.length&&(0,w.isInEditor)(this.urlState.pathTemplate)){const e=this.currentSelection.steps.slice();const t=await this.modalService.openModal(O.MessageModal,{title:`Delete ${A.utils.pluralize(e.length,"step")}`,body:`Are you sure you want to delete ${e.length>1?"these steps":"this step"}?`,okText:"OK",cancelText:"CANCEL",icon:"trash-v4",className:v.default.deletionModal}).promise;if(!t){return}this.recordingStore._deleteSteps(e)}}get selectedOrContainerStep(){const e=this.selectedStep;const t=this.urlState.params.stepId;const s=t?this.containerStep:undefined;const i=this.currentSelection.length>1;if(e&&!i){return e}return s}get containerStep(){if(!this.editedTestStore.scenario){return undefined}const e=this.urlState.params.stepId;return e&&this.editedTestStore.scenario.findStepById(e,true)||this.editedTestStore.scenario}get focusedStepOrTestConfig(){if(!this.editedTestStore.scenario){return undefined}const e=this.urlState.params;const t=this.selectedStepOrTestConfig;const s=e.stepId?this.containerStep:this.editedTestStore.testConfig;const i=this.currentSelection.length>1;if(t&&!i){return t}return i?undefined:s}get selectedStepOrTestConfig(){if(this.isSetupSelected){return this.editedTestStore.testConfig}return this.selectedStep}get selectedStep(){const[e]=this.selectedSteps.values();return this.selectionLength?e:undefined}get currentSelectedGroup(){var e,t;return(t=(e=this.selectedStepOrTestConfig)===null||e===void 0?void 0:e.parentStep)!==null&&t!==void 0?t:this.editedTestStore.scenario}get selectedRange(){var e;if(!this.currentSelection.length){return{min:-1,max:-1,length:0,isContiguous:false}}const t=this.currentSelection.parent;const s=(e=t===null||t===void 0?void 0:t.steps)!==null&&e!==void 0?e:[];const i=[];for(let e=this.currentSelection.length-1;e>=0;--e){i[e]=s.indexOf(this.currentSelection.steps[e])}i.sort(((e,t)=>e-t));const o=i[0];const n=i[i.length-1];return{min:o,max:n,length:i.length,isContiguous:n-o===i.length-1}}get selectionLength(){return this.selectedSteps.size}get hasSelection(){return this.selectionLength>0}get allowGroupingSelection(){return this.selectedRange.isContiguous||this.selectedRange.length===0}get currentSelection(){if(this.selectionLength<1){return{length:0,steps:[]}}const e=[...this.selectedSteps.values()];return{length:this.selectionLength,steps:e,parent:e[0].parentStep instanceof E.GroupStep?e[0].parentStep:undefined}}isStepSelected(e){return this.selectedSteps.has(e.id)}forceSelectSetup(){this.clearSelection();this.isSetupSelected=true}clearSelection(){this.selectedSteps.clear()}setSelectedSteps(e){this.clearSelection();this.isSetupSelected=false;e.forEach((e=>this.selectStep(e)))}reverseSelection(e){for(const t of e){if(this.selectedSteps.has(t.id)){this.deselectStep(t)}else{this.selectStep(t)}}}selectStep(e){if(e&&!this.selectedSteps.has(e.id)){this.selectedSteps.set(e.id,e)}}deselectStep(e){this.selectedSteps.delete(e.id)}setSelection({select:e,appendToSelection:t,step:s}){this.isSetupSelected=false;if(e==="toggle"){e=!this.selectedSteps.has(s.id)}if(e&&!t){this.clearSelection()}if(e){this.selectStep(s)}else{this.deselectStep(s)}}deselectDeletedSteps(e){e.forEach((e=>this.selectedSteps.delete(e)))}setInitialSelection(e){if(!e){return}if(this.selectionFromQueryParams(e)){return}if(!e.getStepContent().isGroupStep){this.setSelection({step:e,select:true})}else{this.deselectAllButChildren(e.getStepContent())}}deselectAllButChildren(e){const t=e.getStepContent().steps;if(!t.length){this.clearSelection()}this.selectedSteps.forEach((e=>{if(!t.includes(e)){this.deselectStep(e)}}))}selectionFromQueryParams(e){const t=this.queryParamSelectionById();if(t.length){this.clearSelection();t.forEach((t=>{const s=e.getStepContent();const i=g.isFunction(s.findStepById)&&g.isFunction(s.findStepByProperty)&&(s.findStepById(t)||s.findStepByProperty("sharedStepInfoId",t));if(i){this.selectStep(i)}}));return true}const{selectionStart:s,selectionEnd:i}=this.queryParamRangeSelection();if(s>=0){this.clearSelection();for(const t of e.getStepContent().steps.slice(s,i)){this.selectStep(t)}return true}return false}queryParamSelectionById(){const e=this.urlState.params["selected-steps"];return e?e.split(","):[]}queryParamRangeSelection(){const e={selectionEnd:-1,selectionStart:-1};let t=Math.floor(Number(this.urlState.params["selection-start"]));let s=Math.floor(Number(this.urlState.params["selection-end"]));if(g.isNaN(t)){t=s-1}if(g.isNaN(s)){s=t+1}if(g.isNaN(t)||g.isNaN(s)){return e}if(s<t||t<0){return e}return{selectionEnd:s,selectionStart:t}}getStepByIndex(e){const t=this.currentSelectedGroup;if(!t||!t.isGroupStep){return undefined}const s=this.selectedRange.min+e;if(s<0){return undefined}return t.steps[s]}getStepOrTestConfigByIndex(e){const t=this.getStepByIndex(e);const s=this.currentSelectedGroup;if((s===null||s===void 0?void 0:s.type)==="scenario"&&!t&&this.getStepByIndex(0)){return this.editedTestStore.testConfig}return t}selectNextStep(){var e,t;if(!((t=(e=this.recordingStore)===null||e===void 0?void 0:e.insertionContainer)===null||t===void 0?void 0:t.isGroupStep)){return}const s=this.getStepOrTestConfigByIndex(1);if(s&&s.type!=="setup"){this.setSelection({select:true,step:s})}}selectPrevStep(){var e,t;if(!((t=(e=this.recordingStore)===null||e===void 0?void 0:e.insertionContainer)===null||t===void 0?void 0:t.isGroupStep)){return}const s=this.getStepOrTestConfigByIndex(-1);if((s===null||s===void 0?void 0:s.type)==="setup"){this.forceSelectSetup()}else if(s){this.setSelection({select:true,step:s})}}};t.EditorSelectionService=P;i([C.observable,o("design:type",Object)],P.prototype,"isSetupSelected",void 0);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"selectedOrContainerStep",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"containerStep",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"focusedStepOrTestConfig",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"selectedStepOrTestConfig",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"selectedStep",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"currentSelectedGroup",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"selectedRange",null);i([C.computed,o("design:type",Number),o("design:paramtypes",[])],P.prototype,"selectionLength",null);i([C.computed,o("design:type",Boolean),o("design:paramtypes",[])],P.prototype,"hasSelection",null);i([C.computed,o("design:type",Boolean),o("design:paramtypes",[])],P.prototype,"allowGroupingSelection",null);i([C.computed,o("design:type",Object),o("design:paramtypes",[])],P.prototype,"currentSelection",null);i([C.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],P.prototype,"forceSelectSetup",null);i([C.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],P.prototype,"clearSelection",null);i([C.action,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],P.prototype,"setSelectedSteps",null);i([C.action,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],P.prototype,"reverseSelection",null);i([C.action,o("design:type",Function),o("design:paramtypes",[typeof(p=typeof _.Step!=="undefined"&&_.Step)==="function"?p:Object]),o("design:returntype",void 0)],P.prototype,"selectStep",null);i([C.action,o("design:type",Function),o("design:paramtypes",[typeof(h=typeof _.Step!=="undefined"&&_.Step)==="function"?h:Object]),o("design:returntype",void 0)],P.prototype,"deselectStep",null);i([C.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],P.prototype,"setSelection",null);i([C.action,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],P.prototype,"deselectDeletedSteps",null);i([C.action,o("design:type",Function),o("design:paramtypes",[typeof(f=typeof _.Step!=="undefined"&&_.Step)==="function"?f:Object]),o("design:returntype",void 0)],P.prototype,"setInitialSelection",null);i([C.action,o("design:type",Function),o("design:paramtypes",[typeof(m=typeof E.GroupStep!=="undefined"&&E.GroupStep)==="function"?m:Object]),o("design:returntype",void 0)],P.prototype,"deselectAllButChildren",null);i([C.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],P.prototype,"selectNextStep",null);i([C.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],P.prototype,"selectPrevStep",null);t.EditorSelectionService=P=i([(0,S.injectable)(),(0,R.exposeGlobally)("editorSelectionService"),o("design:paramtypes",[typeof(n=typeof b.EditedTestStore!=="undefined"&&b.EditedTestStore)==="function"?n:Object,typeof(r=typeof D.ModalService!=="undefined"&&D.ModalService)==="function"?r:Object,typeof(a=typeof I.UrlStateService!=="undefined"&&I.UrlStateService)==="function"?a:Object,typeof(c=typeof T.KeyInputService!=="undefined"&&T.KeyInputService)==="function"?c:Object])],P)},function(e,t,s){"use strict";s.r(t);t["default"]={flexRowCenter:"message_flexRowCenter_11h_N_1lc3NhZ2Ut",bold:"message_bold_3XJXN_1lc3NhZ2Ut",irreversibleAction:"message_irreversibleAction_f9oUi_1lc3NhZ2Ut",modalIconImage:"message_modalIconImage_hZbS6_1lc3NhZ2Ut",modalNote:"message_modalNote_2M0p-_1lc3NhZ2Ut",modalIcon:"message_modalIcon_I7RY6_1lc3NhZ2Ut",errorType:"message_errorType_3M42a_1lc3NhZ2Ut",childIcon:"message_childIcon_176Qt_1lc3NhZ2Ut",deletionModal:"message_deletionModal_2o_dm_1lc3NhZ2Ut",icon:"message_icon_1VcfT_1lc3NhZ2Ut",backgroundedIcon:"message_backgroundedIcon_2pQjL_1lc3NhZ2Ut",warningModal:"message_warningModal_3M9qP_1lc3NhZ2Ut",infoModal:"message_infoModal_39yg4_1lc3NhZ2Ut",allowWhiteSpace:"message_allowWhiteSpace_2cgJe_1lc3NhZ2Ut"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S;Object.defineProperty(t,"__esModule",{value:true});t.SetupMobileTestStore=t.DeviceStatusErrorMessages=void 0;const y=s(2);const b=s(9);const _=s(6);const T=s(27);const E=s(15);const I=s(7);const C=s(29);const D=s(507);const O=s(28);const A=s(126);const j=s(83);const w=s(103);const R=s(156);const P=s(574);const x=s(42);const M=s(143);const N=s(14);const F=I.Logger.getLogger("SetupMobileTestStore");t.DeviceStatusErrorMessages={TMA_IS_OFF:{message:"It seems that the TMA agent is offline."},DEVICE_IS_LOCKED:{message:"The selected device is locked, please unlock it to continue authoring/playing a test."},DEVELOPER_MODE_TURNS_OFF:{message:"Please turn on developer mode on the target device.",docUrl:"https://help.testim.io/docs/configure-tricentis-mobile-agent"},MISSING_IOS_IMAGE:{message:"An iOS image is missing.",docUrl:"https://help.testim.io/docs/configure-tricentis-mobile-agent"},CERTIFICATE_MISSING:{message:"The certificate set for the selected device isn't setup correctly.",docUrl:"https://help.testim.io/docs/configure-tricentis-mobile-agent"}};let L=class e{constructor(e,t,s,i,o,n,r){this.editedTestStore=e;this.mobileAgentService=t;this.mobileAppsStore=s;this.projectsService=i;this.modalService=o;this.featureFlagsService=n;this.mobileFileUploadService=r;this.appSource=R.AppSource.LIBRARY;this.devicesFilterValue="";this.appsFilterValue="";this.uploadingFile=false;this.error="";this.result={};this.abortController=new AbortController;this.setAppSource=e=>{this.appSource=e};this.selectApplication=e=>{this._selectedApplication=e};this.selectDevice=e=>{this._selectedDevice=e};this.showVirtualDevices=()=>{this.changeDevicesFilterValue("");this._shouldShowVirtualDevices=true};this.showPhysicalDevices=()=>{this.changeDevicesFilterValue("");this._shouldShowVirtualDevices=false};this.changeDevicesFilterValue=e=>{this.devicesFilterValue=e;this._selectedDevice=undefined};this.changeAppsFilterValue=e=>{this.appsFilterValue=e;this._selectedApplication=undefined};this.validateWeCanMirrorDevice=async e=>{var t,s;if(this.featureFlagsService.flags.checkDeviceStatus.isEnabled()){this.deviceStatusErrorMessage=await this.checkIfDeviceReadyForInteractions(e)}if(this.deviceStatusErrorMessage){return}if(this.selectedDevice&&!this._selectedDevice){this._selectedDevice=this.selectedDevice}this.result.device=this.selectedDevice;this.result.nativeApp=((t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.nativeApp)||((s=this.editedTestStore.test)===null||s===void 0?void 0:s.testConfig.nativeApp)||undefined;this._selectedComponent=R.SetupMobileTestState.SELECT_APP;if(this.skip==="app"){this.closeModal({...this.result})}};this.nextButtonHandler=async()=>{var e,t;let s;if(this.skip==="app"&&((e=this.editedTestStore.scenario)===null||e===void 0?void 0:e.nativeApp)){s=this.checkAppMatchTargetDevice((t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.nativeApp);if(s){this.error=s;return}}if(this.selectedComponent===R.SetupMobileTestState.SELECT_APP){const e=this.appSource===R.AppSource.UPLOAD?this.currentUploadedApp:this.selectedApplication;s=this.checkAppMatchTargetDevice(e);if(s){this.error=s;return}this.result.nativeApp=e;this.discardFile();this.changeAppsFilterValue("");if(this.result.device||this.skip==="device"){this.closeModal({...this.result})}}if(this.selectedComponent===R.SetupMobileTestState.SELECT_DEVICE&&this.selectedDevice){this.deviceStatusState=(0,T.fromPromise)(this.validateWeCanMirrorDevice(this.selectedDevice))}};this.selectLibrary=()=>{this.discardFile();this.changeAppsFilterValue("");this.setAppSource(R.AppSource.LIBRARY);this._selectedComponent=R.SetupMobileTestState.SELECT_APP};this.selectFromDevice=()=>{this.discardFile();this.changeAppsFilterValue("");this.setAppSource(R.AppSource.DEVICE);this._selectedComponent=R.SetupMobileTestState.SELECT_APP};this.selectUpload=()=>{this.changeAppsFilterValue("");this.setAppSource(R.AppSource.UPLOAD);this._selectedComponent=R.SetupMobileTestState.SELECT_APP};this.goToSelectDevice=()=>{this.discardFile();this.changeDevicesFilterValue("");this.changeAppsFilterValue("");this._selectedComponent=R.SetupMobileTestState.SELECT_DEVICE};this.clearUploadError=()=>{this.error=""};this.discardFile=()=>{this.abortFileTransfer();this.currentUploadedFile=undefined;this.currentUploadedApp=undefined;this.clearUploadError()};this.handleUploadFile=async e=>{this.uploadingFile=true;this.clearUploadError();try{this.mobileFileUploadService.checkFilePropsBeforeUpload(e,this.mobileAppsStore.uploadedFileTypes,this.maxUploadedSize);this.abortController=new AbortController;this.currentUploadedFile=e;this.currentUploadedApp=await this.mobileFileUploadService.uploadFile(e,this.abortController)}catch(e){if(A.MobileFileUploadService.isUserAbortedError(e)){return}F.error("Error while trying to upload a file",{error:e});this.error=e.message}finally{this.uploadingFile=false}}}get agentReady(){return this.mobileAgentService.agentReadyStatus}get agentStatusLoading(){return this.mobileAgentService.agentStatusLoading}handleIosDeviceStatus(e){if(!e.virtual){if(!e.provisioned){return t.DeviceStatusErrorMessages.CERTIFICATE_MISSING}if(!e.imageUploaded){return t.DeviceStatusErrorMessages.MISSING_IOS_IMAGE}if(!e.os16DevEnabled&&parseFloat(e.osVersion)>=16){return t.DeviceStatusErrorMessages.DEVELOPER_MODE_TURNS_OFF}}if(e.passwordProtected){return t.DeviceStatusErrorMessages.DEVICE_IS_LOCKED}return null}handleAndroidDeviceStatus(e){return e.passwordLocked?t.DeviceStatusErrorMessages.DEVICE_IS_LOCKED:null}async checkIfDeviceReadyForInteractions(e){if(e.from==="TVC"){return null}try{const t=await P.tmaMobileService.deviceStatus(e.udid);if((0,_.isEmpty)(t)){F.warn("The endpoint for the device status from TMA returned an empty object.");return null}return e.deviceType==="iOS"?this.handleIosDeviceStatus(t):this.handleAndroidDeviceStatus(t)}catch(e){F.error("It seems that the TMA agent is offline",e);return t.DeviceStatusErrorMessages.TMA_IS_OFF}}verifyMatchBetweenTargetDeviceAndApplication(e){var t,s,i;const o=this.selectedDevice;if(!o){return null}if(this.projectsService.isIos){if((o===null||o===void 0?void 0:o.virtual)&&e.fileName.endsWith(".ipa")){return"This app has been compiled for physical mobile devices and you are currently using a virtual device."}if((o===null||o===void 0?void 0:o.virtual)===false&&e.fileName.endsWith(".app")){return"This app has been compiled for virtual mobile devices and you are currently using a physical device."}}else{const[n,r]=[parseFloat((s=(t=e.appMetadata)===null||t===void 0?void 0:t.minOsVersion)!==null&&s!==void 0?s:"0"),parseFloat((i=o===null||o===void 0?void 0:o.osVersion)!==null&&i!==void 0?i:"0")];if(n>r){return`The app's minimal requirement is ${n}, while the target device's version is ${r}`}}return null}checkAppMatchTargetDevice(e){const t="fileName"in e;return t?this.verifyMatchBetweenTargetDeviceAndApplication(e):null}get shouldShowVirtualDevices(){if(this._shouldShowVirtualDevices===undefined){const{virtual:e,physical:t}=this.mobileAgentService.devicesByType;if(e.length>0&&t.length===0){return true}}return Boolean(this._shouldShowVirtualDevices)}get nextButtonDisabled(){if([R.AppSource.LIBRARY,R.AppSource.DEVICE].includes(this.appSource)){if(this.selectedComponent===R.SetupMobileTestState.SELECT_APP){return(0,_.isEmpty)(this.selectedApplication)}if(this.selectedComponent===R.SetupMobileTestState.SELECT_DEVICE){return(0,_.isEmpty)(this.selectedDevice)}}if(this.appSource===R.AppSource.UPLOAD){if(this.selectedComponent===R.SetupMobileTestState.SELECT_APP){return(0,_.isEmpty)(this.currentUploadedApp)}if(this.selectedComponent===R.SetupMobileTestState.SELECT_DEVICE){return(0,_.isEmpty)(this.selectedDevice)}}return true}get selectDeviceOptions(){if(!this.agentReady){return[]}return this.mobileAgentService.devicesOrEmptyArray.filter((e=>{const t=this.shouldShowVirtualDevices?e.virtual:!e.virtual;const s=(0,_.isEmpty)(this.devicesFilterValue)||e.name.toLowerCase().includes(this.devicesFilterValue.toLowerCase());return t&&s}))}get selectedApplication(){return this._selectedApplication}get selectedDevice(){if(this._selectedDevice){return this._selectedDevice}return this.selectDeviceOptions.length===1?this.selectDeviceOptions[0]:undefined}async getApplicationsFromDevice(){var e;const t=(e=this.selectedDevice)===null||e===void 0?void 0:e.udid;if(!t){F.warn("Trying to get the apps from the device, but no device is selected",{deviceOptions:this.selectDeviceOptions});return[]}try{if(this.projectsService.isIos){const e=await x.httpRequest.get(`${(0,M.tmaBaseUrl)()}/devices/${t}/bundles`);return e.map((e=>({name:e.name,version:e.version,data:e})))}const e=await x.httpRequest.get(`${(0,M.tmaBaseUrl)()}/devices/${t}/apps`);return e.map((e=>({name:e.name,data:e})))}catch(e){F.error("An error occurred while trying to get the apps from the device",{error:e,device:this.selectDevice})}return[]}async getApplicationsFromStorage(){const e=this.projectsService.defaultAppId;try{const s=this.mobileAppsStore.mobileApps;const i=e?s.sort(t):s;return i.map((e=>{var t,s;return{name:((t=e.appMetadata)===null||t===void 0?void 0:t.name)||e.fileName,version:(s=e.appMetadata)===null||s===void 0?void 0:s.version,data:e}}))}catch(e){F.error("An error occurred while trying to get the apps from the device",{error:e,device:this.selectDevice})}return[];function t(t,s){if(t._id===e){return-1}if(s._id===e){return 1}return 0}}get selectAppOptions(){return(0,T.fromPromise)(this.appSource===R.AppSource.DEVICE?this.getApplicationsFromDevice():this.getApplicationsFromStorage())}get filteredAppOptions(){return this.selectAppOptions.case({fulfilled:e=>e.filter((({name:e})=>(0,_.isEmpty)(this.appsFilterValue)||e.toLowerCase().includes(this.appsFilterValue.toLowerCase()))),pending:()=>[],rejected:()=>[]})}get selectedComponent(){const e=this._selectedComponent;if(this.skip==="device"&&[R.SetupMobileTestState.SELECT_DEVICE,undefined].includes(e)){return R.SetupMobileTestState.SELECT_APP}if(this.skip==="app"&&[R.SetupMobileTestState.SELECT_APP,undefined].includes(e)){return R.SetupMobileTestState.SELECT_DEVICE}return e||R.SetupMobileTestState.SELECT_DEVICE}get titles(){if(this.selectedComponent===R.SetupMobileTestState.SELECT_DEVICE){return{title:"Select a device",subTitle:"Select the device that you want to test on"}}return{title:"Select an application",subTitle:"Select a previously uploaded app to Testim library, an existing app in the device library or upload one manually"}}get maxUploadedSize(){return this.projectsService.projectDefaults.maxMobileAppUploadSize?A.BIG_APP_FILE_SIZE:A.MAX_FILE_SIZE}get isUploadingFile(){return this.uploadingFile}async setupMobileTest(e){this.skip=e;const{scenario:t,testConfig:s}=this.editedTestStore;if(!t){return}const i=await this.modalService.openModal(D.SetupMobileTest).promise;if(!i){return}const{device:o,nativeApp:n}=i;t.update({nativeApp:n});if(!o){return}this.editedTestStore.device=o;if(s===null||s===void 0?void 0:s.os){s.os=`${o.deviceType} ${o.osVersion}`}}async setupMobileTestIfNeeded(){var e;const{nativeApp:t}=(e=this.editedTestStore.scenario)!==null&&e!==void 0?e:{};const{device:s}=this.editedTestStore;if(t&&s){return undefined}const i=(()=>{if(!t&&!s){return undefined}if(t){return"app"}return"device"})();return this.setupMobileTest(i)}abortFileTransfer(){this.abortController.abort()}reset(){this.appSource=R.AppSource.LIBRARY;this._selectedComponent=R.SetupMobileTestState.SELECT_DEVICE;this._selectedDevice=undefined;this.appsFilterValue="";this.devicesFilterValue="";this._selectedApplication=undefined;this.deviceStatusErrorMessage=null;this.uploadingFile=false;this.currentUploadedApp=undefined;this.currentUploadedFile=undefined;this._shouldShowVirtualDevices=undefined}};t.SetupMobileTestStore=L;i([y.observable,o("design:type",typeof(p=typeof R.AppSource!=="undefined"&&R.AppSource)==="function"?p:Object)],L.prototype,"appSource",void 0);i([y.observable,o("design:type",Object)],L.prototype,"deviceStatusState",void 0);i([y.observable,o("design:type",Object)],L.prototype,"deviceStatusErrorMessage",void 0);i([y.observable,o("design:type",typeof(m=typeof R.SetupMobileTestState!=="undefined"&&R.SetupMobileTestState)==="function"?m:Object)],L.prototype,"_selectedComponent",void 0);i([y.observable,o("design:type",String)],L.prototype,"devicesFilterValue",void 0);i([y.observable,o("design:type",String)],L.prototype,"appsFilterValue",void 0);i([y.observable,o("design:type",Object)],L.prototype,"_selectedApplication",void 0);i([y.observable.ref,o("design:type",Object)],L.prototype,"_selectedDevice",void 0);i([y.observable.ref,o("design:type",Object)],L.prototype,"uploadingFile",void 0);i([y.observable.ref,o("design:type",Object)],L.prototype,"currentUploadedApp",void 0);i([y.observable.ref,o("design:type",typeof(g=typeof File!=="undefined"&&File)==="function"?g:Object)],L.prototype,"currentUploadedFile",void 0);i([y.observable.ref,o("design:type",Object)],L.prototype,"error",void 0);i([y.observable.ref,o("design:type",Boolean)],L.prototype,"_shouldShowVirtualDevices",void 0);i([y.observable.ref,o("design:type",typeof(v=typeof R.SkipOption!=="undefined"&&R.SkipOption)==="function"?v:Object)],L.prototype,"skip",void 0);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"agentReady",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"agentStatusLoading",null);i([y.action,o("design:type",Object)],L.prototype,"setAppSource",void 0);i([y.action,o("design:type",Object)],L.prototype,"selectApplication",void 0);i([y.action,o("design:type",Object)],L.prototype,"selectDevice",void 0);i([y.action,o("design:type",Object)],L.prototype,"showVirtualDevices",void 0);i([y.action,o("design:type",Object)],L.prototype,"showPhysicalDevices",void 0);i([y.action,o("design:type",Object)],L.prototype,"changeDevicesFilterValue",void 0);i([y.action,o("design:type",Object)],L.prototype,"changeAppsFilterValue",void 0);i([y.computed,o("design:type",Boolean),o("design:paramtypes",[])],L.prototype,"shouldShowVirtualDevices",null);i([y.computed,o("design:type",Boolean),o("design:paramtypes",[])],L.prototype,"nextButtonDisabled",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"selectDeviceOptions",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"selectedApplication",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"selectedDevice",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"selectAppOptions",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"filteredAppOptions",null);i([y.computed,o("design:type",typeof(S=typeof R.SetupMobileTestState!=="undefined"&&R.SetupMobileTestState)==="function"?S:Object),o("design:paramtypes",[])],L.prototype,"selectedComponent",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"titles",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"maxUploadedSize",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"isUploadingFile",null);i([y.action,o("design:type",Object)],L.prototype,"selectLibrary",void 0);i([y.action,o("design:type",Object)],L.prototype,"selectFromDevice",void 0);i([y.action,o("design:type",Object)],L.prototype,"selectUpload",void 0);i([y.action,o("design:type",Object)],L.prototype,"goToSelectDevice",void 0);i([y.action,o("design:type",Object)],L.prototype,"clearUploadError",void 0);i([y.action,o("design:type",Object)],L.prototype,"discardFile",void 0);i([y.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],L.prototype,"reset",null);t.SetupMobileTestStore=L=i([(0,b.injectable)(),o("design:paramtypes",[typeof(n=typeof C.EditedTestStore!=="undefined"&&C.EditedTestStore)==="function"?n:Object,typeof(r=typeof j.MobileAgentService!=="undefined"&&j.MobileAgentService)==="function"?r:Object,typeof(a=typeof w.MobileAppsStore!=="undefined"&&w.MobileAppsStore)==="function"?a:Object,typeof(c=typeof E.ProjectsService!=="undefined"&&E.ProjectsService)==="function"?c:Object,typeof(l=typeof O.ModalService!=="undefined"&&O.ModalService)==="function"?l:Object,typeof(u=typeof N.FeatureFlagsService!=="undefined"&&N.FeatureFlagsService)==="function"?u:Object,typeof(d=typeof A.MobileFileUploadService!=="undefined"&&A.MobileFileUploadService)==="function"?d:Object])],L)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p;Object.defineProperty(t,"__esModule",{value:true});t.MobileAgentService=void 0;const h=s(6);const f=s(28);const m=s(143);const g=s(15);const v=s(2);const S=s(27);const y=s(9);const b=s(42);const _=s(7);const T=s(67);const E=s(5);const I=s(29);const C=s(20);const D=s(22);const O=s(8);const A=s(513);const j=s(21);const w=s(14);const R=_.Logger.getLogger("MobileAgentService");const P=`${m.TMA_SOCKET_BASE_URL}/events`;const x=30;const M="v0.0.0";let N=class e{constructor(e,t,s,i,o,n){this.projectsService=e;this.modalService=t;this.editedTestStore=s;this.testimServices=i;this.analyticsService=o;this.featureFlagsService=n;this.agentDownloadOptions=[{name:"Download for Mac (x64)",value:"Mac"},{name:"Download for Linux (x64)",value:"Linux"},{name:"Download for Windows (x64)",value:"Windows"}];this.devicesExplicitUpdate=0;this.eventSocketConnectionInterval=null;this.currentRunningVersion=M;this.latestRemoteVersion=M;this.tmaUpgradeAvailable=false;this.defaultAgentDownloadOS=this.agentDownloadOptions.find((e=>e.value===this.userOS))||this.agentDownloadOptions[0];this.stopTryConnectingToSocket=()=>{clearInterval(Number(this.eventSocketConnectionInterval));this.eventSocketConnectionInterval=null};this.isNewerVersion=(e,t)=>e.replace("v","").localeCompare(t.replace("v",""))>0;this.onDownload=async()=>{this.analyticsService.track("agent-indication-download",{osType:this.userOS});const e=await this.testimServices.tmaVersions.getLinkForLatestVersionByPlatform(this.defaultAgentDownloadOS.value,this.projectsService.projectId);(0,C.downloadFile)(`TMA-${this.userOS}-Latest.zip`,e,"application/zip")};this.checkForNewerVersion=async()=>{if(!this.defaultAgentDownloadOS){return}const e=await this.getLatestVersionNumberByPlatform(this.defaultAgentDownloadOS.value);this.latestRemoteVersion=e.version||M;const t=await this.getAgentCapabilities();(0,v.runInAction)((()=>{this.currentRunningVersion=t.version||M;this.tmaUpgradeAvailable=this.isNewerVersion(this.latestRemoteVersion,this.currentRunningVersion)}))};this.getLatestVersionNumberByPlatform=async e=>{const t=await this.testimServices.tmaVersions.getLinkForLatestVersionNumberByPlatform(e,this.projectsService.projectId);try{return await b.httpRequest.get(t)}catch(e){R.warn("failed to get mobile agent capabilities",{error:e});return"Inactive"}};this.startPolling=()=>{this.agentInterval=window.setInterval((()=>{this.agentStatus=(0,S.fromPromise)(this.getAgentStatus(),this.agentStatus)}),5e3)};this.stopPolling=()=>{clearInterval(this.agentInterval);this.agentInterval=undefined};(0,v.reaction)((()=>{var e;return(e=this.agentStatus)===null||e===void 0?void 0:e.value}),(()=>{var e,t,s;const i=((e=this.eventsSocket)===null||e===void 0?void 0:e.readyState)===WebSocket.CLOSED;if(((t=this.agentStatus)===null||t===void 0?void 0:t.value)===A.MobileAgentStatuses.READY&&(!this.eventsSocket||i)){this.tryConnectingToSocket()}if(((s=this.agentStatus)===null||s===void 0?void 0:s.value)===A.MobileAgentStatuses.INACTIVE&&i){this.modalService.openToast(T.Toast,{children:"Agent disconnected",timeout:3e3,icon:{type:"mobile-agent-indicator",backgroundType:"error"}})}}))}get userOS(){return O.utils.getOS().split(" ")[0]}tryConnectingToSocket(){this.connectEventsSocket();const e=Date.now();this.stopTryConnectingToSocket();this.eventSocketConnectionInterval=setInterval((()=>{if(Date.now()-e>12e4){this.stopTryConnectingToSocket();return}this.connectEventsSocket()}),8e3)}disconnectEventsSocket(){var e;(e=this.eventsSocket)===null||e===void 0?void 0:e.close()}connectEventsSocket(){try{this.disconnectEventsSocket();this.eventsSocket=new WebSocket(P);this.eventsSocket.onopen=()=>{this.devicesExplicitUpdate++;this.modalService.openToast(T.Toast,{children:"Agent connected",timeout:3e3,icon:{type:"mobile-agent-indicator",backgroundType:"success"}});this.stopTryConnectingToSocket()};this.eventsSocket.onerror=e=>{R.warn("triggered event socket onerror",{error:e})};this.eventsSocket.onmessage=async e=>{this.onNewSocketEvent(e)}}catch(e){R.warn("failed connecting to events socket",{error:e})}}isAndroidOrIos(e){return e==="android"&&this.projectsService.isAndroid||e==="ios"&&this.projectsService.isIos}onNewSocketEvent(e){var t,s;const{data:i}=e;const{DEVICE_CONNECTED:o,DEVICE_DISCONNECTED:n,LOCAL_STATE_CHANGED:r,CLOUD_STATE_CHANGE:a}=E.commonConstants.MOBILE_SOCKET_EVENTS_TYPES;const c=JSON.parse(i);const l=(s=(t=c===null||c===void 0?void 0:c.data)===null||t===void 0?void 0:t.osType)===null||s===void 0?void 0:s.toLowerCase();const u=l&&this.isAndroidOrIos(l);switch(c.type){case o:this.devicesExplicitUpdate++;if(u){const e=c.data.name.length>23?`${c.data.name.substring(0,23)}...`:c.data.name;this.modalService.openToast(T.Toast,{children:`${e} connected`,timeout:3e3,icon:{type:"phone",backgroundType:"success"}})}break;case n:this.devicesExplicitUpdate++;if(u){this.clearDevice(c.data.udid);const e=c.data.name.length>23?`${c.data.name.substring(0,23)}...`:c.data.name;this.modalService.openToast(T.Toast,{children:`${e} disconnected`,timeout:3e3,icon:{type:"phone",backgroundType:"error"}})}break;case r:case a:if(c.data==="Stopping"&&this.eventSocketConnectionInterval){this.modalService.openToast(T.Toast,{children:"Agent disconnected",timeout:3e3,icon:{type:"mobile-agent-indicator",backgroundType:"error"}});this.stopTryConnectingToSocket()}break;default:break}}clearDevice(e){var t;if(((t=this.editedTestStore.device)===null||t===void 0?void 0:t.udid)===e){this.editedTestStore.device=null}}async getAgentCapabilities(){try{return await b.httpRequest.get(`${(0,m.tmaBaseUrl)()}/capabilities`)}catch(e){R.warn("failed to get mobile agent capabilities",{error:e});return"Inactive"}}async getAgentStatus(){try{return(await b.httpRequest.get(`${(0,m.tmaBaseUrl)()}/status`)).fsmState}catch(e){return"Inactive"}}async getDevices(e){try{const[t,s]=await Promise.all([this.featureFlagsService.flags.enableTvcDeviceRecording.isEnabled()?b.httpRequest.get("https://core.waldo.com/devices").catch((()=>[{deviceAddress:"GalaxyA51-10.0-x86_64@devices.waldo.com",manufacturer:"Samsung",model:"Galaxy A51",osName:"android",osVersion:"10.0",resolution:{width:1080,height:2400},deviceNames:["Galaxy A51"],allocation:"Shared"},{deviceAddress:"iPhone8-16.0-arm64@devices.waldo.com",manufacturer:"Apple",model:"iPhone 8",osName:"ios",osVersion:"16.0",resolution:{width:750,height:1334},deviceNames:["iPhone 8"],allocation:"Shared"},{deviceAddress:"iPhone6s-15.0-arm64@devices.waldo.com",manufacturer:"Apple",model:"iPhone 6s",osName:"ios",osVersion:"15.0",resolution:{width:750,height:1334},deviceNames:["iPhone 6s"],allocation:"Shared"}])):[],b.httpRequest.get(`${(0,m.tmaBaseUrl)()}/devices`)]);const i=t.filter((t=>t.osName.toLowerCase()===e)).map((e=>({from:"TVC",udid:e.deviceAddress,model:e.model,name:e.deviceNames[0]||e.model,deviceType:e.osName==="ios"?"iOS":"Android",osVersion:e.osVersion,scaleFactor:e.osName==="android"?1:2,width:e.resolution.width,height:e.resolution.height,virtual:true})));const o=h.chain(s).uniqBy("udid").filter((t=>t.deviceType.toLowerCase()===e)).map((e=>({from:"TMA",model:e.model,name:e.name,deviceType:e.deviceType,width:e.width,height:e.height,osVersion:e.osVersion,minApiVersion:e.minApiVersion,udid:e.udid,virtual:e.virtual,scaleFactor:e.scaleFactor||1}))).value();return[...o,...i]}catch(e){R.warn("failed to get mobile connected devices",{error:e});return[]}}get agentReadyStatus(){var e;return A.MobileAgentStatuses.READY===((e=this.agentStatus)===null||e===void 0?void 0:e.value)}get agentStatusLoading(){return!this.agentStatus}get devices(){var e;const t=((e=this.projectsService.projectType)!==null&&e!==void 0?e:"").toLowerCase();const s=this.devicesExplicitUpdate;return(0,S.fromPromise)(this.getDevices(t))}get devicesOrEmptyArray(){return this.devices.state==="fulfilled"?this.devices.value:[]}get devicesByType(){const e=[];const t=[];for(const s of this.devicesOrEmptyArray){if(s.virtual){e.push(s)}else{t.push(s)}}return{virtual:e,physical:t}}get isConnectingToSocket(){return Boolean(this.eventSocketConnectionInterval)}async getMirroringInfo(e){e||(e=this.editedTestStore.device);if(!e){return undefined}const{deviceType:t,from:s,udid:i,scaleFactor:o,name:n,osVersion:r,width:a,height:c}=e;const{availHeight:l,availWidth:u}=window.screen;const d=(()=>{const e=200;const t=1e3;const s=l-e;const i=u-t;if(!c||!a){const e=Math.min(s,i);return{width:e,height:e}}const o=s/c;const n=i/a;const r=Math.min(o,n);return{width:a*r,height:c*r}})();const p=Math.round(d.width);const h=Math.round(d.height)+x;const f={width:a,height:c,deviceType:t,from:s,udid:encodeURIComponent(i),scaleFactor:o,name:n,osVersion:r};const m=JSON.stringify(f);return{url:`chrome-extension://${E.commonConstants.TESTIM_EXTENSION_ID}/mobileMirror/index.html?state=${m}`,width:p,height:h}}};t.MobileAgentService=N;i([v.observable.ref,o("design:type",Object)],N.prototype,"device",void 0);i([v.observable.ref,o("design:type",typeof(d=typeof S.IPromiseBasedObservable!=="undefined"&&S.IPromiseBasedObservable)==="function"?d:Object)],N.prototype,"agentStatus",void 0);i([v.observable,o("design:type",Object)],N.prototype,"devicesExplicitUpdate",void 0);i([v.observable,o("design:type",Object)],N.prototype,"eventSocketConnectionInterval",void 0);i([v.observable,o("design:type",String)],N.prototype,"currentRunningVersion",void 0);i([v.observable,o("design:type",String)],N.prototype,"latestRemoteVersion",void 0);i([v.observable,o("design:type",Object)],N.prototype,"tmaUpgradeAvailable",void 0);i([v.observable,o("design:type",Object)],N.prototype,"defaultAgentDownloadOS",void 0);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"agentReadyStatus",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"agentStatusLoading",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"devices",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"devicesOrEmptyArray",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"devicesByType",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"isConnectingToSocket",null);t.MobileAgentService=N=i([(0,y.injectable)(),o("design:paramtypes",[typeof(n=typeof g.ProjectsService!=="undefined"&&g.ProjectsService)==="function"?n:Object,typeof(r=typeof f.ModalService!=="undefined"&&f.ModalService)==="function"?r:Object,typeof(a=typeof I.EditedTestStore!=="undefined"&&I.EditedTestStore)==="function"?a:Object,typeof(c=typeof D.TestimServicesApi!=="undefined"&&D.TestimServicesApi)==="function"?c:Object,typeof(l=typeof j.AnalyticsService!=="undefined"&&j.AnalyticsService)==="function"?l:Object,typeof(u=typeof w.FeatureFlagsService!=="undefined"&&w.FeatureFlagsService)==="function"?u:Object])],N)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E,I,C,D;Object.defineProperty(t,"__esModule",{value:true});t.RecordingStore=void 0;const O=s(6);const A=s(66);const j=s(9);const w=s(2);const R=s(29);const P=s(62);const x=s(5);const M=s(7);const N=s(33);const F=s(21);const L=s(28);const k=s(576);const B=s(15);const U=s(579);const G=s(14);const V=s(8);const H=s(20);const $=s(26);const W=s(85);const J=s(73);const Y=s(128);const z=s(34);const q=s(80);const X=s(63);const Z=s(112);const Q=s(233);const K=s(60);const ee=s(49);const te=s(160);const se=s(104);const ie=s(45);const oe=s(55);const ne=s(48);const re=s(110);const ae=s(91);const ce=s(668);const le=s(87);const ue=s(82);const de=s(312);const pe=M.Logger.getLogger("RecordingStore");const he=["group","annotation","user-code","validation-code-step","wait-for-code-step","action-code-step","mouse","network-validation-step","cli-validation-code-step","cli-wait-for-code-step","cli-action-code-step","cli-validation-download-file","cli-wait-for-download-file","simple-ui-verification","android-device-key","wait-for-simple-ui-verification","email-validation-step","email-generator","shared-step-instance","scroll","android-key-board-special-keys","android-swipe","android-tap","android-long-click","ios-long-click","ios-device-key","ios-key-board-special-keys","ios-swipe","ios-tap","text-validation","select-option","text","navigation","wait-for-text-validation","resize-window","element-validation","negative-element-validation","wait-for-element-validation","wait-for-negative-element-validation",re.ConditionType.CUSTOM,"cli-condition-step","input-file","drop-file","hover","wheel","special-key","extract-text","sleep","api-validation","api-action","set-cookie","random-value-generator","date-generator","generate-random-field","css-prop-validation","html-attr-validation","accessibility-validation-step","debug-lab-feature","salesforce-apex-action","accessibility-validation-shared-step","marketplace-wrapper","sfdc-step-apex-action","execute-driver-script","sfdc-internal-test-step"];let fe=class e extends N.EventEmitter{constructor(e,t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v,S){super();this.editedTestStore=e;this.hostService=t;this.projectsService=s;this.analyticsService=i;this.userService=o;this.modalService=n;this.featureFlagsService=r;this.mobileRecordingService=a;this.restrictToChrome=c;this.urlStateService=l;this.productTourService=u;this.branchesService=d;this.editorSelectionService=p;this.notificationDisplayService=h;this.revisionsService=f;this.propertyPanelStore=m;this.playbackStore=g;this.premiumFeaturesService=v;this.setupMobileTestStore=S;this.isRecording=false;this._shouldHighlightElementsInMobile=true;this._isRecordPending=false;this.editedTestStore.on(x.commonConstants.scenario.ADD_STEP,(()=>this.updateAUTStepsCount()));this.editedTestStore.on(x.commonConstants.scenario.TEST_SAVED,(()=>this.fixUrlAfterSave()))}get insertionContainer(){if(this._insertionPoint){return this._insertionPoint.parentStep||this.editedTestStore.scenario}return this._insertionContainer||this.editedTestStore.scenario}set insertionContainer(e){if(this._insertionContainer&&(e===null||e===void 0?void 0:e.id)===this._insertionContainer.id){return}this.insertionPoint=undefined;this._insertionContainer=e;this.hostService.activeHost.sendAsync(x.commonConstants.scenario.PURGE_LAST_STEP_DATA)}get insertionPoint(){return this._insertionPoint}set insertionPoint(e){this._insertionPoint=e;this.hostService.activeHost.sendAsync(x.commonConstants.scenario.PURGE_LAST_STEP_DATA)}get shouldHighlightElementsInMobile(){return this._shouldHighlightElementsInMobile}toggleShouldHighlightElementsInMobile(){this._shouldHighlightElementsInMobile=!this._shouldHighlightElementsInMobile}stopRecording(e){var t;if(e){this.analyticsService.testRecord({...e,testId:(t=this.editedTestStore.test)===null||t===void 0?void 0:t.id})}this.hostService.activeHost.sendAsync(x.commonConstants.scenario.STOP_RECORDING)}getInsertionIndex(e=this.insertionContainer){if(!e){return 0}const t=e.getStepContent();return this.insertionPoint?t.findStepIndex(this.insertionPoint):t.length}async checkStartUrl({analyticsEventSource:e,defaultUrl:t}){let s;if(this.editedTestStore.currentBaseUrlWithFallback){s={baseUrl:this.editedTestStore.currentBaseUrlWithFallback}}else{const i=(0,H.isPlaygroundModeState)(this.urlStateService);if(i){this.analyticsService.track("playground-base-url",{eventSource:e})}s=await this.modalService.openModal(k.TestUrlModal,{title:"START A NEW TEST",defaultUrl:t,showRememberUrl:true,blackMode:i}).promise}if(!s){throw new Error("Missing base url")}const i=V.utils.fixUrl(s.baseUrl);if(this.editedTestStore.scenario){this.editedTestStore.scenario.baseUrl=i}if(this.editedTestStore.test){this.editedTestStore.test.baseUrl=i}this.trigger(x.commonConstants.scenario.SET_BASE_URL_MANUALLY);this.analyticsService.track("set-base-url");if(i&&s.saveTestUrlAsDefault){await this.projectsService.saveDefaultUrl(i)}if(!i){throw new Error("Missing base url")}return i}async shouldDeviceReadinessBlockRecording(){var e;if(!this.featureFlagsService.flags.checkDeviceStatus.isEnabled()){return}const{nativeApp:t}=(e=this.editedTestStore.scenario)!==null&&e!==void 0?e:{};const{device:s}=this.editedTestStore;if(!s||!t){return}const i=await this.setupMobileTestStore.checkIfDeviceReadyForInteractions(s);if(!i){return}this.modalService.openModal(ie.MessageModal,{variety:"error",title:"Could not record",body:i.message,hideFooter:true});throw new Error("could not record test due to device readiness")}async prepareForRecording({onlyLocalReporting:e,analyticsEventSource:t,defaultUrl:s}){await this.shouldDeviceReadinessBlockRecording();this._isRecordPending=!this.editedTestStore.test;if(this.projectsService.isWeb){await this.checkStartUrl({analyticsEventSource:t,defaultUrl:s});return this.buildStartRecordObject(e)}if(this.projectsService.isMobile){return await this.mobileRecordingService.getConfig()}throw new Error(`invalid project type: ${this.projectsService.projectType}`)}buildStartRecordObject(e=false){var t,s,i;const{isMobileWeb:o,resolution:n,mobileEmulation:r}=this.editedTestStore.testConfig;const a=((t=this.editedTestStore.test)===null||t===void 0?void 0:t.baseUrl)||x.commonConstants.defaults.DEFAULT_PAGE_URL;const c=parseFloat(window.getComputedStyle(document.documentElement).zoom);const l=window.self!==window.top;const u=()=>{const e=Number(n===null||n===void 0?void 0:n.height);if(l){return e}let t=window.outerHeight-Math.round(window.innerHeight*c);if(o&&this.featureFlagsService.flags.mobileWebOpenTabAsPopup.isEnabled()){t=x.commonConstants.mobileWeb.MOBILE_WEB_DEBUGGER_HEADER_SPACING}return e+Math.max(t,0)};const d=()=>{const e=Number(n===null||n===void 0?void 0:n.width);if(l){return e}let t=window.outerWidth-Math.round(window.innerWidth*c);if(o&&this.featureFlagsService.flags.mobileWebOpenTabAsPopup.isEnabled()&&V.utils.isWindows()){t=x.commonConstants.mobileWeb.MOBILE_WEB_DEBUGGER_HEADER_VERTICAL_SPACING_WINDOWS}return e+Math.max(t,0)};return{resolution:{height:u(),width:d()},startUrl:a,isMobileWeb:o,mobileEmulation:r,featureFlags:this.getRecordingFeatureFlags(o),isNewTest:((s=this.editedTestStore.scenario)===null||s===void 0?void 0:s.isNew)&&((i=this.editedTestStore.scenario)===null||i===void 0?void 0:i.steps.length)===0,showRecordingPopup:this.showRecordingPopup(),onlyLocalReporting:e}}getRecordingFeatureFlags(e=false){return{recordUploadToDocumentFragment:this.featureFlagsService.flags.recordUploadToDocumentFragment.isEnabled(),recordNetworkEffects:this.featureFlagsService.flags.recordNetworkEffects.isEnabled(),showStepCounter:true,recordNthOfTypeWithChildLocators:this.featureFlagsService.flags.recordNthOfTypeWithChildLocators.isEnabled(),mobileWebOpenTabAsPopup:e&&this.featureFlagsService.flags.mobileWebOpenTabAsPopup.isEnabled(),attachDebuggerOnRecord:this.featureFlagsService.flags.attachDebuggerOnRecord.isEnabled(),useCDPScreencast:this.featureFlagsService.flags.useCDPScreencast.isEnabled(),useFullParentPathForChildSelectors:this.featureFlagsService.flags.useFullParentPathForChildSelectors.isEnabled(),salesForceSelectrorFix:this.featureFlagsService.flags.salesForceSelectrorFix.isEnabled(),customTagScore:this.featureFlagsService.flags.customTagScore.isEnabled(),ignoreHiddenTagsText:Boolean(this.premiumFeaturesService.premiumFeatures.ignoreHiddenTagsText),salesforceSfdc:this.premiumFeaturesService.isTtaSfdcEnabled,sfdcDocumentValidation:this.featureFlagsService.flags.sfdcDocumentValidationStep.isEnabled()}}showRecordingPopup(){var e;if(!this.featureFlagsService.flags.recordingMessage.isEnabled()){return true}const t=(e=this.editedTestStore.test)===null||e===void 0?void 0:e.id;if(this.lastAutPopupTestId!==t){this.lastAutPopupTestId=t;return true}return!this.hostService.activeHost.hasEditorTabs}getStepCount(e=this.editedTestStore.scenario){if(!e){return 0}try{return Array.from(e.getStepContent()).map((({step:e})=>e)).filter((e=>!e.isGroupStep)).length}catch(e){if((e===null||e===void 0?void 0:e.code)===x.commonConstants.error.CIRCULAR_SCENARIO_DETECTED){return 1}}return undefined}async updateAUTStepsCount(){if(!this.insertionContainer){return}const e=this.getStepCount();await this.hostService.activeHost.sendAsync(x.commonConstants.AUT.REPORT_STEPS_COUNT,{count:e})}async startRecording({analyticsEventSource:e,recordType:t,defaultUrl:s,onlyLocalReporting:i}){var o,n;await this.restrictToChrome.restrict();await this.hostService.activeHost.canRecord();this.playbackStore.isLocalRunning=false;let r;try{r=await this.prepareForRecording({onlyLocalReporting:i,analyticsEventSource:e,defaultUrl:s});if(!r){return}}catch(e){pe.warn("error creating recording config",{e:e});return}if(e){const s={};if(this.projectsService.isMobile){s.deviceSource=((o=this.setupMobileTestStore.selectedDevice)===null||o===void 0?void 0:o.virtual)?"virtual":"physical";s.appSource=this.setupMobileTestStore.appSource}this.analyticsService.testRecord({eventSource:e,recordType:t,testId:(n=this.editedTestStore.test)===null||n===void 0?void 0:n.id,...s})}this.productTourService.startTourOncePerNewUser(J.TOUR_NAMES.START_PLAYING);if(!this._isRecordPending){this.hostService.activeHost.initBackgroundState();await this.hostService.activeHost.send(x.commonConstants.scenario.START_RECORDING,r);this.hostService.activeHost.sendAsyncBG(x.commonConstants.scenario.TOGGLE_HIGHLIGHT_MOBILE,this.shouldHighlightElementsInMobile)}}async toggleRecording({analyticsEventSource:e,defaultUrl:t="",onlyLocalReporting:s=false}){this.playbackStore.isRemoteRunning=false;this.playbackStore.isLocalCliRun=false;await this.restrictToChrome.restrict();if(this.isRecording){this.stopRecording({recordType:"stopRecord",eventSource:"toolbar-stop-record"});return}if(this.playbackStore.isPlaying){this.modalService.openModal(ie.MessageModal,{variety:"error",title:"Test is being played",body:"Stop test playback before start recording",hideFooter:true});return}this.startRecording({analyticsEventSource:e,recordType:"startRecord",defaultUrl:t,onlyLocalReporting:s})}async startRecordingAtStep(e){const t=(0,H.isPlaygroundModeState)(this.urlStateService);const s=t?"record-from-here-playground":"record-from-here";const i=t?"startRecordAtPositionPlayground":"startRecordAtPosition";this.startRecording({analyticsEventSource:s,recordType:i,onlyLocalReporting:t});if(e){this.insertionPoint=e}else{const e=this.insertionContainer;this.insertionContainer=e;this.insertionPoint=undefined}}async openAut({overrideBaseUrl:e,onlyLocalReporting:t}){if(this.projectsService.isMobile){try{const e=await this.mobileRecordingService.getConfig();this.hostService.activeHost.sendAsync(x.commonConstants.mobile.OPEN_APP,e)}catch(e){}return}const{startUrl:s,resolution:i,isMobileWeb:o,mobileEmulation:n,featureFlags:r}=this.buildStartRecordObject(t);const a={...i,url:e||s};await this.hostService.activeHost.canRecord();try{const e={windowProps:a,isMobileWeb:o,mobileEmulation:n,featureFlags:r};await this.hostService.activeHost.sendAsync(x.commonConstants.scenario.OPEN_AUT,e)}catch(e){}}startRecordingOnTestLoaded(){if(this._isRecordPending){this._isRecordPending=false;this.startRecording({})}}checkForCircularSteps(e,t){var s,i;const o=e?(s=this.editedTestStore.scenario)===null||s===void 0?void 0:s.findStepById(e,true):this.editedTestStore.scenario;if(!(o===null||o===void 0?void 0:o.getStepContent().isGroupStep)){pe.error(`cannot insert step into parent ${e}`);return}const n=this.revisionsService.sharedStepsInfo[t.sharedStepInfoId];if(t instanceof ae.SharedStepInstance&&[n===null||n===void 0?void 0:n.sharedStepClassId,(i=n===null||n===void 0?void 0:n.sharedStepClass)===null||i===void 0?void 0:i.id].includes(e)){throw new Z.CircularStepReferenceError([o.id])}o.getStepContent().addStep(t,0);const r=e=>{const t=e.getStepContent();return t instanceof le.GroupStep?t.steps:[]};const a=e=>{var t;return(t=r(e))===null||t===void 0?void 0:t.some((e=>{var t;return((t=e.sharedStepClass)===null||t===void 0?void 0:t.id)===o.id}))};try{const{path:e}=(0,Q.bfs)(o,r,a);const t=[...e.reverse(),o].map((e=>e.getDisplayName()));throw new Z.CircularStepReferenceError(t)}catch(e){o.getStepContent().removeStepAt(0);if(e instanceof Z.CircularStepReferenceError){throw e}}}async addStep({stepData:e,parentId:t,position:s,throwOnCircularReference:i}){var o,n;if(!e){pe.error("add step handler: step was not provided");return undefined}const r=K.stepBuilder.buildStepFromData(e);if(r instanceof de.MobileStep){const e=(o=this.editedTestStore.scenario)===null||o===void 0?void 0:o.nativeApp;const t=e===null||e===void 0?void 0:e.appMetadata;if(t){r.recordedApp={...O.pick(t,"name","version","activity","minOsVersion"),fileSize:e.fileSize}}const{device:s}=this.editedTestStore;if(s){r.recordedDevice=O.pick(s,"name","osVersion")}}await this.revisionsService.synchronizeAllStep(r);t||(t=(n=this.insertionContainer)===null||n===void 0?void 0:n.id);return this.addStepWithoutSync({step:r,parentId:t,position:s,throwOnCircularReference:i})}addStepWithoutSync({step:e,parentId:t,position:s,throwOnCircularReference:i}){var o;if(!t){t=this.insertionContainer.id;s=typeof s==="number"?s:this.getInsertionIndex(this.insertionContainer)}else{s=typeof s==="number"?s:this.getInsertionIndex((o=this.editedTestStore.scenario)===null||o===void 0?void 0:o.findStepById(t,true))}try{this.checkForCircularSteps(t,e);return this.editedTestStore.addStep(e,t,s)}catch(e){if(i&&e instanceof Z.CircularStepReferenceError){throw e}this.notificationDisplayService.sendNotification(e instanceof Z.CircularStepReferenceError?"Adding this group is not allowed, as it creates a circular reference.":"Failed to add step");pe.warn("Failed to add step",e);return undefined}}updateStep(e,t){if(!e){return undefined}const s=this.editedTestStore.updateStepById(e,t);this.updateAUTStepsCount();this.trigger(x.commonConstants.scenario.UPDATE_STEP_MANUALLY,s);return s}deleteSteps(e){e=O.castArray(e);const t=e.map((e=>{var t;return(t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.findStepById(e,true)})).filter(Boolean);this._deleteSteps(t)}_deleteSteps(e){const t=e.map((e=>e.id));let s;let i=-1;if(this.insertionContainer&&t.includes(this.insertionContainer.id)){this.insertionContainer=undefined}else if(this.insertionPoint&&t.includes(this.insertionPoint.id)){s=this.insertionContainer;i=this.getInsertionIndex()}this.editorSelectionService.deselectDeletedSteps(t);this.editedTestStore.deleteSteps(e);if(i>=0){this.insertionPoint=s.steps[i]}this.updateAUTStepsCount();this.trigger(x.commonConstants.scenario.DELETE_STEP_MANUALLY,t)}async clearTestAndReload({isInEditorContext:e}={}){const{projectId:t,branch:s,testId:i,stepId:o,path:n}=this.urlStateService.params;this.editedTestStore.reset();if(e&&this.featureFlagsService.flags.saveEditorContextOnBranchChange.isEnabled()){this.branchesService.setBranchChangedInEditorContext(true);if(o){this.urlStateService.go(A.testWithStepPath(t,s,i,o,n))}else{this.urlStateService.go(A.test(t,s,i))}}else{this.urlStateService.go(A.test(t,s,i))}await(0,w.when)((()=>Boolean(this.editedTestStore.test)))}async openStepInEditor(e){if(!this.isStepEditable(e)){this.openPropertyPanelForWhitelistedStepsWhenInEditor(e);return}if(this.tryOpenUiValidationStepEditor(e)){return}if(e.getStepContent().isGroupStep){this.editorSelectionService.clearSelection()}const t=this.urlStateService.searchParams["result-id"];const s=e.id;const i=this.urlStateService.params.path;const o=this.urlStateService.searchParams["shared-step-instance"];const n=this.urlStateService.hooksParams;const r=n.hook?this.urlStateService.searchParams["iteration-id"]:undefined;this.urlStateService.go(A.testResultWithStepPath(this.projectsService.projectId,this.branchesService.branch,this.editedTestStore.testId,e.id,V.utils.getNewPathForParamInStep(i,s),t,r,o,n))}openPropertyPanelForWhitelistedStepsWhenInEditor(e){if(!(e===null||e===void 0?void 0:e.type)||!(0,H.isInEditor)(this.urlStateService.pathTemplate)){return}this.editorSelectionService.setSelection({step:e,select:true});this.propertyPanelStore.isOpen=true}isStepEditable(e){var t;if(!(e===null||e===void 0?void 0:e.type)){return false}if(e instanceof ae.SharedStepInstance&&e.sharedStepClass instanceof ce.MarketplaceWrapperStep){return(t=e.sharedStepClass)===null||t===void 0?void 0:t.canEditStep(e,this.userService.isAdmin())}return he.includes(e.getType())}tryOpenUiValidationStepEditor(e){var t;if(!V.utils.isUiVerificationStep(e.type)){return false}if(((t=e.result)===null||t===void 0?void 0:t.errorType)&&e.result.errorType===x.commonConstants.stepResult.PIXEL_VALIDATION_INCORRECT_CREDENTIALS){this.notificationDisplayService.sendNotification("Cant open Applitools because of incorrect credentials");return false}if(!e.getStepEditorUrl()){return false}const s=window.open(`${e.getStepEditorUrl()}&hooks=baselineUpdate`,"_blank","noopener");try{s===null||s===void 0?void 0:s.window.focus();return true}catch(e){return false}}getUpdatedStepId(e){var t,s;return((t=this.stepsBeforeSave)===null||t===void 0?void 0:t[e])||((s=this.editedTestStore.scenario)===null||s===void 0?void 0:s.findStepByProperty("previousStepId",e))}clearUpdatedStepIdsAfterUrlUpdate(){this.stepsBeforeSave=null}handleBeforeSave(){if(!this.editedTestStore.scenario){return}if(!this.editedTestStore.isLatestVersion){this.editedTestStore.scenario.setDirty()}this.stepsBeforeSave=[...this.editedTestStore.scenario].reduce(((e,{step:t,sharedStep:s})=>Object.assign(e,{[t.id]:t,[(s===null||s===void 0?void 0:s.id)||""]:s})),{})}fixUrlAfterSave(){const e=()=>{var e;const t=(e=this.urlStateService.params.path)!==null&&e!==void 0?e:"";const s=t.split(":").filter(Boolean).map((e=>{const t=this.getUpdatedStepId(e);return(t===null||t===void 0?void 0:t.id)||e})).filter(Boolean);return s.join(":")};const t=this.urlStateService.params.stepId;if((0,H.isInEditor)(this.urlStateService.pathTemplate)&&t){const s=this.getUpdatedStepId(t);const i=(s===null||s===void 0?void 0:s.id)||t;this.urlStateService.updateParams({stepId:i,path:e()});this.clearUpdatedStepIdsAfterUrlUpdate()}}addLabelToTest(e,t){if(!this.editedTestStore.test||this.editedTestStore.test.id!==e.id){return}const{labels:s=[]}=this.editedTestStore.test;if(s.includes(t)){return}s.push(t);this.editedTestStore.updateTestAndTrigger({labels:s})}removeLabelFromTest(e,t){if(!this.editedTestStore.test||this.editedTestStore.test.id!==e.id){return}const{labels:s=[]}=this.editedTestStore.test;const i=s.filter((e=>e!==t));this.editedTestStore.updateTestAndTrigger({labels:i})}toggleHighlightElements(){this.toggleShouldHighlightElementsInMobile();this.hostService.activeHost.sendAsyncBG(x.commonConstants.scenario.TOGGLE_HIGHLIGHT_MOBILE,this.shouldHighlightElementsInMobile)}};t.RecordingStore=fe;i([w.observable.ref,o("design:type",Object)],fe.prototype,"_insertionContainer",void 0);i([w.observable.ref,o("design:type",Object)],fe.prototype,"_insertionPoint",void 0);i([w.observable.ref,o("design:type",Object)],fe.prototype,"isRecording",void 0);i([w.observable.ref,o("design:type",Object)],fe.prototype,"_shouldHighlightElementsInMobile",void 0);i([w.computed,o("design:type",Object),o("design:paramtypes",[Object])],fe.prototype,"insertionContainer",null);i([w.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],fe.prototype,"addStepWithoutSync",null);i([w.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],fe.prototype,"deleteSteps",null);i([w.action,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],fe.prototype,"_deleteSteps",null);t.RecordingStore=fe=i([(0,j.injectable)(),(0,ne.exposeGlobally)("recordingStore"),o("design:paramtypes",[typeof(n=typeof R.EditedTestStore!=="undefined"&&R.EditedTestStore)==="function"?n:Object,typeof(r=typeof P.HostService!=="undefined"&&P.HostService)==="function"?r:Object,typeof(a=typeof B.ProjectsService!=="undefined"&&B.ProjectsService)==="function"?a:Object,typeof(c=typeof F.AnalyticsService!=="undefined"&&F.AnalyticsService)==="function"?c:Object,typeof(l=typeof ee.UserService!=="undefined"&&ee.UserService)==="function"?l:Object,typeof(u=typeof L.ModalService!=="undefined"&&L.ModalService)==="function"?u:Object,typeof(d=typeof G.FeatureFlagsService!=="undefined"&&G.FeatureFlagsService)==="function"?d:Object,typeof(p=typeof U.MobileRecordingService!=="undefined"&&U.MobileRecordingService)==="function"?p:Object,typeof(h=typeof Y.RestrictToChrome!=="undefined"&&Y.RestrictToChrome)==="function"?h:Object,typeof(f=typeof $.UrlStateService!=="undefined"&&$.UrlStateService)==="function"?f:Object,typeof(m=typeof W.ProductTourService!=="undefined"&&W.ProductTourService)==="function"?m:Object,typeof(g=typeof z.BranchesService!=="undefined"&&z.BranchesService)==="function"?g:Object,typeof(v=typeof q.EditorSelectionService!=="undefined"&&q.EditorSelectionService)==="function"?v:Object,typeof(S=typeof X.NotificationDisplayService!=="undefined"&&X.NotificationDisplayService)==="function"?S:Object,typeof(y=typeof Z.RevisionsService!=="undefined"&&Z.RevisionsService)==="function"?y:Object,typeof(b=typeof te.PropertyPanelStore!=="undefined"&&te.PropertyPanelStore)==="function"?b:Object,typeof(_=typeof se.PlaybackStore!=="undefined"&&se.PlaybackStore)==="function"?_:Object,typeof(T=typeof oe.PremiumFeaturesService!=="undefined"&&oe.PremiumFeaturesService)==="function"?T:Object,typeof(E=typeof ue.SetupMobileTestStore!=="undefined"&&ue.SetupMobileTestStore)==="function"?E:Object])],fe)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h;Object.defineProperty(t,"__esModule",{value:true});t.ProductTourService=void 0;const f=s(6);const m=s(149);const g=s(148);const v=s(207);const S=s(9);const y=s(2);const b=s(49);const _=s(14);const T=s(73);const E=s(7);const I=s(26);const C=s(39);const D=s(34);const O=s(21);const A=s(159);const j=s(48);const w=s(160);const R=E.Logger.getLogger("product-tour-service");const P="tst-product-tour";let x=class e{constructor(e,t,s,i,o,n,r,a){this.userService=e;this.featureFlagsService=t;this.urlStateService=s;this.companiesService=i;this.branchesService=o;this.labFeaturesService=n;this.analyticsService=r;this.propertyPanelStore=a;this.currentTours={}}saveCurrentStateToStorage(){var e;const t=Object.keys((e=this.currentTours)!==null&&e!==void 0?e:{}).filter((e=>T.TOURS[e].relaunchOnRefresh)).reduce(((e,t)=>{e[t]=this.currentTours[t];return e}),{});localStorage.setItem(P,JSON.stringify(t))}startFromCurrentState(){const e=f.chain(this.currentTours).keys().first().value();if(e){this.startTourFromCurrentPoint(e)}}startFromLocalStorage(){this.currentTours=this.getFromLocalStorage();this.startFromCurrentState()}startTourFromCurrentPoint(e){if(!e||!Object.keys(T.TOURS).includes(e)){R.error(`The tour ${e} does not exists or is missing`);return}this.playStep(e)}startTourFromBeginning(e){if(!e||!Object.keys(T.TOURS).includes(e)){R.error(`The tour ${e} does not exists or is missing`);return}this.currentTours=this.getFromLocalStorage();this.currentTours[e]=0;this.playStep(e)}isAbleToPlayTour(){return f.isEmpty(this.currentTours)}isTourRunning(e){var t;return e in((t=this.currentTours)!==null&&t!==void 0?t:{})}startTourOncePerNewUser(e,t={}){const s=this.userService.getProductTour(e);if(s){f.merge(s,t);this.startTourFromBeginning(e);this.userService.completeProductTour(e)}}startTourOncePerUser(e,t={}){const s=this.userService.getProductTour(e);if(s===false){return false}f.merge(T.TOURS[e]||{},t);this.startTourFromBeginning(e);this.userService.completeProductTour(e);return true}getTourState(e){return this.userService.getProductTour(e)}stopTour(e,t){var s;if(((s=this.currentStep)===null||s===void 0?void 0:s.tourName)!==e){return}this.track(t||"stopped-tour");delete this.currentTours[e];this.currentStep=undefined;this.saveCurrentStateToStorage()}nextStep(e){if(!e||!Object.keys(T.TOURS).includes(e)){throw new Error("missing tour name")}if(this.currentTours[e]===undefined){return}this.currentTours[e]+=1;this.track("completed-step");if(this.currentTours[e]<=T.TOURS[e].steps.length-1){this.playStep(e)}if(this.currentTours[e]===T.TOURS[e].steps.length&&T.TOURS[e].autoStop){this.stopTour(e,"completed-tour")}}prevStep(e){if(!e||!Object.keys(T.TOURS).includes(e)){throw new Error("missing tour name")}if(this.currentTours[e]===undefined){return}if(this.currentTours[e]>0){this.currentTours[e]-=1;this.playStep(e)}}getStep(){return this.currentStep}endCurrentStep(){var e,t,s,i;if(!((e=this.currentStep)===null||e===void 0?void 0:e.tourName)){return}if((i=(s=(t=this.currentStep)===null||t===void 0?void 0:t.context)===null||s===void 0?void 0:s.endStepArgs)===null||i===void 0?void 0:i.closePanel){this.propertyPanelStore.isOpen=false}this.nextStep(this.currentStep.tourName)}track(e,t){var s,i,o,n;if(!((s=this.currentStep)===null||s===void 0?void 0:s.tourName)){return}if(!((i=this.currentStep)===null||i===void 0?void 0:i.analyticsTag)){return}const r={action:e,tourName:(o=this.currentStep)===null||o===void 0?void 0:o.tourName,stepName:(n=this.currentStep)===null||n===void 0?void 0:n.analyticsTag,...t};this.analyticsService.track("product-tour-interaction",r)}playStep(e){if(!this.featureFlagsService.flags.newProductTour.isEnabled()){return}Object.keys(this.currentTours).forEach((t=>{if(t!==e){delete this.currentTours[t]}}));const t=this.currentTours[e]!==undefined?this.currentTours[e]:0;R.log("start playing step for tour",{tourName:e,currentStepNum:t,toursFromLocalStorage:this.getFromLocalStorage()});this.currentTours[e]=t;this.saveCurrentStateToStorage();this.gotoStep(e,t)}gotoStep(e,t){this.currentStep={...T.TOURS[e].steps[t],tourName:e}}getFromLocalStorage(){try{const e=JSON.parse(localStorage.getItem(P)||"{}");if(f.isObject(e)){return e}return{}}catch{return{}}}triggerFirstTestTour(e,t,s){if(!s&&!this.calculateShouldShowFirstTestTour(t)){return false}const{isFirstUser:i,notFirstUser:o}=T.FirstTourMessages;const n={isFirstUser:{message:i,selector:`.${v.default.container} .${v.default.row}:nth-child(1)`,extraTooltipStyles:{marginTop:"25px",width:"222px"},trigger:"dblclick"},notFirstUser:{message:o,selector:`.${m.default.appHeader} .${g.default.buttons} button:last-child`,extraTooltipStyles:{marginTop:"15px",width:"222px"},trigger:"click"}};const r=e&&!s?"isFirstUser":"notFirstUser";const{message:a,selector:c,extraTooltipStyles:l,trigger:u}=n[r];const d={steps:[{selector:c,extraTooltipStyles:l,trigger:u,message:a}]};this.startTourOncePerUser(T.TOUR_NAMES.FIRST_TEST,d);return true}calculateShouldShowFirstTestTour(e){var t,s;const{inviteToCompany:i}=this.urlStateService.params;const o=!f.isEmpty(i);if(this.companiesService.isTtaForSalesforceApp){return false}let n=Boolean(o||e);if(n){n=this.labFeaturesService.isFeatureAvailableForProject("PREnhancements")?!((t=this.branchesService.getBranchData(this.branchesService.branch))===null||t===void 0?void 0:t.isReadOnly):!((s=this.branchesService.mainBranch)===null||s===void 0?void 0:s.isReadOnly)}return n}shouldStartToursForManagersAndDevelopers(){return this.calculateShouldShowFirstTestTour(this.userService.isNew())}getFirstStepWithLocators(e){if(!e){return null}return e.scenario.steps.find((e=>e.getElementLocators().length!==0))}};t.ProductTourService=x;i([y.observable.shallow,o("design:type",Object)],x.prototype,"currentStep",void 0);t.ProductTourService=x=i([(0,S.injectable)(),(0,j.exposeGlobally)("productTourService"),o("design:paramtypes",[typeof(n=typeof b.UserService!=="undefined"&&b.UserService)==="function"?n:Object,typeof(r=typeof _.FeatureFlagsService!=="undefined"&&_.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof I.UrlStateService!=="undefined"&&I.UrlStateService)==="function"?a:Object,typeof(c=typeof C.CompaniesService!=="undefined"&&C.CompaniesService)==="function"?c:Object,typeof(l=typeof D.BranchesService!=="undefined"&&D.BranchesService)==="function"?l:Object,typeof(u=typeof A.LabFeaturesService!=="undefined"&&A.LabFeaturesService)==="function"?u:Object,typeof(d=typeof O.AnalyticsService!=="undefined"&&O.AnalyticsService)==="function"?d:Object,typeof(p=typeof w.PropertyPanelStore!=="undefined"&&w.PropertyPanelStore)==="function"?p:Object])],x)},,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.GroupStep=void 0;const n=s(6);const r=s(7);const a=s(8);const c=s(2);const l=s(111);const u=s(5);const d=s(110);const p=r.Logger.getLogger("group-step");const h=1e3;class f extends l.ParameterStep{constructor(e,t){super(e,t);this.steps=[];this.name=`group ${a.utils.nextId()}`}_update(e){var t;if(!e){return this}if(e.name){this.name=e.name}let s;let i;if(e.steps&&this.steps.length){const o=e.steps;let n;for(s=0,i=o.length;s<i;++s){n=o[s];(t=this.findStepById(n.id))===null||t===void 0?void 0:t.update(n)}}if(e.applitoolsStepIds){this.applitoolsStepIds=e.applitoolsStepIds}return super._update(e)}getIcon(){return"folder"}getDisplayName(){return this.name}getTestimDocsUrl(){return u.commonConstants.documentationUrls.GROUPS}findStepIndex(e){return n.findIndex(this.steps,e)}getStepPath(e,t=[]){const s=this.steps.map((s=>s.getStepPath(e,t))).find(Boolean);return s||super.getStepPath(e,t)}findAllStepsByProperty(e,t,s=new Set){if(s.has(this)){return[]}s.add(this);let i=[];if(t===this[e]){i.push(this)}if(this.getStepCondition()&&this.getStepCondition()[e]===t){i.push(this.getStepCondition())}if(this.getStepWhileLoop()&&this.getStepWhileLoop()[e]===t){i.push(this.getStepWhileLoop())}let o=this.steps||[];o=o.reduce(((e,t)=>{if(t.getStepCondition()){e=e.concat([t.getStepCondition()])}if(t.getStepWhileLoop()){e=e.concat([t.getStepWhileLoop()])}if(t.getPostCodeStep()){e=e.concat([t.getPostCodeStep()])}return e}),o);i=i.concat(o.filter((s=>s[e]===t)));const r=o.filter((e=>Boolean(e.isGroupStep||e.findAllStepsByProperty))).map((i=>i.findAllStepsByProperty(e,t,s))).filter(Boolean);i=i.concat(n.flattenDeep(r));return i}findStepByProperty(e,t,s=new Set){if(!t){return null}if(t===this[e]){return this}if(s.has(this)){return null}s.add(this);if(this.getStepCondition()&&this.getStepCondition()[e]===t){return this.getStepCondition()}if(this.getStepWhileLoop()&&this.getStepWhileLoop()[e]===t){return this.getStepWhileLoop()}const i=this.steps.slice();for(const s of this.steps){if(s[e]===t){return s}if(s.getStepCondition()){i.push(s.getStepCondition())}if(s.getStepWhileLoop()){i.push(s.getStepWhileLoop())}if(s.getPostCodeStep()){i.push(s.getPostCodeStep())}}const o=i.find((s=>s[e]===t));if(o){return o}for(const o of i){if(o.isGroupStep||o.findStepByProperty){const i=o.findStepByProperty(e,t,s);if(i){return i}}}return undefined}findStepById(e,t=false){if(t){return this.findStepByProperty("id",e)}if(e===this.id){return this}return this.steps.find((t=>t.id===e))}resetDirty(e){super.resetDirty(e);this.steps.forEach((t=>{t.resetDirty(e)}))}resetNew(e){super.resetNew(e);this.steps.forEach((t=>{t.resetNew(e)}))}findStepHierarchy(e,t=[]){return this.loadStepHierarchy(e,t)}loadStepHierarchy(e,t=[]){const s={};function i(e,o){if(s[e.id]&&t.length){const i=s[e.id].map((e=>e.id)).filter((e=>t.includes(e))).length;const n=[e].concat(o).map((e=>e.id)).filter((e=>t.includes(e))).length;if(n>i){s[e.id]=[e].concat(o)}}else{s[e.id]=[e].concat(o)}const n=e.getStepContent();if(n.steps){n.steps.forEach((t=>{i(t,[e].concat(o))}))}}i(this,[]);return s[e]||[]}removeStep(e,t=false){const s=this.findStepIndex({id:e});let i=null;if(s>=0){this.removeStepAt(s)}else if(t){i=this.findStepById(e,true);if(i&&i.parentStep instanceof f){return i.parentStep.removeStep(e,false)}}return i}removeStepAt(e){if(e<0||e>=this.steps.length){throw new Error(`removeStepAt: index '${e}' out of range`)}const t=this.steps[e];if(this===t.parentStep){t.parentStep=null}this.steps.splice(e,1);this.setDirty()}addStep(e,t){if(e.parentStep&&e.parentStep instanceof f){if(e.parentStep===this){return undefined}e.parentStep.removeStep(e.id)}if(Number.isNaN(t)||t===null||typeof t!=="number"){this.steps.push(e)}else{const s=this.steps.length;if(t>=0&&t<=s){this.steps.splice(t,0,e)}else{p.log("scenario add step: illegal position",t,"step count",this.steps.length);return null}}this.setDirty();e.parentStep=this;return e}reset(e=0){if(e>h){return}super.reset();this.steps.forEach((t=>t.reset(e+1)))}getSerializableSaveObject(e){e=Object.assign({deep:true},e);return{...super.getSerializableSaveObject(e),steps:this.steps.map((t=>t.getSerializableSaveObject(e))),applitoolsStepIds:this.applitoolsStepIds,name:this.name}}getSerializableObject(e){e=Object.assign({deep:true},e);return{...super.getSerializableObject(e),steps:this.steps.map((t=>t.getSerializableObject(e))),applitoolsStepIds:this.applitoolsStepIds,name:this.name}}getSerializableSaveSteps(e){e=a.utils.extend({},{deep:true},e);const t=this.getSerializableSaveObject(e);function s(e,t){if(!e||!e.length){return t}e.forEach((e=>{const i=e.steps;t.push(e);if(i===null||i===void 0?void 0:i.length){s(i,t);e.steps=i.map((e=>e.id))}}));return t}return s([t],[])}getPropertiesDescription(e,t,s){const i=super.getPropertiesDescription(e,t,s);const o=this.getStepWhileLoop();const n={none:"Don't repeat",IS_VISIBLE:"While element is visible",IS_NOT_VISIBLE:"While element is not visible",elementText:"While element text is",[d.ConditionType.CUSTOM]:"Custom",DYNAMIC_PARENT_LOOP_CONDITION:"For each item","loop-for-step":`Loop for (${o===null||o===void 0?void 0:o.loopFor})`};const r=(o===null||o===void 0?void 0:o.type)===d.ConditionType.ELEMENT?n[o.subType||d.ConditionType.CUSTOM]:n[(o===null||o===void 0?void 0:o.type)||d.ConditionType.ALWAYS];const a=[...i,{key:"whileLoop",name:"Repeat group",value:r}];return a}get hasRealChanges(){for(const e of this.steps){if(e.hasRealChanges){return true}}return super.hasRealChanges}[Symbol.iterator](){function*e(e,t=[],s=[]){var i,o;yield{step:e,path:t,namedPath:s};class n extends Error{constructor(){super(...arguments);this.code=u.commonConstants.error.CIRCULAR_SCENARIO_DETECTED}}for(const r of e.steps){const e=(o=(i=r.displayName)!==null&&i!==void 0?i:r.stepTitle)!==null&&o!==void 0?o:r.getFriendlyName();if(r.getStepContent().isGroupStep){for(const i of r.getStepContent()){const o={step:i.step,path:t.concat(r.id).concat(i.path),namedPath:s.concat(e).concat(i.namedPath)};if(o.path.length>h){throw new n("Circular Scenario Detected")}if(i.sharedStep){o.sharedStep=i.sharedStep}else if(i.step===r.getStepContent()){o.sharedStep=r}yield o}}else{yield{step:r,path:t.concat(r.id),namedPath:s.concat(e)}}}}return e(this)}get isGroupStep(){return true}get length(){return this.steps.length}}t.GroupStep=f;i([c.observable.shallow,o("design:type",Array)],f.prototype,"steps",void 0);i([c.action,o("design:type",Function),o("design:paramtypes",[String,Object]),o("design:returntype",Object)],f.prototype,"removeStep",null);i([c.action,o("design:type",Function),o("design:paramtypes",[Number]),o("design:returntype",void 0)],f.prototype,"removeStepAt",null);i([c.action,o("design:type",Function),o("design:paramtypes",[Object,Object]),o("design:returntype",Object)],f.prototype,"addStep",null)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.lazyInject=t.UIContainer=void 0;s(113);const i=s(350);const o=s(61);const n=s(62);const r=s(14);const a=s(805);const c=s(48);const l=s(22);t.UIContainer=o.container;t.lazyInject=(0,i.default)(o.container).lazyInject;t.UIContainer.unbind(r.FeatureFlagsService);t.UIContainer.bind(r.FeatureFlagsService).to(a.UIFeatureFlagsService);t.UIContainer.bind(a.UIFeatureFlagsService).toConstantValue(null);if(true){t.UIContainer.bind(n.hostServiceFactory).toFactory(n.hostServiceFactory)}(0,c.exposeGlobally)("testimServicesApi")(l.TestimServicesApi);(0,c.exposeGlobally)("featureFlagsService")(r.FeatureFlagsService)},,,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.SharedStepInstance=void 0;const n=s(6);const r=s(8);const a=s(2);const c=s(7);const l=s(424);const u=s(111);const d=s(5);const p=s(51);const h=s(60);const f=c.Logger.getLogger("sharedStepInstance");const m=["newClassParameters","removeClassParameters","renameClassParameters","updateClassParameters"];const g=["sharedStepInfoId","locatorContext","useLocatorContext","classType","parameterNames","parameterValues","updateParameters","removeParameters","newParameters","renameParameters","emailParamName","label","renameSharedStep","secrets"];const v=["whileLoop","condition","newClassParameters","removeClassParameters","updateClassParameters","renameClassParameters"];const S=["stepTimeout","useStepTimeout","treatAsWarning","stopOnError"];class y extends((0,l.expressionMixin)(u.ParameterStep,"emailParamName")){constructor(...e){super(...e);Object.defineProperties(this,{element:{get(){var e;return((e=this.sharedStepClass)===null||e===void 0?void 0:e.element)||null}},screenImage:{get(){var e;return((e=this.sharedStepClass)===null||e===void 0?void 0:e.screenImage)||null}}})}isParameterDefinitionChanged(e){return Boolean(e.newParameters||e.removeParameters||e.renameParameters)}isConditionDefinitionChanged(e){return Boolean(e.removeCondition)}isParameterValueChanged(e){return Boolean(e.updateParameters)}shouldIgnoreClassUpdate(e){return Boolean(e.aggregateUpdateAction)&&this.classType!=="accessibility-validation-shared-step"}stepTitleHandlers(){const e=["user-code","validation-code-step","wait-for-code-step","action-code-step","cli-validation-code-step","cli-wait-for-code-step","cli-action-code-step","cli-validation-download-file","cli-wait-for-download-file","email-validation-step","network-validation-step","salesforce-apex-action","accessibility-validation-shared-step","api-action","api-validation"].includes(this.classType);if(!e){return""}if(this.classType==="accessibility-validation-shared-step"){return this.getStepContent().getDisplayName()}return this.getDisplayName()}_update(e){var t,s,i;if(e.sharedStepInfoId){this.sharedStepInfoId=e.sharedStepInfoId}if(e.locatorContext){if(this.locatorContext){this.locatorContext.update(e.locatorContext)}else{this.locatorContext=h.stepBuilder.buildStepFromData(e.locatorContext)}}if(Object.hasOwn(e,"useLocatorContext")){this.useLocatorContext=!!e.useLocatorContext;if(!e.useLocatorContext){delete this.locatorContext;this.tabInfo=null}}if(typeof e.renameSharedStep==="string"){p.sharedStepSingleton.rename(this.sharedStepInfoId,e.renameSharedStep)}const o=p.sharedStepSingleton.isReuseAllowed(this.sharedStepInfoId);if(e.classType){this.classType=e.classType;const n={"wait-for-code-step":"wait-for","validation-code-step":"validation","action-code-step":"action","cli-wait-for-code-step":"CLI wait-for","cli-validation-code-step":"CLI validation","cli-action-code-step":"CLI action","cli-validation-download-file":"download validation","cli-wait-for-download-file":"download wait-for","email-validation-step":"email validation",group:"group","api-action":"API action","api-validation":"API validation","network-validation-step":"network validation","salesforce-apex-action":"Salesforce Apex action","accessibility-validation-shared-step":"Accessibility validation","marketplace-wrapper":(i=(s=(t=this.sharedStepInfo)===null||t===void 0?void 0:t.sharedStepClass)===null||s===void 0?void 0:s.getFriendlyName())!==null&&i!==void 0?i:"","execute-driver-script":"action"};this.label||(this.label=`Run ${o?"shared ":""}${n[this.classType]}`)}const n=this.removeOnlyClassDataFromData(e);super._update(n);if(this.sharedStepClass){const t=this.getNonInstanceUpdateData(e);const s=this.isParameterDefinitionChanged(e);if(s){t.parameterNames=r.utils.clone(this.parameterNames)}if(s||Object.keys(t).length>0&&!this.shouldIgnoreClassUpdate(e)){this.sharedStepClass.update(t);if(this.isClassParametersUpdateData(e)){this.setMergedParameters(this.sharedStepClass)}}}return this}update(e){const t=n.chain(this).pick(Object.keys(e)).omit(S).cloneDeep().value();const s=this._update(e);if(this.isChanged(t)||this.isParameterDefinitionChanged(e)||this.isParameterValueChanged(e)||this.isConditionDefinitionChanged(e)){this.setDirty()}return s}removeOnlyClassDataFromData(e){return n.omit(e,v)}isClassParametersUpdateData(e){return m.some((t=>Object.hasOwn(e,t)))}getNonInstanceUpdateData(e){return n.omit(e,g)}getElementLocatorsWithTypes(){if(!this.parameterValues){return[]}return this.parameterValues.filter((e=>["locate","mobile-locate"].includes(e.type))).map((e=>({element:e,type:"element-parameter"})))}getSharedStepClass(e){return this.isNew&&this.sharedStepClass?Promise.resolve(this.sharedStepClass):e.loadSharedStepClass(this.sharedStepInfoId)}getStepPath(e,t=[]){if(t.length>1e3){return t}const s=this.sharedStepClass?this.sharedStepClass.getStepPath(e,t.concat([this.id])):null;return s||super.getStepPath(e,t)}setMergedParameters(e){var t,s;const i=this.getMergedParameters(e);this.parameterNames=i.parameterNames;this.parameterValues=i.parameterValues;const o=((t=e.parameterNames)===null||t===void 0?void 0:t.filter((e=>e.type==="evaluate-expression")))||[];const n=((s=this.parameterValues)===null||s===void 0?void 0:s.filter((e=>e.type==="evaluate-expression")))||[];const r=this.isNew&&!this.originalStepId;if(r&&n.length<o.length){o.forEach((e=>{this.updateParameters({parameterId:e.parameterId,stepData:{type:"evaluate-expression"}})}))}}async syncWithSharedStepClass(e){const t=await this.getSharedStepClass(e);y.mutationCallbacksBatchedForNextTick.add((()=>{this.sharedStepClass=t;this.setMergedParameters(t);this.treatAsWarning=t.treatAsWarning;this.stopOnError=t.stopOnError;if(typeof this.sharedStepClass.refreshLocation==="function"){this.sharedStepClass.refreshLocation(this.parameterValues)}}));if(!y.isPendingBatches){y.isPendingBatches=true;y.afterMutationsPromise=Promise.resolve().then((()=>{y.isPendingBatches=false;(0,a.runInAction)((()=>y.mutationCallbacksBatchedForNextTick.forEach((e=>e()))));y.mutationCallbacksBatchedForNextTick.clear()}))}await y.afterMutationsPromise;return this}getStopOnError(){return this.sharedStepClass?this.sharedStepClass.getStopOnError():super.getStopOnError()}getTreatAsWarning(){return this.sharedStepClass?this.sharedStepClass.getTreatAsWarning():super.getTreatAsWarning()}getStepCondition(){return this.sharedStepClass?this.sharedStepClass.getStepCondition():super.getStepCondition()}findAllStepsByProperty(e,t,s=new Set){if(s.has(this)){return[]}s.add(this);const i=[];if(!this.sharedStepClass){return i}if(this.sharedStepClass[e]===t){i.push(this.sharedStepClass)}if(this.sharedStepClass.condition&&this.sharedStepClass.condition[e]===t){i.push(this.sharedStepClass.condition)}if(this.sharedStepClass.whileLoop&&this.sharedStepClass.whileLoop[e]===t){i.push(this.sharedStepClass.whileLoop)}if(this.sharedStepClass.findAllStepsByProperty){i.push(...this.sharedStepClass.findAllStepsByProperty(e,t,s))}return i}findStepByProperty(e,t,s=new Set){const i=this.sharedStepClass;if(!i){return undefined}if(i[e]===t){return i}if(i.condition&&i.condition[e]===t){return i.condition}if(i.whileLoop&&i.whileLoop[e]===t){return i.whileLoop}if("findStepByProperty"in i&&i.findStepByProperty){return i.findStepByProperty(e,t,s)}return undefined}findStepById(e,t){var s;if((s=this.sharedStepClass)===null||s===void 0?void 0:s.findStepById){return this.sharedStepClass.findStepById(e,t)}return undefined}getMergedParameters(e){const t=e.parameterNames||[];const s=e.getClassParameterValues()||[];const i=new Set(t.map((e=>e.parameterId)));const o=new Set(s.map((e=>e.targetId)));const r=this.parameterValues.filter((e=>e.targetId&&i.has(e.targetId)&&!o.has(e.targetId)));const a=n.uniqBy(s.concat(r),"targetId");return{parameterNames:e.parameterNames,parameterValues:a}}getType(){if(this.sharedStepClass){return this.sharedStepClass.getType()}return super.getType()}getStepContent(){if(this.sharedStepClass){return this.sharedStepClass.getStepContent()}return super.getStepContent()}reset(e=0){super.reset(e);if(this.sharedStepClass){this.sharedStepClass.reset(e+1)}}getSerializableObject(e){var t;return{...super.getSerializableObject(e),sharedStepInfoId:this.sharedStepInfoId,classType:this.classType,locatorContext:(t=this.locatorContext)===null||t===void 0?void 0:t.getSerializableObject(e),useLocatorContext:!!this.useLocatorContext}}getSerializableSaveObject(e){const t=this.getSerializableObject(e);t.parameterValues=t.parameterValues.filter((e=>e.type!=="node-package"));return t}getDisplayName(){var e;const t=this.sharedStepInfo;if(typeof(t===null||t===void 0?void 0:t.name)==="string"){return t.name}return((e=this.sharedStepClass)===null||e===void 0?void 0:e.name)||""}getStepPreview(){return this.getDisplayName()}getIcon(){var e;const t=(e=this.sharedStepClass)===null||e===void 0?void 0:e.icon;if(t){return t}switch(this.classType){case"group":return"folder";case"api-validation":return"cloud-v";case"api-action":return"cloud-step";case"network-validation-step":return"network";case"cli-wait-for-code-step":case"cli-validation-code-step":case"cli-action-code-step":return"cli";case"cli-validation-download-file":case"cli-wait-for-download-file":return"download";case"email-validation-step":return"validate-email";case"salesforce-apex-action":return"apex-logo";case"accessibility-validation-shared-step":return"a11y-step";case"execute-driver-script":return"script";case"validation-code-step":case"wait-for-code-step":case"action-code-step":default:return"js"}}getFriendlyName(){var e,t,s;if(this.isMarketplaceStep){return(s=(t=(e=this.sharedStepInfo)===null||e===void 0?void 0:e.sharedStepClass)===null||t===void 0?void 0:t.getFriendlyName())!==null&&s!==void 0?s:""}return d.sharedStepsFriendlyNames[this.classType]||d.sharedStepsFriendlyNames.__default}getTestimDocsUrl(){var e,t,s;return(s=(t=(e=this.sharedStepClass)===null||e===void 0?void 0:e.getTestimDocsUrl)===null||t===void 0?void 0:t.call(e))!==null&&s!==void 0?s:d.commonConstants.documentationUrls.GROUPS}getNameAsWord(e=false){switch(this.classType){case"user-code":case"validation-code-step":case"wait-for-code-step":case"action-code-step":return!e?"custom action":"custom";case"group":return"group";case"api-validation":case"api-action":return!e?"api step":"api";case"cli-wait-for-download-file":case"cli-validation-download-file":return"download step";case"cli-action-code-step":case"cli-validation-code-step":case"cli-wait-for-code-step":return!e?"cli action":"cli";case"email-validation-step":return!e?"email step":"email";case"salesforce-apex-action":return e?"Apex":"salesforce Apex action";case"accessibility-validation-shared-step":return e?"accessibility":"accessibility Validation";default:return"step"}}hasTimeoutOverrideOption(){if(!this.sharedStepClass){f.error("hasTimeoutOverrideOption(): There's no shared-step-class attached to this shared-step-instance",{sharedStepInstanceId:this.id});return false}return this.sharedStepClass.hasTimeoutOverrideOption()}get hasRealChanges(){if(!this.sharedStepClass){f.error("hasRealChanges(): There's no shared-step-class attached to this shared-step-instance",{sharedStepInstanceId:this.id});return false}return this.sharedStepClass.hasRealChanges}get isMarketplaceStep(){return this.classType==="marketplace-wrapper"}get isLatestVersion(){var e;if(!this.sharedStepInfo){return true}return((e=this.sharedStepInfo.revisions)===null||e===void 0?void 0:e.isLatestVersion())||false}get sharedStepInfo(){return p.sharedStepSingleton.getInfoById(this.sharedStepInfoId)}get isLocked(){var e;return Boolean((e=this.sharedStepInfo)===null||e===void 0?void 0:e.locked)}get isStepSharedAndUsedOnMultipleTests(){var e,t,s;return Boolean(this.sharedStepInfo&&!((e=this.sharedStepInfo)===null||e===void 0?void 0:e.hidden)||((s=(t=this.sharedStepInfo)===null||t===void 0?void 0:t.usage)!==null&&s!==void 0?s:0)>1)}get isShared(){var e;return((e=this.sharedStepInfo)===null||e===void 0?void 0:e.hidden)===false}}t.SharedStepInstance=y;y.mutationCallbacksBatchedForNextTick=new Set;y.isPendingBatches=false;i([a.observable.ref,o("design:type",Boolean)],y.prototype,"useLocatorContext",void 0);i([a.observable.ref,o("design:type",Object)],y.prototype,"conditionResult",void 0);i([a.observable.ref,o("design:type",void 0)],y.prototype,"sharedStepClass",void 0);i([a.action,o("design:type",Function),o("design:paramtypes",[void 0]),o("design:returntype",void 0)],y.prototype,"setMergedParameters",null);i([a.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"isLatestVersion",null);i([a.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"sharedStepInfo",null);i([a.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"isLocked",null);i([a.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"isStepSharedAndUsedOnMultipleTests",null);i([a.computed,o("design:type",Object),o("design:paramtypes",[])],y.prototype,"isShared",null)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.FoldersStore=t.SHOW_IMPROVED_URL_PARAM_NAME=t.SHOW_ARCHIVED_URL_PARAM_NAME=void 0;const d=s(6);const p=s(98);const h=s(591);const f=s(9);const m=s(2);const g=s(22);const v=s(34);const S=s(15);const y=s(7);const b=s(27);const _=s(26);const T=s(49);const E=s(29);const I=s(51);const C=s(5);const D=y.Logger.getLogger("foldersStore");p.extend(h);const O={tests:{_id:"",folderInfoId:"",createdAt:0,children:[],name:"",childFolders:[],childTests:[],type:C.FOLDER_CHILD_TYPES.FOLDER},sharedSteps:{_id:"",folderInfoId:"",createdAt:0,children:[],name:"",childFolders:[],childSharedSteps:[],type:C.FOLDER_CHILD_TYPES.FOLDER}};const A={tests:{folders:[],tests:[],rootFolder:O.tests,type:"tests"},sharedSteps:{folders:[],sharedSteps:[],rootFolder:O.sharedSteps,type:"sharedSteps"}};const j="folder";t.SHOW_ARCHIVED_URL_PARAM_NAME="showArchived";t.SHOW_IMPROVED_URL_PARAM_NAME="onlyShowImproved";let w=class e{constructor(e,t,s,i,o,n){this.projectsService=e;this.branchesService=t;this.testimServices=s;this.urlStateService=i;this.userService=o;this.editedTestStore=n;this.explicitUpdate={tests:0,sharedSteps:0}}get testsFoldersTree(){return(0,b.fromPromise)(this.loadCurrentFolder("tests"),b.fromPromise.resolve(A.tests))}get testsFoldersTreeWithDefaultValue(){return this.testsFoldersTree.state==="fulfilled"?this.testsFoldersTree.value:A.tests}get sharedStepsInfo(){return I.sharedStepSingleton.sharedStepInfos.filter((e=>Boolean(e.name))).filter((e=>!e.marketplace)).filter((e=>this.showArchived===Boolean(e.hidden))).filter((e=>{var t;return this.branchesService.currentBranchRevision[e.id]||((t=e.sharedStepClass)===null||t===void 0?void 0:t.isNew)}))}get sharedStepsFoldersTree(){d.noop(this.sharedStepsInfo);return(0,b.fromPromise)(I.sharedStepSingleton.onReady().then((()=>{const e=this.buildFoldersTreeFromRawData("sharedSteps",{folders:I.sharedStepSingleton.folders,sharedSteps:this.sharedStepsInfo});I.sharedStepSingleton.folders=e.folders;return e})),b.fromPromise.resolve(A.sharedSteps))}get currentFolderInfoId(){return this.urlStateService.params[j]}get showArchived(){return this.urlStateService.params[t.SHOW_ARCHIVED_URL_PARAM_NAME]==="true"}get currentTestsFolder(){return(0,b.fromPromise)(this.getFolderContent("tests",this.currentFolderInfoId))}get currentSharedStepsFolder(){return(0,b.fromPromise)(this.getFolderContent("sharedSteps",this.currentFolderInfoId))}forceUpdateList(e){this.explicitUpdate[e]++}async loadCurrentFolder(e){const t=this.projectsService.projectId;const{isMobile:s}=this.projectsService;const i=this.branchesService.branch;const o=this.showArchived&&this.userService.isAdmin();const n=this.explicitUpdate[e];if(!t||!i){return A[e]}const r=await this.testimServices.folder.listFolders({projectId:t,branch:i,type:e,includeArchived:o,isMobile:s});return this.buildFoldersTreeFromRawData(e,r)}buildFoldersTreeFromRawData(e,t){const s={type:e,folders:t.folders.map((e=>({...e,type:C.FOLDER_CHILD_TYPES.FOLDER}))),rootFolder:O[e]};const i=Object.assign(s,e==="tests"?{tests:t.tests.map((e=>({...e,type:C.FOLDER_CHILD_TYPES.TEST,updatedAt:{full:new Date(e.lastModifiedAt||"").toString(),short:p(e.lastModifiedAt).fromNow()}})))}:{sharedSteps:t.sharedSteps});return this.buildFoldersTree((0,m.observable)(i))}getFolderPath(e,t,s=new Set,i=[]){var o;i=[t.folderInfoId,...i];if(s.has(t.folderInfoId)){return i}s.add((o=t.folderInfoId)!==null&&o!==void 0?o:"");if(e.has(t.parentInfoId)){return this.getFolderPath(e,e.get(t.parentInfoId),s,i)}return i}buildFoldersTree(e){const t=e;const s=new Map(t.folders.map((e=>[e.folderInfoId,e])));t.folders.forEach((e=>{delete e.parentInfoId}));t.folders.forEach((e=>{const t=d.chain(e.children).filter((e=>s.has(e.id))).map((t=>Object.assign(s.get(t.id),{parentInfoId:e.folderInfoId}))).value();e.childFolders=t}));const i="tests"in t?t.tests:t.sharedSteps;i.forEach((e=>{delete e.parentInfoId}));const o=new Map(i.map((e=>["_id"in e?e._id:e.id,e])));t.folders.forEach((e=>{const s=d.chain(e.children).filter((e=>o.has(e.id))).map((t=>Object.assign(o.get(t.id),{parentInfoId:e.folderInfoId}))).value();if(t.type==="tests"){e.childTests=s}else if(t.type==="sharedSteps"){e.childSharedSteps=s}}));t.folders.forEach((e=>{const i=this.getFolderPath(s,e);const o=i.length>1&&i.slice(0,-1).includes(i.at(-1)||"");if(o){D.warn(`Cyclic folder path detected: ${i.join("/")}`,{path:i});delete e.parentInfoId}e.nestedNodesCount=this.countNodes(t.type,e)}));const n=e=>!e.parentInfoId;t.rootFolder.childFolders=t.folders.filter(n);const r=t.rootFolder.childFolders.map((e=>({id:e.folderInfoId,type:C.FOLDER_CHILD_TYPES.FOLDER})));if(t.type==="tests"){const e=t;e.rootFolder.childTests=e.tests.filter(n);e.rootFolder.children=[...r,...e.rootFolder.childTests.map((e=>({id:e._id,type:C.FOLDER_CHILD_TYPES.TEST})))]}if(t.type==="sharedSteps"){const e=t;e.rootFolder.childSharedSteps=e.sharedSteps.filter(n);e.rootFolder.children=[...r,...e.rootFolder.childSharedSteps.map((e=>({id:e.id,type:C.FOLDER_CHILD_TYPES.SHARED_STEP})))]}return t}async getFolderContent(e,t){var s;const{folders:i,rootFolder:o}=e==="tests"?await this.testsFoldersTree:await this.sharedStepsFoldersTree;if(!i){return undefined}return(s=i.find((e=>e.folderInfoId===t)))!==null&&s!==void 0?s:o}async getRecursiveChildrenPaths(e,t,s=[]){let i=new Map;const o=await this.getFolderContent(e,t);const n=[...s,o.name];this.getNonFolderChildren(e,o).forEach((e=>i.set(e._id||e.id,n)));const r=await Promise.all(o.childFolders.map((t=>this.getRecursiveChildrenPaths(e,t.folderInfoId,n))));r.forEach((e=>{i=new Map([...i,...e])}));return i}async createChildFolder({name:e,parentFolder:t,type:s}){const i=this.projectsService.projectId;const o=this.branchesService.branch;const n=this.userService.getUserId();const{folderInfoId:r}=t;const a=s==="tests"?await this.testsFoldersTree:await this.sharedStepsFoldersTree;try{const c=await this.testimServices.folder.createFolder({type:s,projectId:i,branch:o,parentFolderInfoId:r,name:e});a.folders.push({...c,[s==="tests"?"childTests":"childSharedSteps"]:[],childFolders:[],parentInfoId:r,createdBy:n!==null&&n!==void 0?n:undefined,type:C.FOLDER_CHILD_TYPES.FOLDER});t.children.push({type:C.FOLDER_CHILD_TYPES.FOLDER,id:c.folderInfoId});this.buildFoldersTree(a);return c}catch(t){D.error("failed creating child folder",{parentFolderInfoId:r,name:e,projectId:i,branch:o})}return undefined}async moveChildrenToFolder({newParentId:e,children:t,treeType:s}){const i=d.groupBy(t,(({parentInfoId:e})=>e));await Promise.all(Object.values(i).map((t=>{const i=t[0].parentInfoId;if(e===i||!e&&!i){return undefined}return this.moveChildrenToFolderImpl({previousParentId:i,newParentId:e,children:t.map((e=>({type:e.type,id:this.getTreeNodeId(e)}))),treeType:s})})))}async addChildrenToFolder({folderInfoId:e,children:t,treeType:s}){return this.moveChildrenToFolderImpl({newParentId:e,children:t,treeType:s})}async moveChildrenToFolderImpl({previousParentId:e,newParentId:t,children:s,treeType:i}){if(t===e){return}const o=this.projectsService.projectId;const n=this.branchesService.branch;await this.testimServices.folder.moveChildren({projectId:o,branch:n,previousParent:e,newParent:t,children:s});const r=await this.getFolderContent(i,e);const a=await this.getFolderContent(i,t);r.children=d.pullAllBy(r.children,s,"id");a.children=[...a.children,...s];const c=i==="tests"?await this.testsFoldersTree:await this.sharedStepsFoldersTree;this.buildFoldersTree(c)}async changeTestOwner(e,t){const s=this.projectsService.projectId;const i=this.branchesService.branch;const o=e.map((e=>{var t;return(t=e._id)!==null&&t!==void 0?t:e.id}));await this.testimServices.test.updateTestsOwner({projectId:s,branch:i,testIds:o,newOwnerUserId:t});e.forEach((e=>{e.testOwnerUserId=t}))}async renameFolder(e,t){const s=this.projectsService.projectId;const i=this.branchesService.branch;await this.testimServices.folder.updateFolder({projectId:s,branch:i,folderInfoId:e.folderInfoId,name:t});e.name=t}async renameTest(e,t){const s=this.projectsService.projectId;await this.testimServices.test.renameTest(e._id,s,t);e.name=t}async updateTestStatus(e,t,s){const i=this.projectsService.projectId;const o=this.branchesService.branch;const n=e.map((e=>e._id));await this.testimServices.test.updateTestStatus({testIds:n,projectId:i,branch:o,oldTestStatus:s,newTestStatus:t});e.forEach((e=>{e.testStatus=t}))}async updateTestsConfig(e,t){const s=this.projectsService.projectId;const i=e.map((e=>e._id));await this.testimServices.test.updateTestsConfig(s,i,t.id);e.forEach((e=>{e.testConfig=t}));this.explicitUpdate.tests++}async archiveFoldersAndTests({foldersToArchive:e,testsToArchive:t,treeType:s}){var i;const o=this.projectsService.projectId;const n=this.branchesService.branch;const r=s==="tests"?await this.testsFoldersTree:await this.sharedStepsFoldersTree;const a=e.map((e=>e.folderInfoId));const c=(i=t===null||t===void 0?void 0:t.map((e=>e._id)))!==null&&i!==void 0?i:[];const{deletedFolders:l,deletedTests:u}=await this.testimServices.folder.archiveFoldersAndTests({projectId:o,branch:n,folderInfoIds:a,testIds:c});r.folders=r.folders.filter((({folderInfoId:e})=>!l.includes(e)));if(s==="tests"){r.tests=r.tests.filter((({_id:e})=>!u.includes(e)))}this.buildFoldersTree(r);if(this.editedTestStore.testId&&c.includes(this.editedTestStore.testId)){this.editedTestStore.reset()}}async unArchiveFolder(e){const t=this.projectsService.projectId;const s=this.branchesService.branch;await this.testimServices.folder.unarchiveFolder({projectId:t,branch:s,folderInfoId:e.folderInfoId});e.isArchived=false}async unArchiveTest(e){const t=this.projectsService.projectId;const s=this.branchesService.branch;await this.testimServices.test.unArchiveTests(t,[e._id],s);e.isArchived=false}async updateTestList(){this.explicitUpdate.tests++;return this.testsFoldersTree}getNonFolderChildren(e,t){if(e==="tests"){return t.childTests}if(e==="sharedSteps"){return t.childSharedSteps}return[]}countNodes(e,t,s=new Set,i=[t.name]){if(s.has(t.folderInfoId)){return 0}s.add(t.folderInfoId);if(e==="tests"){return t.childTests.length+t.childFolders.reduce(((e,t)=>e+this.countNodes("tests",t,s,[...i,t.name])),0)}if(e==="sharedSteps"){return t.childSharedSteps.length+t.childFolders.reduce(((e,t)=>e+this.countNodes("sharedSteps",t,s,[...i,t.name])),0)}return 0}getTreeNodeId(e){if(e.type===C.FOLDER_CHILD_TYPES.FOLDER){return e.folderInfoId}if(e.type===C.FOLDER_CHILD_TYPES.TEST){return e._id}return e.id}async getItemBreadcrumbsImpl(e,t){if(!t||t.type===C.FOLDER_CHILD_TYPES.FOLDER&&!t.folderInfoId){return[]}const s=await this.getFolderContent(e,t===null||t===void 0?void 0:t.parentInfoId);const i={name:t.name,value:this.getTreeNodeId(t)};return[...await this.getItemBreadcrumbs(e,s),i]}getItemBreadcrumbs(e,t){return(0,b.fromPromise)(this.getItemBreadcrumbsImpl(e,t),b.fromPromise.resolve([]))}};t.FoldersStore=w;i([m.observable,o("design:type",Object)],w.prototype,"explicitUpdate",void 0);i([(0,m.computed)({keepAlive:true}),o("design:type",Object),o("design:paramtypes",[])],w.prototype,"testsFoldersTree",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"testsFoldersTreeWithDefaultValue",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"sharedStepsInfo",null);i([(0,m.computed)({keepAlive:true}),o("design:type",Object),o("design:paramtypes",[])],w.prototype,"sharedStepsFoldersTree",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"currentFolderInfoId",null);i([m.computed,o("design:type",Boolean),o("design:paramtypes",[])],w.prototype,"showArchived",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"currentTestsFolder",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"currentSharedStepsFolder",null);i([m.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Object)],w.prototype,"buildFoldersTree",null);t.FoldersStore=w=i([(0,f.injectable)(),o("design:paramtypes",[typeof(n=typeof S.ProjectsService!=="undefined"&&S.ProjectsService)==="function"?n:Object,typeof(r=typeof v.BranchesService!=="undefined"&&v.BranchesService)==="function"?r:Object,typeof(a=typeof g.TestimServicesApi!=="undefined"&&g.TestimServicesApi)==="function"?a:Object,typeof(c=typeof _.UrlStateService!=="undefined"&&_.UrlStateService)==="function"?c:Object,typeof(l=typeof T.UserService!=="undefined"&&T.UserService)==="function"?l:Object,typeof(u=typeof E.EditedTestStore!=="undefined"&&E.EditedTestStore)==="function"?u:Object])],w)},,function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.addTokenToFileUrl=t.createLogsLink=t.isDataUrl=t.fixUrlSlash=t.buildArtifactUrlWithToken=t.buildDomArtifactUrlWithToken=t.getArtifactUrl=t.fixUrl=t.getHostname=t.isURL=t.getUrlFieldsFromObject=t.urlToRegex=t.isAboutBlank=t.isValidUrl=t.getTestimBaseAgentUrl=t.getAzureFileUrl=t.getAppiumUrl=t.getTmaUrl=t.getServicesUrl=t.getClickimBaseUrl=t.getWsUrl=t.getDeviceId=t.getURLParameter=t.updateServicesUrl=t.servicesUrlGetter=t.URL_REGEX=void 0;t.URL_REGEX=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,})/g;const s=()=>typeof e!=="undefined"&&{}.toString.call(e)==="[object global]";let i;function o(){return i}t.servicesUrlGetter=o;function n(e){i=e}t.updateServicesUrl=n;function r(e){var t;const s={[e]:""};const i=typeof window!=="undefined"?(t=window.location)===null||t===void 0?void 0:t.search:s;const o=new RegExp(`[?|&]${e}=([^&;]+?)(&|#|;|$)`);return decodeURIComponent((o.exec(i)||["",""])[1].replace(/\+/g,"%20"))||null}t.getURLParameter=r;function a(){if(false){}return null}t.getDeviceId=a;function c(){if(false){}if(false){}return undefined}t.getWsUrl=c;function l(){return`${window.location.protocol}//${window.location.host}${window.location.pathname}${window.location.search}`}t.getClickimBaseUrl=l;function u(e){if(false){}if(false){}if(true){if(i){return i}if(!e){return"https://services.testim.io"}return`https://services${String(e)}.testim.io`}if(false){}return undefined}t.getServicesUrl=u;function d(){let e;if(typeof localStorage!=="undefined"){e=localStorage.getItem("tmaUrl")||""}const t=r("tmaUrl")||e||"http://127.0.0.1:8585"||"http://127.0.0.1:8585";return t.replace(/\/$/,"")}t.getTmaUrl=d;function p(){let e;if(typeof localStorage!=="undefined"){e=localStorage.getItem("appiumUrl")||""}const t=r("appiumUrl")||e||"";return t.replace(/\/$/,"")}t.getAppiumUrl=p;function h(){const e=r("azureFileUrl");if(e){return e.replace(/\/$/,"")}return"https://backandstoragetest.blob.core.windows.net"}t.getAzureFileUrl=h;function f(){if(false){}return"http://127.0.0.1:42543"}t.getTestimBaseAgentUrl=f;function m(e){if(!e||typeof e!=="string"){return false}try{new URL(e)}catch{return false}return true}t.isValidUrl=m;function g(e){return e==="about:blank"}t.isAboutBlank=g;function v(e){const t=e=>e.replace(/[%|\\{}()[\]^$+*?.]/g,"\\$&");return new RegExp(`^${e.split(/\*+/).map(t).join(".*")}$`)}t.urlToRegex=v;function S(e){const t=["origin","hash","search","pathname","port","hostname","host","protocol","href"];return t.reduce(((t,s)=>{t[s]=e[s];return t}),{})}t.getUrlFieldsFromObject=S;function y(e){const t=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-/]))?/;return t.test(e)}t.isURL=y;function b(e){try{return new URL(e).hostname}catch(e){return null}}t.getHostname=b;function _(e,t=["http","https","localhost"]){if(!e){return e}if(!t.some((t=>e.startsWith(t)))){return`http://${e}`}return e}t.fixUrl=_;async function T(e,t,s){const i=await t.user.getToken();e.searchParams.append("access_token",i);if(s){e.searchParams.append("attachment",s)}return e}function E(e){if(!e){return{artifactUrl:undefined,isNewStorageApi:false}}if(O(e)){return{artifactUrl:e,isNewStorageApi:false}}if(e.startsWith("http://")||e.startsWith("https://")){try{const t=new URL(e);return{artifactUrl:t,isNewStorageApi:false}}catch(e){return{artifactUrl:undefined,isNewStorageApi:false}}}return{artifactUrl:e,isNewStorageApi:true}}t.getArtifactUrl=E;function I(e,t,s){const{artifactUrl:i,isNewStorageApi:o}=E(e);if(!o){return Promise.resolve(i)}const n=s.storage.getStorageRelativePath(i);const r=new URL(`${t}/dom${n}`);return T(r,s)}t.buildDomArtifactUrlWithToken=I;function C(e,t,s,i){const{artifactUrl:o,isNewStorageApi:n}=E(e);if(!n){return Promise.resolve(o)}const r=s.storage.getStorageFullPath(o);const a=new URL(`${t}${r}`);return T(a,s,i)}t.buildArtifactUrlWithToken=C;function D(e){if(!e){return e}let t=e;const s=["http","https"].some((t=>e.startsWith(t)));if(!s){t=`http://${e}`}try{const i=new URL(t);i.pathname=i.pathname.replace(/\/\/+/g,"/");const o=i.toString();if(!e.endsWith("/")&&o.endsWith("/")){return o.slice(0,-1)}if(!s){const t=o.replace(/^http:\/\//,"");if(e.startsWith("/")&&!t.startsWith("/")){return`/${t}`}return t}return o}catch(t){return e}}t.fixUrlSlash=D;function O(e){if(!e){return false}try{const t=/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@/?%\s]*)\s*$/i;return!!e&&!!e.match(t)}catch(e){return false}}t.isDataUrl=O;function A(e,t=Date.now(),s=t+5e6,i=2e4,o=2e4){const n=t-i;let r=s+o;if(r<=n||Number.isNaN(r)){r=t+5e6+o}return`https://testim.coralogix.com/#/query-new/archive-logs?query=${e}&startTime=${n}&endTime=${r}`}t.createLogsLink=A;function j(e,t,s,i,o){return Promise.all(t.map((async({name:t,url:n})=>{const r=e=>e.at(-1);if(i&&(n.startsWith("http://")||n.startsWith("https://"))){const{pathname:t}=new URL(n);const s=t.startsWith(`/file-by-project/${e}/`);const i=t.startsWith("/file/");if(s){const s=r(t.split("/"));n=`/test-projects-artifacts/${e}/upload-file/${s}`}if(i){o.warn(`still running with old file url ${n}`)}}const a=await C(n,s.testimServerBaseUrl,s,t);if(!a){return undefined}const c=a.href;const l={name:t,url:c};return l})).filter(Boolean))}t.addTokenToFileUrl=j}).call(this,s(36))},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TypedHttpError=void 0;const i=s(328);const o=(0,i.configure)({bigint:false,circularValue:"[Circular]"});class n extends Error{constructor({err:e,response:t,timedout:s,method:i,url:n}){const r="message"in e?e.message:"";super(`Error, while trying to ${i} at ${n} ${r}`);let a;this.response=t;this.timedout=s;if("response"in e){this.superAgentSafeStringifyResponse=e.response&&JSON.parse(o(e.response));this.status=e.status;a=e.response}else if(e instanceof Response){this.status=e.status;a=e}else{a=e}Object.defineProperty(this,"originalResponse",{enumerable:false,value:a})}}t.TypedHttpError=n},,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.BugimOutput=void 0;const r=s(9);const a=s(69);const c=s(5);let l=class e{constructor(e){this.bugimDataStore=e}requestAnnotation(){var e;(e=window.top)===null||e===void 0?void 0:e.postMessage({command:c.commonConstants.bugim.REQUEST_ANNOTATE},"*")}recordCompleted(){var e;(e=window.top)===null||e===void 0?void 0:e.postMessage({command:c.commonConstants.bugim.RECORD_COMPLETED},"*")}addAnnotateStep(e){var t;(t=window.top)===null||t===void 0?void 0:t.postMessage({command:c.commonConstants.bugim.ADD_ANNOTATE_STEP,data:e},"*")}sendCurrentData(e){var t;(t=window.top)===null||t===void 0?void 0:t.postMessage({command:c.commonConstants.bugim.SET_CURRENT_DATA,data:e},"*")}analyticsTrack(e,t={}){var s;e=`bugim-${e}`;const i=this.bugimDataStore.getLoginData();const o=i?(i.authData||i).uid:"not-logged-in-user";const n={command:c.commonConstants.bugim.ANALYTICS_TRACK,data:{eventName:e,userId:o,properties:t}};(s=window.top)===null||s===void 0?void 0:s.postMessage(n,"*")}saveTest(e){var t;(t=window.top)===null||t===void 0?void 0:t.postMessage({command:c.commonConstants.bugim.SAVE_TEST,data:e},"*")}closeBugim(){var e;this.bugimDataStore.clean();(e=window.top)===null||e===void 0?void 0:e.postMessage({command:c.commonConstants.bugim.CLOSE_BUGIM},"*")}publishSuccess(e){var t;this.log("publish-success",e);(t=window.top)===null||t===void 0?void 0:t.postMessage({command:c.commonConstants.bugim.PUBLISH_SUCCESS,data:e},"*")}discardIssue(){var e;this.bugimDataStore.clean();const t=this.bugimDataStore.getProjectId();const s=this.bugimDataStore.getUserId();(e=window.top)===null||e===void 0?void 0:e.postMessage({command:c.commonConstants.bugim.DISCARD_ISSUE,data:{projectId:t,userId:s}},"*")}uploadBase64AsBlob(e,t,s,i,o){var n;(n=window.top)===null||n===void 0?void 0:n.postMessage({command:c.commonConstants.bugim.UPLOAD_BASE64_AS_BLOB,data:{url:e,base64:t,filename:s,contentType:i,headers:o}},"*")}log(...e){this.report("log",...e)}error(...e){this.report("error",...e)}report(e,...t){var s;(s=window.top)===null||s===void 0?void 0:s.postMessage({command:c.commonConstants.bugim.LOGGER,data:{type:e,args:t}},"*")}};t.BugimOutput=l;t.BugimOutput=l=i([(0,r.injectable)(),o("design:paramtypes",[typeof(n=typeof a.BugimDataStore!=="undefined"&&a.BugimDataStore)==="function"?n:Object])],l)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LoadUtils=void 0;const i=s(7);const o=i.Logger.getLogger("load-utils");class n{constructor(e){this.testimServicesApi=e}getRevisions(e,t,s){return this.testimServicesApi.test.getRevisions(e,t,s)}getBulkRevisions(e,t,s){return this.testimServicesApi.test.getBulkRevisions(e,t,s)}getStepHierarchy(e,t){return this.testimServicesApi.step.get(e,t)}async loadTestComplete(e,t,s,i,n,r){const a=Date.now();const c=await this.testimServicesApi.test.getTest(e,t,s,i,n,false,r);const l=Date.now()-a;if(l>1e3*10){o.log(`Get test ${e} took ${l/1e3} seconds`,{projectId:n,branch:i,testId:e})}return c}loadTestCompleteWithoutSharedSteps(e,t,s,i,o,n){return this.testimServicesApi.test.getTest(e,t,s,i,o,true,n)}loadResult(e,t,s,i){return this.testimServicesApi.test.getResult(e,t,s,i)}async loadAdditionalParamsForStepResult(e,t){if(!t.incomingParamsUrl&&!t.outgoingParamsUrl){const s=t._id;if(!s){return{incomingParams:{},outgoingParams:{}}}return this.testimServicesApi.test.loadAdditionalParamsForStepResult(e,s)}const[s,i]=await Promise.all([t.incomingParamsUrl?this.testimServicesApi.storage.downloadJSONFile(t.incomingParamsUrl).catch((()=>undefined)):{},t.outgoingParamsUrl?this.testimServicesApi.storage.downloadJSONFile(t.outgoingParamsUrl).catch((()=>undefined)):{}]);return{incomingParams:s,outgoingParams:i}}}t.LoadUtils=n},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(520),t)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.GridsService=void 0;const d=s(6);const p=s(9);const h=s(27);const f=s(2);const m=s(8);const g=s(7);const v=s(26);const S=s(15);const y=s(39);const b=s(22);const _=s(5);const T=s(20);const E=s(14);const I=g.Logger.getLogger("grids-service");const C=["browserstack","saucelabs","lambdaTest"];const D=["testimTDC","testimHeadspin","testimTVC","pCloudy"];const O=["testimHybrid","testim","testimDF","testimLambdaTest","testimEnterprise"];function A(){let e=m.utils.getStorage().getItem("preferredGrids");try{e=JSON.parse(e)}catch(e){I.error("Failed to parse preferred grids from local storage",{err:e});return{}}return e||{}}let j=class e{constructor(e,t,s,i,o){this.companiesService=e;this.projectService=t;this.featureFlagsService=s;this.testimServices=i;this.urlState=o;this.explicitUpdate=0;this.gridConfigurations=new Map;(0,f.reaction)((()=>this.companiesService.companyId),(async()=>{const{companyId:e}=this.companiesService;if(!e){return}await Promise.all([this.getGridsConfiguration(e),this.getCompanyGrids()]);if(this.grids){this.getGridsFromServer()}}))}isTestimGridType(e){var t;return Boolean((t=this.gridsConfiguration)===null||t===void 0?void 0:t.TESTIM_GRID_TYPES.includes(e))}isTestimMobileGridType(e){var t;return Boolean((t=this.gridsConfiguration)===null||t===void 0?void 0:t.TESTIM_MOBILE_GRID_TYPES.includes(e))}get hasTdcGrid(){var e;return(e=this.grids)===null||e===void 0?void 0:e.some((e=>e.type===_.gridTypes.GRID_TYPE_TESTIM_TDC))}get hasTvcGrid(){var e;return(e=this.grids)===null||e===void 0?void 0:e.some((e=>e.type===_.gridTypes.GRID_TYPE_TESTIM_TVC))}get companyGrids(){const e=this.explicitUpdate;const t=async()=>{try{return await this.getCompanyGrids()}catch(e){I.error("Error getting grids",e);return[]}};return(0,h.fromPromise)(t(),h.fromPromise.resolve([]))}get preferredGrid(){const{companyId:e}=this.companiesService;if(!e){return undefined}this._preferredGrids||(this._preferredGrids=A());if(this._preferredGrids&&this.isValidGrid(this._preferredGrids[e])){return this._preferredGrids[e]}return undefined}set preferredGrid(e){var t;if(!this.isValidGrid(e)){return}const s=(t=this.companiesService.companyId)!==null&&t!==void 0?t:"";this._preferredGrids||(this._preferredGrids=A());this._preferredGrids[s]=e;m.utils.getStorage().setItem("preferredGrids",JSON.stringify(this._preferredGrids))}explicitlyTriggerUpdate(){this.explicitUpdate++}async getGridsFromServer(){const{companyId:e}=this.companiesService;const t=(0,T.isPlaygroundModeState)(this.urlState);let s=await this.testimServices.grid.getAllGrids({companyId:e,isPlaygroundMode:t});const i=this.companiesService.adminPrivilegesForCurrentCompany==="readWrite";if(!i){s=s.filter((e=>!e.isSupportGrid))}this.updateGrids(s);return s}async getGridsConfiguration(e){if(this.gridConfigurations.has(e)){return this.gridConfigurations.get(e)}if((0,T.isPlaygroundModeState)(this.urlState)){this.gridsConfiguration={}}else{this.gridsConfiguration=await this.testimServices.grid.getGridsConfiguration(e)}this.gridConfigurations.set(e,this.gridsConfiguration);return this.gridsConfiguration}async getCompanyGrids(){if(this.grids){return this.grids}return this.getGridsFromServer()}updateGrids(e){if(Array.isArray(e)){this.grids=e;return this.grids}const t=this.grids.findIndex((t=>t._id===e._id));if(t>-1){this.grids[t]=e;return this.grids}this.grids.push(e);return this.grids}async createGrid(e){const t=this.companiesService.companyId;const s=await this.testimServices.grid.createGrid(t,e);this.updateGrids(s);this.explicitlyTriggerUpdate()}async editGrid(e){const t=this.companiesService.companyId;const s=await this.testimServices.grid.updateGrid(t,e);this.updateGrids(s);this.explicitlyTriggerUpdate()}async deleteGrid(e){const t=this.grids.findIndex((({_id:t})=>t===e._id));const s=this.companiesService.companyId;if(t>-1){await this.testimServices.grid.deleteGrid(s,[e._id]);const i=this.preferredGrid;if(i&&i._id===e._id){m.utils.getStorage().removeItem("preferredGrid")}this.grids.splice(t,1);this.explicitlyTriggerUpdate()}}getGridByName(e){var t;return(t=this.grids)===null||t===void 0?void 0:t.find((t=>t.name.toLowerCase()===e.toLowerCase()))}getGridById(e){var t;return(t=this.grids)===null||t===void 0?void 0:t.find((t=>t._id===e))}isValidGrid(e){if(!e||d.isEmpty(e)||!this.isGridTypeMatchesProjectType(e)){return false}return"_id"in e}isGridTypeMatchesProjectType(e){const t=this.projectService.projectType;if(C.includes(e.type)){return true}if([_.commonConstants.test.MOBILE_WEB,_.commonConstants.test.DESKTOP_WEB].includes(t)){return!D.includes(e.type)}return!O.includes(e.type)}async migrateGrid(e,t,s){const i=await this.testimServices.grid.migrate(e,t,s);return this.updateGrids(i)}isUsingFreeDFGrid(e){const t=e.type===_.gridTypes.GRID_TYPE_TESTIM_DF||e.host===_.commonConstants.gridHosts.FREE_GRID_TESTIM;return t&&!this.companiesService.isPayingPlan()&&this.featureFlagsService.flags.runFreeGridOnDeviceFarm.isEnabled()}isGridEnabled(e,t){if(e===_.gridTypes.GRID_TYPE_TESTIM_TVC){const e=(t===null||t===void 0?void 0:t.expireAt)&&Date.now()>t.expireAt||false;return!e}if(e===_.gridTypes.GRID_TYPE_P_CLOUDY){return this.featureFlagsService.flags.enablePCloudyGrid.isEnabled()}return true}};t.GridsService=j;i([f.observable,o("design:type",Object)],j.prototype,"explicitUpdate",void 0);i([f.observable.shallow,o("design:type",typeof(u=typeof Record!=="undefined"&&Record)==="function"?u:Object)],j.prototype,"_preferredGrids",void 0);i([f.observable.shallow,o("design:type",Array)],j.prototype,"grids",void 0);i([f.observable.shallow,o("design:type",Object)],j.prototype,"gridsConfiguration",void 0);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],j.prototype,"hasTdcGrid",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],j.prototype,"hasTvcGrid",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],j.prototype,"companyGrids",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[Object])],j.prototype,"preferredGrid",null);t.GridsService=j=i([(0,p.injectable)(),o("design:paramtypes",[typeof(n=typeof y.CompaniesService!=="undefined"&&y.CompaniesService)==="function"?n:Object,typeof(r=typeof S.ProjectsService!=="undefined"&&S.ProjectsService)==="function"?r:Object,typeof(a=typeof E.FeatureFlagsService!=="undefined"&&E.FeatureFlagsService)==="function"?a:Object,typeof(c=typeof b.TestimServicesApi!=="undefined"&&b.TestimServicesApi)==="function"?c:Object,typeof(l=typeof v.UrlStateService!=="undefined"&&v.UrlStateService)==="function"?l:Object])],j)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g;Object.defineProperty(t,"__esModule",{value:true});t.MobileAppsStore=void 0;const v=s(81);const S=s(9);const y=s(2);const b=s(27);const _=s(22);const T=s(14);const E=s(15);const I=s(5);const C=s(7);const D=s(26);const O=s(21);const A=s(6);const j=s(543);const w=s(28);const R=s(45);const P=s(20);const x=s(94);const M=s(67);const N=s(545);const F=s(126);const L=s(553);const k=s(556);const B=s(569);const U=s(8);const G=s(98);const V=[];const H=C.Logger.getLogger("MobileAppsStore");let $=class e{constructor(e,t,s,i,o,n,r){this.projectsService=e;this.testimServicesApi=t;this.urlStateService=s;this.analyticsService=i;this.modalService=o;this.mobileFileUploadService=n;this.featureFlagsService=r;this.uploadingFile=false;this.uploadError="";this.sortDirection=j.SORT_DIRECTIONS.ASC;this.isPerformingAction=false;this.uploadToGridRequests=new y.ObservableMap;this.abortController=new AbortController;this.addUploadToGridRequest=(e,t)=>{this.uploadToGridRequests.set(e,t)};this.updateUploadToGridRequest=(e,t,s)=>{const i=this.uploadToGridRequests.get(e);if((i===null||i===void 0?void 0:i.status)==="pending"){this.uploadToGridRequests.set(e,{...i,status:t,...s&&{message:s}})}};this.clearUploadError=()=>{this.uploadError=""};this.discardButtonClicked=()=>{this.abortFileTransfer();this.discardFile();this.clearUploadError()};this.handleUploadFile=async(e,t)=>{this.uploadingFile=true;this.clearUploadError();try{this.mobileFileUploadService.checkFilePropsBeforeUpload(e,this.uploadedFileTypes,this.maxUploadedSize);this.abortController=new AbortController;this.currentUploadedFile=e;await this.mobileFileUploadService.uploadFile(e,this.abortController);this.mobileAppsFromPromise=(0,b.fromPromise)(this.loadMobileApps());if(t){t()}}catch(e){if(F.MobileFileUploadService.isUserAbortedError(e)){return}H.error("Error while trying to upload a file",{error:e});this.uploadError=e.message}finally{this.uploadingFile=false}};this.discardFile=e=>{this.currentUploadedFile=undefined;if(e){e(true)}};this.uploadMobileApp=async()=>await this.modalService.openModal(N.UploadMobileAppModal).promise;this.getAvailableActions=e=>{const t=e.size===1;return[{execute:(e,[t])=>this.renameMobileApp(t),name:"Rename Application",icon:"rename",isHidden:!t},{execute:(e,[t])=>this.copyAppIdToClipboard(t.appId||""),name:"Copy ID",icon:"copy",isHidden:!t},{execute:(e,[t])=>this.downloadMobileApp(t),name:"Download File",icon:"download",isHidden:!t},{execute:(e,[t])=>this.deleteMobileApp(t),name:"Delete",icon:"trash-v4",isHidden:!t},{execute:(e,t)=>this.handleUploadToGridAction(t),name:"Upload to grid",icon:"upload-grid",isHidden:!e.size||e.size>3||!this.areAllRequestSettled}]};(0,y.autorun)((()=>{this.mobileAppsFromPromise=(0,b.fromPromise)(this.loadMobileApps())}))}abortFileTransfer(){this.abortController.abort()}get areAllRequestSettled(){return Array.from(this.uploadToGridRequests.values()).every((e=>e.status!=="pending"))}get maxUploadedSize(){return this.projectsService.projectDefaults.maxMobileAppUploadSize?F.BIG_APP_FILE_SIZE:F.MAX_FILE_SIZE}get isUploadingFile(){return this.uploadingFile}get uploadedFileTypes(){return this.projectsService.isAndroid?[I.MOBILE_APP_FILE_TYPES.ANDROID]:[I.MOBILE_APP_FILE_TYPES.IOS,I.MOBILE_APP_FILE_TYPES.IOS_SIMULATOR,I.MOBILE_APP_FILE_TYPES.NATIVE_IOS_SIMULATOR]}get hasReachedMaxMobileAppsUploadLimitForProject(){const{limitNumberOfUploadedMobileApplication:e,allowedNumberOfUploadedMobileApplications:t}=this.projectsService.projectDefaults;if(!e||!t){return false}return t<=this.mobileApps.length}get downloadMimeType(){return this.projectsService.isAndroid?I.MOBILE_APP_MIME_TYPES.ANDROID:I.MOBILE_APP_MIME_TYPES.IOS}get mobileAppsRedesign(){return this.featureFlagsService.flags.mobileAppsRedesign.isEnabled()}get headers(){if(this.mobileAppsRedesign){return[{name:"name",content:"APP",isSortable:true},{name:"name",content:"VERSION",isSortable:true},{name:"name",content:"UPLOADED",isSortable:true}]}return[{name:"appMetadata.name",content:"APPLICATION NAME",isSortable:true},{name:"version",content:"VERSION"},{name:"minOsVersion",content:"MIN. SUPPORTED OS"},{name:"size",content:"SIZE"},{name:"created_at",content:"UPLOADED"}]}get bundledMobileApps(){const e=new Map;this.mobileApps.sort(((e,t)=>G(t.created_at||-1).valueOf()-G(e.created_at||-1).valueOf())).forEach((t=>{var s,i;const o=t.appMetadata.id;const n=t.appMetadata.version;if(!e.has(o)){const i=new Map;e.set(o,{identifier:o,created_at:t.created_at,name:(t===null||t===void 0?void 0:t.name)||((s=t.appMetadata)===null||s===void 0?void 0:s.name)||t.fileName,versions:i})}if(!((i=e.get(o))===null||i===void 0?void 0:i.versions.has(n))){e.get(o).versions.set(n,{})}const r=e.get(o).versions.get(n);if(t.fileName.endsWith(".ipa")){r.physical=t}else{r.virtual=t}}));return e}get mobileApps(){var e;if(((e=this.mobileAppsFromPromise)===null||e===void 0?void 0:e.state)!=="fulfilled"){return[]}return this.mobileAppsFromPromise.value}async loadMobileApps(){try{if(!this.projectsService.isMobile){return[]}return await this.testimServicesApi.mobileApp.getApp(this.projectsService.projectId)}catch(e){H.warn("failed to get mobile apps",{error:e});return[]}}get searchFilter(){var e;return(e=this.urlStateService.searchParams.search)!==null&&e!==void 0?e:""}get filterStatus(){const e=this.mobileAppsRedesign?this.bundledMobileApps.size:this.mobileApps.length;const t=this.mobileAppsRedesign?this.bundledMobileApps.size:this.mobileApps.length;return{filtersLength:e,totalLength:t,isFiltering:Boolean(this.searchFilter),filter:this.searchFilter}}get listItems(){const{searchFilter:e,mobileApps:t,analyticsService:s}=this;s.track("mobile-apps-list-search");return(0,A.chain)(t).filter((({appMetadata:t,fileName:s})=>{var i;const o=(e||"").toLowerCase();const n=s===null||s===void 0?void 0:s.toLowerCase().includes(o);if(t&&"name"in t){return((i=t.name)===null||i===void 0?void 0:i.toLowerCase().includes(o))||n}return n})).orderBy((e=>e===null||e===void 0?void 0:e.fileName.toLowerCase()),this.sortDirection||j.SORT_DIRECTIONS.ASC).value()}get filter(){const{filterStatus:e,listItems:t,onApplyFilter:s}=this;return{filterStatus:e,listItems:t,onApplyFilter:s,sections:V}}get bundledAppsFilter(){const{filterStatus:e,onApplyFilter:t}=this;return{filterStatus:e,listItems:this.bundledAppsListItems,onApplyFilter:t,sections:V}}get bundledAppsListItems(){const{searchFilter:e,analyticsService:t}=this;t.track("mobile-apps-list-search");return(0,A.chain)(Array.from(this.bundledMobileApps.values())).filter((({name:t,identifier:s})=>{const i=(e||"").toLowerCase();return t.toLowerCase().includes(i)||s.toLowerCase().includes(i)})).value()}onApplyFilter([e,[t]]){this.urlStateService.updateParams({showOnlySuperAdmin:t,group:e})}get shouldShowDeviceTypeColumn(){return this.projectsService.isIos&&this.featureFlagsService.flags.showApplicationTypeMobileAppsColumn.isEnabled()}async deleteMobileApp(e){this.analyticsService.track("apps-library-delete");const t=await this.testimServicesApi.mobileApp.getAssociatedTests(this.projectsService.projectId,e);if(t.length){await this.modalService.openModal(L.DeleteMobileApp,{associatedTests:t,mobileAppName:e.fileName}).promise;return}const s=await this.modalService.openModal(R.MessageModal,{title:"Delete Mobile App",body:`Are you sure you want to delete ${e.fileName}?`,okText:"DELETE",cancelText:"CANCEL",variety:"normal",icon:"trash-v4",className:v.default.deletionModal}).promise;if(!s){return}this.isPerformingAction=true;try{await this.testimServicesApi.mobileApp.delete(e,this.projectsService.projectId)}catch(t){H.error("Failed to delete an app from the mobile apps list",{error:t,appId:e.appId})}(0,y.runInAction)((()=>{this.isPerformingAction=false;this.mobileAppsFromPromise=(0,b.fromPromise)(this.loadMobileApps())}))}async renameMobileApp(e){var t;this.analyticsService.track("apps-library-rename");const s=((t=e.appMetadata)===null||t===void 0?void 0:t.name)||"New name";const i=await this.modalService.openFormModal({header:"Edit name",items:{name:{props:{autoFocus:true,placeholder:s},type:"textbox",label:"New name",value:s,validate:e=>{if(!e){return"New name cannot be empty"}return""}}}}).promise;if(!(i===null||i===void 0?void 0:i.name)){return}this.isPerformingAction=true;try{await this.testimServicesApi.mobileApp.renameApp(this.projectsService.projectId,e,i.name)}catch(t){H.error("Failed to rename an app from the mobile apps list",{error:t,appId:e.appId,newName:i.name})}(0,y.runInAction)((()=>{this.isPerformingAction=false;this.mobileAppsFromPromise=(0,b.fromPromise)(this.loadMobileApps())}))}async downloadMobileApp(e){try{this.analyticsService.track("apps-library-download");const t=this.projectsService.projectId;const s=await(0,x.addTokenToFileUrl)(t,[{name:e.fileName,url:e.filePath}],this.testimServicesApi,false,H);const i=s[0].url;(0,P.downloadFile)(e.fileName,i,this.downloadMimeType)}catch(e){H.warn("failed to download mobile app",{error:e})}}async handleUploadToGridAction(e){if(!this.areAllRequestSettled){return}this.uploadToGridRequests=new y.ObservableMap;const t=await this.modalService.openModal(k.UploadMobileAppToGrid).promise;if(!(t===null||t===void 0?void 0:t.gridId)){return}const s=this.projectsService.projectId;U.utils.promiseMap(e,(async e=>this.uploadAppToGrid(s,t.gridId,e)));await this.modalService.openToast(B.UploadAppsProgressToast,{position:"left"}).promise}abortUploadAppToGridRequest(e){var t,s;(s=(t=this.uploadToGridRequests.get(e))===null||t===void 0?void 0:t.abortController)===null||s===void 0?void 0:s.abort();this.updateUploadToGridRequest(e,"aborted")}async uploadAppToGrid(e,t,s){const i=new AbortController;const o=`request_${U.utils.guid()}`;this.addUploadToGridRequest(o,{app:s,abortController:i,status:"pending"});try{await this.testimServicesApi.mobileApp.uploadAppToGrid(e,t,s,i.signal);this.updateUploadToGridRequest(o,"success")}catch(e){if(e.status===409){const t=e.response;this.updateUploadToGridRequest(o,"error",t)}else{this.updateUploadToGridRequest(o,"error")}}}copyAppIdToClipboard(e){this.analyticsService.track("apps-library-copy-id");if(!e){this.modalService.openToast(M.Toast,{children:"An error occurred while trying to copy app ID",timeout:3e3,icon:{type:"exc-mark",backgroundType:"error"}});return}(0,P.copyToClipboard)(e);this.modalService.openToast(M.Toast,{children:"Your app ID was copied to clipboard",timeout:3e3,icon:{type:"check",backgroundType:"success"}})}get bundledAppsAction(){return{getSelectionActions:e=>[]}}get actions(){return{getSelectionActions:this.getAvailableActions}}};t.MobileAppsStore=$;i([y.observable.ref,o("design:type",Object)],$.prototype,"uploadingFile",void 0);i([y.observable.ref,o("design:type",typeof(p=typeof File!=="undefined"&&File)==="function"?p:Object)],$.prototype,"currentUploadedFile",void 0);i([y.observable.ref,o("design:type",Object)],$.prototype,"mobileAppsFromPromise",void 0);i([y.observable,o("design:type",Object)],$.prototype,"uploadError",void 0);i([y.observable,o("design:type",Object)],$.prototype,"sortDirection",void 0);i([y.observable,o("design:type",Object)],$.prototype,"isPerformingAction",void 0);i([y.observable,o("design:type",typeof(m=typeof UploadToGridRequestMap!=="undefined"&&UploadToGridRequestMap)==="function"?m:Object)],$.prototype,"uploadToGridRequests",void 0);i([y.action,o("design:type",Object)],$.prototype,"addUploadToGridRequest",void 0);i([y.action,o("design:type",Object)],$.prototype,"updateUploadToGridRequest",void 0);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"areAllRequestSettled",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"maxUploadedSize",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"isUploadingFile",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"uploadedFileTypes",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"hasReachedMaxMobileAppsUploadLimitForProject",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"downloadMimeType",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"mobileAppsRedesign",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"headers",null);i([y.computed,o("design:type",typeof(g=typeof BundledApps!=="undefined"&&BundledApps)==="function"?g:Object),o("design:paramtypes",[])],$.prototype,"bundledMobileApps",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"mobileApps",null);i([y.computed,o("design:type",String),o("design:paramtypes",[])],$.prototype,"searchFilter",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"filterStatus",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"listItems",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"filter",null);i([y.computed,o("design:type",Object),o("design:paramtypes",[])],$.prototype,"bundledAppsFilter",null);i([y.computed,o("design:type",Array),o("design:paramtypes",[])],$.prototype,"bundledAppsListItems",null);i([y.action.bound,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],$.prototype,"onApplyFilter",null);i([y.computed,o("design:type",Boolean),o("design:paramtypes",[])],$.prototype,"shouldShowDeviceTypeColumn",null);t.MobileAppsStore=$=i([(0,S.injectable)(),o("design:paramtypes",[typeof(n=typeof E.ProjectsService!=="undefined"&&E.ProjectsService)==="function"?n:Object,typeof(r=typeof _.TestimServicesApi!=="undefined"&&_.TestimServicesApi)==="function"?r:Object,typeof(a=typeof D.UrlStateService!=="undefined"&&D.UrlStateService)==="function"?a:Object,typeof(c=typeof O.AnalyticsService!=="undefined"&&O.AnalyticsService)==="function"?c:Object,typeof(l=typeof w.ModalService!=="undefined"&&w.ModalService)==="function"?l:Object,typeof(u=typeof F.MobileFileUploadService!=="undefined"&&F.MobileFileUploadService)==="function"?u:Object,typeof(d=typeof T.FeatureFlagsService!=="undefined"&&T.FeatureFlagsService)==="function"?d:Object])],$)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E,I,C,D,O;Object.defineProperty(t,"__esModule",{value:true});t.PlaybackStore=void 0;const A=s(6);const j=s(66);const w=s(9);const R=s(205);const P=s(5);const x=s(161);const M=s(62);const N=s(7);const F=s(55);const L=s(2);const k=s(15);const B=s(34);const U=s(29);const G=s(234);const V=s(102);const H=s(28);const $=s(67);const W=s(129);const J=s(26);const Y=s(63);const z=s(119);const q=s(22);const X=s(49);const Z=s(61);const Q=s(585);const K=s(21);const ee=s(79);const te=s(83);const se=s(14);const ie=s(588);const oe=s(100);const ne=s(45);const re=s(589);const ae=s(128);const ce=s(51);const le=s(43);const ue=s(8);const de=s(33);const pe=s(48);const he=s(87);const fe=s(162);const me=s(82);const ge=s(163);const ve=s(604);const Se=s(154);const ye=s(609);const be=s(188);const _e=s(615);const Te=s(616);const Ee=new oe.LoadUtils(le.testimServices);const Ie=N.Logger.getLogger("scenario-service");const Ce=["cli-validation-code-step","cli-wait-for-code-step","cli-action-code-step","cli-api-code-step","cli-condition-step","cli-email-code-step"];const De=be.switchboard.getRemote("recordingService",{ignoreTimeoutByDefault:true});let Oe=class e extends de.EventEmitter{constructor(e,t,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E){super();this.branchesService=e;this.editedTestStore=t;this.gridsService=i;this.hostService=o;this.modalService=n;this.premiumFeaturesService=r;this.projectsService=a;this.testResultListenerService=c;this.testResultStore=l;this.urlStateService=u;this.notificationDisplayService=d;this.keyInputService=p;this.testimServicesApi=h;this.userService=f;this.analyticsService=m;this.extensionService=g;this.featureFlagsService=v;this.hiddenParamsService=S;this.restrictToChrome=y;this.mobileAgentService=b;this.hooksService=_;this.setupMobileTestStore=T;this.runsService=E;this.isPlaying=false;this.isPaused=false;this.isLocalRunning=false;this.isDebuggingDisabled=false;this.isDebuggingCodeStep=false;this.isIncognito=false;this.isPlayTestStarted=false;this.isRemoteRunning=false;this.isLocalCliRun=false;this.isWaitingLastExecutionToFinish=false;this._playbackDoneExplicitUpdate=0;this._isPlaybackInitializing=false;this.pendingStepResults={};this.updateIsIncognitoAllowed=async()=>{var e;if(!(this.hostService.activeHost instanceof ge.EditorHostService)){return}const t=await this.hostService.activeHost.isIncognitoAllowedOnBrowser();this.isIncognito=Boolean(t&&((e=this.userService.getPreferences().player)===null||e===void 0?void 0:e.isIncognito))};this.clearPendingResults();Promise.resolve().then((()=>s(84))).then((({RecordingStore:e})=>{this.recordingStore=Z.container.get(e)}));(0,L.reaction)((()=>this.userService.isLoggedIn()&&Boolean(this.hostService.activeHost)),(e=>e&&this.updateIsIncognitoAllowed()));(0,L.reaction)((()=>[this.isPlaying,this.isLocalRunning,this.isPaused,this.projectsService.isMobile]),(()=>{if(this.projectsService.isMobile){if(this.isPaused){De.playState.set("paused");return}De.playState.set(this.isPlaying||this.isLocalRunning?"playing":"idle")}}));(0,L.reaction)((()=>[this.projectsService.isMobile]),(()=>{if(this.projectsService.isMobile){De.isRecording.set(this.recordingStore.isRecording)}}))}get isPlayingAndNotPaused(){return this.isPlaying&&!this.isPaused}getIncognitoAndNetworkAnalytics(){var e,t;return{useIncognito:this.projectsService.isWeb&&this.isIncognito?"on":"off",useMockNetwork:((t=(e=this.editedTestStore.scenario)===null||e===void 0?void 0:e.mockNetworkOptions)===null||t===void 0?void 0:t.isEnabledForPlayback)?"on":"off"}}async runFromHere(e,t){var s,i;const o=(this.urlStateService.params.path||"").split(":");const n=this.urlStateService.params.stepId||((s=this.editedTestStore.scenario)===null||s===void 0?void 0:s.id);const r=[e].concat((i=this.editedTestStore.scenario)===null||i===void 0?void 0:i.findStepHierarchy(n,o));const a="play-from-here";try{await this.restrictToChrome.restrict();await this.basicPlayTestFlow({event:t,analyticsEventSource:a,playMessageType:P.commonConstants.scenario.RUN_FROM_HERE,instancePath:r.reverse(),analyticsProps:{runType:"playFromHere",...this.getIncognitoAndNetworkAnalytics()}})}catch(e){}}async playStep(e,t){var s;const i=P.commonConstants.scenario.PLAY_STEP;const o=this.isPlaying&&((s=this.editedTestStore.test)===null||s===void 0?void 0:s.resultId)?this.editedTestStore.test.resultId:ue.utils.guid();const n=null;const r=null;const a=null;const c=null;try{await this.restrictToChrome.restrict();return this.basicPlayTestFlow({event:e,analyticsEventSource:c,playMessageType:t||i,instancePath:n,runParamsOverride:r,baseUrlOverride:a,resultId:o})}catch{}return undefined}reRunCurrentTestWithRunParamsFromResult(e,t){var s;const i=this.testResultStore.currentTestResultRunParams;const o=(s=this.testResultStore.currentTestResultRunConfig)===null||s===void 0?void 0:s.baseUrl;const n=null;const r=async()=>{await this.restrictToChrome.restrict();return await this.basicPlayTestFlow({event:e,analyticsEventSource:t,playMessageType:P.commonConstants.scenario.TOGGLE_PLAY,instancePath:n,runParamsOverride:i,baseUrlOverride:o,analyticsProps:{runType:"reRunWithSameParams",...this.getIncognitoAndNetworkAnalytics()}})};if(!this.hiddenParamsService.isContainingHiddenParams(i||{})){return r()}return this.hiddenParamsService.openRerunDialog().then((e=>{if(!e){return undefined}const t=this.hiddenParamsService.getHiddenParams();t.forEach((e=>{if(i[e]){delete i[e]}}));return r()})).catch((()=>{}))}async basicPlayTestFlow({event:e,analyticsEventSource:t,playMessageType:s,instancePath:i,runParamsOverride:o,baseUrlOverride:n,resultId:r=ue.utils.guid(),shouldSendAnalyticsEvent:a=true,analyticsProps:c={}}){if(a){this.testStartAnalytics(t,c)}this.addListenersOnLocalRunning(r);this.editedTestStore.test.resultId=r;try{await this.hostService.activeHost.canPlay();await this.showFileSchemeAccessAllowedDialog();await this.showAgentConnectionDialog();await this.validateNoHiddenHookSteps();if(this.recordingStore.isRecording){this.analyticsService.testRecord({recordType:"stopRecordDueToRun",eventSource:"stop-record-run",testId:this.editedTestStore.test.id})}this._onStopRecord();let t=await this.buildPlayParameters(e,i,o,n,!!this.isIncognito,this.current);if(this.projectsService.isMobile){const e=await this.mobileAgentService.getMirroringInfo();t={...t,windowProps:e}}this.onTestStartToRunLocal(s===P.commonConstants.scenario.PLAY_WITHOUT_DEBUG?{isDebuggingDisabled:true}:undefined);this.reportEditorTestStarted();this.setResultIdUrl(t.resultId,{shouldFocusCurrentStep:s===P.commonConstants.scenario.RUN_FROM_HERE});this.hostService.activeHost.initBackgroundState();return await this.hostService.activeHost.send(s,t)}catch(e){return this.handlePlayTestError(e,false)}}listenToRemoteRun(e,t,s){var i;const o=(i=this.editedTestStore.test)===null||i===void 0?void 0:i.resultId;if(o){this.testResultListenerService.leaveTestResult(o,e)}this.setResultIdUrl(t);this.editedTestStore.test.resultId=t;this.isRemoteRunning=true;this._onStopRecord();this.onSetupRunning(s);this.testResultStore.reset();this.addListenersToRemoteRun(e,t)}setResultIdUrl(e,t){if(this.isPlaying||(t===null||t===void 0?void 0:t.shouldFocusCurrentStep)){this.urlStateService.updateParams({"result-id":e})}else{const{projectId:t,branch:s,testId:i}=this.urlStateService.params;this.urlStateService.go(j.testResult(t,s,i,e,undefined,this.urlStateService.searchParams["parent-folder-id"]))}}handlePlayTestError(e,t=false){this.isPlayTestStarted=false;if(e instanceof R.CancellationError||e instanceof R.StartPlaybackError){return}if(t&&e.message===P.commonConstants.error.NOT_ON_CHROME){return}if(e instanceof x.ExecutionBlockedError){this.notificationDisplayService.sendNotification(e.message);return}Ie.error("error while trying to play",e);if(e.message===P.commonConstants.error.MESSAGE_LENGTH_EXCEEDED_MAX_LENGTH_ERROR_MESSAGE){this.notificationDisplayService.sendNotification("Error while trying to play test, the test is too long")}else{this.notificationDisplayService.sendNotification("Error while trying to play test")}}handleStopRunningTestError(e){this.notificationDisplayService.sendNotification(new Error(`Error could not stop ${e}, please try again`))}reportEditorTestStarted(e=this.editedTestStore.test.id,t=this.editedTestStore.test.resultId,s=this.editedTestStore.test.name){if(this.testResultStore.lastReportedTest&&this.testResultStore.lastReportedTest.resultId===t){return undefined}const i=ue.utils.guid();const o=this.projectsService.projectId;const n=Date.now();this.testResultStore.lastReportedTest={resultId:t,startTime:n,executionId:i,testId:e};const r={[t]:{testId:e,status:"RUNNING",name:s,startTime:n,resultId:t,testStatus:this.editedTestStore.test.testStatus}};const{selectedDevice:a}=this.setupMobileTestStore;const c=a&&(0,_e.normalizeLocalTmaDevice)(a);if(c){this.testResultStore.testResult={...this.testResultStore.testResult,device:c}}this.testimServicesApi.execution.reportStarted(i,o,["local-editor"],n,r,{source:"editor",parallel:1,browser:this.projectsService.isMobile?undefined:"chrome",device:this.projectsService.isMobile?a&&(0,_e.normalizeLocalTmaDevice)(a):undefined,runnerVersion:"LocalRunner",testimBranch:this.branchesService.branch},false);this.trigger(P.commonConstants.scenario.PLAYING);return i}async getDevice(){if(!this.projectsService.isMobile){return null}await this.setupMobileTestStore.setupMobileTestIfNeeded();return this.editedTestStore.device}async buildPlayParameters(e,t,s,i,o,n){var r,a;const c=await this.getDevice();if(this.projectsService.isMobile){if(!c){throw new R.CancellationError}if(this.featureFlagsService.flags.checkDeviceStatus.isEnabled()){const e=await this.setupMobileTestStore.checkIfDeviceReadyForInteractions(c);if(e){this.modalService.openModal(ne.MessageModal,{title:"Error",variety:"error",body:e.message,okText:"DISMISS",textAlign:"left"});throw new R.CancellationError}}}const l=await(0,Te.getPlaybackTreeBuilder)();const u=await l.buildPlaybackTreeForTest({sharedStepService:ce.sharedStepSingleton,testimServices:this.testimServicesApi,branch:this.branchesService.branch,test:n,instancePath:t,baseUrl:i,runParamsOverride:s,mockNetworkRunOptions:{disableMockNetwork:!this.editedTestStore.scenario.mockNetworkOptions.isEnabledForPlayback}});u.incognito=!!o;u.config.mobileWebOpenTabAsPopup=this.featureFlagsService.flags.mobileWebOpenTabAsPopup.isEnabled();if(this.premiumFeaturesService.isTtaSfdcEnabled&&!u.config.sfdcCredential){u.config.sfdcCredential=(a=(r=this.branchesService.getBranchData(this.branchesService.branch))===null||r===void 0?void 0:r.sfdcCredential)!==null&&a!==void 0?a:""}if(n.scenario._isDirty){u.isDirty=true}if(u.hooks.warn){const e=this.modalService.openModal(ne.MessageModal,{title:"Warning",icon:"warning",variety:"warning",body:"The current config contains a hook that does not exist in the current branch. The test will run without this hook.",okText:"Run anyway",cancelText:"Cancel"});const t=await e.promise;if(!t){throw new R.CancellationError}delete u.hooks.warn}const d=await this.getFirstStepIncomingParams(u);const p=await l.serializePlaybackTree(u,d);return{bypassSetup:e===null||e===void 0?void 0:e.ctrlKey,mobileDevice:c,mobileDeviceId:c===null||c===void 0?void 0:c.udid,deviceName:c===null||c===void 0?void 0:c.name,playbackTreeData:p,resultId:n.resultId}}async loadAdditionalParamsForStepResult(e){if(!e.result){return}const t=this.projectsService.projectId;const s=await Ee.loadAdditionalParamsForStepResult(t,e.result);e.result.incomingParams=s.incomingParams;e.result.outgoingParams=s.outgoingParams;e.setHiddenParamsResult();e.result.filteredIncomingParams=A.omit(e.result.incomingParams,P.commonConstants.FILTERED_INCOMING_PARAMS)}async getFirstStepIncomingParams(e){var t;if(!((t=e.player.path)===null||t===void 0?void 0:t.length)){return undefined}const s=e.player.path.at(-1);const i=this.getLastStepWithResultInTestFlow(s,e.player.path.map((e=>e.id)).slice(1));try{if(i){await this.loadAdditionalParamsForStepResult(i)}if(i===null||i===void 0?void 0:i.result){const e=this.getIncomingParamsForStartingStep(s.id,i);if(re.ParamsMetadataManager.hasHiddenParams(e)){const e=await this.modalService.openModal(ne.MessageModal,{title:"Warning",icon:"warning",variety:"warning",body:"This test result contains hidden parameters. Please note that these values will not be used in the following run.",okText:"Run",cancelText:"Cancel"}).promise;if(!e){throw new R.CancellationError}}return e}}catch(e){}return undefined}getIncomingParamsForStartingStep(e,t){if(e===t.id){return t.result.incomingParams}t.result.incomingParams[P.commonConstants.test.PARAMS_METADATA_FIELD]=re.ScopedMetadata.mergeMetadata(t.result.outgoingParams[P.commonConstants.test.PARAMS_METADATA_FIELD],t.result.incomingParams[P.commonConstants.test.PARAMS_METADATA_FIELD]);return Object.assign({},t.result.incomingParams,t.result.outgoingParams.global,t.result.outgoingParams.test,t.result.outgoingParams.local)}getStepIdsPath(e){return e.slice(0,e.length-1).join(":")}getLastStepWithResultInTestFlow(e,t){const s=(e,t)=>this.testResultStore.lastStepResults.find((s=>s.id===e&&(!s.path&&!t||s.path===t)));let i=s(e.id,this.getStepIdsPath(t));if(i){if(!e.result){e.result=i}return e}let o;for(const t of this.editedTestStore.scenario){const n=t.step;i=s(n.id,this.getStepIdsPath(t.path));if(i){if(!n.result){n.result=i}o=n}if(n.id===e.id){return o}}return undefined}onTestStartToRunLocal(e){this.isLocalRunning=true;this.isDebuggingDisabled=Boolean(e===null||e===void 0?void 0:e.isDebuggingDisabled)}_onStopRecord(){this.recordingStore.stopRecording()}addListenersOnLocalRunning(e){const t=this.editedTestStore.test.id;if(!this.isPaused){this.testResultStore.reset()}if(this.extensionService.extensionFeatures.reportLocalResults){this.leaveTestResultFromBg();const s=true;this.addListenersToResultFromBg(t,e,s)}else{this.addListenersToRemoteRun(t,e)}return e}addListenersToResultFromBg(e,t,s=false){if(!this.isPaused){this.testResultStore.reset()}const i=this.branchesService.branch;const o=this.projectsService.projectId;this.hostService.activeHost.on(P.commonConstants.localPlayback.STEP_RESULT_UPDATED,(e=>this.onStepResult(this.testResultStore.addStepResult(e))),this);this.hostService.activeHost.on(P.commonConstants.localPlayback.TEST_RESULT_UPDATED,(n=>{const{status:r,steppedIntoGroup:a}=n;this.testResultStore.testResult=Object.assign({},this.testResultStore.testResult,n);this.onTestResultStatusUpdate({branch:i,projectId:o,testId:e,resultId:t,testStatus:r,isLocalResult:true,reportToServer:s,steppedIntoGroup:a});if(n.status&&this.isWaitingLastExecutionToFinish){this.isWaitingLastExecutionToFinish=false}}),this);this.hostService.activeHost.on(P.commonConstants.localPlayback.SETUP_STEP_RESULT_UPDATED,(t=>this.updateTestSetupStepResult(t,e)),this);this.hostService.activeHost.on(P.commonConstants.localPlayback.RUN_CONFIG_PARAMS_RESULT,(e=>{this.testResultStore.testResult=Object.assign({},this.testResultStore.testResult);this.testResultStore.testResult.runConfig=e.runConfig;this.testResultStore.testResult.runParams=e.runParams}))}leaveTestResultFromBg(){this.hostService.activeHost.off([P.commonConstants.localPlayback.STEP_RESULT_UPDATED,P.commonConstants.localPlayback.TEST_RESULT_UPDATED,P.commonConstants.localPlayback.SETUP_STEP_RESULT_UPDATED,P.commonConstants.localPlayback.RUN_CONFIG_PARAMS_RESULT],this)}async hasCliSteps(){return Ce.some((e=>this.editedTestStore.scenario.findAllStepsByProperty("type",e).length>0))||await this.isTestConfigHooksContainingCLISteps()||this.editedTestStore.scenario.hasDownloadSteps()}async isTestConfigHooksContainingCLISteps(){var e,t,s;const i=Object.values((t=(e=this.editedTestStore.testConfig)===null||e===void 0?void 0:e.hooks)!==null&&t!==void 0?t:{}).filter(Boolean);for(const e of i){const t=e.infoId;const i=(s=ce.sharedStepSingleton.getInfoById(t))===null||s===void 0?void 0:s.type;if(Ce.includes(i)){return true}if(i==="group"){try{const e=await ce.sharedStepSingleton.loadSharedStepClass(t);return[...e].some((({step:e})=>Ce.includes(e.classType)))}catch(e){}}}return false}async validateNoHiddenHookSteps(){if(!this.featureFlagsService.flags.enableHooksPresentation.isEnabled()){return}const e=this.hooksService.testHiddenHooks;if(e.length){this.modalService.openModal(ve.HiddenHooksModal,{hiddenHooksNames:e.map((e=>e.name))});throw new R.StartPlaybackError("close-hidden-hooks-dialog")}}async showAgentConnectionDialog(){if(await this.hasCliSteps()){await this.checkAgentConnectionAndShowDialogIfNeeded()}}async checkAgentConnectionAndShowDialogIfNeeded(e){try{return await this.hostService.activeHost.send(P.commonConstants.scenario.CHECK_AGENT_CONNECTION)}catch(t){const s=await this.modalService.openModal(Q.AgentConnectionModal,e).promise;if(!s){throw new R.StartPlaybackError("close-cli-agent-dialog")}return s}}async showFileSchemeAccessAllowedDialog(){if(!this.editedTestStore.scenario.hasDownloadSteps()){return}const e=await this.isFileSchemeAccessAllowed();if(!e){const e=await this.extensionService.requestFileAccess();if(!e){throw new R.StartPlaybackError("close-file-scheme-access-allowed-dialog")}}}async playTest({event:e,analyticsEventSource:t,props:s,analyticsProps:i}){var o;if(this.isPlaying&&!this.isPaused){this.isPaused=true}this.isPlayTestStarted=true;try{await this.restrictToChrome.restrict();await this.basicPlayTestFlow({event:e,analyticsEventSource:t||null,playMessageType:(s===null||s===void 0?void 0:s.isDebuggingDisabled)?P.commonConstants.scenario.PLAY_WITHOUT_DEBUG:P.commonConstants.scenario.TOGGLE_PLAY,shouldSendAnalyticsEvent:Boolean(t),resultId:this.isPlaying&&((o=this.editedTestStore.test)===null||o===void 0?void 0:o.resultId)||ue.utils.guid(),analyticsProps:{...i||{},...this.getIncognitoAndNetworkAnalytics()}})}catch{}this.isPlayTestStarted=false}testStartAnalytics(e,t={}){var s,i,o;if(!this.isPaused&&e){const n={};if(this.projectsService.isMobile){n.deviceSource=((s=this.setupMobileTestStore.selectedDevice)===null||s===void 0?void 0:s.virtual)?"virtual":"physical";n.appSource=this.setupMobileTestStore.appSource}this.analyticsService.testRun({id:this.current.id,testId:this.current.id,resultId:this.current.resultId,eventSource:e,source:e,...((o=(i=this.editedTestStore.scenario)===null||i===void 0?void 0:i.mockNetworkOptions)===null||o===void 0?void 0:o.isEnabledForPlayback)&&{mode:"mock"},...n,...t});this.registerToTestFinished()}}registerToTestFinished(){this.deregisterToTestFinished();this.testFinishedListener=()=>{var e;const t=this.testResultStore.testResult;if(this.setupMobileTestStore.selectedDevice){this.testResultStore.testResult=Object.assign({},this.testResultStore.testResult,{device:this.setupMobileTestStore.selectedDevice})}if(!t){return}const s={resultId:t.id,testId:t.testId};if(this.projectsService.isMobile){s.deviceSource=((e=this.setupMobileTestStore.selectedDevice)===null||e===void 0?void 0:e.virtual)?"virtual":"physical";s.appSource=this.setupMobileTestStore.appSource}if(t.success){this.analyticsService.reportTestSuccess(s)}else{const e=(0,ye.getHandledErrorType)(t.reason);s.failureReason=t.reason;s.errorType=e;this.analyticsService.reportTestFailed(s)}if(t.recordedHarUrl){this.analyticsService.track("user-recorded-mock-network",{testId:t.testId,resultId:t.id,recordedHarUrl:t.recordedHarUrl});this.editedTestStore.assignMockNetworkOptions({isRecordingFullHar:false,recordedHarFileLocation:t.recordedHarUrl,harFileLocationForPlayback:t.recordedHarUrl})}this.deregisterToTestFinished()};this.playbackDoneDisposer=(0,L.reaction)((()=>this._playbackDoneExplicitUpdate),this.testFinishedListener)}deregisterToTestFinished(){var e;if(this.testFinishedListener){(e=this.playbackDoneDisposer)===null||e===void 0?void 0:e.call(this);this.testFinishedListener=null}}async isFileSchemeAccessAllowed(){const e=await this.extensionService.doesExtensionExist();const{IS_FILE_SCHEME_ACCESS_ALLOWED:t}=P.commonConstants.scenario;if(!e){return false}const s=await this.hostService.activeHost.send(t);return s===null||s===void 0?void 0:s.isAllowedAccess}get current(){return this.editedTestStore.test}get playbackDoneExplicitUpdate(){return this._playbackDoneExplicitUpdate}get isPlaybackInitializing(){return this._isPlaybackInitializing}updateTestSetupStepResult(e,t){if(!e){return}const{RUNNING:s}=P.commonConstants.stepStatus;if(e.status===s){this.onSetupRunning()}else{this.onSetupFinished(e,t)}}onTestResultLoaded(e,t){const{RUNNING:s,PAUSED:i,PENDING:o}=P.commonConstants.testStatus;if([s,i,o].includes(e.status)){if(e.source==="cli-local"){this.isLocalCliRun=true}else{this.isRemoteRunning=true}this.addListenersToRemoteRun(t,this.testResultStore.currentTestResultId)}this.updateTestSetupStepResult(e.setupStepResult,t)}async addListenersToRemoteRun(e,t){await this.testResultListenerService.joinToTestResult(t,e);const s=this.branchesService.branch;const i=this.projectsService.projectId;this.testResultListenerService.listenToSetupStepResult(t,e,(t=>this.updateTestSetupStepResult(t,e)));this.testResultListenerService.listenToTestRunConfig(t,e,(e=>{this.testResultStore.testResult=Object.assign({},this.testResultStore.testResult);this.testResultStore.testResult.runConfig=e}));this.testResultListenerService.listenToTestRunParams(t,e,(({runParams:e,runParamsUrl:t})=>this.testResultStore.onTestRunParams(e,t)));this.testResultListenerService.listenToStepResult(t,e,(e=>this.onStepResult(this.testResultStore.addStepResult(e))));this.testResultListenerService.listenToTestResultStatus(t,e,(o=>this.onTestResultStatusUpdate({branch:s,projectId:i,testId:e,resultId:t,testStatus:o,isLocalResult:false,reportToServer:true})))}onTestResultStatusUpdate({branch:e,projectId:t,testId:s,resultId:i,testStatus:o,isLocalResult:n=false,reportToServer:r=true,steppedIntoGroup:a}){const c={[P.commonConstants.testStatus.STOPPED]:()=>{if(n&&!r){this.onPlaybackDoneLocal(s);return}this.onPlaybackDone(s,i,t,e,n)},[P.commonConstants.testStatus.COMPLETED]:()=>{if(n&&!r){this.onPlaybackDoneLocal(s);return}this.onPlaybackDone(s,i,t,e,n)},[P.commonConstants.testStatus.PAUSED]:()=>this.onPausePlay(a),[P.commonConstants.testStatus.RUNNING]:()=>this.onStartPlay(s,i),[P.commonConstants.testStatus.PENDING]:()=>{},DEFAULT:()=>this.onStartPlay(s,i)};c[o||"DEFAULT"]()}onStartPlay(e,t){this.clearPendingResults();this.isPlaying=true;this.isPaused=false;const s="playbackStart";N.Logger.setGlobalInfo({testId:e,testResultId:t,status:s});this.keyInputService.activateLayer(P.commonConstants.KEY_BINDING_LAYERS.RUN);this.notificationDisplayService.removeNotifications(this.notificationDisplayService.MAIN_DISPLAY)}findParentOfNextStepToPlay(e){var t,s;const i=A.maxBy(this.testResultStore.stepResults,"endTimestamp");if(!i||!this.editedTestStore.scenario){return undefined}const o=[...this.editedTestStore.scenario];const n=o.findIndex((({step:e,sharedStep:t,path:s})=>{if(i.path!==null){return s.join(":").includes(i.path)&&[e.id,t===null||t===void 0?void 0:t.id].includes(i.id)}return[e.id,t===null||t===void 0?void 0:t.id].includes(i.id)}));const r=o[n].step;this.prevPlayedStep=r;let a=o[n+1];if(i.type==="shared-step-instance"&&i.status==="completed"&&r instanceof he.GroupStep){const e=r.steps.at(-1);const t=o.findIndex((({step:t})=>t===e));a=o[t+1]}if(a.step instanceof he.GroupStep&&(((t=a.step.steps[0])===null||t===void 0?void 0:t.hasBreakpoint)&&!this.featureFlagsService.flags.appNewAppDebugScheme.isEnabled()||e)){const e=a.step.steps[0];a=o.find((({step:t,sharedStep:s})=>[t.id,s===null||s===void 0?void 0:s.id].includes(e.id)))}const c=a.path.length>1?a.path.at(-2):o[0].step.id;const l=o.find((({step:e,sharedStep:t})=>[e.id,t===null||t===void 0?void 0:t.id].includes(c)));let{iterationId:u}=i;if(u&&l.step instanceof he.GroupStep&&i.type==="shared-step-instance"&&i.id===((s=l.sharedStep)===null||s===void 0?void 0:s.id)&&l.step.findStepIndex({id:a.step.id})===0){u=`${Number(u)+1}`}return{...l,iterationId:u}}buildLinkToParentOfBreakPoint(e){const t=this.findParentOfNextStepToPlay(e);if(!t){return undefined}const{path:s,step:i,sharedStep:o,iterationId:n}=t;if(i.type==="scenario"){const e=j.testResult(this.projectsService.projectId,this.branchesService.branch,this.editedTestStore.testId,this.urlStateService.searchParams["result-id"],this.urlStateService.searchParams);return e}const r=j.testResultWithStepPath(this.projectsService.projectId,this.branchesService.branch,this.editedTestStore.testId,(o===null||o===void 0?void 0:o.id)||i.id,(s===null||s===void 0?void 0:s.join(":"))||"",this.urlStateService.searchParams["result-id"],n,o===null||o===void 0?void 0:o.id,this.urlStateService.searchParams);return r}focusOnPausedStep(e){const t=this.buildLinkToParentOfBreakPoint(e);if(!t){return}this.urlStateService.go(t)}onPausePlay(e){this.isPaused=true;this.isDebuggingCodeStep=false;this.isPlayTestStarted=false;this.focusOnPausedStep(e);this.notificationDisplayService.sendNotification("The test reached a breakpoint");this.hostService.activeHost.sendAsync(P.commonConstants.AUT.SET_MESSAGE,{popupType:"breakpoint",totalDisplayTime:7500})}resetPlayingState(){this.isPlayTestStarted=false;this.isRemoteRunning=false;this.isLocalRunning=false;this.isPlaying=false;this.isDebuggingDisabled=false;this.isDebuggingCodeStep=false;this.isPaused=false}async onPlaybackDone(e,t,i,o,n){if(e!==this.editedTestStore.testId){return undefined}if(n){this.testResultStore.testResult.id=t}else{const s=await Ee.loadResult(e,t,i,o);this.testResultStore.testResult=Object.assign({},this.testResultStore.testResult,s)}const r=this.testResultStore.testResult;this._playbackDoneExplicitUpdate++;const a=r.success!==false?{popupType:"testComplete",totalDisplayTime:7500}:{popupType:"testFailed",popupText:r.reason,totalDisplayTime:7500};this.hostService.activeHost.sendAsync(P.commonConstants.AUT.SET_MESSAGE,a);if(r.success){this.userService.updateGuideTasks("run-successful-test")}if(this.testResultStore.lastReportedTest&&this.testResultStore.lastReportedTest.resultId===r.id){this.reportEditorTestEnded(r)}this.keyInputService.deactivateLayer(P.commonConstants.KEY_BINDING_LAYERS.RUN);N.Logger.setGlobalInfo({status:"playbackDone"});this.resetPlayingState();const c=await Promise.resolve().then((()=>s(240))).then((({TestStreamService:e})=>Z.container.get(e)));return Promise.all([this.testResultListenerService.leaveTestResult(t,e),c.leaveTestStream(e)])}onPlaybackDoneLocal(e){const t=this.testResultStore.testResult;if(e!==this.editedTestStore.testId){return}this._playbackDoneExplicitUpdate++;const s=t.success!==false?{popupType:"testComplete",totalDisplayTime:7500}:{popupType:"testFailed",popupText:t.reason,totalDisplayTime:7500};if(t.success){this.userService.updateGuideTasks("run-successful-test")}this.hostService.activeHost.sendAsync(P.commonConstants.AUT.SET_MESSAGE,s);this.keyInputService.deactivateLayer(P.commonConstants.KEY_BINDING_LAYERS.RUN);N.Logger.setGlobalInfo({status:"playbackDone"});this.resetPlayingState()}async reportEditorTestEnded(e){const{executionId:t,testId:s,resultId:i,startTime:o}=this.testResultStore.lastReportedTest;const n=this.projectsService.projectId;const{success:r,reason:a}=e;await this.testimServicesApi.execution.updateTest({projectId:n,status:"FINISHED",executionId:t,testId:s,resultId:i,startTime:o,endTime:Date.now(),success:r,failureReason:a});await this.testimServicesApi.execution.reportFinished(t,n,r)}startNewTestWhileTestIsRunning(){this.isWaitingLastExecutionToFinish=true}onStepResult(e){var t;let s;try{const t=this.editedTestStore.scenario.getStepByPath(e.path);s=t?t.findStepById(e.id):null}catch(e){Ie.log("_getStepByPath: step not loaded yet",e)}if(!s){this.setPendingResult(e.id,e)}if(s){if(s.type==="scenario"&&((t=this.editedTestStore.testConfig)===null||t===void 0?void 0:t.result)){e.stepScreenshot=this.editedTestStore.testConfig.result.stepScreenshot}const i=this.urlStateService.params.path;let o=this.urlStateService.params["iteration-id"];o=o===undefined?null:o;const{id:n,path:r,whileLoopEvaluated:a,iterationId:c}=e;const l=r?`${r}:${n}`:null;const u=A.chain((i||"").split(":")).dropRight().value();const d=u.length===0?null:u.join(":");if((i===r||i===l||d===l)&&(o===c||(c===null||c===void 0?void 0:c.startsWith(`${o}:`))||!o)){if(a){e=this.testResultStore.getFirstIteration(s,l,o)||e}s.setResult(e)}this.testResultStore.explicitStepResultUpdateInvalidate()}}onSetupRunning(e){if(e&&this.gridsService.isUsingFreeDFGrid(e)){this.freeGridWarning=this.modalService.openToast($.Toast,{children:"Preparing Testim's free grid",icon:{type:"play-icon-over-grid",backgroundType:"warning",color:"black"}})}const t={popupType:"setupRunning",popupText:"Testim is setting up this page for testing",totalDisplayTime:1e4};this.hostService.activeHost.sendAsync(P.commonConstants.AUT.SET_MESSAGE,t);this.testResultStore.resetStepsResults();this.setInitializingStart();this.editedTestStore.testConfig.isRunning=true}onSetupFinished(e,t){var s;if(t!==this.editedTestStore.testId){this._isPlaybackInitializing=false;return}(s=this.freeGridWarning)===null||s===void 0?void 0:s.close();this.hostService.activeHost.sendAsync(P.commonConstants.AUT.CLOSE_POPUP);this.setInitializingEnd();this.editedTestStore.testConfig.isRunning=false;this.editedTestStore.testConfig.isComplete=e.success;this.editedTestStore.testConfig.result=e}setInitializingStart(){this._isPlaybackInitializing=true;this._testRunInitializationCancelId=window.setTimeout((()=>{this._isPlaybackInitializing=false}),this.editedTestStore.testConfig.stepTimeout)}setInitializingEnd(){this._isPlaybackInitializing=false;if(this._testRunInitializationCancelId){window.clearTimeout(this._testRunInitializationCancelId)}}async validateCanPlay(){const e=await this.runsService.isExecutionBlockedDueToQuota;if(e){Ie.warn(`Execution was force-blocked after an attempt to run from the UI.\n                This probably means that a "Play test" button was not disabled even though the runs are blocked.`,{stack:(new Error).stack});throw new x.ExecutionBlockedError}return this.hostService.activeHost.canPlay()}clearPendingResults(){this.pendingStepResults={}}setPendingResult(e,t){this.pendingStepResults[e]=t}getAndDeletePendingResult(e){const t=this.pendingStepResults[e];delete this.pendingStepResults[e];return t}stopPlaying(e){this.isPlayTestStarted=false;if(e){this.analyticsService.testStopped({...e,testId:this.current.id})}this.hostService.activeHost.sendAsync(P.commonConstants.scenario.STOP_PLAY)}};t.PlaybackStore=Oe;i([L.observable,o("design:type",Object)],Oe.prototype,"isPlaying",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isPaused",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isLocalRunning",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isDebuggingDisabled",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isDebuggingCodeStep",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isIncognito",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isPlayTestStarted",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isRemoteRunning",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isLocalCliRun",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"isWaitingLastExecutionToFinish",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"prevPlayedStep",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"_playbackDoneExplicitUpdate",void 0);i([L.observable,o("design:type",Object)],Oe.prototype,"_isPlaybackInitializing",void 0);i([L.computed,o("design:type",Object),o("design:paramtypes",[])],Oe.prototype,"isPlayingAndNotPaused",null);i([L.action,o("design:type",Function),o("design:paramtypes",[String,String,Object]),o("design:returntype",void 0)],Oe.prototype,"listenToRemoteRun",null);i([L.action,o("design:type",Function),o("design:paramtypes",[Boolean]),o("design:returntype",void 0)],Oe.prototype,"onPausePlay",null);i([L.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],Oe.prototype,"resetPlayingState",null);i([L.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],Oe.prototype,"startNewTestWhileTestIsRunning",null);i([L.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],Oe.prototype,"onStepResult",null);i([L.action,o("design:type",Function),o("design:paramtypes",[Object,String]),o("design:returntype",void 0)],Oe.prototype,"onSetupFinished",null);t.PlaybackStore=Oe=i([(0,w.injectable)(),(0,pe.exposeGlobally)("playbackStore"),o("design:paramtypes",[typeof(n=typeof B.BranchesService!=="undefined"&&B.BranchesService)==="function"?n:Object,typeof(r=typeof U.EditedTestStore!=="undefined"&&U.EditedTestStore)==="function"?r:Object,typeof(a=typeof V.GridsService!=="undefined"&&V.GridsService)==="function"?a:Object,typeof(c=typeof M.HostService!=="undefined"&&M.HostService)==="function"?c:Object,typeof(l=typeof H.ModalService!=="undefined"&&H.ModalService)==="function"?l:Object,typeof(u=typeof F.PremiumFeaturesService!=="undefined"&&F.PremiumFeaturesService)==="function"?u:Object,typeof(d=typeof k.ProjectsService!=="undefined"&&k.ProjectsService)==="function"?d:Object,typeof(p=typeof G.TestResultListenerService!=="undefined"&&G.TestResultListenerService)==="function"?p:Object,typeof(h=typeof W.TestResultStore!=="undefined"&&W.TestResultStore)==="function"?h:Object,typeof(f=typeof J.UrlStateService!=="undefined"&&J.UrlStateService)==="function"?f:Object,typeof(m=typeof Y.NotificationDisplayService!=="undefined"&&Y.NotificationDisplayService)==="function"?m:Object,typeof(g=typeof z.KeyInputService!=="undefined"&&z.KeyInputService)==="function"?g:Object,typeof(v=typeof q.TestimServicesApi!=="undefined"&&q.TestimServicesApi)==="function"?v:Object,typeof(S=typeof X.UserService!=="undefined"&&X.UserService)==="function"?S:Object,typeof(y=typeof K.AnalyticsService!=="undefined"&&K.AnalyticsService)==="function"?y:Object,typeof(b=typeof ee.ExtensionService!=="undefined"&&ee.ExtensionService)==="function"?b:Object,typeof(_=typeof se.FeatureFlagsService!=="undefined"&&se.FeatureFlagsService)==="function"?_:Object,typeof(T=typeof ie.HiddenParamsService!=="undefined"&&ie.HiddenParamsService)==="function"?T:Object,typeof(E=typeof ae.RestrictToChrome!=="undefined"&&ae.RestrictToChrome)==="function"?E:Object,typeof(I=typeof te.MobileAgentService!=="undefined"&&te.MobileAgentService)==="function"?I:Object,typeof(C=typeof fe.HooksService!=="undefined"&&fe.HooksService)==="function"?C:Object,typeof(D=typeof me.SetupMobileTestStore!=="undefined"&&me.SetupMobileTestStore)==="function"?D:Object,typeof(O=typeof Se.RunsService!=="undefined"&&Se.RunsService)==="function"?O:Object])],Oe)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CSSSelector=void 0;const i=s(64);class o extends i.RelativeSelector{findElements(e){const t=e.getActualElement();return Array.from(t.querySelectorAll(this.getQuery()))}}t.CSSSelector=o},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.CustomReuseService=t.getSharedStepIcon=t.TYPE_TO_CATEGORY=t.STEP_CATEGORIES=void 0;const l=s(6);const u=s(9);const d=s(34);const p=s(5);const h=s(15);const f=s(2);const m=s(29);const g=s(92);const v=s(51);const S=["untitled validation","untitled action","untitled wait for","untitled group","untitled api validation","untitled api action","untitled CLI validation","untitled CLI action","untitled CLI wait for","untitled download validation","untitled wait for download","untitled email validation","untitled wait for email"];t.STEP_CATEGORIES={group:["group"],action:["action-code-step","cli-action-code-step","api-action","execute-driver-script"],validation:["user-code","validation-code-step","cli-validation-code-step","api-validation","cli-validation-download-file","email-validation-step","network-validation-step","accessibility-validation-shared-step"],wait:["wait-for-code-step","cli-wait-for-code-step","cli-wait-for-download-file"],salesforce:["salesforce-apex-action"]};const y={[p.FOLDER_CHILD_TYPES.FOLDER]:"folder-high",group:"group-empty","user-code":"validation","validation-code-step":"validation","cli-validation-code-step":"validation","email-validation-step":"validation","cli-validation-download-file":"validation","api-validation":"validation","network-validation-step":"network","wait-for-code-step":"timeout","cli-wait-for-code-step":"timeout","cli-wait-for-download-file":"timeout","action-code-step":"js","cli-action-code-step":"cli","api-action":"cloud-step","salesforce-apex-action":"apex-logo","accessibility-validation-shared-step":"a11y-step","marketplace-wrapper":"validation","execute-driver-script":"script"};t.TYPE_TO_CATEGORY=l.reduce(t.STEP_CATEGORIES,((e,t,s)=>Object.assign(e,t.reduce(((e,t)=>Object.assign(e,{[t]:s})),{}))),{});function b(e){if(e.customIcon){return e.customIcon}return y[e.type]}t.getSharedStepIcon=b;let _=class e{constructor(e,t,s,i){this.branchesService=e;this.foldersStore=t;this.projectsService=s;this.editedTestStore=i;this.testSavedCounter=0}initialize(){const e=(0,f.reaction)((()=>this.shouldSharedStepsReload),(()=>{v.sharedStepSingleton.loadSharedStepsFromEditor({projectId:this.projectsService.projectId,branch:this.branchesService.branch})}));this.editedTestStore.on(p.commonConstants.scenario.TEST_SAVED,(()=>this.testSavedCounter++));return e}get shouldSharedStepsReload(){return[this.projectsService.projectId,this.branchesService.branch,this.testSavedCounter]}get isSharedStepsReady(){return this.foldersStore.sharedStepsFoldersTree.state==="fulfilled"}get sharedSteps(){return l.chain(this.foldersStore.sharedStepsFoldersTree.value.sharedSteps).sortBy("name").filter((e=>!S.includes(e.name))).value()}get nonGroupSteps(){return this.sharedSteps.filter((e=>e.type!=="group"))}get marketplaceSteps(){return v.sharedStepSingleton.sharedStepInfos.filter((e=>Boolean(e.name))).filter((e=>e.marketplace&&!e.marketplace.hidden))}};t.CustomReuseService=_;i([f.observable,o("design:type",Object)],_.prototype,"testSavedCounter",void 0);i([f.computed.struct,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"shouldSharedStepsReload",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isSharedStepsReady",null);i([f.computed,o("design:type",Array),o("design:paramtypes",[])],_.prototype,"sharedSteps",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"nonGroupSteps",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"marketplaceSteps",null);t.CustomReuseService=_=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof d.BranchesService!=="undefined"&&d.BranchesService)==="function"?n:Object,typeof(r=typeof g.FoldersStore!=="undefined"&&g.FoldersStore)==="function"?r:Object,typeof(a=typeof h.ProjectsService!=="undefined"&&h.ProjectsService)==="function"?a:Object,typeof(c=typeof m.EditedTestStore!=="undefined"&&m.EditedTestStore)==="function"?c:Object])],_)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f;Object.defineProperty(t,"__esModule",{value:true});t.ConfigListStore=void 0;const m=s(6);const g=s(8);const v=s(20);const S=s(22);const y=s(15);const b=s(28);const _=s(21);const T=s(167);const E=s(78);const I=s(26);const C=s(695);const D=s(9);const O=s(63);const A=s(133);const j=s(2);const w=s(27);const R=s(7);const P=s(255);const x=s(235);const M=s(5);const N=R.Logger.getLogger("config-store");let F=class e{constructor(e,t,s,i,o,n,r){this.projectsService=e;this.modalService=t;this.analyticsService=s;this.saveUtils=i;this.urlState=o;this.notificationDisplayService=n;this.testimServices=r;this.selectableListRef={current:{}};this.explicitUpdate=0;this._isPlaygroundModeState=false;this.displayDevicePool=false;this._isPlaygroundModeState=(0,v.isPlaygroundModeState)(this.urlState);(0,j.autorun)((()=>{var e,t;if(!((t=(e=this.selectableListRef)===null||e===void 0?void 0:e.current)===null||t===void 0?void 0:t.selectedItems)){return}const[s]=this.selectableListRef.current.selectedItems;if(s){this.setSelectedConfig(s)}}));(0,j.autorun)((()=>{var e,t;if(!((t=(e=this.selectableListRef)===null||e===void 0?void 0:e.current)===null||t===void 0?void 0:t.isFilterOpen)){return}const s=this.selectableListRef.current.isFilterOpen;if(s){this.toggleDevicePool(false)}}))}get browsers(){return A.BROWSERS}get configList(){const e=this.explicitUpdate;const t=this.projectsService.projectId;const s=async()=>{try{return await this.loadConfigs(t)}catch(e){N.error("failed fetching test configs",{error:e});return[]}};return(0,w.fromPromise)(s(),w.fromPromise.resolve([]))}get defaultConfig(){const e=async()=>{const e=await this.configList;const t=e.find((e=>e.isDefault));return t&&new E.TestConfig(t)};return(0,w.fromPromise)(e())}findBrowser(e){if(!e||typeof e!=="string"){return this.browsers[0]}const t=[...A.BROWSERS].find((t=>t.name.toLowerCase().includes(e.toLowerCase())))||this.browsers[0];return Object.assign({},t)}findOs(e){const t=A.OSS.find((t=>t.name===e));const s=A.OSS.find((t=>t.synonyms.some((t=>e===null||e===void 0?void 0:e.includes(t)))));const i=t||s||A.OSS[0];return Object.assign({},i)}decorateConfig(e){if(!this.projectsService.isMobile){e.normalizedOS=e&&this.findOs(e.os);e.normalizedBrowser=e&&this.findBrowser(e.browser);e.normalizedResolution=e.resolution&&Object.assign({},e.resolution,{name:`${e.resolution.width}x${e.resolution.height}`})}else{const{os:t="",browser:s}=e;const[i,o]=t.split(" ");e.normalizedOS=e&&{name:i,version:o,synonyms:[t,i,o],hidden:false};e.normalizedBrowser=e&&{name:s,icon:i,value:s===null||s===void 0?void 0:s.toLowerCase()}}return e}async loadConfigs(e){if(e===M.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&this._isPlaygroundModeState){return[]}const t=await this.testimServices.testConfig.getConfigList(e);const s=t.filter((e=>e.name&&e.name!==E.DEFAULT_CONFIG_NAME&&(e.show||e.show===undefined))).map((e=>this.decorateConfig(e)));return s}async changeTestDefaultConfig(e){const t=await this.modalService.openModal(C.ChangeTestDefaultConfig,{selectedConfig:new E.TestConfig(e)}).promise;if(t===null||t===void 0?void 0:t.isNew){await this.saveTestConfig(t)}if(t){return new E.TestConfig(t)}return undefined}async editConfig(e){const t=new E.TestConfig(e);const s=await this.modalService.openModal(C.EditTestConfigModal,{okText:"CHANGE",selectedConfig:t,title:this.projectsService.isMobile?"EDIT CONFIGURATION":"EDIT CONFIG"}).promise;if(s){t.update(s);return t}return undefined}async saveTestConfig(e){await this.testimServices.testConfig.save(this.projectsService.projectId,e.getSerializableObject());this.explicitlyTriggerUpdate()}async editConfigAndSave(e){var t,s,i;const o=await this.editConfig(e);if(!o){return undefined}await this.saveTestConfig(o);const n=this.decorateConfig(o);this.analyticsService.track("test-config-edited",{name:n.name,os:(t=n.normalizedOS)===null||t===void 0?void 0:t.name,resolution:(s=n.normalizedResolution)===null||s===void 0?void 0:s.name,browser:(i=n.normalizedBrowser)===null||i===void 0?void 0:i.name});this.explicitlyTriggerUpdate();return o}buildDefaultTestConfig(){return new E.TestConfig({os:g.utils.os(),browser:"chrome",resolution:{width:1024,height:680},...this.projectsService.isMobile&&{stepDelay:0}})}async buildDefaultMobileWebTestConfig(){const e=await this.configList;const t=e.find((e=>e.name==="iPhone 6"||e.name==="iPhone 6/7/8"))||this.configList.value[0];return new E.TestConfig(t)}async getDefaultConfigPerProjectType(){const e=await this.defaultConfig;if(e){return e}let t=this.buildDefaultTestConfig();if(this.projectsService.isMobileWeb){t=await this.buildDefaultMobileWebTestConfig()}return t}buildNewTestConfig(){const e="";const t=A.OSS.find((e=>!e.hidden));const s=this.browsers[0];const i=A.RESOLUTIONS[0];const o=E.defaults.stepTimeout;const n=E.defaults.stepDelay;const r=E.defaults.setupStepTimeout;const a=E.defaults.hooks;const c=new E.TestConfig({id:g.utils.guid(),os:t.name,browser:s.name,name:e,stepTimeout:o,stepDelay:n,setupStepTimeout:r,resolution:{width:i.width,height:i.height},hooks:a,isNew:true});return this.decorateConfig(c)}explicitlyTriggerUpdate(){this.explicitUpdate++}async createNewConfig(){var e,t,s;const i=this.buildNewTestConfig();const o=await this.modalService.openModal(C.EditTestConfigModal,{okText:"ADD",selectedConfig:i,title:this.projectsService.isMobile?"CREATE NEW CONFIGURATION":"ADD NEW CONFIG"}).promise;if(!o){return undefined}try{i.update(o);await this.saveTestConfig(i);const n=this.decorateConfig(i);this.analyticsService.track("http://localhost:3000/app/",{name:n.name,os:(e=n.normalizedOS)===null||e===void 0?void 0:e.name,resolution:(t=n.normalizedResolution)===null||t===void 0?void 0:t.name,browser:(s=n.normalizedBrowser)===null||s===void 0?void 0:s.name});this.explicitlyTriggerUpdate();return i}catch(e){N.log("Failed to create test config",{err:e});this.notificationDisplayService.sendNotification("Failed to create new test config.");return undefined}}async cloneConfigs(e){if(m.isEmpty(e)){return undefined}if(e.length===1){const t=m.cloneDeep(e[0]);delete t.id;t.name=`Copy of ${t.name}`;return await this.renameConfig(t,true)}return this.cloneMultipleConfigs(e)}async cloneMultipleConfigs(e){const t=await this.modalService.openModal(P.CloneModal,{resourceCount:e.length,resourceName:"configurations",title:"Clone configurations"}).promise;if(!t){return}const s=e.map((({name:e,id:t})=>({name:`Copy of ${e}`,id:t})));try{await this.testimServices.testConfig.clone(this.projectsService.projectId,s);this.explicitlyTriggerUpdate()}catch(e){N.error("failed cloning testConfigs",{err:e,clonedConfigs:s});this.modalService.openModal(x.ErrorModal,{title:"Error",body:"Failed cloning configurations, please try again."})}}async renameConfig(e,t=false){const s=new E.TestConfig(e);const i=await this.modalService.openFormModal({header:t?"Clone configuration":"Edit name",okText:t?"CLONE":"OK",items:{name:{props:{placeholder:"Config name"},type:"textbox",label:t?"Name":"New name",value:e.name,validate:e=>{if(!e){return"Missing configuration name"}return""}}}}).promise;if(i){s.update(i);await this.saveTestConfig(s);return s}return undefined}async deleteConfig(e){const t=await this.modalService.openModal(C.ConfigInUseModal,{testConfig:e}).promise;if(t){const t=new E.TestConfig(e);t.update({show:false});this.notificationDisplayService.sendNotification(`Config ${e.name} was deleted from list.`);await this.saveTestConfig(t);this.explicitlyTriggerUpdate()}}async saveDefaultConfig(e){await this.testimServices.project.saveDefaultConfig(this.projectsService.projectId,e);this.explicitlyTriggerUpdate()}setSelectedConfig(e){this.selectedConfig=e}toggleDevicePool(e){var t;const s=this.selectableListRef.current;if((s===null||s===void 0?void 0:s.isFilterOpen)&&e){(t=s.setIsFilterOpen)===null||t===void 0?void 0:t.call(s,false)}this.displayDevicePool=e}};t.ConfigListStore=F;i([j.observable,o("design:type",typeof(p=typeof React!=="undefined"&&React.RefObject)==="function"?p:Object)],F.prototype,"selectableListRef",void 0);i([j.observable,o("design:type",Object)],F.prototype,"explicitUpdate",void 0);i([j.observable,o("design:type",typeof(h=typeof E.TestConfig!=="undefined"&&E.TestConfig)==="function"?h:Object)],F.prototype,"selectedConfig",void 0);i([j.observable,o("design:type",Object)],F.prototype,"displayDevicePool",void 0);i([j.computed,o("design:type",typeof(f=typeof w.IPromiseBasedObservable!=="undefined"&&w.IPromiseBasedObservable)==="function"?f:Object),o("design:paramtypes",[])],F.prototype,"configList",null);i([(0,j.computed)({keepAlive:true}),o("design:type",Object),o("design:paramtypes",[])],F.prototype,"defaultConfig",null);t.ConfigListStore=F=i([(0,D.injectable)(),o("design:paramtypes",[typeof(n=typeof y.ProjectsService!=="undefined"&&y.ProjectsService)==="function"?n:Object,typeof(r=typeof b.ModalService!=="undefined"&&b.ModalService)==="function"?r:Object,typeof(a=typeof _.AnalyticsService!=="undefined"&&_.AnalyticsService)==="function"?a:Object,typeof(c=typeof T.SaveUtils!=="undefined"&&T.SaveUtils)==="function"?c:Object,typeof(l=typeof I.UrlStateService!=="undefined"&&I.UrlStateService)==="function"?l:Object,typeof(u=typeof O.NotificationDisplayService!=="undefined"&&O.NotificationDisplayService)==="function"?u:Object,typeof(d=typeof S.TestimServicesApi!=="undefined"&&S.TestimServicesApi)==="function"?d:Object])],F)},function(e,t,s){"use strict";s.r(t);t["default"]={lineSeparator:"index_lineSeparator_70gQ4_RyYWNrZXIt",issueField:"index_issueField_2pQat_RyYWNrZXIt",fieldValue:"index_fieldValue_Jg9Sc_RyYWNrZXIt",fieldName:"index_fieldName_1LfZ5_RyYWNrZXIt",fieldInput:"index_fieldInput_11bb__RyYWNrZXIt",freeText:"index_freeText_1rzZq_RyYWNrZXIt",blueRight:"index_blueRight_xOrDM_RyYWNrZXIt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.promiseMap=t.promisifiedRequestIdleCallback=t.promiseTimeout=t.TimeoutError=t.delay=void 0;const i=s(305);function o(e){return new Promise((t=>{setTimeout(t,e)}))}t.delay=o;class n extends Error{}t.TimeoutError=n;function r(e,t,s){let i;if(typeof s!=="string"){if(s instanceof Error){i=s}else{i=new n("operation timed out")}}else{i=new n(s)}const r=Date.now();return Promise.race([e,o(t).then((()=>{throw Object.assign(i,{timeout:t,passedTime:Date.now()-r})}))])}t.promiseTimeout=r;const a=globalThis.requestIdleCallback||globalThis.setTimeout;const c=()=>new Promise((e=>{a((()=>e()))}));t.promisifiedRequestIdleCallback=c;async function l(e,t,{concurrency:s}={}){if(s){const o=i(s);return await Promise.all(Array.from(e,((e,s)=>o((()=>t(e,s))))))}return await Promise.all(Array.from(e,t))}t.promiseMap=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConditionType=void 0;t.ConditionType={ALWAYS:"none",NEVER:"skip-code-step",CUSTOM:"condition-step",ELEMENT:"element-code-step"}},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.ParameterStep=void 0;const i=s(6);const o=s(8);const n=s(72);const r=s(2);const a=s(60);function c(e,t){if(e.targetNamePrefix&&!e.targetName){const s=o.utils.escapeJSName(e.targetNamePrefix);return o.utils.findUniqueName(t,"displayName",s)}return e.targetName}class l extends n.Step{constructor(){super(...arguments);this.parameterNames=[];this.parameterValues=[]}static createParameter(e,t){const s=c(t,e.parameterNames);const i=t.targetId||o.utils.guid();let n=null;if(t.type){t.targetId=i;t.targetName=s;n=a.stepBuilder.buildStepFromData(t)}return{name:{type:t.type,displayName:s,parameterId:i,assigning:false},value:n}}static addParameterToStep(e,t){const s=l.createParameter(e,t);e.parameterNames.push(s.name);if(s.value){e.parameterValues.push(s.value)}return s}addParameter(e){return l.addParameterToStep(this,e)}removeParameter(e){this.parameterValues=this.parameterValues.filter((t=>t.targetId!==e));this.parameterNames=this.parameterNames.filter((t=>t.parameterId!==e))}renameParameters(e){const t=this.parameterNames.find((t=>t.parameterId===e.parameterId));if(e.targetNamePrefix&&t&&e.targetNamePrefix===t.displayName){return}t.displayName=c(e,this.parameterNames);const s=this.parameterValues.find((t=>t.targetId===e.parameterId));if(s){s.update({targetName:t.displayName})}}assignParameters(e){i.remove(this.parameterNames);i.remove(this.parameterValues);e.forEach((e=>this.addParameter(e)))}updateParameters(e){var t;let s=this.parameterValues.find((t=>t.targetId===e.parameterId));const i=(t=this.parameterNames.find((t=>t.parameterId===e.parameterId)))===null||t===void 0?void 0:t.displayName;const o={screenImage:e.screenImage,screenImageHighlight:e.screenImageHighlight,thumbnailImage:e.thumbnailImage,thumbnailInfo:e.thumbnailInfo,targetId:e.parameterId,targetName:i,...e.stepData};if(!s){s=a.stepBuilder.buildStepFromData(o);if(s){this.parameterValues.push(s)}}else{s.update(o)}}_update(e){var t,s,o,n;if(e.parameterValues){this.assignParameters(e.parameterValues)}if(e.parameterNames){i.remove(this.parameterNames);e.parameterNames.forEach((e=>{var t,s;const i=(t=e.type)!==null&&t!==void 0?t:(s=this.parameterValues.find((t=>t.targetId===e.parameterId)))===null||s===void 0?void 0:s.type;this.parameterNames.push({...e,type:i})}))}if(e.newParameters||e.newClassParameters){(t=e.newParameters)===null||t===void 0?void 0:t.forEach((e=>this.addParameter(e)));(s=e.newClassParameters)===null||s===void 0?void 0:s.forEach((e=>this.addParameter(e)))}if(e.removeParameters||e.removeClassParameters){(o=e.removeParameters)===null||o===void 0?void 0:o.forEach((e=>this.removeParameter(e)));(n=e.removeClassParameters)===null||n===void 0?void 0:n.forEach((e=>this.removeParameter(e)))}if(e.renameParameters&&typeof e.renameParameters!=="function"){e.renameParameters.forEach((e=>this.renameParameters(e)))}if(e.renameClassParameters){e.renameClassParameters.forEach((e=>this.renameParameters(e)))}if(e.updateParameters&&typeof e.updateParameters!=="function"){e.updateParameters.forEach((e=>this.updateParameters(e)))}if(e.updateClassParameters){e.updateClassParameters.forEach((e=>this.updateParameters(e)))}return super._update(e)}getSharedProperty(e,t,s,o){const n=o.map((t=>t[e])).filter(Boolean).filter((e=>e!==t));const r=i.uniqWith(n,s);return r.length===1?r[0]:t}getParameterLocation(e){function t(e,t){return Object.keys(e).concat(Object.keys(t)).reduce(((s,i)=>s&&e[i]===t[i]),true)}return this.getSharedProperty("location",null,t,e)}getFrameLocators(){function e(e,t){const s=e=>{const t=e.elementLocator.index;return e.elementLocator.document[t].testimFrameId};return e.length===t.length&&e.reduce(((e,i,o)=>e&&s(i)===s(t[o])),true)}const t="frameLocators";let s=this.parameterValues.filter((e=>e.type==="locate"));const i=()=>s.length>0&&s.filter((e=>!!e[t])).length===0;if(i()){return null}s=s.map((e=>a.stepBuilder.buildStepFromData(e)));return this.getSharedProperty(t,[],e,s)}refreshLocation(e){e||(e=this.parameterValues);const t=this.getParameterLocation(e);if(t){this.location=t;if(e.length>0){this.tabInfo=e[0].tabInfo||this.tabInfo}}}getSerializableObject(e){return{...super.getSerializableObject(e),parameterNames:this.parameterNames,parameterValues:this.parameterValues.map((t=>t.getSerializableObject(e)))}}getClassParameterValues(){return this.parameterValues.filter((e=>e.type==="node-package"))}describeParameters(e=["evaluate-expression","node-package","locate"]){return this.parameterNames.map((t=>{const s=this.parameterValues.find((e=>e.targetId===t.parameterId));const i=s===null||s===void 0?void 0:s.type;if(!e.includes(i)){return undefined}let o="";if(i==="evaluate-expression"){o=s.expression}else if(i==="node-package"){o=`${s.packageName}@${s.packageVersion}`}else if(i==="locate"){o="element"}return{key:t.displayName,value:o}})).filter(Boolean)}getPropertiesDescription(e,t,s){const i=super.getPropertiesDescription(e,t,s);const o=this.parameterNames.map((e=>e.displayName));if(this.parameterNames.length){i.push({key:"parameterNames",name:"Parameters",value:o})}return i}}t.ParameterStep=l;if(e.env.isClickimEditor||false){(0,r.decorate)(l,{parameterNames:r.observable.deep,parameterValues:r.observable.shallow})}}).call(this,s(35))},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.RevisionsService=t.CircularStepReferenceError=void 0;const o=s(6);const n=s(5);const r=s(33);const a=s(43);const c=s(7);const l=s(9);const u=s(233);const d=s(51);const p=s(203);const h=s(91);const f=c.Logger.getLogger("revisions-service");class m extends Error{constructor(e){super(`Circular Reference Detected ${e.join("->")}`);this.code=n.commonConstants.error.CIRCULAR_SCENARIO_DETECTED;Object.setPrototypeOf(this,m.prototype)}}t.CircularStepReferenceError=m;let g=class e extends r.EventEmitter{constructor(){super(...arguments);this.sharedStepService=d.sharedStepSingleton;this.saveIdCounter=0}async loadSharedStepRevision(e,t){await this.sharedStepService.loadSharedStepClass(e.sharedStepInfoId,t);e.sharedStepClass=null;return await this.assureSynchronizedStep(e)}async getStepRevisions(e,t,s){var i;let o;if(e instanceof p.Scenario){o=s.revisions;if(!s.revisions.isListLoaded){const e=await a.testimServicesSingleton.test.getTestRevisions(s.id,this.sharedStepService.branch,this.sharedStepService.currentProject);s.revisions.update(e)}}else if(e instanceof h.SharedStepInstance&&!((i=e.sharedStepInfo)===null||i===void 0?void 0:i.marketplace)){o=await this.sharedStepService.loadRevisions(e.sharedStepInfoId)}if(o){return[{depth:t,step:e,revisionList:o}]}return[]}async getAllSharedSteps(e){if(!["scenario","shared-step-instance"].includes(e.type)){return[[],[]]}const t=await this.assureSynchronizedStep(e);const s=t.getStepContent().isGroupStep?[...t.getStepContent()]:[];if(t.type!=="scenario"){s.unshift({step:t,path:[],namedPath:[]})}const i=s.filter((({step:e})=>e.type==="scenario"));const n=o.chain(s).filter((({step:e,sharedStep:t})=>e.type==="shared-step-instance"||e.type==="group"&&Boolean(t))).map((({step:e,path:t,sharedStep:s})=>({step:s||e,path:t}))).uniqBy("step.sharedStepInfoId").value();return[n,i]}async getNestedStepsRevisions(e,t){const[s,i]=await this.getAllSharedSteps(e);await this.sharedStepService.loadRevisionsBulk(s.map((({step:e})=>e.sharedStepInfoId)));const o=await Promise.all([...i,...s].map((({step:e,path:s})=>this.getStepRevisions(e,s.length+1,t))));return o.flat()}buildRevisionInfoItem(e,t){return{saveId:t.saveId||this.saveIdCounter++,depth:e.depth,step:e.step,revision:t,isCurrent:e.revisionList.current===t.id,isLatest:e.revisionList.latest===t.id,isNew:!t.saveId}}getRevisionChangeHistory(e,t=e.revisionList.latest,s=[],i=new Set){const o=e.revisionList.revisions;if(!t||!o[t]){return s}if(!i.has(t)){i.add(t);const n=o[t];s.push(this.buildRevisionInfoItem(e,n))}const n=o[t].previousVersion;if(!n){return s}this.getRevisionChangeHistory(e,n,s,i);const r=o[t].merged;if(r){this.getRevisionChangeHistory(e,r,s,i)}return s}async getRevisionList(e,t){const s=await this.getNestedStepsRevisions(e,t);if(!s){return[]}return s.filter((e=>e.revisionList)).flatMap((e=>this.getRevisionChangeHistory(e)))}async assureSynchronizedStep(e){var t;if(e.type==="scenario"){return e}const s=await e.syncWithSharedStepClass(this.sharedStepService);if(s.isMarketplaceStep){await((t=s.sharedStepClass)===null||t===void 0?void 0:t.syncWithSharedStepClass(this.sharedStepService))}this.trigger(n.commonConstants.scenario.SHARED_STEP_REVISION_CHANGED);return s}get sharedStepsInfo(){return this.sharedStepService._sharedStepsInfo}async synchronizeAllStep(e){const t=async(e,s=1)=>{if(s>1e3){const{path:t}=(0,u.bfs)(e,(e=>{if(e.getStepContent().isGroupStep){return e.getStepContent().steps}return[]}),(t=>{var s,i;return(i=(s=t.getStepContent())===null||s===void 0?void 0:s.steps)===null||i===void 0?void 0:i.some((t=>t.id===e.id))}));const s=[e,...t].map((e=>e.getDisplayName()));throw new m(s)}if(!["scenario","shared-step-instance","marketplace-wrapper"].includes(e.type)){return[]}try{const i=await this.assureSynchronizedStep(e);const o=i.isMarketplaceStep?[i.getStepContent()]:i.getStepContent().steps||[];const n=await Promise.all(o.map((e=>t(e,s+1))));return n.flat().filter(Boolean)}catch(t){if((t===null||t===void 0?void 0:t.code)===n.commonConstants.error.CIRCULAR_SCENARIO_DETECTED){throw t}return[e.id]}};const s=Date.now();const i=this.sharedStepService.sharedStepInfos.filter((e=>!e.sharedStepClass)).length;const o=await t(e);const r=i-this.sharedStepService.sharedStepInfos.filter((e=>!e.sharedStepClass)).length;if(r){const t=Date.now()-s;f.warn("test was loaded with some missing shared steps, and test was synchronized recursively in client side",{synchronizedSteps:r,duration:t,stepId:e.id})}return o}};t.RevisionsService=g;t.RevisionsService=g=i([(0,l.injectable)()],g)},,function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.dataToBufferOrBlob=t.convertDataURIToBinary=t.compressDataURIToGzip=t.compressToGzip=void 0;const i=s(8);const o=()=>new Promise(((e,t)=>{s.e(0).then((t=>e(s(302))).bind(null,s)).catch((e=>t(e)))}));const n=async(e,t)=>{const s=await o();return l(s.gzip(e,{level:3}),t)};t.compressToGzip=n;const r=async e=>{const{data:t,mimeType:s}=c(e);if(!t){return undefined}const i=await o();return l(i.gzip(t,{level:3}),s)};t.compressDataURIToGzip=r;function a(e){let t=e.split(":");let s;if(["",","].includes(t[1])){return{base64:"",mimeType:s}}if(t[1].includes(";")){t=t[1].split(";");s=t[0]}const i=t[1].split(",")[1];return{base64:i,mimeType:s}}function c(e){const{base64:t,mimeType:s}=a(e);if(!t){return{data:undefined,mimeType:undefined}}const i=window.atob(t);const o=i.length;const n=new Uint8Array(new ArrayBuffer(o));for(let e=0;e<o;e++){n[e]=i.charCodeAt(e)}return{data:n,mimeType:s}}t.convertDataURIToBinary=c;function l(t,s){if(i.utils.isNode()){if(typeof t==="string"){return e.from(t)}if(e.isBuffer(t)){return t}return e.from(t)}return new Blob([t],{type:s})}t.dataToBufferOrBlob=l}).call(this,s(65).Buffer)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isDemoCompanyId=t.isDemoProjectId=void 0;const i=s(5);const o=[i.commonConstants.defaults.DEMO_PROJECT_ID,i.commonConstants.defaults.TTA_SFDC_DEMO_PROJECT_ID];const n=[i.commonConstants.defaults.DEMO_COMPANY_ID,i.commonConstants.defaults.TTA_SFDC_DEMO_COMPANY_ID];function r(e){return o.includes(e)}t.isDemoProjectId=r;function a(e){return n.includes(e)}t.isDemoCompanyId=a},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.RevisionList=void 0;const r=s(2);const a=s(8);const c=s(7);const l=c.Logger.getLogger("revisionList");class u{constructor(e){this.latest=null;this.current=null;this.isListLoaded=false;this.revisions={};if(e){this.update(e)}this.isListLoaded=Boolean(!e||e.revisions)}update(e){const{revisions:t,current:s,latest:i}=e;if(t){this.isListLoaded=true;Object.keys(t).forEach((e=>this.addRevision(t[e])))}this.current=this.current||s||i||null;this.latest=i||this.latest||this.current}addRevision(e){this.revisions[e.id]=e}setLastRevision(e){if(!e){return}this.addRevision(e);this.latest=e.id;this.current=e.id}setCurrentRevision(e){this.current=e;return this}createNewRevision(e,t,s,i,o,n){if(this.getCurrent()&&this.isLatestVersion()&&this.getCurrent().stepId===s){this.getCurrent().name=i;this.getCurrent().message=o;this.getCurrent().saveId=n;return}const r=this.getCurrent()&&this.getCurrent().completeHistory;const c=this.getCurrent()&&!this.getCurrent().previousVersion;let u;if(r&&r.length>0){u=[this.getCurrent().id].concat(...this.getCurrent().completeHistory||[])}else if(c){u=[this.getCurrent().id]}if(!this.latest){l.warn("revisionList createNewRevision: missing latest revision, new revision will have no previousVersion",{stepId:s,name:i,message:o,saveId:n,stack:(new Error).stack})}const d={id:a.utils.guid(),createdAt:Date.now(),authorName:e,author:t,previousVersion:this.latest,stepId:s,name:i,message:o,saveId:n,merged:undefined,completeHistory:u};this.current=d.id;this.revisions[d.id]=d;this.latest=d.id}getCurrent(){var e;return this.revisions[(e=this.current)!==null&&e!==void 0?e:""]}isLatestVersion(){return this.latest===this.current}getSerializedObject(){return{revisions:Object.fromEntries(Object.entries(this.revisions).map((([e,t])=>[e,t]))),current:this.current}}}t.RevisionList=u;i([r.observable,o("design:type",Object)],u.prototype,"latest",void 0);i([r.observable,o("design:type",Object)],u.prototype,"current",void 0);i([r.action,o("design:type",Function),o("design:paramtypes",[typeof(n=typeof Partial!=="undefined"&&Partial)==="function"?n:Object]),o("design:returntype",void 0)],u.prototype,"update",null)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.BaseHostService=t.getSessionId=void 0;const o=s(9);const n=s(7);const r=s(5);const a=s(79);const c=s(33);const l=s(188);const u=n.Logger.getLogger("base-host-service");const d=Math.trunc(Math.random()*-1e4+-1);let p=1;function h(){return d}t.getSessionId=h;function f(){return p++}l.switchboard.registerToScope(d);let m=class e extends c.EventEmitter{constructor(){super(...arguments);this._port=null;this._isConnected=false;this._queue=[];this._queueAsync=[];this._transactions={};this.openPort=a.ExtensionService.openPort}onDisconnect(e){u.log("Port disconnected");if(e===this._port){this._isConnected=false;this._port=null}}sendBG(e,t){return new Promise(((s,i)=>{if(!this._isConnected||!this._port){this._queue.push({command:e,data:t,resolve:s,reject:i});return}const o={command:e,data:t,tabId:d,transactionId:f()};try{this._transactions[o.transactionId]={resolve:s,reject:i,command:e};this._port.postMessage(o)}catch(e){delete this._transactions[o.transactionId];u.error("While sending data",e,t);i(e)}}))}sendAsyncBG(e,t){if(!this._isConnected||!this._port){this._queueAsync.push({command:e,data:t});return}try{this._port.postMessage({command:e,data:t,tabId:d})}catch(e){u.error("While sending async data",e,t)}}processBgMessage(e){const{command:t,data:s,transactionId:i}=e;if(i){const o=this._transactions[i];if(o){delete this._transactions[i];if(t===r.commonConstants.host.ERROR){if(s instanceof Error){o.reject(s)}else if(s&&typeof s==="object"&&s.message){o.reject(Object.assign(new Error(s.message),s))}else{o.reject(new Error(String(s)))}u.warn("processBgMessage error",{data:s})}else{o.resolve(s)}}else{u.error("Missing transaction id",{command:e.command,transactionId:i,pendingTransactions:Object.keys(this._transactions)})}}if(t){this.trigger(t,s)}}async connect(e){try{const t=await this.openPort(r.commonConstants.host.CONSOLE_PORT);t===null||t===void 0?void 0:t.onDisconnect.addListener((()=>this.onDisconnect(t)));const s=await this.startSession(t,e);this.onSessionStarted();n.Logger.setGlobalInfo({extensionVersion:s.extensionVersion});return s}catch{return this.flushAll()}}async sessionStartedExtraData(){return{}}async startSession(e,t){const s={command:r.commonConstants.host.START_SESSION,tabId:d,...await this.sessionStartedExtraData()};return await new Promise((i=>{const o=t=>{if((t===null||t===void 0?void 0:t.command)===r.commonConstants.host.SESSION_STARTED){if(this._isConnected){u.log("port is already connected, aborting");return}if(e){e.onMessage.removeListener(o)}this._port=e;i(t.data)}};if(e){e.onMessage.addListener(o)}if((t!==null&&t!==void 0?t:0)>=0){s.attachTabId=t}if(e){e.postMessage(s)}}))}onSessionStarted(){const e=[...this._queue];const t=[...this._queueAsync];this._queue=[];this._queueAsync=[];if(this._port){this._port.onMessage.addListener((e=>this.processBgMessage(e)));this._isConnected=true}e.forEach((e=>this.sendBG(e.command,e.data).then(e.resolve).catch(e.reject)));t.forEach((e=>this.sendAsyncBG(e.command,e.data)))}isConnected(){return this._isConnected}flushAll(){const e=[...this._queue];e.forEach((e=>{var t;return(t=e.reject)===null||t===void 0?void 0:t.call(e,new Error("Messages queue was flushed"))}));this._queueAsync=[];this._queue=[]}destroy(){if(this._port){this._port.disconnect();this._port=null}this.flushAll()}};t.BaseHostService=m;t.BaseHostService=m=i([(0,o.injectable)()],m)},function(e,t,s){"use strict";const i=s(426);const o=()=>{if(typeof window==="undefined"){return null}if(window.chrome){return window.chrome}if(typeof chrome!=="undefined"){return chrome}if(window.browser){return window.browser}if(typeof browser!=="undefined"){return browser}return null};const n=()=>{var e;const t=o();if(!t){return t}if(t.browsingData){(0,i.promisifyAll)(t,t.browsingData)}(0,i.promisifyAll)(t,t.cookies);(0,i.promisifyAll)(t,t.debugger);(0,i.promisifyAll)(t,t.extension);(0,i.promisifyAll)(t,t.pageCapture);(0,i.promisifyAll)(t,t.runtime);(0,i.promisifyAll)(t,(e=t.storage)===null||e===void 0?void 0:e.local);(0,i.promisifyAll)(t,t.tabs);(0,i.promisifyAll)(t,t.webNavigation);(0,i.promisifyAll)(t,t.windows);return t};let r;const a={get browser(){r||(r=n());return r}};e.exports=a},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.KeyInputService=void 0;const n=s(9);const r=s(7);const a=s(456);const c=s(61);const l=false?undefined:s(457).Mousetrap;const u=r.Logger.getLogger("key-input-service");const d="keydown";const p="*";let h=class e{get GLOBAL_LAYER(){return p}constructor(){this.activeLayerName=null;this.activeLayer=null;this.layers={};this.init();Promise.resolve().then((()=>s(21))).then((({AnalyticsService:e})=>{this.analyticsService=c.container.get(e)}))}init(){this.loadBindings(a.keyBindings);l.start()}getCommandRecord(e,t){e||(e=p);const s=this.layers[e]||{bindings:{}};this.layers[e]=s;const i=s.bindings[t]||{key:null,rawCallback:null};s.bindings[t]=i;return i}bindRecord(e){if(e.key){l.unbind(e.key,d);if(e.callback){l.bind(e.key,e.callback,d)}}}bindLayer(e){var t;const s=(t=e===null||e===void 0?void 0:e.bindings)!==null&&t!==void 0?t:[];Object.keys(s).forEach((e=>this.bindRecord(s[e])))}loadBindings(e){if(!(e===null||e===void 0?void 0:e.length)){u.log("empty key bindings");return}let t;const s=e.length;for(t=0;t<s;++t){const s=e[t];const i=s.layer;if(!i){u.log("Missing name in key binding data",s)}s.bindings.forEach((e=>this.addKeyBinding(i,e)))}if(this.activeLayerName){this.activateLayer(this.activeLayerName)}}addKeyBinding(e,t){if(!(e&&(t===null||t===void 0?void 0:t.key)&&t.command)){u.error("KeyInputService: can't bind keys",e,t);return}const s=this.getCommandRecord(e,t.command);s.key=t.key;s.description=t.description||t.command;s.global=Boolean(t.global);this.setCallback(s,s.rawCallback);if(this.isActiveLayer(e)){this.bindRecord(s)}}addCommandBinding(e,t,s){if(!(e&&t&&s)){u.error("KeyInputService: can't bind a null value, layer",e,"command",t,"callback",typeof s);return}const i=this.getCommandRecord(e,t);this.setCallback(i,s);if(this.isActiveLayer(e)){this.bindRecord(i)}}activateLayer(e){if(this.activeLayer&&e===this.activeLayerName){return}this.activeLayerName=e;this.activeLayer=this.layers[e];l.reset();this.bindLayer(this.activeLayer);this.bindLayer(this.layers[p])}deactivateLayer(e){if(Array.isArray(e)){e.forEach((e=>this.deactivateLayer(e)));return}if(e===this.activeLayerName){this.activeLayer=null;this.activeLayerName=null;l.reset();this.bindLayer(this.layers[p])}else{u.log("keyInputManager: can't deactivate layer",e,", not active")}}isActiveLayer(e){return e===this.activeLayerName||e===this.GLOBAL_LAYER}setCallback(e,t){if(!e){return}const{key:s,global:i}=e;const o=()=>{if(typeof t==="function"){const e=t;return()=>{this.analyticsService.track("KB-shortcut-press",{kind:s});e()}}return t};let n=o();e.rawCallback=n;if(n){if(i){const e=n;n=function(){e();return false}}e.callback=()=>n===null||n===void 0?void 0:n()}else{e.callback=null}}};t.KeyInputService=h;t.KeyInputService=h=i([(0,n.injectable)(),o("design:paramtypes",[])],h)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(211),t);o(s(575),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(458),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(216),t)},function(e,t,s){"use strict";s.r(t);t["default"]={statusDot:"MobileAgentIndicator_statusDot_22aqn_RpY2F0b3It",ready:"MobileAgentIndicator_ready_2OlZJ_RpY2F0b3It",inactive:"MobileAgentIndicator_inactive_zzzQm_RpY2F0b3It",developing:"MobileAgentIndicator_developing_HQxzY_RpY2F0b3It",mobileAgentIndicatorModalWrapper:"MobileAgentIndicator_mobileAgentIndicatorModalWrapper_FxPg1_RpY2F0b3It",adjustToBanner:"MobileAgentIndicator_adjustToBanner_3kPJ7_RpY2F0b3It",header:"MobileAgentIndicator_header_2sYPh_RpY2F0b3It",agentName:"MobileAgentIndicator_agentName_1s6rH_RpY2F0b3It",agentVersion:"MobileAgentIndicator_agentVersion_17T6V_RpY2F0b3It",headerIcon:"MobileAgentIndicator_headerIcon_1lvXB_RpY2F0b3It",agentPortalIcon:"MobileAgentIndicator_agentPortalIcon_zfnNc_RpY2F0b3It",closeIcon:"MobileAgentIndicator_closeIcon_2_4jm_RpY2F0b3It",agentStatus:"MobileAgentIndicator_agentStatus_2QqXk_RpY2F0b3It",connectedDevices:"MobileAgentIndicator_connectedDevices_2vyMv_RpY2F0b3It",tmaUpgradeWrapper:"MobileAgentIndicator_tmaUpgradeWrapper_82axw_RpY2F0b3It",tmaUpgradeIcon:"MobileAgentIndicator_tmaUpgradeIcon_3BPS8_RpY2F0b3It",tmaUpgradeMessage:"MobileAgentIndicator_tmaUpgradeMessage_1rCMb_RpY2F0b3It",tmaUpgradeButton:"MobileAgentIndicator_tmaUpgradeButton_ET9xr_RpY2F0b3It",devicesCollapsible:"MobileAgentIndicator_devicesCollapsible_3nq9C_RpY2F0b3It",devicesCollapsibleHeader:"MobileAgentIndicator_devicesCollapsibleHeader_3xVoW_RpY2F0b3It",devicesCollapsibleContent:"MobileAgentIndicator_devicesCollapsibleContent_3RPgE_RpY2F0b3It",agentImage:"MobileAgentIndicator_agentImage_1xI2m_RpY2F0b3It",description:"MobileAgentIndicator_description_30i-R_RpY2F0b3It",ctaButton:"MobileAgentIndicator_ctaButton_39_yq_RpY2F0b3It",cancelConnecting:"MobileAgentIndicator_cancelConnecting_3lDut_RpY2F0b3It",downloadDropdown:"MobileAgentIndicator_downloadDropdown_2nI76_RpY2F0b3It",info:"MobileAgentIndicator_info_1IGhQ_RpY2F0b3It",infoHeader:"MobileAgentIndicator_infoHeader_3iVHd_RpY2F0b3It",infoDescription:"MobileAgentIndicator_infoDescription_3blJO_RpY2F0b3It",connectedDeviceRowWrapper:"MobileAgentIndicator_connectedDeviceRowWrapper_2p4eU_RpY2F0b3It",phoneIcon:"MobileAgentIndicator_phoneIcon_3ri-J_RpY2F0b3It",deviceName:"MobileAgentIndicator_deviceName_2Ev_Z_RpY2F0b3It",osVersion:"MobileAgentIndicator_osVersion_1Y0gW_RpY2F0b3It"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.UISocketService=void 0;const l=s(2);const u=s(9);const d=s(534);const p=s(8);const h=s(15);const f=s(14);const m=s(38);const g=s(22);const v="socket service is not init";let S=class e{constructor(e,t,s,i){this.authenticationManager=s;this.testimServices=i;(0,l.reaction)((()=>e.projectId),(e=>{if(t.flags.useNewWS.isEnabled()){return this.init(e)}return this.onLogout()}));(0,l.reaction)((()=>this.authenticationManager.isLoggedIn()),(e=>!e&&this.onLogout()))}on(e,t){var s;(s=this.socketService)===null||s===void 0?void 0:s.on(e,t)}once(e,t){var s;(s=this.socketService)===null||s===void 0?void 0:s.once(e,t)}async addFilter(e,t,s,i){if(!this.socketService){throw new Error(v)}return await this.socketService.addFilter(e,t,s,i)}async removeFilter(e,t){if(!this.socketService){throw new Error(v)}return this.socketService.removeFilter(e,t)}listenTo(e,t,s,i){if(!this.socketService){throw new Error(v)}return this.socketService.listenTo(e,t,s,i)}get isConnected(){var e;return(e=this.socketService)===null||e===void 0?void 0:e.isConnected}onLogout(){var e;(e=this.socketService)===null||e===void 0?void 0:e.disconnect();this.socketService=null;this.currentProjectId=null}openNewSocket(e){this.socketService=new d.default(this.testimServices,this.authenticationManager);const t=p.utils.getWsUrl();const s=t||`${this.testimServices.testimServerBaseUrl}/ws`;this.socketService.init(e,s);this.currentProjectId=e}init(e){if(!this.currentProjectId){this.openNewSocket(e)}if(this.currentProjectId!==e&&this.socketService){this.socketService.disconnect();this.openNewSocket(e)}}};t.UISocketService=S;t.UISocketService=S=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof h.ProjectsService!=="undefined"&&h.ProjectsService)==="function"?n:Object,typeof(r=typeof f.FeatureFlagsService!=="undefined"&&f.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof m.AuthenticationService!=="undefined"&&m.AuthenticationService)==="function"?a:Object,typeof(c=typeof g.TestimServicesApi!=="undefined"&&g.TestimServicesApi)==="function"?c:Object])],S)},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.BaseSocketService=void 0;const i=s(77);const o=s(851);const n=s(8);const r=s(7);const a=s(145);const c=s(6);const l=false;const u=l?"http://localhost:8080":"https://services.testim.io";const d=10;const p=3e4;const h=10*1e3;const f=r.Logger.getLogger("base socket service");class m{constructor(){this.attempts=0;this.url="";this.prevErr={type:"PLACEHOLDER_FOR_FIRST_ERROR_LOGGING"};this.rooms={};this.callOrderScheduler=new a.CallOrderScheduler}get projectId(){return this._currentProjectIdConnected}closeSocket(){if(this._socket){this.attempts=0;this.isAllowedWS=undefined;this.rooms={};this._socket.removeAllListeners();this._socket.disconnect();this._socket.destroy();delete this._currentProjectIdConnected}}emitJoinRoom(e,t){return undefined}waitUntilAllStartsWithKeysFulfilled(e){return this.callOrderScheduler.waitUntilAllStartsWithKeysFulfilled(e)}emitPromise(e,t,s=undefined){const o=()=>{var s,i;if(!((s=this._socket)===null||s===void 0?void 0:s.connected)){const t=!!this._socket;const s=(i=this._socket)===null||i===void 0?void 0:i.connected;throw new Error(`socket disconnected, eventName = ${e}, hasSocket = ${t}, connected = ${s}`)}return n.utils.promiseTimeout(new Promise(((s,i)=>{this._socket.emit(e,t,(e=>(e===null||e===void 0?void 0:e.success)?s():i(new Error("bad ack"))))})),p)};const r=()=>(0,i.default)(o,{retries:2,minTimeout:3e3}).catch((e=>{this._socket.io.disconnect();this._socket.io.connect();throw e}));return this.callOrderScheduler.schedule(r,{key:s!==null&&s!==void 0?s:"",retry:true,minTimeout:3e3,retries:20})}joinRoom(e,t){this.rooms[e]=t}leaveRoom(e){delete this.rooms[e]}joinToMultipleResults(){const e=Object.keys(this.rooms);f.log(`re-join all existing rooms${e}`);e.map((e=>{const t=this.rooms[e];if(this.emitJoinRoom){this.emitJoinRoom(e,t)}return undefined}))}init(t,s,i,r,a={},l={}){if(t&&this.projectId!==t){this.url=`${i||u}${s}`;this.closeSocket();this._currentProjectIdConnected=t;const p=Object.assign({},l,{query:Object.assign({},a,{projectId:t}),requestTimeout:h,transports:["websocket"],upgrade:false});if(n.utils.isNode()&&e.caFileContent){p.ca=e.caFileContent}if(n.utils.isNode()&&e.proxyUri&&e.ProxyAgent){p.agent=new e.ProxyAgent(e.proxyUri)}const m=c.debounce(((e,t)=>{var s;const i=(s=this._socket.io.engine.transport)===null||s===void 0?void 0:s.name;f.warn(`Error in SocketService websocket _${e}_ socket ${this._socket.id} is ${this.url} over ${i}. Reconnect attempts ${this.attempts}. Error is: ${t===null||t===void 0?void 0:t.message}`,t,this._socket.io.opts)}),1e4);this._socket=r||o.connect(this.url,p);this._socket.on("reconnect_attempt",(e=>{m("reconnect_attempt",{message:"reconnect attempt",attempt:e});this.attempts++;if(this.attempts===d&&!this.isAllowedWS){f.log("transfer client to use polling instead of websocket");this._socket.io.opts.transports=["polling"];this._socket.io.opts.upgrade=false}}));this._socket.on("connect_error",(e=>{m("connect_error",e)}));this._socket.on("connect_timeout",(e=>{m("connect_timeout",e)}));this._socket.on("error",(e=>{m("error",e)}));this._socket.on("reconnect_error",(e=>{if(this.prevErr.type===e.type){return}this.prevErr=e;m("reconnect_error",e)}));this._socket.on("reconnect",(()=>{f.log("reconnect to socket and re-join to rooms");this.joinToMultipleResults()}));this._socket.on("connect",(()=>{this.attempts=0;if(this.isAllowedWS===undefined){this.isAllowedWS=this._socket.io.engine.transport&&this._socket.io.engine.transport.name==="websocket"}}))}}onError(e){this._socket.on("error",e)}}t.BaseSocketService=m}).call(this,s(36))},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;var r,a,c,l;Object.defineProperty(t,"__esModule",{value:true});t.MobileFileUploadService=t.BIG_APP_FILE_SIZE=t.MAX_FILE_SIZE=t.UPLOAD_TIMEOUT=void 0;const u=s(6);const d=s(77);const p=s(9);const h=s(2);const f=s(8);const m=s(97);const g=s(22);const v=s(15);const S=s(67);const y=s(28);const b=s(14);const _=s(7);t.UPLOAD_TIMEOUT=3*60*1e3;t.MAX_FILE_SIZE=150;t.BIG_APP_FILE_SIZE=500;const T=40;const E=_.Logger.getLogger("MobileFileUploadService");let I=n=class e{constructor(e,t,s,i){this.testimServicesApi=e;this.projectsService=t;this.modalService=s;this.featureFlagsService=i;this._uploadProgress=0;this.checkFilePropsBeforeUpload=(e,t,s)=>{if(t.every((t=>!e.name.endsWith(`.${t}`)))){throw new Error(`File type should be of ${f.utils.pluralize(t.length,"type")} ${t.join(", ").toUpperCase()}`)}const i=this.projectsService.projectId;if(!i){throw new Error("No Project Detected")}const o=n.fileSizeInMb(e);if(!this.featureFlagsService.flags.dontLimitMobileAppSize.isEnabled()&&o>s){throw new Error(`File size should not exceed ${s} MB`)}};this.applicationTimeOut=e=>{const t=Math.ceil(e.size/1024);const s=Math.ceil(t/(T*60));return(s+1)*60*1e3};this.uploadFile=async(e,t)=>{try{(0,h.runInAction)((()=>{this._uploadState="uploading";this._uploadProgress=0}));const s=this.projectsService.projectId;const{name:i,type:o}=e;const n=await e.arrayBuffer();const r={fileName:i,mimeType:o,file:new Blob([n],{type:o})};const{appId:a,versionId:c}=await this.testimServicesApi.mobileApp.createNewVersion(s,r,this.applicationTimeOut(e),t.signal,undefined,this.onUploadProgress);(0,h.runInAction)((()=>{this._uploadState="parsing";this._uploadProgress=1}));await this.waitForAppParsingComplete(a,c,t.signal);const l=await this.testimServicesApi.mobileApp.getById(s,a);l._id=c;this.modalService.openToast(S.Toast,{children:"Your app was successfully uploaded",timeout:3e3,icon:{type:"check",backgroundType:"success"}});return l}catch(t){E.error("Failed uploading mobile app",{error:t,file:u.pick(e,["name","size","type"])});if(t instanceof m.TypedHttpError&&t.timedout){throw new Error("The upload process has failed due to timeout")}if(n.isUserAbortedError(t)){throw t}throw new Error("Your upload has failed. Please try again.")}finally{this._uploadState=undefined}};this.onUploadProgress=e=>{this._uploadProgress=e.loaded/e.total}}get uploadState(){return this._uploadState}get uploadProgress(){return this._uploadProgress}static fileSizeInMb({size:e}){return e/1024/1024}static isUserAbortedError(e){return e.message.includes("The user aborted")}async waitForAppParsingComplete(e,s,i){const o=this.projectsService.projectId;return await(0,d.default)((async()=>{i.throwIfAborted();const t=await this.testimServicesApi.mobileApp.checkVersionStatus(o,e,s)||"parsing";if(t==="valid"){return{success:true}}if(t==="invalid"){throw new d.AbortError("App parsing completed as invalid")}throw new Error("App parsing not complete")}),{retries:20,maxRetryTime:t.UPLOAD_TIMEOUT})}};t.MobileFileUploadService=I;i([h.observable.ref,o("design:type",String)],I.prototype,"_uploadState",void 0);i([h.observable.ref,o("design:type",Object)],I.prototype,"_uploadProgress",void 0);i([h.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"uploadState",null);i([h.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"uploadProgress",null);t.MobileFileUploadService=I=n=i([(0,p.injectable)(),o("design:paramtypes",[typeof(r=typeof g.TestimServicesApi!=="undefined"&&g.TestimServicesApi)==="function"?r:Object,typeof(a=typeof v.ProjectsService!=="undefined"&&v.ProjectsService)==="function"?a:Object,typeof(c=typeof y.ModalService!=="undefined"&&y.ModalService)==="function"?c:Object,typeof(l=typeof b.FeatureFlagsService!=="undefined"&&b.FeatureFlagsService)==="function"?l:Object])],I)},function(e,t,s){"use strict";s.r(t);t["default"]={isDraggingOver:"DragAndDropUpload_isDraggingOver_21biY_BVcGxvYWQt",chooseFile:"DragAndDropUpload_chooseFile_3xxH3_BVcGxvYWQt",title:"DragAndDropUpload_title_3ufiH_BVcGxvYWQt",subtitle:"DragAndDropUpload_subtitle_3ZRGX_BVcGxvYWQt",reachedMaxUploadLimit:"DragAndDropUpload_reachedMaxUploadLimit_1Gr0Q_BVcGxvYWQt",uploadAppDragAndDropWithFileChosen:"DragAndDropUpload_uploadAppDragAndDropWithFileChosen_2itss_BVcGxvYWQt",selectAppDragAndDropWithFileChosen:"DragAndDropUpload_selectAppDragAndDropWithFileChosen_33nay_BVcGxvYWQt",uploadAppUploadDetails:"DragAndDropUpload_uploadAppUploadDetails_1pmkg_BVcGxvYWQt",uploadAppStatusAndFileDetails:"DragAndDropUpload_uploadAppStatusAndFileDetails_2G_3y_BVcGxvYWQt",selectAppStatusAndFileDetails:"DragAndDropUpload_selectAppStatusAndFileDetails_31f5Z_BVcGxvYWQt",fileDetails:"DragAndDropUpload_fileDetails_2WDVk_BVcGxvYWQt",fileName:"DragAndDropUpload_fileName_1b6WG_BVcGxvYWQt",fileSize:"DragAndDropUpload_fileSize_3bvMS_BVcGxvYWQt",statusIcon:"DragAndDropUpload_statusIcon_1r8xH_BVcGxvYWQt",innerTitle:"DragAndDropUpload_innerTitle_1cST6_BVcGxvYWQt",discardFileWrapper:"DragAndDropUpload_discardFileWrapper_3dyx5_BVcGxvYWQt",discardFile:"DragAndDropUpload_discardFile_13ZH__BVcGxvYWQt",errorMessage:"DragAndDropUpload_errorMessage_2XXBY_BVcGxvYWQt",selectAppChooseFileWrapper:"DragAndDropUpload_selectAppChooseFileWrapper_2KyCG_BVcGxvYWQt",uploadAppChooseFileWrapper:"DragAndDropUpload_uploadAppChooseFileWrapper_aVfQu_BVcGxvYWQt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.RestrictToChrome=void 0;const l=s(4);const u=s(232);const d=s(9);const p=s(8);const h=s(28);const f=s(5);const m=s(16);const g=s(26);const v=s(49);const S=s(20);const y=s(580);const b=s(39);const _="https://www.google.com/chrome/";let T=class e{constructor(e,t,s,i){this.modalService=e;this.urlState=t;this.userService=s;this.companiesService=i}get approvedEdgeChromium(){var e,t;const s=this.userService.getPreferences();return(t=(e=s===null||s===void 0?void 0:s.dialogs)===null||e===void 0?void 0:e.approvedEdgeChromium)!==null&&t!==void 0?t:false}async restrict(){if(p.utils.isChrome()){return true}if(this.companiesService.isTtaForSalesforceApp){return true}const e=(0,S.isPlaygroundModeState)(this.urlState);if(!e&&p.utils.isEdgeChromium()){if(this.approvedEdgeChromium){return true}const e=await this.modalService.openFormModal({zIndex:Number(u.default.modalLayer)+1,className:u.default.edgeModal,header:()=>(0,l.jsxs)("h3",{children:["Edge chromium ",(0,l.jsx)("span",{className:u.default.beta,children:"BETA"})]}),items:{message:{type:"message",label:(0,l.jsxs)("div",{className:u.default.edgeMessage,children:[(0,l.jsx)(m.Icon,{icon:"edge-chromium"}),(0,l.jsx)("span",{children:"Edge Chromium is in beta, some features may not be supported."})]})},remember:{type:"checkbox",value:false,label:"Don't show this message again"}}}).promise;if(!e){throw new Error(f.commonConstants.error.NOT_ON_CHROME)}if(e===null||e===void 0?void 0:e.remember){const e=this.userService.getPreferences();e.dialogs=e.dialogs||{};e.dialogs.approvedEdgeChromium=true;await this.userService.savePreferences(e)}return true}try{const t=await this.modalService.openModal(y.RestrictToChromeModal,{blackMode:e}).promise;if(t){const e=window.open(_,"_blank","noopener");if(e){e.focus()}}}catch(e){throw new Error(f.commonConstants.error.NOT_ON_CHROME)}throw new Error(f.commonConstants.error.NOT_ON_CHROME)}};t.RestrictToChrome=T;t.RestrictToChrome=T=i([(0,d.injectable)(),o("design:paramtypes",[typeof(n=typeof h.ModalService!=="undefined"&&h.ModalService)==="function"?n:Object,typeof(r=typeof g.UrlStateService!=="undefined"&&g.UrlStateService)==="function"?r:Object,typeof(a=typeof v.UserService!=="undefined"&&v.UserService)==="function"?a:Object,typeof(c=typeof b.CompaniesService!=="undefined"&&b.CompaniesService)==="function"?c:Object])],T)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.TestResultStore=void 0;const d=s(6);const p=s(584);const h=s(9);const f=s(2);const m=s(5);const g=s(8);const v=s(142);const S=s(130);const y=s(29);const b=s(15);const _=s(34);const T=s(22);const E=s(27);const I=s(48);const C=s(14);const D=s(7);const{HIDDEN_PARAM:O}=m.commonConstants.test;const A=[m.commonConstants.stepStatus.WHILELOOP_DONE,m.commonConstants.stepStatus.COMPLETED];const j=D.Logger.getLogger("TestResultStore");let w=class e{constructor(e,t,s,i,o,n){this.applitoolsService=e;this.branchesService=t;this.editedTestStore=s;this.featureFlagsService=i;this.projectsService=o;this.testimServicesApi=n;this.lastStepResults=[];this.stepResults=[];this._explicitStepResultUpdate=0;this.allStepPartialResults=[];this.stepResultsTab=new p.default}get explicitStepResultUpdate(){return this._explicitStepResultUpdate}explicitStepResultUpdateInvalidate(){this._explicitStepResultUpdate++}get runParams(){return d.map(this.currentTestResultRunParams,((e,t)=>({key:t,value:e!==O?e:"*****"})))}get currentTestResultId(){var e;return(e=this._testResult)===null||e===void 0?void 0:e.id}get isCurrentTestResultForever(){return Boolean(this.testResult&&!this.testResult.created_at)}get currentTestResultRunConfig(){var e;return(e=this.testResult)===null||e===void 0?void 0:e.runConfig}get currentTestResultRunParams(){var e;return(e=this.testResult)===null||e===void 0?void 0:e.runParams}get testResult(){return this._testResult}set testResult(e){(0,f.runInAction)((()=>{this._testResult=e;Object.values((e===null||e===void 0?void 0:e.stepsResults)||{}).forEach((e=>this.addStepResult(e)))}))}get applitoolsRunConfig(){var e,t,s,i,o,n,r,a,c,l;if(!this.applitoolsService.isApplitoolsEnabled){return undefined}return{applitoolsRCA:(t=(e=this.currentTestResultRunConfig)===null||e===void 0?void 0:e.applitoolsRCA)!==null&&t!==void 0?t:false,applitoolsDiffs:(i=(s=this.currentTestResultRunConfig)===null||s===void 0?void 0:s.applitoolsDiffs)!==null&&i!==void 0?i:false,applitoolsEnvironments:(n=(o=this.currentTestResultRunConfig)===null||o===void 0?void 0:o.applitoolsEnvironments)!==null&&n!==void 0?n:[],applitoolsMatchLevel:(a=(r=this.currentTestResultRunConfig)===null||r===void 0?void 0:r.applitoolsMatchLevel)!==null&&a!==void 0?a:v.APPLITOOLS_DEFAULT_MATCH_LEVEL,applitoolsConcurrency:(l=(c=this.currentTestResultRunConfig)===null||c===void 0?void 0:c.applitoolsConcurrency)!==null&&l!==void 0?l:5}}get showPixelValidationWarnings(){return this.stepResults.some((e=>{var t;return g.utils.isUiVerificationStep(e===null||e===void 0?void 0:e.type)&&e.success&&e.treatAsWarning&&((t=e.eyesResult)===null||t===void 0?void 0:t.isNew)}))}reset(){this._testResult=undefined;if(this.stepResults.length>0){this.lastStepResults=this.stepResults}this.stepResults=[];this.allStepPartialResults=[];this.stepResultsTab=new p.default}resetStepsResults(){if(this.editedTestStore.testConfig&&this.editedTestStore.scenario){this.editedTestStore.testConfig.isComplete=null;this.editedTestStore.testConfig.result=undefined;this.editedTestStore.scenario.reset();this.reset()}}async onTestRunParams(e,t){this.testResult=Object.assign({},this.testResult);if(!d.isEmpty(e)){this.testResult.runParams=e;return}if(!d.isEmpty(t)){const e=await this.testimServicesApi.storage.downloadJSONFile(t);this.testResult.runParams=e}}isSameStepResult(e,t){return e.path==t.path&&e.id==t.id&&e.stepResultId==t.stepResultId}getStepResultFromPartialResults(e){const t=d.chain(this.allStepPartialResults).filter((t=>this.isSameStepResult(e,t))).sortBy("eventTime").value();return d.merge({},...t)}addStepResultTabInfo(e){var t,s;if(!((s=(t=e.resultInfo)===null||t===void 0?void 0:t.runTabInfo)===null||s===void 0?void 0:s.infoId)){return}const{runTabInfo:i}=e.resultInfo||{};const o=i===null||i===void 0?void 0:i.infoId;this.stepResultsTab.addStepResult(o,e.stepResultId,i.order)}addStepResult(e){this.addStepResultTabInfo(e);this.allStepPartialResults.push(e);const t=this.getStepResultFromPartialResults(e);d.remove(this.stepResults,(t=>this.isSameStepResult(t,e)));this.stepResults.push(t);return t}calcStepResultTabNumber(e){return this.stepResultsTab.calcStepResultTabNumber(this,e)}hasMoreThanOneTabInResults(){return this.stepResultsTab.hasMoreThanOneTabInResults()}getInnerStepsResults(e){e=e===undefined?null:e;const t=this.stepResults.filter((t=>t.path===e));if(!t.length){return this.stepResults.filter((t=>e===null||e===void 0?void 0:e.endsWith(t.path)))}return t}getStepResult(e,t,s){e=e===undefined?null:e;s=s===undefined?null:s;return this.getInnerStepsResults(e).find((e=>e.id===t&&e.iterationId===s))}get lastSuccessfulResult(){var e;let t=Date.now();if((e=this._testResult)===null||e===void 0?void 0:e.startTime){t=this._testResult.startTime-1}return(0,E.fromPromise)(this.testimServicesApi.test.getLastSuccessfulResult(this.editedTestStore.testId,this.projectsService.projectId,this.branchesService.branch,t))}getStepIteration(e,t,s){return this.getStepIterations(e,t).find((e=>e.iterationId===s))}getStepIterations(e,t){if(d.isEmpty(e)){return[]}const s=t&&d.chain(t.split(":")).dropRight().join(":").value()||null;const i=e.id;return this.stepResults.filter((e=>e.path===s&&e.id===i&&e.iterationId&&A.includes(e.status)))}getFirstIteration(e,t,s){const i=d.chain(this.getStepIterations(e,t)).filter((e=>{var t;return((t=e.iterationId)===null||t===void 0?void 0:t.startsWith(`${s}:`))||d.isEmpty(s)})).orderBy(["iteration"],["asc"]).value();const o=i.find((e=>!(e.status===m.commonConstants.stepStatus.WHILELOOP_DONE&&e.whileLoopEvaluated)&&!e.success));const n=i[0];const r=d.cloneDeep(o||n);const a=i.find((({reason:e})=>e===m.commonConstants.stepResult.MAX_ITERATIONS_EXCEEDED));if(a&&r){r.tabsImage=a.tabsImage;r.stepDOM=a.stepDOM;r.isDomBlackList=a.isDomBlackList;r.stepScreenshot=a.stepScreenshot;r.success=false;r.reason=m.commonConstants.stepResult.MAX_ITERATIONS_EXCEEDED}return r}get stepResultLogsAsSet(){return(0,E.computedFn)(((e,t)=>{var s,i,o,n;return new Set((n=t?(i=(s=this.testResult)===null||s===void 0?void 0:s.fullLogs)===null||i===void 0?void 0:i.sfdcStats:(o=this.testResult)===null||o===void 0?void 0:o.fullLogs)===null||n===void 0?void 0:n[e])}))}get doesStepHaveLogOfType(){return(0,E.computedFn)(((e,t,s)=>{try{const{stepResultId:i}=(e===null||e===void 0?void 0:e.result)||{};if(!i){return false}let o=t;if(this.featureFlagsService.flags.propagateChildLogs.isEnabled()){o=d.camelCase(`verbose ${t}`)}return this.stepResultLogsAsSet(o,s).has(i)}catch(e){j.error("stepHasResult failed",{error:e,type:t,isSfdc:s});return false}}))}};t.TestResultStore=w;i([f.observable,o("design:type",Object)],w.prototype,"_testResult",void 0);i([f.observable.shallow,o("design:type",Array)],w.prototype,"stepResults",void 0);i([f.observable,o("design:type",Object)],w.prototype,"_explicitStepResultUpdate",void 0);i([f.computed.struct,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"runParams",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"currentTestResultId",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"isCurrentTestResultForever",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"currentTestResultRunConfig",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"currentTestResultRunParams",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"applitoolsRunConfig",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"showPixelValidationWarnings",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],w.prototype,"addStepResult",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],w.prototype,"lastSuccessfulResult",null);t.TestResultStore=w=i([(0,h.injectable)(),(0,I.exposeGlobally)("testResultStore"),o("design:paramtypes",[typeof(n=typeof S.ApplitoolsService!=="undefined"&&S.ApplitoolsService)==="function"?n:Object,typeof(r=typeof _.BranchesService!=="undefined"&&_.BranchesService)==="function"?r:Object,typeof(a=typeof y.EditedTestStore!=="undefined"&&y.EditedTestStore)==="function"?a:Object,typeof(c=typeof C.FeatureFlagsService!=="undefined"&&C.FeatureFlagsService)==="function"?c:Object,typeof(l=typeof b.ProjectsService!=="undefined"&&b.ProjectsService)==="function"?l:Object,typeof(u=typeof T.TestimServicesApi!=="undefined"&&T.TestimServicesApi)==="function"?u:Object])],w)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.ApplitoolsService=void 0;const c=s(6);const l=s(43);const u=s(15);const d=s(49);const p=s(9);const h=s(2);const f=s(27);const m=s(55);let g=class e{constructor(e,t,s){this.projectsService=e;this.userService=t;this.premiumFeaturesService=s;this.explicitUpdate=0}get isApplitoolsConnected(){const e=this.explicitUpdate;const t=this.projectsService.projectId;if(!t||!this.userService.isLoggedIn()){return f.fromPromise.resolve(false)}return(0,f.fromPromise)(l.testimServicesSingleton.applitools.connected(t).then((e=>!c.isEmpty(e))))}get isApplitoolsEnabled(){return Boolean(this.isApplitoolsConnected.value&&this.premiumFeaturesService.canUseApplitools())}update(){this.explicitUpdate++}};t.ApplitoolsService=g;i([h.observable,o("design:type",Object)],g.prototype,"explicitUpdate",void 0);i([(0,h.computed)({keepAlive:true}),o("design:type",Object),o("design:paramtypes",[])],g.prototype,"isApplitoolsConnected",null);i([h.computed,o("design:type",Object),o("design:paramtypes",[])],g.prototype,"isApplitoolsEnabled",null);t.ApplitoolsService=g=i([(0,p.injectable)(),o("design:paramtypes",[typeof(n=typeof u.ProjectsService!=="undefined"&&u.ProjectsService)==="function"?n:Object,typeof(r=typeof d.UserService!=="undefined"&&d.UserService)==="function"?r:Object,typeof(a=typeof m.PremiumFeaturesService!=="undefined"&&m.PremiumFeaturesService)==="function"?a:Object])],g)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.combineScopes=t.ConnectionMaxSizeError=t.BrokerTimeoutError=t.ActionsQueue=t.stampMessage=t.hasMetadata=void 0;const i=s(7);const o=new i.Logger("broker utils");function n(e){var t;return Boolean((t=e.metadata)===null||t===void 0?void 0:t.transactionId)}t.hasMetadata=n;function r(e,t,s){var i;(i=e.metadata.stamps)[t]||(i[t]=s);return e}t.stampMessage=r;class a{constructor(e,t={}){this.canRunQueueItems=e;this.options=t;this._actions=[];this.ttl=t.ttl||2e4}remove(e){const t=this._actions.indexOf(e);if(t<0){return}this._actions.splice(t,1)}async add(e){const t=this.canRunQueueItems();const s=t instanceof Promise?await t:t;if(!s){let t;return new Promise(((s,i)=>{const o=async()=>{clearTimeout(t);try{await e();s()}catch(e){i(e)}};this._actions.push(o);t=setTimeout((()=>{this.remove(o);if(this.options.throwOnTimeout){i(new c(this.ttl));return}s()}),this.ttl)}))}this.doAll();return e()}doAll(){for(const e of this._actions){(async()=>{try{await e()}catch(e){o.error("Failed to perform a action from the action queue",{error:e})}})()}this._actions=[]}}t.ActionsQueue=a;class c extends Error{constructor(e){super("TIMEOUT");this.timeout=e}}t.BrokerTimeoutError=c;class l extends Error{constructor(e){super("MAX_SIZE_ERROR");this.maxSize=e}}t.ConnectionMaxSizeError=l;function u(...e){let t=[];e.forEach((e=>{if(e){t=t.concat(e)}}));return t}t.combineScopes=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isValueMatched=t.matchAttributeValue=t.MATCHING_METHOD_OPTIONS_WITH_VALUES=t.MATCHING_METHOD_OPTIONS=t.MATCHING_METHOD_DEFINITION=void 0;t.MATCHING_METHOD_DEFINITION={Equals:{asSelector:(e,t)=>`[${e}='${t}']`},Contains:{asSelector:(e,t)=>`[${e}*='${t}']`},"Starts with":{asSelector:(e,t)=>`[${e}^='${t}']`},"Ends with":{asSelector:(e,t)=>`[${e}$='${t}']`}};t.MATCHING_METHOD_OPTIONS=Object.keys(t.MATCHING_METHOD_DEFINITION).map((e=>({name:e})));t.MATCHING_METHOD_OPTIONS_WITH_VALUES=Object.keys(t.MATCHING_METHOD_DEFINITION).map((e=>({name:e,value:e})));function i(e,t,s="Equals"){switch(s){case"Contains":return t.filter((t=>t.includes(e)));case"Starts with":return t.filter((t=>t.startsWith(e)));case"Ends with":return t.filter((t=>t.endsWith(e)));case"Equals":default:return t.filter((t=>t===e))}}t.matchAttributeValue=i;function o(e,t,s="Equals"){return i(e,t,s).length>0}t.isValueMatched=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RESOLUTIONS=t.BROWSERS=t.OSS=void 0;t.OSS=[{name:"Linux",synonyms:["linux","Linux"],hidden:false},{name:"Windows 11",synonyms:["Windows 11","windows 11"],hidden:false},{name:"Windows 10",synonyms:["Windows 10","windows 10"],hidden:false},{name:"Windows 8",synonyms:["Windows 8","windows 8"],hidden:false},{name:"Windows 8.1",synonyms:["Windows 8.1","windows 8.1"],hidden:false},{name:"Windows 7",synonyms:["Windows 7","windows 7"],hidden:false},{name:"Windows XP",synonyms:["Windows XP","windows xp"],hidden:false},{name:"macOS Sierra",synonyms:["Mac OS 10.12"],hidden:false},{name:"macOS High Sierra",synonyms:["Mac OS 10.13"],hidden:false},{name:"macOS Mojave",synonyms:["Mac OS 10.14"],hidden:false},{name:"macOS Catalina",synonyms:["Mac OS 10.15"],hidden:false},{name:"macOS Big Sur",synonyms:["Mac OS 11"],hidden:false},{name:"OS X El Capitan",synonyms:["Mac OS 10.11"],hidden:false},{name:"OS X Yosemite",synonyms:["Mac OS 10.10"],hidden:false},{name:"OS X Mavericks",synonyms:["Mac OS 10.9"],hidden:false},{name:"OS X Mountain Lion",synonyms:["Mac OS 10.8"],hidden:false},{name:"OS X Lion",synonyms:["Mac OS 10.7"],hidden:false},{name:"OS X Snow Leopard",synonyms:["Mac OS 10.6"],hidden:false},{name:"Android (Chrome Emulator)",synonyms:["Android (Chrome Emulator)"],hidden:true},{name:"iOS (Chrome Emulator)",synonyms:["iOS (Chrome Emulator)"],hidden:true}];t.BROWSERS=[{name:"Chrome",icon:"chrome",value:"chrome",stepTimeoutDefault:3e4},{name:"Firefox",icon:"firefox",value:"firefox",stepTimeoutDefault:45e3},{name:"Safari",icon:"safari",value:"safari",stepTimeoutDefault:45e3},{name:"Edge Chromium",icon:"edge-chromium",value:"edge-chromium",stepTimeoutDefault:3e4}];t.RESOLUTIONS=[{name:"1920x1080",width:1920,height:1080},{name:"1366x768",width:1366,height:768},{name:"1440x900",width:1440,height:900},{name:"1280x800",width:1280,height:800},{name:"1280x1024",width:1280,height:1024},{name:"1024x768",width:1024,height:768}]},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.Issue=void 0;const c=s(6);const l=s(2);class u{constructor(){this.explicitUpdate=0;this.model={}}get type(){return this._type}set type(e){this._type=e}get displayName(){return"new Issue"}set fields(e){this._fields=e}get fields(){return this._fields}get isValid(){return!(0,c.isEmpty)(this.containerId)}addLink(e,t){this._fields.description+=`\n[${e}|${t}]\n`}toDTO(){throw new Error("Not Implemented")}}t.Issue=u;i([l.observable,o("design:type",typeof(n=typeof Record!=="undefined"&&Record)==="function"?n:Object)],u.prototype,"model",void 0);i([l.observable,o("design:type",String)],u.prototype,"containerId",void 0);i([l.observable,o("design:type",String)],u.prototype,"description",void 0);i([l.observable,o("design:type",String)],u.prototype,"summary",void 0);i([l.observable,o("design:type",String)],u.prototype,"stepImage",void 0);i([l.observable,o("design:type",String)],u.prototype,"resultImage",void 0);i([l.observable,o("design:type",String)],u.prototype,"annotatedImageBase64",void 0);i([l.observable,o("design:type",typeof(r=typeof Record!=="undefined"&&Record)==="function"?r:Object)],u.prototype,"_savedModel",void 0);i([l.observable,o("design:type",Object)],u.prototype,"explicitUpdate",void 0);i([l.observable,o("design:type",typeof(a=typeof Record!=="undefined"&&Record)==="function"?a:Object)],u.prototype,"_fields",void 0);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],u.prototype,"isValid",null)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.HttpForJiraService=void 0;const r=s(9);const a=s(62);const c=s(5);let l=class e{constructor(e){this.hostService=e}async sendToBackground(e,...t){const{resolve:s,response:i}=await this.hostService.activeHost.sendBG(c.commonConstants.host.HTTP_REQUEST,{method:e,parameters:t});i.data=i;if(!s){throw i}return i}get(...e){return this.sendToBackground("get",...e)}getJson(e){return this.sendToBackground("getJson",e,{Accept:"application/json"},{responseType:"json"})}postJson(...e){return this.sendToBackground("postJson",...e)}};t.HttpForJiraService=l;t.HttpForJiraService=l=i([(0,r.injectable)(),o("design:paramtypes",[typeof(n=typeof a.HostService!=="undefined"&&a.HostService)==="function"?n:Object])],l)},,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.handleApplitoolsSdkResult=t.buildApplitoolsSdkConfig=t.APPLITOOLS_DEFAULT_MATCH_LEVEL=t.APPLITOOLS_MATCH_LEVELS=void 0;const i=s(6);const o=s(8);const n=s(7);const r=s(42);const a=s(301);const c=s(5);const l=n.Logger.getLogger("eyes-utils");const u=n.Logger.getLogger("applitoolsSDK");t.APPLITOOLS_MATCH_LEVELS=["Exact","Strict","Content","Layout"];t.APPLITOOLS_DEFAULT_MATCH_LEVEL=t.APPLITOOLS_MATCH_LEVELS[1];const d=({projectId:e,applitoolsIntegrationData:t},s)=>s.applitoolsAppName||(t===null||t===void 0?void 0:t.appName)||e;const p=({stepPlayerParentStep:e,testName:t},s,i)=>{var o,n;if(s.applitoolsTestName){return s.applitoolsTestName}let r=i.getDisplayName();if((o=e===null||e===void 0?void 0:e.step)===null||o===void 0?void 0:o.name){if(((n=e.step)===null||n===void 0?void 0:n.type)==="scenario"){r=`${t} > ${r}`}else{r=`${e.step.name} > ${r}`}}return r};const h=({testName:e,testResultId:t,playback:s},i)=>{if(!s.executionId||!s.executionName){const s=t||i.applitoolsTestId.id;return`${e} - ${s}`}return`${s.executionName} - ${s.executionId}`};const f=({stepPlayerParentStep:e,testId:t,testName:s,avoidLongName:i},o,n)=>{const{applitoolsTestName:r}=o;const a=r?`_${r}`:"";const c=2.1;const l=n.isUsingApplitoolsSDK&&parseFloat(n.getStepVersion())<c;if(!l||i){return`${n.applitoolsTestId.id}_${n.applitoolsTestId.count}${a}`}let u=`${n.getDisplayName()} (${n.applitoolsTestId.id})`;let d=e;while(d===null||d===void 0?void 0:d.parentStep){if((d===null||d===void 0?void 0:d.step.type)!=="shared-step-instance"){u=`${d.step.name} (${d.step.originalStepId||d.step.id}) > ${u}`}d=d===null||d===void 0?void 0:d.parentStep}const p=`[${t}] - ${s} > ${u}${a}`;if(p.length>988){return`${n.applitoolsTestId.id}_${n.applitoolsTestId.count}${a}`}return p};const m=({config:e},t,s)=>{if(!s){return undefined}const{browser:o,resolution:n,applitoolsEnvironments:r}=e;const a=t.applitoolsData.additionalEnvironments;const c=t.applitoolsData.overrideTestApplitoolsSettings?a:r;if(i.isEmpty(c)){return undefined}const l=o==="edge-chromium"||o.toLowerCase()==="edge chromium"?"edgechromium":o;const u={name:i.lowerCase(l),height:i.toInteger(n.height),width:i.toInteger(n.width)};const d=e=>{if(e.envType==="browser"){return{name:e.type,height:e.resolution.height,width:e.resolution.width}}if(e.envType==="emulator"){return{chromeEmulationInfo:{deviceName:e.device,screenOrientation:e.orientation}}}if(e.envType==="ios"){return{iosDeviceInfo:{deviceName:e.device,screenOrientation:e.orientation,iosVersion:e.version}}}return undefined};return i.chain(c).map(d).compact().unshift(u).value()};const g=e=>{const t=e=>{if(e===null||e===void 0?void 0:e.name)return`${e.name}, ${e.width}x${e.height}`;if(e===null||e===void 0?void 0:e.chromeEmulationInfo)return`${e.chromeEmulationInfo.deviceName}, ${e.chromeEmulationInfo.screenOrientation}`;if(e===null||e===void 0?void 0:e.iosDeviceInfo)return`${e.iosDeviceInfo.deviceName} (${e.iosDeviceInfo.iosVersion}), ${e.iosDeviceInfo.screenOrientation}`;return""};if(!e.length){return undefined}const s=i.chain(e).map(((e,s)=>`(${s+1}) ${t(e)}.`)).join(" ").value();return`on the following environments: ${s}`};const v=async(e,t,s)=>{var i;if(!((i=t.stepsInfo)===null||i===void 0?void 0:i[0].apiUrls)||!t.secretToken){return}const n=e=>new Promise(((t,s)=>{if(o.utils.isNode()){t(`data:image/png;base64,${e.toString("base64")}`);return}const i=new FileReader;i.readAsDataURL(e);i.onload=()=>{var e;return t(((e=i.result)===null||e===void 0?void 0:e.toString())||"")};i.onerror=e=>s(e)}));const{projectId:c,testResultId:u,testId:d,applitoolsIntegrationData:p}=e.getRunContext(undefined);try{const i=`${t.stepsInfo[0].apiUrls.checkpointImage}?AccessToken=${t.secretToken}&apiKey=${p===null||p===void 0?void 0:p.runKey}`;const o=await r.httpRequest.getBlob(i);const l=await n(o);const h=e.shouldCreateNewBaseline(s)?e.stepResultUploader.uploadImageAndSaveAsBaseline(l,s).imgUrl:a.assetService.uploadImageArtifactApi({projectId:c,imageDataUrl:l,storageApi:e.servicesApi.storage,testId:d,testResultId:u});if(h){Object.assign(t,{resultImage:h})}}catch(e){l.error("error getting applitools checkpoint image",{err:e})}};const S=async(e,t,s)=>{const{applitoolsSdkConfig:i,shouldUseVisualGrid:o}=e;const n=t.reduce(((e,t,s)=>{var o;return t.status==="Passed"?e:[...e,(o=i.browsersInfo)===null||o===void 0?void 0:o[s]]}),[]).filter(Boolean);const r=i.browsersInfo?n.length>0:t[0].status!=="Passed";const a=t.some((e=>e.isNew));const l=t[0];await v(e,l,s);return{success:!r,forceTreatAsWarning:!r&&a,reason:a?"New baseline created":undefined,resultInfo:{reason:g(n)},errorType:r?c.commonConstants.stepResult.PIXEL_VALIDATION_FAILURE:undefined,eyesResult:l,isMultiEnvironments:o,shouldRetry:false}};const y=(e,s)=>{var o;const n=e.getRunContext(undefined);const r=((o=n.incomingParams)===null||o===void 0?void 0:o.final)||{};const a=e.playback.executionId;const{applitoolsData:g}=s;const v=Boolean(g.overrideTestApplitoolsSettings);const{currentBranch:S,testId:y,labels:b,testResultId:_,testName:T,applitoolsIntegrationData:E,config:I,projectId:C}=n;const D=g.matchLevel&&g.overrideTestApplitoolsSettings===undefined&&!s.isUsingApplitoolsSDK;const O={name:"Source",value:"Testim"};const A=[O,{name:"Test ID (Testim)",value:y},{name:"Test Name (Testim)",value:T},{name:"Test Result ID (Testim)",value:_},{name:"Step ID (Testim)",value:s.applitoolsTestId.id},{name:"Step Name (Testim)",value:s.label||s.getDisplayName()},{name:"Branch (Testim)",value:S},{name:"Labels (Testim)",value:b.join(", ")}];if(a){A.unshift({name:"Execution ID (Testim)",value:a})}const j=a&&e.playback.executionName?a:_;const w=(v||D?g.matchLevel:I.applitoolsMatchLevel)||t.APPLITOOLS_DEFAULT_MATCH_LEVEL;const R={appName:d(n,r),displayName:p(e,r,s),testName:f(e,r,s),dontCloseBatches:true,serverUrl:E.url,apiKey:E.runKey,sendDom:s.type!=="wait-for-simple-ui-verification"&&((v?g.applitoolsRCA:I.applitoolsRCA)||false),browsersInfo:m(n,s,e.shouldUseVisualGrid),defaultMatchSettings:{matchLevel:w==="Content"?"IgnoreColors":w,ignoreDisplacements:v?g.applitoolsDiffs:I.applitoolsDiffs},stitchOverlap:50,stitchMode:"CSS",hideScrollbars:false,properties:A,batch:{name:h(e,s),id:j,properties:[O]},branchName:!S||S===c.commonConstants.MASTER_BRANCH?"default":S};if(r.applitoolsTestConfiguration&&i.isPlainObject(r.applitoolsTestConfiguration)){Object.assign(R,r.applitoolsTestConfiguration,{properties:[...R.properties,...r.applitoolsTestConfiguration.properties||[]]});l.log("Applitools SDK step executed with applitoolsTestConfiguration parameter",{applitoolsTestConfiguration:r.applitoolsTestConfiguration})}function P({label:e}){const t={isApplitoolsSdkLog:true,label:e,projectId:C,testId:y,testResultId:_,executionId:a};return{debug:e=>u.log(e,t),log:e=>u.log(e,t),warn:e=>u.warn(e,t),error:e=>u.error(e,t),fatal:e=>u.exception(e,t),verbose:e=>u.log(e,t)}}let x;if(r.verboseVisualValidationSteps){x={...P({label:"root"}),console:P({label:"console-logger"}),isLogger:true,close(){},open(){},tag(){},extend:P};l.log("Applitools SDK step run in verbose mode",{executionId:a,applitoolsData:g,testId:y,branch:S,projectId:C,config:R})}return{config:R,loggerConfig:x}};t.buildApplitoolsSdkConfig=y;const b=async(e,t,s)=>{var i,o,n,r,a,l;if(t.success){return await S(e,t.eyesResults,s)}if(((i=t.err)===null||i===void 0?void 0:i.message)==="Screenshot region is out of viewport"){return{success:false,isApplitoolsSdkResult:true,attemptAutoScroll:true,reason:"Element is outside of viewport"}}if((s===null||s===void 0?void 0:s.isUsingApplitoolsSDK)&&((o=t.err)===null||o===void 0?void 0:o.message)==="Error in request startSession: Network Error"){e.avoidLongName=true}const u=((r=(n=t.err)===null||n===void 0?void 0:n.info)===null||r===void 0?void 0:r.testResult)||((a=t.err)===null||a===void 0?void 0:a.message);const d=u==="Failed to set the viewport size"?"due to error setting window resolution.":undefined;return{success:false,errorType:c.commonConstants.stepResult.PIXEL_VALIDATION_ENV_FAILURE,reason:(l=t.err)===null||l===void 0?void 0:l.message,resultInfo:d,shouldRetry:false}};t.handleApplitoolsSdkResult=b},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ANDROID_KEYCODES_MAP=t.MIRRORING_DEFAULT_HEIGHT=t.MIRRORING_DEFAULT_WIDTH=t.MOBILE_OS=t.DOM_POLL_INTERVAL=t.DEFAULT_STEP_DELAY=t.TMA_SOCKET_BASE_URL=t.tmaBaseUrl=void 0;const i=s(94);function o(){return`${(0,i.getTmaUrl)()}/api`}t.tmaBaseUrl=o;t.TMA_SOCKET_BASE_URL=`${(0,i.getTmaUrl)().replace("https://","wss://").replace("http://","ws://")}`;t.DEFAULT_STEP_DELAY=1e3;t.DOM_POLL_INTERVAL=2e3;t.MOBILE_OS={ANDROID:"Android",IOS:"iOS"};t.MIRRORING_DEFAULT_WIDTH=356;t.MIRRORING_DEFAULT_HEIGHT=Math.round(t.MIRRORING_DEFAULT_WIDTH/.481);t.ANDROID_KEYCODES_MAP={0:7,1:8,2:9,3:10,4:11,5:12,6:13,7:14,8:15,9:16}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.AnalyticsSystemsService=void 0;const r=s(9);const a=s(353);const c=s(22);const l=s(7);const u="<no-company-name>";const d=l.Logger.getLogger("analytics-systems-service");let p=class e{constructor(e){this.testimServices=e;this.urlQueryParams=new a.QueryParamsContainer("");this.signUpUserIds=new Set}setQueryParamsFromUrl(e){try{this.urlQueryParams=new a.QueryParamsContainer(e)}catch(t){d.error("Failed to parse url query params",{error:t,signupOriginUrl:e})}}getUrlParams(){return this.urlQueryParams}resetUrlParams(){this.urlQueryParams=new a.QueryParamsContainer("")}setCurrentUser(e,t,s){this.currentUserId=e;this.currentUserEmail=t;this.currentUserName=s}setCurrentCompany(e){this.currentCompanyName=e?e.name:u}async trackSelectProject(e){await this.testimServices.analyticsSystems.dispatchEvent(e,this.currentUserId,"selectProject",e,{userEmail:this.currentUserEmail,userName:this.currentUserName,companyName:this.currentCompanyName})}async trackSignup(e){if(this.signUpUserIds.has(e.userId)){d.warn("user already signedUp",e);return undefined}this.signUpUserIds.add(e.userId);return this.testimServices.analyticsSystems.dispatchSignupEvent(e.projectId,e.userId,e)}};t.AnalyticsSystemsService=p;t.AnalyticsSystemsService=p=i([(0,r.injectable)(),o("design:paramtypes",[typeof(n=typeof c.TestimServicesApi!=="undefined"&&c.TestimServicesApi)==="function"?n:Object])],p)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CallOrderScheduler=t.UPDATE_REQUEST_TIMEOUT_MS=t.TIMEOUT_REQUEST_ORDERING=void 0;const i=s(77);const o=s(7);const n=s(33);const r=s(8);t.TIMEOUT_REQUEST_ORDERING=30*60*1e3;t.UPDATE_REQUEST_TIMEOUT_MS=3e4;const a={retry:false,retries:20,minTimeout:3e3,key:"",timeoutBetweenRequestOrdering:t.TIMEOUT_REQUEST_ORDERING};class c extends n.EventEmitter{constructor(){super(...arguments);this.promiseQueueMap=new Map;this.promiseQueueTimeoutsMap=new Map;this.logger=o.Logger.getLogger("call-order-scheduler")}schedule(e,s=a){var o,n;this.trigger("schedule",e,s);const c=(o=this.promiseQueueMap.get(s.key))!==null&&o!==void 0?o:Promise.resolve();clearTimeout(this.promiseQueueTimeoutsMap.get(s.key));this.promiseQueueTimeoutsMap.set(s.key,setTimeout((()=>{this.trigger("timeout",e,s);this.promiseQueueMap.delete(s.key);this.promiseQueueTimeoutsMap.delete(s.key)}),(n=s.timeoutBetweenRequestOrdering)!==null&&n!==void 0?n:t.TIMEOUT_REQUEST_ORDERING));const l=c.then((()=>{var o;this.trigger("run",e,s);const n=s.retry?i.default:(e,t)=>e();return n((async()=>{this.trigger("retry",e,s);let i;try{i=await r.utils.promiseTimeout(e(),t.UPDATE_REQUEST_TIMEOUT_MS)}catch(e){this.logger.warn("Error in update (retrying):",e);throw e}this.trigger("success",e,s);return i}),{retries:(o=s===null||s===void 0?void 0:s.retries)!==null&&o!==void 0?o:a.retries,minTimeout:s.minTimeout})})).catch((t=>{this.trigger("error",e,s,t);this.logger.error("Error in update:",t,s===null||s===void 0?void 0:s.key,e===null||e===void 0?void 0:e.name);return undefined}));this.promiseQueueMap.set(s.key,l);return l}async waitUntilAllStartsWithKeysFulfilled(e){const t=Array.from(this.promiseQueueMap.keys()).filter((t=>t.startsWith(e)));if(t.length===0){return}const s=t.map((e=>this.promiseQueueMap.get(e)));await Promise.all(s)}}t.CallOrderScheduler=c},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.FeatureAvailabilityService=void 0;const n=s(9);const r=s(2);let a=class e{setPlanType(e){this.planType=e}get isNonFreePlan(){const e=["pro","trial"];return e.includes(this.planType||"free")}get isPullRequestsEnabled(){return this.isNonFreePlan}get isTestStatusEnabled(){return this.isNonFreePlan}};t.FeatureAvailabilityService=a;i([r.observable,o("design:type",Object)],a.prototype,"planType",void 0);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],a.prototype,"isNonFreePlan",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],a.prototype,"isPullRequestsEnabled",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],a.prototype,"isTestStatusEnabled",null);t.FeatureAvailabilityService=a=i([(0,n.injectable)()],a)},,function(e,t,s){"use strict";s.r(t);t["default"]={main:"DefaultHeader_main_bNS15_RIZWFkZXIt",dropdown:"DefaultHeader_dropdown_1FaD9_RIZWFkZXIt",dropdownContainer:"DefaultHeader_dropdownContainer_1lSPn_RIZWFkZXIt",projects:"DefaultHeader_projects_1Qcf8_RIZWFkZXIt",branches:"DefaultHeader_branches_5ST9M_RIZWFkZXIt",right:"DefaultHeader_right_34K1F_RIZWFkZXIt",left:"DefaultHeader_left_1oVYP_RIZWFkZXIt",branch:"DefaultHeader_branch_2LBTw_RIZWFkZXIt",separator:"DefaultHeader_separator_ntM9B_RIZWFkZXIt",buttons:"DefaultHeader_buttons_22Bmi_RIZWFkZXIt",forkButton:"DefaultHeader_forkButton_1z3lU_RIZWFkZXIt",prsButton:"DefaultHeader_prsButton_1JMEl_RIZWFkZXIt",badge:"DefaultHeader_badge_1uzvr_RIZWFkZXIt",hasMergeDp:"DefaultHeader_hasMergeDp_1l_7D_RIZWFkZXIt",dpOptions:"DefaultHeader_dpOptions_10GHR_RIZWFkZXIt",mergeDpOptions:"DefaultHeader_mergeDpOptions_2pe2__RIZWFkZXIt",mergeOpButtons:"DefaultHeader_mergeOpButtons_2X7wG_RIZWFkZXIt",mergeOpDate:"DefaultHeader_mergeOpDate_17__W_RIZWFkZXIt",projectsDpOptionsList:"DefaultHeader_projectsDpOptionsList_3TElz_RIZWFkZXIt",mergeDpOptionsList:"DefaultHeader_mergeDpOptionsList_2XYlL_RIZWFkZXIt",pinnedBranch:"DefaultHeader_pinnedBranch_3coBj_RIZWFkZXIt",mergeOpName:"DefaultHeader_mergeOpName_fbhle_RIZWFkZXIt",branchNameWrapper:"DefaultHeader_branchNameWrapper_15_T2_RIZWFkZXIt",readOnlyBranch:"DefaultHeader_readOnlyBranch_25BNz_RIZWFkZXIt",readOnlyBranchName:"DefaultHeader_readOnlyBranchName_2alBN_RIZWFkZXIt",readOnlyLabel:"DefaultHeader_readOnlyLabel_15Pix_RIZWFkZXIt",activeProjectMark:"DefaultHeader_activeProjectMark_2W9qg_RIZWFkZXIt",cloneMark:"DefaultHeader_cloneMark_1dTRZ_RIZWFkZXIt",currentProject:"DefaultHeader_currentProject_17qVJ_RIZWFkZXIt",branchList:"DefaultHeader_branchList_akg0W_RIZWFkZXIt",typeIcon:"DefaultHeader_typeIcon_wVaNw_RIZWFkZXIt",projectName:"DefaultHeader_projectName_NY30V_RIZWFkZXIt",selectedProject:"DefaultHeader_selectedProject_3KZ5X_RIZWFkZXIt",renderItem:"DefaultHeader_renderItem_3OH1s_RIZWFkZXIt",branchItem:"DefaultHeader_branchItem_bv3qS_RIZWFkZXIt",confirmModal:"DefaultHeader_confirmModal_26WEJ_RIZWFkZXIt",pinBranchWrapper:"DefaultHeader_pinBranchWrapper_3qboR_RIZWFkZXIt",mainPinIcon:"DefaultHeader_mainPinIcon_3AJPh_RIZWFkZXIt",pinIcon:"DefaultHeader_pinIcon_1nUXo_RIZWFkZXIt",dropdownWithPin:"DefaultHeader_dropdownWithPin_2X-1N_RIZWFkZXIt"}},function(e,t,s){"use strict";s.r(t);t["default"]={"app-header":"AppHeader_app-header_rq9J3_BIZWFkZXIt",appHeader:"AppHeader_app-header_rq9J3_BIZWFkZXIt","app-header-hide-content":"AppHeader_app-header-hide-content_1TL7E_BIZWFkZXIt",appHeaderHideContent:"AppHeader_app-header-hide-content_1TL7E_BIZWFkZXIt","app-header-content":"AppHeader_app-header-content_2BA6j_BIZWFkZXIt",appHeaderContent:"AppHeader_app-header-content_2BA6j_BIZWFkZXIt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.Tooltip=t.rectToStyles=void 0;const l=s(4);const u=s(10);const d=s(210);const p=s(50);const h=s(12);const f=s(0);const m=s(2);const g=s(20);const v=({top:e,left:t,width:s,height:i},o)=>{switch(o){case"right":return{top:e+i/2,left:t+s,opacity:0};case"left":return{top:e+i/2,left:t,opacity:0};case"bottom":return{top:e+i,left:t+s/2,opacity:0};case"leftBottom":case"bottomLeft":return{top:e+i,left:t,opacity:0};case"rightBottom":case"bottomRight":return{top:e+i,left:t+s,opacity:0};case"leftTop":case"topLeft":return{top:e,left:t,opacity:0};case"rightTop":case"topRight":return{top:e,left:t+s,opacity:0};case"top":default:return{top:e,left:t+s/2,opacity:0}}};t.rectToStyles=v;class S{constructor(e){this.timeoutId=null;this.isVisible=false;this.calculatedDirection="top";this.style={top:0,left:0,opacity:0};this.tooltipRef={current:null};this._props=e}get trigger(){return this.props.trigger||"hover"}get props(){return this._props}get attachedChildProps(){if(!this.props.attachToChild){return undefined}if(["hover","self"].includes(this.trigger)){return{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}}return{onClick:this.handleClick}}updateProps(e){this._props=e}handleVisibilityChanged(e){var t,s;this.isVisible=e;(s=(t=this.props).onVisibilityChanged)===null||s===void 0?void 0:s.call(t,e)}showTooltip(e){var s;const{value:i,disabled:o,direction:n,delay:r}=this.props;if(i===undefined||i===""||o){return}const a=(s=typeof n==="function"?n():n)!==null&&s!==void 0?s:"top";const c=(0,t.rectToStyles)(e,a);this.calculatedDirection=a;this.style=c;this.handleVisibilityChanged(true);this.timeoutId=window.setTimeout((()=>(0,m.runInAction)((()=>{this.style={...c,opacity:1};this.timeoutId=null}))),r!==null&&r!==void 0?r:0)}hideTooltip(){if(this.timeoutId){clearTimeout(this.timeoutId)}this.style={top:0,left:0,opacity:0};this.handleVisibilityChanged(false)}handleMouseEnter(e){var t,s;if(this.trigger==="hover"){this.showTooltip(e.currentTarget.getBoundingClientRect())}(s=(t=this.props).onMouseEnter)===null||s===void 0?void 0:s.call(t,e)}handleMouseLeave(e){var t,s;if(this.trigger==="hover"){this.hideTooltip()}(s=(t=this.props).onMouseLeave)===null||s===void 0?void 0:s.call(t,e)}handleClick(e){if(this.trigger!=="click"){return}if(this.isVisible){this.hideTooltip();return}this.showTooltip(e.currentTarget.getBoundingClientRect())}setRef(e){this.tooltipRef.current=e;if(!e){return undefined}const t=[];if(this.props.shouldUseNativeLeaveEvent){e.addEventListener("mouseleave",this.handleMouseLeave);t.push((()=>e.removeEventListener("mouseleave",this.handleMouseLeave)))}if(this.props.shouldUseNativeEnterEvent){e.addEventListener("mouseenter",this.handleMouseEnter);t.push((()=>e.removeEventListener("mouseenter",this.handleMouseEnter)))}return()=>t.forEach((e=>e()))}}i([m.observable,o("design:type",typeof(n=typeof Omit!=="undefined"&&Omit)==="function"?n:Object)],S.prototype,"_props",void 0);i([m.observable.ref,o("design:type",Object)],S.prototype,"timeoutId",void 0);i([m.observable.ref,o("design:type",Object)],S.prototype,"isVisible",void 0);i([m.observable.ref,o("design:type",String)],S.prototype,"calculatedDirection",void 0);i([m.observable.ref,o("design:type",Object)],S.prototype,"style",void 0);i([m.observable.shallow,o("design:type",Object)],S.prototype,"tooltipRef",void 0);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"trigger",null);i([m.computed.struct,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"props",null);i([m.computed.struct,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"attachedChildProps",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[typeof(r=typeof Omit!=="undefined"&&Omit)==="function"?r:Object]),o("design:returntype",void 0)],S.prototype,"updateProps",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[Boolean]),o("design:returntype",void 0)],S.prototype,"handleVisibilityChanged",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[typeof(a=typeof DOMRect!=="undefined"&&DOMRect)==="function"?a:Object]),o("design:returntype",void 0)],S.prototype,"showTooltip",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],S.prototype,"hideTooltip",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],S.prototype,"handleMouseEnter",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],S.prototype,"handleMouseLeave",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],S.prototype,"handleClick",null);i([m.action.bound,o("design:type",Function),o("design:paramtypes",[typeof(c=typeof HTMLSpanElement!=="undefined"&&HTMLSpanElement)==="function"?c:Object]),o("design:returntype",void 0)],S.prototype,"setRef",null);t.Tooltip=(0,h.observer)((({children:e,...t})=>{var s;const i=(0,f.useMemo)((()=>new S(t)),[]);i.updateProps(t);(0,g.useClickOutside)({callback:i.hideTooltip,activate:i.isVisible&&i.trigger==="click",ignoredElements:[i.tooltipRef],eventListenerOptions:false});(0,f.useEffect)((()=>{if(i.trigger!=="self"||!i.tooltipRef.current){return}if(t.isOpen===true&&!i.isVisible){i.showTooltip(i.tooltipRef.current.getBoundingClientRect());return}if(t.isOpen===false&&i.isVisible){i.hideTooltip()}}),[t.isOpen,i.isVisible,i.trigger,i]);(0,f.useEffect)((()=>{if((t.value===undefined||t.value===""||t.disabled)&&i.trigger==="hover"){i.hideTooltip()}}),[i,i.trigger,t.disabled,t.value]);const o=i.isVisible&&(0,p.createPortal)((0,l.jsx)("div",{className:(0,u.default)(d.default.tooltip,t.className,d.default[(s=t.color)!==null&&s!==void 0?s:"black"],d.default[i.calculatedDirection],{[d.default.lineWrap]:t.lineWrap}),style:i.style,children:t.value}),document.body);if(t.attachToChild){return(0,l.jsxs)(l.Fragment,{children:[o,(0,f.cloneElement)(e,i.attachedChildProps)]})}return(0,l.jsxs)("span",{ref:i.setRef,className:t.wrapperClassName,onMouseEnter:t.shouldUseNativeEnterEvent?undefined:i.handleMouseEnter,onMouseLeave:t.shouldUseNativeLeaveEvent?undefined:i.handleMouseLeave,onClick:i.handleClick,children:[o,e]})}));t.Tooltip.displayName="Tooltip"},function(e,t,s){"use strict";s.r(t);t["default"]={zIndexNotificationLayer:"3012",dropdownContainer:"dropdown_dropdownContainer_1aBNs_JvcGRvd24t",mainContainer:"dropdown_mainContainer_1fcyr_JvcGRvd24t","--error":"dropdown_--error_2oHCb_JvcGRvd24t",error:"dropdown_--error_2oHCb_JvcGRvd24t",placeholder:"dropdown_placeholder_1Akin_JvcGRvd24t",close:"dropdown_close_3bL3U_JvcGRvd24t",disabled:"dropdown_disabled_30-gn_JvcGRvd24t",autogrow:"dropdown_autogrow_jJ4Ge_JvcGRvd24t",hasSearch:"dropdown_hasSearch_2rdtX_JvcGRvd24t",dropdownOptions:"dropdown_dropdownOptions_3mh3N_JvcGRvd24t",optionsList:"dropdown_optionsList_2ns3w_JvcGRvd24t",top:"dropdown_top_2aYPk_JvcGRvd24t",bottom:"dropdown_bottom_1bNuO_JvcGRvd24t",hidden:"dropdown_hidden_nTjad_JvcGRvd24t",item:"dropdown_item_13YTS_JvcGRvd24t",highlighted:"dropdown_highlighted_3r8Uo_JvcGRvd24t",selected:"dropdown_selected_3x_47_JvcGRvd24t",optionsSearch:"dropdown_optionsSearch_1Qjj1_JvcGRvd24t",optionsSearchClose:"dropdown_optionsSearchClose_1_Jao_JvcGRvd24t",optionsSearchIcon:"dropdown_optionsSearchIcon_2YJEE_JvcGRvd24t",optionsNoResults:"dropdown_optionsNoResults_DRgB9_JvcGRvd24t",loaderWrapper:"dropdown_loaderWrapper_ZTurI_JvcGRvd24t",dropdownOptionsStatic:"dropdown_dropdownOptionsStatic_20axW_JvcGRvd24t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.safeHighlight=t.highlight=t.handleKeydown=t.useDropdown=void 0;const i=s(6);const o=s(0);const n=s(5);const r=s(12);function a({defaultSelectedIndex:e,resetFilterOnBlur:t,listRef:s}){const i=e!==null&&e!==void 0?e:0;const n=(0,o.useRef)(null);const a=(0,o.useRef)(null);const c=(0,r.useLocalStore)((()=>({selectedIndex:i,filter:""})));const[l,u]=(0,o.useReducer)(((e,s)=>{if(t!==false&&!s){c.filter=""}return s}),false);return(0,o.useMemo)((()=>({inputElement:n,optionsElement:a,showOptions:l,setShowOptions:u,defaultSelectedIndex:i,listRef:s,state:c})),[n,a,c,l,u,i,s])}t.useDropdown=a;function c({optionsElement:e,listRef:t},s){const{current:i}=e;if((t===null||t===void 0?void 0:t.current)&&s>=0){t.current.scrollToRow(s)}if(i&&s>=0){const e=i.childNodes.item(s);if(e){const t=e.offsetTop;const s=e.offsetHeight;const o=i.clientHeight;const n=i.scrollTop;if(t<n){i.scrollTop=t}else if(t+s>o+n){i.scrollTop=t+s-o}}}}function l(e,t){const{filteredList:s}=t;if(e<0){e=s.length-1}else if(e>=s.length){e=0}c(t,e);t.state.selectedIndex=e}function u(e){const{filteredList:t,setShowOptions:s,applyChanges:i,value:o,defaultSelectedIndex:r}=e;return a=>{const{keyCode:c}=a;const u=t[e.state.selectedIndex];const d=a.shiftKey?-1:1;switch(c){case n.KEYS.shift:case n.KEYS.ctrl:case n.KEYS.alt:case n.KEYS.meta:return;case n.KEYS.enter:if(s&&u){i("",u)}else{i(e.state.filter,o)}s(false);return;case n.KEYS.escape:s(false);l(r,e);a.preventDefault();return;case n.KEYS.tab:a.preventDefault();l(e.state.selectedIndex+d,e);s(true);return;case n.KEYS.down:l(e.state.selectedIndex+1,e);s(true);return;case n.KEYS.up:l(e.state.selectedIndex-1,e);s(true);return;default:setTimeout((()=>l(r,e)));s(true)}}}t.handleKeydown=u;function d(e,t=""){if(!t){return i.escape(e)}e=i.escape(e);t=i.escape(t);const s=new RegExp(`&[^;]+;|${i.escapeRegExp(t)}`,"gi");return e.replace(s,(e=>e.toLowerCase()===t.toLowerCase()?`<em>${e}</em>`:e))}t.highlight=d;function p(e,t=""){return{__html:d(e,t)}}t.safeHighlight=p},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileAgentIndicator=t.MobileAgentStatuses=void 0;const i=s(4);const o=s(0);const n=s(123);const r=s(10);const a=s(0);const c=s(514);const l=s(16);const u=s(517);const d=s(20);const p=s(83);const h=s(11);const f=s(12);const m=s(21);t.MobileAgentStatuses={READY:"Ready",DEVELOPING:"Developing",INACTIVE:"Inactive"};t.MobileAgentIndicator=(0,f.observer)((()=>{var e,s;const[o,f]=(0,a.useState)(false);const g=(0,h.useDependencyInjector)(p.MobileAgentService);const v=(0,h.useDependencyInjector)(m.AnalyticsService);const S=(0,a.useRef)(null);const y=(0,d.useClickOutside)({callback:()=>f(false),activate:o,ignoredElements:[S]});const b=()=>{v.track("agent-indication");f(!o)};(0,a.useEffect)((()=>{g.startPolling();return g.stopPolling}),[g,g.agentStatus]);const _=[t.MobileAgentStatuses.READY,t.MobileAgentStatuses.DEVELOPING].includes((e=g.agentStatus)===null||e===void 0?void 0:e.value)?(s=g.agentStatus)===null||s===void 0?void 0:s.value:t.MobileAgentStatuses.INACTIVE;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(c.HeaderRoundBtn,{ref:S,onClick:b,tooltipValue:"",selected:o,children:[(0,i.jsx)("div",{className:(0,r.default)(n.default.statusDot,n.default[_===null||_===void 0?void 0:_.toLowerCase()])}),(0,i.jsx)(l.Icon,{icon:"mobile-agent-indicator"})]}),o&&(0,i.jsx)(u.MobileAgentIndicatorModal,{closeModal:()=>f(false),connectedDevices:g.devicesByType,agentStatus:_,elementRef:y})]})}));t.MobileAgentIndicator.displayName="MobileAgentIndicator"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l;Object.defineProperty(t,"__esModule",{value:true});t.RunsService=void 0;const u=s(9);const d=s(38);const p=s(532);const h=s(533);const f=s(2);const m=s(22);const g=s(5);const v=s(15);const S=s(27);const y=s(7);const b=y.Logger.getLogger("runs-service");let _=class e{constructor(e,t,s,i){this.socket=t;this.testimServices=s;this.projectsService=i;this._usageDetailsByProject={};this.beforeUnloadHandler=()=>{this.socket.closeSocket()};this.disposer=(0,f.reaction)((()=>e.isLoggedIn()),(e=>!e&&this.beforeUnloadHandler()));window.addEventListener("beforeunload",this.beforeUnloadHandler)}dispose(){this.disposer();window.removeEventListener("beforeunload",this.beforeUnloadHandler);this.beforeUnloadHandler()}getSuiteRuns(e,t,s,i,o){const n=new p.SocketDataAggregator((e=>{const t=s.success==="false"&&s.runnerStatus==="FINISHED";if(t){e=e.filter((e=>e.passed<e.total))}i===null||i===void 0?void 0:i(e)}),o);this.socket.switchChannel({channel:"runResult",projectId:e,returnFullDocument:false,eventQuery:t,query:s,aggregator:n});return n}getSuiteTests(e,t,s,i,o){const n=new p.SocketDataAggregator((e=>{i===null||i===void 0?void 0:i(e)}),o);this.socket.switchChannel({channel:"testResult",projectId:e,returnFullDocument:false,eventQuery:t,query:s,aggregator:n});return n}getSuiteTestsOnce(e,t){return this.testimServices.realData.getDataV2("testResult",t)}getTestRuns(e,t,s,i,o){const n=new p.SocketDataAggregator(((e,t)=>{i===null||i===void 0?void 0:i(e,Boolean(t))}),o);this.socket.switchChannel({channel:"testResult",projectId:e,returnFullDocument:true,eventQuery:t,query:s,aggregator:n});return n}async getUsageDetails(){var e;const t=this.projectsService.projectId;if(!t||t===g.commonConstants.defaults.FAKE_CODE_PROJECT_ID){return undefined}(e=this._usageDetailsByProject)[t]||(e[t]=this.testimServices.plan.getUsageForCurrentBillingPeriod(t));return this._usageDetailsByProject[t]}get isExecutionBlockedDueToQuota(){const e=async()=>{try{const e=await this.getUsageDetails();return Boolean(e===null||e===void 0?void 0:e.isExecutionBlocked)}catch(e){b.error("failed fetching isExecutionBlocked, defaulting to not blocked",{error:e});return false}};return(0,S.fromPromise)(e(),S.fromPromise.resolve(false))}};t.RunsService=_;i([f.observable.shallow,o("design:type",typeof(l=typeof Record!=="undefined"&&Record)==="function"?l:Object)],_.prototype,"_usageDetailsByProject",void 0);i([(0,f.computed)({keepAlive:true}),o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isExecutionBlockedDueToQuota",null);t.RunsService=_=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof d.AuthenticationService!=="undefined"&&d.AuthenticationService)==="function"?n:Object,typeof(r=typeof h.RealDataSocket!=="undefined"&&h.RealDataSocket)==="function"?r:Object,typeof(a=typeof m.TestimServicesApi!=="undefined"&&m.TestimServicesApi)==="function"?a:Object,typeof(c=typeof v.ProjectsService!=="undefined"&&v.ProjectsService)==="function"?c:Object])],_)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(539),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AppSource=t.SetupMobileTestState=void 0;var i;(function(e){e["SELECT_APP"]="selectApp";e["SELECT_DEVICE"]="selectDevice"})(i||(t.SetupMobileTestState=i={}));var o;(function(e){e["LIBRARY"]="library";e["DEVICE"]="device";e["UPLOAD"]="upload"})(o||(t.AppSource=o={}))},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"9856b2bf8d.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HeadlessModal=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(30);const a=s(70);const c=s(16);const l=e=>(0,i.jsxs)(r.BaseModal,{...e,closeModal:e.closeModal,className:(0,n.default)({[a.default.headlessModal]:true,[a.default.blackMode]:e.blackMode},e.className),children:[(0,i.jsx)(c.Icon,{onClick:()=>e.closeModal(),className:a.default.close,icon:"close"}),(0,i.jsx)("div",{className:(0,n.default)(a.default.modalContent,e.modalContentClassName),children:e.children})]});t.HeadlessModal=l;t.HeadlessModal.displayName="HeadlessModal";t.HeadlessModal.defaultProps=r.BaseModal.defaultProps},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.LabFeaturesService=void 0;const c=s(22);const l=s(14);const u=s(9);const d=s(7);const p=s(38);const h=s(2);const f=d.Logger.getLogger("lab-features-service");let m=class e{constructor(e,t,s){this.featureFlagsService=t;this.authenticationService=s;this.featuresBeingFetched=null;this._isLabsEnabledForCurrentCompany=false;this.labFeaturesApi=e.labFeatures}isFeatureAvailableForProject(e){var t,s;const i=this.featureFlagsService.flags[e].getValue();if(i==="disabled"){return false}if(i==="enabled"){return true}const o=(s=(t=this.currentFeatures)===null||t===void 0?void 0:t.features)!==null&&s!==void 0?s:[];const n=o.find((t=>t.featureFlagName===e));const r=this.isLabsEnabledForCurrentCompany;const a=n===null||n===void 0?void 0:n.enabled;return Boolean(r&&a)}async forceLoadLabFeatures(e,t){this.currentFeatures=null;return this.loadLabFeatures(e,t)}async loadLabFeatures(e,t){var s;if(!this.authenticationService.isLoggedIn()){f.log(`Attempted loading lab features before logging in - using a fallback of no features.\n            This probably has no real effect, and lab features will be re-fetched in following rendering loops.`,{projectId:e,companyFeatures:t,stacktrace:new Error("").stack});return[]}this._isLabsEnabledForCurrentCompany=Boolean(t===null||t===void 0?void 0:t.enableLabFeatures);if(!e){return[]}await this.featureFlagsService.fetch();if(((s=this.currentFeatures)===null||s===void 0?void 0:s.projectId)===e){return this.currentFeatures.features}return this.fetchLabFeaturesAndKeepLastResult(e)}get isLabsEnabledForCurrentCompany(){return this._isLabsEnabledForCurrentCompany}async fetchLabFeaturesAndKeepLastResult(e){const t=()=>{var t;return((t=this.featuresBeingFetched)===null||t===void 0?void 0:t.projectId)===e};const s=t()?this.featuresBeingFetched.featuresPromise:this.labFeaturesApi.getAllFeatures(e);this.featuresBeingFetched={projectId:e,featuresPromise:s};const i=await s;this.currentFeatures={projectId:e,features:i};if(t()){this.featuresBeingFetched=null}return this.currentFeatures.features}};t.LabFeaturesService=m;i([h.observable,o("design:type",Object)],m.prototype,"currentFeatures",void 0);t.LabFeaturesService=m=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof c.TestimServicesApi!=="undefined"&&c.TestimServicesApi)==="function"?n:Object,typeof(r=typeof l.FeatureFlagsService!=="undefined"&&l.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof p.AuthenticationService!=="undefined"&&p.AuthenticationService)==="function"?a:Object])],m)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l;Object.defineProperty(t,"__esModule",{value:true});t.PropertyPanelStore=void 0;const u=s(9);const d=s(2);const p=s(29);const h=s(21);const f=s(80);const m=s(91);const g=s(26);const v=s(14);let S=class e{constructor(e,t,s,i,o){this.analyticsService=e;this.editorSelectionService=t;this.editedTestStore=s;this.urlStateService=i;this.featureFlagsService=o;this.isOpen=false;this.selectedTab="properties";this._selectedCard="pp";this.sendPropertyPanelAnalytics=e=>{if(!this.step){return}const t=this.step.getFriendlyName();const s={originLocation:e,depthLevel:this.depthLevel,toggleValue:!this.isOpen?"open":"close",propertyPanelObject:t,id:this.step.id};this.analyticsService.track("editor-controlpanel-visibility-change",s)};this.toggleIsOpen=({source:e,value:t=false,selectedTab:s="properties"})=>{this.sendPropertyPanelAnalytics(e);if(t){this.selectedTab=s;this.isOpen=t;return}if(this.selectedTab===s){this.isOpen=!this.isOpen;return}this.selectedTab=s;this.isOpen=true};this.goBack=()=>this.selectedCard="pp";this.goToPrevious=()=>this.selectedCard=this.previousCard||"pp"}get openOnDebugger(){return this.isOpen&&this.selectedTab==="debugger"}get openOnProperties(){return this.isOpen&&this.selectedTab==="properties"}get resizablePropertyPanelEnabled(){return this.featureFlagsService.flags.resizablePropertyPanel.isEnabled()}get stepUsage(){var e,t;return(t=(e=this.sharedStepInfo)===null||e===void 0?void 0:e.usage)!==null&&t!==void 0?t:0}get isStepReusable(){return Boolean(this.sharedStepInfo&&!this.sharedStepInfo.hidden)}get isStepSharedAndUsedOnMultipleTests(){var e;const t=this.selectedOrContainerStep instanceof m.SharedStepInstance?this.selectedOrContainerStep.sharedStepInfo:undefined;return Boolean(t&&!(t===null||t===void 0?void 0:t.hidden)||((e=t===null||t===void 0?void 0:t.usage)!==null&&e!==void 0?e:0)>1)}get sharedStepInfo(){return this.selectedOrContainerStep instanceof m.SharedStepInstance?this.selectedOrContainerStep.sharedStepInfo:undefined}get selectedOrContainerStep(){return this.editorSelectionService.selectedOrContainerStep}get step(){return this.editorSelectionService.focusedStepOrTestConfig}get revisionStep(){if(this.selectedCard!=="revisions"||!this.step){return undefined}if(this.step instanceof m.SharedStepInstance){return this.step}if(this.step.type==="setup"){return this.editedTestStore.scenario}return undefined}get selectedCard(){return this._selectedCard}set selectedCard(e){this.previousCard=this._selectedCard;this._selectedCard=e}get depthLevel(){var e,t;const s=this.urlStateService.pathParams;if(!s.stepId){return"test"}const i=this.editedTestStore.scenario;if(i){const o=(t=(e=i.findStepById(s.stepId,true))===null||e===void 0?void 0:e.getStepContent())===null||t===void 0?void 0:t.type;if(o==="group"){return"group"}}return"step"}};t.PropertyPanelStore=S;i([d.observable.ref,o("design:type",Object)],S.prototype,"locateStep",void 0);i([d.observable,o("design:type",Object)],S.prototype,"isOpen",void 0);i([d.observable,o("design:type",String)],S.prototype,"selectedTab",void 0);i([d.observable,o("design:type",String)],S.prototype,"_selectedCard",void 0);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"openOnDebugger",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"openOnProperties",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"resizablePropertyPanelEnabled",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"stepUsage",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"isStepReusable",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"isStepSharedAndUsedOnMultipleTests",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"sharedStepInfo",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"selectedOrContainerStep",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"step",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"revisionStep",null);i([d.computed,o("design:type",String),o("design:paramtypes",[String])],S.prototype,"selectedCard",null);i([d.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"depthLevel",null);i([d.action,o("design:type",Object)],S.prototype,"toggleIsOpen",void 0);t.PropertyPanelStore=S=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof h.AnalyticsService!=="undefined"&&h.AnalyticsService)==="function"?n:Object,typeof(r=typeof f.EditorSelectionService!=="undefined"&&f.EditorSelectionService)==="function"?r:Object,typeof(a=typeof p.EditedTestStore!=="undefined"&&p.EditedTestStore)==="function"?a:Object,typeof(c=typeof g.UrlStateService!=="undefined"&&g.UrlStateService)==="function"?c:Object,typeof(l=typeof v.FeatureFlagsService!=="undefined"&&v.FeatureFlagsService)==="function"?l:Object])],S)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SaveTestError=t.ExecutionBlockedError=void 0;const i=s(5);class o extends Error{constructor(){super(i.commonConstants.error.QUOTA_EXECUTION_BLOCKED)}}t.ExecutionBlockedError=o;class n extends Error{}t.SaveTestError=n},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f;Object.defineProperty(t,"__esModule",{value:true});t.HooksService=t.TEST_LEVEL_UNIQUE_IDENTIFIERS=void 0;const m=s(6);const g=s(9);const v=s(2);const S=s(60);const y=s(92);const b=s(592);const _=s(6);const T=s(112);const E=s(129);const I=s(26);const C=s(5);const D=s(29);const O=s(80);const A=s(21);const j=s(51);const w=s(43);const R=s(14);const P=s(593);const x=s(28);const{HOOK:M}=C.commonConstants;t.TEST_LEVEL_UNIQUE_IDENTIFIERS={AFTER_TEST:"after-test-step",BEFORE_TEST:"before-test-step",SETUP_STEP:"setup-step"};let N=class e{constructor(e,t,s,i,o,n,r,a,c){this.foldersStore=e;this.revisionsService=t;this.testResultStore=s;this.urlStateService=i;this.editedTestStore=o;this.analyticsService=n;this.editorSelectionService=r;this.featureFlagsService=a;this.modalService=c;this.testHooksAreOpen=false;this.hookedStepsIds=new v.ObservableSet;this.hooksPathToIgnore=new v.ObservableSet;this.hookSteps=new v.ObservableMap;this.cachedClonedHooksTypes=new v.ObservableMap;this.testHooks=new v.ObservableMap;this.cachedClonedHooks=new v.ObservableMap;(0,v.reaction)((()=>this.urlStateService.params.testId),(()=>{this.resetHooksData()}));(0,v.reaction)((()=>this.urlStateService.params["result-id"]),(()=>{this.closeOpenHooks()}));(0,v.reaction)((()=>this.isInsideHookView),(()=>{this.toggleHookIndicationToast()}),{fireImmediately:true})}get testHasHooks(){return Boolean(this.hookSteps.size)}get isInsideHookView(){return Boolean(this.hookType)&&Boolean(this.hookedStepId)}get hookType(){return this.urlStateService.searchParams.hook}get hookedStepId(){return this.urlStateService.searchParams.hookedStepId}get isAfterTestHookShowing(){return this.testHooksAreOpen&&this.testHooks.has(M.HANDLER.AFTER_TEST)}get iterationId(){return this.urlStateService.params["iteration-id"]}get beforeAndAfterHooksAreSame(){const e=this.hookSteps.get(M.HANDLER.BEFORE_STEP);const t=this.hookSteps.get(M.HANDLER.AFTER_STEP);if(!e||!t){return false}return e.sharedStepInfoId===t.sharedStepInfoId}get testHiddenHooks(){var e;const t=(e=this.editedTestStore.testConfig)===null||e===void 0?void 0:e.hooks;if(!t||m.isEmpty(t)){return[]}const s=Object.values(t).filter((e=>e)).map((e=>e.infoId));return j.sharedStepSingleton.sharedStepInfos.filter((e=>e.hidden&&s.includes(e.id)))}toggleHookIndicationToast(){const e=this.featureFlagsService.flags.hookDrillReadOnly.isEnabled();const t=localStorage.getItem(P.HIDE_HOOK_POPUP);if(!e||t){return}if(this.isInsideHookView){this.indicationToast=this.modalService.openToast(P.HookIndicationToast)}else{this.closeIndicationToast()}}closeIndicationToast(e=false){var t;if(e){localStorage.setItem(P.HIDE_HOOK_POPUP,"true")}(t=this.indicationToast)===null||t===void 0?void 0:t.close();this.indicationToast=undefined}isHookOpen(e){return this.hookedStepsIds.has(e)}sendToggleHooksAnalytics(e,t){var s;const{BEFORE_TEST:i,AFTER_TEST:o,BEFORE_STEP:n,AFTER_STEP:r}=M.HANDLER;const a=(s=this.editedTestStore.testConfig)===null||s===void 0?void 0:s.id;const c=e=>this.analyticsService.track("step-hook-toggle",{actionType:t,hookType:e});if(e===a){const e=this.hookSteps.has(i);const t=this.hookSteps.has(o);if(e&&t){c("before&afterTest");return}if(e){c(i);return}if(t){c(o)}}else{const e=this.hookSteps.has(n);const t=this.hookSteps.has(r);if(e&&t){c("before&afterStep");return}if(e){c(n);return}if(t){c(r)}}}toggleHooksByStepId(e,t=true){var s,i;const o=(s=this.editedTestStore.testConfig)===null||s===void 0?void 0:s.id;if(e===((i=this.editedTestStore.scenario)===null||i===void 0?void 0:i.id)&&o){e=o}if(this.hookedStepsIds.has(e)){this.hookedStepsIds.delete(e);if(t){this.sendToggleHooksAnalytics(e,"close")}}else{this.hookedStepsIds.add(e);if(t){this.sendToggleHooksAnalytics(e,"open")}}const n=e===o;if(n){this.testHooksAreOpen=!this.testHooksAreOpen}}afterStepHookDidNotRunOnCondition(e,t){var s,i,o;const n=(i=(s=this.testResultStore.testResult)===null||s===void 0?void 0:s.runConfig)===null||i===void 0?void 0:i.hooks;if(t===M.HANDLER.BEFORE_STEP||t===M.HANDLER.BEFORE_TEST||!n){return false}const r=(o=n[t])===null||o===void 0?void 0:o.condition;const a=Boolean((e===null||e===void 0?void 0:e.success)&&r===M.CONDITION.FAILURE);const c=Boolean((e===null||e===void 0?void 0:e.success)===false&&r===M.CONDITION.SUCCESS);return a||c}skippedHook(e,t){if(t===M.HANDLER.AFTER_TEST){return this.afterTestHookDidNotRunOnCondition}return this.afterStepHookDidNotRunOnCondition(e,t)}get afterTestHookDidNotRunOnCondition(){var e,t,s,i,o;const n=(t=(e=this.testResultStore.testResult)===null||e===void 0?void 0:e.runConfig)===null||t===void 0?void 0:t.hooks;const r=(s=this.testHooks.get(M.HANDLER.AFTER_TEST))===null||s===void 0?void 0:s.result;if(!n||r){return false}const a=(i=n[M.HANDLER.AFTER_TEST])===null||i===void 0?void 0:i.condition;const c=(o=this.testResultStore.testResult)===null||o===void 0?void 0:o.success;const l=c&&a===M.CONDITION.FAILURE;const u=!c&&a===M.CONDITION.SUCCESS;return l||u}shouldDisplayTestHooks(e){return!this.isInsideHookView&&this.testHooksAreOpen&&this.hookSteps.has(e)}_cloneHookStep(e){const t=S.stepBuilder.buildStepFromData(e,{newId:true});t.sharedStepClass=m.cloneDeep(e.sharedStepClass);return t}getTestHooks(e,t){const s=this.hookSteps.get(t);if(!s){return undefined}const i=`${e}-${t}`;let o;const n=this.cachedClonedHooks.get(i);if(n){o=n}else{o=this._cloneHookStep(s);const e=this.testResultStore.stepResults.filter((e=>e.hookType===t));const i=e.find((e=>e.stepScreenshot))||e[0];if(i){o.setResult(i)}}this.cachedClonedHooksTypes.set(o.id,t);this.cachedClonedHooks.set(i,o);this.testHooks.set(t,o);return o}getHooksStepsWithResult(e){let t=[];let s=false;const i={beforeStep:undefined,afterStep:undefined};this.hookSteps.forEach(((o,n)=>{if(n===M.HANDLER.BEFORE_TEST||n===M.HANDLER.AFTER_TEST){return}const r=`${e}-${n}`;let a;if(this.cachedClonedHooks.has(r)){a=this.cachedClonedHooks.get(r)}else{a=this._cloneHookStep(o);if(!s){t=this.getHooksResultByStepId(e);s=true}const i=t=>{if(!this.iterationId){return t.hookType===n}return t.hookType===n&&!t.iterationId&&t.id!==e};if(t.length>1){const e=t.filter((e=>i(e)));const s=e.find((e=>e.stepScreenshot))||e[0];if(s){a.setResult(s)}}this.cachedClonedHooksTypes.set(a.id,n);if(!this.iterationId){this.cachedClonedHooks.set(r,a)}}if(a){i[n]=a}}));return i}getRelevantTestHooksResults(e){var t;const s=m.chain(this.testResultStore.stepResults).sortBy("startTimestamp").value();if(e!==M.HANDLER.BEFORE_TEST){const t=s.findIndex((t=>t.hookType===e));return s.slice(t)}const i=(t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.steps;if(!i||!i[0]){return[]}const o=i[0].id;const n=s.findIndex((e=>e.id===o));return s.slice(0,n)}getHooksResultByStepId(e){var t;const s=t=>{if(!this.iterationId){return t.id===e}return t.id===e&&t.iterationId===this.iterationId};const i=this.testResultStore.stepResults.findIndex((e=>s(e)));const o=this.testResultStore.stepResults.slice(i);const n=((t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.steps.map((e=>e.id)))||[];const r=o.findIndex((t=>n.includes(t.id)&&t.id!==e));if(r===-1){return o}return o.slice(0,r)}closeOpenHooks(){this.hookedStepsIds.clear();this.testHooksAreOpen=false}openLastSelectedHookStep(e,s){if(!this.hookedStepsIds.has(e)){this.toggleHooksByStepId(e)}if(s===M.HANDLER.AFTER_TEST){this.autoSelectedHookId=t.TEST_LEVEL_UNIQUE_IDENTIFIERS.AFTER_TEST}else{this.autoSelectedHookId=`${e}-${s}`}}onSeeErrorHookLoaded(){if(this.seeErrorStepId){this.toggleHooksByStepId(this.seeErrorStepId);this.seeErrorStepId=undefined}}onAutoScroll(){if(!this.autoSelectedHookId){return}if(this.autoSelectedHookId===t.TEST_LEVEL_UNIQUE_IDENTIFIERS.SETUP_STEP){this.editorSelectionService.forceSelectSetup()}const e=this.testHooks.get(M.HANDLER.AFTER_TEST);if(this.autoSelectedHookId===t.TEST_LEVEL_UNIQUE_IDENTIFIERS.AFTER_TEST&&e){this.editorSelectionService.setSelection({select:true,step:e})}const s=this.testHooks.get(M.HANDLER.BEFORE_TEST);if(this.autoSelectedHookId===t.TEST_LEVEL_UNIQUE_IDENTIFIERS.BEFORE_TEST&&s){this.editorSelectionService.setSelection({select:true,step:s})}const i=this.cachedClonedHooks.get(this.autoSelectedHookId);if(i){this.editorSelectionService.setSelection({select:true,step:i})}this.autoSelectedHookId=undefined}async setHooks(e,t){const s=[];for(const[i,o]of Object.entries(e)){const e=t.find((e=>e.id===(o===null||o===void 0?void 0:o.infoId)));if(!e){continue}const n=S.stepBuilder.buildStepFromData({type:"shared-step-instance",sharedStepInfoId:e.id,classType:e.type,name:e.name});s.push(this.revisionsService.synchronizeAllStep(n));this.hookSteps.set(i,n)}await Promise.all(s)}async setHooksSharedStepClasses(e,t){var s;if(!e||(0,_.isEmpty)(e.hooks)){return}const i=[];for(const o of Object.values(e.hooks)){if(o){const e=(s=t[o.infoId])===null||s===void 0?void 0:s.step;if(e){i.push({id:o.infoId,type:e.type,name:e.name})}}}await this.setHooks(e.hooks,i)}resetHooksData(){this.testHooksAreOpen=false;this.autoSelectedHookId=undefined;this.hookSteps.clear();this.testHooks.clear();this.hookedStepsIds.clear();this.hooksPathToIgnore.clear();this.cachedClonedHooks.clear();this.cachedClonedHooksTypes.clear()}async loadNewHooksData(e){var t;this.resetHooksData();const{testId:s,projectId:i,branch:o}=this.urlStateService.pathParams;const n=(t=this.testResultStore.testResult)===null||t===void 0?void 0:t.resultId;if(!e||(0,_.isEmpty)(e.hooks)||!n){return}try{const e=await w.testimServicesSingleton.test.getResult(s,n,i,o);Object.values((e===null||e===void 0?void 0:e.stepsResults)||{}).forEach((e=>this.testResultStore.addStepResult(e)))}catch(e){this.testResultStore.stepResults=this.testResultStore.stepResults.reverse()}const{sharedSteps:r}=this.foldersStore.sharedStepsFoldersTree.value;this.setHooks(e.hooks,r)}};t.HooksService=N;i([v.observable,o("design:type",Object)],N.prototype,"testHooksAreOpen",void 0);i([v.observable,o("design:type",Object)],N.prototype,"autoSelectedHookId",void 0);i([v.observable,o("design:type",Object)],N.prototype,"seeErrorStepId",void 0);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"testHasHooks",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"isInsideHookView",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"hookType",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"hookedStepId",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"isAfterTestHookShowing",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"iterationId",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"beforeAndAfterHooksAreSame",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"testHiddenHooks",null);i([v.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],N.prototype,"toggleHookIndicationToast",null);i([v.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],N.prototype,"closeIndicationToast",null);i([v.computed,o("design:type",Object),o("design:paramtypes",[])],N.prototype,"afterTestHookDidNotRunOnCondition",null);i([v.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],N.prototype,"closeOpenHooks",null);i([v.action,o("design:type",Function),o("design:paramtypes",[String,typeof(f=typeof b.HookType!=="undefined"&&b.HookType)==="function"?f:Object]),o("design:returntype",void 0)],N.prototype,"openLastSelectedHookStep",null);i([v.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],N.prototype,"onSeeErrorHookLoaded",null);i([v.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],N.prototype,"onAutoScroll",null);i([v.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],N.prototype,"resetHooksData",null);t.HooksService=N=i([(0,g.injectable)(),o("design:paramtypes",[typeof(n=typeof y.FoldersStore!=="undefined"&&y.FoldersStore)==="function"?n:Object,typeof(r=typeof T.RevisionsService!=="undefined"&&T.RevisionsService)==="function"?r:Object,typeof(a=typeof E.TestResultStore!=="undefined"&&E.TestResultStore)==="function"?a:Object,typeof(c=typeof I.UrlStateService!=="undefined"&&I.UrlStateService)==="function"?c:Object,typeof(l=typeof D.EditedTestStore!=="undefined"&&D.EditedTestStore)==="function"?l:Object,typeof(u=typeof A.AnalyticsService!=="undefined"&&A.AnalyticsService)==="function"?u:Object,typeof(d=typeof O.EditorSelectionService!=="undefined"&&O.EditorSelectionService)==="function"?d:Object,typeof(p=typeof R.FeatureFlagsService!=="undefined"&&R.FeatureFlagsService)==="function"?p:Object,typeof(h=typeof x.ModalService!=="undefined"&&x.ModalService)==="function"?h:Object])],N)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f;Object.defineProperty(t,"__esModule",{value:true});t.EditorHostService=void 0;const m=s(8);const g=s(117);const v=s(5);const S=s(7);const y=s(26);const b=s(49);const _=s(79);const T=s(55);const E=s(39);const I=s(34);const C=s(15);const D=s(38);const O=s(21);const A=s(20);const j=s(598);const w=s(2);const R=s(9);const P=S.Logger.getLogger("base-editor-host");let x=class e extends g.BaseHostService{constructor(e,t,s,i,o,n,r,a,c,l){super();this.projectsService=e;this.branchesService=t;this.companiesService=s;this.premiumFeaturesService=i;this.extensionService=o;this.authenticationManager=n;this.userService=r;this.urlState=a;this.analyticsService=c;this.labFeaturesService=l;this.hasEditorTabs=false;this.branchChangeListener=e=>this.reportBranchChange(e);this.projectChangeListener=()=>this.reportProjectChange();this.onLabFeaturesChanged=()=>this.reportLabFeaturesChanged();this.companyChangeListener=()=>this.reportCompanyChange();this.onLoginListener=()=>this.reportLoginChange();this.onLogOutListener=()=>this.reportLogOutChange();this.onVersionUpdated=()=>this.extensionService.onReceivedUpdate();this.onInstalled=()=>this.init();this.listenToEvents();this.extensionService.on(v.commonConstants.host.INSTALLED,this.onInstalled);this.init()}async init(){var e;const t=(e=this.urlState.params)===null||e===void 0?void 0:e.attachTabId;if(this._port){return}const s=await this.extensionService.doesExtensionExist();if(!s){this.flushAll();return}const i=await this.connect(t&&parseInt(t,10));this.hasEditorTabs=i.hasSessionTab;this.initLivenessCheck();this.on(v.commonConstants.host.EXTENSION_UPDATE_EXISTS,this.onVersionUpdated)}canRecord(){return this.extensionService.validateInExtension()}async isIncognitoAllowedOnBrowser(){const e=await this.extensionService.doesExtensionExist();if(!e){return false}const t=await this.send(v.commonConstants.scenario.IS_INCOGNITO_ALLOWED,{});return Boolean(t===null||t===void 0?void 0:t.isIncognitoAllowed)}send(e,t){return this.sendBG(e,t)}sendAsync(e,t){this.sendAsyncBG(e,t)}initLivenessCheck(){if(this.livenessCheck){clearInterval(this.livenessCheck)}const e=this.extensionService._extensionVersion===v.commonConstants.host.DEV_EXTENSION_VERSION;const t=Boolean(this.extensionService._extensionVersion);if(!e&&t){this.livenessCheck=window.setInterval((()=>this.extensionService.pingExtension().catch((e=>{P.error("extension did not answer ping",e);clearInterval(this.livenessCheck)}))),1e3*60*10)}}onDisconnect(e){const t=this._port;super.onDisconnect(e);if(e===t){window.location.reload()}}openExtensionManager(){const{OPEN_EXTENSION_MANAGER:e}=v.commonConstants.host;this.sendAsyncBG(e)}onSessionStarted(){super.onSessionStarted();this.reportLoginChange();this.initBackgroundState()}initBackgroundState(){this.reportCompanyChange();this.reportProjectChange();this.reportBranchChange(this.branchesService.branch)}async sessionStartedExtraData(){await(0,w.when)((()=>Boolean(this.projectsService.areProjectsLoaded&&this.projectsService.projectId)));return{projectType:this.projectsService.projectType}}reportLabFeaturesChanged(){return this.extensionService.onLabFeaturesChanged(this.projectsService.projectId)}reportProjectChange(){const e=this.premiumFeaturesService.premiumFeatures;const t=(0,A.isPlaygroundModeState)(this.urlState);if(t){e.disableUploadFile=true}if(A.isEditorForceMode){e.fileDownload=false}this.sendAsyncBG(v.commonConstants.host.SET_PROJECT,{projectType:this.projectsService.projectType,projectId:this.projectsService.projectId,servicesUrl:m.utils.getServicesUrl(),agentBaseUrl:m.utils.getTestimBaseAgentUrl(),projectDefaults:this.projectsService.projectDefaults,premiumFeatures:e})}reportLogOutChange(){this.sendAsyncBG(v.commonConstants.scenario.APP_LOGOUT)}reportLoginChange(){this.sendAsyncBG(v.commonConstants.scenario.APP_LOGIN,this.authenticationManager.loginData)}reportCompanyChange(){this.sendAsyncBG(v.commonConstants.host.SET_COMPANY,{companyId:this.companiesService.companyId,planType:this.companiesService.companyPlanType,isPOC:this.companiesService.activePlan.isPoc,isStartUp:this.companiesService.activePlan.isStartUp,onprem:this.companiesService.isOnPrem,storageType:this.companiesService.storageType,storageBaseUrl:this.companiesService.storageBaseUrl,premiumFeatures:this.premiumFeaturesService.premiumFeatures})}reportBranchChange(e){this.sendAsyncBG(v.commonConstants.scenario.BRANCH_CHANGED,{branch:e})}listenToEvents(){this.userService.on(v.commonConstants.user.LOGIN,this.onLoginListener);this.userService.on(v.commonConstants.user.LOGOUT,this.onLogOutListener);this.projectsService.on([v.commonConstants.scenario.PROJECT_SELECTED,v.commonConstants.scenario.PROJECT_CHANGED],this.projectChangeListener);this.companiesService.on([v.commonConstants.scenario.COMPANY_SELECTED,v.commonConstants.scenario.COMPANY_CHANGED],this.companyChangeListener);this.branchesService.on(v.commonConstants.scenario.BRANCH_CHANGE,this.branchChangeListener);this.labFeaturesService.on(v.commonConstants.labFeatures.PROJECT_LAB_FEATURES_CHANGED,this.onLabFeaturesChanged);this.on(v.commonConstants.scenario.NO_TABS_IN_SESSION,(()=>{this.hasEditorTabs=false}));this.on(v.commonConstants.scenario.CREATED_TAB_IN_SESSION,(()=>{this.hasEditorTabs=true}));this.on(v.commonConstants.host.ANALYTICS_TRACK,(([e,t])=>this.analyticsService.track(e,t)))}unsubscribeFromEvents(){const{PROJECT_SELECTED:e,PROJECT_CHANGED:t,COMPANY_SELECTED:s,COMPANY_CHANGED:i,BRANCH_CHANGE:o}=v.commonConstants.scenario;this.branchesService.off(o,this.branchChangeListener);this.projectsService.off([e,t],this.projectChangeListener);this.companiesService.off([s,i],this.companyChangeListener);this.userService.off(v.commonConstants.user.LOGIN,this.onLoginListener);this.userService.off(v.commonConstants.user.LOGOUT,this.onLogOutListener);this.extensionService.off(v.commonConstants.host.INSTALLED,this.onInstalled);this.off(v.commonConstants.host.EXTENSION_UPDATE_EXISTS,this.onVersionUpdated)}destroy(){this.removeAllListeners();this.unsubscribeFromEvents();super.destroy()}canPlay(){return this.extensionService.validateInExtension()}};t.EditorHostService=x;i([w.observable,o("design:type",Object)],x.prototype,"hasEditorTabs",void 0);t.EditorHostService=x=i([(0,R.injectable)(),o("design:paramtypes",[typeof(n=typeof C.ProjectsService!=="undefined"&&C.ProjectsService)==="function"?n:Object,typeof(r=typeof I.BranchesService!=="undefined"&&I.BranchesService)==="function"?r:Object,typeof(a=typeof E.CompaniesService!=="undefined"&&E.CompaniesService)==="function"?a:Object,typeof(c=typeof T.PremiumFeaturesService!=="undefined"&&T.PremiumFeaturesService)==="function"?c:Object,typeof(l=typeof _.ExtensionService!=="undefined"&&_.ExtensionService)==="function"?l:Object,typeof(u=typeof D.AuthenticationService!=="undefined"&&D.AuthenticationService)==="function"?u:Object,typeof(d=typeof b.UserService!=="undefined"&&b.UserService)==="function"?d:Object,typeof(p=typeof y.UrlStateService!=="undefined"&&y.UrlStateService)==="function"?p:Object,typeof(h=typeof O.AnalyticsService!=="undefined"&&O.AnalyticsService)==="function"?h:Object,typeof(f=typeof j.UILabFeaturesService!=="undefined"&&j.UILabFeaturesService)==="function"?f:Object])],x)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ErrorModal=void 0;const i=s(4);const o=s(0);const n=s(45);const r=s(236);const a=s(10);const c=({title:e,subTitle:t,closeModal:s,className:o,body:c,hideFooter:l})=>(0,i.jsx)(n.MessageModal,{title:e,subTitle:t,body:c||"Something went wrong, please try again or contact support",okText:"DISMISS",variety:"error",textAlign:"left",hideFooter:l,closeModal:s,className:(0,a.default)(r.default.modal,o)});t.ErrorModal=c;c.displayName="ErrorModal"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f;Object.defineProperty(t,"__esModule",{value:true});t.TestController=void 0;const m=s(6);const g=s(2);const v=s(8);const S=s(7);const y=s(5);const b=s(43);const _=s(308);const T=s(100);const E=s(60);const I=s(62);const C=s(34);const D=s(310);const O=s(14);const A=s(29);const j=s(167);const w=s(84);const R=s(9);const P=s(51);const x=s(48);const M=s(637);const N=s(111);const F=s(638);const L=s(39);const k=s(15);const B=s(21);const U=s(641);const G=S.Logger.getLogger("test controller");const{IMPROVE:V,REASSIGN:H}=y.commonConstants.assignTypes;let $=class e{constructor(e,t,s,i,o,n,r,a,c,l){this.hostService=e;this.branchesService=t;this.companiesService=s;this.projectsService=i;this.featureFlagsService=o;this.editedTestStore=n;this.saveUtils=r;this.recordingStore=a;this.analyticsService=c;this.tmsService=l;this.missingSteps=[];this.loadUtils=new T.LoadUtils(b.testimServicesSingleton)}async updateStepImages(e,t,s,i){const o=await this._getImage(t.tabInfo||undefined,e,i);if(!o.screenImage){return}this.editedTestStore.updateStep(t,{aggregateUpdateAction:true,screenImageHighlight:o.absoluteScreenHighlight,screenImage:o.screenImage,[s]:{thumbnailInfo:{elementArea:o.absoluteScreenHighlight,image:o.screenImage}}})}updateStepEvents(e,t,s){if(!(e instanceof M.BaseEventStep)||!e.events||!s.pointerPosition){return}function i(s){if(t==="toElement"){return s.event==="mouseup"}if(e.toElement){return s.event==="mousedown"}return true}const o=e.events.map((e=>{const t=e;if(i(t)){const e={originX:s.pointerPosition.x,originY:s.pointerPosition.y,screenX:s.pointerPosition.screenX,screenY:s.pointerPosition.screenY,x:s.pointerPosition.x-s.rect.left,y:s.pointerPosition.y-s.rect.top};const i=m.cloneDeep(t);i.pointerPosition=Object.assign(i.pointerPosition||{},e);return i}return t}));this.editedTestStore.updateStep(e,{events:o})}groupSteps(e,t={}){var s;const i="group";const o=t.name||"";const n=this.editedTestStore.scenario;let r=n;if(e[0]){r=((s=n===null||n===void 0?void 0:n.findStepById(e[0],true))===null||s===void 0?void 0:s.parentStep)||undefined}else if(t.parentId){r=(n===null||n===void 0?void 0:n.findStepById(t.parentId,true))||undefined}let a;if(e.length){a=Math.min(...e.map((e=>(r===null||r===void 0?void 0:r.findStepIndex({id:e}))||0)))}else{a=t.position}const c=E.stepBuilder.buildStepFromData({name:o,type:i});const l=e=>{var t,s;return(s=(t=e.parentStep)===null||t===void 0?void 0:t.findStepIndex(e))!==null&&s!==void 0?s:0};const u=e.map((e=>n===null||n===void 0?void 0:n.findStepById(e,true))).filter(Boolean).sort(((e,t)=>l(e)-l(t)));u.forEach((e=>{c.addStep(e)}));const d=P.sharedStepSingleton.createSharedStepInfo(c.name,c,{hidden:!t.allowReuse});const p=E.stepBuilder.buildStepFromData({type:"shared-step-instance",sharedStepInfoId:d.id,name:c.name,classType:i});p.sharedStepClass=c;r===null||r===void 0?void 0:r.getStepContent().addStep(p,a);this.hostService.activeHost.sendAsync(y.commonConstants.scenario.PURGE_LAST_STEP_DATA);return p}addNewSharedStepFromRecording(e){var t,s,i;if(!e){G.error("failed to add shared step: step was not provided")}const{name:o,type:n,allowReuse:r=false}=e;const a=(s=(t=this.recordingStore.insertionContainer)===null||t===void 0?void 0:t.id)!==null&&s!==void 0?s:"";const c=this.recordingStore.getInsertionIndex((i=this.editedTestStore.scenario)===null||i===void 0?void 0:i.findStepById(a,true));this.addNewSharedStep({type:n},c,a,o,{hidden:!r})}addNewSharedStep(e,t,s,i,o={}){var n;const r=P.sharedStepSingleton.createNewSharedStep(e,i,o);let a=(n=this.editedTestStore.scenario)===null||n===void 0?void 0:n.findStepById(s,true);if(!(a===null||a===void 0?void 0:a.getStepContent().addStep)){a=this.recordingStore.insertionContainer}a.getStepContent().addStep(r,t);return r}getSaveRecordingData(){const e=this.editedTestStore.test;return{test:e,scenario:e.scenario,testConfig:e.testConfig,customTestData:e.customTestData,wereAllStepsNewBeforeSave:e.areAllStepsNew()}}triggerTestSavedEvent(e,t){this.editedTestStore.trigger(y.commonConstants.scenario.TEST_SAVED,{wereAllStepsNewBeforeSave:e,test:t})}async autoGroup(e,t,s,i,o,n,r="create"){const a=n.uid||"";const c=n.name||n.email||"";const{testConfig:l,customTestData:u,wereAllStepsNewBeforeSave:d,test:p,scenario:h}=this.getSaveRecordingData();const f=await this.saveUtils.autoGroup(t,s,e,i,o,p,h,l,u,a,c,r);this.triggerTestSavedEvent(d,p);return f}async saveRecording(e,t,s,i,o){var n;const{test:r,scenario:a,testConfig:c,customTestData:l,wereAllStepsNewBeforeSave:u}=this.getSaveRecordingData();const d=await this.saveUtils.saveRecording(e,t,r,a,c,s,l,i,o,this.analyticsService,this.tmsService.tests);this.branchesService.saveLatestRevision(r.id,(n=r.revisions.latest)!==null&&n!==void 0?n:"");const p=d.sharedStepsData.dirtySharedStepInfos.map((e=>e.id));P.sharedStepSingleton.sharedStepInfos.filter((e=>p.includes(e.id))).forEach((e=>this.branchesService.saveLatestRevision(e.id,e.revisions.latest)));const h=this.editedTestStore.test;this.triggerTestSavedEvent(u,r);return h}async loadTest({id:e,revisionId:t,branch:s,resultId:i,projectId:o,skipSharedSteps:n=false,validateBranchAfterTestLoaded:r=true}){const a=this.featureFlagsService.flags.loadTestUseBranchMap.isEnabled();const c=n?this.loadUtils.loadTestCompleteWithoutSharedSteps(e,t,null,s,o,a):this.loadUtils.loadTestComplete(e,t,null,s,o,a);const l=await c;if(r&&this.branchesService.branch!==s){return undefined}this.missingSteps=l.missingSteps;if(l.sharedStepClasses){P.sharedStepSingleton.setSharedStepClasses(l.sharedStepClasses)}if(l.scenarioData.sharedSteps){P.sharedStepSingleton.setBranchLatestRevisions(l.scenarioData.sharedSteps)}this.editedTestStore.setTestFromFromData(l);if(this.editedTestStore.test){if(i){this.editedTestStore.test.resultId=i}return this.editedTestStore.test}return undefined}async setElementLocatorAndReturnLocatorData({selectionMode:e,...t}){const s=await this.hostService.activeHost.send(y.commonConstants.scenario.GET_LOCATOR,{selectionMode:e});if(!s){return undefined}if("canceled"in s){return undefined}const i={...s,...(!t.assignType||t.assignType===H)&&{wasReassigned:true}};if(J(i)){await this.setMobileLocatorAndImage({locatorData:i,...t})}else{await this.setWebLocatorImageAndLocation({locatorData:i,...t})}return i}async setMobileLocatorAndImage(e){const{locatorData:t,step:s,paramId:i,paramNamePrefix:o,onlyLocalReporting:n}=e;const r=await(0,F.ImageUploader)(this.companiesService.storageType).uploadImage({imageURL:t.screenshotUrl,storageBaseUrl:this.companiesService.storageBaseUrl,projectId:this.projectsService.projectId});this.editedTestStore.updateStep(s,{...t,screenImage:r,element:{id:v.utils.guid(),type:"mobile-locate",xpath:t.element.xpath,mobileLocator:t.element.mobileLocator,forceVisibility:t.element.forceVisibility,thumbnailInfo:{elementArea:t.element.thumbnailInfo.elementArea,image:r},screenImage:r}});const a=Object.assign(m.cloneDeep(t),{id:v.utils.guid(),type:"mobile-locate",screenImage:r});const c=W(t);if(s instanceof N.ParameterStep){if(i){await this._updateStepByParamId({step:s,stepData:a,locatorData:t,imageData:c,paramId:i,onlyLocalReporting:n});return}if(o){await this._updateStepByParamNamePrefix({step:s,stepData:a,locatorData:t,imageData:c,paramNamePrefix:o,onlyLocalReporting:n})}}}async setWebLocatorImageAndLocation(e){const{locatorData:t,step:s,elementName:i="element",paramId:o,paramNamePrefix:n,assignType:r=H,projectDefaults:a,onlyLocalReporting:c}=e;if(r===V){let e;if(s instanceof N.ParameterStep){if(o){e=s.parameterValues.find((e=>e.targetId===o))}else if(i&&s[i]){e=s[i]}}if(e){const s=new D.LocatorsComparator;const{elementLocator:i}=s.mergeLocatorPaths(t.elementLocator,e.elementLocator);t.elementLocator=i;t.improvedVersion=(e.improvedVersion||0)+1;t.wasImproved=true}else{G.error("couldn't find element to improve upon",{paramNamePrefix:n,elementName:i,paramId:o,stepType:s.type,stepId:s.id})}}const l=_.LocateStep.buildLocateStepData(t,a.selectorFilterSpec);const u=W(t);const d=s.tabInfo||t.tabInfo;if(s instanceof N.ParameterStep){if(o){await this._updateStepByParamId({step:s,stepData:l,locatorData:t,imageData:u,tabInfo:d,paramId:o,onlyLocalReporting:c});return}if(n){await this._updateStepByParamNamePrefix({step:s,stepData:l,locatorData:t,imageData:u,tabInfo:d,paramNamePrefix:n,onlyLocalReporting:c});return}}await this._updateWebLocatorByElementName({step:s,stepData:l,locatorData:t,imageData:u,elementName:i,onlyLocalReporting:c})}async _updateWebLocatorByElementName({step:e,stepData:t,locatorData:s,imageData:i,elementName:o,onlyLocalReporting:n}){const r={aggregateUpdateAction:true,location:s.location,targetName:s.label,tabInfo:s.tabInfo,wasImproved:s.wasImproved,wasReassigned:s.wasReassigned,..."targetName"in s&&{targetName:s.targetName},..."relativeTouch"in s&&{relativeTouch:s.relativeTouch},[o]:t};this.editedTestStore.updateStep(e,r);this.updateStepEvents(e,o,s);await this.updateStepImages(i,e,o,n)}async _updateStepByParamId({step:e,stepData:t,locatorData:s,imageData:i,tabInfo:o,paramId:n,onlyLocalReporting:r}){var a;const c=e.parameterNames.find((e=>e.parameterId===n));if(!c){return}this.editedTestStore.updateStep(e,{aggregateUpdateAction:true,tabInfo:s.tabInfo,wasImproved:s.wasImproved,wasReassigned:s.wasReassigned,updateParameters:[{parameterId:n,stepData:t}]});if(!("element"in t)||((a=t.element)===null||a===void 0?void 0:a.type)!=="mobile-locate"){await this._takeScreenshotForParameters(o,i,e,n,r)}}async _updateStepByParamNamePrefix({step:e,stepData:t,locatorData:s,imageData:i,tabInfo:o,paramNamePrefix:n,onlyLocalReporting:r}){var a;this.editedTestStore.updateStep(e,{aggregateUpdateAction:true,tabInfo:s.tabInfo,wasImproved:s.wasImproved,wasReassigned:s.wasReassigned,newParameters:[{...t,targetNamePrefix:n}]});const c=e.parameterValues.at(-1).targetId;if(!("element"in t)||((a=t.element)===null||a===void 0?void 0:a.type)!=="mobile-locate"){await this._takeScreenshotForParameters(o,i,e,c,r)}}_getImage(e,t,s=false){return this.hostService.activeHost.send(y.commonConstants.scenario.CAPTURE_SCREENSHOT,{tabInfo:e,info:t,onlyLocalReporting:s})}async _takeScreenshotForParameters(e,t,s,i,o=true){const n=await this._getImage(e||undefined,t,o);this.editedTestStore.updateStep(s,{aggregateUpdateAction:true,updateParameters:[{parameterId:i,screenImage:n.screenImage,screenImageHighlight:n.absoluteScreenHighlight}]})}createNewTest(e,t,s,i){const o="";const n="";const r="";this.editedTestStore.setNewTestWithDefault(e,t,s,o,n,r,null,i);this.recordingStore.insertionContainer=this.editedTestStore.scenario;if(!this.editedTestStore.test){return null}if(i===y.commonConstants.test.ANDROID){this.editedTestStore.test.isMobile=true}else if(i===y.commonConstants.test.IOS){this.editedTestStore.test.isMobile=true}return this.editedTestStore.test}};t.TestController=$;i([g.action,o("design:type",Function),o("design:paramtypes",[Array,Object]),o("design:returntype",void 0)],$.prototype,"groupSteps",null);t.TestController=$=i([(0,R.injectable)(),(0,x.exposeGlobally)("testController"),o("design:paramtypes",[typeof(n=typeof I.HostService!=="undefined"&&I.HostService)==="function"?n:Object,typeof(r=typeof C.BranchesService!=="undefined"&&C.BranchesService)==="function"?r:Object,typeof(a=typeof L.CompaniesService!=="undefined"&&L.CompaniesService)==="function"?a:Object,typeof(c=typeof k.ProjectsService!=="undefined"&&k.ProjectsService)==="function"?c:Object,typeof(l=typeof O.FeatureFlagsService!=="undefined"&&O.FeatureFlagsService)==="function"?l:Object,typeof(u=typeof A.EditedTestStore!=="undefined"&&A.EditedTestStore)==="function"?u:Object,typeof(d=typeof j.SaveUtils!=="undefined"&&j.SaveUtils)==="function"?d:Object,typeof(p=typeof w.RecordingStore!=="undefined"&&w.RecordingStore)==="function"?p:Object,typeof(h=typeof B.AnalyticsService!=="undefined"&&B.AnalyticsService)==="function"?h:Object,typeof(f=typeof U.TmsService!=="undefined"&&U.TmsService)==="function"?f:Object])],$);function W(e){var t;const s=e.windowOffset||{left:0,top:0};const i=m.clone((t=e.rect)!==null&&t!==void 0?t:e.screenImageHighlight);i.left=Math.floor(i.left+s.left);i.top=Math.floor(i.top+s.top);const o=m.clone(e.pointerPosition);return{elementRect:i,pointerPosition:o}}function J(e){return"element"in e&&e.element.type==="mobile-locate"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ElementLocator=void 0;const i=s(54);const o=s(53);const n=s(634);class r{constructor(e={}){this.selectors=e.selectors;this.nonUniqueSelectors=e.nonUniqueSelectors;this.score=null;this.document=null;this.sessionId=i.injectorUtils.guid()}isEdited(){return this.selectors.some((e=>e.isEdited()))}setDocument(e){this.document=e}getDocument(){return this.document}getIndexInDocument(){return this.document.elementLocators.indexOf(this)}filterSelectors(){return this.selectors.filter((e=>e===null||e===void 0?void 0:e.isUsed)).filter((e=>!o.locatorBuilderUtils.isEmptyTextSelector(e)))}setTargetElement(){this.isTargetElement=true}getTargetElement(){const e=this.getDocument()?this.getDocument().getElementLocators():[];return e.find((e=>e.isTargetElement===true))}setScoreThreshold(e){this.scoreThreshold=e}getScoreThreshold(){return this.scoreThreshold||o.locatorBuilderUtils.MINIMAL_SCORE_THRESHOLD}locate(){if(this.locatorCache){return this.locatorCache}const e=this.getDocument()?this.getDocument().getElementLocators().indexOf(this):null;const t=this.filterSelectors();if(t.length===0){this.locatorCache={locatorIndex:e,foundElementID:o.locatorBuilderUtils.EMPTY_RESULT_ID,element:o.locatorBuilderUtils.EMPTY_RESULT,score:"0",foundElementScore:0,foundElementStr:o.locatorBuilderUtils.domElementToStr(o.locatorBuilderUtils.EMPTY_RESULT),selectorResults:[],isTargetElement:false};return this.locatorCache}const s=t.map((e=>e.locate()));const i=new n.AggregatedQueryResult;if(this.isTargetElement){i.setTargetElement()}const r=i.getBestFromSelectorResults(s);i.updateSelectorResultsWithRelativeElement(s,Number(r.testimElementDomId));this.score=r.finalScore.toFixed(2);this.locatorCache=this.buildLocatorResultObject(r,s,e,i);return this.locatorCache}buildLocatorResultObject(e,t,s,i){const n=t.map((e=>e.getSerializableObject()));return{foundElementStr:o.locatorBuilderUtils.domElementToStr(e.element),foundElementID:o.locatorBuilderUtils.calcTestimId(e.element),foundElementScore:e.score,selectorResults:n,locatorIndex:s,element:e.element,score:this.score,isTargetElement:i.isTargetElement}}getScore(){if(this.getActualElement()&&!o.locatorBuilderUtils.isNone(this.score)){return this.score}this.forceCalcScore();return this.score}forceCalcScore(){const e=this.locate();if(o.locatorBuilderUtils.isEmptyResult(e.element)){this.score=0}else{this.setActualElement(e.element);this.score=e.score}}getActualElement(){return this.actualElement}setActualElement(e){this.actualElement=e}getDomId(){return this.sessionId}serialize(){return{type:"ElementLocator",selectors:this.selectors.map((e=>e.serialize())),score:this.score,...Object.hasOwn(this,"scoreThreshold")&&{scoreThreshold:this.scoreThreshold},...this.nonUniqueSelectors&&{nonUniqueSelectors:this.nonUniqueSelectors.map((e=>e.serialize()))}}}selectorTypes(){return this.serialize().selectors.map((e=>e.type))}toString(){return`elementLocator: selectors=\n${JSON.stringify(this.selectorTypes(),null,2)}`}}t.ElementLocator=r},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.deleteCodelessProps=t.saveUtilsPrivateFunctions=t.SaveUtils=t.isCodeSizeAboveLimit=t.CODE_STEP_LIMIT_MESSAGE=t.TEST_DATA_LIMIT_MESSAGE=void 0;const r=s(6);const a=s(5);const c=s(7);const l=s(22);const u=s(9);const d=s(51);const p=s(8);const h=s(161);const f=c.Logger.getLogger("SaveUtils");const m=new Set;const g=2e6;t.TEST_DATA_LIMIT_MESSAGE=`The test data size must be within ${p.utils.formatBytes(g)}, Please decrease the code or you won't be able to save this test`;t.CODE_STEP_LIMIT_MESSAGE=`The code size must be within ${p.utils.formatBytes(g)}, Please decrease the test data or you won't be able to save this test`;const v=e=>new Blob([e]).size;const S=e=>v(e)>g;t.isCodeSizeAboveLimit=S;let y=class e{constructor(e){this.testimServicesApi=e}updateTms(e,t,s){var i,o,n;if(e.tms&&!((i=e===null||e===void 0?void 0:e.tms)===null||i===void 0?void 0:i.tmsTests)){e.tms.tmsProjectId=undefined;return}if(!((o=e.tms)===null||o===void 0?void 0:o.tmsProjectId)||!((n=e.tms)===null||n===void 0?void 0:n.tmsTests)||!s||s.length===0){return}const r=e.tms.tmsTests.filter((({tmsTestId:e})=>s.some((({id:t})=>t===e))));if(r.length===0){e.tms.tmsProjectId=undefined;e.tms.tmsTests=undefined;e.setDirty()}else if(e.tms.tmsTests.length!==r.length){e.tms.tmsTests=r;e.setDirty()}}async saveRecording(e,s,i,o,n,r,a,c,l,u,d){if(!i){throw new Error("could not save, no test")}if((0,t.isCodeSizeAboveLimit)(i.customTestData.code)){throw new h.SaveTestError(t.TEST_DATA_LIMIT_MESSAGE)}_(a.code,i.id);if(m.has(i.id)){f.error("saveRecording: failed to save test - already saving",{testId:i.id,name:i.name,scenarioId:o.id,pendingSaveTests:[...m],author:r,stack:new Error("").stack});throw new Error("saveRecording: Failed to save test. Details: already saving")}f.log("saveRecording: saving test",{testId:i.id,name:i.name,scenarioId:o.id,author:r,authorName:l,stack:new Error("").stack});i.isEmptyTest=[...o].length===0;this.updateTms(o,e,d);const p=I(s,i,o,r,u);const g=n.getSerializableObject();const v=a.getSerializableSaveObject();try{m.add(i.id);const t=p.sharedStepsData.dirtySharedStepInfos.map((e=>e.id));const n=new Set([...o].flatMap((({step:e,sharedStep:t})=>[e,e===null||e===void 0?void 0:e.sharedStepClass,t,t===null||t===void 0?void 0:t.sharedStepClass])).filter(Boolean));const a=await this.testimServicesApi.test.save(e,{author:r,message:s.message,parentFolderId:s.parentFolderId},p.serializedStepToSave,p.sharedStepsData,p.childSharedStepInfoIds,p.serializedTest,c,g,v);C(a,o,i,l);D(o,i,t,n);f.log("test saved",{testId:i.id,name:i.name,scenarioId:o.id,pendingSaveTests:[...m]});return p}catch(e){f.error("scenario save failed",{err:e,testId:i.id,name:i.name,scenarioId:o.id,pendingSaveTests:[...m]});throw new Error(`Failed to save. Details: ${e.message}`)}finally{m.delete(i.id)}}async autoGroup(e,t,s,i,o,n,r,a,c,l,u,d="create"){if(m.has(n.id)){f.error("autoGroup: failed to save - already saving",{testId:n.id,name:n.name,scenarioId:r.id,pendingSaveTests:[...m],mode:d,author:l});throw new Error("autoGroup: Failed to save. Details: already saving")}m.add(n.id);f.log("autoGroup: saving test",{testId:n.id,name:n.name,scenarioId:r.id,mode:d,author:l,authorName:u});const p=I(e,n,r,l);const h=a.getSerializableObject();const g=c.getSerializableSaveObject();const v={projectId:s,steps:p.serializedStepToSave,test:p.serializedTest,branch:i,testConfig:h,customData:g,sharedSteps:p.sharedStepsData,childSharedStepInfoIds:p.childSharedStepInfoIds,saveInfo:{author:l,message:e.message}};try{let e;const a=p.sharedStepsData.dirtySharedStepInfos.map((e=>e.id));const c=new Set([...r].flatMap((({step:e,sharedStep:t})=>[e,e===null||e===void 0?void 0:e.sharedStepClass,t,t===null||t===void 0?void 0:t.sharedStepClass])).filter(Boolean));if(d==="create"){e=await this.testimServicesApi.autoGroup.autoGroup(t,s,i,v,o)}else{e=await this.testimServicesApi.autoGroup.autoGroupReplace(t,s,i,v,o)}D(r,n,a,c);f.log("autoGroup: test saved",{testId:n.id,name:n.name,scenarioId:r.id,pendingSaveTests:[...m]});return e}catch(e){f.error("failed to autoGroup",{err:e,testId:n.id,name:n.name,scenarioId:r.id,pendingSaveTests:[...m]});throw e}finally{m.delete(n.id)}}};t.SaveUtils=y;t.SaveUtils=y=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof l.TestimServicesApi!=="undefined"&&l.TestimServicesApi)==="function"?n:Object])],y);t.saveUtilsPrivateFunctions={prepareSharedStepInfoForSave:E,prepareTestDataForSave:I,markScenarioAsDirtyIfNeeded:T,commitSaveInfo:C,resetAfterSave:D,deleteCodelessProps:A};function b(e){const t=Object.keys(e);const s=t.filter((e=>(e===null||e===void 0?void 0:e.trim)&&!p.utils.isValidJavaScriptIdentifier(e.trim())));if(s.length){throw new Error(`Invalid parameter ${p.utils.pluralize(s.length,"name")} detected:\n        "${s.join(", ")}". Parameter names must be valid JavaScript identifiers.`)}}function _(e,t){try{const t=new Function(e).apply();if(!t){return}if(Array.isArray(t)){for(const e of t){b(e)}return}b(t)}catch(e){f.error("Failed to validate Test data before saving test",{error:e,testId:t});throw new h.SaveTestError(`Invalid Test data detected: ${e.message}`)}}function T(e,t=e){const s=e.getStepContent();if(s.steps){s.steps.forEach((e=>T(e,t)))}if(s.isDirty){t.setDirty()}}function E(e,t,s){const i=e=>{const t={addDirtyFlag:true,addIsNewFlag:true};const s=e.isGroupStep?e.getStepContent().getSerializableSaveSteps(t):[e.getSerializableSaveObject(t)];return s.filter((e=>e.isDirty))};let o=[];const n={};const r=[...new Set([...e].map((({sharedStep:e,step:t})=>(e===null||e===void 0?void 0:e.sharedStepInfoId)||(t===null||t===void 0?void 0:t.sharedStepInfoId))).filter(Boolean))];const c=d.sharedStepSingleton.sharedStepInfos.filter((e=>r.includes(e.id))).filter((e=>{var t;return((t=e.sharedStepClass)===null||t===void 0?void 0:t.isDirty)||e.dirty})).filter((e=>!e.marketplace)).map((e=>{var t,s;if((t=e.sharedStepClass)===null||t===void 0?void 0:t.isDirty){o=o.concat(i(e.sharedStepClass));const t=e.sharedStepClass.isNew?null:((s=e.revisions)===null||s===void 0?void 0:s.latest)||null;if(!t&&!e.sharedStepClass.isNew){f.error("shared step info dose not have latest revision id",{sharedStepInfoId:e.id,name:e.name})}n[e.sharedStepClass.id]={name:e.name,infoId:e.id,current:t,childSharedStepInfoIds:(e.sharedStepClass.steps||[]).map((e=>e.sharedStepInfoId)).filter(Boolean)}}return{name:e.name,sharedStepClassId:e.sharedStepClassId,id:e.id,type:e.type,hidden:e.hidden}}));for(const e of o){if(e.type!=="email-validation-step"){continue}let i;if(e.validationType===a.commonConstants.EMAIL_VALIDATION_TYPE.CODELESS){i=a.commonConstants.EMAIL_VALIDATION_TYPE.CODELESS;delete e.postCode;O(e)}else{i=a.commonConstants.EMAIL_VALIDATION_TYPE.CODED;A(e)}t===null||t===void 0?void 0:t.track("email-validation-mode-save",{validationType:i,testId:s,stepId:e.originalStepId})}return{dirtySharedClasses:o,dirtySharedStepInfos:c,currentRevisions:n,sharedStepIds:r}}function I(e,t,s,i,o){var n,r;t.name=e.name||t.name||"Untitled";t.description=e.description||t.description||"";t.updateLastModified(i);T(s);const a=s.getSerializableSaveSteps({addDirtyFlag:true,addIsNewFlag:true}).filter((e=>e.isDirty));const c=(s.steps||[]).map((e=>e.sharedStepInfoId)).filter(Boolean);const l=E(s,o,t.id);const u=t.getSerializableSaveObject();u.createdBy=((n=u.createdBy)===null||n===void 0?void 0:n.uid)||u.createdBy;const d=t._isNew?null:((r=t.revisions)===null||r===void 0?void 0:r.latest)||null;if(!d&&!t._isNew){f.error("test dose not have latest revision id",{sharedStepInfoId:t.id,name:t.name})}l.currentRevisions[s.id]={name:t.name,current:d,infoId:t.id};return{serializedStepToSave:a,serializedTest:u,sharedStepsData:l,childSharedStepInfoIds:c}}function C(e,t,s,i){[...t].forEach((({sharedStep:t,step:s})=>{Object.assign(s,r.omit(e.steps[s.id],"steps"));if(t){Object.assign(t,r.omit(e.steps[t.id],"steps"))}}));d.sharedStepSingleton.sharedStepInfos.filter((t=>Boolean(e.revisions[t.id]&&t.revisions))).forEach((t=>{var s,o;t.revisions.setLastRevision({...e.revisions[t.id],authorName:i});const n=(s=t.sharedStepClass)===null||s===void 0?void 0:s.id;if(n&&e.steps[n]){Object.assign(t.sharedStepClass,e.steps[n]);t.sharedStepClassId=(o=e.steps[n])===null||o===void 0?void 0:o.id}}));if(e.revisions[s.id]){s.revisions.setLastRevision({...e.revisions[s.id],authorName:i})}if(e.testDataId){t.testDataId=e.testDataId}}function D(e,t,s,i){t.resetNew();t.customTestData.resetDirty();e.resetDirty(i);e.resetNew(i);d.sharedStepSingleton.resetDirty(s,i)}function O(e){const t=e===null||e===void 0?void 0:e.textExtraction;if(!t){return}const{type:s}=t;if(s===a.commonConstants.TEXT_EXTRACTION_TYPE.REGEX&&t.regex){delete t.start;delete t.end;return}if(s===a.commonConstants.TEXT_EXTRACTION_TYPE.BETWEEN&&t.start&&t.end){delete t.regex;return}if(s===a.commonConstants.TEXT_EXTRACTION_TYPE.FROM&&t.start){delete t.regex;delete t.end;return}if(s===a.commonConstants.TEXT_EXTRACTION_TYPE.TO&&t.end){delete t.regex;delete t.start;return}delete e.textExtraction}function A(e){delete e.timeRangeInMinutes;delete e.expectedSubject;delete e.expectedBody;delete e.textExtraction}t.deleteCodelessProps=A},function(e,t,s){"use strict";s.r(t);t["default"]={createGroupModal:"createGroup_createGroupModal_3nK6O_RlR3JvdXAt",back:"createGroup_back_1iBtR_RlR3JvdXAt",allowOverflow:"createGroup_allowOverflow_G1rjv_RlR3JvdXAt",groupLoaderWrapper:"createGroup_groupLoaderWrapper_1qUhX_RlR3JvdXAt",label:"createGroup_label_nfmtn_RlR3JvdXAt",icon:"createGroup_icon_2u-o8_RlR3JvdXAt",firstLabel:"createGroup_firstLabel_1p_CX_RlR3JvdXAt",replacer:"createGroup_replacer_2CUTs_RlR3JvdXAt",sameRowLabel:"createGroup_sameRowLabel_1Z6vC_RlR3JvdXAt",shouldFork:"createGroup_shouldFork_1jVb8_RlR3JvdXAt",pagination:"createGroup_pagination_1kM86_RlR3JvdXAt",newGroupTextBox:"createGroup_newGroupTextBox_X20ko_RlR3JvdXAt",buttonError:"createGroup_buttonError_3jWVh_RlR3JvdXAt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseImageManipulator=void 0;const i="https://res.cloudinary.com/testim/image/upload/remote_media/";class o{static isMigratedCloudinaryUrl(e){return Boolean(e.match(/(cloudinary\.com).*test-projects-assets|test-result-assets/))}static isTestimImage(e){return/image\.testim\.io/.test(e)}static getImageName(e){var t,s,i,o;const n=(t=e.match("remote_media/.*"))===null||t===void 0?void 0:t.at(-1);const r=(s=e.match("test-result-artifacts/.*"))===null||s===void 0?void 0:s.at(-1);const a=(i=e.match("test-projects-artifacts/.*"))===null||i===void 0?void 0:i.at(-1);const c=(o=e.match("media_by_project/.*"))===null||o===void 0?void 0:o.at(-1);return n||c||r||a||e.split("/").at(-1)}_getBaseUrl(e){return e.replace(new RegExp(`${o.getImageName(e)}$`),"")}static convertStorageToCloudinaryUrl(e){return o.isTestimImage(e)?i+o.getImageName(e):e}_cloudinaryRectangle(e){return`x_${e.left},y_${e.top},w_${e.width},h_${e.height}`}_cloudinarySize(e){return`w_${e.width},h_${e.height}`}_roundRectangleSize(e){if(!e){return null}return{top:Math.round(e.top),left:Math.round(e.left),width:Math.round(e.width),height:Math.round(e.height),pixelRatio:e.pixelRatio}}_createRectangleFromCenterAndSize(e,t,s){return{left:Math.round(e.x-s*t.width/2),top:Math.round(e.y-s*t.height/2),width:Math.round(t.width*s),height:Math.round(t.height*s)}}_createCenteredRectangle(e,t,s){return{left:Math.round(Math.max(e.left+.5*(e.width-t),0)),top:Math.round(Math.max(e.top+.5*(e.height-s),0)),width:Math.round(t),height:Math.round(s)}}_scaleRectangle(e,t){return this._createCenteredRectangle(e,e.width*t,e.height*t)}isCloudinaryImage(e){return/res\.cloudinary\.com/.test(e)}replaceWithJpeg(e){if(o.isMigratedCloudinaryUrl(e)){return e}e=o.convertStorageToCloudinaryUrl(e);return`${e.match(/^(.*)(\..*)$/)[1]}.jpg`}}t.BaseImageManipulator=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initialRules=t.rulesDropdownOptions=t.stringOperators=t.stringOperatorsWithRegex=t.numberOperatorsWithRegex=t.numberOperators=t.equals=void 0;const i=s(8);t.equals=[{name:"equals",value:"="}];t.numberOperators=[{name:"greater than",value:">"},{name:"less than",value:"<"},...t.equals,{name:"equals or greater than",value:">="},{name:"equals or less than",value:"<="}];t.numberOperatorsWithRegex=[...t.equals,{name:"not equals",value:"!"},{name:"regex",value:"regex"}];t.stringOperatorsWithRegex=[{name:"contains",value:"="},{name:"not contains",value:"!"},{name:"regex",value:"regex"}];t.stringOperators=[...t.equals,{name:"not equals",value:"!"}];t.rulesDropdownOptions=[{name:"OS version",value:"os_version"},{name:"Manufacturer",value:"manufacturer"}];t.initialRules=[{id:i.utils.guid(),field:{name:"OS Version",value:"os_version"},operator:{name:"equals",value:"="},operatorsType:"number",operand:""},{id:i.utils.guid(),field:{name:"Manufacturer",value:"manufacturer"},operator:{name:"equals",value:"="},operatorsType:"string",operand:""}]},,,,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.BugimAnalytics=void 0;const r=s(9);const a=s(190);let c=class e{constructor(e){this.bugimOutput=e}_track(e,t){t=t||{};t.timestamp=new Date;this.bugimOutput.analyticsTrack(e,t)}showSettings(){this._track("show-settings")}openSettings(){this._track("open-settings")}publish(){this._track("publish")}errorOnPublish(){this._track("publish-error")}playVideo(){this._track("open-video")}openMagicLink(){this._track("open-magic-link")}discardTest(){this._track("discard-test")}endAnnotation(){this._track("end-annotation")}stopRecord(e){this._track("stop-record",{numberOfSteps:e})}selectedBugtracker(e){this._track("select-bug-tracker",{name:e})}bugTrackerLinkOpened(e){this._track("bug-tracker-link-opened",{name:e})}chooseGeneralProblem(){this._track("choose-general-problem")}chooseTextValidation(){this._track("choose-text-validation")}enterExpectedText(e){this._track("enter-expected-text",{value:e})}highlightElement(){this._track("highlight-element")}};t.BugimAnalytics=c;t.BugimAnalytics=c=i([(0,r.injectable)(),o("design:paramtypes",[typeof(n=typeof a.BugimOutput!=="undefined"&&a.BugimOutput)==="function"?n:Object])],c)},function(e,t,s){"use strict";s.r(t);t["default"]={jiraField:"index_jiraField_3VDR-_VyLUppcmEt",jiraSelectChoice:"index_jiraSelectChoice_1fEw4_VyLUppcmEt",jiraNone:"index_jiraNone_1Au1__VyLUppcmEt",dynamicFields:"index_dynamicFields_2bsBR_VyLUppcmEt",isLoading:"index_isLoading_1Ez23_VyLUppcmEt"}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getYPoint=t.getXPoint=t.calculateElementMiddlePoint=t.calculateClickPoint=t.isWithinBounds=t.isWithinTargetRect=void 0;function i(e,t,s){return o(e.left,e.right,t)&&o(e.top,e.bottom,s)}t.isWithinTargetRect=i;function o(e,t,s){return s>e&&s<t}t.isWithinBounds=o;function n(e,t){if(!e){return null}const s=o(0,t.width,e.x);const i=o(0,t.height,e.y);if(s&&i){return{x:t.left+e.x,y:t.top+e.y}}return null}t.calculateClickPoint=n;function r(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}t.calculateElementMiddlePoint=r;const a=(e,t)=>e.width*t+e.left;t.getXPoint=a;const c=(e,t)=>e.height*t+e.top;t.getYPoint=c},,,,,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.MobileLocatorFactory=t.MobileLocator=t.LocatorConfiguration=t.ExtractionType=t.LocateMode=void 0;const r=s(6);const a=s(14);const c=s(2);const l=s(296);const u=s(300);var d;(function(e){e[e["Shallow"]=0]="Shallow";e[e["DeepThenShallow"]=1]="DeepThenShallow"})(d||(t.LocateMode=d={}));var p;(function(e){e[e["Shallow"]=0]="Shallow";e[e["Deep"]=1]="Deep"})(p||(t.ExtractionType=p={}));const h=1;var f;(function(e){e[e["TreeElementMembersLimitPerLevel"]=5]="TreeElementMembersLimitPerLevel";e[e["ParentsTreeLevelsUp"]=10]="ParentsTreeLevelsUp";e[e["ChildrenThreeLevelsDown"]=1]="ChildrenThreeLevelsDown"})(f||(t.LocatorConfiguration=f={}));class m{constructor(e){this.locatorStrategy=undefined;this.threshold=undefined;this.extractionType=p.Shallow;this.xpath=new u.ManualSelector("");this.parents=[];this.children=[];this.siblings=[];this.attributes={};this.closestText=new u.ManualSelector("");if(e){this.xpath=new u.ManualSelector(e)}this.version=h;this._indexOnlyXpath=new u.AutoGeneratedSelector("indexOnlyXpath",this);this._closestParentIndexOnlyXpath=new u.AutoGeneratedSelector("closestParentIndexOnlyXpath",this);this._xpathWithoutIndices=new u.AutoGeneratedSelector("xpathWithoutIndices",this)}get computedLocatorStrategy(){if(this.locatorStrategy){return this.locatorStrategy}if(!a.default.flags.locateMobileElementsUsingML.isEnabled()){return"fallback"}if(Object.values(this.attributes).some((e=>e.isExpression))){return"fallback"}return"ML"}static getMobileLocator(e,t){if(!e)return undefined;return new this(t)}static isOldVersionLocator(e){return typeof e.xpath==="string"}static isValidSelector(e){return e&&e.currentValue!==""}static getFirstValidSelector(e){return e.find((e=>this.isValidSelector(e)))}get text(){return m.getFirstValidSelector([this.attributes.text,this.attributes.label,this.attributes.value])}get label(){return this.text}get value(){return this.text}get class(){return this.attributes.class||this.attributes.type}get type(){return this.class}get id(){const e=this.resourceId;const t=this.name;return e||t}get resourceId(){return this.attributes["resource-id"]}get name(){return this.attributes.name}get index(){return this.attributes.index}get accessabilityId(){return this.attributes.accessabilityId}_updateAndGetAutoGeneratedSelector(e){e.updateValues(this);return e}get xpathWithoutIndices(){return this._updateAndGetAutoGeneratedSelector(this._xpathWithoutIndices)}get indexOnlyXpath(){return this._updateAndGetAutoGeneratedSelector(this._indexOnlyXpath)}get closestParentIndexOnlyXpath(){return this._updateAndGetAutoGeneratedSelector(this._closestParentIndexOnlyXpath)}get position(){var e;if(this.attributes.bounds){const t=this.attributes.bounds.currentValue;const s=(e=t.match(/\d+/g))===null||e===void 0?void 0:e.map(Number);if(s){return{x:s[0],y:s[1]}}return undefined}return{x:parseInt(this.attributes.x.currentValue,10),y:parseInt(this.attributes.y.currentValue,10)}}get contentDesc(){return this.attributes["content-desc"]}get osType(){var e;if((e=this.device)===null||e===void 0?void 0:e.osType){return this.device.osType.toLowerCase()}const t=this.attributes.bounds;if(t){return"android"}return"ios"}}t.MobileLocator=m;i([c.observable.ref,o("design:type",Object)],m.prototype,"locatorStrategy",void 0);i([c.observable.ref,o("design:type",String)],m.prototype,"threshold",void 0);i([c.computed,o("design:type",Object),o("design:paramtypes",[])],m.prototype,"computedLocatorStrategy",null);class g{static getClosestText(e,t=this.selectorDistanceType){if(!e||e.length===0)return"";let s="";let i=Number.MAX_SAFE_INTEGER;let o=Number.MAX_SAFE_INTEGER;for(let n=0;n<e.length;n++){const[r,a,c]=e[n];if(!r)continue;let l;let d;if(t===u.SelectorDistanceType.Euclidean){l=a;d=c}else{l=c;d=a}if(!l||!d)continue;if(l<i){s=r;i=l;o=d}if(l===i&&d<o){s=r;i=l;o=d}}return s}static getElementClosestTextCandidatesInBfsBounds(e,t,s=3,i=20){const o=[];const n=new Set;let r=false;const a=[[e,0]];while(a.length>0){const[c,l]=a.shift();if(l>s&&n.size>i){break}if(n.has(c))continue;n.add(c);for(const e of Array.from(c.children)){a.push([e,l+1])}const u=c.parentElement;if(u!==null){a.push([u,l+1])}if(!r){r=true;continue}const d=this._getDomElementText(c,t.toLowerCase());if(!d)continue;const p=this._getElementsEuclideanDistance(e,c);o.push([d,p,l])}return o}static _getMobileLocatorClosestTextCandidatesInBfsBounds(e){var t;const s=[];const i=2;const o=e.parents.slice(0,i);const n=[...e.children,...o,...e.siblings];for(let o=0;o<n.length;o++){const r=n[o];if(r===e)continue;const a=(t=r.text)===null||t===void 0?void 0:t.currentValue;if(!a)continue;const c=this._getEuclideanDistance(e.position,r.position);let l=1;if(o>=e.children.length+i){l=2}s.push([a,c,l])}return s}static _getDomElementText(e,t){if(t==="android"){return e.getAttribute("text")||""}if(t==="ios"){const t=e.getAttribute("label");if(t&&t!=="")return t;const s=e.getAttribute("value");if(s&&s!=="")return s;const i=e.getAttribute("text");if(i&&i!=="")return i}return""}static _getElementsEuclideanDistance(e,t){const s=this._getElementPosition2D(e);const i=this._getElementPosition2D(t);if(!s||!i)return undefined;const o=i.x-s.x;const n=i.y-s.y;return Math.hypot(o,n)}static _getElementPosition2D(e){const t=(0,l.parseBoundsFromElement)(e);return{x:t.left,y:t.top}}static createAndFillMobileLocatorDataRecursive(e){var t;e=this.getUpdatedLocatorDataForBackwardCompatibility(e);const s=m.getMobileLocator(true);const{children:i,parents:o,siblings:c}=e;Object.assign(s,e);this._fillPropertiesWithTypes(s,e);s.children=n._fillMobileLocatorsListRecursively(r.cloneDeep(i));s.parents=n._fillMobileLocatorsListRecursively(r.cloneDeep(o));s.siblings=n._fillMobileLocatorsListRecursively(r.cloneDeep(c));if(a.default.flags.locateMobileElementsUsingClosestText.isEnabled()&&((t=e.closestText)===null||t===void 0?void 0:t.originalValue)===undefined){const e=this._getMobileLocatorClosestTextCandidatesInBfsBounds(s);const t=this.getClosestText(e);s.closestText=new u.ManualSelector(t)}return s}static _getEuclideanDistance(e,t){if(!e||!t)return undefined;const s=t.x-e.x;const i=t.y-e.y;return Math.hypot(s,i)}static _attributesMapStringToStringDictionary(e){const t=JSON.parse(e);return Object.assign({},...t.map((e=>({[e[0]]:e[1]}))))}static getUpdatedLocatorDataForBackwardCompatibility(e){if(m.isOldVersionLocator(e))e=this._updateMobileLocatorData(e);return e}static _updateMobileLocatorData(e){const t={xpath:new u.ManualSelector(e.xpath)};t.domLocation=e.domLocation;t.extractionType=e.extractionType;t.children=e.children&&typeof e.children[0]!=="string"?e.children:undefined;t.parents=e.parents&&typeof e.parents[0]!=="string"?e.parents:undefined;t.siblings=e.siblings&&typeof e.siblings[0]!=="string"?e.siblings:undefined;t.attributes={};const s=e.attributesMapString?this._attributesMapStringToStringDictionary(e.attributesMapString):e.attributes;if(s){Object.keys(s).forEach((e=>{t.attributes[e]=new u.ManualSelector(s[e])}))}return t}static _fillPropertiesWithTypes(e,t){Object.keys(t).forEach((s=>{const i=s;if(u.AbstractSelector.isAttributeNameOfSelector(i,t)){let s=t[i];if(s.selectorKind==="Manual")s=new u.ManualSelector;else{const e=t[i];s=new u.AutoGeneratedSelector(e.name,m.getMobileLocator(true));delete s["currentValue"];const o=e.name;t[i].name=v(o)}Object.assign(s,t[i]);Reflect.set(e,i,s)}}));Object.keys(e.attributes).forEach((s=>{const i=new u.ManualSelector;e.attributes[s]=Object.assign(i,t.attributes[s])}))}}t.MobileLocatorFactory=g;n=g;g.selectorDistanceType=u.SelectorDistanceType.DomBfs;g.createMobileLocatorFromElement=(e,t,s=d.DeepThenShallow,i=f.ChildrenThreeLevelsDown)=>{const o=(0,l.getElementXpath)(e).replace("hierarchy","").replace("AppiumAUT","");const r=m.getMobileLocator(true,o);if(!r){throw new Error("Sanity check failed in MobileLocatorFactory.createMobileLocatorFromElement")}r.extractionType=s===d.Shallow?p.Shallow:p.Deep;const c=e.getAttributeNames();c.forEach((t=>{const s=e.getAttribute(t);r.attributes[t]=new u.ManualSelector(s)}));if(s!==d.Shallow){const t=s===d.DeepThenShallow?d.Shallow:s;n._fillDeepMobileLocatorAttributes(r,o,e,t,i)}if(t&&a.default.flags.locateMobileElementsUsingClosestText.isEnabled()){const s=n.getElementClosestTextCandidatesInBfsBounds(e,t.deviceType);const i=n.getClosestText(s);r.closestText=new u.ManualSelector(i)}if(t){r.device={width:t.width,height:t.height,name:t.name,osType:t.deviceType,osVersion:t.osVersion,virtual:t.virtual}}return r};g._fillDeepMobileLocatorAttributes=(e,t,s,i,o)=>{e.xpath=new u.ManualSelector(t);if(s.parentElement){let t=s.parentElement;while(t&&e.parents.length<f.ParentsTreeLevelsUp){const s=n.createMobileLocatorFromElement(t,undefined,d.Shallow);e.parents.push(s);t=t.parentElement}}if(o>0){const t=Array.from(s.children||[]);t.slice(0,f.TreeElementMembersLimitPerLevel).forEach((t=>{const s=n.createMobileLocatorFromElement(t,undefined,i,o-1);e.children.push(s)}));if(s.parentNode){const t=Array.from(s.parentNode.children||[]);t.slice(0,f.TreeElementMembersLimitPerLevel).forEach((t=>{if(t!==s){const s=n.createMobileLocatorFromElement(t,undefined,i,o-1);e.siblings.push(s)}}))}}};g._fillMobileLocatorsListRecursively=e=>{if(!e)return[];return e.map((e=>n.createAndFillMobileLocatorDataRecursive(e)))};function v(e){return e[0].toLowerCase()+e.substring(1)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.conditionSubType=t.expressionSubType=void 0;t.expressionSubType={EXPRESSION:"expression",TEXT:"text"};t.conditionSubType={MUST_BE_HIDDEN:"mustBeHidden",MUST_BE_VISIBLE:"mustBeVisible",ELEMENT_TEXT:"elementText",CUSTOM_CODE:"custom-code",IS_VISIBLE:"IS_VISIBLE",IS_NOT_VISIBLE:"IS_NOT_VISIBLE",DYNAMIC_PARENT_LOOP_CONDITION:"DYNAMIC_PARENT_LOOP_CONDITION",LOOP_FOR:"loopFor"}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NoEnvironmentParamEvaluator=void 0;class i{executeOrDefault(e,t){if(typeof t!=="string"){return e}try{return this.execute(t)}catch(t){return e}}execute(e){const t=e;const s=`return ${t}`.replace(/\n/g,"\\n");const i=Function.apply(Function,[s]);const o=i.apply(null,[]);return o}}t.NoEnvironmentParamEvaluator=i},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.switchboard=void 0;const i=s(610);const o=s(612);const n={EDITOR:"editor",MOBILE_MIRROR:"mobileMirror",AUT:"aut",BACKGROUND:"background"};const r={[n.EDITOR]:()=>{if(window.chrome){return[new i.ConnectionToBackground(n.EDITOR,{external:true})]}return[]},[n.MOBILE_MIRROR]:()=>[new i.ConnectionToBackground(n.MOBILE_MIRROR)],[n.AUT]:()=>[new i.ConnectionToBackground(n.AUT)],[n.BACKGROUND]:()=>[new i.RuntimeConnectionListener(n.BACKGROUND),new i.RuntimeConnectionListener(n.BACKGROUND,{external:true})]};t.switchboard=new o.Switchboard(r);if(false){}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SelectorMatcher=t.matchers=void 0;const i=s(185);const o=s(241);t.matchers={STARTS_WITH:{friendlyName:"Starts with",comparator:(e,t)=>e.startsWith(t)},ENDS_WITH:{friendlyName:"Ends with",comparator:(e,t)=>e.endsWith(t)},CONTAINS:{friendlyName:"Contains",comparator:(e,t)=>e.includes(t)},EQUALS_TO:{friendlyName:"Equals to",comparator:(e,t)=>e===t},REGEX:{friendlyName:"Regex",comparator:(e,t)=>new RegExp(t).test(e)}};const n={comparator:()=>true};const r=e=>"isMappingSpec"in e;const a=e=>"isReplaceSpec"in e;const c=e=>!r(e)&&!a(e);function l(e,s,i){if(e===null||e===undefined){return false}if(s){s=s.toLowerCase()}return(t.matchers[i]||n).comparator(e.toLowerCase(),s)}class u{constructor(e=[]){const t=u.findSpecProblems(e);if(t.length){throw new Error(`Invalid spec. ${t.join("; ")}`)}this.spec=e}get mappingSpec(){return this.spec.filter(r)}get replaceSpec(){return this.spec.filter(a)}get filterSpec(){return this.spec.filter(c)}static findSpecProblems(e){return e.map((e=>{if(!e){return"null element"}if(!e.key){return"missing key"}if(!e.value){return"missing value"}if(e.key.matcher&&!t.matchers[e.key.matcher]){return`unrecognized matcher: "${e.key.matcher}"`}if(e.value.matcher&&!t.matchers[e.value.matcher]){return`unrecognized matcher: "${e.value.matcher}"`}if((r(e)||a(e))&&!(e.value.token.includes("(")&&e.value.token.includes(")"))){return`Missing parenthesis in mapping value ${e.value.token}`}return null})).map(((e,t)=>e?`at index ${t}: ${e}`:null)).filter((e=>!!e))}compareSelectorToSpec(e,t){return l(e.key,t.key.token,t.key.matcher)&&l(e.value,t.value.token,t.value.matcher)}matches(e,t=this.spec){const s=e.getMatcherDescriptor();const i=t.filter(c);return i.some((e=>this.compareSelectorToSpec(s,e)))}matchesData(e,t=this.spec){return this.matches(o.selectorClasses.create(e),t)}matchesExisting(e){return this.matches(e,this.spec.filter((e=>e.applyForExisting)))}map(e,t=this.spec,s=new i.NoEnvironmentParamEvaluator){let o=false;if(!e.isEditable()){return o}const n=e.getMatcherDescriptor();const c=t.filter(a);const l=c.find((e=>this.compareSelectorToSpec(n,e)));if(l){const t=n.value.replace(new RegExp(l.value.token),l.replacement);e.updateMappedProperty(`'${t}'`,{name:l.mappingTo});e.evaluateComputedProperties(s);return true}const u=t.filter(r);const d=u.find((e=>this.compareSelectorToSpec(n,e)));if(d){const t=n.value.match(d.value.token);if((t===null||t===void 0?void 0:t.length)===2){o=true;e.updateMappedProperty(`'${t[1]}'`,{name:d.mappingTo});e.evaluateComputedProperties(s)}}return o}mapData(e,t){const s=o.selectorClasses.create(e);this.map(s,this.spec,t);return s.serialize()}mapExisting(e,t){return this.map(e,this.spec.filter((e=>e.applyForExisting)),t)}}t.SelectorMatcher=u},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.BugimOutput=void 0;const o=s(9);const n=s(327).segmentAnalytics;let r=class e{analyticsTrack(...e){n.track(...e)}};t.BugimOutput=r;t.BugimOutput=r=i([(0,o.injectable)()],r)},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.cloneExistingTest=t.buildFromTestBundle=t.build=void 0;const i=s(7);const o=s(8);const n=s(116);const r=s(78);const a=s(60);const c=s(201);const l=s(51);const u=s(5);const d=s(202);const p=u.commonConstants.test;const h=i.Logger.getLogger("testBuilder");const f=c.Test.UNKNOWN_CREATOR;function m(e,t,s,i){const o=new n.RevisionList;o.createNewRevision(i,s,t,e,"created");return o.getSerializedObject()}function g(e,t={}){const s=t.type||e;switch(s){case p.DESKTOP_WEB:case p.MOBILE_WEB:return{type:s,startingPoint:t.baseUrl};case p.ANDROID:case p.IOS:return{type:s,startingPoint:t.nativeApp};default:{h.error("Unsupported Test type value",{type:s,testTypeHint:e});throw new Error(`Unsupported Test type value: ${s}.`)}}}function v(e,t,s,i,o,n,a=p.DESKTOP_WEB){const l=new Date(2014,9,1).valueOf();const u=e.createdBy||f;const h=e.createAt||l;i||(i=m(e.name,s.id,u,n));const v=r.TestConfig.createFromData({...t,nativeApp:s.nativeApp||undefined});const S=d.CustomTestData.createFromData(o);const y=e.name;const{type:b,startingPoint:_}=g(a,e);const{sessionType:T,version:E,description:I,labels:C,latestTestResult:D,lastModifiedBy:O,lastModifiedAt:A,captureVideoUrl:j}=e;const w=new c.Test(e.id,y,I,i,C,v,D,false,u,h,O,A,j,S,E,_,b);if(s){w.scenario=s}return w}t.build=v;function S(e){const t=a.stepBuilder.buildStepFromData({...e.scenarioData,type:"scenario"});t.resetDirty();t.resetNew();const s=v(e.testData,e.testConfigData,t,e.revisionData,e.customTestData,null,e.type);return s}t.buildFromTestBundle=S;async function y(e,t,s,i){const n=a.stepBuilder.buildStepFromData({...e.scenarioData,type:"scenario"});n.id=o.utils.guid();n.setNew();for(let e=0;e<n.steps.length;e++){const t=n.steps[e];t.id=o.utils.guid();t.setNew();if(l.sharedStepSingleton.isStepDeepClonable(t)){await l.sharedStepSingleton.cloneSharedStep(t,t.getDisplayName(),n,e);n.removeStep(t.id,false)}if(t.applitoolsTestId){t.applitoolsTestId={id:o.utils.guid(),count:0};t.applitoolsData||(t.applitoolsData={});t.applitoolsData.testId=t.applitoolsTestId}}e.testConfigData.id=e.testConfigData.name===r.DEFAULT_CONFIG_NAME?o.utils.guid():e.testConfigData.id;e.customTestData.id=o.utils.guid();e.testData.id=o.utils.guid();e.testData.name=t;e.testData.description=i;e.testData.createAt=Date.now();e.testData.createdBy=s.uid;e.testData.lastModifiedAt=Date.now();e.testData.lastModifiedBy=s.uid;e.testData.latestTestResult=null;const c=v(e.testData,e.testConfigData,n,null,e.customTestData,s.name,e.type);return c}t.cloneExistingTest=y},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=s(38);const o=s(61);const n=o.container.get(i.AuthenticationService);t.default=n},,,,,,,function(e,t,s){"use strict";(function(e){var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.Test=void 0;const n=s(8);const r=s(116);const a=s(5);const c=s(2);const l=a.commonConstants.test;const u=n.utils.guid;const d=null;class p{constructor(e,t,s,i,o,n,a,p,h,f,m,g,v,S,y,b,_=l.DESKTOP_WEB){this._scenario=null;this._isNew=p;this.captureVideoUrl=v||null;this.type=_;this._baseUrl=null;this.testConfig=n;this.revisions=new r.RevisionList(i);(0,c.extendObservable)(this,{name:t||"",description:s||""});Object.defineProperties(this,{id:{value:e||u(),enumerable:true,writable:false},labels:{value:o||[],enumerable:true,writable:true},latestTestResult:{value:a||null,enumerable:true,writable:true},createdBy:{value:h||d,enumerable:true,writable:true},createAt:{value:f||Date.now(),enumerable:true,writable:true},lastModifiedBy:{value:m||null,enumerable:true,writable:true},lastModifiedAt:{value:g||null,enumerable:true,writable:true},scenario:{get(){return this._scenario},set(e){this._scenario=e},enumerable:false},baseUrl:{get:()=>this._baseUrl,set:e=>{this._baseUrl=e}},scenarioId:{get(){return this._scenario?this._scenario.id:null}},testConfigId:{get(){return this.testConfig.id},enumerable:true},customTestData:{value:S,enumerable:false,writable:true},customTestDataId:{get(){return this.customTestData.id},enumerable:true},version:{value:y||this.getVersion(),enumerable:true}});this._baseUrl=b}update(e){if(!e){return this}if(e.labels){this.labels=e.labels}if(e.captureVideoUrl){this.captureVideoUrl=e.captureVideoUrl}if(typeof e.baseUrl==="string"){this.baseUrl=e.baseUrl}return this}isNewTest(){return this._isNew}resetNew(){this._isNew=false}updateLastModified(e){this.lastModifiedAt=Date.now();this.lastModifiedBy=e}getRevisionData(){return this.revisions.getSerializedObject()}areAllStepsNew(){try{return![...this.scenario].some((({step:e})=>!e.isNew&&!e.isGroupStep))}catch(e){return false}}getSerializableObject(){return{id:this.id,type:this.type,isEmptyTest:this.isEmptyTest,name:this.name,description:this.description,labels:this.labels,latestTestResult:this.latestTestResult,createdBy:this.createdBy,createAt:this.createAt,lastModifiedBy:this.lastModifiedBy,lastModifiedAt:this.lastModifiedAt,testConfigId:this.testConfigId,version:this.version,resultId:this.resultId,captureVideoUrl:this.captureVideoUrl,customTestDataId:this.customTestDataId,baseUrl:this._baseUrl}}getSerializableSaveObject(){return this.getSerializableObject()}getVersion(){return"2.0.0"}}t.Test=p;p.UNKNOWN_CREATOR=d;i([c.observable.ref,o("design:type",Object)],p.prototype,"testConfig",void 0);if(e.env.isClickimEditor){(0,c.decorate)(p,{baseUrl:c.observable,_baseUrl:c.observable})}}).call(this,s(35))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CustomTestData=void 0;const i=s(8);class o{constructor(e){e=e||{};this.name="untitled test data";this.type="customTestData";this.isDirty=false;this.code=e.code||"";this.enable=e.enable||false;this.id=e.id||i.utils.guid();this.version=this.getVersion()}static createFromData(e){return new o(e)}getType(){return this.type}getVersion(){return"1.0.0"}update(e){if(e||e===""){this.isDirty=true;this.code=e;this.enable=true}}delete(){this.isDirty=true;this.enable=false}getSerializableObject(){return{id:this.id,version:this.getVersion(),code:this.code,name:this.name,enable:this.enable}}getSerializableSaveObject(){return{...this.getSerializableObject(),isDirty:this.isDirty}}resetDirty(){this.isDirty=false}}t.CustomTestData=o},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.Scenario=void 0;const r=s(5);const a=s(87);const c=s(2);const l=s(204);const u=s(8);const d=["cli-validation-download-file","cli-wait-for-download-file","cli-download-code-step"];class p extends a.GroupStep{constructor(e,t){super(e,"scenario");this.baseUrl="";this.mockNetworkOptions={};this.networkCaptureOptions={captureRequestBody:false,captureResponseBody:false};this.nativeApp=null;this.isArchived=false;this.testDataId="";this.tms={};this.name=t||`scenario ${u.utils.nextId()}`}get appName(){if(!this.nativeApp){return""}const e=r.commonConstants.mobile.MISSING_NAME;const{name:t,appMetadata:{name:s}={},fileName:i}=this.nativeApp;return t||s||i||e}_update(e){if(e.isArchived!==undefined){this.isArchived=e.isArchived}if(e.baseUrl!==undefined){this.baseUrl=e.baseUrl}if(e.testDataId!==undefined){this.testDataId=e.testDataId}if(e.testStatus!==undefined){this.testStatus=e.testStatus}if(e.testOwnerUserId!==undefined){this.testOwnerUserId=e.testOwnerUserId}if(e.tms!==undefined){this.tms=e.tms}if(e.mockNetworkOptions!==undefined){this.mockNetworkOptions=e.mockNetworkOptions}if(e.networkCaptureOptions!==undefined){this.networkCaptureOptions=e.networkCaptureOptions}if(e.sfdcOptions!==undefined){this.sfdcOptions=e.sfdcOptions}if(e.nativeApp!==undefined){this.nativeApp=e.nativeApp}if(e.nativeEvents!==undefined){this.nativeEvents=e.nativeEvents}return super._update(e)}getSerializableObject(e){e=u.utils.extend({deep:true,full:false},e);return{...super.getSerializableObject(e),isArchived:this.isArchived,baseUrl:this.baseUrl,testDataId:this.testDataId,tms:this.tms,mockNetworkOptions:this.mockNetworkOptions,testStatus:this.testStatus,testOwnerUserId:this.testOwnerUserId,networkCaptureOptions:this.networkCaptureOptions,sfdcOptions:this.sfdcOptions,nativeApp:this.nativeApp}}findStepIndex(e){var t;if(e.parentId&&e.parentId!==this.id){const t=this.findStepById(e.parentId,true);if(t&&"findStepIndex"in t){return t.findStepIndex({id:e.id})}return-1}return super.findStepIndex({id:e.id||((t=e.step)===null||t===void 0?void 0:t.id)})}getStepByPath(e){const t=e=>{const t=e.map((e=>{const t=this.findStepById(e,true);if(t){return t}throw new Error(`step '${e}' not found`)}));return t.at(-1)};if(!e){return this}const s=e.split(":").filter(Boolean);if(s.length===0){return this}return t(s)}getStepPath(e,t=[this.id]){return super.getStepPath(e,t)}getFriendlyName(){return"Test"}hasDownloadSteps(){return d.some((e=>this.findAllStepsByProperty("type",e).length>0))}getPropertiesDescription(e,t,s){var i,o,n;const a=this.mockNetworkOptions;let c=`Custom File: ${a.customHarFileLocation}`;if(!a.harFileLocationForPlayback){c=false}else if(a.recordedHarFileLocation===a.harFileLocationForPlayback){c="Recorded HAR"}return[this.baseUrl&&{key:"baseUrl",name:"Base URL",value:this.baseUrl,tooltip:true},{key:"testDataId",name:"Test data",value:"",subLink:"/data"},{key:"mockNetworkOptions",name:"Mock Network",value:c},(t===null||t===void 0?void 0:t.flags.networkBodyCapture.isEnabled())&&{key:"networkCaptureOptions",name:"Network Capture Options",value:this.networkCaptureOptions},(e===null||e===void 0?void 0:e.isTestStatusEnabled)&&{key:"testStatus",name:"Test Status",value:l.TestStatusNameMap[this.testStatus||"draft"]},this.sfdcOptions&&{key:"sfdcSaveLogScreenshots",name:"Save Salesforce Log screenshots",value:(i=this.sfdcOptions.saveLogScreenshots)!==null&&i!==void 0?i:false},{key:"testOwner",name:"Test Owner",value:(n=(o=s===null||s===void 0?void 0:s.projectUsersMapOrEmptyDefault[this.testOwnerUserId])===null||o===void 0?void 0:o.name)!==null&&n!==void 0?n:r.commonConstants.user.UNASSIGNED_USER}].filter(Boolean)}}t.Scenario=p;i([c.observable,o("design:type",Object)],p.prototype,"baseUrl",void 0);i([c.observable,o("design:type",Object)],p.prototype,"mockNetworkOptions",void 0);i([c.observable,o("design:type",Object)],p.prototype,"networkCaptureOptions",void 0);i([c.observable,o("design:type",String)],p.prototype,"testOwnerUserId",void 0);i([c.observable,o("design:type",typeof(n=typeof l.TestStatus!=="undefined"&&l.TestStatus)==="function"?n:Object)],p.prototype,"testStatus",void 0);i([c.observable.ref,o("design:type",Object)],p.prototype,"nativeApp",void 0);i([c.observable.ref,o("design:type",Object)],p.prototype,"sfdcOptions",void 0);i([c.computed,o("design:type",Object),o("design:paramtypes",[])],p.prototype,"appName",null)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestStatusNameMap=void 0;t.TestStatusNameMap={draft:"Draft",evaluating:"Evaluating",active:"Active",quarantine:"Quarantine"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StartPlaybackError=t.CancellationError=void 0;class i extends Error{}t.CancellationError=i;class o extends Error{}t.StartPlaybackError=o},function(e,t,s){"use strict";s.r(t);t["default"]={actualPlayButton:"PlaybackStateButtons_actualPlayButton_1iBw9_J1dHRvbnMt",mockNetworkIcon:"PlaybackStateButtons_mockNetworkIcon_2uPBK_J1dHRvbnMt",incognitoIcon:"PlaybackStateButtons_incognitoIcon_3gNXp_J1dHRvbnMt",playButtonMenu:"PlaybackStateButtons_playButtonMenu_Cr_Le_J1dHRvbnMt",mainPlayButtonTooltip:"PlaybackStateButtons_mainPlayButtonTooltip_3HGJl_J1dHRvbnMt",mainPlayButton:"PlaybackStateButtons_mainPlayButton_1qUa1_J1dHRvbnMt",pauseIcon:"PlaybackStateButtons_pauseIcon_3VVcG_J1dHRvbnMt",debugPlayIcon:"PlaybackStateButtons_debugPlayIcon_1gtUW_J1dHRvbnMt",playButtonMenuItem:"PlaybackStateButtons_playButtonMenuItem_3B7RP_J1dHRvbnMt",beetle:"PlaybackStateButtons_beetle_2oWX6_J1dHRvbnMt",title:"PlaybackStateButtons_title_pyFm6_J1dHRvbnMt",keyboardShortcut:"PlaybackStateButtons_keyboardShortcut_VwtSN_J1dHRvbnMt",rerunIcon:"PlaybackStateButtons_rerunIcon_obDwg_J1dHRvbnMt",menuItemDisabled:"PlaybackStateButtons_menuItemDisabled_vuuA6_J1dHRvbnMt",playOptions:"PlaybackStateButtons_playOptions_6AWGC_J1dHRvbnMt",playPropsButton:"PlaybackStateButtons_playPropsButton_2zt82_J1dHRvbnMt",playProps:"PlaybackStateButtons_playProps_HnI_F_J1dHRvbnMt",caretIcon:"PlaybackStateButtons_caretIcon_SiGQd_J1dHRvbnMt",isDropdownOpened:"PlaybackStateButtons_isDropdownOpened_1hRQC_J1dHRvbnMt",smallerIcon:"PlaybackStateButtons_smallerIcon_104ow_J1dHRvbnMt"}},function(e,t,s){"use strict";s.r(t);t["default"]={container:"ListView_container_2eP4P_JsZUxpc3Qt",row:"ListView_row_2HbtY_JsZUxpc3Qt",isArchived:"ListView_isArchived_2n5Ou_JsZUxpc3Qt",selected:"ListView_selected_2VElh_JsZUxpc3Qt",innerList:"ListView_innerList_2LjRA_JsZUxpc3Qt",tableContainer:"ListView_tableContainer_1p-by_JsZUxpc3Qt",loader:"ListView_loader_l4vUE_JsZUxpc3Qt",actionsMenu:"ListView_actionsMenu_2m0fb_JsZUxpc3Qt",shortHeader:"ListView_shortHeader_3buUY_JsZUxpc3Qt"}},function(e,t,s){"use strict";s.r(t);t["default"]={rightMenu:"ScenarioEditorHeader_rightMenu_1gKuG_JIZWFkZXIt",addGroup:"ScenarioEditorHeader_addGroup_3vx0H_JIZWFkZXIt",hook:"ScenarioEditorHeader_hook_P418W_JIZWFkZXIt",textualButton:"ScenarioEditorHeader_textualButton_3xNZ-_JIZWFkZXIt",settingsButton:"ScenarioEditorHeader_settingsButton_dezPF_JIZWFkZXIt",isPropertyPanelOpen:"ScenarioEditorHeader_isPropertyPanelOpen_1ejjH_JIZWFkZXIt",saveButton:"ScenarioEditorHeader_saveButton_Gk0MO_JIZWFkZXIt",highlightElements:"ScenarioEditorHeader_highlightElements_2OM-b_JIZWFkZXIt",recordButton:"ScenarioEditorHeader_recordButton_ut1cF_JIZWFkZXIt",recordButtonIconWrapper:"ScenarioEditorHeader_recordButtonIconWrapper_eboVJ_JIZWFkZXIt",isRecording:"ScenarioEditorHeader_isRecording_2g7L4_JIZWFkZXIt",recordButtonIcon:"ScenarioEditorHeader_recordButtonIcon_AGXSa_JIZWFkZXIt",stopRecordButtonIcon:"ScenarioEditorHeader_stopRecordButtonIcon_3YgI2_JIZWFkZXIt",recordingAnimation:"ScenarioEditorHeader_recordingAnimation_2byQg_JIZWFkZXIt"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"df12f92f3e.svg"},function(e,t,s){"use strict";s.r(t);t["default"]={tooltip:"tooltip_tooltip_ho76t_Rvb2x0aXAt",top:"tooltip_top_1zyJ1_Rvb2x0aXAt",topLeft:"tooltip_topLeft_3UU74_Rvb2x0aXAt",topRight:"tooltip_topRight_1xntC_Rvb2x0aXAt",bottom:"tooltip_bottom_x56US_Rvb2x0aXAt",bottomLeft:"tooltip_bottomLeft_1x_kt_Rvb2x0aXAt",bottomRight:"tooltip_bottomRight_1MQki_Rvb2x0aXAt",left:"tooltip_left_2jChn_Rvb2x0aXAt",leftTop:"tooltip_leftTop_2J9nx_Rvb2x0aXAt",leftBottom:"tooltip_leftBottom_1tgZG_Rvb2x0aXAt",right:"tooltip_right_29BdM_Rvb2x0aXAt",rightTop:"tooltip_rightTop_Avdfl_Rvb2x0aXAt",rightBottom:"tooltip_rightBottom_3Qqp4_Rvb2x0aXAt",white:"tooltip_white_1en6P_Rvb2x0aXAt",lineWrap:"tooltip_lineWrap_awbE9_Rvb2x0aXAt",hoverableTooltip:"tooltip_hoverableTooltip_3H51E_Rvb2x0aXAt",roundIconWithHoverableTooltip:"tooltip_roundIconWithHoverableTooltip_5tOuS_Rvb2x0aXAt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Form=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(70);const a=s(212);const c=s(121);const l=s(472);const u=s(74);const d=s(31);const p=s(40);const h=s(122);const f=s(32);const m=s(218);const g=s(44);const v=s(0);const S=s(482);const y=s(219);const b=s(20);const _=s(486);const T=s(489);const E=s(492);const I=s(222);const C=s(223);const D=["checkbox","radiobutton","radiobuttonGroup","message","image","empty"];const O=["message","empty"];const A=o.memo((({item:e,value:t,onChange:s,props:a})=>{switch(e.type){case"autocomplete":return(0,i.jsx)(l.Autocomplete,{...a,onChange:s,value:t});case"checkbox":return(0,i.jsx)(u.Checkbox,{...a,onChange:s,checked:t,children:e.inline!==false&&e.label||(a===null||a===void 0?void 0:a.children)});case"cta":return(0,i.jsx)(d.Cta,{...a});case"deviceSelection":return(0,i.jsxs)("div",{children:[(0,i.jsx)(C.SelectDevice,{}),(0,i.jsx)(I.SelectApp,{})]});case"dropdown":return(0,i.jsx)(p.Dropdown,{...a,onChange:s,value:t});case"image":return(0,i.jsx)("img",{...a});case"message":return(0,i.jsx)("div",{className:(0,n.default)(r.default.modalSection,a===null||a===void 0?void 0:a.className),children:e.inline!==false&&e.label||(a===null||a===void 0?void 0:a.children)});case"password":return(0,i.jsx)(_.PasswordTextbox,{...a,onChange:s,value:t});case"phoneTextBox":return(0,i.jsx)(E.PhoneTextbox,{value:t,...a,onPhoneNumberChange:(e,t)=>{s(t)}});case"radiobutton":return(0,i.jsx)(h.RadioButton,{...a,onChange:s,checked:t,children:e.inline!==false&&e.label||(a===null||a===void 0?void 0:a.children)});case"radiobuttonGroup":return(0,i.jsx)(y.RadioButtonGroup,{...a,title:e.inline&&typeof e.label==="string"?e.label:"",onChange:s,checked:t});case"tagsInput":return(0,i.jsx)(c.TagsInput,{...a,tags:t,onTagsChange:s});case"testStatusDropdown":return(0,i.jsx)(S.TestStatusDropdown,{...a,onChange:(e,t)=>s(t)});case"textarea":return(0,i.jsx)(T.TextArea,{...a,onChange:s,children:t});case"textbox":return(0,i.jsx)(f.Textbox,{...a,onChange:s,value:t});case"textboxWithCopy":return(0,i.jsx)(m.TextboxWithCopy,{...a,value:t});default:return(0,i.jsx)(o.Fragment,{})}}));A.displayName="FormComponent";const j=(e,t)=>{switch(e.type){case"checkbox":case"radiobutton":return t.target.checked;case"textbox":case"password":case"textarea":return t.target.value;default:return t}};const w=({items:e,onChange:t,values:s,className:o})=>{const[r,c]=(0,v.useReducer)(((e,t)=>({...e,[t]:true})),s||{});const[l,u]=(0,v.useReducer)(((e,t)=>{const s=Object.keys(t).every((s=>e[s]!==t[s]||!Object.hasOwn(e,s)&&Object.hasOwn(t,s)));return s?{...e,...t}:e}),{});const d=(0,v.useCallback)(((i,o)=>{const n=e[i];o=j(n,o);if(n.validate){const e=n.validate(o,s);(async()=>u({[i]:await e}))()}let r={};if(n.type==="radiobutton"&&o){const t=Object.entries(e).filter((([,e])=>{var t,s;return e!==n&&((t=e.props)===null||t===void 0?void 0:t.name)===((s=n.props)===null||s===void 0?void 0:s.name)}));r=Object.fromEntries(t.map((([e])=>[e,false])))}t({changes:{[i]:o,...r}});c(i);Object.keys(r).forEach((e=>c(e)))}),[e,t,s]);const p=(0,v.useMemo)((()=>Object.keys(e).reduce(((e,t)=>Object.assign(e,{[t]:e=>d(t,e)})),{})),[e,d]);const h=t=>!e[t].isVisible||e[t].isVisible(s[t],s);(0,v.useEffect)((()=>{const e=!Object.keys(l).some((e=>l[e]&&h(e)));t({isValid:e})}),[l,h,t]);(0,b.useAsyncEffect)((i=>{t({isValid:false});(async()=>{const t={};await Promise.all(Object.keys(e).map((async i=>{const o=e[i];if(o.validate){t[i]=await o.validate(s[i],s)}})));if(i()){u(t)}})()}),[]);return(0,i.jsx)("div",{className:(0,n.default)(a.default.form,o),children:Object.keys(e).map((t=>{if(!h(t)){return undefined}const o=e[t];const n=D.includes(o.type)&&o.inline!==false;const a=n&&O.includes(o.type)?o.noWrap!==false:o.noWrap;const c=typeof(o===null||o===void 0?void 0:o.props)==="function"?o.props(s[t],s):o.props;const u=(0,i.jsx)(A,{item:o,value:s[t],onChange:p[t],props:c},`${t}_component`);return a?u:(0,i.jsxs)(g.FieldLabel,{...o.labelProps,error:r[t]&&l[t]||undefined,children:[!n&&o.label&&(0,i.jsx)("span",{children:o.label}),u]},t)}))})};t.Form=w;t.Form.displayName="Form"},function(e,t,s){"use strict";s.r(t);t["default"]={formModal:"form_formModal_3AQKM_JzLWZvcm0t",navigation:"form_navigation_3wvav_JzLWZvcm0t",form:"form_form_2VhUN_JzLWZvcm0t",errorMessage:"form_errorMessage_1eOeY_JzLWZvcm0t",gray:"form_gray_1cXAo_JzLWZvcm0t",bottomSeparator:"form_bottomSeparator_1Il5l_JzLWZvcm0t"}},,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RadioButton=void 0;const i=s(4);const o=s(0);const n=s(6);const r=s(217);const a=s(10);const c=e=>{var t;const s=(t=e.title)!==null&&t!==void 0?t:typeof e.children==="string"?e.children:"";return(0,i.jsxs)("label",{className:(0,a.default)(r.default.radioLabel,e.wrapperClassName,{[r.default.disabled]:e.disabled}),title:s,children:[(0,i.jsx)("input",{type:"radio",...n.omit(e,["children","wrapperClassName","buttonSize","iconVariety"])}),(0,i.jsx)("i",{className:(0,a.default)(r.default.radioIcon,{[r.default.large]:e.buttonSize==="large",[r.default.donut]:e.iconVariety==="donut"})}),e.children]})};t.RadioButton=c},function(e,t,s){"use strict";s.r(t);t["default"]={radioLabel:"radiobutton_radioLabel_3OiEw_9idXR0b24t","radio-icon":"radiobutton_radio-icon_-0GVT_9idXR0b24t",radioIcon:"radiobutton_radio-icon_-0GVT_9idXR0b24t",donut:"radiobutton_donut_20cqg_9idXR0b24t",disabled:"radiobutton_disabled_QKZTa_9idXR0b24t",large:"radiobutton_large_X9wvo_9idXR0b24t","radio-group-wrapper":"radiobutton_radio-group-wrapper_2rAK8_9idXR0b24t",radioGroupWrapper:"radiobutton_radio-group-wrapper_2rAK8_9idXR0b24t"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(478),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RadioButtonGroup=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(217);const a=s(0);const c=s(12);const l=s(216);const u=(0,c.observer)((({name:e,onChange:t,props:{postButtonElement:s,children:o,...n}={},checked:r})=>{const c=(0,a.useCallback)((s=>{if(s.target.checked){t(e)}}),[t,e]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.RadioButton,{...n,checked:r===e,onChange:c,children:o!==null&&o!==void 0?o:n.title}),s]})}));u.displayName="RadioButtonWrapped";t.RadioButtonGroup=(0,c.observer)((({options:e,title:t,checked:s,wrapperClassName:o,onChange:a})=>(0,i.jsxs)("div",{className:(0,n.default)(r.default.radioGroupWrapper,o),children:[t&&(0,i.jsx)("div",{children:t}),Object.keys(e).map((t=>(0,i.jsx)(u,{name:t,checked:s,onChange:a,props:e[t]},String(t))))]})));t.RadioButtonGroup.displayName="RadioButtonGroup"},,,function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(505),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(510),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ToastsWrapper=t.Toast=void 0;const i=s(4);const o=s(0);const n=s(0);const r=s(10);const a=s(512);const c=s(16);const l=s(20);const u=s(12);const d=s(6);t.Toast=(0,u.observer)((({closeToast:e,animationContainer:t,timeout:s,icon:o,children:u,closeOnClickOutside:p,hideClose:h,customToastClass:f,customToastBodyClass:m})=>{const g=(0,l.useClickOutside)({callback:()=>{t.shouldClose=true},activate:Boolean(p)});const v=(0,n.useCallback)((()=>{if(!g.current){return e()}g.current.classList.add(a.default.leave);g.current.addEventListener("animationend",(()=>e()));return undefined}),[e,g]);(0,l.useAsyncEffect)((e=>{const t=s&&setTimeout((()=>{if(e()){v()}}),s);return()=>{if(t){clearTimeout(t)}}}),[s,v]);(0,n.useEffect)((()=>{if(t.shouldClose){v()}}),[v,t.shouldClose]);const S=(0,n.useMemo)((()=>(0,d.capitalize)((o===null||o===void 0?void 0:o.color)||"white")),[o]);return(0,i.jsxs)("div",{className:(0,r.default)(a.default.toast,{[a.default.hasIcon]:o,[f]:f!==undefined},a.default.enter),ref:g,children:[o&&(0,i.jsx)(c.Icon,{icon:o.type,className:(0,r.default)(a.default.icon,a.default[o.backgroundType],a.default[`iconColor${S}`])}),(0,i.jsx)("div",{className:(0,r.default)(a.default.body,{[m]:m!==undefined}),children:u}),!h&&(0,i.jsx)("button",{onClick:()=>v(),className:a.default.close,children:(0,i.jsx)(c.Icon,{icon:"close-thin",className:a.default.icon})})]})}));const p=({children:e,position:t="left"})=>(0,i.jsx)("div",{className:(0,r.default)(a.default.toastWrapper,{[a.default.bottomRight]:t==="right"}),children:e});t.ToastsWrapper=p;t.Toast.displayName="Toast";t.ToastsWrapper.displayName="ToastsWrapper"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(535),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(541),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(548),t)},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"ff22c20e8c.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"3b19e511a3.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DiscardFileAnchor=void 0;const i=s(4);const o=s(127);const n=s(0);const r=({onDiscardClick:e})=>(0,i.jsx)("div",{className:o.default.discardFileWrapper,children:(0,i.jsx)("a",{className:o.default.discardFile,onClick:e,children:"Discard File"})});t.DiscardFileAnchor=r;t.DiscardFileAnchor.displayName="DiscardFileAnchor"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(559),t)},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"restrictToChrome_modal__HmUx_9DaHJvbWUt","edge-modal":"restrictToChrome_edge-modal_3jlaB_9DaHJvbWUt",edgeModal:"restrictToChrome_edge-modal_3jlaB_9DaHJvbWUt",beta:"restrictToChrome_beta_2CoPo_9DaHJvbWUt",bold:"restrictToChrome_bold_1PRQu_9DaHJvbWUt","edge-message":"restrictToChrome_edge-message_1wrAY_9DaHJvbWUt",edgeMessage:"restrictToChrome_edge-message_1wrAY_9DaHJvbWUt",img:"restrictToChrome_img_cQgkM_9DaHJvbWUt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.bfs=void 0;function i(e,t,s){const i=[e];const o=new Map;while(i.length>0){const r=i.shift();if(s(r)){return{target:r,path:Array.from(n(r,o)).concat(e)}}const a=t(r);for(const e of a){if(o.has(e)){continue}o.set(e,r);i.push(e)}}throw new RangeError(`Could not compute a path between element${e} to an element matching the passed predicate: ${s.toString()}`);function*n(t,s){while(t!==e){yield t;t=s.get(t)}}}t.bfs=i},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l;Object.defineProperty(t,"__esModule",{value:true});t.TestResultListenerService=void 0;const u=s(8);const d=s(7);const p=s(15);const h=s(124);const f=s(5);const m=s(14);const g=s(26);const v=s(9);const S=s(20);const y=s(583);const b=s(38);const _=d.Logger.getLogger("test-result-service");let T=class e{constructor(e,t,s,i,o){this.projectsService=e;this.featureFlagsService=t;this.socketService=s;this.urlStateService=i;this.authenticationManager=o;this.testResultService=new y.TestResultService;e.on([f.scenario.PROJECT_CHANGED,f.scenario.PROJECT_SELECTED],(e=>{const t=(0,S.isPlaygroundModeState)(this.urlStateService);if(e.id===f.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&t){return}this.init(e.id)}),this);o.on(f.commonConstants.scenario.APP_LOGOUT,(()=>{this.testResultService.closeSocket()}))}init(e=this.projectsService.projectId){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.init(e,u.utils.getServicesUrl())}this.testResultService.closeSocket();return undefined}joinToTestResult(e,t){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.joinToTestResult(e,t)}return this.socketService.addFilter(e,{resultId:e,testId:t},[f.socketEventTypes.TEST_RESULT_UPDATED,f.socketEventTypes.TEST_RESULT_CREATED,f.socketEventTypes.SETUP_STEP_RESULT,f.socketEventTypes.RUN_CONFIG_PARAMS_RESULT,f.socketEventTypes.STEP_RESULT])}joinToTestResultWithoutStep(e,t){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.joinToTestResult(e,t)}return this.socketService.addFilter(e,{resultId:e,testId:t},[f.socketEventTypes.TEST_RESULT_UPDATED,f.socketEventTypes.TEST_RESULT_CREATED])}leaveTestResult(e,t){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.leaveTestResult(e,t)}return this.socketService.removeFilter(e,[f.socketEventTypes.TEST_RESULT_UPDATED,f.socketEventTypes.TEST_RESULT_CREATED,f.socketEventTypes.SETUP_STEP_RESULT,f.socketEventTypes.RUN_CONFIG_PARAMS_RESULT,f.socketEventTypes.STEP_RESULT])}listenToTestResult(e,t,s){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.listenToTestResult(e,t,s)}this.socketService.listenTo(e,[f.socketEventTypes.TEST_RESULT_UPDATED,f.socketEventTypes.TEST_RESULT_CREATED],(s=>s.resultId===e&&s.testId===t),s);return undefined}listenToTestResultStatus(e,t,s){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.listenToTestResultStatus(e,t,s)}this.socketService.listenTo(e,[f.socketEventTypes.TEST_RESULT_UPDATED,f.socketEventTypes.TEST_RESULT_CREATED],(s=>s.resultId===e&&s.testId===t),(e=>{const t=e===null||e===void 0?void 0:e.status;if(t){s(t)}else{_.warn("test result return without status")}}));return undefined}listenToSetupStepResult(e,t,s){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.listenToSetupStepResult(e,t,s)}this.socketService.listenTo(e,[f.socketEventTypes.SETUP_STEP_RESULT],(s=>s.resultId===e&&s.testId===t),(e=>s(e)));return undefined}listenToTestRunConfig(e,t,s){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.listenToTestRunConfig(e,t,s)}this.socketService.listenTo(e,[f.socketEventTypes.RUN_CONFIG_PARAMS_RESULT],(s=>s.resultId===e&&s.testId===t),(e=>s(e.runConfig)));return undefined}listenToTestRunParams(e,t,s){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.listenToTestRunParams(e,t,s)}this.socketService.listenTo(e,[f.socketEventTypes.RUN_CONFIG_PARAMS_RESULT],(s=>s.resultId===e&&s.testId===t),(e=>s({runParams:e.runParams,runParamsUrl:e.runParamsUrl})));return undefined}listenToStepResult(e,t,s){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.testResultService.listenToStepResult(e,t,s)}this.socketService.listenTo(e,[f.socketEventTypes.STEP_RESULT],(s=>s.resultId===e&&s.testId===t),(e=>s(e)));return undefined}};t.TestResultListenerService=T;t.TestResultListenerService=T=i([(0,v.injectable)(),o("design:paramtypes",[typeof(n=typeof p.ProjectsService!=="undefined"&&p.ProjectsService)==="function"?n:Object,typeof(r=typeof m.FeatureFlagsService!=="undefined"&&m.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof h.UISocketService!=="undefined"&&h.UISocketService)==="function"?a:Object,typeof(c=typeof g.UrlStateService!=="undefined"&&g.UrlStateService)==="function"?c:Object,typeof(l=typeof b.AuthenticationService!=="undefined"&&b.AuthenticationService)==="function"?l:Object])],T)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(164),t);o(s(606),t);o(s(607),t)},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"ErrorModal_modal_2gwB-_MtZXJyb3It","contact-link":"ErrorModal_contact-link_2My6p_MtZXJyb3It",contactLink:"ErrorModal_contact-link_2My6p_MtZXJyb3It"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RuntimeConnectionListener=t.throwMaxLengthIfNeeded=t.EXTENSION_LOADED=t.PONG_MSG=t.PING_MSG=void 0;const i=s(7);const o=s(118);const n=s(238);const r=s(131);const a=s(239);const c=s(5);t.PING_MSG="BROKER_RUNTIME_CONNECTION_PING";t.PONG_MSG="BROKER_RUNTIME_CONNECTION_PONG";t.EXTENSION_LOADED="EXTENSION_LOADED";function l(e){var t;if((t=e===null||e===void 0?void 0:e.message)===null||t===void 0?void 0:t.startsWith(c.commonConstants.error.MESSAGE_LENGTH_EXCEEDED_MAX_LENGTH_ERROR_MESSAGE)){throw new r.ConnectionMaxSizeError(6e7)}}t.throwMaxLengthIfNeeded=l;const u=i.Logger.getLogger("runtime-connection-listener");async function d({external:e}){const s=e?"*://*/*":"chrome-extension://*/*";const i=await o.browser.tabs.queryAsync({url:s,status:"complete"});i.forEach((s=>{if(!s.id){return}if(e){o.browser.tabs.executeScriptAsync(s.id,{allFrames:true,code:`window.postMessage('${t.EXTENSION_LOADED}')`}).catch((e=>{var t;if((t=e.message)===null||t===void 0?void 0:t.includes("The tab was closed")){return}u.error("Failed to send extension loaded event",{error:e})}));return}o.browser.tabs.sendMessage(s.id,{data:t.EXTENSION_LOADED})}))}function p(e={}){const{frameId:t,tab:s}=e;const i=s===null||s===void 0?void 0:s.id;if(i===undefined){return undefined}return`t:${i}f:${t}`}class h{constructor(e,{external:s}={}){this.context=e;this._handlersData=new Map;this._handlersMsgQueues=new Map;this._external=s;d({external:s});o.browser.runtime[s?"onConnectExternal":"onConnect"].addListener((e=>{e.postMessage({type:t.PING_MSG});const s=({type:i,data:o}={type:"",data:{}})=>{if(i===t.PONG_MSG&&o.context){this.registerHandler(e,o);e.onMessage.removeListener(s)}};e.onMessage.addListener(s)}))}registerHandler(e,t){var s,i,o;const c=(s=t.context)!==null&&s!==void 0?s:"unknown";const l=(i=t.exposedServices)!==null&&i!==void 0?i:[];const u=p(e.sender);if(!u){e.disconnect();return}this._handlersData.set(u,Object.assign(e,{context:c,services:new Set(l)}));if(!this._handlersMsgQueues.has(u)){this._handlersMsgQueues.set(u,new r.ActionsQueue((()=>Boolean(this._handlersData.get(u)))))}const d=e=>{var t;if(!(0,r.hasMetadata)(e)){return}if(this.msgProcessor.debug){(0,n.logMessage)("received <<",c,e)}const s={handlerId:u,handlerContext:c};this.msgProcessor.processMessage((0,r.stampMessage)(e,this.context,s));if(e.type===a.switchboardEvents.EXPOSED){const{data:{key:s}}=e;(t=this._handlersData.get(u))===null||t===void 0?void 0:t.services.add(s)}};e.onDisconnect.addListener((e=>{e.onMessage.removeListener(d);this._handlersData.delete(u);setTimeout((()=>{if(!this._handlersData.has(u)){this._handlersMsgQueues.delete(u)}}),1e3*30)}));e.onMessage.addListener(d);(o=this._handlersMsgQueues.get(u))===null||o===void 0?void 0:o.doAll()}getOrigin(e){var t;const s=(t=e.metadata.stamps[this.context])!==null&&t!==void 0?t:{};if("handlerId"in s&&"handlerContext"in s){return s}return undefined}async addToQueue(e,t){const s=this._handlersMsgQueues.get(e);await(s===null||s===void 0?void 0:s.add((()=>{const s=this._handlersData.get(e);try{s===null||s===void 0?void 0:s.postMessage(t);if(s&&this.msgProcessor.debug){(0,n.logMessage)("post >>",s.context,t)}}catch(e){l(e);throw e}})))}async forward(e){var t;const s=(t=this.getOrigin(e))===null||t===void 0?void 0:t.handlerId;const{recipientServiceKey:i}=e.metadata;const o=async t=>{if(t===s){return}await this.addToQueue(t,e)};if(i){for(const[e,t]of this._handlersData){if(t.services.has(i)){await o(e)}}return}for(const e of this._handlersMsgQueues.keys()){await o(e)}}async backward(e){const t=this.getOrigin(e);if(t){await this.addToQueue(t.handlerId,e)}}}t.RuntimeConnectionListener=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.logMessage=void 0;const i="font-family: monospace";const o=["#FFAB00","#1DE9B6","#FF4081","#EEFF41"];const n={};let r=0;function a(e,t,s){var a,c;if((a=s.metadata)===null||a===void 0?void 0:a.noConsoleLog){return}(c=n[t])!==null&&c!==void 0?c:n[t]=o[r++%o.length];const{type:l,...u}=s;console.debug(`%c${e.toLocaleUpperCase()} %c[${t}] %c${l}`,i,`color: ${n[t]}; ${i}`,"",u)}t.logMessage=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.switchboardEvents=void 0;t.switchboardEvents={EXPOSED:"switchboard:exposed",ERROR:"switchboard:ERROR"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h;Object.defineProperty(t,"__esModule",{value:true});t.TestStreamService=void 0;const f=s(15);const m=s(124);const g=s(5);const v=s(617);const S=s(8);const y=s(33);const b=s(14);const _=s(26);const T=s(9);const E=s(20);const I=s(38);const C=s(29);const D=s(62);const O=s(618);const A=s(129);const{socketEventTypes:j,scenario:w}=g.commonConstants;let R=class e extends y.EventEmitter{constructor(e,t,s,i,o,n,r,a,c){super();this.projectsService=e;this.featureFlagsService=t;this.socketService=s;this.urlStateService=i;this.editedTestStore=o;this.stepAdder=n;this.hostService=r;this.testResultStore=a;this.authenticationManager=c;this.streamTestSocketIO=new v.TestStreamSocketIO;this.lastTestId="";this.handleStepAdded=this.handleStepAdded.bind(this);this.handleStepUpdated=this.handleStepUpdated.bind(this);this.handleTestUpdated=this.handleTestUpdated.bind(this);this.handleTestConfigUpdated=this.handleTestConfigUpdated.bind(this);e.on([w.PROJECT_CHANGED,w.PROJECT_SELECTED],(e=>{const t=(0,E.isPlaygroundModeState)(this.urlStateService);if(e.id===g.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&t){return}this.init(e.id)}),this);c.on(g.commonConstants.scenario.APP_LOGOUT,(()=>{this.streamTestSocketIO.closeSocket()}))}init(e=this.projectsService.projectId){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.init(e,S.utils.getServicesUrl())}this.streamTestSocketIO.closeSocket();return undefined}async listenToTestStream(e){if(this.lastTestId===e){return}if(this.lastTestId&&this.lastTestId!==e){await this.leaveTestStream(this.lastTestId)}this.lastTestId=e;await this.joinToTestStream(e);this.listenToStepAdded(e);this.listenToStepUpdated(e);this.listenToTestUpdated(e);this.listenToTestConfigUpdated(e)}joinToTestStream(e){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.joinToTestStream(e)}return this.socketService.addFilter(e,{testId:e},[j.STEP_ADDED,j.STEP_UPDATED,j.TEST_UPDATED,j.TEST_CONFIG_UPDATED])}leaveTestStream(e){this.lastTestId="";if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.leaveTestStream(e)}return this.socketService.removeFilter(e,[j.STEP_ADDED,j.STEP_UPDATED,j.TEST_UPDATED,j.TEST_CONFIG_UPDATED])}handleStepAdded(e){const t=Object.assign(e.step,{id:e.stepId||e.step._id});this.stepAdder.addStep({stepData:t})}listenToStepAdded(e){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.listenToStepAdded(e,this.handleStepAdded)}this.socketService.listenTo(e,[j.STEP_ADDED],(t=>t.testId===e),this.handleStepAdded);return undefined}handleStepUpdated(e){this.editedTestStore.updateStepById(e.stepId,Object.assign(e.step,{id:e.stepId}))}listenToStepUpdated(e){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.listenToStepUpdated(e,this.handleStepUpdated)}this.socketService.listenTo(e,[j.STEP_UPDATED],(t=>t.testId===e),this.handleStepUpdated);return undefined}handleTestUpdated(e){if(e.baseUrl&&this.editedTestStore.scenario){this.editedTestStore.scenario.baseUrl=e.baseUrl}}listenToTestUpdated(e){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.listenToTestUpdated(e,this.handleTestUpdated)}this.socketService.listenTo(e,[j.TEST_UPDATED],(t=>t.testId===e),this.handleTestUpdated);return undefined}handleTestConfigUpdated(e){var t;const{resolution:s,testConfigId:i}=e;if(s&&i){(t=this.editedTestStore.testConfig)===null||t===void 0?void 0:t.update({id:i,resolution:s})}if(s&&this.testResultStore.currentTestResultRunConfig){this.testResultStore.currentTestResultRunConfig.resolution=s}}listenToTestConfigUpdated(e){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.streamTestSocketIO.listenToTestConfigUpdated(e,this.handleTestConfigUpdated)}this.socketService.listenTo(e,[j.TEST_CONFIG_UPDATED],(t=>t.testId===e),this.handleTestConfigUpdated);return undefined}};t.TestStreamService=R;t.TestStreamService=R=i([(0,T.injectable)(),o("design:paramtypes",[typeof(n=typeof f.ProjectsService!=="undefined"&&f.ProjectsService)==="function"?n:Object,typeof(r=typeof b.FeatureFlagsService!=="undefined"&&b.FeatureFlagsService)==="function"?r:Object,typeof(a=typeof m.UISocketService!=="undefined"&&m.UISocketService)==="function"?a:Object,typeof(c=typeof _.UrlStateService!=="undefined"&&_.UrlStateService)==="function"?c:Object,typeof(l=typeof C.EditedTestStore!=="undefined"&&C.EditedTestStore)==="function"?l:Object,typeof(u=typeof O.StepsAdder!=="undefined"&&O.StepsAdder)==="function"?u:Object,typeof(d=typeof D.HostService!=="undefined"&&D.HostService)==="function"?d:Object,typeof(p=typeof A.TestResultStore!=="undefined"&&A.TestResultStore)==="function"?p:Object,typeof(h=typeof I.AuthenticationService!=="undefined"&&I.AuthenticationService)==="function"?h:Object])],R)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.selectorClasses=void 0;const i=s(309);const o=s(619);const n=s(620);const r=s(621);const a=s(622);const c=s(623);const l=s(244);const u=s(624);const d=s(625);const p=s(626);const h=s(627);const f=s(628);const m=s(629);const g=s(630);const v=s(631);const S=s(632);function y(e,t){switch(e.type){case"IdSelector":return new o.IdSelector(e);case"CSSClassSelector":return new n.CSSClassSelector(e);case"AttributeSelector":return new r.AttributeSelector(e,t);case"TextContentSelector":return new a.TextContentSelector(e);case"InnerTextSelector":return new c.InnerTextSelector(e);case m.NthChildSelector.TYPE:return new m.NthChildSelector(e);case h.NthTagSelector.TYPE:return new h.NthTagSelector(e,t);case"TagSelector":return new l.TagSelector(e,t);case"StyleSelector":return new f.StyleSelector(e);case"UrlSelector":return new u.UrlSelector(e);case"UrlQueryParamSelector":return new g.UrlQueryParamSelector(e);case"BodySelector":return new p.BodySelector(e);case"HTMLSelector":return new d.HTMLSelector(e);case"ChildSelector":return new v.ChildSelector(e);case"FrameVisibleSelector":return new S.FrameVisibleSelector(e);case i.ShadowRootSelector.TYPE:return new i.ShadowRootSelector(e);default:throw new Error(`Illegal selector type ${e.type}`)}}t.selectorClasses={create:y}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryResult=void 0;const i=s(6);class o{constructor(e){this.testimElementDomId=e.testimElementDomId;this.element=e.element;this.score=e.score;this.parentIndex=typeof e.parentIndex==="number"?e.parentIndex:undefined;this.parentScore=e.parentScore;this.relativeParent=e.relativeParent;this.relativeParentTestimDomId=e.relativeParentTestimDomId;this.className="QueryResult"}getSerializableObject(){return i.pick(this,["testimElementDomId","score","parentScore","relativeParentTestimDomId","parentIndex","className"])}}t.QueryResult=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SelectorResult=void 0;const i=s(6);class o{constructor(e){this.displayName=e.displayName;this.displayValue=e.displayValue;this.foundElements=e.foundElements;this.foundParentsIds=e.foundParentsIds;this.validatedElements=e.validatedElements;this.className="SelectorResult";this.chosenParent=e.chosenParent;this.time=e.time;this.queryResults=e.queryResults;this.selectorType=e.selectorType;this.isDifferentSiblingCount=e.isDifferentSiblingCount;this.selector=e.selector}setChosenParent(e){if(typeof e==="number"){this.chosenParent=e}}setValidatedElements(e){this.validatedElements=e}getSerializableObject(){return i.pick(this,["validatedElements","foundElements","foundParentsIds","displayName","displayValue","chosenParent","time","className"])}}t.SelectorResult=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TagSelector=void 0;const i=s(54);const o=s(105);const n=s(76);const r=["DIV","SPAN"];const a=.1;const c=.3;const l=.5;class u extends o.CSSSelector{constructor(e,t){super(e,t);this.tagName=e.tagName;this.userDefinedTagName=e.userDefinedTagName;this.evaluatedTagName=this.tagName}isEdited(){return this._isValueEdited(this.userDefinedTagName)}getType(){return"TagSelector"}evaluateComputedProperties(e){this.evaluatedTagName=e.executeOrDefault(this.tagName,this.userDefinedTagName)}getQuery(){return this.evaluatedTagName}getDisplayName(){return"Tag"}getDisplayValue(){return this.effectiveTagName()}_matches(e){return this._equals(e)}_equals(e){if(e instanceof u){return this.tagName===e.tagName&&this.userDefinedTagName===e.userDefinedTagName}return false}isSelectorValid(e){return i.injectorUtils.getTagName(e,true)===this.evaluatedTagName}computeInitialScore(e){const t={isValid:this.metaData.customTagScore&&(e.tagName||"").includes("-"),score:l};const s={isValid:r.includes(e.tagName),score:a};const i={isValid:true,score:c};const o=[t,s,i];const n=o.find((e=>e.isValid))||i;return n.score}getSelfScore(){if(Object.hasOwn(this,"selfScore")){if(this.metaData.salesForceSelectrorFix){const e=this.effectiveTagName().includes("-");const t=this.selfScore===c;if(e&&t){return l}}return this.selfScore}return this.computeInitialScore({tagName:this.effectiveTagName()})}effectiveTagName(){return(0,n.displayFormat)(this.tagName,this.userDefinedTagName)}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{userDefinedTagName:{type:"textbox",value:(0,n.scriptFormat)(this.tagName,this.userDefinedTagName),label:"Tag Name",props:{autoFocus:true,placeholder:"tag name"},validate:e=>e.trim()?undefined:"The Tag Name is required"}}}}updateProperties(e){this.userDefinedTagName=e.userDefinedTagName;return true}serialize(){return{...super.serialize(),tagName:this.tagName,userDefinedTagName:this.userDefinedTagName}}}t.TagSelector=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DomRootRelativeSelector=void 0;const i=s(53);const o=s(242);const n=s(243);const r=s(64);class a extends r.RelativeSelector{_elementToLocateResult(e){const t={testimElementDomId:i.locatorBuilderUtils.calcTestimId(e),element:e,parentScore:1,score:this.getSelfScore()};const s=new o.QueryResult(t);const r={queryResults:[s],displayName:this.getDisplayName(),displayValue:this.getDisplayValue(),foundElements:[{id:s.testimElementDomId,score:s.score}],foundParentsIds:[],selectorType:this.type,time:0,selector:this};return new n.SelectorResult(r)}getDisplayValue(){return"true"}isUnique(){return true}computeInitialScore(){return 1}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}}t.DomRootRelativeSelector=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LocatorDocument=void 0;class i{constructor(e){this.elementLocators=e}getElementLocators(){return this.elementLocators}isEdited(){return this.elementLocators.some((e=>e.isEdited()))}}t.LocatorDocument=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseImageUploader=void 0;const i=s(8);const o=3e4;class n{constructor(e){this.servicesApi=e}getUploadTimeout(e){return o}uploadImage(e){const t=encodeURI(e.imageURL).length;return i.utils.promiseTimeout(this.saveImageToServerPromise(e),this.getUploadTimeout(t),"timeout while trying to upload an image")}}t.BaseImageUploader=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SharedStepFolderSelection=void 0;const i=s(4);const o=s(0);const n=s(92);const r=s(44);const a=s(16);const c=s(11);const l=s(646);const u=s(28);const d=s(10);const p=s(652);const h=({isFolderSelectionEnabled:e,entityTypeName:t,setSelectedParentFolder:s,selectedParentFolder:h})=>{const f=(0,c.useDependencyInjector)(u.ModalService);const m=(0,c.useDependencyInjector)(n.FoldersStore);const g=o.useCallback((async()=>{const e=await m.getFolderContent("sharedSteps",h.infoId);const t=await f.openModal(l.FolderSelectionModal,{initialFolder:e,treeType:"sharedSteps",className:p.default.folderSelectionModal}).promise;if(!t){return}const i=t.selectedFolderInfoId?t.selectedFolderName:"Root";s({infoId:t.selectedFolderInfoId,name:i})}),[m,f,h.infoId,s]);return(0,i.jsxs)(r.FieldLabel,{className:(0,d.default)(p.default.folderSelection,{[p.default.hidden]:!e}),children:[(0,i.jsxs)("span",{children:["Select ",t?`${t} `:"","folder"]}),(0,i.jsxs)("button",{className:p.default.selectFolderButton,type:"button",onClick:g,children:[(0,i.jsx)("span",{children:h.name}),(0,i.jsx)(a.Icon,{icon:"arrow-up"})]})]})};t.SharedStepFolderSelection=h;t.SharedStepFolderSelection.displayName="SharedStepFolderSelection"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(667),t)},function(e,t,s){"use strict";s.r(t);t["default"]={"toggle-switch-label":"toggleSwitch_toggle-switch-label_1PPGg_VTd2l0Y2gt",toggleSwitchLabel:"toggleSwitch_toggle-switch-label_1PPGg_VTd2l0Y2gt",disabled:"toggleSwitch_disabled_1yaQH_VTd2l0Y2gt",switch:"toggleSwitch_switch_22Oa__VTd2l0Y2gt",checked:"toggleSwitch_checked_KquJ6_VTd2l0Y2gt",state:"toggleSwitch_state_3J7mn_VTd2l0Y2gt",large:"toggleSwitch_large_1w_dr_VTd2l0Y2gt",icons:"toggleSwitch_icons_D12Rx_VTd2l0Y2gt","small-icons":"toggleSwitch_small-icons_BgX4R_VTd2l0Y2gt",smallIcons:"toggleSwitch_small-icons_BgX4R_VTd2l0Y2gt",iconUnchecked:"toggleSwitch_iconUnchecked_3GqTh_VTd2l0Y2gt",iconChecked:"toggleSwitch_iconChecked_XMfc8_VTd2l0Y2gt",dark:"toggleSwitch_dark_SUNtL_VTd2l0Y2gt","light-on-dark":"toggleSwitch_light-on-dark_1iUZT_VTd2l0Y2gt",lightOnDark:"toggleSwitch_light-on-dark_1iUZT_VTd2l0Y2gt",activated:"toggleSwitch_activated_2Xbkw_VTd2l0Y2gt",checkbox:"toggleSwitch_checkbox_KyYWZ_VTd2l0Y2gt",right:"toggleSwitch_right_2M103_VTd2l0Y2gt"}},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"TourGuide_modal_1GyUG_VyR3VpZGUt",body:"TourGuide_body_2xvvJ_VyR3VpZGUt",largeTitle:"TourGuide_largeTitle_3Odrb_VyR3VpZGUt",smallTitle:"TourGuide_smallTitle_1Za7O_VyR3VpZGUt",subTitle:"TourGuide_subTitle_2pdfX_VyR3VpZGUt",textItem:"TourGuide_textItem_1qi62_VyR3VpZGUt",cta:"TourGuide_cta_1J_Gl_VyR3VpZGUt",productTourContainer:"TourGuide_productTourContainer_WVZBW_VyR3VpZGUt",productTourTooltip:"TourGuide_productTourTooltip_1GKlK_VyR3VpZGUt",minContentArea:"TourGuide_minContentArea_2z4RZ_VyR3VpZGUt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.SfdcTourService=t.TOUR_NAMES=t.TOURS_NAMES=void 0;const n=s(2);const r=s(9);const a=s(61);const c=s(73);Object.defineProperty(t,"TOURS_NAMES",{enumerable:true,get:function(){return c.TOURS_NAMES}});Object.defineProperty(t,"TOUR_NAMES",{enumerable:true,get:function(){return c.TOUR_NAMES}});const l=s(48);let u=class e{constructor(){this.isPerformingAction=false;this.handleContinuationResponse=(e,t,s)=>{var i,o;this.continuationResponses.push(e);(i=this.productTourService)===null||i===void 0?void 0:i.track("continuation-response",{question:e,answer:t});if(s){this.exitTour();(o=this.productTourService)===null||o===void 0?void 0:o.startTourFromBeginning(s)}else if(t==="yes"){this.nextStep(this.tourName)}else{this.exitTour()}};this.continuationResponses=[];this.sessionTriggeredTours=[];Promise.resolve().then((()=>s(85))).then((({ProductTourService:e})=>{this.productTourService=a.container.get(e)}));Promise.resolve().then((()=>s(673))).then((({SchedulerStore:e})=>{this.schedulerStore=a.container.get(e)}))}get tourName(){var e,t;return(t=(e=this.productTourService)===null||e===void 0?void 0:e.currentStep)===null||t===void 0?void 0:t.tourName}get isSfdcTourActive(){var e;return(e=this.tourName)===null||e===void 0?void 0:e.startsWith("sfdc")}get trigger(){var e,t;return(t=(e=this.productTourService)===null||e===void 0?void 0:e.currentStep)===null||t===void 0?void 0:t.trigger}get currentStepContext(){var e,t;return(t=(e=this.productTourService)===null||e===void 0?void 0:e.currentStep)===null||t===void 0?void 0:t.context}get isNullStep(){var e,t;return((t=(e=this.productTourService)===null||e===void 0?void 0:e.currentStep)===null||t===void 0?void 0:t.noTip)&&this.productTourService.currentStep.selector===""&&this.productTourService.currentStep.analyticsTag==="wait-null-step"}nextStep(e){var t;const s=e||this.tourName;if(s){(t=this.productTourService)===null||t===void 0?void 0:t.nextStep(s)}}handleScheduledRunTour(){if(this.tourName===c.TOUR_NAMES.SFDC_RUN_AND_SCHEDULE){if(this.isNullStep){this.nextStep()}else{this.startTourOncePerSession(c.TOUR_NAMES.SFDC_ACTIVATE_SCHEDULED_RUN)}return}if(this.tourName===c.TOUR_NAMES.SFDC_ACTIVATE_SCHEDULED_RUN&&this.isNullStep&&!this.isPerformingAction){this.isPerformingAction=true;(async e=>{if(!e){this.isPerformingAction=false;return}await e.sfdcCreateFirstScheduler();const t=(await e.list)[0];if(t&&!t.enabled){this.nextStep()}else{this.exitTour()}this.isPerformingAction=false})(this.schedulerStore)}}startTourOncePerSession(e){var t;if(this.sessionTriggeredTours.includes(e)){return}this.sessionTriggeredTours.push(e);(t=this.productTourService)===null||t===void 0?void 0:t.startTourFromBeginning(e)}startPendingTour(e,t){if(!(e===null||e===void 0?void 0:e.length)){this.startTourOncePerSession(c.TOUR_NAMES.SFDC_MISSING_ENVIRONMENT);return}if(!(t===null||t===void 0?void 0:t.length)){this.startTourOncePerSession(c.TOUR_NAMES.SFDC_MISSING_PERSONA)}}continueAfterNullStep(){if(this.isNullStep){this.nextStep(this.tourName)}}startTourFromStep(e,t){var s,i;(s=this.productTourService)===null||s===void 0?void 0:s.startTourFromBeginning(e);const o=c.TOURS[e].steps.map((e=>e.analyticsTag)).indexOf(t);(i=this.productTourService)===null||i===void 0?void 0:i.gotoStep(e,o)}isSelectorOfCurrentStep(e){var t,s;return(s=(t=this.productTourService)===null||t===void 0?void 0:t.currentStep)===null||s===void 0?void 0:s.selector.includes(e||"<#>")}advanceToNextStep(){var e;if(!this.isSfdcTourActive){return}(e=this.productTourService)===null||e===void 0?void 0:e.endCurrentStep()}exitTour(){var e;if(this.tourName){(e=this.productTourService)===null||e===void 0?void 0:e.stopTour(this.tourName)}}handleActionCallback(e){const t={nextTourStep:this.nextStep,exitTour:this.exitTour};t[e]()}hasRespondedToContinuation(e){return this.continuationResponses.includes(e)}environmentCreationFinalize(e){var t;if(this.tourName&&e){if(e==="success"){this.nextStep(this.tourName);return}(t=this.productTourService)===null||t===void 0?void 0:t.prevStep(this.tourName)}}};t.SfdcTourService=u;i([n.observable,o("design:type",Boolean)],u.prototype,"isPerformingAction",void 0);i([n.computed,o("design:type",Object),o("design:paramtypes",[])],u.prototype,"tourName",null);i([n.computed,o("design:type",Object),o("design:paramtypes",[])],u.prototype,"isSfdcTourActive",null);i([n.computed,o("design:type",Object),o("design:paramtypes",[])],u.prototype,"trigger",null);i([n.computed,o("design:type",Object),o("design:paramtypes",[])],u.prototype,"currentStepContext",null);i([n.computed,o("design:type",Object),o("design:paramtypes",[])],u.prototype,"isNullStep",null);t.SfdcTourService=u=i([(0,r.injectable)(),(0,l.exposeGlobally)("sfdcTourService"),o("design:paramtypes",[])],u)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E,I,C,D,O;Object.defineProperty(t,"__esModule",{value:true});t.TestListService=void 0;const A=s(6);const j=s(66);const w=s(193);const R=s(254);const P=s(681);const x=s(7);const M=s(5);const N=s(45);const F=s(130);const L=s(49);const k=s(119);const B=s(29);const U=s(21);const G=s(15);const V=s(34);const H=s(14);const $=s(167);const W=s(67);const J=s(28);const Y=s(79);const z=s(682);const q=s(128);const X=s(9);const Z=s(43);const Q=s(100);const K=s(255);const ee=s(92);const te=s(84);const se=s(234);const ie=s(2);const oe=s(27);const ne=s(73);const re=s(85);const ae=s(683);const ce=s(26);const le=s(104);const ue=s(764);const de=s(82);const pe=s(55);const he=M.commonConstants.scenario;const fe=x.Logger.getLogger("test-list-srv");let me=class e{constructor(e,t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_){this.applitoolsService=e;this.projectsService=t;this.playbackStore=s;this.userService=i;this.editedTestStore=o;this.branchesService=n;this.analyticsService=r;this.labelsStore=a;this.extensionService=c;this.restrictToChrome=l;this.featureFlagsService=u;this.modalService=d;this.saveUtils=p;this.foldersStore=h;this.recordingStore=f;this.productTourService=m;this.stepLoader=g;this.urlStateService=v;this.setupMobileTestStore=S;this.premiumFeaturesService=y;this.testResultListenerService=_;this._testList=null;this.loadUtils=new Q.LoadUtils(Z.testimServicesSingleton);b.addCommandBinding(b.GLOBAL_LAYER,"new test",(()=>this.createNewTest()));n.on(he.CURRENT_BRANCH_UPDATE,(()=>this.loadTestList()));this.editedTestStore.on(he.TEST_SAVED,(()=>this.loadTestList()));if(n.isListInitialized()){this.loadTestList()}(0,ie.reaction)((()=>this._testList),(()=>this.testsContainingApplitoolsSteps=undefined))}getTestList(){return this._testList}get testList(){return(0,oe.fromPromise)(this.getTestListAsync())}get testsMap(){return new Map(this.testList.case({rejected:()=>[],pending:()=>[],fulfilled:e=>e.map((e=>[e._id,e]))}))}async getTestListAsync(e=false){const t=e?await this.foldersStore.updateTestList():await this.foldersStore.testsFoldersTree;const s=t.tests.map((e=>Object.assign(e,{id:e._id||e.id})));this._testList=A.sortBy(s,["name"]);return this._testList}processTestListFromCallback(e){const t=async()=>{const t=await e();return A(t).map((e=>({...e,id:e._id}))).sortBy(["name"]).value()};return(0,oe.fromPromise)(t(),oe.fromPromise.resolve([]))}get leanTestList(){return this.processTestListFromCallback((()=>Z.testimServicesSingleton.test.getAllLean(this.projectsService.projectId,this.branchesService.branch)))}leanExecutedTestListByTimePeriod(e,t){return this.processTestListFromCallback((()=>Z.testimServicesSingleton.result.getExecutedTestListByTimePeriod(this.projectsService.projectId,e,t)))}async loadTestList(){const e=Date.now();await this.branchesService.waitForBranchesReady();const t=this.projectsService.projectId;if(!t){fe.warn("attempted to run loadTestList with falsy projectId",{projectId:t});return}const s=this.branchesService.branch;const i=await this.getTestListAsync(true);if(this.branchesService.branch!==s){return}const o=Date.now()-e;if(o>1e3*10){fe.log(`Get all tests for project ${t} took ${o/1e3} seconds`,{projectId:t,branch:s})}this._testList=A.sortBy(i,["name"]);this.analyticsService.reportTestsCount(this._testList.length)}async warnBeforeDiscardingTest(){const e=this.editedTestStore.shouldTestBeSaved;const t=this.playbackStore.isPlaying;if(!e&&!t){return true}let s;if(t){this.playbackStore.startNewTestWhileTestIsRunning();s=await this.modalService.openModal(ue.TestIsRunningModal).promise}else{s=await this.modalService.openModal(N.MessageModal,{title:"Unsaved changes",body:"Discard current changes?",okText:"Ok",cancelText:"Cancel",className:P.default.discardTestModal}).promise}return Boolean(s)}async createNewTestWithoutExtensionCheck(e){if(await this.warnBeforeDiscardingTest()){this.stepLoader.createAndGoToNewTest({parentFolderId:e,checkExtensionExists:false})}}async createNewTest(e,t){var s;const i=this.featureFlagsService.flags.verboseNewTestLogs.isEnabled()?fe:{log:A.noop};i.log("create new test",{projectId:this.projectsService.projectId,branch:this.branchesService.branch,parentFolderId:t});(s=e===null||e===void 0?void 0:e.preventDefault)===null||s===void 0?void 0:s.call(e);try{await this.restrictToChrome.restrict();if(this.premiumFeaturesService.isTtaSfdcEnabled){this.createNewTestWithoutExtensionCheck(t);return}const{extensionInstalled:e}=await this.extensionService.validateInExtension(false);if(e){const e=j.test(this.projectsService.projectId,this.branchesService.branch,"new",undefined,t);i.log("navigating to test url",{testUrl:e,location:window.location.href});this.urlStateService.go(e);i.log("reloading");window.location.reload()}else{const e=await this.warnBeforeDiscardingTest();if(this.productTourService.isTourRunning(ne.TOUR_NAMES.FIRST_TEST)){this.analyticsService.track("tour-add-test");this.productTourService.startTourOncePerUser(ne.TOUR_NAMES.START_RECORDING,{autoStop:true})}if(e){this.setupMobileTestStore.reset();await this.stepLoader.createAndGoToNewTest({parentFolderId:t})}}}catch(e){fe.warn("failed to create new test",e)}}addLabelToTestsByIds(e,t){const s=this._testList.filter((t=>e.includes(t.id||t._id)));if(!s.length){const t=e.filter((e=>this._testList.filter((t=>(t.id||t._id)===e)).length===0));t.forEach((e=>s.push({id:e,labels:[]})))}const i=this.calculateTestsToAddLabels(s,t);if(!i){return[]}return this.addLabelToTests(i,t)}removeLabelFromTestsByIds(e,t){const s=this._testList.filter((t=>e.includes(t.id||t._id)));return this.removeLabelFromTests(s,t)}async removeLabelFromTests(e,t){const s=e.filter((e=>!A.isEmpty(e.labels)));s.forEach((e=>this.recordingStore.removeLabelFromTest(e,t)));await this.pruneTestsLabel(s.map((e=>e.id||e._id)),t);e.forEach((e=>{if(e.labels){e.labels=e.labels.filter((e=>e!==t))}}))}removeLabelsFromTests(e,t){t.forEach((t=>{this.removeLabelFromTests(e,t)}))}updateTestsLabel(e,t){return Z.testimServicesSingleton.test.updateTestsLabel(e,t,this.projectsService.projectId)}pruneTestsLabel(e,t){return Z.testimServicesSingleton.test.pruneTestsLabel(e,t,this.projectsService.projectId)}async loadTest(e,t){var s,i,o;t===null||t===void 0?void 0:t.preventDefault();const n=this.editedTestStore.testId;const r=this.projectsService.projectId;const a=e._id||e.id;if(n===a){const e=((s=this.editedTestStore.scenario)===null||s===void 0?void 0:s.isNew)&&((i=this.editedTestStore.scenario)===null||i===void 0?void 0:i.steps.length);const t=e||await this.modalService.openModal(N.MessageModal,{title:"Back to opened test?",body:"You are trying to reopen a test that is already open in the Editor.",okText:"Yes, take me to the editor",cancelText:"No, discard and reload",className:P.default.backToOpenedTestModal,considerDiscardAsCancel:false}).promise;if(t===undefined){return}if(t===false){if((o=this.editedTestStore.test)===null||o===void 0?void 0:o.resultId){this.testResultListenerService.leaveTestResult(this.editedTestStore.test.resultId,this.editedTestStore.test.id)}this.playbackStore.resetPlayingState();this.editedTestStore.reset()}this.analyticsService.userClickedOnTest({originLocation:"testsTestList",testId:a,openType:"modal"});this.urlStateService.go(j.test(r,this.branchesService.branch,a))}else{const e=await this.warnBeforeDiscardingTest();if(e){this.analyticsService.userClickedOnTest({originLocation:"testsTestList",testId:a});this.urlStateService.go(j.test(r,this.branchesService.branch,a))}}}async saveTestClone(e,t,s,i){const o=await w.cloneExistingTest(s,t.name,i,t.description);const n=await this.saveUtils.saveRecording(e,{},o,o.scenario,o.testConfig,i.uid,o.customTestData,this.branchesService.branch);this.branchesService.saveLatestRevision(o.id,o.revisions.latest);await this.loadTestList();return n}async cloneTests(e){const t=e.map((e=>Object.assign(e,{id:e.id||e._id})));this.analyticsService.track("cloning-tests",{cloneCount:t.length});let s;if(t.length===1){const e=await this.modalService.openFormModal({header:"Clone Test",items:{name:{props:{autoFocus:true,placeholder:`e.g. Copy of ${t[0].name}`},type:"textbox",label:"Name",value:`Copy of ${t[0].name}`,validate:e=>e?undefined:"Please provide a name"}},okText:"Clone",className:R.default.cloneSingleModal,subHeader:"The test and all its steps will be cloned. Shared steps/groups \n will remain shared."}).promise;if(!e){return undefined}s=[{id:t[0].id,name:e.name,description:t[0].description}]}else{const e=await this.modalService.openModal(K.CloneModal,{resourceCount:t.length,resourceName:"tests",subHeader:"The tests and their steps will be cloned. Shared steps/groups will remain shared.",title:"Clone Tests"}).promise;if(!e){return undefined}s=t.map((e=>({id:e.id,name:`Copy of ${e.name}`,description:e.description})))}if(!s){return undefined}try{const e=async e=>{const t=await this.loadUtils.loadTestComplete(e.id,null,null,this.branchesService.branch,this.projectsService.projectId,this.featureFlagsService.flags.loadTestUseBranchMap.isEnabled());return this.saveTestClone(this.projectsService.projectId,e,t,this.userService.getLoggedUserInfo())};const t=await Promise.allSettled(s.map(e));await this.loadTestList();return{reloadTestList:true,newTestsIds:t.map((e=>{if(e.status==="rejected"){fe.error("Error while cloning test",e.reason);this.modalService.openToast(W.Toast,{children:"Failed to clone test",timeout:4e3,icon:{type:"failed",backgroundType:"error"}});return undefined}this.modalService.openToast(W.Toast,{children:`successfully cloned test ${e.value.serializedTest.name}}`,timeout:4e3,icon:{type:"V",backgroundType:"success"}});return e.value.serializedTest._id||e.value.serializedTest.id}))}}catch(e){fe.error("Error while cloning test",e);return undefined}}calculateTestsToAddLabels(e,t){return e.filter((e=>{var s;return!((s=e.labels)===null||s===void 0?void 0:s.includes(t))}))}async addLabelToTests(e,t){e.forEach((e=>{this.recordingStore.addLabelToTest(e,t)}));await Promise.all([this.updateTestsLabel(e.map((e=>e.id||e._id)),t),this.labelsStore.addLabels([t])]);e.forEach((e=>{e.labels=A.uniq(e.labels.concat(t))}))}addLabelsToTests(e,t){t.forEach((t=>{this.addLabelToTests(e,t)}))}async getTestsContainingStep(e){return Z.testimServicesSingleton.sharedSteps.getAllTestsContainingStep(this.projectsService.projectId,this.branchesService.branch,e)}async updateTestsContainingApplitoolsStep(){if(!this.applitoolsService.isApplitoolsEnabled||this.testsContainingApplitoolsSteps){return}const e=this.projectsService.projectId;const t=this.branchesService.branch;try{const s=await Z.testimServicesSingleton.test.getAllTestsContainingApplitoolsStep(e,t);this.testsContainingApplitoolsSteps=s}catch(s){fe.error("Failed loading applitools filters",{projectId:e,branch:t,err:s});throw s}}};t.TestListService=me;i([ie.observable.ref,o("design:type",Object)],me.prototype,"testsContainingApplitoolsSteps",void 0);i([ie.observable.ref,o("design:type",Object)],me.prototype,"_testList",void 0);i([ie.computed,o("design:type",Object),o("design:paramtypes",[])],me.prototype,"testList",null);i([ie.computed,o("design:type",typeof(O=typeof Map!=="undefined"&&Map)==="function"?O:Object),o("design:paramtypes",[])],me.prototype,"testsMap",null);i([ie.computed,o("design:type",Object),o("design:paramtypes",[])],me.prototype,"leanTestList",null);t.TestListService=me=i([(0,X.injectable)(),o("design:paramtypes",[typeof(n=typeof F.ApplitoolsService!=="undefined"&&F.ApplitoolsService)==="function"?n:Object,typeof(r=typeof G.ProjectsService!=="undefined"&&G.ProjectsService)==="function"?r:Object,typeof(a=typeof le.PlaybackStore!=="undefined"&&le.PlaybackStore)==="function"?a:Object,typeof(c=typeof L.UserService!=="undefined"&&L.UserService)==="function"?c:Object,typeof(l=typeof B.EditedTestStore!=="undefined"&&B.EditedTestStore)==="function"?l:Object,typeof(u=typeof V.BranchesService!=="undefined"&&V.BranchesService)==="function"?u:Object,typeof(d=typeof U.AnalyticsService!=="undefined"&&U.AnalyticsService)==="function"?d:Object,typeof(p=typeof z.LabelsStore!=="undefined"&&z.LabelsStore)==="function"?p:Object,typeof(h=typeof Y.ExtensionService!=="undefined"&&Y.ExtensionService)==="function"?h:Object,typeof(f=typeof q.RestrictToChrome!=="undefined"&&q.RestrictToChrome)==="function"?f:Object,typeof(m=typeof H.FeatureFlagsService!=="undefined"&&H.FeatureFlagsService)==="function"?m:Object,typeof(g=typeof J.ModalService!=="undefined"&&J.ModalService)==="function"?g:Object,typeof(v=typeof $.SaveUtils!=="undefined"&&$.SaveUtils)==="function"?v:Object,typeof(S=typeof ee.FoldersStore!=="undefined"&&ee.FoldersStore)==="function"?S:Object,typeof(y=typeof te.RecordingStore!=="undefined"&&te.RecordingStore)==="function"?y:Object,typeof(b=typeof re.ProductTourService!=="undefined"&&re.ProductTourService)==="function"?b:Object,typeof(_=typeof ae.StepLoader!=="undefined"&&ae.StepLoader)==="function"?_:Object,typeof(T=typeof ce.UrlStateService!=="undefined"&&ce.UrlStateService)==="function"?T:Object,typeof(E=typeof de.SetupMobileTestStore!=="undefined"&&de.SetupMobileTestStore)==="function"?E:Object,typeof(I=typeof pe.PremiumFeaturesService!=="undefined"&&pe.PremiumFeaturesService)==="function"?I:Object,typeof(C=typeof k.KeyInputService!=="undefined"&&k.KeyInputService)==="function"?C:Object,typeof(D=typeof se.TestResultListenerService!=="undefined"&&se.TestResultListenerService)==="function"?D:Object])],me)},function(e,t,s){"use strict";s.r(t);t["default"]={icon:"CloneModal_icon_3lSsU_5lTW9kYWwt","icon-with-gradient":"CloneModal_icon-with-gradient_2AYUp_5lTW9kYWwt",iconWithGradient:"CloneModal_icon-with-gradient_2AYUp_5lTW9kYWwt",modal:"CloneModal_modal_10y2x_5lTW9kYWwt",bodyText:"CloneModal_bodyText_2ce7M_5lTW9kYWwt",iconContainer:"CloneModal_iconContainer_2YxOL_5lTW9kYWwt",cloneSingleModal:"CloneModal_cloneSingleModal_3L_aJ_5lTW9kYWwt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CloneModal=void 0;const i=s(4);const o=s(0);const n=s(31);const r=s(16);const a=s(30);const c=s(254);const l=({closeModal:e,resourceCount:t,resourceName:s,subHeader:o,title:l})=>(0,i.jsxs)(a.BaseModal,{closeModal:()=>e(),className:c.default.modal,subHeader:o,header:(0,i.jsx)("h3",{children:l}),footer:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.Cta,{onClick:()=>e(true),children:"CLONE"}),(0,i.jsx)(n.Cta,{variety:"secondary",onClick:()=>e(),children:"CANCEL"})]}),children:[(0,i.jsx)("div",{className:c.default.iconContainer,children:(0,i.jsx)(r.Icon,{className:c.default.icon,icon:"clone-full"})}),(0,i.jsxs)("div",{className:c.default.bodyText,children:[(0,i.jsx)("div",{children:`You are about to clone the ${t} selected ${s}.`}),(0,i.jsx)("div",{children:`The new ${s} names will include Copy of and the original name.`})]})]});t.CloneModal=l;l.displayName="CloneModal"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(705),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IOS_VERSION_NAMES=t.IOS_DEVICE_NAME=t.CHROME_EMULATION_DEVICE_NAME=t.BROWSER_OPTIONS=void 0;t.BROWSER_OPTIONS=[{name:"Chrome",value:"chrome"},{name:"Chrome one version back",value:"chrome-one-version-back"},{name:"Chrome two versions back",value:"chrome-two-versions-back"},{name:"Firefox",value:"firefox"},{name:"Firefox one version back",value:"firefox-one-version-back"},{name:"Firefox two versions back",value:"firefox-two-versions-back"},{name:"IE 11",value:"ie"},{name:"IE 10",value:"ie10"},{name:"Edge",value:"edgelegacy"},{name:"Edge Chromium",value:"edgechromium"},{name:"Edge Chromium one version back",value:"edgechromium-one-version-back"},{name:"Edge Chromium two versions back",value:"edgechromium-two-versions-back"},{name:"Safari",value:"safari"},{name:"Safari early access",value:"safari-earlyaccess"},{name:"Safari one version back",value:"safari-one-version-back"},{name:"Safari two version back",value:"safari-two-versions-back"}];t.CHROME_EMULATION_DEVICE_NAME=[{name:"Blackberry PlayBook",value:"Blackberry PlayBook"},{name:"BlackBerry Z30",value:"BlackBerry Z30"},{name:"Galaxy A5",value:"Galaxy A5"},{name:"Galaxy Note 10",value:"Galaxy Note 10"},{name:"Galaxy Note 10 Plus",value:"Galaxy Note 10 Plus"},{name:"Galaxy Note 2",value:"Galaxy Note 2"},{name:"Galaxy Note 3",value:"Galaxy Note 3"},{name:"Galaxy Note 4",value:"Galaxy Note 4"},{name:"Galaxy Note 8",value:"Galaxy Note 8"},{name:"Galaxy Note 9",value:"Galaxy Note 9"},{name:"Galaxy S3",value:"Galaxy S3"},{name:"Galaxy S5",value:"Galaxy S5"},{name:"Galaxy S8",value:"Galaxy S8"},{name:"Galaxy S8 Plus",value:"Galaxy S8 Plus"},{name:"Galaxy S9",value:"Galaxy S9"},{name:"Galaxy S9 Plus",value:"Galaxy S9 Plus"},{name:"Galaxy S10",value:"Galaxy S10"},{name:"Galaxy S10 Plus",value:"Galaxy S10 Plus"},{name:"Galaxy S20",value:"Galaxy S20"},{name:"Galaxy S22",value:"Galaxy S22"},{name:"iPad",value:"iPad"},{name:"iPad 6th Gen",value:"iPad 6th Gen"},{name:"iPad 7th Gen",value:"iPad 7th Gen"},{name:"iPad Air 2",value:"iPad Air 2"},{name:"iPad Mini",value:"iPad Mini"},{name:"iPad Pro",value:"iPad Pro"},{name:"iPhone 11",value:"iPhone 11"},{name:"iPhone 11 Pro",value:"iPhone 11 Pro"},{name:"iPhone 11 Pro Max",value:"iPhone 11 Pro Max"},{name:"iPhone 4",value:"iPhone 4"},{name:"iPhone 5/SE",value:"iPhone 5/SE"},{name:"iPhone 6/7/8",value:"iPhone 6/7/8"},{name:"iPhone 6/7/8 Plus",value:"iPhone 6/7/8 Plus"},{name:"iPhone X",value:"iPhone X"},{name:"iPhone XR",value:"iPhone XR"},{name:"iPhone XS",value:"iPhone XS"},{name:"iPhone XS Max",value:"iPhone XS Max"},{name:"Kindle Fire HDX",value:"Kindle Fire HDX"},{name:"Laptop with HiDPI screen",value:"Laptop with HiDPI screen"},{name:"Laptop with MDPI screen",value:"Laptop with MDPI screen"},{name:"Laptop with touch",value:"Laptop with touch"},{name:"LG G6",value:"LG G6"},{name:"LG Optimus L70",value:"LG Optimus L70"},{name:"Microsoft Lumia 550",value:"Microsoft Lumia 550"},{name:"Microsoft Lumia 950",value:"Microsoft Lumia 950"},{name:"Nexus 10",value:"Nexus 10"},{name:"Nexus 4",value:"Nexus 4"},{name:"Nexus 5",value:"Nexus 5"},{name:"Nexus 5X",value:"Nexus 5X"},{name:"Nexus 6",value:"Nexus 6"},{name:"Nexus 6P",value:"Nexus 6P"},{name:"Nexus 7",value:"Nexus 7"},{name:"Nokia Lumia 520",value:"Nokia Lumia 520"},{name:"Nokia N9",value:"Nokia N9"},{name:"OnePlus 7T",value:"OnePlus 7T"},{name:"OnePlus 7T Pro",value:"OnePlus 7T Pro"},{name:"Pixel 2",value:"Pixel 2"},{name:"Pixel 2 XL",value:"Pixel 2 XL"},{name:"Pixel 3",value:"Pixel 3"},{name:"Pixel 3 XL",value:"Pixel 3 XL"},{name:"Pixel 4",value:"Pixel 4"},{name:"Pixel 4 XL",value:"Pixel 4 XL"},{name:"Pixel 5",value:"Pixel 5"}];t.IOS_DEVICE_NAME=[{name:"iPhone 12 Pro Max",value:"iPhone 13 Pro Max",supportedIosVersions:["latest"]},{name:"iPhone 13 Pro",value:"iPhone 13 Pro",supportedIosVersions:["latest"]},{name:"iPhone 13",value:"iPhone 13",supportedIosVersions:["latest"]},{name:"iPhone 12 Pro Max",value:"iPhone 12 Pro Max",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 12 Pro",value:"iPhone 12 Pro",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 12",value:"iPhone 12",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 12 mini",value:"iPhone 12 mini",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 11 Pro Max",value:"iPhone 11 Pro Max",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 11 Pro",value:"iPhone 11 Pro",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 11",value:"iPhone 11",supportedIosVersions:["latest","latest-1"]},{name:"iPhone XR",value:"iPhone XR",supportedIosVersions:["latest","latest-1"]},{name:"iPhone Xs",value:"iPhone Xs",supportedIosVersions:["latest","latest-1"]},{name:"iPhone X",value:"iPhone X",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 8",value:"iPhone 8",supportedIosVersions:["latest","latest-1"]},{name:"iPhone 7",value:"iPhone 7",supportedIosVersions:["latest","latest-1"]},{name:"iPad Pro",value:"iPad Pro (12.9-inch) (3rd generation)",supportedIosVersions:["latest","latest-1"]},{name:"iPad 7th Gen",value:"iPad (7th generation)",supportedIosVersions:["latest","latest-1"]},{name:"iPad Air 2",value:"iPad Air (2nd generation)",supportedIosVersions:["latest","latest-1"]}];t.IOS_VERSION_NAMES=[{name:"Latest",value:"latest"},{name:"One version back",value:"latest-1"}]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NativeEventsSection=void 0;const i=s(4);const o=s(12);const n=s(10);const r=s(56);const a=s(74);const c=s(40);const l=s(44);const u=s(21);const d=s(11);const p=s(78);const h=[{name:"Native click event",value:true},{name:"Non-native click event",value:false}];t.NativeEventsSection=(0,o.observer)((({config:e,showHeader:t,onChange:s})=>{const f=(0,d.useDependencyInjector)(u.AnalyticsService);const m=(0,o.useLocalStore)((e=>({get isEnabled(){const{nativeEvents:t}=e.config;return t!==undefined&&t!=="inherit"},get currentOption(){return h.find((t=>t.value===e.config.nativeEvents))},update(t){var s;if(e.config instanceof p.TestConfig){e.config.update(t);return}(s=e.onChange)===null||s===void 0?void 0:s.call(e,t)},apply(e){const{checked:t}=e.target;this.update({nativeEvents:t?true:"inherit"});this.sendAnalytics(t?"native":"inherit")},selectType({value:e}){this.update({nativeEvents:e});this.sendAnalytics(e?"native":"non-native")},sendAnalytics(e){f.track("click-native-config",{nativeState:e})}})),{config:e,onChange:s});return(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)("div",{className:(0,n.default)(r.default.separator,r.default.reduceMarginBottom,r.default.subHeader),children:"Native events"}),(0,i.jsx)(l.FieldLabel,{children:(0,i.jsx)(a.Checkbox,{checked:m.isEnabled,onChange:m.apply,children:"Apply to click steps"})}),m.isEnabled&&(0,i.jsxs)(l.FieldLabel,{className:r.default.formLabel,children:[(0,i.jsx)("span",{children:"Click event type"}),(0,i.jsx)(c.Dropdown,{searchable:false,appendToBody:true,options:h,value:m.currentOption,onChange:m.selectType})]})]})}));t.NativeEventsSection.displayName="NativeEventsSection"},function(e,t,s){"use strict";s.r(t);t["default"]={wrapper:"DeviceList_wrapper_1hBu__ljZUxpc3Qt",main:"DeviceList_main_28S2i_ljZUxpc3Qt",header:"DeviceList_header_2LyKQ_ljZUxpc3Qt",headerIcon:"DeviceList_headerIcon_1jVpj_ljZUxpc3Qt",deviceListHeader:"DeviceList_deviceListHeader_31f5z_ljZUxpc3Qt",list:"DeviceList_list_31kmV_ljZUxpc3Qt",deviceListRow:"DeviceList_deviceListRow_2wmX7_ljZUxpc3Qt",headerText:"DeviceList_headerText_Net1e_ljZUxpc3Qt",osVersion:"DeviceList_osVersion_32BD2_ljZUxpc3Qt",searchWrapper:"DeviceList_searchWrapper_1A8u5_ljZUxpc3Qt",search:"DeviceList_search_27ObA_ljZUxpc3Qt",loaderWrapper:"DeviceList_loaderWrapper_2E0yz_ljZUxpc3Qt",emptyStateWrapper:"DeviceList_emptyStateWrapper_2KhYT_ljZUxpc3Qt",emptyStateHeader:"DeviceList_emptyStateHeader_1vHQd_ljZUxpc3Qt",emptyStateSearch:"DeviceList_emptyStateSearch_1BS0T_ljZUxpc3Qt",emptyStateBody:"DeviceList_emptyStateBody_22hbG_ljZUxpc3Qt"}},function(e,t,s){"use strict";s.r(t);t["default"]={rulesWrapper:"RulesList_rulesWrapper_WrOjU_lnUnVsZXMt",disabled:"RulesList_disabled_14N2J_lnUnVsZXMt",tableContainer:"RulesList_tableContainer_2w8YO_lnUnVsZXMt",rowWrapper:"RulesList_rowWrapper_oMrLH_lnUnVsZXMt",tableRow:"RulesList_tableRow_3kbt0_lnUnVsZXMt",ruleName:"RulesList_ruleName_35R3y_lnUnVsZXMt",operator:"RulesList_operator_3qn7W_lnUnVsZXMt",tableHeader:"RulesList_tableHeader_37kV-_lnUnVsZXMt",iconColumn:"RulesList_iconColumn_1bM8o_lnUnVsZXMt",rulesDivider:"RulesList_rulesDivider_16KwT_lnUnVsZXMt",addRuleBtn:"RulesList_addRuleBtn_p4ErZ_lnUnVsZXMt",delete:"RulesList_delete_2dC5m_lnUnVsZXMt",trashIcon:"RulesList_trashIcon_3ZeOo_lnUnVsZXMt",loaderWrapper:"RulesList_loaderWrapper_1l86F_lnUnVsZXMt",textBox:"RulesList_textBox__JHDP_lnUnVsZXMt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestConfigForm=t.getFormItems=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(727);const a=s(10);const c=s(56);const l=s(120);const u=s(11);const d=s(0);const p=s(106);const h=s(15);const f=s(16);const m=s(37);const g=s(12);const v=s(133);const S=s(107);const y=s(256);const b=s(761);const _=s(258);const T=v.OSS.map((e=>({name:e.name,value:e})));const E=v.RESOLUTIONS.map((e=>({name:e.name,value:e})));const I={name:"Any version",value:"any-version"};const C={name:"Any device",value:"any-device"};const D=()=>(0,i.jsxs)("div",{className:c.default.warning,children:[(0,i.jsx)(f.Icon,{icon:"warning"}),(0,i.jsx)("span",{children:"Running from the editor will be only on Chrome"})]});D.displayName="BrowserTypeWarning";const O=({config:e,configListStore:t})=>{const s=E.find((t=>o.isMatch(t.value,e.resolution)))||e.resolution;const i=t.findBrowser(e.browser);const n=t.findOs(e.os);return Object.assign({},e,{browser:i,os:n,resolution:s,resolution_width:e.resolution.width,resolution_height:e.resolution.height,osVersion:I,device:C})};const A=(e,t)=>{var s,i,n;if(!t){return e}t=Object.assign({},t);if((s=t.browser)===null||s===void 0?void 0:s.value){t.stepTimeout=t.browser.value.stepTimeoutDefault;t.browser=t.browser.value.name}if((i=t.os)===null||i===void 0?void 0:i.value){t.os=t.os.value.name}if((n=t.resolution)===null||n===void 0?void 0:n.value){t.resolution=o.pick(t.resolution.value,["width","height"])}if(t.resolution_width){t.resolution={width:t.resolution_width,height:e.resolution.height}}if(t.resolution_height){t.resolution={width:e.resolution.width,height:t.resolution_height}}return Object.assign({},e,t)};const j=({opts:e,projectsService:t,configListStore:s,formValues:o})=>{var n,r,a;if(t.isMobile){return{device:{type:"dropdown",label:"Device name",labelProps:{className:c.default.formLabel},value:C,props:{options:[],searchable:false,appendToBody:true,disabled:true,containerClassName:c.default.dropdownContainer}},osVersion:{type:"dropdown",label:"OS version",labelProps:{className:c.default.formLabel},value:I,props:{options:[],searchable:false,appendToBody:true,disabled:true,containerClassName:c.default.dropdownContainer}}}}const l=s.browsers;const u={name:{type:"textbox",label:"Name",labelProps:{className:c.default.formLabel},props:{disabled:t.isMobileWeb},value:o.name},browser:{type:"dropdown",label:"Browser",labelProps:{className:c.default.formLabel},value:(n=l.find((({value:e})=>e===o.browser)))!==null&&n!==void 0?n:l[0],props:{options:l,searchable:false,appendToBody:true,disabled:e===null||e===void 0?void 0:e.disableBrowserAndOs,containerClassName:c.default.dropdownContainer}},browser_warning:(e===null||e===void 0?void 0:e.warnBrowserMismatch)?{type:"message",label:D}:{type:"empty"},os:{type:"dropdown",label:"Os",labelProps:{className:c.default.formLabel},value:(r=T.find((({value:e})=>e===o.os)))!==null&&r!==void 0?r:T[0],props:{options:T,searchable:false,appendToBody:true,disabled:e===null||e===void 0?void 0:e.disableBrowserAndOs,containerClassName:c.default.dropdownContainer}},os_warning:(e===null||e===void 0?void 0:e.warnBrowserMismatch)?{type:"message",props:{className:c.default.fullLabel},label:(0,i.jsxs)("div",{className:c.default.warning,children:[(0,i.jsx)(f.Icon,{icon:"warning"}),(0,i.jsx)("span",{children:"Running from the editor will be only on your computer OS"})]})}:{type:"empty"}};if((e===null||e===void 0?void 0:e.resolutionMode)==="textboxes"){Object.assign(u,{resolution_message:{type:"message",label:"Resolution",props:{className:c.default.fullLabel}},resolution_width:{type:"textbox",labelProps:{className:c.default.resolutionInput},value:o.resolution.width,props:{type:"number",disabled:t.isMobileWeb}},resolution_message1:{type:"message",label:"x",props:{className:c.default.resolutionX}},resolution_height:{type:"textbox",labelProps:{className:c.default.resolutionInput},value:o.resolution.height,props:{type:"number",disabled:t.isMobileWeb}}})}else{u.resolution={type:"dropdown",label:"Resolution",labelProps:{className:c.default.formLabel},value:(a=E.find((({value:e})=>e===o.resolution)))!==null&&a!==void 0?a:E[0],props:{options:E,searchable:false,appendToBody:true}}}return u};const w=()=>({general_message:{type:"message",label:"General",props:{className:(0,a.default)(c.default.separator,c.default.subHeader)}},stepTimeout:{type:"textbox",label:"Step timeout (ms)",labelProps:{className:c.default.formLabel},value:"",props:{type:"number"}},stepDelay:{type:"textbox",label:"Step delay (ms)",labelProps:{className:c.default.formLabel},value:"",props:{type:"number"}},setupStepTimeout:{type:"textbox",label:"Setup step timeout (ms)",labelProps:{className:c.default.formLabel},value:"",props:{type:"number"}}});const R=({editedSections:e,opts:t,projectsService:s,configListStore:i,formValues:o})=>{const n={};if(e.basic){Object.assign(n,j({opts:t,projectsService:s,configListStore:i,formValues:o}))}if(e.advanced){Object.assign(n,w())}return n};t.getFormItems=R;const P=new r({coerceTypes:true});const x=P.compile({type:"object",properties:{stepDelay:{type:"number"},stepTimeout:{type:"number"},setupStepTimeout:{type:"number"}}});t.TestConfigForm=(0,g.observer)((({editedConfig:e,editedSections:s,className:o,opts:n})=>{const r=(0,u.useDependencyInjector)(S.ConfigListStore);const f=(0,u.useDependencyInjector)(p.CustomReuseService);const g=(0,u.useDependencyInjector)(h.ProjectsService);const[v,T]=(0,d.useState)();const[E,I]=(0,d.useState)();const C=(0,d.useCallback)((({changes:t})=>{if(!t||!x(t)){return}T({...v,...t});const s=A(e,t);e.update(s)}),[e,v]);const D=(0,d.useCallback)((e=>C({changes:e})),[C]);(0,d.useEffect)((()=>{if(f.isSharedStepsReady){const i=O({config:e,configListStore:r});I((0,t.getFormItems)({projectsService:g,configListStore:r,editedSections:s,opts:n,formValues:i}));T(i)}}),[e,s,n,r,g,f.isSharedStepsReady]);if(!E||!v){return(0,i.jsx)("div",{className:c.default.loaderWrapper,children:(0,i.jsx)(m.Loader,{})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:c.default.spacer}),(0,i.jsx)(l.Form,{onChange:C,values:v,className:(0,a.default)(c.default.form,o),items:E}),s.nativeEvents&&(0,i.jsx)(_.NativeEventsSection,{showHeader:true,config:e}),s.hooks&&(0,i.jsx)(b.HooksSection,{config:e,className:(0,a.default)(c.default.form,o)}),s.applitools&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,a.default)(c.default.separator,c.default.reduceMarginBottom,c.default.subHeader),children:"Visual Validation"}),(0,i.jsx)(y.ApplitoolsSection,{config:v,onChange:D,tooltipsDirection:"topRight",className:o,environmentRowClassName:c.default.environmentRow})]}),(0,i.jsx)("div",{className:c.default.spacer})]})}));t.TestConfigForm.displayName="TestConfigForm"},,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HourGlass=t.TadaEmoji=t.RocketLaptop=t.PlusDocs=t.CogWheels=void 0;const i=s(4);const o=s(772);const n=s(773);const r=s(774);const a=s(775);const c=s(776);const l=s(777);const u=({onLoad:e,...t})=>(0,i.jsx)("div",{className:l.default.cogWheels,children:(0,i.jsx)("img",{src:r.default,onLoad:e,...t})});t.CogWheels=u;t.CogWheels.displayName="CogWheelsIllustration";const d=({onLoad:e,...t})=>(0,i.jsx)("div",{className:l.default.plusDocs,children:(0,i.jsx)("img",{src:n.default,onLoad:e,...t})});t.PlusDocs=d;t.PlusDocs.displayName="PlusDocsIllustration";const p=({onLoad:e,...t})=>(0,i.jsx)("div",{className:l.default.rocketLaptop,children:(0,i.jsx)("img",{src:o.default,onLoad:e,...t})});t.RocketLaptop=p;t.RocketLaptop.displayName="RocketLaptopIllustration";const h=({onLoad:e,...t})=>(0,i.jsx)("div",{className:l.default.tadaEmoji,children:(0,i.jsx)("img",{src:a.default,onLoad:e,...t})});t.TadaEmoji=h;t.TadaEmoji.displayName="TadaEmojiIllustration";const f=({onLoad:e,...t})=>(0,i.jsx)("div",{className:l.default.hourGlass,children:(0,i.jsx)("img",{src:c.default,onLoad:e,...t})});t.HourGlass=f;t.HourGlass.displayName="HourGlassIllustration"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(778),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.analyticsKeyLookup=t.toolTipTextLookup=t.branchLabelLookup=t.Branch=void 0;const i=s(315);Object.defineProperty(t,"Branch",{enumerable:true,get:function(){return i.Branch}});function o(e){const t={[i.Branch.Sobjects]:"Select the Object",[i.Branch.RecordTypes]:"Select Record Type",[i.Branch.QuickActions]:"Select Quick Action",[i.Branch.Apps]:"Select App",[i.Branch.RelatedLists]:"Select Related List",[i.Branch.Profiles]:"Select Profile"};return t[e]||"Make a selection"}t.branchLabelLookup=o;function n(e){const t={[i.Branch.Sobjects]:"Select the object you want to create",[i.Branch.RecordTypes]:"Select the type of record you want to create",[i.Branch.Apps]:"Select the App you want to launch"};return t[e]||"Make your selection"}t.toolTipTextLookup=n;function r(e){return`${e}-metadata-selection`}t.analyticsKeyLookup=r},function(e,t,s){"use strict";s.r(t);t["default"]={red:"#f66577",pink:"#f665cf",grey:"#9ea0ab",green:"#32b7a0",black:"#313131",orange:"#f9b256",blue:"#5b82eb",lime:"#82d945",turquoise:"#2dc1ff",fab:"annotate_fab_3up_D_5ub3RhdGUt",rectangle:"annotate_rectangle_20ycl_5ub3RhdGUt",stepCounter:"annotate_stepCounter_67OUG_5ub3RhdGUt",fabContent:"annotate_fabContent_1oxHv_5ub3RhdGUt",text:"annotate_text_1ajwK_5ub3RhdGUt",banner:"annotate_banner_2QIx8_5ub3RhdGUt",bannerText:"annotate_bannerText_3MwvN_5ub3RhdGUt",hide:"annotate_hide_21ivX_5ub3RhdGUt",annotate:"annotate_annotate_3tijf_5ub3RhdGUt",fabIcon:"annotate_fabIcon_2ke1k_5ub3RhdGUt",annotateMenu:"annotate_annotateMenu_JGg59_5ub3RhdGUt",menuItem:"annotate_menuItem_2CxQc_5ub3RhdGUt",last:"annotate_last_3hPew_5ub3RhdGUt",active:"annotate_active_2yF7v_5ub3RhdGUt",circle:"annotate_circle_24GGb_5ub3RhdGUt",delete:"annotate_delete_OFhM2_5ub3RhdGUt",colorTooltipHoverHelper:"annotate_colorTooltipHoverHelper_3f3hU_5ub3RhdGUt",colorPickerTooltip:"annotate_colorPickerTooltip_174gZ_5ub3RhdGUt",colorPicker:"annotate_colorPicker_2waZj_5ub3RhdGUt",color:"annotate_color_3FCJG_5ub3RhdGUt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(816),t);o(s(276),t)},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"1ac9cbab7a.png"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.GitHubIssue=void 0;const n=s(6);const r=s(2);const a=s(134);class c extends a.Issue{constructor(e){super();this.bugTracker="GitHub";this.repo=e.repo;this.summary=e.summary;this.description=e.description;this.stepImage=e.stepImage;this.resultImage=e.resultImage;if(e.bugTracker===this.bugTracker){this._savedModel=e.model}}get displayName(){return"New card"}get isValid(){return!(0,n.isEmpty)(this.model.selectedRepo)&&Boolean(this.description&&this.summary)}toDTO(){return{repoName:this.repo.name,repoOwner:this.repo.owner,summary:this.summary,description:this.description}}getfilledFields(){return Object.keys(this.toDTO())}}t.GitHubIssue=c;i([r.observable.ref,o("design:type",Object)],c.prototype,"repo",void 0);i([r.observable.ref,o("design:type",Array)],c.prototype,"repos",void 0);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],c.prototype,"isValid",null)},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"d6554fa87d.png"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(822),t);o(s(279),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getJiraEpicDataGetter=t.getJiraSprintDataGetter=t.getFieldType=t.JIRA_FIELD_NAMES=void 0;const i={user:n,labels:d,none:l,"multi-select-user":a,"multi-select":r,select:c,multiline:u};t.JIRA_FIELD_NAMES={epic:"com.pyxis.greenhopper.jira:gh-epic-link",sprint:"com.pyxis.greenhopper.jira:gh-sprint",textarea:"com.atlassian.jira.plugin.system.customfieldtypes:textarea",labels:"com.atlassian.jira.plugin.system.customfieldtypes:labels"};function o(e){const[t]=Object.entries(i).find((([,t])=>t(e)))||[""];return t}t.getFieldType=o;function n(e){var t;return((t=e.schema)===null||t===void 0?void 0:t.type)==="user"}function r(e){var t;return(t=e.operations)===null||t===void 0?void 0:t.find((e=>e==="add"))}function a(e){var t;return r(e)&&((t=e.schema)===null||t===void 0?void 0:t.items)==="user"}function c(e){var s,i;return(e.allowedValues||[]).length>0||((s=e.schema)===null||s===void 0?void 0:s.type)==="array"||((i=e.schema)===null||i===void 0?void 0:i.custom)===t.JIRA_FIELD_NAMES.epic}function l(e){var t;return((t=e.allowedValues)===null||t===void 0?void 0:t.length)===0}function u(e){var s,i,o;return((s=e.schema)===null||s===void 0?void 0:s.type)==="string"&&(((i=e.schema)===null||i===void 0?void 0:i.system)==="description"||((o=e.schema)===null||o===void 0?void 0:o.custom)===t.JIRA_FIELD_NAMES.textarea)}function d(e){var s;return e.key==="labels"||((s=e.schema)===null||s===void 0?void 0:s.custom)===t.JIRA_FIELD_NAMES.labels}function p(e,t){return async function(s){const i=`${e}rest/greenhopper/1.0/sprint/picker?query=${s}`;const o=await t.get(i);const n=o.data.suggestions||[];const r=o.data.allMatches||[];return n.concat(r)}}t.getJiraSprintDataGetter=p;function h(e,t){return async function(s){const i=`${e}rest/greenhopper/1.0/epics?maxResults=100&hideDone=true&searchQuery=${s}`;const o=await t.get(i);return o.data.epicLists.reduce(((e,t)=>e.concat(t.epicNames||[])),[])}}t.getJiraEpicDataGetter=h},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.JiraIssue=void 0;const n=s(6);const r=s(2);const a=s(134);class c extends a.Issue{constructor(e){super();this.bugTracker="Jira";this.type=null;this.description=e.description;this.summary=e.summary;if(e.bugTracker===this.bugTracker){this._savedModel=e.model}}get displayName(){return`${this.model.issuetype.name} ${this.key}`}set fields(e){this._fields=e}get fields(){return this._fields}get requiredFields(){return n.filter(this.fields,(e=>e.required))}get isValid(){const e=this.fields||{};const t=Object.keys(e).every((t=>{if(t.includes("customfield_"))return true;const s=!e[t].required||!n.isEmpty(this.model[t])||!n.isEmpty(this[t]);return s}));return t&&Boolean(this.summary)}toDTO(){const e=n.cloneDeep(this.model);const t={};t.summary=this.summary;Object.keys(e).filter((e=>this.fields[e]!==undefined)).forEach((s=>t[s]=l(this.fields[s],e[s])));return{fields:t}}getfilledFields(){return Object.keys(this.toDTO().fields)}}t.JiraIssue=c;i([r.computed,o("design:type",Object),o("design:paramtypes",[])],c.prototype,"displayName",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[Object])],c.prototype,"fields",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],c.prototype,"requiredFields",null);i([r.computed,o("design:type",Boolean),o("design:paramtypes",[])],c.prototype,"isValid",null);function l(e={},t={}){var s,i,o,n,r,a,c;if(((s=e.allowedValues)===null||s===void 0?void 0:s.length)===0){return undefined}if(((i=e.schema)===null||i===void 0?void 0:i.custom)==="com.pyxis.greenhopper.jira:gh-sprint"){return t.id}if(((o=e.schema)===null||o===void 0?void 0:o.custom)==="com.pyxis.greenhopper.jira:gh-epic-link"){return t.key}if(((n=e.schema)===null||n===void 0?void 0:n.type)==="array"&&Array.isArray(t)){if(((r=e.schema)===null||r===void 0?void 0:r.items)==="string"){return t.map((e=>e.label))}if(((a=e.schema)===null||a===void 0?void 0:a.items)==="option"){return t.map((e=>({value:e})))}if(((c=e.schema)===null||c===void 0?void 0:c.items)==="version"){return t.map((e=>({id:e})))}}return t}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(825),t);o(s(283),t)},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"63b9cd8778.png"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.SlackIssue=void 0;const n=s(6);const r=s(2);const a=s(134);class c extends a.Issue{constructor(e){super();this.bugTracker="Slack";this.channel=e.channel;this.summary=e.summary;this.description=e.description;this.stepImage=e.stepImage;this.resultImage=e.resultImage;if(e.bugTracker===this.bugTracker){this._savedModel=e.model}}get displayName(){return"New card"}get isValid(){return!(0,n.isEmpty)(this.channel)&&Boolean(this.description&&this.summary)}toDTO(){return{channel:this.channel,summary:this.summary,description:this.description,resultImage:this.resultImage,stepImage:this.stepImage}}getfilledFields(){return Object.keys(this.toDTO())}}t.SlackIssue=c;i([r.observable,o("design:type",String)],c.prototype,"channel",void 0);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],c.prototype,"isValid",null)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(827),t);o(s(286),t)},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"43d7447e2c.png"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.TrelloIssue=void 0;const n=s(6);const r=s(2);const a=s(134);class c extends a.Issue{constructor(e){super();this.bugTracker="Trello";this.listId=e.listId;this.summary=e.summary;this.description=e.description;if(e.bugTracker===this.bugTracker){this._savedModel=e.model}}get displayName(){return"New card"}get isValid(){return!(0,n.isEmpty)(this.listId)&&Boolean(this.description&&this.summary)}toDTO(){return{idList:this.listId,pos:"bottom",name:this.summary,desc:this.description,due:null}}getfilledFields(){return Object.keys(this.toDTO())}}t.TrelloIssue=c;i([r.observable,o("design:type",String)],c.prototype,"listId",void 0);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],c.prototype,"isValid",null)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(829),t)},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isLocalEnv=t.isProdEnv=t.getUserAgentInfo=t.getMajorVersion=t.os=t.getOS=t.isEdgeChromium=t.isChrome=t.isFirefox=t.browserName=t.browserVersion=t.hasStorage=t.getEnvName=t.isTouchDevice=t.isWindows=t.isMac=void 0;const i=s(94);const o=s(304);function n(){return navigator.platform.toUpperCase().includes("MAC")}t.isMac=n;function r(){return navigator.platform.toUpperCase().includes("WIN")}t.isWindows=r;function a(){return("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&window.innerHeight<600&&window.innerWidth<1024}t.isTouchDevice=a;function c(){return(0,i.getURLParameter)("env")||"prod"}t.getEnvName=c;function l(){let e=false;if(typeof window==="undefined"){return false}try{if(typeof window==="undefined"){return false}e=typeof window.localStorage==="object"&&typeof window.localStorage.getItem==="function"}catch(e){}return e}t.hasStorage=l;function u(){if(typeof window==="undefined"||!window.navigator||!window.navigator.userAgent){return{name:"unknown",version:"0"}}const e=navigator.userAgent;let t;let s=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(s[1])){t=/\brv[ :]+(\d+)/g.exec(e)||[];return{name:"IE",version:t[1]||""}}if(s[1]==="Chrome"){t=e.match(/\b(OPR|Edge|Edg)\/(\d+)/);if(t!=null){return{name:t[1].replace("OPR","Opera").replace(/Edg$/,"Edge"),version:t[2]}}}s=s[2]?[s[1],s[2]]:[navigator.appName,navigator.appVersion,"-?"];if((t=e.match(/version\/(\d+)/i))!=null)s.splice(1,1,t[1]);return{name:s[0],version:s[1]}}function d(){return u().version}t.browserVersion=d;function p(){return u().name.toLowerCase()}t.browserName=p;function h(){return p()==="firefox"}t.isFirefox=h;function f(){return p()==="chrome"}t.isChrome=f;function m(e){e||(e=u());const t=typeof e.version==="number"?Math.floor(e.version):Number(e.version.split(".")[0]);const s=e.name.toLowerCase()==="edge"&&t>=79;return s}t.isEdgeChromium=m;function g(){const e=o().os;return`${e.name} ${e.version}`}t.getOS=g;t.os=g;function v(e){return typeof e==="number"?Math.floor(e):Number(e.split(".")[0])}t.getMajorVersion=v;function S(){const e=new o;return e.getResult()}t.getUserAgentInfo=S;function y(){const e=c();return["prod","prod/"].includes(e)}t.isProdEnv=y;function b(){const e=c();return["local","local/"].includes(e)}t.isLocalEnv=b},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateSalesforceMfaSecret=t.findUniqueName=t.pluralize=t.valueContainsOnlyDigits=t.getSafeFileName=t.getNumberWithOrdinal=t.formatBytes=t.nFormatter=t.getElapsedTimeFromSeconds=t.numberWithCommas=t.validatePasswordStrength=t.validateEmail=t.toCamelCase=t.isLegalName=t.copyCurrentSelectionToClipboard=t.copyToClipboard=t.removeLeadAndTrailingQuotes=t.isTextExpression=t.combinePath=t.escapeAndRemoveQuotes=t.escapeText=t.escapeJSName=t.isValidParamName=t.jsVarNameValidator=t.get2xImage=t.encodeFilepath=t.isValidJavaScriptIdentifier=void 0;function i(e){const t=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|null|this|true|void|with|await|break|catch|class|const|false|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDF00-\uDF1C\uDF27\uDF30-\uDF45]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF1A]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFF1]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D3-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDF00-\uDF1C\uDF27\uDF30-\uDF50]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD46\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFF1]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF])*$/;return t.test(e)}t.isValidJavaScriptIdentifier=i;function o(e){const t=e.includes("\\");const s=t?"\\":"/";const i=e.lastIndexOf(s);const o=e.substr(0,i);const n=e.substr(i+1);const r=encodeURIComponent(n);const a=`${o}${s}${r}`;return a}t.encodeFilepath=o;function n(e){if(!e){return""}const t=e.substring(0,e.lastIndexOf("."));const s=e.substring(e.lastIndexOf("."));return`${t}@2x${s}`}t.get2xImage=n;const r=e=>["do","if","in","for","let","new","try","var","case","else","enum","eval","false","null","this","true","void","with","break","catch","class","const","super","throw","while","yield","delete","export","import","public","return","static","switch","typeof","default","extends","finally","package","private","continue","debugger","function","arguments","interface","protected","implements","instanceof"].includes(e);const a=e=>!/[$A-Z_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/.test(e[0]);t.jsVarNameValidator={isReservedWord:r,hasInvalidFirstLetter:a};function c(e){return e===l(e)}t.isValidParamName=c;function l(e){e||(e="param");function t(e){return e.replace(/[^$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc0-9\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19b0-\u19c0\u19c8\u19c9\u19d0-\u19d9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2-\u1cf4\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f1\ua900-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]/g,"_")}if(r(e)){e=`_${e}`}if(a(e)){e=`_${e}`}e=t(e);return e}t.escapeJSName=l;function u(e){return typeof e==="string"?`'${e.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}'`:e}t.escapeText=u;function d(e){return u(f(e))}t.escapeAndRemoveQuotes=d;function p(...e){const t=/^\/+(.*)/;const s=/\/+$/;function i(e,i,o){if(i){e=e.replace(t,"")}if(o){e=e.replace(s,"")}return e}return e.map(((e,t)=>i(String(e||""),t!==0,true))).join("/")}t.combinePath=p;function h(e){return Boolean(e&&(e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')||e.startsWith("`")&&e.endsWith("`")))}t.isTextExpression=h;function f(e){return h(e)?e.slice(1,e.length-1):e}t.removeLeadAndTrailingQuotes=f;const m=function(e=""){return navigator.clipboard.writeText(e)};t.copyToClipboard=m;const g=function(){let e=false;try{e=document.execCommand("copy")}catch(t){e=false}return e};t.copyCurrentSelectionToClipboard=g;function v(e){const t=[".","#","[","]","$","/"];const s=t.filter((t=>e.includes(t))).length;return s===0}t.isLegalName=v;function S(e){const t=/-|\s/gi;const s=/\w/;const i=e.split(t).reduce(((e,t,i)=>{let o=e;if(i===1){o=o.replace(s,(e=>e.toLowerCase()))}return o+t.replace(s,(e=>e.toUpperCase()))}));if(i===e){e=e.toLowerCase();return e.replace(s,(e=>e.toUpperCase()))}return i}t.toCamelCase=S;function y(e){const t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}t.validateEmail=y;function b(e,t=8){const s=()=>new RegExp(/\d+/).test(e);const i=()=>new RegExp(/[a-zA-Z]+/).test(e);const o=()=>new RegExp(/[`~\!@#\$%\^\&\*\(\)\-_\=\+\[\{\}\]\\\|;:'",<.>\/\?]+/).test(e);const n=()=>!new RegExp(/[\s]+/).test(e);const r=!e;const a=r||e.length<t;const c=r||!s()||!o();const l=r||!i();const u=r||!n();const d=!(a||c||l||u);return{tooShort:a,missingDigitsOrSymbols:c,missingLetters:l,hasSpaces:u,valid:d}}t.validatePasswordStrength=b;function _(e){const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return t.join(".")}t.numberWithCommas=_;function T(e=0){e=Math.floor(e);const t=Math.floor(e/3600);const s=Math.floor((e-t*3600)/60);let i=e-t*3600-s*60;i=Math.round(i*100)/100;let o=t>0?`${t<10?`0${t}`:t}:`:"";o+=s<10?`0${s}`:s;o+=`:${i<10?`0${i}`:i}`;return o}t.getElapsedTimeFromSeconds=T;function E(e,t){const s=["","K","M","G","T","P","E","Z","Y"];const i=e===0?e:Math.floor(Math.log(e)/Math.log(1e3));const o=parseFloat((e/1e3**i).toFixed(t));return`${o}${s[i]}`}t.nFormatter=E;function I(e,t,s){if(!e||e===0)return"0 Byte";const i=s?1024:1e3;const o=t+1||3;const n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];const r=Math.floor(Math.log(e)/Math.log(i));return`${parseFloat((e/i**r).toFixed(o))} ${n[r]}`}t.formatBytes=I;function C(e){const t=["th","st","nd","rd"];const s=e%100;return e+(t[(s-20)%10]||t[s]||t[0])}t.getNumberWithOrdinal=C;function D(e,t){const s=99;const i=t.length+1;const o=e.replace(/[/\\?%*:|"<>]/g,"-").slice(0,s-i);return`${o}.${t}`}t.getSafeFileName=D;const O=e=>/^[0-9]+$|^$/.test(e);t.valueContainsOnlyDigits=O;const A=(e,t)=>`${e===1||t.endsWith("s")?t:`${t}s`}`;t.pluralize=A;function j(e,t,s){s=String(s);if(!(e===null||e===void 0?void 0:e.length)||!t){return s}const i=e.map((e=>e[t]));let o;let n;const r=i.length;for(o=0;o<r;++o){if(o===0){n=s}else{n=`${s}_${o}`}if(!i.includes(n)){return n}}return`${s}_${o}`}t.findUniqueName=j;function w(e){if(!e.trim()){return"Missing key"}const t=e=>/^[\x00-\x7F]*$/.test(e);if(!t(e)){return"Key must be ASCII"}return undefined}t.validateSalesforceMfaSecret=w},,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.xpathOne=t.getElementTag=t.getElementXpath=t.parseBounds=t.parseBoundsFromElement=void 0;function i(e){const t=e.getAttribute("bounds");if(t){return o(t)}return{left:Number(e.getAttribute("x")),top:Number(e.getAttribute("y")),height:Number(e.getAttribute("height")),width:Number(e.getAttribute("width"))}}t.parseBoundsFromElement=i;function o(e){if(!(e===null||e===void 0?void 0:e.includes("]["))){return{left:0,top:0,width:0,height:0}}const t=/\[(\d+),(\d+)\]\[(\d+),(\d+)\]/g.exec(e);const s=Number(t[1]||"0");const i=Number(t[2]||"0");const o=Number(t[3]||"0");const n=Number(t[4]||"0");return{left:s,width:o-s,top:i,height:n-i}}t.parseBounds=o;function n(e){if(!e||e.nodeType!==1)return"";const t=r(e);const s=a(e);return`${n(e.parentNode)}/${t}${s}`}t.getElementXpath=n;function r(e){return e.getAttribute("node-name")||e.nodeName}t.getElementTag=r;function a(e){if(!e||e.nodeType!==1||typeof DocumentFragment!=="undefined"&&e.parentNode instanceof DocumentFragment||!e.parentNode){return""}const t=r(e);const s=Array.from(e.parentNode.children).map((e=>({tag:r(e),index:Number(e.getAttribute("index"))}))).sort(((e,t)=>e.index-t.index));let i=0;let o=false;let n=false;for(const r of s){if(o&&n){break}if(Number(e.getAttribute("index"))===r.index){o=true}else if(r.tag===t){n=true;if(!o){i++}}}return n?`[${i+1}]`:""}t.xpathOne=a},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LocatorDeserializer=void 0;const i=s(6);const o=s(311);const n=s(53);const r=s(185);const a=s(76);const c=s(189);const l=s(246);const u=s(633);const d=s(166);const p=s(635);const h=s(241);class f{constructor(e,t=[],s={}){this.dom=e;this.selectorFilterSpec=t;this.metaData=s}deserialize(e,t=new r.NoEnvironmentParamEvaluator){const s=e.document;const i=s.map((e=>this._deserializeSingleElementLocator(e,t)));const o=new l.LocatorDocument(i);i.forEach((e=>{e.selectors.forEach((e=>{e.parentsLocators=e.parentsLocators.map((e=>i[e]));if(Object.hasOwn(e,"chosenParent")){e.chosenParent=i[e.chosenParent]}}));e.setDocument(o)}));return i[e.index]}filterOutTextContentSelectorIfNeeded(e){const t=e.find((e=>n.locatorBuilderUtils.isInnerTextSelectorType(e.type)));return t&&!n.locatorBuilderUtils.isEmptyTextSelector(t)?e.filter((e=>!n.locatorBuilderUtils.isTextContentSelectorType(e.type))):this._cloneSelectors(e)}static getTagSelectorFromLocatorData(e){const t=e.document[e.index];return t.selectors.concat(t.nonUniqueSelectors||[]).find((e=>e.type==="TagSelector"))}_cloneSelectors(e){const t=e.find((e=>{var t;return(t=e.dom)===null||t===void 0?void 0:t.parsedUsingLinkedom}));if(t){return i.cloneDeepWith(e,(e=>{if(i.isElement(e)){return i.clone(e)}return undefined}))}return i.cloneDeep(e)}_deserializeSelectors(e,t){const s=new c.SelectorMatcher(this.selectorFilterSpec);const o=i.chain(e).map((e=>this._deserializeSelector(e,t))).compact().value();o.forEach((e=>{if(s.matchesExisting(e)){e.isDisabled=true;e.isUsed=false}else{s.mapExisting(e,t)}}));return this.filterOutTextContentSelectorIfNeeded(o)}_deserializeSingleElementLocator(e,t){const s=this._deserializeSelectors(e.selectors,t);let i;if(e.nonUniqueSelectors){i=this._deserializeSelectors(e.nonUniqueSelectors,t)}return this._createElementLocatorObject(e,{selectors:s,nonUniqueSelectors:i})}_deserializeSelector(e,t){e.dom=this.dom;return this._buildSelector(e,t)}_buildSelector(e,t){let s;try{s=h.selectorClasses.create(e,this.metaData);if(s.isUsed){s.evaluateComputedProperties(t)}return s}catch(t){if(t instanceof a.SelectorParamEvaluationError){t.selectorType=s===null||s===void 0?void 0:s.getDisplayName();throw t}o.locatorLogger.error(`Couldn't create a selector object of type ${e.type}`,t);return null}}_createElementLocatorObject(e,t){let s;switch(e.type){case"ElementLocator":s=new d.ElementLocator(t);break;case"FrameLocator":s=new u.FrameElementLocator(t);break;case"ChildElementLocator":s=new p.ChildElementLocator(t);break;default:break}s.score=Number(e.score);s.runtimeScore=e.runtimeScore;s.foundElementTestimId=e.foundElementTestimId;if(Object.hasOwn(e,"scoreThreshold")){s.setScoreThreshold(e.scoreThreshold)}return s}}t.LocatorDeserializer=f},function(e,t,s){"use strict";(function(e){var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.selectorsConfig=t.generatedValueCreationFunc=t.selectorLocateOrder=t.AutoGeneratedSelector=t.ManualSelector=t.AbstractSelector=t.MOBILE_MATCHING_METHOD_OPTIONS_WITH_VALUES=t.MobileSelectorMatchMethod=t.SelectorDistanceType=t.xpathManipulations=t.IndexXpathType=t.getXpathWithoutClassNames=void 0;const n=s(2);function r(e,t){let s=e;if(s.startsWith("//")){s=s.substring(2)}let i=0;if(s.includes("/")){i=s.match(/[/]/g).length}let o="";for(let e=0;e<i+1;e++){const e=s.indexOf("[");const i=s.indexOf("/");if(e!==-1&&(i===-1||i>e)){if(t){const e=s.substring(0,s.indexOf("]")+1);o+=`${e}/`}else{const t=s.substring(e,s.indexOf("]")+1);o+=`*${t}/`}}else{o+="*/"}s=s.substring(s.indexOf("/")+1)}o=o.substring(0,o.length-1);return`//${o}`}t.getXpathWithoutClassNames=r;var a;(function(e){e["First"]="first";e["Last"]="last"})(a||(t.IndexXpathType=a={}));t.xpathManipulations={getXpathFromIndexType:(e,t,s=false)=>{if(!s)e=r(e,true);let i=e;if(i.startsWith("//")){i=i.substring(2)}let o="";let n;if(t===a.First){n=e.indexOf("]")}else if(t===a.Last){n=e.lastIndexOf("]")}else{return e}if(n!==-1){const t=e.substring(0,n).lastIndexOf("/");if(t!==-1){o=e.substring(t+1)}return`//${o}`}return""},removeXpathIndices:e=>e.replace(/\[[0-9]+\]/g,"[*]")};var c;(function(e){e["Euclidean"]="Euclidean";e["DomBfs"]="DomBfs"})(c||(t.SelectorDistanceType=c={}));var l;(function(e){e["Equals"]="Equals";e["Contains"]="Contains";e["StartsWith"]="StartsWith";e["EndsWith"]="EndsWith"})(l||(t.MobileSelectorMatchMethod=l={}));t.MOBILE_MATCHING_METHOD_OPTIONS_WITH_VALUES=Object.keys(l).map((e=>({name:e,value:e})));class u{get disabled(){return this._disabled}get lastValueEditByUser(){return this._isCurrentValueUserEdited}disable(){this._disabled=true}enable(){this._disabled=undefined}static isSelector(e,t){if(e&&e instanceof Object&&"selectorKind"in e){return t?e.selectorKind===t:true}return false}static isAttributeNameOfSelector(e,t,s){if(!e||!(e in t))return false;return u.isSelector(t[e],s)}}t.AbstractSelector=u;i([n.observable.ref,o("design:type",Boolean)],u.prototype,"_disabled",void 0);class d extends u{constructor(e){super();this.originalValue="";this._lastValueBeforeUserEdit="";this._currentValue="";this._isExpression=false;this._matchMethod=l.Equals;this.selectorKind="Manual";if(e){this._currentValue=e;this.originalValue=e;this._lastValueBeforeUserEdit=e}}get isExpression(){return Boolean(this._isExpression)}set isExpression(e){this._isExpression=e}get currentValue(){return this._currentValue}get matchMethod(){return this._matchMethod||l.Equals}set matchMethod(e){this._matchMethod=e}get lastValueBeforeUserEdit(){return this._lastValueBeforeUserEdit}revertUserEdits(){this.setCurrentValue(this._lastValueBeforeUserEdit,false)}setCurrentValue(e,t){this._currentValue=e;if(t){this._isCurrentValueUserEdited=true}else{this._isCurrentValueUserEdited=undefined;this._lastValueBeforeUserEdit=e}}}t.ManualSelector=d;if(e.env.isClickimEditor||false){(0,n.decorate)(d,{_currentValue:n.observable.ref})}class p extends u{constructor(e,t){super();this.selectorKind="AutoGenerated";this._xpath="";this.name=e;this._xpath=t.xpath.currentValue}get currentValue(){return h(this._xpath,this.name)}updateValues(e){this._xpath=e.xpath.currentValue}}t.AutoGeneratedSelector=p;t.selectorLocateOrder=["text","id","imageLocation","class","contentDesc","closestText","closestParentIndexOnlyXpath","indexOnlyXpath","xpathWithoutIndices","xpath"];function h(e,s){switch(s){case"closestParentIndexOnlyXpath":return t.xpathManipulations.getXpathFromIndexType(e,a.First);case"indexOnlyXpath":return t.xpathManipulations.getXpathFromIndexType(e,a.Last);case"xpathWithoutIndices":return t.xpathManipulations.removeXpathIndices(e);default:throw Error("AutoGenerated selector name given does not have a suitable function ingeneratedValueCreationFunc")}}t.generatedValueCreationFunc=h;t.selectorsConfig={id:{selectorType:"Manual",description:"In android: ResourceId. In ios: Name.",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.25,locateOrder:t.selectorLocateOrder.indexOf("id")},text:{selectorType:"Manual",description:"Notice: In ios the text could be in the label or value attribute.",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.25,locateOrder:t.selectorLocateOrder.indexOf("text")},label:{selectorType:"Manual",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.25,locateOrder:t.selectorLocateOrder.indexOf("label")},value:{selectorType:"Manual",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.25,locateOrder:t.selectorLocateOrder.indexOf("value")},class:{selectorType:"Manual",description:"Examples: android.widget.TextView, android.ViewGroup.",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.1,locateOrder:t.selectorLocateOrder.indexOf("class")},xpath:{selectorType:"Manual",description:"The path of the element in the elements tree.",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.02,locateOrder:t.selectorLocateOrder.indexOf("xpath")},contentDesc:{selectorType:"Manual",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.08,locateOrder:t.selectorLocateOrder.indexOf("contentDesc")},name:{selectorType:"Manual",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:0,locateOrder:t.selectorLocateOrder.indexOf("name")},index:{selectorType:"Manual",isUserEditable:false,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"0",confidenceWeight:0,locateOrder:t.selectorLocateOrder.indexOf("index")},type:{selectorType:"Manual",description:"Similar to Class.",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.1,locateOrder:t.selectorLocateOrder.indexOf("type")},resourceId:{selectorType:"Manual",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:0,locateOrder:t.selectorLocateOrder.indexOf("resourceId")},accessabilityId:{selectorType:"Manual",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:0,locateOrder:t.selectorLocateOrder.indexOf("accessabilityId")},closestText:{selectorType:"Manual",description:"Closest text to the element.",isUserEditable:true,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.07,locateOrder:t.selectorLocateOrder.indexOf("closestText")},imageLocation:{selectorType:"Manual",isUserEditable:false,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.08,locateOrder:t.selectorLocateOrder.indexOf("imageLocation")},closestParentIndexOnlyXpath:{selectorType:"AutoGenerated",description:"Xpath of the first target parent in the xml tree that has an index.",isUserEditable:false,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.06,locateOrder:t.selectorLocateOrder.indexOf("closestParentIndexOnlyXpath")},xpathWithoutIndices:{selectorType:"AutoGenerated",description:"The index of the smallest group of elements that has index and which the target element belongs to.",isUserEditable:false,canBeDisabledByUser:false,showValueInUI:true,defaultValue:"",confidenceWeight:.03,locateOrder:t.selectorLocateOrder.indexOf("xpathWithoutIndices")},indexOnlyXpath:{selectorType:"AutoGenerated",description:"Xpath with only indices, ignore class names or other attributes.",isUserEditable:false,canBeDisabledByUser:true,showValueInUI:true,defaultValue:"",confidenceWeight:.06,locateOrder:t.selectorLocateOrder.indexOf("indexOnlyXpath")}};t.selectorLocateOrder.sort(((e,s)=>{const i=t.selectorsConfig[e].confidenceWeight||0;const o=t.selectorsConfig[s].confidenceWeight||0;return o-i}))}).call(this,s(35))},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.assetService=t.Queue=t.RUN_RESULT_ARTIFACTS_BUCKET=t.PROJECT_ARTIFACTS_BUCKET=t.TEST_RESULT_ARTIFACTS_BUCKET=t.ArtifactsSubTypes=t.MIME_TYPES=void 0;const i=s(6);const o=s(410);const n=s(8);const r=s(7);const a=s(114);const c=s(5);const l=s(115);const u=s(194);var d;(function(e){e["HTML"]="text/html";e["MHTML"]="text/mhtml";e["JSON"]="application/json";e["WEBM"]="video/webm";e["JPG"]="image/jpeg";e["PNG"]="image/png";e["XML"]="application/xml"})(d||(t.MIME_TYPES=d={}));const p=s(411);const h=r.Logger.getLogger("asset service");var f;(function(e){e["DOM_TYPE"]="dom";e["IMAGE_TYPE"]="image";e["VIDEO_TYPE"]="video";e["FILE_TYPE"]="file";e["OBJECT_TYPE"]="object";e["HTML_TYPE"]="html";e["LOG_TYPE"]="log";e["ARTIFACT_TYPE"]="artifact"})(f||(f={}));var m;(function(e){e["ELEMENT_LOCATE_RESULT"]="element-locate-result";e["ELEMENT_IMAGE_FILE"]="element-image";e["FRAME_LOCATE_RESULT"]="frame-locate-result";e["TEST_RUN_PARAMS"]="test-run-params";e["TEST_LOGS"]="test-log";e["TEST_HAR_FILE"]="har-file";e["COVERAGE_FILE"]="coverage";e["VIDEO_FILE"]="video-file";e["UPLOAD_FILE"]="upload-file";e["RESULT_IMAGE_FILE"]="res-img";e["RECORD_IMAGE_FILE"]="rec-img";e["DOM_FILE"]="dom";e["HTML_FILE"]="html";e["STEP_INCOMING_PARAMS"]="step-incoming-params";e["STEP_OUTGOING_PARAMS"]="step-outgoing-params";e["STEP_RESPONSE_BODY_RAW"]="step-response-body-raw";e["STEP_REQUEST_BODY"]="step-request-body";e["STEP_REQUEST_HEADERS"]="step-request-headers";e["STEP_ACCESSIBILITY_RESULT"]="step-accessibility-result";e["STEP_RESPONSE_HEADERS"]="step-response-headers";e["STEP_CLI_CONSOLE_LOG"]="step-cli-console-log";e["DOWNLOAD_VALIDATION_FILE"]="download-validation-file";e["PERFORMANCE_MONITORING_LOG"]="performance-monitoring-log";e["CODE_COVERAGE_FILES"]="code-coverage-files";e["CODE_COVERAGE_SCRIPT_CODE"]="code-coverage-script-code"})(m||(t.ArtifactsSubTypes=m={}));const g=900;const v=4;const S=200;const y=[m.RESULT_IMAGE_FILE,m.TEST_HAR_FILE,m.TEST_LOGS];const b=["stepId","stepName"];t.TEST_RESULT_ARTIFACTS_BUCKET="test-result-artifacts";t.PROJECT_ARTIFACTS_BUCKET="test-projects-artifacts";t.RUN_RESULT_ARTIFACTS_BUCKET="run-result-artifacts";const _="all";const T=[/https?:\/\/accounts\.google\.com\/signin/,/https?:\/\/login\.microsoftonline\.com/];function E(e){return(new p).update(e).digest("hex")}function I(e){switch(e){case d.HTML:return"html";case d.MHTML:return"mhtml";case d.JSON:return"json";case d.WEBM:return"webm";case d.JPG:return"jpg";case d.PNG:return"png";case d.XML:return"xml";default:return undefined}}function C(e){const t=I(e);return t?`.${t}`:""}class D{constructor(e,t,s=v){this.sendFunction=e;this.name=t;this.maxRequests=s;this.skippedMd5={};this.md5SentMap={};this.sent={};this.queue=[];this.pausedQueue={};this.pending={};this.paused={};this.running=false;this.defaultMaxRequests=this.maxRequests}add(e,t=_){if(this.paused[t]){this.pausedQueue[t]=this.pausedQueue[t]||[];this.pausedQueue[t].push(e);return}if(!this.pending[t]){this.pending[t]=0;this.sent[t]=this.sent[t]||0;this.skippedMd5[t]=this.skippedMd5[t]||0}this.pending[t]++;this.queue.push({item:e,tag:t});if(!this.running){this.run(this.sendFunction)}}pause(e=_){this.paused[e]=true}reset(){this.skippedMd5={};this.md5SentMap={};this.sent={};this.pending={};this.queue=[];this.paused={};this.pausedQueue={};this.running=false}drain(e=_,t){this.paused[e]=false;this.pausedQueue[e]=this.pausedQueue[e]||[];while(this.pausedQueue[e].length>0){const s=this.pausedQueue[e].shift();if(!s){break}if(t&&!t(s)){continue}this.add(s,e)}return undefined}queueSize(e=_){return this.pending[e]||0}async send(e,t,s){this.maxRequests--;try{await t(e)}catch(t){h.warn(`failed to upload ${e.type}, ${e.fileName}`,t)}finally{this.maxRequests++;this.pending[s]--}}async run(e){this.running=true;try{while(this.queue.length>0){if(this.maxRequests===0){await n.utils.delay(S);continue}const{item:t,tag:s=_}=this.queue.shift()||{};if(!t){break}if(t.md5){if(this.md5SentMap[t.md5]){this.skippedMd5[s]++;this.pending[s]--;continue}this.md5SentMap[t.md5]=true}this.send(t,e,s).then((()=>{this.sent[s]++}))}}finally{this.running=false}}isAllRequestsCompleted(e=_){return this.queueSize(e)===0&&this.maxRequests===this.defaultMaxRequests}}t.Queue=D;async function O(e){const{artifact:t,mimeType:s,fileName:i,storagePath:o,metadata:n,storageApi:r,subType:c,tagging:l}=e;if(c===m.UPLOAD_FILE){const e=await(0,a.compressDataURIToGzip)(t);if(!e){return undefined}return await r.uploadFile(o,{fileName:i,mimeType:e.type,file:e},n||{},{"X-Asset-Encoding":"gzip"},l)}if([m.VIDEO_FILE,m.RESULT_IMAGE_FILE,m.RECORD_IMAGE_FILE,m.DOM_FILE].includes(c)){return await r.uploadFile(o,{fileName:i,mimeType:s,file:t},n||{},{},l)}const u=(e,t)=>t===undefined?null:t;const d=typeof t==="string"?t:JSON.stringify(t,u);const p=await(0,a.compressToGzip)(d,s);return await r.uploadFile(o,{fileName:i,mimeType:s,file:p},n||{},{"X-Asset-Encoding":"gzip"},l)}const A=new D(O,"html");const j=new D(O,"artifact",6);const w=[j,A];function R(e){const{projectId:s,storageApi:i,testId:o,testResultId:r,subType:a,mimeType:c,prefix:l,md5Hash:u}=e;const d=C(c);const p=u||n.utils.guid();const h=`${a}${l||""}_${p}${d||""}`;const f=`${o}/${r}/${h}`;const m=i.getStorageRelativePath(f,t.TEST_RESULT_ARTIFACTS_BUCKET,s);return{storagePath:m,fileName:h}}function P(e){return(0,l.isDemoProjectId)(e)&&!u.default.isAdmin}async function x(e){const{projectId:t,testId:s,testResultId:i,artifact:o,subType:n,storageApi:r,mimeType:a="application/octet-stream",metadata:c,prefix:l="",tagging:u}=e;if(P(t)){return""}const{storagePath:d,fileName:p}=R({projectId:t,storageApi:r,testId:s,testResultId:i,subType:n,mimeType:a,prefix:l});await O({artifact:o,fileName:p,storagePath:d,type:f.ARTIFACT_TYPE,subType:n,storageApi:r,mimeType:a,metadata:c,tagging:u});return d}function M(e){const{projectId:t,testId:s,testResultId:n,artifact:r,subType:a,storageApi:c,mimeType:l="application/octet-stream",metadata:u,prefix:d="",md5Hash:p,tagging:h}=e;if(P(t)){return""}const{storagePath:m,fileName:g}=R({projectId:t,storageApi:c,testId:s,testResultId:n,subType:a,mimeType:l,prefix:d,md5Hash:p});const v={artifact:r,fileName:g,storagePath:m,type:f.ARTIFACT_TYPE,storageApi:c,mimeType:l,metadata:u&&i.omit(u,b),tagging:h,subType:a};if(p){v.md5=`${p}:${n}`}j.add(v,n);if(y.includes(a)){o.uploadItem({fileName:g,file:r,mimeType:l,metadata:{...u,subType:a,testResultId:n}})}return m}function N(e,t,s,i,o,n,r,a){return M({projectId:e,testId:t,testResultId:s,artifact:i,subType:o,storageApi:n,mimeType:d.JSON,metadata:r,prefix:a})}function F(e,t,s,i,o,n=0){const r={testId:t,resultId:s,projectId:e};return N(e,t,s,i,m.TEST_HAR_FILE,o,r,`_${n}_`)}function L(e,t,s,i){if(!t){return null}const o={recordedResultId:s};return H({projectId:e,artifact:t,subType:`${c.mockNetworkStorage.PATH}/${c.mockNetworkStorage.HAR_FILE_DIRECTORY}`,storageApi:i,mimeType:d.JSON,metadata:o,mode:"nested"},"recording")}function k(e,t,s,i,o,n=0){const r={testId:t,resultId:s,projectId:e};return N(e,t,s,i,m.TEST_LOGS,o,r,`_${n}_`)}function B({projectId:e,storageApi:s,runId:i,mimeType:o,subType:r,overrideFileName:a}){const c=C(o);const l=n.utils.guid();const u=a||`${l}${c}`;const d=`${i}/${r}/${u}`;const p=s.getStorageRelativePath(d,t.RUN_RESULT_ARTIFACTS_BUCKET,e);return{storagePath:p,fileName:u}}async function U({projectId:e,runId:t,storageApi:s,hash:i,text:o,subType:n,mimeType:r="text",tagging:a},c){if(P(e)){return""}const{storagePath:l,fileName:u}=B({mimeType:r,projectId:e,storageApi:s,runId:t,subType:n,overrideFileName:i});const d={artifact:o,fileName:u,storagePath:l,type:f.ARTIFACT_TYPE,storageApi:s,subType:n,mimeType:r,tagging:a};j.add(d,c);return l}function G(e,t,s,i,o,n,r,a){return M({projectId:e,testId:t,testResultId:s,artifact:i,subType:o,storageApi:n,metadata:r,prefix:a})}function V({projectId:e,storageApi:s,subType:i,mimeType:o,prefix:r="",mode:a,overrideFileName:c}){const l=C(o);const u=n.utils.guid();let d;let p;if(a==="root"){d=c||`${i}${r}_${u}${l}`;p=d}else{d=c||`${r?`${r}_`:""}${u}${l}`;p=`${i}/${d}`}const h=s.getStorageRelativePath(p,t.PROJECT_ARTIFACTS_BUCKET,e);return{storagePath:h,fileName:d}}function H(e,t){const{projectId:s,artifact:i,subType:o,storageApi:n,mimeType:r="application/octet-stream",metadata:a,prefix:c="",mode:l="root",overrideFileName:u,tagging:d}=e;const{storagePath:p,fileName:h}=V({projectId:s,storageApi:n,subType:o,mimeType:r,prefix:c,mode:l,overrideFileName:u});if(P(s)){return""}j.add({artifact:i,fileName:h,storagePath:p,type:f.ARTIFACT_TYPE,storageApi:n,mimeType:r,metadata:a,subType:o,tagging:d},t);return p}function $(e,t,s,i,o,n=d.MHTML){if(!(o===null||o===void 0?void 0:o.dom)){return null}const r=T.some((e=>e.test(o.url)));const a=M({projectId:e,testId:t,testResultId:s,mimeType:n,artifact:o.dom,subType:m.DOM_FILE,storageApi:i});return{domUrl:a,isDomBlackList:r}}function W(e,t,s,i,o,n,r){if(P(e)){return""}const a=d.HTML;const c=m.HTML_FILE;const l=E(i);const{storagePath:u,fileName:p}=R({testId:t,projectId:e,storageApi:r,mimeType:a,testResultId:o,subType:c,md5Hash:l});A.add({mimeType:a,subType:c,artifact:i,fileName:p,storagePath:u,metadata:Object.assign({},n||{}),type:f.ARTIFACT_TYPE,storageApi:r,md5:`${l}:${o}`},o);return u}function J(e){return(" "+e).substr(1)}function Y(e){const t=e.split(":")[1].split(";");const s=t[0]||d.JPG;const i=J(t[1].split(",")[1]);return{base64:i,mimeType:s}}function z(t,s){if(n.utils.isNode()){return e.from(t,"base64")}const i=atob(t);const o=[];const r=i.length;for(let e=0;e<r;e++){o.push(i.charCodeAt(e))}return new Blob([new Uint8Array(o)],{type:s})}function q(e,t,s,i){if(!t){return null}return H({projectId:e,artifact:t,subType:m.UPLOAD_FILE,storageApi:i,mode:"nested",overrideFileName:`${n.utils.guid()}_${s}`},"recording")}function X(e){const{projectId:t,imageDataUrl:s,storageApi:i,testId:o,testResultId:n,forceJpgImageType:r=false,metadata:a}=e;if(!s){return undefined}const c=E(s);const l=Y(s);const u=l.base64;let p=l.mimeType;if(r){p=d.JPG}const h=z(u,p);return M({projectId:t,testId:o,testResultId:n,artifact:h,subType:m.RESULT_IMAGE_FILE,storageApi:i,mimeType:p,md5Hash:c,tagging:{[m.RESULT_IMAGE_FILE]:true},metadata:a})}function Z(e){const{projectId:t,imageDataUrl:s,storageApi:i,metadata:o}=e;if(!s){return undefined}const{base64:n,mimeType:r}=Y(s);const a=z(n,r);return H({projectId:t,artifact:a,metadata:o,mimeType:r,subType:m.RECORD_IMAGE_FILE,tagging:{[m.RECORD_IMAGE_FILE]:true},storageApi:i,mode:"nested"},"recording")}function Q(e,t,s,i,o,n,r,a,c){let l=null;let u;const d=X({projectId:e,imageDataUrl:i,storageApi:o,testId:n,testResultId:r,forceJpgImageType:true,metadata:a});const p=$(e,n,r,o,s,c);if(p){l=p.domUrl;u=p.isDomBlackList}return{domUrl:l,isDomBlackList:u,imgUrl:d}}function K(e,t,s){if(!t){return null}return H({projectId:e,artifact:t,subType:m.VIDEO_FILE,storageApi:s,mimeType:t.type},"recording")}async function ee(e){if(e()){return undefined}return new Promise((t=>{let s=0;const i=()=>{if(s>=g){return true}return e()};const o=setInterval((()=>{if(!i()){s++;return undefined}clearInterval(o);return t()}),200)}))}async function te(e){const t=()=>j.isAllRequestsCompleted(e);return ee(t)}async function se(e=_){const t=()=>w.every((t=>t.isAllRequestsCompleted(e)));const s=Date.now();if(t()){h.log(`asset service summary - Qs done immediately, skipped htmls: ${A.skippedMd5[e]},\n        sent htmls: ${A.sent[e]}. waited ${Date.now()-s} for screenshots`);return}const i=w.filter((t=>t.queueSize(e)>0)).map((t=>({name:t.name,size:t.queueSize(e)})));const o=Date.now();await ee(t);const n=`asset service summary - skipped htmls: ${A.skippedMd5[e]}, sent htmls: ${A.sent[e]}. `;const r=`Waited ${o-s} for screenshots and ${Date.now()-o} for the Qs tp finish. `;const a=`Sent breakdown: ${i.map((({name:e,size:t})=>`${e}: ${t}`)).join(", ")}.`;h.log(`${n}${r}${a}`)}function ie(e=_){w.forEach((t=>t.pause(e)))}function oe(){w.forEach((e=>e.reset()))}function ne(e=_){h.log("asset service summary - ",{sizes:w.map((t=>({name:t.name,size:t.queueSize(e)})))})}async function re(e=_,t){w.forEach((s=>s.drain(e,t)));await se(e)}t.assetService={upload:Q,uploadVideo:K,uploadFileArtifactApi:q,uploadHTML:W,uploadImageArtifactApi:X,uploadProjectImageArtifact:Z,isAllRequestsCompleted:se,isAllArtifactRequestsCompleted:te,uploadHar:F,uploadMockHar:L,uploadLogs:k,uploadArtifactJson:N,uploadArtifactString:G,uploadArtifactNoQueue:x,uploadRunResultArtifact:U,pauseAllQueues:ie,resetAllQueues:oe,drainAllQueues:re,logAllQueueSizes:ne}}).call(this,s(65).Buffer)},,,,,,,function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.LocateStep=void 0;const i=s(6);const o=s(5);const n=s(2);const r=s(72);const a=s(8);const c=s(189);class l extends r.Step{constructor(){super(...arguments);this.deepOpacityCheck=null;this.disableForceVisibility=false;this.documentLengthAtRecording=null;this.domId=null;this.elementLocator=null;this.forceVisibility=false;this.isDocument=null;this.isInput=null;this.isShadowed=null;this.testimFrameId=null;this.thumbnailImage=null;this.thumbnailInfo=null}static decorateNonUniqueSelector(e){e.isUniqueSelector=false;e.score=Number(e.selfScore);e.displayValue=e.getDisplayValue()}static decorateUniqueSelector(e){e.isUniqueSelector=true;e.score=Number(e.selfScore);e.displayValue=e.getDisplayValue()}static addResultDataToSelector(e,t,s){e.foundElements=t;e.chosenParent=s}static addResultDataToLocator(e,t){var s;const i=e=>`${Math.floor(Number(e)*100)}%`;if(!t.score){e.runtimeScore="(n/a)"}else if(t.score==="0"&&((s=t.selectorResults)===null||s===void 0?void 0:s.length)===0){e.runtimeScore="(n/a)"}else{e.runtimeScore=i(t.score)}e.foundElementTestimId=t.foundElementID}static locateStrategy(e){if(!e.elementLocator&&e.selector){return o.commonConstants.locators.strategy.SELECTOR}return o.commonConstants.locators.strategy.LOCATOR}getScoreThreshold(e=this.elementLocator){if(!e){return undefined}const{index:t}=e;return e.document[t].scoreThreshold}setScoreThreshold(e,t=this.elementLocator){if(!t){return}const{index:s}=t;t.document[s].scoreThreshold=e}_cleanElementLocator(e){var t;if(!e){return undefined}(t=e.document)===null||t===void 0?void 0:t.forEach((e=>{delete e.runtimeScore;delete e.foundElementTestimId;const t=e.selectors||[];const s=e.nonUniqueSelectors||[];t.concat(s).forEach((e=>{delete e.foundElements;delete e.chosenParent;delete e.displayValue;delete e.score;delete e.isUniqueSelector}))}));return e}_update(e){if(e.elementLocator){if(this.elementLocator){const t=this.getScoreThreshold();if(t!==undefined){this.setScoreThreshold(t,e.elementLocator)}if(!i.isEqual(e.elementLocator,this.elementLocator)){this.id=a.utils.guid()}}this.elementLocator=this._cleanElementLocator(e.elementLocator)}if(e.id&&e.forceElementId){this.id=e.id;delete e.forceElementId}if(e.selector){this.selector=e.selector}if(e.nthChildIndex!==undefined){this.nthChildIndex=e.nthChildIndex}this.frameLocators=r.Step.buildFrameLocatorStepData(e)||this.frameLocators;if(this.frameLocators){this.frameLocators=this.frameLocators.map((e=>this._cleanElementLocator(e)))}if(e.testimFrameId){this.testimFrameId=e.testimFrameId}if(e.domId){this.domId=e.domId}if(e.clickOffset){this.clickOffset=e.clickOffset}if(e.thumbnailImage){this.thumbnailImage=e.thumbnailImage}if(e.thumbnailInfo){const t=e.thumbnailInfo.elementArea||{height:0,width:0,left:0,top:0,pixelRatio:1};this.thumbnailInfo={image:e.thumbnailInfo.image,elementArea:{height:t.height&&Math.round(t.height),width:t.width&&Math.round(t.width),left:t.left&&Math.round(t.left),top:t.top&&Math.round(t.top),pixelRatio:t.pixelRatio}};if(e.thumbnailInfo.removeElementArea){delete this.thumbnailInfo.elementArea}}if(typeof e.forceVisibility==="boolean"){this.forceVisibility=e.forceVisibility}if(typeof e.disableForceVisibility==="boolean"){this.disableForceVisibility=e.disableForceVisibility}if(Object.hasOwn(e,"documentLengthAtRecording")){this.documentLengthAtRecording=e.documentLengthAtRecording}if(Object.hasOwn(e,"contextMatchThreshold")){this.contextMatchThreshold=e.contextMatchThreshold}if(Object.hasOwn(e,"improvedVersion")){this.improvedVersion=e.improvedVersion}if(Object.hasOwn(e,"wasReassigned")){this.wasReassigned=e.wasReassigned}if(Object.hasOwn(e,"wasChangedManually")){this.wasChangedManually=e.wasChangedManually}if(typeof e.isInput==="boolean"){this.isInput=e.isInput}if(typeof e.deepOpacityCheck==="boolean"){this.deepOpacityCheck=e.deepOpacityCheck}if(typeof e.opacity==="number"){this.opacity=e.opacity}if(e.isDocument){this.isDocument=e.isDocument}if(Object.hasOwn(e,"isShadowed")){this.isShadowed=e.isShadowed}if(Object.hasOwn(e,"wasChangedManually")){this.wasChangedManually=e.wasChangedManually}return super._update(e)}getDisplayName(){return"Locate Element"}getSerializableObject(e){return{...super.getSerializableObject(e),elementLocator:this._cleanElementLocator(this.elementLocator),domId:this.domId,thumbnailInfo:this.thumbnailInfo||"",thumbnailImage:this.thumbnailInfo?null:this.thumbnailImage||"",isDocument:this.isDocument,isShadowed:this.isShadowed,forceVisibility:this.forceVisibility,disableForceVisibility:this.disableForceVisibility,clickOffset:this.clickOffset,selector:this.selector,nthChildIndex:this.nthChildIndex,isTopFrame:this.frameLocators&&this.frameLocators.length===0,opacity:this.opacity,deepOpacityCheck:this.deepOpacityCheck,contextMatchThreshold:this.contextMatchThreshold,improvedVersion:this.improvedVersion||0,documentLengthAtRecording:this.documentLengthAtRecording,...this.frameLocators&&{frameLocators:this.frameLocators.map((e=>this._cleanElementLocator(e)))},...this.testimFrameId&&{testimFrameId:this.testimFrameId},...this.wasChangedManually&&{wasChangedManually:this.wasChangedManually}}}static buildLocateStepData(e,t=[]){const s=i.cloneDeep(e);if(l.locateStrategy(e)===o.commonConstants.locators.strategy.LOCATOR){d(s,t)}return u(s)}}t.LocateStep=l;if(e.env.isClickimEditor){(0,n.decorate)(l,{elementLocator:n.observable.deep,thumbnailInfo:n.observable.deep,frameLocators:n.observable.ref,selector:n.observable.ref,forceVisibility:n.observable.ref})}function u(e){return{type:"locate",multiStepKey:e.multiStepKey,elementLocator:e.elementLocator,selector:e.selector,nthChildIndex:e.nthChildIndex,thumbnailImage:e.thumbnailImage,domId:e.domId,isDocument:e.isDocument,isShadowed:e.isShadowed,location:e.location,tabInfo:e.tabInfo,isInput:e.isInput,deepOpacityCheck:e.deepOpacityCheck,frameLocators:r.Step.buildFrameLocatorStepData(e),forceVisibility:Object.hasOwn(e,"forceVisibility")?e.forceVisibility:true,disableForceVisibility:Object.hasOwn(e,"disableForceVisibility")?e.disableForceVisibility:false,clickOffset:e.clickOffset,opacity:e.opacity,improvedVersion:e.improvedVersion,wasImproved:e.wasImproved,wasReassigned:e.wasReassigned,wasChangedManually:e.wasChangedManually,contextMatchThreshold:e.contextMatchThreshold,name:e.name,documentLengthAtRecording:e.documentLengthAtRecording}}function d(e,t=[]){var s;const i=new c.SelectorMatcher(t);p(e.elementLocator,i);(s=e.frameLocators)===null||s===void 0?void 0:s.forEach((e=>{p(e.elementLocator,i)}))}function p(e,t){if(!e)return;e.document.forEach((e=>{if(t.filterSpec.length>0){e.selectors.forEach((e=>{if(t.matchesData(e)){e.isUsed=false}}))}if(t.mappingSpec.length>0){e.selectors=e.selectors.map((e=>t.mapData(e)))}}))}}).call(this,s(35))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ShadowRootSelector=void 0;const i=s(64);const o=s(5);const n=.3;class r extends i.RelativeSelector{static get TYPE(){return"ShadowRootSelector"}static elementIsShadowRoot(e){var t;return Boolean(e.shadowRoot)||((t=e.hasAttribute)===null||t===void 0?void 0:t.call(e,o.commonConstants.locators.TESTIM_SHADOW_ROOT_ID))}getType(){return r.TYPE}getDisplayName(){return"Shadow Root"}getDisplayValue(){return"true"}_matches(e){return this._equals(e)}_equals(e){return e instanceof r}isSelectorValid(e){return r.elementIsShadowRoot(e)}computeInitialScore(){return n}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}findElements(e){const t=e.getActualElement();return Array.from(t.querySelectorAll(`[${o.commonConstants.locators.TESTIM_SHADOW_ROOT_ID}]`))}}t.ShadowRootSelector=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LocatorsComparator=void 0;const i=s(6);const o=s(53);const n=s(299);const r=s(246);const a=s(636);const c=.2;const l=0;const u=(e,t)=>!!e.nonUniqueSelectors&&!!t.nonUniqueSelectors;const d=(e,t)=>{let s=e.selectors;let i=t.selectors;if(u(e,t)){s=s.concat(e.nonUniqueSelectors);i=i.concat(t.nonUniqueSelectors)}s=s.filter((e=>e.isMatchable()));i=i.filter((e=>e.isMatchable()));return{newSelectors:s,oldSelectors:i}};const p=e=>{const t=i.chain(e).map((e=>e.getSelfScore())).sum().value();return Math.floor(t*1e3)/1e3};const h=(e,t)=>{const{newSelectors:s,oldSelectors:i}=d(e,t);return p(s.concat(i))};const f=(e,t)=>e.map((e=>{const s=t.find((t=>e.matches(t)));return{oldSelector:s||a.MaxWeightedMatch.NO_MATCH,newSelector:e}}));const m=(e,t)=>{const{newSelectors:s,oldSelectors:o}=d(e,t);const n=i.chain(f(s,o)).filter((e=>e.oldSelector!==a.MaxWeightedMatch.NO_MATCH)).map((({oldSelector:e,newSelector:t})=>[e,t])).flatten().value();return p(n)};const g=(e,t)=>{const{newSelectors:s,oldSelectors:o}=d(e,t);return i.chain(f(s,o)).filter((e=>e.oldSelector!==a.MaxWeightedMatch.NO_MATCH)).filter((e=>e.newSelector.equals(e.oldSelector))).map((({oldSelector:e,newSelector:t})=>[e,t])).flatten().value()};const v=(e,t)=>p(g(e,t));class S{static get POSITIVE_MATCH_THRESHOLD_SCORE(){return c}static getSelectorsToMatch(e,t){return d(e,t)}static getSelectorsMatchings(e,t){return f(e,t)}static sumSelectorScores(e){return p(e)}static getTotalLocatorScore(e,t){return h(e,t)}static getSharedSelectorScore(e,t){return m(e,t)}static getEqualSelectorScore(e,t){return v(e,t)}calcMatchScore(e,t){return m(e,t)/h(e,t)}calcAllMatchScores(e,t){const s=e.map((e=>t.map((t=>this.calcMatchScore(e,t)))));this.forceChildLocatorsScores(s,e,t);return s}forceChildLocatorsScores(e,t,s){t.forEach(((t,i)=>{if(t.isChildLocator){s.forEach(((t,s)=>{e[i][s]=l}))}}));s.forEach(((s,i)=>{if(s.isChildLocator){t.forEach(((t,s)=>{e[s][i]=l}))}}))}calcAssignment(e,t,s,i){const o=this.calcAllMatchScores(e,t);return(new a.MaxWeightedMatch).calcAssignment(o,s,i,S.POSITIVE_MATCH_THRESHOLD_SCORE)}calcAssignmentAndScore(e,t,s,i){const o=this.calcAllMatchScores(e,t);return(new a.MaxWeightedMatch).calcAssignmentAndScore(o,s,i,S.POSITIVE_MATCH_THRESHOLD_SCORE)}mergeLocators(e,t,s,i){const{newSelectors:o,oldSelectors:n}=d(e,t);o.forEach((e=>{const t=n.filter((t=>e.matches(t)));if(t.length===1){e.mergeSelector(t[0],s,i)}}))}getDeserializedLocator(e,t={},s=[]){return new n.LocatorDeserializer(t,s).deserialize(e)}getDeserializedElementLocators(e){return new n.LocatorDeserializer({}).deserialize(e).getDocument().getElementLocators()}mergeLocatorPaths(e,t,s=.1,i=.3){const n=this.getDeserializedElementLocators(e);const c=this.getDeserializedElementLocators(t);const{assignments:l,score:u}=this.calcAssignmentAndScore(n,c,e.index,t.index);l.forEach((({i:e,j:t})=>{if(t!==a.MaxWeightedMatch.NO_MATCH){this.mergeLocators(n[e],c[t],s,i)}}));const d=new r.LocatorDocument(n);const p=n[e.index];p.setDocument(d);return{elementLocator:o.locatorBuilderUtils.serializeLocators(p),similarityScore:u}}findMatchIndexForSingleElement(e,t,s,o=S.POSITIVE_MATCH_THRESHOLD_SCORE){const n=this.calcAllMatchScores(e.document.elementLocators,s.document.elementLocators);const r=n[t];const a=i.max(r);if(a<o){return{index:-1,matchScore:a}}const c=r.map(((e,t)=>e===a?t:-1)).filter((e=>e>-1));const l=i.minBy(c,(e=>Math.abs(e-t)));return{index:l,matchScore:a}}_filterSelectors(e,t){if(e.getType()==="ChildSelector"){return false}if(!t){return true}return t(e)}_constructWithoutChildLocators(e,t){let s;if(Array.isArray(e)){if(!t){return e}s=i.cloneDeep(e)}else{s=this.getDeserializedElementLocators(e);s[e.index].isTargetElement=true}s=s.filter((e=>!e.isChildLocator));s.forEach((e=>{e.selectors=e.selectors.filter((e=>this._filterSelectors(e,t)));e.nonUniqueSelectors=(e.nonUniqueSelectors||[]).filter((e=>this._filterSelectors(e,t)))}));return s}compareLocatorsOnlyDirectMatches(e,t,s){const o=this._constructWithoutChildLocators(e,s);const n=this._constructWithoutChildLocators(t,s);if(o.length!==n.length){return 0}const r=i.zip(n,o).map((([e,t])=>v(e,t)/h(e,t)));return i.mean(r)}}t.LocatorsComparator=S},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.locatorLogger=void 0;const i=s(7);t.locatorLogger=i.Logger.getLogger("locator")},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.MobileStep=void 0;const n=s(2);const r=s(60);const a=s(72);const c=s(182);const l=s(313);class u extends a.Step{_update(e){var t;if((t=e.element)===null||t===void 0?void 0:t.mobileLocator){e.element.mobileLocator=c.MobileLocatorFactory.getUpdatedLocatorDataForBackwardCompatibility(e.element.mobileLocator)}if(e.recordedDevice){this.recordedDevice=e.recordedDevice}if(e.recordedApp){this.recordedApp=e.recordedApp}this.updateElement(e.element);return super._update(e)}updateElement(e){if(!e){return}if(this.element instanceof l.MobileLocateStep){this.element.update(e)}else{this.element=r.stepBuilder.buildStepFromData(e)}}getSerializableObject(e){return{...super.getSerializableObject(e),...this.element instanceof l.MobileLocateStep&&{element:this.element.getSerializableObject(e)},recordedDevice:this.recordedDevice,recordedApp:this.recordedApp}}get ignoreTopFrame(){return true}get ignoreFrameRetries(){return true}}t.MobileStep=u;i([n.observable.ref,o("design:type",Object)],u.prototype,"element",void 0)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.MobileLocateStep=void 0;const r=s(2);const a=s(72);const c=s(182);class l extends a.Step{_update(e){var t,s;if(e.id){this.id=e.id}if(Object.hasOwn(e,"elementPositionInfoAtRecording")){this.elementPositionInfoAtRecording=e.elementPositionInfoAtRecording}if(e.thumbnailInfo){const s=e.thumbnailInfo.elementArea||((t=this.thumbnailInfo)===null||t===void 0?void 0:t.elementArea)||{height:0,width:0,left:0,top:0,pixelRatio:1};this.thumbnailInfo={image:e.thumbnailInfo.image,elementArea:{height:Math.round(s.height),width:Math.round(s.width),left:Math.round(s.left),top:Math.round(s.top),pixelRatio:s.pixelRatio}}}if(Object.hasOwn(e,"xpath")){this.xpath=(s=e.xpath)!==null&&s!==void 0?s:""}const i=Object.hasOwn(e,"element")&&e.element.mobileLocator||Object.hasOwn(e,"mobileLocator")&&e.mobileLocator;if(i){this.mobileLocator=c.MobileLocatorFactory.createAndFillMobileLocatorDataRecursive(i)}if(Object.hasOwn(e,"forceVisibility")){this.forceVisibility=Boolean(e.forceVisibility)}if(Object.hasOwn(e,"disableForceVisibility")){this.disableForceVisibility=Boolean(e.disableForceVisibility)}if(Object.hasOwn(e,"wasReassigned")){this.wasReassigned=Boolean(e.wasReassigned)}if(Object.hasOwn(e,"wasChangedManually")){this.wasChangedManually=Boolean(e.wasChangedManually)}return super._update(e)}getDisplayName(){return"Locate Element"}getSerializableObject(e){return{...super.getSerializableObject(e),xpath:this.xpath,elementPositionInfoAtRecording:this.elementPositionInfoAtRecording,thumbnailInfo:this.thumbnailInfo,mobileLocator:this.mobileLocator,forceVisibility:this.forceVisibility,disableForceVisibility:this.disableForceVisibility,wasReassigned:this.wasReassigned,wasChangedManually:this.wasChangedManually}}}t.MobileLocateStep=l;i([r.observable.shallow,o("design:type",Object)],l.prototype,"elementPositionInfoAtRecording",void 0);i([r.observable.shallow,o("design:type",Object)],l.prototype,"thumbnailInfo",void 0);i([r.observable.ref,o("design:type",typeof(n=typeof c.MobileLocator!=="undefined"&&c.MobileLocator)==="function"?n:Object)],l.prototype,"mobileLocator",void 0);i([r.observable.ref,o("design:type",Boolean)],l.prototype,"forceVisibility",void 0)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.convertTestResultArtifactUrlToCloudinaryOrMinio=void 0;const i=s(14);function o(e,t,s){const o=i.default.flags.useLocalImageManipulator.isEnabled();if(e&&o){return e}if(!e){return""}if(!e.startsWith("/test-result-artifacts/")&&!e.startsWith("/test-projects-artifacts/")){return e}if(t&&s){return`${s}${e}`}return`https://res.cloudinary.com/testim/image/upload${e}`}t.convertTestResultArtifactUrlToCloudinaryOrMinio=o},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=s(4);const o=s(50);const n=s(323);o.render((0,i.jsx)(n.App,{}),document.getElementById("react-root"))},,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.App=void 0;const i=s(4);s(324);s(325);const o=s(0);const n=s(288);const r=s(326);const a=s(806);const c=s(11);const l=s(807);const u=s(814);const d=s(840);const p=s(20);const h=s(850);const f=s(99);const m=s(117);const g=s(69);const v=({children:e})=>{const t=(0,n.useLocation)();(0,o.useEffect)((()=>{const e=t.pathname.replace("/","");r.UIContainer.get(f.BugimOutput).sendCurrentData({state:e})}),[t]);return e};const S=()=>{(0,p.useAsyncEffect)((async()=>{const e=r.UIContainer.get(g.BugimDataStore);const t=r.UIContainer.get(f.BugimOutput);r.UIContainer.get(h.BugimInput).start();t.log("fab is running",window.location.toString());r.UIContainer.get(m.BaseHostService).connect();e.subscribe("screenshotImage",(e=>t.sendCurrentData({screenshotImage:e})));e.subscribe("annotateImage",(e=>t.sendCurrentData({annotateImage:e})));e.subscribe("timer",(e=>t.sendCurrentData({timer:e})))}),[]);return(0,i.jsxs)(c.DependencyInjectionProvider,{container:r.UIContainer,children:[(0,i.jsx)(a.ModalProvider,{}),(0,i.jsx)(n.HashRouter,{children:(0,i.jsx)(v,{children:(0,i.jsxs)(n.Routes,{children:[(0,i.jsx)(n.Route,{path:"/recording",element:(0,i.jsx)(l.Recording,{})}),(0,i.jsx)(n.Route,{path:"/annotate",element:(0,i.jsx)(u.Annotate,{})}),(0,i.jsx)(n.Route,{path:"/publish",element:(0,i.jsx)(d.Publish,{})}),(0,i.jsx)(n.Route,{path:"*",element:(0,i.jsx)(n.Navigate,{to:"/recording"})})]})})})]})};t.App=S},function(e,t,s){"use strict";s.r(t);t["default"]={}},function(e,t,s){"use strict";s.r(t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UIContainer=void 0;s(113);const i=s(190);const o=s(99);const n=s(88);Object.defineProperty(t,"UIContainer",{enumerable:true,get:function(){return n.UIContainer}});n.UIContainer.bind(i.BugimOutput).to(o.BugimOutput)},function(e,t,s){"use strict";s.r(t);s.d(t,"segmentAnalytics",(function(){return m}));var i=s(7);var o=s.n(i);var n=s(42);var r=s.n(n);const a=i["Logger"].getLogger("segment-analytics");const c=200;const l="https://api.segment.io/v1/track";const u={secret:"sJOSIGKa5x5rJEGsaOlCjrgozAf7FnVY",context:{library:{name:"Testim REST API",version:"1.0.0"}}};const d=[];function p(){const e=d.shift();if(e){n["httpRequest"].postJson(l,e).then(h).catch((t=>{a.error("failed to send to segment",t,e);h()}))}}function h(){setTimeout(p,c)}function f(e,t,s){const i=Object.assign({},u,{properties:s});i.userId=t;i.event=e;return i}const m={track(e,t,s){if(false){}s||(s={});s.timestamp=new Date;d.push(f(e,t,s));if(d.length===1){h()}}}},,,,,,,,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.throttleFunction=void 0;function i(e,{callsNum:t,delayMs:s}){const i=[];const o=[];let n=0;const r=()=>{const a=Date.now();const c=o.at(-1);const l=a-s;if(c===undefined||c<=l){o.length=0}else{o.splice(0,o.findIndex((e=>e>l)))}while(i.length&&o.length+n<t){const t=i.shift();++n;(async()=>{try{const s=await e(...t.args||[]);t.resolve(s)}catch(e){t.reject(e)}finally{--n;o.push(Date.now());if(i.length&&o.length===1){setTimeout(r,s)}}})()}if(i.length&&o.length){setTimeout(r,o[0]+s-a)}};return(...e)=>new Promise(((t,s)=>{i.push({args:e,resolve:t,reject:s});r()}))}t.throttleFunction=i},,,,,,,,function(e,t){(function(){var e=this;!function(){var t=e.analytics=e.analytics||[];if(!t.initialize)if(t.invoked)e.console&&console.error&&console.error("Segment snippet included twice.");else{t.invoked=true;t.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];t.factory=function(e){return function(){var s=Array.prototype.slice.call(arguments);s.unshift(e);t.push(s);return t}};for(var s=0;s<t.methods.length;s++){var i=t.methods[s];t[i]=t.factory(i)}t.load=function(e){var t=document.createElement("script");t.type="text/javascript";t.async=true;t.src="https://cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)};t.SNIPPET_VERSION="3.1.0";t.load("sJOSIGKa5x5rJEGsaOlCjrgozAf7FnVY")}}()}).call(window)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryParamsContainer=void 0;class i{constructor(e){const t=e.split("?");if(t.length<2){return}const s=t[t.length-1];const i=new URL(`http://demo.io?${s}`).searchParams;this.utmCampaign=i.get("utm_campaign");this.utmContent=i.get("utm_content");this.utmMedium=i.get("utm_medium");this.utmSource=i.get("utm_source");this.utmTerm=i.get("utm_term");this.referrer=i.get("referrer")}get hasParams(){return Boolean(this.referrer||this.utmCampaign||this.utmContent||this.utmMedium||this.utmSource||this.utmTerm)}}t.QueryParamsContainer=i},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimStepApi=void 0;const i=s(13);class o extends i.TestimBaseApi{get(e,t){return this.getJson(`/step/${e}?projectId=${t}`)}async getBulk(e,t){return await this.postJson(`/step/batch?projectId=${t}`,{stepsIds:e})}async getSharedBulk(e,t){return await this.postJson(`/step/shared/batch?projectId=${t}`,{stepsIds:e})}async getShallowSharedSteps(e,t){return await this.postJson(`/step/v2/classes?projectId=${t}`,{steps:e})}async updateScreenImage(e,t,s,i){await this.putJson(`/step/screenImage/${e}?projectId=${t}`,{screenImage:s,screenHighlight:i})}}t.TestimStepApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimResultsApi=void 0;const i=s(13);const o="/result";const n=1e4;class r extends i.TestimBaseApi{updateStep(e,t,s,i,r,a){r.stepResultId=i;return this.updateAndRetry((()=>this.postJson(`${o}/step`,{projectId:e,resultId:t,testId:s,stepResultId:i,stepData:r,remoteRunId:a},n)),`stepResult:${e}:${t}:${i}`)}updateSetupStep(e,t,s,i,r){return this.updateAndRetry((()=>this.postJson(`${o}/setupStep`,{projectId:e,resultId:t,testId:s,setupStep:i,remoteRunId:r},n)),`testResult:${e}:${t}`)}async updateTestCompleted(e,t,s,i,o){await this.waitUntilAllStartsWithKeysFulfilled(`stepResult:${e}:${t}`);await this.updateTest(e,t,s,i,o)}updateLightweightTest(e,t,s,i){return this.updateAndRetry((()=>this.postJson(`${o}/lightweight/test`,{projectId:e,resultId:t,testId:s,testResult:i},n)),`lightweightTest:${e}:${t}`,3)}updateTest(e,t,s,i,r){return this.updateAndRetry((()=>this.postJson(`${o}/test`,{projectId:e,resultId:t,testId:s,testResult:i,remoteRunId:r},n)),`testResult:${e}:${t}`)}updateRunConfigAndRunParams(e,t,s,i,r,a){return this.updateAndRetry((()=>this.postJson(`${o}/runParamsAndRunConfig`,{projectId:e,resultId:t,testId:s,runConfig:i,runParamsUrl:r,remoteRunId:a},n)),`testResult:${e}:${t}`)}tagFailureType(e,t,s){return this.updateAndRetry((()=>this.postJson(`${o}/failureType`,{projectId:e,resultIds:t,...s},n)),`testResultFailureType:${e}`)}updateExecutionTests(e){return this.putJson(`${o}/run/tests`,e)}addNeedsImprove(e,t,s,i){return this.postJson(`${o}/needImprove`,{projectId:e,resultId:t,testId:s,needImprove:i})}addImprovedLocatorRuns(e,t,s,i,n){return this.postJson(`${o}/improvedLocatorResults`,{projectId:e,resultId:t,testId:s,diffs:n,wasResultSuccess:Boolean(i)})}getExecutedTestListByTimePeriod(e,t,s){return this.getJson(`${o}/executed-list?projectId=${e}&startTime=${t}&endTime=${s}`)}}t.TestimResultsApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimSuiteApi=void 0;const i=s(13);const o=s(5);const n="/suite";class r extends i.TestimBaseApi{getNames(e,t,s){if(e===o.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&t){return Promise.resolve()}return this.getJson(`${n}/suiteNames?projectId=${e}&branch=${encodeURIComponent(s||"")}`)}getAll(e,t){return this.getJson(`${n}?projectId=${e}&branch=${encodeURIComponent(t)}`)}get(e,t,s){return this.getJson(`${n}/${s}?projectId=${e}&branch=${encodeURIComponent(t)}`)}getRunInfoList(e,t,s,i,o,r,a,c){return this.postJson(`${n}/v2/list`,{projectId:e,labels:i,testIds:s,testNames:o,testConfigNames:r,suiteNames:a,branch:t,rerunFailedByRunId:c})}async create(e,t,s,i,o,r,a){const c={projectId:e,suite:{id:t,name:s,description:i},testIds:o,branch:r,userId:a};await this.postJson(n,c);return c}update(e,t,s,i,o,r,a,c){return this.putJson(`${n}/${t}`,{projectId:e,suite:{id:t,name:s,description:i},testIds:o,branch:r,userId:a,previousVersion:c})}delete(e,t,s,i){return this.deleteJson(n,{projectId:e,suiteIds:t,branch:s,userId:i})}}t.TestimSuiteApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimStorageApi=void 0;const i=s(114);const o=s(7);const n=s(13);const r=o.Logger.getLogger("testim-storage-api");const a=10;const c=3*1e3;const l=20*1e3;class u extends n.TestimBaseApi{relativize(e){return e.startsWith("/")?e:`/${e}`}getStorageFullPath(e,t,s){return`/storage${this.getStorageRelativePath(e,t,s)}`}getStorageRelativePath(e,t,s){let i=this.relativize(e);if(s){i=`/${s}${i}`}if(t){i=`/${t}${i}`}return i}downloadJSONFile(e,t,s,i){if(typeof e==="object"){return Promise.resolve(e)}const o=this.getStorageRelativePath(e,t,s);return this.getJson(`/storage${o}`,undefined,i||a,c)}downloadJSONFiles(e){const t=e.map((e=>`/storage${this.relativize(e)}`));return Promise.all(t.map((e=>this.getJson(e,undefined,a,c))))}downloadFile(e,t,s){if(typeof e==="object"){return Promise.resolve(e)}const i=this.getStorageRelativePath(e,t,s);return this.get(`/storage${i}`,undefined,undefined,a,c)}downloadFiles(e){const t=e.map((e=>`/storage${this.relativize(e)}`));return Promise.all(t.map((e=>this.getJson(e,undefined,a,c))))}convertObjectToStringForMultipleFormField(e,t){let s="{}";try{if(t){const e={};for(const[s,i]of Object.entries(t)){e[s]=!i||typeof i!=="object"?String(i):JSON.stringify(i)}s=t?JSON.stringify(e):"{}"}}catch(t){r.error(`failed to parse object for ${e}`,t)}return s}uploadFile(e,t,s,i={},o={},n=undefined,r=undefined,a=undefined){const c=this.convertObjectToStringForMultipleFormField(e,s);const u=this.convertObjectToStringForMultipleFormField(e,o);return this.postFormDataWithRetries(`/storage${this.relativize(e)}`,{metadata:c,tagging:u},{file:t},n,undefined,i,r!==undefined?r:l,a)}copyImageToPersistentBucket({projectId:e,fileUrl:t}){return this.postJson(`/storage/clone/${e}${this.relativize(t)}`,{sourceBucket:"test-result-artifacts",targetBucket:"test-projects-artifacts"})}listFiles(e){return this.getJson(`/storage/list${e}`,undefined,a,c)}getProjectArtifactPath(e,t){return this.getStorageRelativePath(e,"test-projects-artifacts",t)}async uploadProjectJsonArtifact(e,t,s){if(typeof s!=="string"){s=JSON.stringify(s)}return await this.uploadProjectArtifact(e,t,s,"application/json")}async uploadProjectArtifact(e,t,s,o){const n=await(0,i.compressToGzip)(s,o);return await this.uploadFile(e,{fileName:t,mimeType:o,file:n},undefined,{"X-Asset-Encoding":"gzip"})}}t.TestimStorageApi=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTestApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getTest(e,t,s,i,o,n=true,r=false,a=undefined){const c=[`projectId=${o}`,`branch=${encodeURIComponent(i)}`,`revisionId=${t}`,`overrideTestConfigId=${s}`,`skipSharedSteps=${n}`,`useBranchMap=${r}`,a!==undefined?`includeMobileProjectApps=${a}`:undefined].filter(Boolean).join("&");return this.getJson(`/test/${e}?${c}`)}getAll(e,t,s=false){return this.getJson(`/test?projectId=${e}&branch=${encodeURIComponent(t)}&includeArchived=${s}`)}getAllLean(e,t){return this.getJson(`/test/lean?projectId=${e}&branch=${encodeURIComponent(t)}`)}getResult(e,t,s,i){return this.getJson(`/test/v2/${e}/result/${t}?projectId=${s}&branch=${encodeURIComponent(i)}`)}getGraph(e,t,s="",i=1e3){return this.getJson(`/test/graph?projectId=${e}&branch=${encodeURIComponent(t)}&label=${s}&testsCountLimit=${i}`)}getLastSuccessfulResult(e,t,s,i){return this.getJson(`/test/${e}/lastSuccessfulResult?projectId=${t}&branch=${encodeURIComponent(s)}&startTime=${i}`)}getResultRunData(e,t,s){return this.getJson(`/test/v2/${e}/result/${t}/runData?projectId=${s}`)}getRevisions(e,t,s){return this.getJson(`/test/${e}/revision?projectId=${s}&branch=${encodeURIComponent(t)}`)}getTestRevisions(e,t,s){return this.getJson(`/test/${e}/revision?projectId=${s}&branch=${encodeURIComponent(t)}&type=test`)}getRevisionsTree(e,t){return this.getJson(`/test/${e}/revisions-tree/?projectId=${t}`)}getBulkRevisions(e,t,s){return this.postJson("/test/revision",{projectId:t,branch:e,infoIds:s})}updateTestLabel(e,t,s){return this.putJson(`/test/${e}/label`,{projectId:s,labels:t})}updateTestsLabel(e,t,s){return this.putJson("/test/label",{testIds:e,projectId:s,label:t})}pruneTestsLabel(e,t,s){return this.deleteJson("/test/label",{testIds:e,projectId:s,label:t})}updateTestsOwner({projectId:e,branch:t,testIds:s,newOwnerUserId:i}){return this.putJson("/test/owner",{projectId:e,branch:t,testIds:s,newOwnerUserId:i})}renameTest(e,t,s){return this.putJson(`/test/${e}/name`,{projectId:t,name:s})}updateTestStatus({testIds:e,projectId:t,branch:s,oldTestStatus:i,newTestStatus:o}){return this.putJson("/test/testStatus",{testIds:e,projectId:t,branch:s,oldTestStatus:i,newTestStatus:o})}save(e,t,s,i,o,n,r,a,c){return this.postJson("/test/v2",{projectId:e,saveInfo:t,steps:s,test:n,branch:r,testConfig:a,customData:c,sharedSteps:i,childSharedStepInfoIds:o,sessionType:"codeless"},5*6e4,3)}deleteTests(e,t,s,i){t=Array.isArray(t)?t:[t];return this.deleteJson("/test",{projectId:e,testIds:t,userId:s,branch:i})}unArchiveTests(e,t,s){t=Array.isArray(t)?t:[t];return this.postJson("/test/unarchive",{projectId:e,testIds:t,branch:s})}hideCustomActions(e,t){return this.deleteJson("/test/customAction",{projectId:e,actions:t})}unhideCustomActions(e,t){return this.putJson("/test/customAction/unhide",{projectId:e,actions:t})}toggleTestResultPeriod(e,t,s){return this.postJson("/test/result-history",{projectId:e,testId:t,resultId:s})}updateTestsConfig(e,t,s){return this.putJson("/test/config/bulk",{projectId:e,testConfigId:s,testIds:t})}getLogs(e,t,s){return this.getJson(`/test/${t}/result/${s}/log?projectId=${e}`)}loadAdditionalParamsForStepResult(e,t){return this.getJson(`/test/step-result/${t}/additional-params?projectId=${e}`)}getAllTestsContainingApplitoolsStep(e,t){return this.getJson(`/test/applitoolsTests?projectId=${e}&branch=${t}`)}}t.TestimTestApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimLocatorsApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getLocators(e,t){return this.getJson(`/locator/?projectId=${t}&locatorIds=${JSON.stringify(e)}`)}getImagesSimilarityScore(e,t,s,i){return this.postJson("/locator/image-similarity-score",{record_url:e,images:t,projectId:s,extraInfo:i})}getLocateMl(e,t,s,i,o){return this.postJson("/locator/locate-element-in-dom",{recordAttributes:e,playbackDom:t,playbackDevice:s,projectId:i,extraInfo:o})}}t.TestimLocatorsApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimRemoteApi=void 0;const i=s(13);class o extends i.TestimBaseApi{runScheduler(e){return this.postJson("/run/scheduled-job",e)}runTest(e){return this.postJson("/run/remote-test",e)}abortRun(e,t){return this.deleteJson("/run",{projectId:e,remoteRunId:t})}testUrlAvailability(e){return this.postJson("/run/url-availability",{url:e})}}t.TestimRemoteApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAnalyticsSystemsApi=void 0;const i=s(13);const o=s(7);const n=s(5);const r=o.Logger.getLogger("TestimAnalyticsSystemsApi");const a="/analyticsSystems";const c=e=>e===n.commonConstants.defaults.FAKE_CODE_PROJECT_ID;class l extends i.TestimBaseApi{async dispatchEvent(e,t,s,i,o){try{if(c(e)){return}await this.postJson(`${a}/dispatchEvent/`,{projectId:e,entityId:t,eventType:s,parentEntityId:i,eventData:o})}catch(t){r.error("failed dispatching event",{projectId:e,err:t})}}async dispatchSignupEvent(e,t,s){try{if(c(e)){return}await this.postJson(`${a}/dispatchSignupEvent/`,{projectId:e,entityId:t,eventType:"signup",eventData:s})}catch(t){r.error("failed dispatching signup event",{projectId:e,err:t})}}}t.TestimAnalyticsSystemsApi=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTmsApi=void 0;const i=s(5);const o=s(13);const n=e=>e===i.commonConstants.defaults.FAKE_CODE_PROJECT_ID;const r="/integration/tms";class a extends o.TestimBaseApi{async providers(e){if(n(e)){return undefined}return await this.getJson(`${r}/providers?projectId=${e}`)}async connected(e){if(n(e)){return undefined}return await this.getJson(`${r}/connected?projectId=${e}`)}connect(e,t,s){return this.postJson(`${r}/connect?projectId=${e}`,Object.assign({},{provider:t},s))}disconnect(e){return this.getJson(`${r}/disconnect?projectId=${e}`)}async getProjects(e){if(n(e)){return undefined}return await this.getJson(`${r}/projects?projectId=${e}`)}setProjectLink(e,t){const s=Array.from(t);return this.postJson(`${r}/link/project?projectId=${e}`,{tmsProjectIds:s})}async getTests(e,t){if(n(e)){return undefined}return await this.getJson(`${r}/tests?projectId=${e}&tmsProjectId=${t}`)}async setTests(e,t,s){if(n(e)){return undefined}return await this.postJson(`${r}/tests?projectId=${e}&tmsProjectId=${t}`,{testCases:s})}async checkMappedTests(e,t,s,i){if(n(e)){return undefined}return await this.postJson(`${r}/mapped-tests?projectId=${e}&tmsProjectId=${t}&branchId=${s}`,{testIds:i})}async getProjectTMSObj(e){if(n(e)){return undefined}return await this.getJson(`${r}/project?projectId=${e}`)}async getProjectLink(e){if(n(e)){return undefined}return await this.getJson(`${r}/link/project?projectId=${e}`)}async setMapTestsInDB(e,t,s){if(n(e)){return undefined}return await this.postJson(`${r}/save-tests`,{mappedTests:s,tmsProjectId:t,projectId:e})}}t.TestimTmsApi=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAutoGroupingApi=void 0;const i=s(13);const o=s(7);const n=o.Logger.getLogger("TestimAutoGroupingApi");const r="/autoGrouper";class a extends i.TestimBaseApi{async autoGroup(e,t,s,i,o){try{return await this.postJson(`${r}/`,{projectId:t,sharedStepInfoId:e.sharedStepInfoId,branch:s,saveTestData:i,forkData:o})}catch(e){n.error("Failed to auto group :(",{projectId:t,err:e});throw new Error(e.response)}}async autoGroupReplace(e,t,s,i,o){try{return await this.postJson(`${r}/replace`,{projectId:t,branch:s,saveTestData:i,forkData:o,replacedStepsGroup:e})}catch(e){n.error("Failed to auto group :(",{projectId:t,err:e});throw new Error(e.response)}}}t.TestimAutoGroupingApi=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimUserApi=void 0;const i=s(13);const o="/v2/user";class n extends i.TestimBaseApi{updatePreferences(e,t){return this.putJson(`${o}/preferences`,{userId:e,preferences:t})}getPreferences(){return this.getJson(`${o}/preferences`)}updatePhoneNumber(e,t){return this.putJson(`${o}/phone`,{userId:e,phoneNumber:t})}updateName(e,t){return this.putJson(`${o}/name`,{userId:e,name:t})}updateRole(e,t){return this.putJson(`${o}/role`,{userId:e,role:t})}updatePersonalInfo(e,t){return this.putJson(`${o}/personal-info`,{userId:e,data:t})}}t.TestimUserApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimSuggestionsApi=t.FilterBy=t.SortBy=void 0;const i=s(13);var o;(function(e){e["Magic"]="magic";e["MagicDsc"]="magicDsc";e["MatchLengthAsc"]="matchLengthAsc";e["MatchLengthDsc"]="matchLengthDsc";e["NumberOfTestsAsc"]="numberOfTestsAsc";e["NumberOfTestsDsc"]="numberOfTestsDsc"})(o||(t.SortBy=o={}));var n;(function(e){e["Owner"]="owner";e["TestName"]="TestName";e["SuiteName"]="suiteName";e["GroupName"]="groupName"})(n||(t.FilterBy=n={}));class r extends i.TestimBaseApi{getSuggestions(e,t,s=false){return this.getJson(`/suggestions/${e}/${encodeURIComponent(t)}?includeExpandData=${Boolean(s)}`)}getSuggestionsFiltered(e,t,{includeExpandData:s=true,allowedTestIds:i,allowedGroupIds:n,sort:r=o.Magic,minSteps:a,maxSteps:c}){return this.postJson(`/suggestions/${e}/${encodeURIComponent(t)}`,{includeExpandData:s,allowedTestIds:i,allowedGroupIds:n,sort:r,minSteps:Math.min(100,Math.max(0,a||0)),maxSteps:Math.max(0,Math.min(100,c||0))})}applySuggestion(e,t,s,i,o){return this.postJson("/suggestions/apply",{projectId:e,forkData:t,author:s,groupName:i,suggestion:o})}loadGroupSignatures(e,t){return this.getJson(`/suggestions/group-signature/${e}/${encodeURIComponent(t)}`)}computeSuggestions(e){return this.postJson("/suggestions/compute",{projectId:e})}}t.TestimSuggestionsApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimSlackApi=void 0;const i=s(13);const o=s(5);class n extends i.TestimBaseApi{disconnect(e){return this.getJson(`/integration/slackBot/disconnect?projectId=${e}`,undefined,0,0,false)}connected(e){if(e===o.commonConstants.defaults.FAKE_CODE_PROJECT_ID){return Promise.resolve({})}return this.getJson(`/integration/slackBot/connected?projectId=${e}`,undefined,0,0,false)}getChannels(e){return this.getJson(`/integration/slackBot/channels?projectId=${e}`)}doesChannelExist(e,t){return this.getJson(`/integration/slackBot/check?projectId=${e}&channelId=${t}`)}}t.TestimSlackApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimExecutionApi=void 0;const i=s(7);const o=s(13);const n=s(5);const r="/result/run";const a="/executions/v2/count";const c=i.Logger.getLogger("testim-execution-api");class l extends o.TestimBaseApi{constructor(){super(...arguments);this.count=(e,t)=>this.countRequestBuilder({companyId:e,startTime:t});this.countByType=(e,t,s)=>this.countRequestBuilder({companyId:e,startTime:t,type:s});this.countByDates=(e,t,s)=>this.countRequestBuilder({companyId:e,startTime:t,endTime:s});this.countByDatesByProject=(e,t,s)=>this.countRequestBuilder({companyId:e,startTime:t,endTime:s,byProject:true});this.countByDatesByProjectType=(e,t,s,i=n.commonConstants.TEST_QUOTA_TYPE.WEB)=>this.countRequestBuilder({companyId:e,startTime:t,endTime:s,byProject:true,type:i});this.countRequestBuilder=({companyId:e,startTime:t,endTime:s,byProject:i,type:o})=>{let n=`${a}?companyId=${e}&startTime=${t}`;if(s){n+=`&endTime=${s}`}if(i!==undefined){n+=`&byProject=${i}`}if(o!==undefined){n+=`&type=${o}`}return this.getJson(n)}}reportStarted(e,t,s,i,o,n,a){c.log("localExecutionStarted: ",{executionId:e,projectId:t,labels:s,startTime:i,executions:o,config:n});return this.postJson(r,{runId:e,projectId:t,labels:s,startTime:i,execution:o,config:n,status:"RUNNING",show:a})}reportFinished(e,t,s){c.log("localExecutionFinished: ",e,t,s);const i=Date.now();return this.putJson(r,{runId:e,projectId:t,endTime:i,status:"FINISHED",success:s})}reportAborted(e,t){c.log("localExecutionAborted: ",e,t);const s=Date.now();return this.putJson(r,{runId:e,projectId:t,endTime:s,status:"ABORTED",success:false})}updateTest(e){c.log("updateTestStatus: ",e);const{executionId:t,...s}=e;return this.putJson(`${r}/test`,{...s,runId:t})}getExecutionAndTimestampsById(e,t){return this.getJson(`/executions/${t}?projectId=${e}`,undefined,1)}getAllResultLabels(e,t=0){return this.getJson(`/real-data/runResult/distinct/resultLabels?projectId=${e}&startTime=>=${t}`)}}t.TestimExecutionApi=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTestPlanApi=void 0;const i=s(13);const o="/testPlan";class n extends i.TestimBaseApi{getAll(e){return this.getJson(`${o}?projectId=${e}`)}async create(e){await this.postJson(o,e)}async update(e){await this.putJson(`${o}/${e.testPlanId}`,e)}async delete(e,t){await this.deleteJson(o,{projectId:e,testPlanIds:t})}getRunInfoList(e,t,s){return this.postJson(`${o}/list`,{projectId:e,names:s,branch:t})}}t.TestimTestPlanApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAuditLogApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getByCompanyId(e){const{companyId:t,section:s,action:i,userEmail:o,page:n}=e;const r=new URLSearchParams;r.set("companyId",t);if(s){r.set("section",s)}if(i){r.set("action",i)}if(o){r.set("userEmail",o)}if(n){r.set("page",String(n))}return this.getJson(`/auditLog?${r}`)}getByCompanyIdV2(e){return this.postJson("/auditLog",e)}}t.TestimAuditLogApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimRealDataApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getDataV2(e,t){return this.postJson(`/real-data/${e}`,t)}filterToQuery(e){return Object.entries(e).map((([e,t])=>{if(!Array.isArray(t)){return`${e}=${encodeURIComponent(t)}`}return t.map((t=>`${e}[]=${encodeURIComponent(t)}`)).join("&")})).join("&")}async getDownloadCsv(e,t,s,i){const o=await this.getToken();const n=this.filterToQuery(s);const r=new URL(`${this.baseUrl}/real-data/${t}/download?${n}`);r.searchParams.append("access_token",o);r.searchParams.append("fileName",i);if(!r.searchParams.has("projectId")){r.searchParams.append("projectId",e)}return r.toString()}}t.TestimRealDataApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimLabFeaturesApi=void 0;const i=s(5);const o=s(115);const n=s(13);class r extends n.TestimBaseApi{getAllFeatures(e){if(e===i.commonConstants.defaults.FAKE_CODE_PROJECT_ID){return Promise.resolve([])}return this.getJson(`/labFeature/v2/project/${e}`)}updateLabFeatureProject(e){return this.putJson("/labFeature/v2/project-feature",e)}markSunsettingLabFeaturesAsViewed(e){if(e.projectId===i.commonConstants.defaults.FAKE_CODE_PROJECT_ID||(0,o.isDemoProjectId)(e.projectId)){return Promise.resolve()}return this.putJson("/labFeature/v2/viewed-sunsetting",e)}}t.TestimLabFeaturesApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PublicApiKeysManagementApi=void 0;const i=s(13);const o="/publicApiKeys";class n extends i.TestimBaseApi{getAll(e){return this.getJson(`${o}/${e}`)}create(e,t){return this.postJson(`${o}/${e}`,{name:t})}update(e,t,s){return this.putJson(`${o}/${e}/${encodeURIComponent(t)}`,{name:s})}delete(e,t){return this.deleteJson(`${o}/${e}/${encodeURIComponent(t)}`,{})}}t.PublicApiKeysManagementApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTestConfigApi=void 0;const i=s(13);class o extends i.TestimBaseApi{save(e,t){return this.postJson("/testConfig",{testConfig:t,projectId:e})}clone(e,t){return this.postJson("/testConfig/clone",{cloneConfigsInfo:t,projectId:e})}getConfigList(e){return this.getJson(`/testConfig/${e}`)}getConfigUsage(e,t){return this.getJson(`/testConfig/${t}/usage?projectId=${e}`)}}t.TestimTestConfigApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimReportApi=void 0;const i=s(13);const o="/reports";class n extends i.TestimBaseApi{buildQueryParams({projects:e,startDate:t,endDate:s}){return`${e.map((e=>`projectIds=${encodeURIComponent(e)}`)).join("&")}&startDate=${encodeURIComponent(t)}&endDate=${encodeURIComponent(s)}`}getTests(e){return this.getJson(`${o}/v2/improve?${this.buildQueryParams(e)}`)}getRunsReport(e){return this.postJson(`${o}/v3/runs`,e)}getFailureTypesReport(e){return this.postJson(`${o}/v3/failure-types`,e)}getMostBrokenTestsV2(e){return this.postJson(`${o}/v3/top-failures`,e)}getRunningTestsReport(e){return this.postJson(`${o}/v3/running-tests`,e)}getActivityReport(e){return this.postJson(`${o}/v3/activity`,e)}getLocatorAccuracyV2(e){return this.postJson(`${o}/v3/locator-accuracy`,e)}getFilterOptions(e){return this.postJson(`${o}/v3/filters`,e)}getTeamProductivity(e){return this.postJson(`${o}/v3/teamProductivity`,{...e,projectIds:[]})}}t.TestimReportApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UtilityApis=void 0;const i=s(13);class o extends i.TestimBaseApi{signCloudinaryImageUrl(e){return this.getJson(`/cloudinary/token/${e}`)}}t.UtilityApis=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimFolderApi=void 0;const i=s(13);class o extends i.TestimBaseApi{listFolders({projectId:e,branch:t,type:s,includeArchived:i=false,isMobile:o=false}){return this.getJson(`/folders?projectId=${e}&branch=${encodeURIComponent(t)}&type=${s}&includeArchived=${i}&isMobile=${o}`)}getRevisionsTree(e,t){return this.getJson(`/folders/${e}/revisions-tree/?projectId=${t}`)}createFolder({projectId:e,branch:t,name:s,type:i,parentFolderInfoId:o}){return this.postJson("/folders",{projectId:e,branch:t,name:s,type:i,parentFolderInfoId:o})}updateFolder({projectId:e,branch:t,folderInfoId:s,name:i,addedChildren:o,removedChildren:n}){return this.putJson(`/folders/${s}`,{projectId:e,branch:t,name:i,addedChildren:o,removedChildren:n})}moveChildren({projectId:e,branch:t,previousParent:s,newParent:i,children:o}){return this.putJson("/folders/move",{projectId:e,branch:t,previousParent:s,newParent:i,children:o})}archiveFoldersAndTests({projectId:e,branch:t,folderInfoIds:s,testIds:i}){return this.deleteJson("/folders/",{projectId:e,branch:t,folderInfoIds:s,testIds:i})}unarchiveFolder({projectId:e,branch:t,folderInfoId:s}){return this.putJson(`/folders/unarchive/${s}`,{projectId:e,branch:t})}}t.TestimFolderApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimSharedStepApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getAllTestsContainingStep(e,t,s){if(!s.length){return[]}return this.getJson(`/sharedSteps?projectId=${e}&branch=${encodeURIComponent(t)}&${s.map((e=>`sharedStepInfoId=${encodeURIComponent(e)}`)).join("&")}`)}getRevisionsTree(e,t){return this.getJson(`/sharedSteps/${e}/revisions-tree/?projectId=${t}`)}updateLock(e,t,s){return this.putJson(`/sharedSteps/${e}/lock?projectId=${t}`,{isLocked:s})}}t.TestimSharedStepApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimRemoteBranch=void 0;const i=s(13);const o="/remoteBranch";class n extends i.TestimBaseApi{async fetchRemoteBranchData(e){return this.get(`${o}?projectId=${e}`)}async addRemoteBranch(e,t,s,i){const n=`projectId=${e}&remoteCompanyId=${s}&remoteProjectId=${t}&localBranchName=${encodeURIComponent(i)}`;return this.postJson(`${o}?${n}`,null)}async updateRemoteBranch(e){return this.putJson(`${o}?projectId=${e}`,null)}async removeRemoteBranch(e){return this.deleteJson(`${o}?projectId=${e}`,null)}}t.TestimRemoteBranch=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimPullRequestApi=void 0;const i=s(13);const o=["awaitingReview","changesRequested","approved"];const n=["merged","closed"];const r="/pull-request";class a extends i.TestimBaseApi{async listPullRequests(e,t=0,s=50,i={branchNameFilter:[],showClosedPRS:false,statusFilter:[],submitterFilter:[]}){let{statusFilter:n}=i;const{branchNameFilter:a,showClosedPRS:c,submitterFilter:l}=i;if(!c&&!n.length){n=o}const u=new URLSearchParams({page:t.toString(),pageSize:s.toString(),branchNameFilter:a.toString(),submitterFilter:l.toString(),statusFilter:n.toString()});return this.getJson(`${r}/${e}?${u.toString()}`)}async getPullRequest(e,t,s){let i=`${r}/${e}/${t}`;if(s){i=`${i}?loadComments=true`}return this.getJson(i)}async getPullRequestByBranches(e,t,s){const i=new URLSearchParams({excludeStatus:n.join(",")});return this.getJson(`${r}/${e}/${encodeURIComponent(t)}/${encodeURIComponent(s)}?${i.toString()}`)}async createPullRequest({projectId:e,sourceBranch:t,targetBranch:s,title:i,comment:o}){return this.postJson(`${r}/${e}`,{sourceBranch:t,targetBranch:s,title:i,comment:o})}async transitionPullRequestStatus(e,t,s,i,o){return this.putJson(`${r}/${e}/${t}`,{status:s,revisionData:i,comment:o})}async mergePullRequest(e){const{projectId:t,pullRequestId:s}=e;return this.putJson(`${r}/${t}/${s}/merge`,e)}}t.TestimPullRequestApi=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimSchedulerApi=void 0;const i=s(13);const o=s(5);const n="/schedulers";class r extends i.TestimBaseApi{getAll({projectId:e,isPlaygroundMode:t}){if(e===o.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&t){return Promise.resolve([])}return this.getJson(`${n}?projectId=${e}`)}create(e){return this.postJson(n,e)}update(e){return this.putJson(`${n}/${e.schedulerId}`,e)}enable(e,t,s,i){return this.putJson(`${n}/${t}/enable`,{projectId:e,token:s,enable:i})}deleteSchedulers(e,t){return this.deleteJson(n,{projectId:e,schedulerIds:t})}}t.TestimSchedulerApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimGridApi=void 0;const i=s(6);const o=s(13);const n=s(5);function r(e){e=i.merge({},e.external,e.browsers,e);e.gridId=e._id;delete e._id;delete e.browsers;delete e.external;delete e.isArchived;delete e.updated_at;delete e.created_at;return e}const a="/grid";class c extends o.TestimBaseApi{async isBrowserNumberValid(e,t,s,i,o,n,r){return this.getJson(`${a}/isBrowserNumberValid?companyId=${e}&type=${t}&chrome=${s}&firefox=${i}&edgeChromium=${o}&safari=${n}&gridId=${r}`)}createGrid(e,t){return this.postJson(a,Object.assign({companyId:e},r(t)))}updateGrid(e,t){return this.putJson(a,Object.assign({companyId:e},r(t)))}deleteGrid(e,t){return this.deleteJson(a,{companyId:e,gridIds:t})}migrate(e,t,s){return this.postJson(`${a}/${t}/migrate`,{companyId:e,toType:s})}async getAllGrids({companyId:e,isPlaygroundMode:t}){if(e===n.commonConstants.defaults.FAKE_CODE_COMPANY_ID&&t){return[]}return this.getJson(`${a}?companyId=${e}`)}async getGridsConfiguration(e){return this.getJson(`${a}/config?companyId=${e}`)}getGridUsage(e,t){return this.getJson(`/grid/${t}/usage?projectId=${e}`)}async getMobileDevicesFromGrid({projectType:e,gridId:t,companyId:s,selectors:i}){let o=`${a}/mobileDevices/${t}/${s}?projectType=${e}`;o=i?`${o}&selectors=${encodeURIComponent(i)}`:o;const n=await this.getJson(o);return n}}t.TestimGridApi=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimPlanApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getAll(e){return this.getJson(`/plan?companyId=${e}`)}getPlan(e){return this.getJson(`/plan/getPlan?planId=${e}`)}getCompanyPlanFromDb(e){return this.getJson(`/plan/companyPlan?companyId=${e}`)}switchToFreePlan(e){return this.putJson(`/plan/switchToFreePlan?companyId=${e}`)}switchToTrialPlan(e){return this.putJson(`/plan/switchToTrialPlan?companyId=${e}`)}switchToProPlan(e){return this.putJson(`/plan/switchToProPlan?companyId=${e}`)}updateTailoredPlan(e,t){return this.postJson("/plan/tailoredPlan",{companyId:e,planData:t})}updatePlan(e,t){return this.putJson("/plan",{companyId:e,planData:t})}updateL2CPlan(e,t){return this.putJson("/plan/l2c",{companyId:e,planData:t})}getBillingStartDate(e){return this.getJson(`/plan/billing-period-start-date?companyId=${e}`)}async getUsageForCurrentBillingPeriod(e){return this.getJson(`/plan/project/${e}/usage-current-billing-period`)}}t.TestimPlanApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimApplitoolsApi=void 0;const i=s(5);const o=s(13);class n extends o.TestimBaseApi{connect(e,t){return this.postJson("/integration/applitools/v3/connect",Object.assign({},t,{projectId:e}))}disconnect(e){return this.getJson(`/integration/applitools/v3/disconnect?projectId=${e}`,null,0,0,false)}connected(e){if(e===i.commonConstants.defaults.FAKE_CODE_PROJECT_ID){return Promise.resolve({})}return this.getJson(`/integration/applitools/v3/connected?projectId=${e}`,null,0,0,false)}}t.TestimApplitoolsApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAuthApi=void 0;const i=s(13);const o="/auth";class n extends i.TestimBaseApi{signout(e,t){return this.postJson(`${o}/signout`,{userId:e,refreshToken:t})}signup({name:e,email:t,password:s,allowPersonalEmail:i,metadata:n={}}){return this.rawPostJson(`${o}/signup`,{name:e,email:t,password:s,allowPersonalEmail:i,metadata:n})}signin(e,t,s){return this.rawPostJson(`${o}/signin`,{email:e,password:t,captcha:s})}authSSO(e){return this.rawPostJson(`${o}/sso/auth`,{token:e})}signinSSO(e){return this.rawGetJson(`${o}/sso/signin?email=${e}`)}validateUserSSO(e){return this.rawGetJson(`${o}/sso/validate-user?email=${e}`)}sendPasswordResetEmail(e){return this.rawPostJson(`${o}/reset`,{email:e})}resetPassword(e,t){return this.rawPutJson(`${o}/reset`,{token:e,password:t})}verifyResetPasswordToken(e){return this.rawGetJson(`${o}/reset/verify?token=${e}`)}changePassword(e,t,s){return this.putJson(`${o}/changePassword`,{userId:e,oldPassword:t,newPassword:s})}check(e){return this.refreshTokenOnExp((t=>this.rawGetJson(`${o}/check`,{Authorization:`Bearer ${(t||e).token}`})))}tryToCreateUser(e,t,s){return this.postJson(`${o}/verify-email`,{userId:e,email:t,password:s})}getMarketoDetails(e){return this.rawGetJson(`${o}/signupMarketoDetails/${e}`)}getMarketoDetailsByEmail(e){return this.rawGetJson(`${o}/signupMarketoDetailsByEmail/${e}`)}sendConfirmationEmail(e){return this.postJson(`${o}/confirmation-email`,{userId:e})}createInitialMarketoDetails({email:e,country:t,agreeToMarketing:s,agreeToTricentisPolicies:i,isSocialSignup:n=false,productType:r}){return this.rawPostJson(`${o}/initial-marketo-signup`,{email:e,country:t,agreeToMarketing:s,agreeToTricentisPolicies:i,isSocialSignup:n,productType:r})}updateMarketoDetails({email:e,...t}){return this.putJson(`${o}/update-marketo-signup`,{email:e,...t})}finalMarketoDetails(e){return this.putJson(`${o}/final-marketo-signup`,{email:e})}}t.TestimAuthApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimBranchApi=void 0;const i=s(13);class o extends i.TestimBaseApi{getRevisions(e,t){return this.getJson(`/branch/${encodeURIComponent(t)}/revision?projectId=${e}`)}getBranchesData(e){return this.getJson(`/branch/branchData?projectId=${e}`)}getBranchData(e,t){return this.getJson(`/branch/branchData/${encodeURIComponent(t)}?projectId=${e}`)}create(e,t,s,i=true){return this.postJson("/branch",{projectId:e,fromBranchName:t,newBranchName:s,createBranchAsync:i})}update(e,t,s){return this.putJson(`/branch/${encodeURIComponent(t)}`,{projectId:e,branchData:s})}merge(e,t,s,i,o,n,r,a){return this.postJson("/branch/merge",{projectId:e,author:i,targetBranch:t,sourceBranch:s,checkMd5:o,stagedEntities:n,mergeResolution:r,shouldDeleteBranch:a})}dryMerge(e,t,s,i){return this.postJson("/branch/dry-merge",{projectId:e,authorId:i,targetBranch:t,sourceBranch:s})}getBranchForkStatus(e,t){return this.getJson(`/branch/forkStatus?projectId=${e}&branchName=${encodeURIComponent(t)}`)}}t.TestimBranchApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimCompanyApi=void 0;const i=s(13);const o=s(5);const n="/company";class r extends i.TestimBaseApi{rename(e,t){return this.putJson(`${n}/name`,{companyId:e,name:t})}addOwner(e,t){return this.postJson(`${n}/owner`,{companyId:e,userId:t})}removeOwner(e,t){return this.deleteJson(`${n}/owner`,{companyId:e,userId:t})}replaceOwner(e,t,s){return this.putJson(`${n}/owner`,{companyId:e,userId:t,oldOwnerUserId:s})}getUsers(e){return this.getJson(`${n}/users?companyId=${e}`)}getUsersCount(e){return this.getJson(`${n}/users/count?companyId=${e}`)}getTestsCount(e){return this.getJson(`${n}/tests/count?companyId=${e}`)}getTestsCountByType(e,t){return this.getJson(`${n}/tests/count?companyId=${e}&type=${t}`)}async getProjects(e){if(e===o.commonConstants.defaults.FAKE_CODE_USER_ID){return undefined}return this.getJson(`${n}/projects?userId=${e}`)}getProjectsUsers(e){return this.getJson(`${n}/projects/users?companyId=${e}`)}getCompanies(e){return this.getJson(`${n}?userId=${e}`)}createProject(e,t){return this.postJson(`${n}/project`,{companyId:e,projectName:t})}deleteUser(e,t){return this.deleteJson(`${n}/user`,{companyId:e,userId:t})}deleteUsers(e,t){return this.deleteJson(`${n}/users`,{companyId:e,userIds:t})}invite(e,t,s,i,o){return this.postJson(`${n}/invite`,{companyId:e,emails:t,projectIds:s,captcha:i,addAsOwner:o})}getInvitedEmails(e){return this.getJson(`${n}/invites?companyId=${e}`)}deleteInvite(e,t){return this.deleteJson(`${n}/invite`,{companyId:e,email:t})}deleteInvites(e,t){return this.deleteJson(`${n}/invites`,{companyId:e,emails:t})}getCompany(e){return this.getJson(`${n}/company?companyId=${e}`)}getCompanyByProjectId(e){return this.getJson(`${n}/company/${e}`)}setCompanySSO(e,t,s){return this.postFormData(`${n}/sso/${t}?companyId=${e}`,{[t]:s})}getProjectsWithManageRights(e){return this.getJson(`${n}/projects/owned?companyId=${e}`)}getCompanyProjects(e){return this.getJson(`${n}/projects/${e}`)}searchCompanies(e,t=100,s=false){return this.getJson(`${n}/search?name=${encodeURIComponent(e)}&limit=${t}&includeArchived=${Boolean(s)}`)}setUCID(e,t){return this.postJson(`${n}/ucid`,{companyId:e,ucid:t})}setFollowL2c(e,t){return this.postJson(`${n}/followL2CPlan`,{companyId:e,followL2CPlan:t})}extendL2CTrial(e,t,s){return this.postJson(`${n}/extendL2CTrialPeriod`,{companyId:e,productFamily:t,days:s})}}t.TestimCompanyApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimEmailValidationApi=void 0;const i=s(13);class o extends i.TestimBaseApi{generatePermanentEmail(e){return this.getJson(`/email-validation/generate/permanent?projectId=${e}`)}getRecipients(e){return this.getJson(`/email-validation/recipient?projectId=${e}&permanentOnly=${true}`)}getRecipientsV2(e){return this.getJson(`/email-validation/recipient/v2?projectId=${e}&permanentOnly=${false}`)}generateTempEmail(e){return this.getJson(`/email-validation/generate?projectId=${e}`)}getInboxEmails(e,t){return this.getJson(`/email-validation/inbox?projectId=${e}&email=${t}`)}deleteEmail(e,t){return this.deleteJson("/email-validation/recipient",{projectId:e,email:t})}}t.TestimEmailValidationApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimIntegrationApi=void 0;const i=s(13);class o extends i.TestimBaseApi{checkGithub(e){return this.rawGetJson(`/integration/github/check?projectId=${e}`)}getGitHubRepos(e){return this.getJson(`/integration/github/repos?projectId=${e}`)}getGitHubIntegrationDetails(e){return this.getJson(`/integration/github/details?projectId=${e}`)}getAll(e){return this.getJson(`/integration?projectId=${e}`)}updateGitHubIntegration(e,t,s,i){return this.putJson("/integration/github",{projectId:e,create:t,merge:s,selectedRepo:i})}saveGitHubInstallationId(e,t){return this.putJson("/integration/github/install",{projectId:e,installationId:t})}disconnectGitHub(e){return this.putJson("/integration/github/disconnect",{projectId:e})}checkBitbucket(e){return this.rawGetJson(`/integration/bitbucket/check?projectId=${e}`)}getBitbucketRepos(e){return this.getJson(`/integration/bitbucket/repos?projectId=${e}`)}searchBitBucketRepos(e,t){return this.getJson(`/integration/bitbucket/search?projectId=${e}&term=${encodeURIComponent(t)}`)}getBitbucketIntegrationDetails(e){return this.getJson(`/integration/bitbucket/details?projectId=${e}`)}updateBitbucketIntegration(e,t,s,i){return this.putJson("/integration/bitbucket",{projectId:e,create:t,merge:s,selectedRepo:i})}disconnectBitbucket(e){return this.deleteJson("/integration/bitbucket",{projectId:e})}}t.TestimIntegrationApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimLabelApi=void 0;const i=s(13);class o extends i.TestimBaseApi{create(e,t){return this.postJson(`/label?projectId=${e}`,{labels:t,projectId:e})}delete(e,t){return this.deleteJson("/label",{labels:t,projectId:e})}getAll({projectId:e}){return this.getJson(`/label?projectId=${e}`)}}t.TestimLabelApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimProjectApi=void 0;const i=s(13);const o=s(5);const n="/v2/project";class r extends i.TestimBaseApi{getSharedStepList(e,t,s){return this.getJson(`${n}/sharedStepList?projectId=${e}&branch=${t}&withUsage=${s}`)}getReplaceGroupList(e,t){return this.getJson(`${n}/replaceGroupList?projectId=${e}&branch=${t}`)}create(e,t,s=o.commonConstants.test.DESKTOP_WEB){return this.postJson(n,{companyId:e,projectName:t,type:s})}archive(e){return this.postJson(`${n}/archive`,{projectId:e})}restore(e){return this.postJson(`${n}/restore`,{projectId:e})}clone({sourceProjectId:e,targetCompany:t,targetCompanyName:s,targetProject:i,targetProjectName:o,includeTestResults:r,copyGridMachines:a,copyScheduler:c,cloneFiles:l,useSourceOwner:u}){return this.postJson(`${n}/clone`,{sourceProjectId:e,targetCompany:t,targetCompanyName:s,targetProject:i,targetProjectName:o,includeTestResults:r,copyGridMachines:a,copyScheduler:c,cloneFiles:l,useSourceOwner:u})}getProject(e){return this.getJson(`${n}/project?projectId=${e}`)}rename(e,t){return this.putJson(`${n}/rename`,{projectId:e,name:t})}saveDefaultUrl(e,t){return this.putJson(`${n}/defaultUrl`,{projectId:e,url:t})}saveDebugPanelStatus(e,t){return this.putJson(`${n}/debugPanelStatus`,{projectId:e,panelStatus:t})}saveDefaultApp(e,t){return this.putJson(`${n}/defaultApp`,{projectId:e,appId:t})}saveHiddenParams(e,t){return this.putJson(`${n}/hiddenParams`,{projectId:e,params:t})}saveDefaults(e,t){return this.putJson(`${n}/projectDefaults`,{projectId:e,projectDefaults:t})}saveDefaultConfig(e,t){return this.putJson(`${n}/defaultConfig`,{projectId:e,configId:t})}addOwner(e,t,s){return this.postJson(`${n}/owner`,{projectId:e,userId:t,companyId:s})}removeOwner(e,t,s){return this.deleteJson(`${n}/owner`,{projectId:e,userId:t,companyId:s})}replaceOwner(e,t,s,i){return this.putJson(`${n}/owner`,{projectId:e,userId:s,companyId:t,oldOwnerUserId:i})}getUsers(e,t){return this.getJson(`${n}/users?projectId=${e}&companyId=${t}`)}deleteUser(e,t){return this.deleteJson(`${n}/user`,{projectId:e,userId:t})}deleteUsers(e,t){return this.deleteJson(`${n}/users`,{projectId:e,userIds:t})}invite(e,t,s){return this.postJson(`${n}/invite`,{projectId:e,emails:t,captcha:s})}getInvitedEmails(e){return this.getJson(`${n}/invites?projectId=${e}`)}deleteInvite(e,t){return this.deleteJson(`${n}/invite`,{projectId:e,email:t})}deleteInvites(e,t){return this.deleteJson(`${n}/invites`,{projectId:e,emails:t})}getCiUser(e){return this.getJson(`${n}/ciuser?projectId=${e}`)}updateReportSettings(e){return this.putJson(`${n}/v2/reportSettings`,e)}updateAutoComplete(e){return this.putJson(`${n}/autoComplete`,e)}updateAutoImproveReadOnly(e){return this.putJson(`${n}/autoImproveReadOnly`,e)}updateProjectEditorType(e,t){return this.putJson(`${n}/editorProjectType`,{type:t,projectId:e})}getReportSettings(e){return this.getJson(`${n}/v2/reportSettings?projectId=${e}`)}getReportSettingsForProjects(e=[]){return this.getJson(`${n}/reportSettingsProjects?projectIds=${e.join(",")}`)}savePullRequestSettings(e,t,s){return this.putJson(`${n}/pullRequest`,{projectId:e,[t]:s})}searchProjects(e,t=100,s=false){return this.getJson(`${n}/search?name=${encodeURIComponent(e)}&limit=${t}&includeArchived=${Boolean(s)}`)}}t.TestimProjectApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimRemoteStepApi=void 0;const i=s(13);const o="/remoteStep";const n=5e3;class r extends i.TestimBaseApi{save(e,t,s,i){return this.updateAndRetry((()=>this.postJson(`${o}`,{projectId:e,resultId:t,stepId:s,remoteStep:i},n)),`remoteStep:${t}:${s}`)}}t.TestimRemoteStepApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimDashboardApi=void 0;const i=s(13);const o="/app-dashboard";class n extends i.TestimBaseApi{getExecutionFilters(e,t,s,i,n){return this.postJson(`${o}/${e}/filters`,{startTime:t,endTime:s,includeEvaluating:i,branch:n})}getExecutionData({projectId:e,onlyAssignedToUser:t,startTime:s,endTime:i,filters:n,limit:r}){return this.postJson(`${o}/${e}/executions`,{onlyAssignedToUser:t,startTime:s,endTime:i,filters:n,limit:r})}getOverviewData(e,t,s){return this.getJson(`${o}/${e}/overview?onlyAssignedToUser=${t}&branch=${encodeURIComponent(s)}`)}getDuplicationData(e){return this.getJson(`${o}/${e}/duplication`)}getPullRequestsData(e,t){return this.getJson(`${o}/${e}/pullRequests?onlyAssignedToUser=${t}`)}getAuditLogData(e,t){return this.getJson(`${o}/${e}/auditLog?onlyAssignedToUser=${t}`)}}t.TestimDashboardApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimSlackBugTracker=void 0;const i=s(13);class o extends i.TestimBaseApi{disconnect(e){return this.rawPutJson("/integration/slack/disconnect",{projectId:e})}}t.TestimSlackBugTracker=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAutoImproveApi=void 0;const i=s(13);const o="/autoImprove";class n extends i.TestimBaseApi{autoImproveTest(e,t){return this.postJson(`${o}/test`,{projectId:e,testId:t})}}t.TestimAutoImproveApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimMarketplaceApi=void 0;const i=s(13);class o extends i.TestimBaseApi{async publishSharedStep(e,t,s){return await this.putJson(`/marketplace/${t}?projectId=${e}`,s)}async updateSharedStep(e,t){return await this.postJson(`/marketplace/${t}?projectId=${e}`,{})}async getRevision(e,t){return await this.getJson(`/marketplace/revision/${e}?projectId=${t}`)}async getClass(e,t){return await this.getJson(`/marketplace/class/${e}?projectId=${t}`)}}t.TestimMarketplaceApi=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SecretsApi=void 0;const i=s(13);const o="/secrets";class n extends i.TestimBaseApi{getSecretAuthenticator(e,t){return this.getJson(`${o}/${e}/${t}/mfa`)}saveSecret(e,t){return this.postJson(`${o}/${e}`,{secretValue:t})}deleteSecret(e,t){return this.deleteJson(o,{projectId:e,secretId:t})}}t.SecretsApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimDropbearApi=t.SampleTestsStatus=void 0;const i=s(13);const o=s(7);const n=o.Logger.getLogger("testimDropbearApi");const r=5;const a=15e3;const c=5;const l=15e3;class u{constructor(){this.completed=0;this.total=0;this.status="starting"}}t.SampleTestsStatus=u;class d extends i.TestimBaseApi{async post(e,t,s,i){var o,c;try{const o=await this.postJson(`/sfdc/graphql?projectId=${t}`,e,s||a,i||r);return typeof o==="string"?JSON.parse(o):o}catch(e){n.error("sfdc-metadata-error",{err:e});const t=((o=e.response)===null||o===void 0?void 0:o.message)?(c=e.response)===null||c===void 0?void 0:c.message:"Error while fetching metadata";throw new Error(t)}}async compile(e,t,s){const i={node:{version:"v1",sfdcCredential:s,node:e}};try{const e=await this.postJson(`/sfdc/compile/node?projectId=${t}`,i,l,c);if(!(e===null||e===void 0?void 0:e.data)){throw new Error("no result")}const{data:{cFormat:s,error:o}}=e;if(o){return{error:JSON.stringify(o)}}if(!s){throw new Error("no steps compiled")}return s}catch(e){n.error("sfdc-compiler-error",{err:e});throw new Error("Error while compiling step")}}async generateSampleTests(e,t,s,i){const o={login:e,projectId:t,branch:s,sfdcCredential:i};try{const e=await this.postJson("/sfdc/generate-sample-tests/",o);const{folderId:t,error:s}=e;if(s)throw new Error(s);if(!t)throw new Error("Sample tests folder was not created");return{folderId:t}}catch(e){n.error("generate-sample-tests-error",{err:e});return{error:e.message}}}async getSampleTestsStatus(e,t){try{return await this.getJson(`/sfdc/generate-sample-tests/${t}?projectId=${e}`)}catch(e){n.error("generate-sample-tests-error",{err:e});throw new Error("Error fetching status of sample tests")}}async abortSampleTestsGeneration(e,t){try{return await this.getJson(`/sfdc/generate-sample-tests/${t}/abort?projectId=${e}`)}catch(e){n.error("generate-sample-tests-error",{err:e});throw new Error("Error aborting generation of sample tests")}}async getRedirectUri(e,t,s,i,o,n){if(e===undefined){return{redirect_uri:null}}const r=o?`&branch=${encodeURIComponent(o)}`:"";const a=n?`&personaName=${encodeURIComponent(n)}`:"";const c=`/sfdc/${e}?projectId=${i}&name=${encodeURIComponent(t)}${r}${a}&origin=${encodeURIComponent(s)}`;const l=await this.getJson(c);return l}async fetch(e,t){if(t===undefined){throw new Error("undefined options")}if(typeof e!=="string"){throw new Error("url needs to be string")}const s=await this.post(t.body,e);const i=typeof s==="string"?s:JSON.stringify(s);return new Response(i,{headers:{"Content-Type":"application/json"}})}}t.TestimDropbearApi=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAdminManagementApi=void 0;const i=s(13);const o="/adminManagement";class n extends i.TestimBaseApi{getAllAdmins(){return this.getJson(`${o}/`)}changeUserToAdmin(e,t,s,i,n){return this.postJson(`${o}/`,{email:e,companyAllowPrivileges:t,companyBlockList:s,adminGroup:i,defaultAdminPrivileges:n})}editAdminPrivileges(e,t,s,i,n){return this.putJson(`${o}/${e}`,{companyAllowPrivileges:t,companyBlockList:s,adminGroup:i,defaultAdminPrivileges:n})}removeAdminPrivileges(e){return this.deleteJson(`${o}/${e}`,{})}}t.TestimAdminManagementApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAdminToolsApi=void 0;const i=s(13);const o="/adminTools";class n extends i.TestimBaseApi{renameBranch(e,t,s){return this.putJson(`${o}/${e}/branch/${t}`,{newName:s})}syncProjectsResultsToES(e){return this.postJson(`${o}/syncProjectsResultsToES`,e)}deleteProjects(e){return this.deleteJson(`${o}/projects/`,{projectIds:e})}deleteCompany(e){return this.deleteJson(`${o}/company/${e}`,{})}syncK8SCronJobs(){return this.postJson(`${o}/syncK8SCronJobs`,{})}getUserPreferences(e){return this.getJson(`${o}/preferences?userEmail=${e}`)}updateUserPreferences(e,t){return this.putJson(`${o}/preferences`,{userEmail:e,preferences:t})}changeProjectToken(e){return this.putJson(`${o}/changeToken`,{projectId:e})}getUserCompanyRelations(e){return this.getJson(`${o}/userCompanyRelations?userEmail=${e}`)}updateUserCompanyRelations(e,t){return this.putJson(`${o}/userCompanyRelations`,{userEmail:e,companyRelations:t})}deleteDuplicateTests(e,t){return this.deleteJson(`${o}/deleteDuplicateTests/${t}/${e}`,{})}addPermanentEmail(e,t){return this.postJson(`${o}/addPermanentEmail/`,{projectId:e,email:t})}evictFromCache(e){return this.deleteJson(`${o}/evictFromCache`,{keys:e})}changeLoginMethod(e,t){return this.postJson(`${o}/changeLoginMethod`,{email:e,newLoginMethod:t})}}t.TestimAdminToolsApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimMobileAppApi=t.UPLOAD_TIMEOUT=void 0;const i=s(13);t.UPLOAD_TIMEOUT=3*60*1e3;const o="/mobile-app";class n extends i.TestimBaseApi{create(e,t){return this.postJson(`${o}?projectId=${e}`,{...t,projectId:e})}createNewVersion(e,s,i,n,r,a){return this.postFormDataWithProgress(`${o}/version?projectId=${e}`,{projectId:e,...r&&{appId:r}},{file:s},undefined,undefined,{},i!==undefined?i:t.UPLOAD_TIMEOUT,n,a)}checkVersionStatus(e,t,s){return this.getJson(`${o}/app/${t}/${s}/status?projectId=${e}`)}getApp(e){return this.getJson(`${o}?projectId=${e}`)}getById(e,t){return this.getJson(`${o}/app/${t}?projectId=${e}`)}delete(e,t){return this.deleteJson("/mobile-app",{mobileApp:e,projectId:t})}renameApp(e,t,s){return this.putJson(`${o}/app/${t.appId}/name?projectId=${e}`,{name:s})}getAssociatedTests(e,t){return this.getJson(`${o}/${t._id}/tests?projectId=${e}`)}uploadAppToGrid(e,t,s,i){return this.postJson(`${o}/app/upload-to-grid?projectId=${e}&gridId=${t}`,s,undefined,undefined,i)}}t.TestimMobileAppApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTmaVersionsApi=void 0;const i=s(13);const o="/tmaVersions";const n={Windows:"windows",Linux:"linux",Mac:"macos"};class r extends i.TestimBaseApi{async getLinkForLatestVersionByPlatform(e,t){const s=await this.getToken();const i=new URL(`${this.baseUrl}${o}/latest`);i.searchParams.append("platform",n[e]);i.searchParams.append("attachment",`${n[e]}-installer-tricentis-mobile.zip`);i.searchParams.append("projectId",t);i.searchParams.append("access_token",s);return i.href}async getLinkForLatestVersionNumberByPlatform(e,t){const s=await this.getToken();return`${this.baseUrl}${o}/latest-version?platform=${n[e]}&projectId=${t}&access_token=${s}`}}t.TestimTmaVersionsApi=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTdcApi=void 0;const i=s(13);const o="/tdc";class n extends i.TestimBaseApi{requestTrialOrganization(e,t,s){return this.postJson(`${o}/organization`,{companyId:e,marketingData:s,projectId:t})}getOrganization(e){return this.getJson(`${o}/${e}`)}getDevices(e,t,s){return this.getJson(`${o}/${s}/devices?pool=${e}&projectType=${t}`)}}t.TestimTdcApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTvcApi=void 0;const i=s(13);const o="/tvc";class n extends i.TestimBaseApi{getDevices(e,t){return this.getJson(`${o}/devices?companyId=${e}&projectType=${t}`)}requestTrialOrganization(e,t){return this.postJson(`${o}/trial`,{projectId:e,marketingData:t})}}t.TestimTvcApi=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimTextractApi=void 0;const i=s(13);const o=s(7);const n=o.Logger.getLogger("testimTextractApi");const r=15e3;class a extends i.TestimBaseApi{async parseDocument({fileName:e,fileBlob:t,projectId:s,timeout:i}){var o,a;try{const o={file:{fileName:e,mimeType:"application/pdf",file:t}};const n=await this.postFormData(`/textract/parse?projectId=${s}`,null,o,{},i||r);return typeof n==="string"?JSON.parse(n):n}catch(e){n.error("sfdc-document-parse-error",{err:e});const t=((o=e.response)===null||o===void 0?void 0:o.message)?(a=e.response)===null||a===void 0?void 0:a.message:"Failed to parse document";throw new Error(t)}}}t.TestimTextractApi=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestimAssistant=void 0;const i=s(13);const o="/assistant";class n extends i.TestimBaseApi{sendMessageToHelper(e){return this.postJson(`${o}/help`,e)}sendFeedbackToHelper(e){return this.postJson(`${o}/helpMessageFeedback`,e)}}t.TestimAssistant=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isTestimProductType=t.TESTIM_PRODUCT_TYPE_SPECIFIC=t.TESTIM_PRODUCT_TYPE=void 0;t.TESTIM_PRODUCT_TYPE={AUTOMATE:"automate",TTA_SFDC:"ttaSfdc"};t.TESTIM_PRODUCT_TYPE_SPECIFIC={TESTIM:"testim",SFDC:"sfdc"};function i(e){return typeof e==="string"&&Object.values(t.TESTIM_PRODUCT_TYPE).includes(e)}t.isTestimProductType=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KeyValueStore=void 0;class i{constructor(e="testim"){this.namespace=e}async get(e){const t=await this.connect();return o((()=>t.get(e)))}async set(e,t){const s=await this.connect();s.put(t,e)}async connect(){const e=await o((()=>window.indexedDB.open(this.namespace,2)),(e=>{e.onupgradeneeded=e=>{if(!e.target.result.objectStoreNames.contains(this.namespace)){e.target.result.createObjectStore(this.namespace,{keypath:this.namespace})}}}));const t=e.transaction(this.namespace,"readwrite").objectStore(this.namespace);return t}}t.KeyValueStore=i;function o(e,t=(e=>{})){return new Promise(((s,i)=>{const o=e();o.onsuccess=()=>s(o.result);o.onerror=e=>i(Object.assign(new Error(String(e)),{event:e}));t(o)}))}},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.drain=t.uploadItem=t.initialize=void 0;const i=s(114);const o=s(7);const n=s(42);const r=s(8);const a=o.Logger.getLogger("asset service");let c;const l=new Set;const u=e=>{c=e.serverUrl};t.initialize=u;const d=async({file:t,fileName:s,mimeType:o,metadata:u})=>{if(!c){return undefined}if(!e.isBuffer(t)&&!(t instanceof Blob)&&!(typeof t==="string")){t=JSON.stringify(t)}if(typeof t==="string"){t=(0,i.dataToBufferOrBlob)(t,o)}if(r.utils.isNode()){t=e.from(t,"base64")}const d=n.httpRequest.postFormData(c,{fileName:s,metadata:u?JSON.stringify(u):null},{file:{fileName:s,mimeType:o,file:t}}).catch((e=>a.error("failed saving local artifact",{err:e,fileName:s,mimeType:o}))).finally((()=>l.delete(d)));l.add(d);return await d};t.uploadItem=d;const p=async()=>{await Promise.all(Array.from(l))};t.drain=p}).call(this,s(65).Buffer)},,,,function(e,t){},,function(e,t){},,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getStepClass=t.registerStep=void 0;const i=new Map;function o(e,t){i.set(e,t)}t.registerStep=o;function n(e){return i.get(e)}t.getStepClass=n},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l;Object.defineProperty(t,"__esModule",{value:true});t.SharedStepService=void 0;const u=s(6);const d=s(33);const p=s(100);const h=s(116);const f=s(2);const m=s(60);const g=s(43);const v=s(8);const S=s(5);const y=s(87);class b extends d.EventEmitter{constructor(e=g.testimServicesSingleton){super();this._sharedStepsInfo={};this.branch=S.MASTER_BRANCH;this._currentBranchRevisions=null;this._sharedStepsLatestRevisions={};this.LIST_UPDATED=b.LIST_UPDATED;this.testimServicesApi=e;this.loadUtils=new p.LoadUtils(this.testimServicesApi);this.setAsNotReady()}get sharedStepInfos(){return Object.values(this._sharedStepsInfo)}setAsNotReady(){if(!this._waitForValueFulfilled&&this._waitForValue){return this._waitForValue}this._waitForValueFulfilled=false;this._waitForValue=new Promise((e=>{this._gotInitialValues=()=>{this._waitForValueFulfilled=true;e()}}));return this._waitForValue}isReady(){return this._waitForValueFulfilled===true}onReady(){return this._waitForValue}reportSharedStepListUpdate(){this.trigger(this.LIST_UPDATED)}async loadSharedSteps({withUsage:e=true}){this.setAsNotReady();const t=await this.testimServicesApi.project.getSharedStepList(this.currentProject,this.branch,e);return this.addSharedStepsInfo(t)}async loadSharedStepsFromEditor({projectId:e,branch:t,includeArchived:s=false}){if(t!==this.branch||e!==this.currentProject){this.branch=t;this.currentProject=e;this._sharedStepsInfo={}}if(!this.branch||!this.currentProject){return}this.setAsNotReady();const{sharedSteps:i,folders:o}=await this.testimServicesApi.folder.listFolders({projectId:e,branch:t,type:"sharedSteps",includeArchived:s});if(t!==this.branch||e!==this.currentProject){return}(0,f.runInAction)((()=>this.addSharedStepsInfo(i)));this.folders=o}setUserInfo(e){this.userInfo=e}getDirtySharedStepClasses(e){return u.chain(this._sharedStepsInfo).keys().filter((t=>!e||e.includes(t))).map((e=>this._sharedStepsInfo[e])).map((e=>e.sharedStepClass)).compact().filter((e=>e.isDirty)).value()}resetDirty(e,t){this.getDirtySharedStepClasses(e).forEach((e=>{e.resetDirty(t);e.resetNew(t)}));this.sharedStepInfos.filter((t=>!e||e.includes(t.id))).forEach((e=>{e.dirty=false}))}async onProjectChangedBG(e,t=true){if(this.currentProject!==e){this.currentProject=e;this._sharedStepsInfo={};if(!t){this.setAsNotReady();this._gotInitialValues();return undefined}return await this.loadSharedSteps({withUsage:false})}return undefined}setBranch(e){this.branch=e;this._currentBranchRevisions=null}async setCurrentBranchRevisions(){if(this._currentBranchRevisions){return}const e=await this.testimServicesApi.branch.getRevisions(this.currentProject,this.branch);this._currentBranchRevisions=e}async getLatestRevision(e){await this.setCurrentBranchRevisions();return this._currentBranchRevisions[e]}addSharedStepsInfo(e){e=Array.isArray(e)?e:Object.values(e);for(const t of e){const e=this._sharedStepsInfo[t.id];const s=t.usage||(e===null||e===void 0?void 0:e.usage)||0;if(!(e===null||e===void 0?void 0:e.sharedStepClass)||e.usage&&e.usage!==s){const i={...t,usage:s,dirty:(e===null||e===void 0?void 0:e.dirty)||false,revisions:(e===null||e===void 0?void 0:e.revisions)||null};this._sharedStepsInfo[i.id]=i}}this._gotInitialValues();this.reportSharedStepListUpdate()}setSharedStepRevisions(e,t){const s=this._sharedStepsInfo[e];if(!s){return}s.revisions||(s.revisions=new h.RevisionList(t));if(t){s.revisions.update(t)}else{const e=this.userInfo.name||this.userInfo.email;s.revisions.createNewRevision(e,this.userInfo.uid,s.sharedStepClassId,s.name,"created")}}async loadRevisions(e){var t;const s=this._sharedStepsInfo[e];if(!s){throw new Error(`shared step ${e} was not found`)}if((t=s.revisions)===null||t===void 0?void 0:t.isListLoaded){return s.revisions}if(s.marketplace){const e=await this.testimServicesApi.marketplace.getRevision(s.id,this.currentProject);(0,f.runInAction)((()=>{for(const[t,s]of Object.entries(e)){this.setSharedStepRevisions(t,s)}}));return s.revisions}const i=await this.loadUtils.getRevisions(s.id,this.branch,this.currentProject);this.setSharedStepRevisions(e,i);return s.revisions}async loadRevisionsBulk(e){const t=u.chain(this._sharedStepsInfo).pick(e).filter((e=>{var t;return e&&!((t=e.revisions)===null||t===void 0?void 0:t.isListLoaded)})).map((e=>e.id)).value();if(!t.length){return}const s=await this.loadUtils.getBulkRevisions(this.branch,this.currentProject,t);Object.keys(s).forEach((e=>this.setSharedStepRevisions(e,s[e])))}setCurrentRevisions(e){Object.keys(e).map((e=>this._sharedStepsInfo[e])).forEach((t=>{var s;return(s=t===null||t===void 0?void 0:t.revisions)===null||s===void 0?void 0:s.update({current:e[t.id]})}))}setBranchLatestRevisions(e){this._sharedStepsLatestRevisions=u.chain(e).keyBy("sharedStepInfoId").mapValues((({stepId:e,name:t,revisionId:s})=>({stepId:e,name:t,id:s}))).value()}async setSharedStepClasses(e,t=true){this._sharedStepsLatestRevisions={};if(!t){(0,f.runInAction)((()=>{Object.keys(e).forEach((e=>{var t;(t=this._sharedStepsInfo)[e]||(t[e]={id:e})}))}))}await this.onReady();const s=Object.keys(e).find((e=>!this._sharedStepsInfo[e]));if(s){await this.loadSharedSteps({withUsage:true})}(0,f.runInAction)((()=>{Object.keys(e).forEach((t=>{const s=this._sharedStepsInfo[t];if(!s){return}const{step:i,revisions:o}=e[t];s.sharedStepClass=m.stepBuilder.buildStepFromData(i);s.sharedStepClass.resetNew();s.sharedStepClass.resetDirty();const n=this._sharedStepsLatestRevisions[t]?{latest:this._sharedStepsLatestRevisions[t].id}:{};s.revisions=new h.RevisionList(o||n)}))}))}updateOnlyInfos(e){Object.keys(e).forEach((t=>{const{step:s}=e[t];const i={sharedStepClass:m.stepBuilder.buildStepFromData(s)};this._sharedStepsInfo[t]=i}))}async loadLatestSharedStepClasses(e){await this.onReady();const t=e.map((e=>this._sharedStepsInfo[e])).filter(Boolean);if(t.length!==e.length){throw new Error("missing some shared steps")}const s=t.filter((e=>e.sharedStepClass));const i=t.filter((e=>!s.includes(e)));if(i.length===0){return s.map((e=>e.sharedStepClass))}const o=await this.getSharedStepRevisionsBatch(i);const n=o.map((({latestRevision:e})=>e.stepId));const r=await this.testimServicesApi.step.getSharedBulk(n,this.currentProject);const a=new Map(r.map((e=>[e.stepData.id,e.stepData])));for(const{info:e,latestRevision:t}of o){const s=a.get(t.stepId);const i=m.stepBuilder.buildStepFromData(s);e.sharedStepClass=i;e.sharedStepClass.resetNew();e.sharedStepClass.resetDirty()}return t.map((e=>e.sharedStepClass))}async getSharedStepRevisionsBatch(e){await this.loadRevisionsBulk(e.map((e=>e.id)));return e.map((e=>{const t=this._sharedStepsInfo[e.id].revisions;return{info:e,latestRevision:t.revisions[t.latest]}}))}async loadSharedStepClass(e,t){await this.onReady();const s=this._sharedStepsInfo[e];if(!s){throw new Error(`no such shared step ${e}`)}if(s.sharedStepClass&&!t){return s.sharedStepClass}const i=await this.getSharedStepRevision(s.id,t);const{stepId:o,name:n}=i;if(s.sharedStepClass&&o===s.sharedStepClass.id){return s.sharedStepClass}if(s.marketplace){const t=await this.testimServicesApi.marketplace.getClass(e,this.currentProject);for(const e of t){const t=this._sharedStepsInfo[e.sharedStepInfoId];if(!t){continue}t.sharedStepClass=m.stepBuilder.buildStepFromData(e.stepData);t.sharedStepClass.resetNew();t.sharedStepClass.resetDirty()}return s.sharedStepClass}const r=await this.loadUtils.getStepHierarchy(o,this.currentProject);s.sharedStepClass=m.stepBuilder.buildStepFromData(r.stepData);s.sharedStepClass.resetNew();s.sharedStepClass.resetDirty();if(n){s.sharedStepClass.name=n}return s.sharedStepClass}async getSharedStepRevision(e,t){const s=async s=>{const i=e=>e?s.revisions[e]:null;const o=i(t)||i(s.current);if(o){return o}const n=await this.getLatestRevision(e);return s.revisions[n]};const i=this._sharedStepsLatestRevisions[e];if(!t&&i){return i}const o=await this.loadRevisions(e);const n=await s(o);return o.setCurrentRevision(n.id).getCurrent()}rename(e,t){const s=this._sharedStepsInfo[e];if(s&&s.name!==t){s.name=t;s.dirty=true;this.trigger(this.LIST_UPDATED,this._sharedStepsInfo)}}isReuseAllowed(e){const t=this.getInfoById(e);if(!t){return false}return!t.hidden}createSharedStepInfo(e,t,s={}){const i={id:v.utils.guid(),sharedStepClassId:t.id,name:e,sharedStepClass:t,type:t.type,dirty:true,hidden:false,usage:0,usedTestsIds:[],revisions:new h.RevisionList,...s};i.revisions=new h.RevisionList;const o=this.userInfo.name||this.userInfo.email;i.revisions.createNewRevision(o,this.userInfo.uid,i.sharedStepClassId,i.name,"created");this._sharedStepsInfo[i.id]=i;this.trigger(this.LIST_UPDATED,this._sharedStepsInfo);return i}getInfoById(e){return this._sharedStepsInfo[e]}updateHiddenStatus(e,t,s){t=typeof t!=="boolean"?true:t;if(!e||e.length===0){return}const i=e.reduce(((e,i)=>{if(this._sharedStepsInfo[i]){const o=Object.assign({},this._sharedStepsInfo[i]);o.hidden=s;o.dirty=t;Object.assign(e,{[i]:o})}return e}),{});Object.assign(this._sharedStepsInfo,i);this.trigger(this.LIST_UPDATED,this._sharedStepsInfo)}showSharedStepInfo(e,t){this.updateHiddenStatus(e,t,false)}hideSharedStepInfo(e,t){this.updateHiddenStatus(e,t,true)}async toggleSharedStepLock(e,t){var s;if(!((s=this._sharedStepsInfo)===null||s===void 0?void 0:s[e])){return}const i=Boolean(typeof t==="boolean"?t:!this._sharedStepsInfo[e].locked);await this.testimServicesApi.sharedSteps.updateLock(e,this.currentProject,i);this._sharedStepsInfo[e].locked=i;this.trigger(this.LIST_UPDATED,this._sharedStepsInfo)}invalidateCachedData(){this._currentBranchRevisions=null;const e=Object.values(this._sharedStepsInfo).filter((e=>{var t;return(t=e.sharedStepClass)===null||t===void 0?void 0:t.isNew}));if(e.length>0){e.forEach((({id:e})=>{delete this._sharedStepsInfo[e]}));this.reportSharedStepListUpdate()}this.resetDirty();Object.values(this._sharedStepsInfo).forEach((e=>{delete e.sharedStepClass;delete e.revisions}))}async cloneSharedStep(e,t,s,i,o){var n;if(!e.isSharedStepInstance()){return undefined}const r=s.getStepContent();if(!(r instanceof y.GroupStep)){return undefined}if(e.isMarketplaceStep){if(!e.sharedStepClass){e.sharedStepClass=await this.loadSharedStepClass(e.sharedStepInfoId)}return this.cloneMarketplaceStep(e,t,s,i,o)}const a=(n=o===null||o===void 0?void 0:o.allowReuse)!==null&&n!==void 0?n:e.isShared;await e.syncWithSharedStepClass(this);const c=m.stepBuilder.buildStepFromData({...e.getStepContent().getSerializableObject(),name:t},{newId:true,newApplitoolsTestId:true});const l=this.createSharedStepInfo(t,c,{hidden:!a});const u=m.stepBuilder.buildStepFromData({...e.getSerializableObject(),name:t,sharedStepInfoId:l.id},{newId:true});const d=e.getStepContent().steps||[];u.sharedStepClass=c;r.addStep(u,i);for(let e=0;e<d.length;e++){const t=d[e];if(this.isStepDeepClonable(t)){await this.cloneSharedStep(t,t.getDisplayName(),u,e+1);c.removeStep(c.steps[e].id)}}return u}isStepDeepClonable(e){return e.isSharedStepInstance()&&!e.isShared}async cloneMarketplaceStep(e,t,s,i,o){var n;const r=this.getInfoById(e.sharedStepInfoId);const a={...e===null||e===void 0?void 0:e.sharedStepClass,sharedStepInfoId:(n=e===null||e===void 0?void 0:e.sharedStepClass)===null||n===void 0?void 0:n.sharedStepInfoId,type:e.classType,name:t};const c=this.createNewSharedStep(a,t,{hidden:!(o===null||o===void 0?void 0:o.allowReuse)||r.hidden});if(s){s.addStep(c,i)}return c}createNewSharedStep(e,t,s={}){const i="";const o={"validation-code-step":"untitled validation","action-code-step":"untitled action","wait-for-code-step":"untitled wait for","cli-validation-download-file":"untitled download validation","cli-wait-for-download-file":"untitled wait for download","email-validation-step":"untitled email validation","cli-validation-code-step":"untitled CLI validation","cli-action-code-step":"untitled CLI action","cli-wait-for-code-step":"untitled CLI wait for","api-validation":"untitled api validation","api-action":"untitled api action","network-validation-step":"untitled network validation"};const n=e.type;const r=m.stepBuilder.buildStepFromData({name:t||o[n!==null&&n!==void 0?n:""],type:n,code:i,...e});const a=this.createSharedStepInfo(r.name,r,s);const c=m.stepBuilder.buildStepFromData({type:"shared-step-instance",sharedStepInfoId:a.id,name:r.name,classType:n});c.sharedStepClass=r;return c}}t.SharedStepService=b;b.LIST_UPDATED="shared-steps:updated";i([f.observable.deep,o("design:type",typeof(n=typeof Record!=="undefined"&&Record)==="function"?n:Object)],b.prototype,"_sharedStepsInfo",void 0);i([f.observable.ref,o("design:type",typeof(r=typeof Promise!=="undefined"&&Promise)==="function"?r:Object)],b.prototype,"_waitForValue",void 0);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],b.prototype,"sharedStepInfos",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],b.prototype,"addSharedStepsInfo",null);i([f.action,o("design:type",Function),o("design:paramtypes",[typeof(c=typeof Record!=="undefined"&&Record)==="function"?c:Object]),o("design:returntype",void 0)],b.prototype,"setCurrentRevisions",null);i([f.action,o("design:type",Function),o("design:paramtypes",[String,String]),o("design:returntype",void 0)],b.prototype,"rename",null);i([f.action,o("design:type",Function),o("design:paramtypes",[String,Object,typeof(l=typeof Partial!=="undefined"&&Partial)==="function"?l:Object]),o("design:returntype",void 0)],b.prototype,"createSharedStepInfo",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Array,Object,Boolean]),o("design:returntype",void 0)],b.prototype,"updateHiddenStatus",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Array,Boolean]),o("design:returntype",void 0)],b.prototype,"showSharedStepInfo",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Array,Boolean]),o("design:returntype",void 0)],b.prototype,"hideSharedStepInfo",null);i([f.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],b.prototype,"invalidateCachedData",null)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.maskHiddenParams=void 0;const i=s(5);function o(e,t){if(!e){return undefined}const s=Object.assign({},e);const o=new Set(t||[]);Object.keys(s).forEach((e=>{const t=s[e]===i.commonConstants.test.HIDDEN_PARAM||o.has(e);s[e]=t?"*****":s[e]}));return s}t.maskHiddenParams=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.expressionMixin=void 0;const i=s(2);const o=s(8);const n=s(53);const r=s(60);const a=(e,t)=>{function s(e,s){e[t]=s}function a(e){return e[t]}class c extends e{constructor(...e){super(...e);s(this,null)}getValue(){var e,t;const s=a(this);if(s){return(t=(e=s.getValue()).trim)===null||t===void 0?void 0:t.call(e)}return"[not set]"}getSerializableObject(e){var s;return{...super.getSerializableObject(e),[t]:(s=a(this))===null||s===void 0?void 0:s.getSerializableObject(e)}}_updateElementTextSelector(e,t){if(!e){return null}try{const s=e.elementLocator.document;const i=s.at(-1);const r=n.locatorBuilderUtils.getInnerTextSelector(i);if(!r){return undefined}r.updatedInnerText=o.utils.isRegExp(t)?t:o.utils.removeLeadAndTrailingQuotes(t);return e}catch(e){return undefined}}_update(e){const t=a(e);if(t){t.location||(t.location=e.location||this.location);t.tabInfo||(t.tabInfo=e.tabInfo||this.tabInfo);t.frameLocators||(t.frameLocators=e.frameLocators||this.frameLocators);const i=a(this);if(i){i.update(t);const e=this._updateElementTextSelector(this.getElementData(),t.expression);if(e){this.updateElement(e)}}else{s(this,r.stepBuilder.buildStepFromData(t))}}return super._update(e)}getElementData(){}updateElement(e){}}(0,i.decorate)(c,{[t]:i.observable.ref});return c};t.expressionMixin=a},function(e,t,s){"use strict";s.r(t);(function(e){s.d(t,"shimSafeQuerySelector",(function(){return i}));function i(){var t;var s;function i(){return typeof e!=="undefined"&&{}.toString.call(e)==="[object global]"}function o(e){if(e&&e.toString){return e.toString().indexOf("[native code]")>-1}else{return false}}function n(){if(s&&t){return}var e=void 0;const i=document.body||document.documentElement;try{if(i){e=document.createElement("iframe");e.style.setProperty("display","none");e.style.setProperty("pointer-events","none");i.appendChild(e);s=e.contentDocument;t=s.createElement("div")}else{s=document.implementation.createHTMLDocument();t=s.createElement("div")}}finally{if(e&&i){i.removeChild(e)}}}function r(e){return function(r,a){if(o(r.querySelector)||i()){return e==="all"?r.querySelectorAll(a):r.querySelector(a)}n();var c=r===document?s:t;return e==="all"?c.querySelectorAll.call(r,a):c.querySelector.call(r,a)}}return{querySelector:r(null),querySelectorAll:r("all")}}}).call(this,s(36))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.promisifyAll=t.promisify=t.ChromeError=void 0;class i extends Error{constructor(e,t){super(e);this.originalStack=t}}t.ChromeError=i;const o=(e,t,s)=>(...o)=>{const n=new Error("Promisified CDP Error").stack;const r=t[s].bind(t);return new Promise(((t,s)=>{r(...o,(o=>{var r;const a=(r=e.runtime)===null||r===void 0?void 0:r.lastError;if(a){return s(new i(a.message,n))}return t(o)}))}))};t.promisify=o;const n=Symbol("promisified");const r=(e,s)=>{if(!s||n in s)return s;for(const i of Object.getOwnPropertyNames(s)){if(typeof s[i]!=="function"){continue}s[`${i}Async`]=(0,t.promisify)(e,s,i)}s[n]=true;return s};t.promisifyAll=r},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"3c2fee809c.jpg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"e45656084d.jpg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MANAGER_ROLES=t.DEVELOPER_ROLES=void 0;t.DEVELOPER_ROLES=["Front End Dev","Backend Dev","Full Stack Dev","Developer"];t.MANAGER_ROLES=["Manager / Director / VP"]},function(e,t,s){"use strict";s.r(t);t["default"]={scenarioEditorMain:"BaseStepEditor_scenarioEditorMain_3L73Z_BFZGl0b3It",scenarioEditorMainSteps:"BaseStepEditor_scenarioEditorMainSteps_3wV74_BFZGl0b3It",isDragging:"BaseStepEditor_isDragging_1rLFm_BFZGl0b3It",testRoot:"BaseStepEditor_testRoot_2CiJD_BFZGl0b3It",resizablePP:"BaseStepEditor_resizablePP_3EWJM_BFZGl0b3It",resizablePp:"BaseStepEditor_resizablePP_3EWJM_BFZGl0b3It",selectionBox:"BaseStepEditor_selectionBox_1v63i_BFZGl0b3It",draggedStepsCursor:"BaseStepEditor_draggedStepsCursor_vYnAU_BFZGl0b3It",isCopying:"BaseStepEditor_isCopying_3Csfz_BFZGl0b3It",draggedStepsCounter:"BaseStepEditor_draggedStepsCounter_3q8B4_BFZGl0b3It"}},function(e,t,s){"use strict";s.r(t);t["default"]={mainContainer:"TestimGuideHeader_mainContainer_1RUrL_VIZWFkZXIt"}},function(e,t,s){"use strict";s.r(t);t["default"]={stepPair:"StepPair_stepPair_2MZRY_RlcFBhaXIt",noMargin:"StepPair_noMargin_Dz5Td_RlcFBhaXIt",reduceMenuZIndex:"StepPair_reduceMenuZIndex_ebxnl_RlcFBhaXIt",abstractStep:"StepPair_abstractStep_1zU2v_RlcFBhaXIt",contentPlaceholder:"StepPair_contentPlaceholder_2Odcm_RlcFBhaXIt",actionPlaceholder:"StepPair_actionPlaceholder_F1FtI_RlcFBhaXIt",labelPlaceholder:"StepPair_labelPlaceholder_1W-oi_RlcFBhaXIt",stepWrapper:"StepPair_stepWrapper_1FJq-_RlcFBhaXIt",stepActions:"StepPair_stepActions_1qE7E_RlcFBhaXIt",locked:"StepPair_locked_iXjYZ_RlcFBhaXIt",isImproved:"StepPair_isImproved_15d-J_RlcFBhaXIt",dragHandler:"StepPair_dragHandler_3UslT_RlcFBhaXIt",isDragging:"StepPair_isDragging_1vgYA_RlcFBhaXIt",failureReasonTooltip:"StepPair_failureReasonTooltip_38YYw_RlcFBhaXIt",stepFailureReason:"StepPair_stepFailureReason_3ySEW_RlcFBhaXIt",warn:"StepPair_warn_3f8RN_RlcFBhaXIt"}},function(e,t,s){"use strict";s.r(t);t["default"]={error:"EditorErrorNotification_error_l0s4A_ljYXRpb24t",failureText:"EditorErrorNotification_failureText_2QYJ4_ljYXRpb24t",start:"EditorErrorNotification_start_27_uM_ljYXRpb24t",tagTestContainer:"EditorErrorNotification_tagTestContainer_W4k_1_ljYXRpb24t",seeErrorContainer:"EditorErrorNotification_seeErrorContainer_3EU33_ljYXRpb24t",seeErrorLink:"EditorErrorNotification_seeErrorLink_3fmS2_ljYXRpb24t",disabled:"EditorErrorNotification_disabled_2vWuI_ljYXRpb24t",separator:"EditorErrorNotification_separator_1Y-zE_ljYXRpb24t"}},function(e,t,s){"use strict";s.r(t);t["default"]={"ci-section":"CiSection_ci-section_1nWmw_NlY3Rpb24t",ciSection:"CiSection_ci-section_1nWmw_NlY3Rpb24t",dropdowns:"CiSection_dropdowns_36xzM_NlY3Rpb24t","dropdowns-item":"CiSection_dropdowns-item_ZgkeK_NlY3Rpb24t",dropdownsItem:"CiSection_dropdowns-item_ZgkeK_NlY3Rpb24t","grid-label":"CiSection_grid-label_d_Ugl_NlY3Rpb24t",gridLabel:"CiSection_grid-label_d_Ugl_NlY3Rpb24t"}},function(e,t,s){"use strict";s.r(t);t["default"]={"code-section":"CodeSection_code-section_22PPf_NlY3Rpb24t",codeSection:"CodeSection_code-section_22PPf_NlY3Rpb24t","code-header":"CodeSection_code-header_1fuXl_NlY3Rpb24t",codeHeader:"CodeSection_code-header_1fuXl_NlY3Rpb24t","code-mode":"CodeSection_code-mode_3krpo_NlY3Rpb24t",codeMode:"CodeSection_code-mode_3krpo_NlY3Rpb24t","code-instructions":"CodeSection_code-instructions_3Wtp8_NlY3Rpb24t",codeInstructions:"CodeSection_code-instructions_3Wtp8_NlY3Rpb24t",editorWrapper:"CodeSection_editorWrapper_tQNxZ_NlY3Rpb24t"}},function(e,t,s){"use strict";s.r(t);t["default"]={tooltipContainer:"shoutouts_tooltipContainer_21oxr_9tVG91cnMt",tooltip:"shoutouts_tooltip_2FODy_9tVG91cnMt"}},function(e,t,s){"use strict";s.r(t);t["default"]={stepViewerNext:"StepViewerNavigation_stepViewerNext_2fhEe_BWaWV3ZXIt",stepViewerPrev:"StepViewerNavigation_stepViewerPrev_2uEI4_BWaWV3ZXIt",isDisabled:"StepViewerNavigation_isDisabled_26GPD_BWaWV3ZXIt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ManagerTour=void 0;const i=s(4);const o=s(11);const n=s(61);const r=s(439);const a=s(29);const c=s(0);const l=s(6);const u=s(73);const d=s(80);const p=s(21);const h=s(20);const f=s(160);const m=s(2);const g=[{src:"https://app-video.testim.io/validation.mp4",type:"video/mp4"},{src:"https://app-video.testim.io/validation.webm",type:"video/webm"}];const v=({stopTour:e})=>{const t=(0,o.useDependencyInjector)(a.EditedTestStore);const v=(0,o.useDependencyInjector)(d.EditorSelectionService);const S=(0,o.useDependencyInjector)(f.PropertyPanelStore);const y=(0,o.useDependencyInjector)(p.AnalyticsService);const[b,_]=(0,c.useState)();const T=(0,c.useMemo)((()=>b===null||b===void 0?void 0:b.getFirstStepWithLocators(t.test)),[t.test,b]);const E=(0,c.useMemo)((()=>(0,l.isEmpty)(T)),[T]);(0,h.useAsyncEffect)((async()=>{_(n.container.get((await Promise.resolve().then((()=>s(85)))).ProductTourService))}),[t]);const I=async t=>{e();if(t){y.track("locator-video-view-locator")}else{y.track("locators-video-close")}if(!E&&T){(0,m.runInAction)((()=>{S.isOpen=true;v.setSelection({select:true,step:T});b===null||b===void 0?void 0:b.startTourOncePerNewUser(u.TOUR_NAMES.LOCATORS)}))}};return(0,i.jsx)(r.GettingStartedGuideTaskModal,{shouldNavigateToExample:!E,closeModal:I,taskName:"Tests Stability and Smart Locators",ctaText:E?"Done":"View locators",text:"Tests Stability and Smart Locators",docText:"Learn how our AI and Smart Locators lock in elements to keep tests stable.",docLink:"https://www.testim.io/test-stability/",sources:g})};t.ManagerTour=v;t.ManagerTour.displayName="ManagerTour"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(440),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GettingStartedGuideTaskModal=void 0;const i=s(4);const o=s(0);const n=s(441);const r=s(30);const a=s(448);const c=s(451);const l=s(31);const u=s(11);const d=s(21);const p=({closeModal:e,sources:t,text:s,docLink:o,docText:p,ctaText:h,taskName:f,youtubeLink:m,shouldNavigateToExample:g})=>{const v=(0,u.useDependencyInjector)(d.AnalyticsService);return(0,i.jsxs)(r.BaseModal,{bodyClassName:n.default.body,className:n.default.modal,closeOnEscape:true,closeOnClickOutside:true,closeModal:e,children:[m?(0,i.jsx)("div",{className:n.default.video,children:(0,i.jsx)(c.YoutubeEmbed,{src:m})}):(0,i.jsx)(a.Video,{controls:true,autoPlay:true,loop:true,className:n.default.video,sources:t}),(0,i.jsx)("div",{className:n.default.message,children:s}),(0,i.jsxs)("div",{className:n.default.docLink,children:[p," See ",(0,i.jsx)("a",{onClick:()=>v.track("progress-bar-click-docs",{taskName:f}),target:"_blank",rel:"noopener noreferrer",href:o,children:"docs"}),"."]}),(0,i.jsx)("div",{className:n.default.cta,children:(0,i.jsx)(l.Cta,{onClick:()=>e(g),children:h})})]})};t.GettingStartedGuideTaskModal=p;t.GettingStartedGuideTaskModal.displayName="GettingStartedGuideTaskModal"},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"GettingStartedGuideTaskModal_modal_3t-mI_NrTW9kYWwt",body:"GettingStartedGuideTaskModal_body_2JMMa_NrTW9kYWwt",video:"GettingStartedGuideTaskModal_video_OzjYi_NrTW9kYWwt",message:"GettingStartedGuideTaskModal_message_1HlvN_NrTW9kYWwt",docLink:"GettingStartedGuideTaskModal_docLink_1SLKn_NrTW9kYWwt",cta:"GettingStartedGuideTaskModal_cta_1zvbw_NrTW9kYWwt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CircleIcon=t.CircleIconColors=t.HoverableTooltipInfoIcon=t.HoverableInfoIcon=t.InfoIcon=t.Icon=void 0;const i=s(4);const o=s(6);const n=s(10);const r=s(443);const a=s(0);const c=s(444);const l=s(52);const u=c.testimIconBaseSelector.replace(".","");t.Icon=(0,a.memo)((({icon:e,className:t,children:s,...o})=>(0,i.jsx)("i",{className:(0,n.default)(u,`${c.testimIconClassPrefix}${e}`,r.default.icon,t),"aria-hidden":"true",...o,children:s})));t.Icon.displayName="Icon";t.InfoIcon=(0,a.memo)((({tooltip:e,direction:s,variety:o="info",lineWrap:n,tooltipClassName:r,...a})=>(0,i.jsx)(l.Tooltip,{value:e,direction:s,lineWrap:n,className:r,attachToChild:true,children:(0,i.jsx)(t.Icon,{...a,icon:o})})));t.InfoIcon.displayName="InfoIcon";t.HoverableInfoIcon=(0,a.memo)((({tooltipProps:e,variety:s="info",hoverVariety:n="info-inverted",...r})=>{const[c,u]=(0,a.useState)(s);const d=(0,a.useCallback)((()=>u(n)),[u,n]);const p=(0,a.useCallback)((()=>u(s)),[u,s]);return(0,i.jsx)(l.Tooltip,{...o.omit(e,["children"]),children:(0,i.jsx)(t.Icon,{...r,icon:c,onMouseEnter:d,onMouseLeave:p})})}));t.HoverableInfoIcon.displayName="HoverableInfoIcon";const d=({tooltipBody:e,color:s="white",direction:o,variety:n="info",hoverVariety:r="info-inverted",className:c,tooltipClassName:u,...d})=>{const[p,h]=(0,a.useState)(n);const f=(0,a.useCallback)((()=>h(r)),[h,r]);const m=(0,a.useCallback)((()=>h(n)),[h,n]);return(0,i.jsx)(l.HoverableTooltip,{className:u,direction:o,color:s,value:e,children:(0,i.jsx)(t.Icon,{...d,icon:p,className:c,onMouseEnter:f,onMouseLeave:m})})};t.HoverableTooltipInfoIcon=d;t.HoverableTooltipInfoIcon.displayName="HoverableTooltipInfoIcon";t.CircleIconColors={"circle-red":["#F95F6C","#D33240"],"circle-blue":["#7093FF","#3D5AFE"]};t.CircleIcon=(0,a.memo)((({svgUniqueId:e,type:s})=>{const[o,n]=t.CircleIconColors[s];return(0,i.jsxs)("svg",{width:"11",height:"10",viewBox:"0 0 11 10",fill:"none",children:[(0,i.jsx)("circle",{cx:"5.5",cy:"5",r:"4.5",fill:`url(#${e})`,stroke:"#D8DAE5"}),(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:e,x1:"0.5",y1:"0",x2:"0.5",y2:"10",gradientUnits:"userSpaceOnUse",children:[(0,i.jsx)("stop",{stopColor:o}),(0,i.jsx)("stop",{offset:"1",stopColor:n})]})})]})}));t.CircleIcon.displayName="CircleIcon"},function(e,t,s){"use strict";s.r(t);t["default"]={icon:"icon_icon_WbfCm_RzLWljb24t","icon-with-gradient":"icon_icon-with-gradient_TTyk1_RzLWljb24t",iconWithGradient:"icon_icon-with-gradient_TTyk1_RzLWljb24t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.testimIcons=t.testimIconClassPrefix=t.testimIconBaseSelector=void 0;t.testimIconBaseSelector=".tst-icon";t.testimIconClassPrefix="i-";t.testimIcons=["a11y-step","abort-run","aborted","academic-cap","action","active-status","add-branch","add-project-owner","add","addGroup","addUser--stroke","addUser","admin","alert","android-phone-virtual","android-phone","android","android2","angle-double-right","angle-down","angle-left","angle-right","apex-logo","apple","archive","arrow-back","arrow-down","arrow-forward","arrow-left","arrow-long-down","arrow-long-up","arrow-thin","arrow-up-right","arrow-up","arrow","arrowRight","attr-step","autogrouper","back","batch","branch","browser","bugim","bulb","caret-down","caret-right","caret-up","chart","chat","check-circle","check","check2","checkbox-step","checkList","chrome","circle-arrow-down","clear-logs","cli-shared","cli","clickim","clock","clone-full","Clone","close-thin","close","cloud--full","cloud-step","cloud-v","cloud","codeVerification","cog","collapse","collapsible","comment","config","console","contact_support","copy_full","copy-code","copy-v2","copy","create-folder","create-label","create-suite","create-test","create","create1","css-step","cut","date-generator-step","debug-beetle","debugging","delete--stroke","delete","demos_project","desktop","desktop2","desktop3","device-management","device","display-email-back-arrow","document","documentation","download","dp-arrow","draft-status","drag","dragging-handle","drop","dropdown_empty","dropdown","edge-chromium","edge","edit-small","edit","editor","educate","elementVisible","email","enter","evaluating-status","exc-mark","expand","explorer","export","external-link","extract-text","eye-off","eye-on","eye-slash-new","eye-slash","eye","failed-blue","failed","failure-tag","file-full","file-o","file-upload","filter-full","filter-hamburger","filter-icon","filter","firefox","flaky-status","folder-high","folder","forward","full-screen-v3","gauge","generate-fake-data-step","generate-string-step","get-cookie","github","google","graph","grid-view-mode","group-empty","group-v2","group","hand","har","highlight","history","home","hook","hover-menu","hover","i","inbox-email","incognito-v2","incognito","info-clean","info-inverted","info","insights","invited","ios-phone-virtual","ios-phone","ios","js-scope","js","jsCheck","key","keyboard","label-row","lamp","landscape","leave","lightning","link","list","loader","loader2","locator","lock_ful","lock-full-blue","lock","logout","loop","m-testim","magic-link","mail","meet","merge-branch-dropdown","merge","mergeBranch--hover","mergeBranch","message","minus","mobile-agent-indicator","mobile-app","mobile-hide-keyboard","mobile-home-button","mobile-off","mobile-on","mobile-test-config","mobileweb","mocked-network","more-actions","more","mouse","mouseWheel","move-folder","multiple-tests","navigate","network_error","network_warning","network","new-app","new-plan","new-tab","new","newChat","off-black","open","opened-arrow","ordered-list","overview","paste","pause","pencil","performance-session","phone","physical-device","picture","pie_v2","pie","pin","pixel-validation","pixelCheck","plan","play_empty","play--stroke","play-icon-over-grid","play-step-by-step","play","plus--circle-storke","plus--circle","plus","plus2","portrait","press-and-hold","pull-request","quarantine-status","queued","radio-button-step","reassign","record","redo","refresh-step","refresh","remote-run--hover","remote-run","remove-filter","remove-project-owner","rename","replace-owner","rerun-failed","rerun-passed","rerun","reset","resize","results","retries","rightClick","rocket","rotate-left","rounded-lock-locked","rounded-lock-unlocked","running","safari","salesforce-cloud-logo","salesforce-validate","save","saveView","scale","scholarship","screen--full","screen-empty","screen-v2","screen","screenshot-v2","screenshot","screenshot1","script","scroll","search-test-name","search-thin","search","send","separator","set-cookie","settings-v3","settings-v4","sfdc-closeconsoletabs","sfdc-convert-lead-to-opportunity","sfdc-doc-validation","sfdc-edit","sfdc-findrecord","sfdc-launchapp","sfdc-login","sfdc-logout","sfdc-pp-action","sfdc-pp-validate","sfdc-quotelineeditor","sfdc-quotelineeditor","sfdc-relatedlistaction","sfdc-sobjectcreate","sfdc-sobjectdelete","sfdc-sobjectquickaction","sfdc-sobjectvalidate","share","shared-component","shared-folder","shared-validation","shared","show","skipped","sleep","small-cog-reversed","sort-arrow-down","sort-arrow-up","stats","status","step-into","step-out","step-over","stop","stopwatch","submit","success-v","suitcase","suite-row","suite-tests-list-arrow-down","suite-tests-list-arrow-up","support","swipe-2","swipe","table-view-mode","tabs","tack","tag--full","tag","tap","test-history","test-suite","testData","text-validation","text","textCheck","textFeedback","thrash","three-dots","thumbDown","thumbnail","thumbUp","timeout","tip","tip1","tip2","toolbar-rerun","trash-v3","trash-v4","trash","tricentis","ttm4j-test-case","turbo-mode","unarchive","undo-drag","undo","untitled","upload-grid","upload","uploadFile","user","users","v--circle","V","validate-email","validation","video-camera","video","virtual-device","visibility-validation","visual-validation","warning","youtube"]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RoundIconWithHoverableTooltip=t.HoverableTooltip=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(210);const a=s(16);const c=s(150);t.HoverableTooltip=(0,o.memo)((({className:e,isOpenInitially:t,value:s,...a})=>{const[l,u]=(0,o.useState)(t);const d=(0,o.useCallback)((e=>()=>u(e)),[u]);return(0,i.jsx)(c.Tooltip,{...a,className:(0,n.default)(r.default.hoverableTooltip,e),isOpen:l,onMouseEnter:d(true),onMouseLeave:d(false),trigger:"self",value:(0,i.jsx)(s,{closeTooltip:d(false)})})}));t.HoverableTooltip.displayName="HoverableTooltip";t.RoundIconWithHoverableTooltip=(0,o.memo)((({className:e,tooltip:s,direction:o,icon:c})=>(0,i.jsx)(t.HoverableTooltip,{wrapperClassName:(0,n.default)(r.default.roundIconWithHoverableTooltip,e),value:s,color:"white",direction:o,children:(0,i.jsx)(a.Icon,{icon:c})})));t.RoundIconWithHoverableTooltip.displayName="RoundIconWithHoverableTooltip"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ShortcutTooltip=void 0;const i=s(4);const o=s(447);const n=s(0);const r=s(150);t.ShortcutTooltip=(0,n.memo)((({value:e,shortcutButtons:t,...s})=>{const n=(0,i.jsxs)("div",{className:o.default.shortcutTooltip,children:[(0,i.jsx)("div",{children:e}),(0,i.jsx)("div",{className:o.default.tooltipShortcutWrapper,children:t.map(((e,t)=>(0,i.jsx)("span",{className:o.default.tooltipShortcutButton,children:e},t)))})]});return(0,i.jsx)(r.Tooltip,{...s,value:n})}));t.ShortcutTooltip.displayName="ShortcutTooltip"},function(e,t,s){"use strict";s.r(t);t["default"]={shortcutTooltip:"ShortcutTooltip_shortcutTooltip_1RJ4B_Rvb2x0aXAt",tooltipShortcutWrapper:"ShortcutTooltip_tooltipShortcutWrapper_178Hi_Rvb2x0aXAt",tooltipShortcutButton:"ShortcutTooltip_tooltipShortcutButton_3bNaH_Rvb2x0aXAt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(449),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Video=void 0;const i=s(4);const o=s(10);const n=s(450);const r=({autoPlay:e,controls:t,loop:s,sources:r,className:a})=>(0,i.jsx)("video",{className:(0,o.default)(n.default.container,a),loop:s,autoPlay:e,controls:t,children:r.map((({src:e,type:t},s)=>(0,i.jsx)("source",{src:e,type:t},s)))});t.Video=r;t.Video.displayName="Video"},function(e,t,s){"use strict";s.r(t);t["default"]={container:"video_container_1fq3x_MtdmlkZW8t"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(452),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.YoutubeEmbed=void 0;const i=s(4);const o=s(0);const n=s(453);const r=({src:e})=>(0,i.jsx)("iframe",{className:n.default.mainFrame,src:e,frameBorder:0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:true});t.YoutubeEmbed=r;t.YoutubeEmbed.displayName="YoutubeEmbed"},function(e,t,s){"use strict";s.r(t);t["default"]={mainFrame:"YoutubeEmbed_mainFrame_2jPMk_JlRW1iZWQt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Cta=void 0;const i=s(4);const o=s(10);const n=s(455);const r=({className:e,variety:t,color:s,children:r,...a})=>(0,i.jsx)("button",{className:(0,o.default)(n.default.cta,e,t&&n.default[t],s&&n.default[s]),...a,children:r});t.Cta=r;t.Cta.displayName="Cta"},function(e,t,s){"use strict";s.r(t);t["default"]={cta:"cta_cta_3JDAt_50cy1jdGEt",lightgray:"cta_lightgray_fEg65_50cy1jdGEt",gray:"cta_gray_2f6QL_50cy1jdGEt",white:"cta_white_Yt2bz_50cy1jdGEt",pink:"cta_pink_3v_7I_50cy1jdGEt",orange:"cta_orange_3Y-vb_50cy1jdGEt",olive:"cta_olive_oqyUl_50cy1jdGEt","--small":"cta_--small_bsvWx_50cy1jdGEt",small:"cta_--small_bsvWx_50cy1jdGEt","--large":"cta_--large_xulYA_50cy1jdGEt",large:"cta_--large_xulYA_50cy1jdGEt","large-mont":"cta_large-mont_PqwfY_50cy1jdGEt",largeMont:"cta_large-mont_PqwfY_50cy1jdGEt","--secondary":"cta_--secondary_2ZPuE_50cy1jdGEt",secondary:"cta_--secondary_2ZPuE_50cy1jdGEt","--error":"cta_--error_2aSDP_50cy1jdGEt",error:"cta_--error_2aSDP_50cy1jdGEt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.keyBindings=void 0;const i=s(5);t.keyBindings=[{layer:"edit",bindings:[{key:"esc",command:"close preview or back"},{key:"alt+j",command:"add js"},{key:"alt+g",command:"add group"},{key:"right",command:"select next"},{key:"left",command:"select prev"},{key:"del",command:"delete selected"},{key:"mod+s",command:"save test"},{key:"mod+z",command:"undo"},{key:"mod+y",command:"redo"},{key:"backspace",command:"delete or back"},{key:"alt+p",command:"add viewport visual validation"},{key:"alt+d",command:"add document visual validation"},{key:"alt+x",command:"add extract value step"},{key:"alt+m",command:"wait for element visible"},{key:"alt+t",command:"wait for element text"}]},{layer:"empty",bindings:[]},{layer:"stepViewer",bindings:[{key:"esc",command:"close preview or back"},{key:"right",command:"select next"},{key:"left",command:"select prev"}]},{layer:i.commonConstants.KEY_BINDING_LAYERS.RUN,bindings:[{key:"p",command:"pause"},{key:"right",command:"select next"},{key:"left",command:"select prev"},{key:"f11",command:"step into"},{key:"f10",command:"step over"},{key:"shift+f11",command:"step out"},{key:"mod+shift+f5",command:"rerun"},{key:"f8",command:"pause or continue"},{key:"shift+f5",command:"stop run"}]},{layer:"selectable-list",bindings:[{key:"mod+a",command:"select all"},{key:"esc",command:"clear selection"}]},{layer:"*",bindings:[{key:"mod+shift+l",command:"reload settings"},{key:"alt+n",command:"new test"},{key:"alt+shift+f",command:"featureFlagsDebug"},{key:"f8",command:"play"},{key:"f10",command:"play next step"},{key:"ctrl+b",command:"toggle breakpoint"},{key:"mod+k",command:"commandPalette"},{key:"f5",command:"start run"},{key:"mod+f5",command:"start run without debugging"}]}]},function(e,t,s){"use strict";s.r(t);s.d(t,"Mousetrap",(function(){return N}));var i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},o={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={option:"alt",command:"meta",return:"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},a,c={},l={},u={},d,p=false,h=false,f=false;for(var m=1;m<20;++m){i[111+m]="f"+m}for(m=0;m<=9;++m){i[m+96]=m}function g(e){if(e.type=="keypress"){var t=String.fromCharCode(e.which);if(!e.shiftKey){t=t.toLowerCase()}return t}if(i[e.which]){return i[e.which]}if(o[e.which]){return o[e.which]}return String.fromCharCode(e.which).toLowerCase()}function v(e,t){return e.sort().join(",")===t.sort().join(",")}function S(e){e=e||{};var t=false,s;for(s in u){if(e[s]){t=true;continue}u[s]=0}if(!t){f=false}}function y(e,t,s,i,o,n){var r,a,l=[],d=s.type;if(!c[e]){return[]}if(d=="keyup"&&D(e)){t=[e]}for(r=0;r<c[e].length;++r){a=c[e][r];if(!i&&a.seq&&u[a.seq]!=a.level){continue}if(d!=a.action){continue}if(d=="keypress"&&!s.metaKey&&!s.ctrlKey||v(t,a.modifiers)){var p=!i&&a.combo==o;var h=i&&a.seq==i&&a.level==n;if(p||h){c[e].splice(r,1)}l.push(a)}}return l}function b(e){var t=[];if(e.shiftKey){t.push("shift")}if(e.altKey){t.push("alt")}if(e.ctrlKey){t.push("ctrl")}if(e.metaKey){t.push("meta")}return t}function _(e){if(e.preventDefault){e.preventDefault();return}e.returnValue=false}function T(e){if(e.stopPropagation){e.stopPropagation();return}e.cancelBubble=true}function E(e,t,s){if(N.stopCallback(t,t.target||t.srcElement)){return}e(t,s);_(t);T(t)}function I(e,t,s){var i=y(e,t,s),o,n={},r=0,a=false;for(o=0;o<i.length;++o){if(i[o].seq){r=Math.max(r,i[o].level)}}for(o=0;o<i.length;++o){if(i[o].seq){if(i[o].level!=r){continue}a=true;n[i[o].seq]=1;E(i[o].callback,s,i[o].combo);continue}if(!a){E(i[o].callback,s,i[o].combo)}}var c=s.type=="keypress"&&h;if(s.type==f&&!D(e)&&!c){S(n)}h=a&&s.type=="keydown"}function C(e){if(typeof e.which!=="number"){e.which=e.keyCode}var t=g(e);if(!t){return}if(e.type=="keyup"&&p===t){p=false;return}N.handleKey(t,b(e),e)}function D(e){return e=="shift"||e=="ctrl"||e=="alt"||e=="meta"}function O(){clearTimeout(d);d=setTimeout(S,1e3)}function A(){if(!a){a={};for(var e in i){if(e>95&&e<112){continue}if(i.hasOwnProperty(e)){a[i[e]]=e}}}return a}function j(e,t,s){if(!s){s=A()[e]?"keydown":"keypress"}if(s=="keypress"&&t.length){s="keydown"}return s}function w(e,t,s,i){u[e]=0;function o(t){return function(){f=t;++u[e];O()}}function n(t){E(s,t,e);if(i!=="keyup"){p=g(t)}setTimeout(S,10)}for(var r=0;r<t.length;++r){var a=r+1===t.length;var c=a?n:o(i||P(t[r+1]).action);x(t[r],c,i,e,r)}}function R(e){if(e==="+"){return["+"]}return e.split("+")}function P(e,t){var s,i,o,a=[];s=R(e);for(o=0;o<s.length;++o){i=s[o];if(r[i]){i=r[i]}if(t&&t!="keypress"&&n[i]){i=n[i];a.push("shift")}if(D(i)){a.push(i)}}t=j(i,a,t);return{key:i,modifiers:a,action:t}}function x(e,t,s,i,o){l[e+":"+s]=t;e=e.replace(/\s+/g," ");var n=e.split(" "),r;if(n.length>1){w(e,n,t,s);return}r=P(e,s);c[r.key]=c[r.key]||[];y(r.key,r.modifiers,{type:r.action},i,e,o);c[r.key][i?"unshift":"push"]({callback:t,modifiers:r.modifiers,action:r.action,seq:i,level:o,combo:e})}function M(e,t,s){for(var i=0;i<e.length;++i){x(e[i],t,s)}}const N={start:function(){this.stop();document.addEventListener("keypress",C,true);document.addEventListener("keydown",C,true);document.addEventListener("keyup",C,true)},stop:function(){document.removeEventListener("keypress",C,true);document.removeEventListener("keydown",C,true);document.removeEventListener("keyup",C,true)},bind:function(e,t,s){e=e instanceof Array?e:[e];M(e,t,s);return this},unbind:function(e,t){return N.bind(e,(function(){}),t)},trigger:function(e,t){if(l[e+":"+t]){l[e+":"+t]({},e)}return this},reset:function(){c={};l={};return this},stopCallback:function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1){return false}var s=String(t.tagName).toLowerCase();if(s==="select"||t.isContentEditable){return true}if(s==="input"||s==="textarea"){return!t.hasAttribute("readonly")}return false},handleKey:I}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TagsInput=void 0;const i=s(4);const o=s(0);const n=s(151);const r=s(6);const a=s(10);const c=s(0);const l=s(32);const u=s(16);const d=s(5);const p=s(152);const h=s(50);const f=s(176);const m=s(20);const g=s(12);const v=s(469);const S=s(27);const y=s(37);const b=280;const _=(0,g.observer)((e=>{const{filteredList:t,dropdown:s,addTagAndClearInput:o,appendToBody:l,optionsRef:u,listRef:d,parentRef:h,setTotalHeight:m,totalHeight:g}=e;(0,c.useEffect)((()=>{}),[s.state.selectedIndex]);const S=new f.CellMeasurerCache({fixedWidth:true,defaultHeight:50});const[_,T]=(0,c.useState)(undefined);const E=(0,c.useCallback)((()=>{if(!l||!h.current){return undefined}const t={position:"fixed",zIndex:parseInt(v.default.zIndexNotificationLayer,10)};const{width:s,bottom:i,top:o,left:n}=h.current.getBoundingClientRect();const r=Math.min(e.totalHeight?e.totalHeight:0,b);if(i+r>window.innerHeight){return Object.assign(t,{width:s,left:n,top:o-r})}return Object.assign(t,{width:s,left:n,top:i})}),[l,h,e.totalHeight]);const I=(0,c.useMemo)((()=>E()),[E,e.totalHeight]);(0,c.useEffect)((()=>{let e=true;if(!l){return undefined}const t=r.debounce((()=>{if(!e){return}T(E())}),5);window.addEventListener("scroll",t,true);window.addEventListener("resize",t);T(undefined);return()=>{e=false;window.removeEventListener("scroll",t,true);window.removeEventListener("resize",t)}}),[l,E,I]);const C=({index:e,parent:c,key:l,style:u})=>{const d=t[e];const h=r.escape(d.extraText);return(0,i.jsx)(f.CellMeasurer,{cache:S,parent:c,columnIndex:0,rowIndex:e,children:(0,i.jsx)("div",{style:u,className:(0,a.default)([n.default.item,s.state.selectedIndex===e&&n.default.highlighted,v.default.item]),title:d.name,onMouseDown:()=>o(d.value),onMouseEnter:()=>{s.state.selectedIndex=e},dangerouslySetInnerHTML:{__html:`${d.extraTextPrepended?h:""}${(0,p.highlight)(d.name,s.state.filter)}${!d.extraTextPrepended?h:""}`}})},l)};const D=r.debounce((()=>m(t.reduce(((e,t,s)=>e+S.rowHeight({index:s})),0))),100);const O=e.totalHeight===0&&t.length<10;return(0,i.jsx)("div",{ref:u,style:_||I,className:(0,a.default)(n.default.autogrow,n.default.dropdownOptions),children:e.isLoading?(0,i.jsx)("div",{className:v.default.loaderWrapper,children:(0,i.jsx)(y.Loader,{})}):(0,i.jsx)(f.AutoSizer,{children:({width:e,height:s})=>(0,i.jsx)(f.List,{height:Math.min(s,g<=0?s:g),width:e,ref:d,rowCount:t.length,overscanColumnCount:10,deferredMeasurementCache:S,rowHeight:S.rowHeight,rowRenderer:C,onRowsRendered:D,className:(0,a.default)(n.default.optionsList,v.default.optionsList,{[v.default.hidden]:O})})})})}));_.displayName="TagsInputOptions";t.TagsInput=(0,g.observer)((e=>{var t;const s=(0,c.useRef)();const o=(0,c.useRef)();const n=(0,p.useDropdown)({listRef:o,defaultSelectedIndex:-1,resetFilterOnBlur:false});const r=(0,m.useClickOutside)({callback:()=>n.setShowOptions(false),activate:n.showOptions,events:["mousedown"],ignoredElements:[s]});const[f,g]=(0,c.useState)(0);const[y,b]=(0,c.useState)((t=e.tags)!==null&&t!==void 0?t:[]);const[T,E]=(0,c.useState)("");const I=(0,c.useRef)(null);const C=e.wrapTagContents?"100%":`${e.placeholder?`${e.placeholder.length*8}px`:"20px"}`;const[D,O]=(0,c.useState)(C);const A=(0,c.useMemo)((()=>{if(!e.suggestions||Array.isArray(e.suggestions)){return S.fromPromise.resolve(e.suggestions||[])}return(0,S.fromPromise)(e.suggestions(n.state.filter))}),[e.suggestions,n.state.filter]);const j=(0,c.useMemo)((()=>Array.isArray(e.suggestions)?e.suggestions.length-1:0),[e.suggestions]);const w=(0,c.useMemo)((()=>{var t,s;if(A.state!=="fulfilled"){return[]}const i=Array.isArray(e.suggestions);const o=(s=(t=A.value)===null||t===void 0?void 0:t.filter((({name:t})=>{if(!i){return true}t=e.searchCaseInsensitive?t.toLowerCase():t;const s=e.searchCaseInsensitive?n.state.filter.toLowerCase():n.state.filter;return t.includes(s)})))!==null&&s!==void 0?s:[];const r=e.singleSelectionMode?o:o.filter((e=>!y.includes(e.value)));if(r.length===1&&r[0].value==="all"){return[]}return r}),[e.suggestions,e.searchCaseInsensitive,A.state,A.value,y,n.state.filter,e.singleSelectionMode]);const R=t=>{b(t);if(e.onTagsChange){e.onTagsChange(t)}};const P=t=>{var s,i;if(e.disabled){return}const o=[...y];o.splice(t,1);(s=e.onInputChanged)===null||s===void 0?void 0:s.call(e,(i=I===null||I===void 0?void 0:I.current)===null||i===void 0?void 0:i.value);R(o)};const x=(0,c.useCallback)((async t=>{var s;if(!t){return}let i=t;if(!e.disableTrimTag){i=t.trim()}if(e.forceTagToLowerCase){i=i.toLowerCase()}if(e.isTagValid&&!await e.isTagValid(i)){return}const o=e.singleSelectionMode?[]:[...y];o.push(i);R(o);O(C);E("");(s=e.onInputChanged)===null||s===void 0?void 0:s.call(e,"");n.state.filter="";if(e.singleSelectionMode){n.setShowOptions(false)}}),[C,n.state,e.forceTagToLowerCase,e.isTagValid,R,y,e.singleSelectionMode]);const M=(0,p.handleKeydown)({...n,value:T,filteredList:w,applyChanges:(t,s)=>{var i;if(e.disableEnterFreeText){return}x((i=s===null||s===void 0?void 0:s.value)!==null&&i!==void 0?i:t);n.state.selectedIndex=-1}});const N=t=>{if([d.KEYS.space,d.KEYS.comma].includes(t.keyCode)&&!e.disableEnterFreeText){x(T);return}if(t.keyCode===d.KEYS.backspace&&!T&&y.length>0){P(y.length-1);return}if(t.keyCode===d.KEYS.tab&&e.disableTabKeySelection){if(!e.disableEnterFreeText){x(T)}n.setShowOptions(false);return}M(t)};const F=(0,c.useCallback)((()=>{if(e.showOptionsOnFocus){const e=y.length===0&&(T===""||T===undefined);if(e){setTimeout((()=>n.setShowOptions(true)),0)}}}),[n,T,e.showOptionsOnFocus,y.length]);const L=(0,c.useCallback)((()=>{if(e.addCurrentTextAsTagOnBlur){x(T)}}),[T,e.addCurrentTextAsTagOnBlur,x]);const k=t=>{var s;E(t);(s=e.onInputChanged)===null||s===void 0?void 0:s.call(e,t);n.state.filter=t;if(!t){O(C);return}let i=I.current.scrollWidth;if(e.wrapTagContents){const e=getComputedStyle(r.current);const t=r.current.clientWidth-(parseInt(e.paddingLeft,10)||0)-(parseInt(e.paddingRight,10)||0);i=Math.min(i,t)}O(`${i}px`)};(0,c.useEffect)((()=>{var t;b((t=e.tags)!==null&&t!==void 0?t:[])}),[e.tags]);const B=(0,c.useMemo)((()=>n.showOptions&&(A.state==="pending"||w.length)),[n.showOptions,w.length,A.state]);const U=(0,c.useCallback)((t=>{var s;if(e.disabled){return}n.setShowOptions(!B);(s=I.current)===null||s===void 0?void 0:s.focus();t.preventDefault()}),[I,n,B,e.disabled]);const G=(0,c.useCallback)((()=>(0,i.jsx)(_,{totalHeight:f,setTotalHeight:g,optionsRef:s,listRef:o,parentRef:r,filteredList:w,addTagAndClearInput:x,dropdown:n,appendToBody:e.appendToBody,isLoading:A.state==="pending"})),[x,n,w,e.appendToBody,f,A.state]);const V=(0,c.useMemo)((()=>{if(!B){return""}if(e.appendToBody&&I.current){return(0,h.createPortal)(G(),document.body)}return G()}),[e.appendToBody,B,G]);return(0,i.jsxs)("div",{ref:r,onKeyDown:N,onMouseDown:U,className:(0,a.default)(v.default.tagsInput,{[v.default.disabled]:e.disabled,[v.default.error]:e.error},e.wrapperClassName),children:[e.isSelectAllEnabled&&y.length===j?(0,i.jsxs)("span",{className:v.default.tag,children:[(0,i.jsx)("span",{title:"All Tags",className:v.default.tagText,children:"All Tags"}),(0,i.jsx)(u.Icon,{className:(0,a.default)({[v.default.disabled]:e.disabled}),icon:"close",onClick:()=>R([])})]},"all-tags"):y.map(((t,s)=>{const o=e.transformDisplayName?e.transformDisplayName(t):t;return(0,i.jsxs)("span",{className:v.default.tag,children:[(0,i.jsx)("span",{title:o,className:(0,a.default)(v.default.tagText,{[v.default.wrapTagText]:e.wrapTagContents}),children:o}),(0,i.jsx)(u.Icon,{className:(0,a.default)({[v.default.disabled]:e.disabled}),icon:"close",onClick:e=>{var t;P(s);(t=I.current)===null||t===void 0?void 0:t.focus();e.preventDefault()},onMouseDown:e=>{e.stopPropagation()}})]},s)})),(0,i.jsx)(l.Textbox,{style:{width:D},ref:I,placeholder:e.placeholder,className:v.default.input,disabled:e.disabled,autoFocus:e.autoFocus,value:T,onFocus:F,onBlur:L,onChange:e=>k(e.target.value)}),V]})}));t.TagsInput.displayName="TagsInput"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Textbox=void 0;const i=s(4);const o=s(0);const n=s(460);const r=s(10);t.Textbox=o.forwardRef((({variety:e,hasError:t,className:s,...o},a)=>{const c=(0,r.default)(n.default.textField,e?n.default[e]:"",{[n.default.borderRed]:t},s);return(0,i.jsx)("input",{className:c,ref:a,...o})}));t.Textbox.displayName="Textbox"},function(e,t,s){"use strict";s.r(t);t["default"]={textField:"textbox_textField_2SD96_RleHRib3gt","--error":"textbox_--error_1Xgvz_RleHRib3gt",error:"textbox_--error_1Xgvz_RleHRib3gt",black:"textbox_black_lhJcA_RleHRib3gt",borderRed:"textbox_borderRed_2dg6P_RleHRib3gt",propertyPanelMedium:"textbox_propertyPanelMedium_CDVxw_RleHRib3gt"}},,,,,,,,,function(e,t,s){"use strict";s.r(t);t["default"]={zIndexNotificationLayer:"3012",tagsInput:"tagsInput_tagsInput_3-tk0_dzSW5wdXQt",disabled:"tagsInput_disabled_aKiPC_dzSW5wdXQt",error:"tagsInput_error_8CPIk_dzSW5wdXQt",tags:"tagsInput_tags_1xjlB_dzSW5wdXQt",tag:"tagsInput_tag_2faqC_dzSW5wdXQt",tagText:"tagsInput_tagText_wABqS_dzSW5wdXQt",wrapTagText:"tagsInput_wrapTagText_1lzhs_dzSW5wdXQt",input:"tagsInput_input_2lNiS_dzSW5wdXQt",optionsList:"tagsInput_optionsList_3FCW6_dzSW5wdXQt",hidden:"tagsInput_hidden_3aSgd_dzSW5wdXQt",item:"tagsInput_item_6P3pa_dzSW5wdXQt",loaderWrapper:"tagsInput_loaderWrapper_1cBof_dzSW5wdXQt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Loader=void 0;const i=s(4);const o=s(0);const n=s(471);const r=s(10);const a=s(0);const c=({className:e,showAfter:t,marginAuto:s})=>{const[c,l]=o.useState(Boolean(t));(0,a.useLayoutEffect)((()=>{if(t){const e=setTimeout((()=>l(false)),t);return()=>clearTimeout(e)}if(c){l(false)}return undefined}),[t,c]);if(c){return null}return(0,i.jsxs)("div",{className:(0,r.default)(n.default.ldsEllipsis,s&&n.default.marginAuto,e),children:[(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{})]})};c.displayName="DelayedLoader";const l=e=>{if(!e.showAfter){return(0,i.jsxs)("div",{className:(0,r.default)(n.default.ldsEllipsis,e.marginAuto&&n.default.marginAuto,e.className),children:[(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{})]})}return(0,i.jsx)(c,{...e})};t.Loader=l;t.Loader.displayName="Loader"},function(e,t,s){"use strict";s.r(t);t["default"]={ldsEllipsis:"Loader_ldsEllipsis_3VEUg_1Mb2FkZXIt","lds-ellipsis1":"Loader_lds-ellipsis1_RcnbC_1Mb2FkZXIt",ldsEllipsis1:"Loader_lds-ellipsis1_RcnbC_1Mb2FkZXIt","lds-ellipsis2":"Loader_lds-ellipsis2_3Dr8v_1Mb2FkZXIt",ldsEllipsis2:"Loader_lds-ellipsis2_3Dr8v_1Mb2FkZXIt","lds-ellipsis3":"Loader_lds-ellipsis3_xIyBo_1Mb2FkZXIt",ldsEllipsis3:"Loader_lds-ellipsis3_xIyBo_1Mb2FkZXIt",marginAuto:"Loader_marginAuto_2dO40_1Mb2FkZXIt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(473),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Autocomplete=void 0;const i=s(4);const o=s(0);const n=s(0);const r=s(32);const a=s(152);const c=s(16);const l=s(10);const u=s(151);const d=s(474);const p=s(12);const h=s(50);const f=s(27);const m=s(37);t.Autocomplete=(0,p.observer)((e=>{const t=(0,a.useDropdown)({defaultSelectedIndex:-1,resetFilterOnBlur:false});const{value:s,inputProps:o,hideIcon:p,appendToBody:v,caseInsensitive:S,onAutoCompletion:y,onChange:b}=e;const{setShowOptions:_}=t;const T=(0,n.useRef)(null);const E=(0,n.useCallback)(((e,s)=>{t.state.filter=e;if(s){y(s)}else{b(e)}}),[t.state,y,b]);const I=(0,n.useMemo)((()=>{if(Array.isArray(e.suggestions)){return f.fromPromise.resolve(e.suggestions)}return(0,f.fromPromise)(e.suggestions(t.state.filter))}),[e.suggestions,t.state.filter]);const C=(0,n.useMemo)((()=>{var s;if(I.state!=="fulfilled"){return[]}const i=Array.isArray(e.suggestions);const o=(s=I.value)!==null&&s!==void 0?s:[];if(!i){return o}const n=S?t.state.filter.toLowerCase():t.state.filter;return o.filter((({name:e})=>(S?e.toLowerCase():e).includes(n)))}),[e.suggestions,S,t.state.filter,I.state,I.value]);const D=(0,n.useMemo)((()=>(0,a.handleKeydown)({...t,value:s,applyChanges:E,filteredList:C})),[t,s,E,C]);const O=(0,n.useCallback)((()=>_(false)),[_]);const A=(0,n.useCallback)((e=>E(e.target.value)),[E]);const j=(0,n.useCallback)((()=>E("")),[E]);const w=(0,n.useMemo)((()=>{var e;if(!v){return undefined}const{width:t,bottom:s,left:i}=((e=T.current)===null||e===void 0?void 0:e.getBoundingClientRect())||{width:0,bottom:0,left:0};const o={position:"fixed",zIndex:parseInt(d.default.zIndexNotificationLayer,10),width:t,left:i,top:s};return o}),[v,T.current]);const R=(0,n.useMemo)((()=>{if(I.state==="pending"){return(0,i.jsx)("div",{className:d.default.loaderWrapper,children:(0,i.jsx)(m.Loader,{})})}return C.map(((e,s)=>(0,i.jsx)(g,{applyChanges:E,setSelectedIndex:e=>{t.state.selectedIndex=e},index:s,suggestion:e,isSelected:t.state.selectedIndex===s,filter:t.state.filter},s)))}),[C,t.state,I.state,E]);return(0,i.jsxs)("div",{className:(0,l.default)(u.default.dropdownContainer,d.default.dropdownContainer),children:[(0,i.jsxs)("div",{className:(0,l.default)(u.default.inputContainer,d.default.inputContainer),children:[(0,i.jsx)(r.Textbox,{...o,ref:T,onKeyDown:D,onBlur:O,value:s,onChange:A}),!p&&(0,i.jsx)(c.Icon,{icon:t.state.filter?"close":"search",onClick:j,className:d.default.icon})]}),Boolean(t.showOptions&&(I.state==="pending"||C.length))&&(v?(0,h.createPortal)((0,i.jsx)("div",{className:u.default.dropdownOptionsStatic,style:w,ref:t.optionsElement,children:R}),document.body):(0,i.jsx)("div",{className:u.default.dropdownOptionsStatic,ref:t.optionsElement,children:R}))]})}));t.Autocomplete.displayName="Autocomplete";function g({index:e,suggestion:t,applyChanges:s,setSelectedIndex:o,isSelected:r,filter:c}){const d=(0,n.useCallback)((()=>s("",t)),[s,t]);const p=(0,n.useCallback)((()=>o(e)),[o,e]);return(0,i.jsx)("div",{className:(0,l.default)({[u.default.highlighted]:r}),title:t.name,onMouseDown:d,onMouseEnter:p,dangerouslySetInnerHTML:(0,a.safeHighlight)(t.name,c)})}g.displayName="FilterItem"},function(e,t,s){"use strict";s.r(t);t["default"]={zIndexNotificationLayer:"3012",dropdownContainer:"autocomplete_dropdownContainer_1I7en_9tcGxldGUt",inputContainer:"autocomplete_inputContainer_3GHJG_9tcGxldGUt",icon:"autocomplete_icon_15vsS_9tcGxldGUt",loaderWrapper:"autocomplete_loaderWrapper_3x68I_9tcGxldGUt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Checkbox=void 0;const i=s(4);const o=s(0);const n=s(476);const r=s(10);t.Checkbox=o.memo((({children:e,wrapperClassName:t,...s})=>{var o;const a=(o=s.title)!==null&&o!==void 0?o:typeof e==="string"?e:"";const c=s.disabled;return(0,i.jsxs)("label",{className:(0,r.default)(n.default.checkboxLabel,s.variety&&n.default[s.variety],t,{[n.default.checkboxLabelDisabled]:c}),title:a,children:[(0,i.jsx)("input",{type:"checkbox",...s}),e]})}));t.Checkbox.displayName="Checkbox"},function(e,t,s){"use strict";s.r(t);t["default"]={large:"checkbox_large_i-62U_hlY2tib3gt",checkboxLabel:"checkbox_checkboxLabel_2Kz_x_hlY2tib3gt",checkboxLabelDisabled:"checkbox_checkboxLabelDisabled_3vT3b_hlY2tib3gt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Dropdown=void 0;const i=s(4);const o=s(6);const n=s(10);const r=s(151);const a=s(0);const c=s(50);const l=s(32);const u=s(152);const d=s(16);const p=s(176);const h=s(20);const f=s(12);const m=s(27);const g=s(37);const v=280;const S=81;const y=(0,f.observer)((e=>{var t;const[s,c]=(0,a.useState)(undefined);const[f,m]=(0,a.useState)("bottom");const{value:y,optionsClassName:b,searchContainerClassName:T,optionsListClassName:E,searchable:I=true,renderItem:C,applyChanges:D,filteredList:O,dropdown:A,listRef:j,appendToBody:w,inputRef:R,setTotalHeight:P,onToggle:x,isLoading:M,noResults:N,itemsHeader:F}=e;(0,a.useEffect)((()=>{}),[A.state.selectedIndex]);const L=(0,h.useClickOutside)({callback:()=>{A.setShowOptions(false);x===null||x===void 0?void 0:x(false)},activate:A.showOptions,ignoredElements:[R]});const k=(0,a.useCallback)((()=>{if(!w){return undefined}const t={position:"fixed",zIndex:parseInt(r.default.zIndexNotificationLayer,10)};const{width:s,bottom:i,top:o,left:n}=R.current.getBoundingClientRect();const a=Math.min(e.totalHeight?e.totalHeight+(I?S:0):0,v);if(i+a>window.innerHeight){m("top");return Object.assign(t,{width:s,left:n,top:o-a})}m("bottom");return Object.assign(t,{width:s,left:n,top:i})}),[w,R,L,e.totalHeight]);const B=(0,a.useMemo)((()=>k()),[k,e.totalHeight]);(0,a.useEffect)((()=>{let e=true;if(!w){return undefined}const t=o.debounce((()=>{if(!e){return}c(k())}),5);window.addEventListener("scroll",t,true);window.addEventListener("resize",t);c(undefined);return()=>{e=false;window.removeEventListener("scroll",t,true);window.removeEventListener("resize",t)}}),[w,k,B]);const U=(0,a.useMemo)((()=>(0,u.handleKeydown)({...A,value:y,applyChanges:D,filteredList:O})),[A,y,D,O]);const G=(0,a.useCallback)((e=>{e.nativeEvent.preventDefault();A.state.filter=""}),[A.state]);const V=(0,a.useCallback)((e=>D(e.target.value)),[D]);const H=(0,a.useMemo)((()=>new p.CellMeasurerCache({fixedWidth:true,defaultHeight:50})),[]);H.clearAll();const $=(0,a.useMemo)((()=>o.debounce((()=>P(O.reduce(((e,t,s)=>e+H.rowHeight({index:s})),0))),100)),[P,H,O]);const W=({index:e,parent:t,key:s,style:o})=>{const n=O[e];return(0,i.jsx)(_,{RenderItem:C,applyChanges:D,cache:H,option:n,index:e,parent:t,value:y,style:o,isSelected:A.state.selectedIndex===e,setSelectedIndex:e=>{A.state.selectedIndex=e}},s)};const J=e.totalHeight===0&&O.length<10;return(0,i.jsxs)("div",{ref:L,style:s||B,className:(0,n.default)(r.default.dropdownOptions,r.default[f],b),children:[I&&(0,i.jsxs)("div",{className:(0,n.default)(r.default.optionsSearch,T),children:[(0,i.jsx)(d.Icon,{className:r.default.optionsSearchIcon,icon:"search-thin"}),(0,i.jsx)(l.Textbox,{...e.optionsSearchableProps,autoFocus:true,onKeyDown:U,value:A.state.filter,onChange:V}),A.state.filter&&(0,i.jsx)(d.Icon,{className:r.default.optionsSearchClose,icon:"close-thin",onMouseDown:G})]}),(0,i.jsxs)("div",{className:(0,n.default)(r.default.autogrow,{[r.default.hasSearch]:I}),children:[M&&(0,i.jsx)("div",{className:r.default.loaderWrapper,children:(0,i.jsx)(g.Loader,{})}),!M&&F,Boolean(O.length&&!M)&&(0,i.jsx)(p.AutoSizer,{children:({width:t,height:s})=>(0,i.jsx)(p.List,{height:Math.min(s,e.totalHeight<=0?s:e.totalHeight),width:t,ref:j,rowCount:O.length,overscanColumnCount:10,deferredMeasurementCache:H,rowHeight:H.rowHeight,rowRenderer:W,onRowsRendered:$,className:(0,n.default)(r.default.optionsList,E,{[r.default.hidden]:J})})}),Boolean(!O.length&&!M)&&(0,i.jsx)("div",{className:r.default.optionsNoResults,children:(0,i.jsx)("div",{children:(t=N===null||N===void 0?void 0:N(A.state.filter))!==null&&t!==void 0?t:"No results."})})]})]})}));y.displayName="DropdownOptions";t.Dropdown=(0,f.observer)((e=>{var t;const[s,o]=(0,a.useState)(0);const c=(0,a.useRef)();const l=(0,a.useRef)(null);const p=(0,u.useDropdown)({listRef:c,resetFilterOnBlur:true});const{value:h,options:g,onChange:v,onToggle:S,placeholder:y,disabled:_,className:T,containerClassName:E,SelectedItemRenderComponent:I,searchable:C=true,iconWhenClosed:D="arrow-down",iconWhenOpen:O="arrow-up"}=e;const{setShowOptions:A,showOptions:j}=p;const w=(0,f.useLocalStore)((e=>({get isLoading(){return w.filteredList.state==="pending"},get filteredList(){if(Array.isArray(e.options)){return m.fromPromise.resolve(e.options.filter((e=>{var t,s;return((t=e.name)!==null&&t!==void 0?t:"").toLowerCase().includes(((s=p.state.filter)!==null&&s!==void 0?s:"").toLowerCase())})))}return(0,m.fromPromise)(e.options(p.state.filter))}})),{options:g});const R=(0,a.useCallback)(((e,t)=>{if(t){v(t);p.state.filter="";A(false)}else{p.state.filter=e}}),[p.state,A,v]);const P=w.filteredList.case({fulfilled:e=>e,pending:()=>[],rejected:()=>[]});const x=p.showOptions?O:D;const M=(0,a.useCallback)((e=>{e.stopPropagation();if(_){return}A(!j);S===null||S===void 0?void 0:S(!j)}),[_,A,j,S]);const N=j&&(P.length||C);const F=(0,a.useCallback)((()=>R("",h)),[h,R]);const L=I&&h?(0,i.jsx)(I,{item:h}):(t=h===null||h===void 0?void 0:h.name)!==null&&t!==void 0?t:"";return(0,i.jsxs)("div",{className:(0,n.default)(r.default.dropdownContainer,T),children:[(0,i.jsxs)("div",{ref:l,className:(0,n.default)(r.default.mainContainer,E,{[r.default.disabled]:_}),children:[(0,i.jsx)("span",{onClick:M,onDoubleClick:M,tabIndex:0,onKeyDown:e=>e.key==="Enter"&&M(e),children:(0,i.jsx)("div",{children:L})}),Boolean(y&&!h)&&(0,i.jsx)("div",{className:r.default.placeholder,children:y}),(0,i.jsx)(d.Icon,{className:(0,n.default)({[r.default.disabled]:_}),icon:x,onClick:F})]}),(0,i.jsx)(b,{inputRef:l,applyChanges:R,filteredList:P,dropdown:p,totalHeight:s,setTotalHeight:o,listRef:c,showOptions:N,isLoading:w.isLoading,...e})]})}));t.Dropdown.displayName="Dropdown";function b(e){const{showOptions:t,appendToBody:s,inputRef:o,applyChanges:n,filteredList:r,dropdown:a,totalHeight:l,setTotalHeight:u,listRef:d,...p}=e;if(!t){return null}if(s&&o.current){return(0,c.createPortal)((0,i.jsx)(y,{inputRef:o,applyChanges:n,filteredList:r,dropdown:a,totalHeight:l,setTotalHeight:u,listRef:d,appendToBody:s,...p}),document.body)}return(0,i.jsx)(y,{inputRef:o,applyChanges:n,filteredList:r,dropdown:a,totalHeight:l,setTotalHeight:u,listRef:d,appendToBody:s,...p})}function _({index:e,parent:t,style:s,option:o,isSelected:c,cache:l,applyChanges:u,RenderItem:d,value:h,setSelectedIndex:f}){var m;const g=(0,a.useCallback)((()=>u("",o)),[o,u]);const v=(0,a.useCallback)((()=>f(e)),[e,f]);return(0,i.jsx)(p.CellMeasurer,{cache:l,parent:t,columnIndex:0,rowIndex:e,children:(0,i.jsx)("div",{style:s,className:(0,n.default)([r.default.item,{[r.default.highlighted]:c,[r.default.selected]:((m=o.value)!==null&&m!==void 0?m:null)===(h===null||h===void 0?void 0:h.value)}]),title:o.name,onMouseDown:g,onMouseEnter:v,children:d?(0,i.jsx)(d,{item:o}):o.name})})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TextboxWithCopy=void 0;const i=s(4);const o=s(0);const n=s(479);const r=s(10);const a=s(32);const c=s(20);const l=s(0);t.TextboxWithCopy=o.memo((({onCopy:e,value:t,className:s,readOnly:o,variety:u,hasError:d,buttonClassName:p})=>{const h=(0,l.useCallback)((()=>{(0,c.copyToClipboard)(t!==null&&t!==void 0?t:"");e===null||e===void 0?void 0:e()}),[e,t]);return(0,i.jsxs)("div",{className:(0,r.default)(n.default.textboxWithCopy,s),children:[(0,i.jsx)(a.Textbox,{value:t,readOnly:o,variety:u,hasError:d}),(0,i.jsx)("button",{onClick:h,className:(0,r.default)(n.default.copyButton,p,{[n.default.borderRed]:d}),children:"Copy"})]})}));t.TextboxWithCopy.displayName="TextboxWithCopy"},function(e,t,s){"use strict";s.r(t);t["default"]={textboxWithCopy:"textboxWithCopy_textboxWithCopy_2CUas_l0aENvcHkt",copyButton:"textboxWithCopy_copyButton_19PAz_l0aENvcHkt","border-red":"textboxWithCopy_border-red_1jE6f_l0aENvcHkt",borderRed:"textboxWithCopy_border-red_1jE6f_l0aENvcHkt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FieldLabel=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(481);const a=e=>(0,i.jsxs)("label",{onClick:e.onClick,className:(0,n.default)(r.default.fieldLabel,e.error?r.default.hasError:"",e.className),children:[e.children,e.error&&(0,i.jsx)("span",{className:r.default.error,children:e.error}),e.secondaryLabel&&(0,i.jsx)("span",{className:e.secondaryLabelClassName,children:e.secondaryLabel})]});t.FieldLabel=a;t.FieldLabel.displayName="FieldLabel"},function(e,t,s){"use strict";s.r(t);t["default"]={fieldLabel:"fieldLabel_fieldLabel_2XnFA_xkTGFiZWwt",hasError:"fieldLabel_hasError_1BxfS_xkTGFiZWwt",error:"fieldLabel_error_tEAQ3_xkTGFiZWwt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(483),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestStatusDropdown=void 0;const i=s(4);const o=s(0);const n=s(66);const r=s(40);const a=s(0);const c=s(484);const l=s(10);const u=s(204);const d=s(45);const p=s(11);const h=s(28);const f=s(15);const m=s(29);const g=s(52);const v=s(34);const S=s(146);const y=s(26);const b=s(39);const _=s(5);const T=Object.keys(u.TestStatusNameMap).map((e=>({name:u.TestStatusNameMap[e],value:e})));const E=T[0];const I=(e,t)=>{var s;if(e){return{name:"Select",value:"select"}}return(s=T.find((e=>e.value===t)))!==null&&s!==void 0?s:E};const C=({testId:e,className:t,testStatus:s,onChange:o,blockChangeIfTestOpenInEditor:u,showTooltip:E,size:C="small"})=>{const D=(0,p.useDependencyInjector)(S.FeatureAvailabilityService);const O=(0,p.useDependencyInjector)(b.CompaniesService);const A=(0,p.useDependencyInjector)(f.ProjectsService);const j=!D.isTestStatusEnabled&&!(A.isDemo&&O.adminPrivilegesForCurrentCompany==="readWrite");const[w,R]=(0,a.useState)(I(j,s));const P=(0,p.useDependencyInjector)(h.ModalService);const x=(0,p.useDependencyInjector)(y.UrlStateService);const M=(0,p.useDependencyInjector)(m.EditedTestStore);const N=(0,p.useDependencyInjector)(v.BranchesService);const{isBranchReadOnly:F,branchReadOnlyMessage:L}=N.getCurrentBranchReadOnlyData();const k=(0,a.useCallback)((async t=>{if(u&&e&&M.testId===e){const t=await P.openModal(d.MessageModal,{title:"You cannot change the test status",body:"Test is already open in the editor, to change the test status, go to the editor",okText:"Take me to editor",className:c.default.backToOpenedTestModal}).promise;if(t){x.go(n.test(A.projectId,N.branch,e))}return}R((s=>{o(s,t,e);return t}))}),[u,N.branch,M.testId,P,o,A.projectId,e,x]);const B=(0,a.useMemo)((()=>j||u&&F),[u,F,j]);const U=(0,a.useMemo)((()=>{if(j){return _.tooltipText.payingCustomerChangeStatus}if(!E){return""}if(B){return L}return""}),[L,B,E,j]);const G=(0,a.useMemo)((()=>B&&!j?0:1500),[B,j]);(0,a.useEffect)((()=>{R(I(j,s))}),[s,j]);return(0,i.jsx)(g.Tooltip,{delay:G,value:U,children:(0,i.jsx)("div",{className:(0,l.default)(t,c.default.container,c.default[C],{[c.default.disabled]:B}),children:(0,i.jsx)(r.Dropdown,{disabled:B,optionsListClassName:c.default.optionsList,optionsClassName:c.default.dropdownOptions,containerClassName:(0,l.default)(c.default.dropdown,c.default[w.value]),searchable:false,appendToBody:true,value:w,options:T,onChange:k})})})};t.TestStatusDropdown=C;t.TestStatusDropdown.displayName="TestStatusDropdown"},function(e,t,s){"use strict";s.r(t);t["default"]={container:"TestStatusDropdown_container_m7QHI_JvcGRvd24t",disabled:"TestStatusDropdown_disabled_31oZ3_JvcGRvd24t",dropdown:"TestStatusDropdown_dropdown_2FLYc_JvcGRvd24t",draft:"TestStatusDropdown_draft_e9t9i_JvcGRvd24t",active:"TestStatusDropdown_active_2wkD0_JvcGRvd24t",quarantine:"TestStatusDropdown_quarantine_3I_UW_JvcGRvd24t",evaluating:"TestStatusDropdown_evaluating_2-GKM_JvcGRvd24t","extra-large":"TestStatusDropdown_extra-large_2jK8e_JvcGRvd24t",extraLarge:"TestStatusDropdown_extra-large_2jK8e_JvcGRvd24t",medium:"TestStatusDropdown_medium_JtjKF_JvcGRvd24t",small:"TestStatusDropdown_small_3dzmq_JvcGRvd24t","dropdown-options":"TestStatusDropdown_dropdown-options_3QAAj_JvcGRvd24t",dropdownOptions:"TestStatusDropdown_dropdown-options_3QAAj_JvcGRvd24t","options-list":"TestStatusDropdown_options-list_2xgTg_JvcGRvd24t",optionsList:"TestStatusDropdown_options-list_2xgTg_JvcGRvd24t","back-to-opened-test-modal":"TestStatusDropdown_back-to-opened-test-modal_vW-bC_JvcGRvd24t",backToOpenedTestModal:"TestStatusDropdown_back-to-opened-test-modal_vW-bC_JvcGRvd24t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MessageModal=void 0;const i=s(4);const o=s(10);const n=s(70);const r=s(81);const a=s(30);const c=s(31);const l=s(16);const u=s(0);const d=s(37);const p=({okText:e,cancelText:t,closeModal:s,displayFooterLoader:o})=>{if(o){return(0,i.jsx)(d.Loader,{})}return(0,i.jsxs)("div",{children:[e?(0,i.jsx)(c.Cta,{autoFocus:true,onClick:()=>s(true),children:e}):null,t?(0,i.jsx)(c.Cta,{variety:"secondary",onClick:()=>s(false),children:t}):null]})};p.displayName="Footer";const h=e=>{var t;const s=Boolean(e.image||e.icon);const c=e.textAlign==="left"?n.default.textAlignLeft:n.default.textAlignCenter;const d=(t=e.variety)!==null&&t!==void 0?t:"normal";const h=(0,u.useCallback)((()=>e.closeModal(e.considerDiscardAsCancel===false?undefined:false)),[e.closeModal,e.considerDiscardAsCancel]);return(0,i.jsxs)(a.BaseModal,{className:(0,o.default)(e.className,{[r.default.errorType]:d==="error",[r.default.warningModal]:d==="warning",[r.default.infoModal]:d==="info",[r.default.allowWhiteSpace]:e.allowWhiteSpace}),closeModal:h,subHeader:e.subHeader,subHeaderClassName:e.subHeaderClassName,header:(0,i.jsx)("h3",{children:e.title}),footer:e.hideFooter===true?"":(0,i.jsx)(p,{...e}),children:[e.image&&(0,i.jsx)("div",{className:(0,o.default)(n.default.modalSection,r.default.flexRowCenter),children:(0,i.jsx)("img",{className:r.default.modalIconImage,src:e.image,alt:e.alt})}),e.icon&&(0,i.jsx)("div",{className:(0,o.default)(n.default.modalSection,r.default.flexRowCenter,e.iconClass),children:(0,i.jsx)(l.Icon,{className:(0,o.default)(r.default.modalIcon,r.default.icon),icon:e.icon,title:e.alt,children:e.childIcon?(0,i.jsx)(l.Icon,{className:r.default.childIcon,icon:e.childIcon}):null})}),e.subTitle&&(0,i.jsx)("p",{className:(0,o.default)(n.default.modalSection,r.default.bold,s&&r.default.flexRowCenter),children:e.subTitle}),e.body&&(0,i.jsx)("div",{className:(0,o.default)(n.default.modalSection,c,s&&r.default.flexRowCenter),children:e.body}),e.note&&(0,i.jsx)("p",{className:(0,o.default)(n.default.modalSection,r.default.modalNote,s&&r.default.flexRowCenter),children:e.note})]})};t.MessageModal=h;t.MessageModal.displayName="MessageModal"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(487),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PasswordTextbox=void 0;const i=s(4);const o=s(0);const n=s(32);const r=s(0);const a=s(488);const c=s(6);const l=s(16);const u=e=>{const[t,s]=(0,r.useState)(false);const o=()=>{s(!t)};return(0,i.jsxs)("div",{className:a.default.passwordTextbox,children:[(0,i.jsx)(n.Textbox,{type:t?"text":"password",...c.omit(e,["type"])}),(0,i.jsx)("div",{onClick:o,className:a.default.passwordIcon,children:t?(0,i.jsx)(l.Icon,{icon:"eye-on"}):(0,i.jsx)(l.Icon,{icon:"eye-off"})})]})};t.PasswordTextbox=u;t.PasswordTextbox.displayName="PasswordTextbox"},function(e,t,s){"use strict";s.r(t);t["default"]={"password-textbox":"passwordTextbox_password-textbox_2YA3A_RleHRib3gt",passwordTextbox:"passwordTextbox_password-textbox_2YA3A_RleHRib3gt","password-icon":"passwordTextbox_password-icon_2rrR1_RleHRib3gt",passwordIcon:"passwordTextbox_password-icon_2rrR1_RleHRib3gt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(490),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TextArea=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(491);t.TextArea=(0,n.forwardRef)((({className:e,...t},s)=>(0,i.jsx)("textarea",{ref:s,className:(0,o.default)(r.default.textarea,e),...t})));t.TextArea.displayName="TextArea"},function(e,t,s){"use strict";s.r(t);t["default"]={textarea:"textarea_textarea_v75rW_V4dGFyZWEt","--error":"textarea_--error_1F_RA_V4dGFyZWEt",error:"textarea_--error_1F_RA_V4dGFyZWEt",black:"textarea_black_3KjCA_V4dGFyZWEt","border-red":"textarea_border-red_638uo_V4dGFyZWEt",borderRed:"textarea_border-red_638uo_V4dGFyZWEt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(493),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PhoneTextbox=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(6);const a=s(494);s(495);const c=s(496);const l=s(42);const u=s(8);const d=s(5);const p=e=>async t=>{if(false){}let s=e;try{const t=await l.httpRequest.getJson("https://ipinfo.io?callback");s=(t===null||t===void 0?void 0:t.country)||e}catch{}finally{t(s)}};const h=e=>{var t;const s=((t=u.utils.getStorage().getItem(d.SIGNUP_COUNTRY_KEY))===null||t===void 0?void 0:t.toLowerCase())||"us";return(0,i.jsx)(c.default,{containerClassName:(0,n.default)("intl-tel-input",e.containerClassName,a.default.phoneInputContainer,{[a.default.disabled]:e.disabled}),inputClassName:(0,n.default)("form-control",e.inputClassName,a.default.phoneInput),separateDialCode:true,allowDropdown:true,autoHideDialCode:true,defaultCountry:s,autoPlaceholder:"aggressive",geoIpLookup:p(s),onFlagClick:t=>{var s;t.preventDefault();(s=e.onFlagClick)===null||s===void 0?void 0:s.call(e,t)},...r.omit(e,"containerClassName","onFlagClick")})};t.PhoneTextbox=h;t.PhoneTextbox.displayName="PhoneTextbox"},function(e,t,s){"use strict";s.r(t);t["default"]={phoneInputContainer:"PhoneTextbox_phoneInputContainer_3-2Mf_RleHRib3gt","--error":"PhoneTextbox_--error_pZlkW_RleHRib3gt",error:"PhoneTextbox_--error_pZlkW_RleHRib3gt",disabled:"PhoneTextbox_disabled_3xWGF_RleHRib3gt",phoneInput:"PhoneTextbox_phoneInput_19oIc_RleHRib3gt"}},,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SelectApp=t.AppOptionRow=void 0;const i=s(4);const o=s(10);const n=s(506);const r=s(0);const a=s(6);const c=s(12);const l=s(37);const u=s(82);const d=s(11);const p=s(226);const h=s(156);const f=s(155);const m=s(52);const g=s(16);const v=s(225);const S=s(227);const y=s(103);const b=({name:e,version:t,isSelected:s,handleClick:r})=>{const a=t&&t!=="N/A"&&`Version ${t}`;return(0,i.jsxs)("div",{className:(0,o.default)(n.default.appRowWrapper,s&&n.default.selectedApp),onClick:s?undefined:r,children:[(0,i.jsx)("div",{className:n.default.appRowImageWrapper,children:(0,i.jsx)(g.Icon,{className:n.default.appRowImage,icon:"mobile-app"})}),(0,i.jsxs)("div",{className:n.default.appDetails,children:[(0,i.jsx)(m.Tooltip,{value:e,direction:"bottom",delay:200,children:(0,i.jsx)("div",{className:n.default.appName,children:e})}),(0,i.jsx)(m.Tooltip,{value:a,direction:"bottom",delay:200,children:(0,i.jsx)("div",{className:n.default.version,children:a})})]})]})};t.AppOptionRow=b;t.AppOptionRow.displayName="AppOptionRow";const _=(0,c.observer)((()=>{const e=(0,d.useDependencyInjector)(u.SetupMobileTestStore);(0,r.useEffect)((()=>{const t=e.projectsService.defaultAppId;if(e.appSource===h.AppSource.LIBRARY&&t&&(0,a.isEmpty)(e.appsFilterValue)){const s=e.filteredAppOptions.find((e=>e.data._id===t));if(s){e.selectApplication(s.data)}}}),[e]);if((0,a.isEmpty)(e.filteredAppOptions)&&(0,a.isEmpty)(e.appsFilterValue)){return(0,i.jsx)("div",{className:n.default.noApps,children:(0,i.jsx)(v.AppsEmptyState,{})})}const s=t=>{e.changeAppsFilterValue(t.currentTarget.value)};return(0,i.jsxs)("div",{className:n.default.appOptions,children:[(0,i.jsx)("div",{className:n.default.searchInput,children:(0,i.jsx)(f.SearchInput,{value:e.appsFilterValue,changeHandler:s})}),e.filteredAppOptions.map(((s,o)=>(0,i.jsx)(t.AppOptionRow,{name:s.name,version:s.version,isSelected:(0,a.isEqual)(e.selectedApplication,s.data),handleClick:()=>e.selectApplication(s.data)},o)))]})}));_.displayName="SelectAppOptions";const T=(0,c.observer)((()=>{const e=(0,d.useDependencyInjector)(u.SetupMobileTestStore);const t=[{text:"FROM LIBRARY",icon:"mobile-app",isSelected:e.appSource===h.AppSource.LIBRARY,handleClick:e.selectLibrary},{text:"FROM DEVICE",icon:"physical-device",isSelected:e.appSource===h.AppSource.DEVICE,handleClick:e.selectFromDevice},{text:"UPLOAD APP",icon:"upload-file",isSelected:e.appSource===h.AppSource.UPLOAD,handleClick:e.selectUpload}];return(0,i.jsx)(p.SelectCategory,{categories:t})}));T.displayName="SelectAppSource";t.SelectApp=(0,c.observer)((()=>{const e=(0,d.useDependencyInjector)(y.MobileAppsStore);const t=(0,d.useDependencyInjector)(u.SetupMobileTestStore);return(0,i.jsxs)("div",{className:n.default.selectAppWrapper,children:[(0,i.jsx)(T,{}),t.appSource===h.AppSource.UPLOAD?(0,i.jsx)(S.DragAndDropUpload,{uploadedFileType:e.uploadedFileTypes,maxUploadedSize:t.maxUploadedSize,handleUploadFile:t.handleUploadFile,handleDiscardFile:t.discardFile,uploadedFile:t.currentUploadedFile,isUploadingFile:t.isUploadingFile,isInSelectAppModal:true,error:t.error,analyticsSource:"select-application-modal"}):t.selectAppOptions.case({pending:()=>(0,i.jsx)(l.Loader,{}),rejected:()=>null,fulfilled:()=>(0,i.jsx)(_,{})})]})}));t.SelectApp.displayName="SelectApp"},function(e,t,s){"use strict";s.r(t);t["default"]={selectAppWrapper:"SelectApp_selectAppWrapper_rlXgA_xlY3RBcHAt",noApps:"SelectApp_noApps_3rPik_xlY3RBcHAt",appOptions:"SelectApp_appOptions_3gRrA_xlY3RBcHAt",searchInput:"SelectApp_searchInput_2DPj6_xlY3RBcHAt",appRowWrapper:"SelectApp_appRowWrapper_2LRyH_xlY3RBcHAt",selectedApp:"SelectApp_selectedApp_2ILsZ_xlY3RBcHAt",appDetails:"SelectApp_appDetails_W8uxw_xlY3RBcHAt",appName:"SelectApp_appName_1V3Zr_xlY3RBcHAt",version:"SelectApp_version_3Y9us_xlY3RBcHAt",appRowImageWrapper:"SelectApp_appRowImageWrapper_3HYzl_xlY3RBcHAt",appRowImage:"SelectApp_appRowImage_3KTIm_xlY3RBcHAt",selectApplication:"SelectApp_selectApplication_2ADpL_xlY3RBcHAt",dropDown:"SelectApp_dropDown_z7O35_xlY3RBcHAt",filter:"SelectApp_filter_25zxB_xlY3RBcHAt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(508),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SetupMobileTest=void 0;const i=s(4);const o=s(0);const n=s(509);const r=s(30);const a=s(31);const c=s(0);const l=s(82);const u=s(12);const d=s(11);const p=s(222);const h=s(223);const f=s(156);const m=s(16);const g=s(5);const v=(0,i.jsxs)("div",{className:n.default.subHeaderStyle,children:[(0,i.jsx)(m.Icon,{icon:"mobile-agent-indicator",className:n.default.tmaUpgradeIcon}),(0,i.jsxs)("div",{className:n.default.subHeaderInner,children:[(0,i.jsx)("div",{children:"Tricentis Mobile Agent was not found. Install the agent to record and play local mobile tests."}),(0,i.jsx)("a",{href:g.commonConstants.documentationUrls.TESTIM_MOBILE_AGENT,rel:"noreferrer",target:"_blank",children:(0,i.jsx)("span",{className:n.default.learnMoreLink,children:"Learn more"})})]})]});t.SetupMobileTest=(0,u.observer)((({closeModal:e})=>{const t=(0,d.useDependencyInjector)(l.SetupMobileTestStore);(0,c.useEffect)((()=>{if(t){t.deviceStatusErrorMessage=null;t.closeModal=e}}),[e,t]);const[{title:s,subTitle:u},m]=[t.titles,t.selectedComponent===f.SetupMobileTestState.SELECT_APP||t.skip==="app"?"Done":"Next"];const g=o.useCallback((()=>{t.changeDevicesFilterValue("");t.changeAppsFilterValue("");t.discardFile();e()}),[e,t]);return(0,i.jsx)(r.BaseModal,{closeModal:g,header:(0,i.jsx)("h3",{children:"Setup your mobile test"}),className:n.default.wrapper,bodyClassName:n.default.body,subHeaderClassName:n.default.errorSubheader,subHeader:v,hideSubHeader:t.agentStatusLoading||t.agentReady,footer:(0,i.jsxs)("div",{children:[t.selectedComponent===f.SetupMobileTestState.SELECT_DEVICE||t.skip==="device"?(0,i.jsx)(a.Cta,{variety:"secondary",onClick:g,children:"Cancel"}):(0,i.jsx)(a.Cta,{variety:"secondary",onClick:t.goToSelectDevice,children:"Back"}),(0,i.jsx)(a.Cta,{onClick:t.nextButtonHandler,disabled:t.nextButtonDisabled,children:m})]}),children:(0,i.jsxs)("div",{className:n.default.componentWrapper,children:[(0,i.jsx)("span",{className:n.default.innerTitle,children:s}),(0,i.jsx)("span",{className:n.default.subInnerTitle,children:u}),(0,i.jsxs)("div",{className:n.default.interactiveComponentWrapper,children:[t.selectedComponent===f.SetupMobileTestState.SELECT_DEVICE&&(0,i.jsx)(h.SelectDevice,{}),t.selectedComponent===f.SetupMobileTestState.SELECT_APP&&(0,i.jsx)(p.SelectApp,{})]}),t.error&&(0,i.jsx)("div",{className:n.default.uploadErrorMessage,children:t.error})]})})}));t.SetupMobileTest.displayName="SetupMobileTest"},function(e,t,s){"use strict";s.r(t);t["default"]={wrapper:"SetupMobileTest_wrapper_1_Uwb_lsZVRlc3Qt",body:"SetupMobileTest_body_38S0Q_lsZVRlc3Qt",componentWrapper:"SetupMobileTest_componentWrapper_1_BvZ_lsZVRlc3Qt",innerTitle:"SetupMobileTest_innerTitle_2u2QQ_lsZVRlc3Qt",subInnerTitle:"SetupMobileTest_subInnerTitle_2z0ex_lsZVRlc3Qt",interactiveComponentWrapper:"SetupMobileTest_interactiveComponentWrapper_2O8DO_lsZVRlc3Qt",footer:"SetupMobileTest_footer_YuYl2_lsZVRlc3Qt",nextButton:"SetupMobileTest_nextButton_1sija_lsZVRlc3Qt",errorSubheader:"SetupMobileTest_errorSubheader_2eCvx_lsZVRlc3Qt",subHeaderStyle:"SetupMobileTest_subHeaderStyle_2PE17_lsZVRlc3Qt",subHeaderInner:"SetupMobileTest_subHeaderInner_CVhyQ_lsZVRlc3Qt",tmaUpgradeIcon:"SetupMobileTest_tmaUpgradeIcon_24UBR_lsZVRlc3Qt",learnMoreLink:"SetupMobileTest_learnMoreLink_2lEwE_lsZVRlc3Qt",uploadErrorMessage:"SetupMobileTest_uploadErrorMessage_u8euj_lsZVRlc3Qt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SelectDevice=t.DeviceOptionRow=void 0;const i=s(4);const o=s(10);const n=s(511);const r=s(6);const a=s(12);const c=s(11);const l=s(83);const u=s(37);const d=s(225);const p=s(82);const h=s(155);const f=s(16);const m=s(52);const g=s(226);const v=s(14);const S=({deviceName:e,deviceType:t,osVersion:s,isVirtual:r,isSelected:a,handleClick:c,from:l})=>(0,i.jsxs)("div",{className:(0,o.default)(n.default.deviceRowWrapper,a&&n.default.selectedDevice),onClick:a?undefined:c,children:[(0,i.jsx)("div",{className:n.default.deviceRowImageWrapper,children:(0,i.jsx)(f.Icon,{className:n.default.deviceRowImage,icon:r?"virtual-device":"physical-device"})}),(0,i.jsxs)("div",{className:n.default.deviceDetails,children:[(0,i.jsx)(m.Tooltip,{value:e,direction:"bottom",delay:200,children:(0,i.jsx)("div",{className:n.default.deviceName,children:l?`${e} (${l})`:e})}),(0,i.jsxs)("div",{className:n.default.osVersion,children:[t," ",s||""]})]})]});t.DeviceOptionRow=S;t.DeviceOptionRow.displayName="DeviceOptionRow";const y=(0,a.observer)((()=>{var e;const s=(0,c.useDependencyInjector)(p.SetupMobileTestStore);const o=(0,c.useDependencyInjector)(v.FeatureFlagsService);if(((e=s.deviceStatusState)===null||e===void 0?void 0:e.state)==="pending"){return(0,i.jsx)(u.Loader,{})}if((0,r.isEmpty)(s.selectDeviceOptions)&&(0,r.isEmpty)(s.devicesFilterValue)){return(0,i.jsx)("div",{className:n.default.noDevices,children:(0,i.jsx)(d.DevicesEmptyState,{})})}const a=e=>{s.changeDevicesFilterValue(e.currentTarget.value)};return(0,i.jsxs)("div",{className:n.default.deviceOptions,children:[(0,i.jsx)("div",{className:n.default.searchInput,children:(0,i.jsx)(h.SearchInput,{value:s.devicesFilterValue,changeHandler:a})}),s.selectDeviceOptions.map((e=>{var n;return(0,i.jsx)(t.DeviceOptionRow,{deviceName:e.name,deviceType:e.deviceType,isVirtual:e.virtual,osVersion:e.osVersion,from:o.flags.enableTvcDeviceRecording.isEnabled()?e.from:undefined,isSelected:e.udid===((n=s.selectedDevice)===null||n===void 0?void 0:n.udid),handleClick:()=>s.selectDevice(e)},e.udid)}))]})}));y.displayName="SelectDeviceOptions";const b=(0,a.observer)((()=>{const e=(0,c.useDependencyInjector)(p.SetupMobileTestStore);const t=[{text:"PHYSICAL DEVICES",icon:"physical-device",isSelected:!e.shouldShowVirtualDevices,handleClick:e.showPhysicalDevices},{text:"VIRTUAL DEVICES",icon:"virtual-device",isSelected:e.shouldShowVirtualDevices,handleClick:e.showVirtualDevices}];return(0,i.jsx)(g.SelectCategory,{categories:t})}));b.displayName="SelectDevicesType";const _=({message:e,docUrl:t})=>(0,i.jsxs)("div",{className:n.default.deviceStatusErrorMessage,children:[e," ",t&&(0,i.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:"Learn more"})]});_.displayName="DeviceReadyErrorHandler";t.SelectDevice=(0,a.observer)((()=>{const e=(0,c.useDependencyInjector)(l.MobileAgentService);const t=(0,c.useDependencyInjector)(p.SetupMobileTestStore);return e.devices.case({pending:()=>(0,i.jsx)(u.Loader,{}),rejected:()=>(0,i.jsx)(i.Fragment,{children:" "}),fulfilled:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:n.default.selectDeviceWrapper,children:[(0,i.jsx)(b,{}),(0,i.jsx)(y,{})]}),t.deviceStatusErrorMessage&&(0,i.jsx)(_,{...t.deviceStatusErrorMessage})]})})}));t.SelectDevice.displayName="SelectDevice"},function(e,t,s){"use strict";s.r(t);t["default"]={selectDeviceWrapper:"SelectDevice_selectDeviceWrapper_2qF-Z_REZXZpY2Ut",noDevices:"SelectDevice_noDevices_2mqcx_REZXZpY2Ut",deviceOptions:"SelectDevice_deviceOptions_wj6MB_REZXZpY2Ut",searchInput:"SelectDevice_searchInput_2D_rO_REZXZpY2Ut",deviceRowWrapper:"SelectDevice_deviceRowWrapper_1gSgc_REZXZpY2Ut",selectedDevice:"SelectDevice_selectedDevice_hXxn1_REZXZpY2Ut",deviceDetails:"SelectDevice_deviceDetails_5Y2kB_REZXZpY2Ut",deviceName:"SelectDevice_deviceName_1YVR8_REZXZpY2Ut",osVersion:"SelectDevice_osVersion_2FdHH_REZXZpY2Ut",deviceRowImageWrapper:"SelectDevice_deviceRowImageWrapper_1ScVL_REZXZpY2Ut",deviceRowImage:"SelectDevice_deviceRowImage_1pG4i_REZXZpY2Ut",deviceStatusErrorMessage:"SelectDevice_deviceStatusErrorMessage_2wKfL_REZXZpY2Ut"}},function(e,t,s){"use strict";s.r(t);t["default"]={toastWrapper:"Toast_toastWrapper_3WhJp_MtVG9hc3Qt",bottomRight:"Toast_bottomRight_BeD5L_MtVG9hc3Qt",toast:"Toast_toast_bSaii_MtVG9hc3Qt",enter:"Toast_enter_38jsP_MtVG9hc3Qt",leave:"Toast_leave_1xFhF_MtVG9hc3Qt",hasIcon:"Toast_hasIcon_2ccNc_MtVG9hc3Qt",close:"Toast_close_22n9D_MtVG9hc3Qt",icon:"Toast_icon_2u6mz_MtVG9hc3Qt",primary:"Toast_primary_1YVD6_MtVG9hc3Qt",error:"Toast_error_1yGX2_MtVG9hc3Qt",warning:"Toast_warning_1_FD2_MtVG9hc3Qt",success:"Toast_success_3CTKL_MtVG9hc3Qt",iconColorWhite:"Toast_iconColorWhite_3bwtZ_MtVG9hc3Qt",iconColorBlack:"Toast_iconColorBlack_GgS4E_MtVG9hc3Qt",body:"Toast_body_1NfLQ_MtVG9hc3Qt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(153),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(515),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HeaderRoundBtn=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(0);const a=s(52);const c=s(516);t.HeaderRoundBtn=(0,r.forwardRef)((({buttonVariety:e,selected:t,tooltipValue:s,children:n,onClick:r,isDisabled:l,shortcutButtons:u},d)=>{const p=Array.isArray(u)?a.ShortcutTooltip:a.Tooltip;return(0,i.jsx)(p,{value:s,shortcutButtons:u,delay:1e3,direction:"bottom",children:(0,i.jsx)("button",{ref:d,onClick:r,className:(0,o.default)(c.default.button,c.default[e!==null&&e!==void 0?e:"gray"],{[c.default.selected]:t}),disabled:l,children:n})})}));t.HeaderRoundBtn.displayName="HeaderRoundBtn"},function(e,t,s){"use strict";s.r(t);t["default"]={button:"HeaderRoundBtn_button_1BU_0_91bmRCdG4t",black:"HeaderRoundBtn_black_Tr7Rf_91bmRCdG4t",selected:"HeaderRoundBtn_selected_30RuE_91bmRCdG4t",gray:"HeaderRoundBtn_gray_32GLz_91bmRCdG4t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileAgentIndicatorModal=void 0;const i=s(4);const o=s(10);const n=s(123);const r=s(50);const a=s(153);const c=s(83);const l=s(11);const u=s(12);const d=s(518);const p=s(530);t.MobileAgentIndicatorModal=(0,u.observer)((({elementRef:e,agentStatus:t,connectedDevices:s,closeModal:u})=>{const h=(0,l.useDependencyInjector)(c.MobileAgentService);const f=(0,l.useDependencyInjector)(p.AppBannerService);const m=()=>{if(t===a.MobileAgentStatuses.INACTIVE){if(h.isConnectingToSocket){return(0,i.jsx)(d.ConnectingAgentIndication,{})}return(0,i.jsx)(d.InactiveAgentIndication,{})}return(0,i.jsx)(d.ActiveAgentIndication,{connectedDevices:s,agentStatus:t,closeModal:u})};return(0,r.createPortal)((0,i.jsx)("div",{ref:e,className:(0,o.default)(n.default.mobileAgentIndicatorModalWrapper,n.default[t.toLowerCase()],f.bannerMessageDetails.type!=="none"&&n.default.adjustToBanner),children:m()}),document.body)}));t.MobileAgentIndicatorModal.displayName="MobileAgentIndicatorModal"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConnectingAgentIndication=t.ActiveAgentIndication=t.InactiveAgentIndication=void 0;const i=s(4);const o=s(10);const n=s(123);const r=s(519);const a=s(0);const c=s(12);const l=s(11);const u=s(83);const d=s(101);const p=s(31);const h=s(52);const f=s(526);const m=s(16);const g=s(37);const v=s(529);const S=s(153);const y=s(5);const b=s(21);const _="tricentis-mobile-agent:";const T=({title:e,numberOfDevices:t})=>(0,i.jsxs)("div",{className:n.default.devicesCollapsibleHeader,children:[(0,i.jsx)("div",{children:e}),(0,i.jsx)("div",{children:t})]});T.displayName="CollapsibleHeader";const E=()=>{const e=(0,l.useDependencyInjector)(u.MobileAgentService);const t=(0,l.useDependencyInjector)(b.AnalyticsService);const s=(0,a.useCallback)((()=>{t.track("agent-indication-retry-connection");window.isOurOwnDownload=true;window.location.protocol=_;e.tryConnectingToSocket();setTimeout((()=>{window.isOurOwnDownload=false}),1)}),[t,e]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:n.default.header,children:"Local agent unavailable"}),(0,i.jsx)("div",{className:n.default.description,children:"To test your mobile app the local agent must be installed and running."}),(0,i.jsx)(f.DownloadDropdown,{outerWrapperClassName:n.default.downloadDropdown,placeholder:"Select OS",options:e.agentDownloadOptions,defaultValue:e.defaultAgentDownloadOS}),(0,i.jsxs)("div",{className:n.default.info,children:[(0,i.jsx)("div",{className:n.default.infoHeader,children:"Already installed an agent?"}),(0,i.jsxs)("div",{className:n.default.infoDescription,children:["Check whether Tricentis Mobile Agent is running. ",(0,i.jsx)("a",{href:y.commonConstants.documentationUrls.TESTIM_MOBILE_AGENT,target:"_blank",rel:"noreferrer noopener",children:"Learn more here."})]})]}),(0,i.jsx)(p.Cta,{onClick:s,children:"RETRY CONNECTING"})]})};t.InactiveAgentIndication=E;t.InactiveAgentIndication.displayName="InactiveAgentIndication";t.ActiveAgentIndication=(0,c.observer)((({connectedDevices:e,closeModal:t,agentStatus:s})=>{const r=(0,l.useDependencyInjector)(u.MobileAgentService);const{virtual:c,physical:p}=e;(0,a.useEffect)((()=>{r.checkForNewerVersion()}),[r]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:n.default.header,children:[(0,i.jsxs)("div",{className:n.default.agentName,children:["Local Agent ",(0,i.jsx)("div",{className:n.default.agentVersion,children:r.currentRunningVersion.replace("v","")})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(h.Tooltip,{value:"Open TMA Console",direction:"left",children:(0,i.jsx)(m.Icon,{className:(0,o.default)(n.default.headerIcon,n.default.agentPortalIcon),icon:"new-tab",onClick:()=>window.open("http://localhost:8585/","_blank")})}),(0,i.jsx)(m.Icon,{className:(0,o.default)(n.default.headerIcon,n.default.closeIcon),icon:"close-thin",onClick:()=>t()})]})]}),(0,i.jsxs)("div",{className:n.default.agentStatus,children:["Agent Status: ",s===S.MobileAgentStatuses.DEVELOPING?"Busy":s]}),(0,i.jsx)("hr",{}),r.devices.state==="pending"?(0,i.jsx)(g.Loader,{marginAuto:true}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:n.default.connectedDevices,children:["CONNECTED DEVICES (",p.length+c.length,")"]}),(0,i.jsx)(d.Collapsible,{headerClassName:n.default.devicesCollapsible,header:(0,i.jsx)(T,{title:"Physical Devices",numberOfDevices:p.length}),children:(0,i.jsx)("div",{className:n.default.devicesCollapsibleContent,children:p.map((e=>(0,i.jsx)(v.ConnectedDeviceRow,{device:e.deviceType,deviceName:e.name,osVersion:e.osVersion},e.name)))})}),(0,i.jsx)(d.Collapsible,{headerClassName:n.default.devicesCollapsible,header:(0,i.jsx)(T,{title:"Virtual Devices",numberOfDevices:c.length}),children:(0,i.jsx)("div",{className:n.default.devicesCollapsibleContent,children:c.map((e=>(0,i.jsx)(v.ConnectedDeviceRow,{device:e.deviceType,virtual:true,deviceName:e.name,osVersion:e.osVersion},e.name)))})}),r.tmaUpgradeAvailable&&(0,i.jsxs)("div",{className:n.default.tmaUpgradeWrapper,children:[(0,i.jsx)(m.Icon,{icon:"mobile-agent-indicator",className:n.default.tmaUpgradeIcon}),(0,i.jsxs)("span",{className:n.default.tmaUpgradeMessage,children:["TMA version ",r.latestRemoteVersion.replace("v","")," available"]}),(0,i.jsx)("span",{className:n.default.tmaUpgradeButton,onClick:r.onDownload,children:"DOWNLOAD"})]})]})]})}));t.ActiveAgentIndication.displayName="ActiveAgentIndication";const I=()=>{const e=(0,l.useDependencyInjector)(u.MobileAgentService);const t=(0,l.useDependencyInjector)(b.AnalyticsService);const s=(0,a.useCallback)((()=>{t.track("agent-indication-cancel-connection");e.stopTryConnectingToSocket()}),[t,e]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{className:n.default.agentImage,src:r.default}),(0,i.jsx)("div",{className:n.default.header,children:"Starting local agent"}),(0,i.jsx)("div",{className:n.default.description,children:"This might take a few minutes."}),(0,i.jsx)(g.Loader,{}),(0,i.jsx)("div",{className:n.default.cancelConnecting,onClick:s,children:"Cancel"})]})};t.ConnectingAgentIndication=I;t.ConnectingAgentIndication.displayName="ConnectingAgentIndication"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"db34288d3c.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CollapsibleHeader=t.Collapsible=void 0;const i=s(4);const o=s(10);const n=s(521);const r=s(0);const a=s(16);const c=s(522);const l=450;const u=1e4;const d=e=>{var t;const s=(0,r.useRef)(null);const[d,p]=(0,r.useState)(false);const[h,f]=(0,r.useState)();const[m,g]=(0,r.useState)();const v=(t=e.maxHeight)!==null&&t!==void 0?t:u;const S=(0,r.useCallback)((()=>{var t,i;if(e.disabled&&!d){return}const o=(t=s.current)===null||t===void 0?void 0:t.scrollHeight;if(d){f(undefined);g(`${o!==null&&o!==void 0?o:0}px`);requestAnimationFrame((()=>g(undefined)))}else{f(`${o?l*(v/o):0}ms`);g(`${v}px`)}p(!d);(i=e.onToggle)===null||i===void 0?void 0:i.call(e,!d)}),[d,v,e]);(0,r.useEffect)((()=>{if(e.autoOpen&&!d){S()}}),[]);(0,r.useEffect)((()=>{if(e.disabled&&d){S()}}),[e.disabled]);(0,r.useEffect)((()=>{if(e.isOpen!==undefined&&e.isOpen!==d){S()}}),[e.isOpen,d,S]);const{resizable:y,children:b,headerClassName:_,headerClassNameOpen:T,subHeaderClassName:E}=e;const I=(0,r.useMemo)((()=>y&&d?(0,i.jsx)("div",{className:n.default.resizableContainer,children:b}):b),[y,d,b]);const C=(0,r.useMemo)((()=>d?T:undefined),[d,T]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:(0,o.default)(n.default.header,_,C,{[n.default.isOpen]:d}),onClick:S,children:[e.header," ",!e.hideArrow&&(0,i.jsx)(a.Icon,{className:(0,o.default)(n.default.icon,e.headerIconClassName),icon:"arrow-down"})]}),e.collapsedSubHeader&&(0,i.jsx)("div",{className:(0,o.default)(n.default.collapsedSubHeader,E),children:e.collapsedSubHeader}),(0,i.jsx)(c.Resizable,{axis:"y",minValue:50,maxValue:600,property:"height",position:"bottom",disable:!e.resizable,className:(0,o.default)(n.default.collapsible,e.className),ref:s,style:{transitionDuration:h,maxHeight:m},children:I})]})};t.Collapsible=d;t.Collapsible.displayName="Collapsible";const p=e=>(0,i.jsx)(t.Collapsible,{...e,headerClassName:(0,o.default)(n.default.collapsibleHeader,e.headerClassName)});t.CollapsibleHeader=p;t.CollapsibleHeader.displayName="CollapsibleHeader"},function(e,t,s){"use strict";s.r(t);t["default"]={collapsedSubHeader:"collapsible_collapsedSubHeader_2nFVQ_Fwc2libGUt",header:"collapsible_header_2D-WY_Fwc2libGUt",icon:"collapsible_icon_23cWi_Fwc2libGUt",isOpen:"collapsible_isOpen_2qlmo_Fwc2libGUt",collapsible:"collapsible_collapsible_QNJdD_Fwc2libGUt",resizableContainer:"collapsible_resizableContainer_1VGGz_Fwc2libGUt",collapsibleHeader:"collapsible_collapsibleHeader_3t8dV_Fwc2libGUt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(523),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Resizable=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(524);const a=s(525);t.Resizable=(0,n.forwardRef)((({children:e,className:t,style:s,handleClassName:c,...l},u)=>{var d;(d=l.position)!==null&&d!==void 0?d:l.position=l.axis==="y"?"top":"left";const{containerRef:p,handleRef:h}=(0,r.useResizer)(l);const f=(0,n.useCallback)((e=>{p.current=e;if(u){u.current=e}}),[u,p]);if(l.disable){return(0,i.jsx)("div",{ref:u,className:t,style:s,children:e})}return(0,i.jsxs)("div",{ref:f,style:s,className:(0,o.default)(a.default.container,t),children:[e,(0,i.jsx)("div",{ref:h,className:(0,o.default)(a.default.handleArea,c,{[a.default.xAxis]:l.axis==="x",[a.default.yAxis]:l.axis==="y",[a.default.bottom]:l.position==="bottom",[a.default.top]:l.position==="top"}),children:(0,i.jsx)("div",{className:a.default.handle})})]})}));t.Resizable.displayName="Resizable"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.useResizer=void 0;const i=s(6);const o=s(0);function n({minValue:e,maxValue:t,currentValue:s,delta:i}){let o=s+i;if(o<e){o=e}else if(o>t){o=t}const n=o-s;return{newValue:o,newDelta:n}}const r=({minValue:e,maxValue:t,disable:s,axis:r,property:a,saveValue:c,position:l})=>{const u=(0,o.useRef)(null);const d=(0,o.useRef)(null);const p=(0,o.useRef)(0);const h=(0,o.useMemo)((()=>{var e;return(e=u.current)===null||e===void 0?void 0:e.style.transition}),[]);const f=(0,o.useMemo)((()=>i.throttle((()=>{const e=u.current;if(!e){return}e.style.transition=h||""}),100)),[u,h]);const m=(0,o.useCallback)((()=>{if(c&&u.current){const{storage:e,key:t}=c;const s=window[`${e}Storage`][t];u.current.style[a]=`${s}px`}}),[c,a]);const g=(0,o.useCallback)((e=>{if(c){const{storage:t,key:s}=c;window[`${t}Storage`][s]=e}}),[c]);(0,o.useLayoutEffect)((()=>{if(s){return undefined}m();const i=s=>{if(!u.current){return}u.current.style.transition="none";const i=p.current-s[r];const o=parseInt(getComputedStyle(u.current,"")[r==="x"?"width":"height"],10);const c=["bottom","right"].includes(l);const{newValue:d,newDelta:h}=n({minValue:e,maxValue:t,currentValue:o,delta:i*(c?-1:1)});p.current-=h*(c?-1:1);u.current.style[a]=`${d}px`;g(d);f()};const o=e=>{p.current=e[r];document.addEventListener("mousemove",i,false)};const c=()=>document.removeEventListener("mousemove",i,false);const h=d.current;h===null||h===void 0?void 0:h.addEventListener("mousedown",o,false);document.addEventListener("mouseup",c,false);const v=()=>{const s=u.current;if(!s){return}const i=parseInt(s.style[a],10);if(i>t||i<e){s.style[a]=""}};v();return()=>{h===null||h===void 0?void 0:h.removeEventListener("mousedown",o,false);document.removeEventListener("mousemove",i,false);document.removeEventListener("mouseup",c,false)}}),[e,t,u,d,f,s,r,a,m,g]);return{containerRef:u,handleRef:d}};t.useResizer=r},function(e,t,s){"use strict";s.r(t);t["default"]={container:"Resizable_container_gsqDp_NpemFibGUt",handleArea:"Resizable_handleArea_3Qes0_NpemFibGUt",xAxis:"Resizable_xAxis_d_oXx_NpemFibGUt",handle:"Resizable_handle_3sLRn_NpemFibGUt",yAxis:"Resizable_yAxis_223kZ_NpemFibGUt",top:"Resizable_top_VHxyk_NpemFibGUt",bottom:"Resizable_bottom_3NleX_NpemFibGUt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(527),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DownloadDropdown=void 0;const i=s(4);const o=s(10);const n=s(528);const r=s(0);const a=s(12);const c=s(20);const l=s(16);const u=s(11);const d=s(22);const p=s(15);const h=s(21);const f=(0,a.observer)((({option:e,onSelected:t})=>{const s=(0,r.useCallback)((()=>t(e)),[e,t]);return(0,i.jsx)("div",{className:n.default.option,onClick:s,children:e.name},e.value)}));f.displayName="DownloadDropdownItem";t.DownloadDropdown=(0,a.observer)((({options:e,placeholder:t,outerWrapperClassName:s,defaultValue:r,analyticsSource:m="indicationModal"})=>{var g;const v=(0,u.useDependencyInjector)(d.TestimServicesApi);const S=(0,u.useDependencyInjector)(p.ProjectsService);const y=(0,u.useDependencyInjector)(h.AnalyticsService);const b=(0,a.useLocalStore)((e=>({_selected:e.defaultValue,_isOpen:false,get selected(){return this._selected},get isOpen(){return this._isOpen},setSelected(e){this._selected=e},toggle(){this._isOpen=!this._isOpen},close(){this._isOpen=false},onSelected(e){this.setSelected(e);this.close()},async onDownload(){if(!this.selected){return}const e=await v.tmaVersions.getLinkForLatestVersionByPlatform(this.selected.value,S.projectId);(0,c.downloadFile)(`TMA-${this.selected.value}-Latest.zip`,e,"application/zip");y.track(`agent-download-${this._selected}`,{source:m})}})),{defaultValue:r});const _=(0,c.useClickOutside)({callback:b.close,activate:b.isOpen});return(0,i.jsxs)("div",{ref:_,className:(0,o.default)(n.default.outerWrapper,s),children:[(0,i.jsxs)("div",{className:n.default.innerWrapper,children:[(0,i.jsxs)("div",{onClick:b.toggle,className:n.default.dropdown,children:[(0,i.jsx)("div",{className:n.default.selectedOption,children:((g=b.selected)===null||g===void 0?void 0:g.name)||t}),(0,i.jsx)("div",{className:(0,o.default)(n.default.caret,{[n.default.isOpen]:b.isOpen}),children:(0,i.jsx)(l.Icon,{icon:"caret-down"})})]}),(0,i.jsx)("div",{onClick:b.onDownload,className:n.default.downloadIconWrapper,children:(0,i.jsx)(l.Icon,{icon:"download",color:"white"})})]}),b.isOpen&&(0,i.jsx)("div",{className:n.default.optionsWrapper,children:e.map((e=>(0,i.jsx)(f,{option:e,onSelected:b.onSelected},e.value)))})]})}));t.DownloadDropdown.displayName="DownloadDropdown"},function(e,t,s){"use strict";s.r(t);t["default"]={outerWrapper:"DownloadDropdown_outerWrapper_rqaco_JvcGRvd24t",innerWrapper:"DownloadDropdown_innerWrapper_2n9uc_JvcGRvd24t",dropdown:"DownloadDropdown_dropdown_3H8S4_JvcGRvd24t",selectedOption:"DownloadDropdown_selectedOption_165_T_JvcGRvd24t",caret:"DownloadDropdown_caret_1Cr02_JvcGRvd24t",isOpen:"DownloadDropdown_isOpen_1GixI_JvcGRvd24t",downloadIconWrapper:"DownloadDropdown_downloadIconWrapper_guFU__JvcGRvd24t",optionsWrapper:"DownloadDropdown_optionsWrapper_2iso0_JvcGRvd24t",option:"DownloadDropdown_option_2PO9s_JvcGRvd24t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConnectedDeviceRow=void 0;const i=s(4);const o=s(123);const n=s(16);const r=s(52);const a=({deviceName:e,device:t,osVersion:s,virtual:a})=>(0,i.jsxs)("div",{className:o.default.connectedDeviceRowWrapper,children:[(0,i.jsx)(n.Icon,{icon:`${t.toLowerCase()}-phone${a?"-virtual":""}`,className:o.default.phoneIcon}),(0,i.jsxs)("div",{children:[(0,i.jsx)(r.Tooltip,{value:e.length>27?e:"",direction:"bottom",delay:200,children:(0,i.jsx)("div",{className:o.default.deviceName,children:e})}),s&&(0,i.jsxs)("div",{className:o.default.osVersion,children:["OS ",s]})]})]});t.ConnectedDeviceRow=a;t.ConnectedDeviceRow.displayName="ConnectedDeviceRow"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p;Object.defineProperty(t,"__esModule",{value:true});t.AppBannerService=void 0;const h=s(98);const f=s(187);const m=s(2);const g=s(9);const v=s(27);const S=s(5);const y=s(55);const b=s(39);const _=s(29);const T=s(26);const E=s(15);const I=s(38);const C=s(20);const D=s(154);const O=s(102);h.extend(f);let A=class e{constructor(e,t,s,i,o,n,r,a){this.authenticationService=e;this.companiesService=t;this.editedTestStore=s;this.gridsService=i;this.premiumFeaturesService=o;this.projectsService=n;this.runsService=r;this.urlState=a}async loadPlan(){const[e,t]=await Promise.all([this.runsService.getUsageDetails(),this.premiumFeaturesService.isUserCountExceedingQuota()]);return{usageDetails:e,isUsersExceeded:t}}get planDetails(){const{companyId:e}=this.companiesService;if(e===S.commonConstants.defaults.FAKE_CODE_COMPANY_ID||!this.authenticationService.isLoggedIn()){return v.fromPromise.resolve({})}return(0,v.fromPromise)(this.loadPlan())}get bannerMessageDetails(){if(this.shouldDisplayOldVersionBanner){return{type:"old-version"}}if(this.planDetails.state!=="fulfilled"){return{type:"none"}}const e=this.quotaMessageDetails;if(e){return{type:"quota",...e}}return{type:"none"}}get quotaMessageDetails(){var e,t;if(this.planDetails.state!=="fulfilled"||!((e=this.planDetails.value)===null||e===void 0?void 0:e.usageDetails)&&!((t=this.planDetails.value)===null||t===void 0?void 0:t.isUsersExceeded)){return undefined}const{isUsersExceeded:s,usageDetails:{executedRuns:i=0,maxAllowedRuns:o=1,isExecutionBlocked:n=false}={}}=this.planDetails.value;const r=i/o;if(r>=1){return{severity:"finalWarning",isExecutionBlocked:n}}if(r>=.9){return{severity:"secondWarning",isExecutionBlocked:n}}if(r>=.8){return{severity:"firstWarning",isExecutionBlocked:n}}if(s){return{severity:"usersExceeded",isExecutionBlocked:n}}return undefined}get shouldDisplayOldVersionBanner(){return(0,C.isInEditor)(this.urlState.pathTemplate)&&(!this.editedTestStore.isLatestVersion||this.editedTestStore.hasSharedStepsViewingOlderRevisions)}get showUsageExampleBanner(){return this.projectsService.isDemo&&!this.urlState.pathTemplate.startsWith("/company/:companyId")}get showTdcTrialSuggestion(){return this.projectsService.isMobile&&!this.gridsService.hasTdcGrid&&!this.companiesService.tdcLicense}get showTdcTrialCountdown(){var e;return this.projectsService.isMobile&&this.gridsService.hasTdcGrid&&Boolean((e=this.companiesService.tdcLicense)===null||e===void 0?void 0:e.isTrial)}get showTdcExpired(){var e;if(!this.projectsService.isMobile||!this.gridsService.hasTdcGrid){return false}const t=(e=this.companiesService.tdcLicense)===null||e===void 0?void 0:e.expireAt;const s=h.utc().isAfter(t);if(!s){return false}const i=h.utc(h()).diff(t,"day");return i<=14}get isBannerDisplayed(){return this.bannerMessageDetails.type!=="none"||this.showUsageExampleBanner}};t.AppBannerService=A;i([m.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"planDetails",null);i([m.computed.struct,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"bannerMessageDetails",null);i([m.computed.struct,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"quotaMessageDetails",null);i([m.computed,o("design:type",Boolean),o("design:paramtypes",[])],A.prototype,"shouldDisplayOldVersionBanner",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"showUsageExampleBanner",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"showTdcTrialSuggestion",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"showTdcTrialCountdown",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"showTdcExpired",null);i([m.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"isBannerDisplayed",null);t.AppBannerService=A=i([(0,g.injectable)(),o("design:paramtypes",[typeof(n=typeof I.AuthenticationService!=="undefined"&&I.AuthenticationService)==="function"?n:Object,typeof(r=typeof b.CompaniesService!=="undefined"&&b.CompaniesService)==="function"?r:Object,typeof(a=typeof _.EditedTestStore!=="undefined"&&_.EditedTestStore)==="function"?a:Object,typeof(c=typeof O.GridsService!=="undefined"&&O.GridsService)==="function"?c:Object,typeof(l=typeof y.PremiumFeaturesService!=="undefined"&&y.PremiumFeaturesService)==="function"?l:Object,typeof(u=typeof E.ProjectsService!=="undefined"&&E.ProjectsService)==="function"?u:Object,typeof(d=typeof D.RunsService!=="undefined"&&D.RunsService)==="function"?d:Object,typeof(p=typeof T.UrlStateService!=="undefined"&&T.UrlStateService)==="function"?p:Object])],A)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.REVISIONABLE_STEP_TYPES=t.MULTI_STEP_SUPPORTED_STEP_TYPES=t.TEXT_VALIDATION_STEP_TYPES=t.STEPS_TO_CLOSE_PROPERTY_PANEL=t.CONFIGURABLE_PREMIUM_STEP_TYPES=t.NON_CONFIGURABLE_PREMIUM_STEP_TYPES=t.APPLITOOLS_STEP_TYPES=t.PREMIUM_STEP_TYPES=t.STEP_TYPES_WITH_GREATER_VISIBILITY_THRESHOLD=t.STEP_TYPES_THAT_DO_NOT_CLOSE_AUT_FRAME=t.IGNORE_AUTO_IMPROVE_STEP_TYPES=t.AUTO_IMPROVE_SHARED_STEP_TYPES=t.API_STEP_TYPES=t.CLI_STEPS=t.FULL_TIMEOUT_STEP_TYPES=t.TYPES_TO_PLAY_WITH_MAX_TOTAL_STEP_TIME=t.IGNORE_FIND_ELEMENT_FOR_STEPS=void 0;t.IGNORE_FIND_ELEMENT_FOR_STEPS=["android-swipe","ios-swipe","android-scroll-to-text","ios-scroll-to-text"];t.TYPES_TO_PLAY_WITH_MAX_TOTAL_STEP_TIME=["user-code","validation-code-step","wait-for-code-step","action-code-step","cli-validation-code-step","cli-wait-for-code-step","cli-action-code-step","cli-validation-download-file","cli-wait-for-download-file","email-validation-step","network-validation-step","salesforce-apex-action","accessibility-validation-shared-step","ios-scroll-to-text","android-scroll-to-text","sfdc-internal-test-step","sfdc-recorded-step","sfdc-step-apex-action","sfdc-step-login","sfdc-step-loginas","sfdc-step-logout","sfdc-step-sobjectcreate","sfdc-step-sobjectdelete","sfdc-step-findrecord","sfdc-step-quickaction","sfdc-step-sobjectvalidate","sfdc-step-launchapp","sfdc-step-wait-for-page-load","sfdc-step-closeconsoletabs","sfdc-step-sobjectedit","sfdc-step-relatedlistaction","sfdc-step-permission-validation","sfdc-step-convert-lead-to-opportunity","sfdc-step-quotelineeditor","sfdc-document-validation"];t.FULL_TIMEOUT_STEP_TYPES=["simple-ui-verification","wait-for-simple-ui-verification","custom-validation","refresh","cli-action-code-step","cli-wait-for-code-step","cli-validation-code-step","cli-validation-download-file","cli-wait-for-download-file","salesforce-apex-action","sfdc-internal-test-step","sfdc-recorded-step","sfdc-step-apex-action","sfdc-step-login","sfdc-step-loginas","sfdc-step-logout","sfdc-step-sobjectcreate","sfdc-step-sobjectdelete","sfdc-step-findrecord","sfdc-step-quickaction","sfdc-step-sobjectvalidate","sfdc-step-launchapp","sfdc-step-wait-for-page-load","sfdc-step-closeconsoletabs","sfdc-step-sobjectedit","sfdc-step-relatedlistaction","sfdc-step-permission-validation","sfdc-step-convert-lead-to-opportunity","sfdc-step-quotelineeditor","sfdc-document-validation"];t.CLI_STEPS=["cli-validation-code-step","cli-wait-for-code-step","cli-action-code-step","cli-validation-download-file","cli-wait-for-download-file"];t.API_STEP_TYPES=["api-validation","api-action"];t.AUTO_IMPROVE_SHARED_STEP_TYPES=["user-code","validation-code-step","wait-for-code-step","action-code-step","email-validation-step","network-validation-step"];t.IGNORE_AUTO_IMPROVE_STEP_TYPES=["negative-element-validation","wait-for-negative-element-validation"];t.STEP_TYPES_THAT_DO_NOT_CLOSE_AUT_FRAME=["navigation","wheel","scroll","resize-window"];t.STEP_TYPES_WITH_GREATER_VISIBILITY_THRESHOLD=["negative-element-validation","wait-for-negative-element-validation"];t.PREMIUM_STEP_TYPES=["api-action","api-validation","cli-validation-code-step","cli-wait-for-code-step","cli-action-code-step","cli-wait-for-download-file","cli-validation-download-file","accessibility-validation-shared-step","accessibility-validation-step","simple-ui-verification","wait-for-simple-ui-verification","email-validation-step","email-generator","network-validation-step"];t.APPLITOOLS_STEP_TYPES=["simple-ui-verification","wait-for-simple-ui-verification"];t.NON_CONFIGURABLE_PREMIUM_STEP_TYPES=["api-action","api-validation"];t.CONFIGURABLE_PREMIUM_STEP_TYPES=["simple-ui-verification","wait-for-simple-ui-verification"];t.STEPS_TO_CLOSE_PROPERTY_PANEL=["api-action","api-validation","scenario"];t.TEXT_VALIDATION_STEP_TYPES=["extract-text","text-validation","wait-for-text-validation"];t.MULTI_STEP_SUPPORTED_STEP_TYPES=["hover","text-validation","wait-for-text-validation","simple-ui-verification","wait-for-simple-ui-verification","element-validation","wait-for-element-validation","wait-for-negative-element-validation","extract-text","accessibility-validation-step","negative-element-validation","checkbox-validation","css-prop-validation","html-attr-validation"];t.REVISIONABLE_STEP_TYPES=["scenario","setup","shared-step-instance"]},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.SocketDataAggregator=void 0;const n=s(6);const r=s(2);class a{constructor(e,t){this.dataTransformer=t;this.queue=[];this.hasInitialData=false;this.data=[];this.emitAggregatedData=()=>{e===null||e===void 0?void 0:e(this.data,this.hasMorePages)}}get isDataInitialized(){return this.hasInitialData}get value(){return this.data}emptyQueue(){this.queue=[]}isValidResponse(e){return!!e&&!!e.operationType&&!!e.data}isInitialData(e){return e.operationType==="initialize"}process(e){var t;if(!this.isValidResponse(e)){return undefined}if(this.isInitialData(e)){const{docs:s,hasMorePages:i}=(t=e.data)!==null&&t!==void 0?t:{};s===null||s===void 0?void 0:s.forEach((e=>{var t;return(t=this.dataTransformer)===null||t===void 0?void 0:t.call(this,e)}));this.data=s||[];this.hasInitialData=true;this.hasMorePages=i;return this.playAndEmitAggregatedData()}this.insertDeltaToQueue(e);if(this.isDataInitialized){return this.playAndEmitAggregatedData()}return undefined}playAndEmitAggregatedData(){const e=this.playQueue();this.emptyQueue();this.emitAggregatedData();return e}getDeltaTimestamp(e){if(!e.updated_at){return undefined}return new Date(e.updated_at).getTime()}getQueueTimestamps(){return this.queue.map((e=>this.getDeltaTimestamp(e.data)))}insertDeltaToQueue(e){const t=this.getDeltaTimestamp(e.data);const s=n.sortedIndex(this.getQueueTimestamps(),t);this.insertToCollection(e,this.queue,s)}insertToCollection(e,t,s){t.splice(s,0,e)}getInsertionIndex(e){const t=e.data.startTime;return n.sortedIndexBy(this.data.map((e=>e.startTime)),t,(e=>-e))}updateOperation(e,t){var s;const i=Object.assign(e,t.data);(s=this.dataTransformer)===null||s===void 0?void 0:s.call(this,i)}findEntry(e){return this.data.find((t=>t.id===e.id))}playQueue(){return this.queue.map((e=>{var t;if(e.operationType==="insert"){if(this.findEntry(e.data)){return{reason:"duplicate",response:e}}const s=this.getInsertionIndex(e);if(s>this.data.length){return{reason:"outdated",response:e}}(t=this.dataTransformer)===null||t===void 0?void 0:t.call(this,e.data);this.insertToCollection(e.data,this.data,s);return undefined}if(e.operationType==="update"){const t=this.data.find((({id:t})=>t===e.data.id));if(!t){return{reason:"insertNotFound",response:e}}this.updateOperation(t,e)}return undefined})).filter(Boolean)}}t.SocketDataAggregator=a;i([r.observable,o("design:type",Object)],a.prototype,"hasInitialData",void 0);i([r.observable,o("design:type",Array)],a.prototype,"data",void 0);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],a.prototype,"isDataInitialized",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],a.prototype,"value",null);i([r.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],a.prototype,"process",null);i([r.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],a.prototype,"playQueue",null)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r;Object.defineProperty(t,"__esModule",{value:true});t.RealDataSocket=void 0;const a=s(9);const c=s(6);const l=s(8);const u=s(7);const d=s(43);const p=s(5);const h=s(14);const f=s(124);const m=s(125);const g=u.Logger.getLogger("real-data-socket");const{socketEventTypes:v}=p.commonConstants;const S={runResult:v.RUN_RESULT_UPDATED,testResult:v.TEST_RESULT_UPDATED};const y={runResult:v.RUN_RESULT_CREATED,testResult:v.TEST_RESULT_CREATED};let b=class e{constructor(e,t){this.featureFlagsService=e;this.socketService=t;this.alreadyTriedConnectingOnceToSocket=false;if(!this.featureFlagsService.flags.useNewWS.isEnabled()){this.baseSocket=new m.BaseSocketService}}get isLive(){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return Boolean(this.baseSocket._socket)&&!this.baseSocket._socket.disconnected}return this.socketService.isConnected}get currentProjectId(){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.baseSocket.projectId}return this.socketService.currentProjectId}get isSubscribedToChannel(){return!!this.store}_initSocket(e){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){if(this.isLive){this.closeSocket()}this.baseSocket.init(e,"/real-data",l.utils.getServicesUrl())}return this.addHandlers()}async getInitialDataViaRest(e,t,s,i){var o,n;const r=i?{...t,fullDocument:true}:t;this.addFilter(e,r,s,i);try{const s=await d.testimServicesSingleton.realData.getDataV2(e,r);if(!s.success){g.error("failed to get init data, success=false");return}if(((o=this.store)===null||o===void 0?void 0:o.channel)!==e||((n=this.store)===null||n===void 0?void 0:n.query)!==t){return}this.process({data:s.data,operationType:"initialize"})}catch(e){g.error("error to get init data",e)}}addHandlers(){if(this.featureFlagsService.flags.useNewWS.isEnabled()){this.socketService.on("disconnect",(()=>{this.socketService.once("connect",(()=>this.recover()))}));return new Promise((e=>{this.socketService.once("connect",e)}))}this.baseSocket._socket.on("disconnect",(()=>{this.baseSocket._socket.once("connect",(()=>this.recover()))}));return Promise.resolve()}closeSocket(){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){this.stopListen();this.baseSocket.closeSocket()}}stopListen(){if(!this.isSubscribedToChannel){return}const e=this.store.channel;this.store=undefined;if(!this.featureFlagsService.flags.useNewWS.isEnabled()){this.emit(`${e}:listen:stop`);this.off(`${e}:changes`);return}const t=y[e];const s=S[e];this.socketService.removeFilter("real-data",[t,s])}listenToChanges(e,t){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){this.on(`${e}:changes`,(t=>{const s=this.process(t);if(!c.isEmpty(s)){this.getMissingData(e,s)}}));return undefined}const s=y[e];const i=S[e];this.socketService.listenTo("real-data",[i],(()=>true),(e=>{const s=t?"insert":"update";this.process({operationType:s,data:e})}));this.socketService.listenTo("real-data",[s],(()=>true),(e=>{this.process({operationType:"insert",data:e})}));return undefined}async getMissingData(e,t){var s,i,o;const n=c.chain(t).filter((({reason:e})=>e==="insertNotFound")).map((({response:e})=>e.data.id)).filter(Boolean).value();try{const{query:t}=(s=this.store)!==null&&s!==void 0?s:{};const r={...t};if(n.length){Object.assign(r,{_id:n})}const a=await d.testimServicesSingleton.realData.getDataV2(e,r);if(!a.success){g.error(`failed to get missing data, success=${a.success}`);return}if(((i=this.store)===null||i===void 0?void 0:i.channel)!==e||((o=this.store)===null||o===void 0?void 0:o.query)!==t){return}a.data.docs.forEach((e=>{this.process({data:e,operationType:"insert"})}))}catch(e){g.error("error while getting missing data",{err:e})}}addFilter(e,t,s,i){if(!this.featureFlagsService.flags.useNewWS.isEnabled()){return this.emit(`${e}:listen`,{query:t})}const o=y[e];const n=S[e];return this.socketService.addFilter("real-data",s,[o,n],i)}switchChannel(e){const{channel:t,projectId:s,returnFullDocument:i,eventQuery:o,query:n,aggregator:r}=e;if(!t||!this.aggregator&&!r){return}if(!this.isLive&&!this.alreadyTriedConnectingOnceToSocket||!!s&&this.currentProjectId!==s){this.closeSocket();delete this.store;this._initSocket(s).then((()=>{this.alreadyTriedConnectingOnceToSocket=true;this.switchChannel(e)}));return}if(r){this.aggregator=r}if(this.isSubscribedToChannel){this.stopListen()}this.store={eventQuery:o,returnFullDocument:i,query:n,channel:t,aggregator:this.aggregator,projectId:s};this.listenToChanges(t,i);this.getInitialDataViaRest(t,n,o,i)}recover(){if(this.store){this.switchChannel(this.store)}}process(e){var t;return(t=this.aggregator)===null||t===void 0?void 0:t.process(e)}on(e,t){this.baseSocket._socket.on(e,t)}off(e,t){this.baseSocket._socket.off(e,t)}emit(e,t){this.baseSocket._socket.emit(e,t)}};t.RealDataSocket=b;t.RealDataSocket=b=i([(0,a.injectable)(),o("design:paramtypes",[typeof(n=typeof h.FeatureFlagsService!=="undefined"&&h.FeatureFlagsService)==="function"?n:Object,typeof(r=typeof f.UISocketService!=="undefined"&&f.UISocketService)==="function"?r:Object])],b)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=s(8);const o=s(7);const n=s(33);const r=s(5);const a=o.Logger.getLogger("socket-service");const c=1e3;class l extends n.EventEmitter{constructor(e,t){super();this.testimServices=e;this.authenticationManager=t;this.isConnected=false;this.clientId=i.utils.guid();this.ws=null;this.url=null;this.filterMap={};this.listeners=new Map}doReconnect(e,t,s){a.log("test result websocket re-connect");const i=true;setTimeout((()=>this.init(e,s,i)),c)}formatUrl(e){if(e===null||e===void 0?void 0:e.startsWith("http://")){return e.replace("http://","ws://")}if(e===null||e===void 0?void 0:e.startsWith("https://")){return e.replace("https://","wss://")}return e}parseEvent(e){try{return JSON.parse(e.data)}catch(e){a.error("failed to parse",e);return undefined}}async init(e,t="wss://services.testim.io/ws",s=false){const i=this.formatUrl(t);const o=await this.testimServices.auth.getToken();const n=new URLSearchParams;n.append("projectId",e);n.append("clientId",this.clientId);n.append("token",o);this.url=`${i}?${n}`;this.ws=new WebSocket(this.url);this.ws.onopen=()=>{a.log("websocket opened");this.isConnected=true;if(s){this.trigger(r.socketEventTypes.RECONNECT);this.reSendAllExistingFilters();return}this.trigger(r.socketEventTypes.CONNECT)};this.ws.onclose=t=>{if(!this.isConnected){return}const{code:s}=t;a.log("websocket closed",t);this.isConnected=false;this.trigger(r.socketEventTypes.DISCONNECT);if(s===401){a.log("invalid token");this.authenticationManager.logout();return}if(!this.ws||this.ws.readyState===WebSocket.CLOSED){this.doReconnect(e,o,i)}};this.ws.onerror=e=>{a.log("websocket error",e,this.clientId,this.filterMap);this.trigger(r.socketEventTypes.ERROR)};this.ws.onmessage=e=>{const t=this.parseEvent(e);if((t===null||t===void 0?void 0:t.type)&&t.data){this.trigger(t.type,t.data)}else{a.warn("invalid event structure",t)}}}async initAndWaitForConnect(e,t){return await new Promise((async s=>{this.once([r.socketEventTypes.CONNECT],s);await this.init(e,t)}))}disconnect(){var e;this.isConnected=false;(e=this.ws)===null||e===void 0?void 0:e.close()}sendMessage(e){if(!this.ws){a.warn("attempted to send message but socket was not connected",e);return}try{this.ws.send(JSON.stringify(e))}catch(e){a.error("failed to stringify message for sending or sending it",e)}}reSendAllExistingFilters(){Object.keys(this.filterMap).forEach((e=>{const t=this.filterMap[e];this.sendMessage({type:"add-filter",filter:t})}))}listenOnce(e,t,s){const i=o=>{if(t(o)){s(o);this.off(e,i)}};this.on(e,i)}addFilter(e,t,s,o=false){const n="add-filter";return new Promise((r=>{const a=i.utils.guid();const c={query:t,id:a,type:s,fullDocument:o};this.listenOnce(`${n}:done`,(e=>e.id===a),r);this.sendMessage({type:n,filter:c});this.filterMap[e]=c}))}removeFilter(e,t){const s="remove-filter";return new Promise((i=>{const o=this.filterMap[e];if(!o){i();return}delete this.filterMap[e];this.removeListeners(e,t);const{id:n}=o;this.listenOnce(`${s}:done`,(e=>e.id===n),i);this.sendMessage({type:s,filter:o})}))}removeListeners(e,t){if(this.listeners.size===0){return}t.forEach((t=>{const s=`${e}:${t}`;const i=this.listeners.get(s);if(i){this.listeners.delete(s);i.forEach((e=>this.off(t,e)))}}))}listenTo(e,t,s,i){function o(e){if(s(e)){i(e)}}t.forEach((t=>{const s=`${e}:${t}`;if(!this.listeners.has(s)){this.listeners.set(s,[])}const i=o.bind(this);const n=this.listeners.get(s);if(n){n.push(i);this.on(t,i)}}))}}t.default=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AppsEmptyState=t.DevicesEmptyState=void 0;const i=s(4);const o=s(536);const n=s(537);const r=s(538);const a=s(0);const c=({text:e,image:t})=>{const s=t==="no-apps"?n.default:r.default;return(0,i.jsxs)("div",{className:o.default.emptyState,children:[(0,i.jsx)("img",{src:s}),(0,i.jsx)("span",{className:o.default.footerText,children:e})]})};c.displayName="EmptyState";const l=()=>(0,i.jsx)(c,{text:"There are no devices to show.",image:"no-devices"});t.DevicesEmptyState=l;t.DevicesEmptyState.displayName="DevicesEmptyState";const u=()=>(0,i.jsx)(c,{text:"No apps were found. Please upload an app first.",image:"no-apps"});t.AppsEmptyState=u;t.AppsEmptyState.displayName="AppsEmptyState"},function(e,t,s){"use strict";s.r(t);t["default"]={emptyState:"EmptyState_emptyState_1vDqo_R5U3RhdGUt",footerText:"EmptyState_footerText_3AuQK_R5U3RhdGUt"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"37cf7a74b3.png"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"49ebb357aa.png"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SearchInput=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(12);const a=s(540);const c=s(16);const l=s(32);t.SearchInput=(0,r.observer)((({value:e,changeHandler:t,searchClassName:s})=>(0,i.jsxs)("div",{className:a.default.searchWrapper,children:[(0,i.jsx)(c.Icon,{icon:"search-thin",className:a.default.icon}),(0,i.jsx)(l.Textbox,{className:(0,n.default)(a.default.search,s),value:e,placeholder:"Search",onChange:t})]})));t.SearchInput.displayName="SearchInput"},function(e,t,s){"use strict";s.r(t);t["default"]={searchWrapper:"SearchInput_searchWrapper_CBpvs_NoSW5wdXQt",search:"SearchInput_search_19L6q_NoSW5wdXQt",icon:"SearchInput_icon_1FDS__NoSW5wdXQt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SelectCategory=void 0;const i=s(4);const o=s(12);const n=s(10);const r=s(542);const a=s(16);t.SelectCategory=(0,o.observer)((({categories:e})=>(0,i.jsx)("div",{className:r.default.categories,children:e.map((({text:e,icon:t,isSelected:s,handleClick:o},c)=>(0,i.jsxs)("div",{onClick:!s?o:undefined,className:(0,n.default)(r.default.category,s&&r.default.isSelected),children:[(0,i.jsxs)("div",{className:r.default.details,children:[(0,i.jsx)(a.Icon,{className:r.default.icon,icon:t}),e]}),(0,i.jsx)(a.Icon,{className:r.default.arrow,icon:"play"})]},c)))})));t.SelectCategory.displayName="SelectCategory"},function(e,t,s){"use strict";s.r(t);t["default"]={categories:"SelectCategory_categories_18mxA_F0ZWdvcnkt",category:"SelectCategory_category_23eFa_F0ZWdvcnkt",isSelected:"SelectCategory_isSelected_13R3C_F0ZWdvcnkt",icon:"SelectCategory_icon_1Ddpq_F0ZWdvcnkt",details:"SelectCategory_details_2VGfn_F0ZWdvcnkt",arrow:"SelectCategory_arrow_2y9c-_F0ZWdvcnkt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.useSortedColumns=t.SORT_DIRECTIONS=void 0;const i=s(544);var o;(function(e){e["ASC"]="asc";e["DESC"]="desc"})(o||(t.SORT_DIRECTIONS=o={}));function n(){const[e,t]=(0,i.useUrlParam)("sort");const[s,n]=(0,i.useUrlParam)("sortDirection");function r(){switch(s){case o.DESC:return o.DESC;case o.ASC:return o.ASC;default:return undefined}}function a(i){if(i===e){n(s===o.ASC?o.DESC:o.ASC)}else{n(o.ASC);t(i)}}return{sortedColumnName:e,sortDirection:r(),handleSort:a}}t.useSortedColumns=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.useUrlParamNumber=t.useUrlParamArray=t.parseUrlParamArray=t.useUrlParam=void 0;const i=s(0);const o=s(11);const n=s(26);function r(e){var t;const s=(0,o.useDependencyInjector)(n.UrlStateService);const r=(t=s.params[e])!==null&&t!==void 0?t:"";const a=(0,i.useCallback)(((t,i={})=>{s.updateParams({[e]:t,...i})}),[e,s]);return[r,a]}t.useUrlParam=r;function a(e){return e.split(";").filter(Boolean)}t.parseUrlParamArray=a;function c(e){var t;const s=(0,o.useDependencyInjector)(n.UrlStateService);const r=(t=s.params[e])!==null&&t!==void 0?t:"";const c=(0,i.useMemo)((()=>a(r)),[r]);const l=(0,i.useCallback)(((t,i={})=>{s.updateParams({[e]:t,...i})}),[e,s]);return[c,l]}t.useUrlParamArray=c;function l(e){var t;const s=(0,o.useDependencyInjector)(n.UrlStateService);const r=(t=s.params[e])!==null&&t!==void 0?t:"";const a=(0,i.useMemo)((()=>{if(!r){return undefined}const e=Number(r);if(Number.isNaN(e)){return undefined}return e}),[r]);const c=(0,i.useCallback)(((t,i={})=>{const o=t===undefined?t:String(t);s.updateParams({[e]:o,...i})}),[e,s]);return[a,c]}t.useUrlParamNumber=l},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(546),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UploadMobileAppModal=void 0;const i=s(4);const o=s(547);const n=s(0);const r=s(12);const a=s(30);const c=s(11);const l=s(103);const u=s(227);t.UploadMobileAppModal=(0,r.observer)((({closeModal:e})=>{const t=(0,c.useDependencyInjector)(l.MobileAppsStore);const s=(0,n.useCallback)((()=>{t.clearUploadError();t.abortFileTransfer();t.discardFile(e)}),[e,t]);return(0,i.jsx)(a.BaseModal,{className:o.default.uploadMobileAppModal,closeModal:s,header:(0,i.jsx)("h3",{children:"Add new app"}),closeOnEscape:true,children:(0,i.jsx)(u.DragAndDropUpload,{uploadedFileType:t.uploadedFileTypes,maxUploadedSize:t.maxUploadedSize,handleUploadFile:e=>t.handleUploadFile(e,s),handleDiscardFile:t.discardButtonClicked,uploadedFile:t.currentUploadedFile,error:t.uploadError,isUploadingFile:t.isUploadingFile,isInSelectAppModal:false})})}));t.UploadMobileAppModal.displayName="UploadMobileApp"},function(e,t,s){"use strict";s.r(t);t["default"]={uploadMobileAppModal:"UploadMobileAppModal_uploadMobileAppModal_3rs8I_JpbGVBcHAt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DragAndDropUpload=void 0;const i=s(4);const o=s(10);const n=s(127);const r=s(549);const a=s(157);const c=s(12);const l=s(8);const u=s(11);const d=s(550);const p=s(551);const h=s(552);const f=s(126);const m=s(21);const g=s(103);const v=s(5);t.DragAndDropUpload=(0,c.observer)((({uploadedFileType:e,maxUploadedSize:t,handleUploadFile:s,handleDiscardFile:S,uploadedFile:y,error:b,isUploadingFile:_,isInSelectAppModal:T,analyticsSource:E="apps-library"})=>{const I=(0,u.useDependencyInjector)(p.FileUploadService);const C=(0,u.useDependencyInjector)(m.AnalyticsService);const D=(0,u.useDependencyInjector)(g.MobileAppsStore);const O=(0,c.useLocalStore)((()=>({isDraggingOver:false,get supportedFileTypesString(){const t=e.filter((e=>e!==v.MOBILE_APP_FILE_TYPES.NATIVE_IOS_SIMULATOR)).join(", .");return`Supported file ${l.utils.pluralize(e.length,"type")} .${t}`},get dragAndDropChooseFileTitle(){if(D.hasReachedMaxMobileAppsUploadLimitForProject){return{title:"You have reached the uploaded apps limit",subTitle:"Delete an existing app from the Mobile Apps library to be able to upload a new one."}}return this.isDraggingOver?{title:"Drop a file here",subTitle:"to upload"}:{title:"Drop a file here or click to upload",subTitle:`${this.supportedFileTypesString}, up to ${t} MB.`}},get dragAndDropChooseFileImage(){if(D.hasReachedMaxMobileAppsUploadLimitForProject){return a.default}return r.default},onDragOver(e){e.preventDefault();if(!this.isDraggingOver){this.isDraggingOver=true}},onDragLeave(e){e.preventDefault();if(this.isDraggingOver){this.isDraggingOver=false}},onDrop(e){e.preventDefault();const t=e.dataTransfer.files[0];this.isDraggingOver=false;if(t){s(t)}},async onClick(){if(D.hasReachedMaxMobileAppsUploadLimitForProject){return}C.track("add-new-app",{source:E});const e=await I.readFileAttributes({},window.document);if(e.length===1){s(e[0])}}})));return(0,i.jsxs)(i.Fragment,{children:[y?(0,i.jsx)(h.DragAndDropWithFileChosen,{onDiscardClick:S,chosenFile:y,fileSize:f.MobileFileUploadService.fileSizeInMb(y),isUploading:_,error:b,isInSelectAppModal:T}):(0,i.jsx)("div",{className:(0,o.default)(D.hasReachedMaxMobileAppsUploadLimitForProject&&n.default.reachedMaxUploadLimit,O.isDraggingOver&&!D.hasReachedMaxMobileAppsUploadLimitForProject&&n.default.isDraggingOver,T?n.default.selectAppChooseFileWrapper:n.default.uploadAppChooseFileWrapper),...!D.hasReachedMaxMobileAppsUploadLimitForProject&&{onDragOver:O.onDragOver,onDragLeave:O.onDragLeave,onDrop:O.onDrop},children:(0,i.jsx)(d.DragAndDropChooseFile,{onClick:O.onClick,title:O.dragAndDropChooseFileTitle.title,subTitle:O.dragAndDropChooseFileTitle.subTitle,image:O.dragAndDropChooseFileImage})}),!T&&b&&(0,i.jsx)("div",{className:n.default.errorMessage,children:b})]})}));t.DragAndDropUpload.displayName="DragAndDropUpload"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"3cb853ff11.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DragAndDropChooseFile=void 0;const i=s(4);const o=s(127);const n=({title:e,subTitle:t,onClick:s,image:n})=>(0,i.jsxs)("div",{className:o.default.chooseFile,onClick:s,children:[(0,i.jsx)("img",{src:n,alt:"Drag and drop"}),(0,i.jsx)("div",{className:o.default.title,children:e}),(0,i.jsx)("div",{className:o.default.subtitle,children:t})]});t.DragAndDropChooseFile=n;t.DragAndDropChooseFile.displayName="DragAndDropChooseFile"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:true});t.FileUploadService=void 0;const o=s(8);const n=s(9);const r="file_upload_srv_input";let a=class e{constructor(){this.readFileAttributes=(e,t)=>{let s;let i;const o=new Promise(((e,t)=>{s=e;i=t}));this.generateNewFileInput(e,t);const n=e=>{this.input.removeEventListener("change",n);const t=this.onInputChangeAttributesOnly(e);if(t.length){s(t)}else{i(new Error("No Files"))}};this.input.addEventListener("change",n);this.input.click();return o}}generateNewFileInput(e,t){var s,i,n;if(this.input){this.input.remove()}const a=t.createElement("input");a.setAttribute("id",`${r}_${o.utils.guid()}`);a.setAttribute("type","file");a.setAttribute("name","file");a.setAttribute("accept",(i=(s=e.accept)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:"");a.setAttribute("testim-link-id",(n=e.linkId)!==null&&n!==void 0?n:"");a.style.display="none";if(e.multiple){a.setAttribute("multiple","multiple")}t.body.appendChild(a);this.input=a}handleFile(e,t){return new Promise(((s,i)=>{const o=new FileReader;o.onload=()=>{const t=o.result;if(t){s({file:e,content:t})}};o.onerror=e=>{i(e)};o.onabort=e=>{i(e)};const n=`readAs${t}`;o[n](e)}))}async onInputChange({target:e},t){const{files:s}=e;if(s){if(s.length===1){return await this.handleFile(s[0],t)}return await Promise.all(Array.from(s).map((e=>this.handleFile(e,t))))}return[]}onInputChangeAttributesOnly({target:e}){const{files:t}=e;return t||[]}async readFile(e,t,s=window.document){let i;let o;let n;this.generateNewFileInput(t,s);try{const t=new Promise(((e,t)=>{o=e;n=t}));i=async t=>{try{const s=await this.onInputChange(t,e);return o(s)}catch(e){return n(e)}};this.input.addEventListener("change",i);this.input.click();return await t}finally{if(i){this.input.removeEventListener("change",i)}}}};t.FileUploadService=a;t.FileUploadService=a=i([(0,n.injectable)()],a)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DragAndDropWithFileChosen=void 0;const i=s(4);const o=s(0);const n=s(6);const r=s(12);const a=s(127);const c=s(228);const l=s(229);const u=s(157);const d=s(230);const p=s(52);const h=s(11);const f=s(126);t.DragAndDropWithFileChosen=(0,r.observer)((({chosenFile:e,fileSize:t,onDiscardClick:s,isUploading:r,error:m,isInSelectAppModal:g})=>{const v=(0,h.useDependencyInjector)(f.MobileFileUploadService);const{title:S,icon:y}=(0,o.useMemo)((()=>{if(m){return{title:"upload error",icon:u.default}}if(r){const e=v.uploadState==="parsing"?"processing uploaded":"uploading";return{title:`${e} file... (${Math.round(v.uploadProgress*100)}%)`,icon:c.default}}return{title:"uploaded",icon:l.default}}),[m,r,v.uploadProgress,v.uploadState]);return(0,i.jsxs)("div",{className:g?a.default.selectAppDragAndDropWithFileChosen:a.default.uploadAppDragAndDropWithFileChosen,children:[(0,i.jsx)("div",{className:a.default.innerTitle,children:S}),(0,i.jsxs)("div",{className:g?undefined:a.default.uploadAppUploadDetails,children:[(0,i.jsxs)("div",{className:g?a.default.selectAppStatusAndFileDetails:a.default.uploadAppStatusAndFileDetails,children:[(0,i.jsx)("img",{className:a.default.statusIcon,src:y}),(0,i.jsxs)("div",{className:a.default.fileDetails,children:[(e===null||e===void 0?void 0:e.name)&&(0,i.jsx)(p.Tooltip,{value:e.name,delay:200,children:(0,i.jsx)("div",{className:a.default.fileName,children:e.name})}),t&&(0,i.jsx)("div",{className:a.default.fileSize,children:`${Math.round(t)} MB`})]})]}),(r||g&&!(0,n.isEmpty)(m))&&(0,i.jsx)(d.DiscardFileAnchor,{onDiscardClick:s})]})]})}));t.DragAndDropWithFileChosen.displayName="DragAndDropWithFileChosen"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(554),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DeleteMobileApp=void 0;const i=s(4);const o=s(0);const n=s(0);const r=s(10);const a=s(45);const c=s(555);const l=s(101);const u=s(81);const d=s(16);const p=({closeModal:e,mobileAppName:t,associatedTests:s})=>{const o=(0,n.useMemo)((()=>(0,i.jsxs)("div",{className:c.default.modalBody,children:[(0,i.jsxs)("div",{className:c.default.explanationText,children:["You are about to delete ",(0,i.jsx)("strong",{children:t}),", used in various of your existing tests. Deleting this application will only be possible after completely removing it from all tests in which it is configured."]}),(0,i.jsx)(l.Collapsible,{header:"Mobile Tests Using Your App",headerClassName:c.default.associatedTestsCollapsible,children:s.map((e=>(0,i.jsxs)("div",{className:c.default.associatedTestRow,children:[(0,i.jsx)(d.Icon,{icon:"file-full",className:c.default.testIcon}),(0,i.jsx)("div",{className:c.default.associatedTestName,children:e.name})]},e.id)))})]})),[s,t]);return(0,i.jsx)(a.MessageModal,{title:"Delete Mobile App",body:o,okText:"DISMISS",variety:"normal",textAlign:"left",closeModal:e,icon:"trash-v4",className:(0,r.default)(c.default.deleteMobileAppModal,u.default.deletionModal)})};t.DeleteMobileApp=p;t.DeleteMobileApp.displayName="DeleteMobileApp"},function(e,t,s){"use strict";s.r(t);t["default"]={deleteMobileAppModal:"DeleteMobileApp_deleteMobileAppModal_1zxjT_JpbGVBcHAt",modalBody:"DeleteMobileApp_modalBody_1-FOP_JpbGVBcHAt",explanationText:"DeleteMobileApp_explanationText_1tgRL_JpbGVBcHAt",associatedTestsCollapsible:"DeleteMobileApp_associatedTestsCollapsible_1ZvsF_JpbGVBcHAt",associatedTestRow:"DeleteMobileApp_associatedTestRow_QmqR9_JpbGVBcHAt",testIcon:"DeleteMobileApp_testIcon_2s6HJ_JpbGVBcHAt",associatedTestName:"DeleteMobileApp_associatedTestName_2u5KG_JpbGVBcHAt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(557),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UploadMobileAppToGrid=void 0;const i=s(4);const o=s(558);const n=s(0);const r=s(12);const a=s(30);const c=s(231);const l=s(31);t.UploadMobileAppToGrid=(0,r.observer)((({closeModal:e})=>{const[t,s]=(0,n.useState)();const r=(0,n.useCallback)((()=>{e({gridId:t===null||t===void 0?void 0:t.value})}),[e,t]);return(0,i.jsx)(a.BaseModal,{className:o.default.uploadMobileAppModal,closeModal:e,header:(0,i.jsx)("h3",{children:"UPLOAD APP TO GRID"}),closeOnEscape:true,footer:(0,i.jsxs)("div",{children:[(0,i.jsx)(l.Cta,{variety:"secondary",onClick:()=>e(),children:"Cancel"}),(0,i.jsx)(l.Cta,{disabled:!t,onClick:r,children:"UPLOAD"})]}),children:(0,i.jsxs)("div",{className:o.default.body,children:[(0,i.jsx)("div",{className:o.default.message,children:"Upload app to your desired grid from the Testim interface. Your upload will run in the background."}),(0,i.jsx)("div",{className:o.default.gridTitle,children:"Select a grid"}),(0,i.jsx)(c.GridListSelector,{hideErrors:true,hideTitle:true,autoSelectFirst:true,wrapperClassName:o.default.dropdownsItem,onGridSelectedByState:s,onGridSelectedByUser:s,selectedGrid:t})]})})}));t.UploadMobileAppToGrid.displayName="UploadMobileAppToGrid"},function(e,t,s){"use strict";s.r(t);t["default"]={uploadMobileAppModal:"UploadMobileAppToGridModal_uploadMobileAppModal_kcw2b_BUb0dyaWQt",body:"UploadMobileAppToGridModal_body_1s1Ql_BUb0dyaWQt",message:"UploadMobileAppToGridModal_message_17idE_BUb0dyaWQt",gridTitle:"UploadMobileAppToGridModal_gridTitle_177o6_BUb0dyaWQt",dropdownsItem:"UploadMobileAppToGridModal_dropdownsItem_Wp_PK_BUb0dyaWQt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GridListSelector=t.mobileGridType=t.NO_GRID_OPTION=void 0;const i=s(4);const o=s(10);const n=s(560);const r=s(0);const a=s(102);const c=s(11);const l=s(40);const u=s(44);const d=s(7);const p=s(20);const h=s(15);const f=s(5);const m=s(561);const g=s(39);const v=d.Logger.getLogger("grid-list-selector");const S="No grid available";t.NO_GRID_OPTION={name:S,value:S};const y="The original grid has been deleted.";t.mobileGridType=[f.gridTypes.GRID_TYPE_BROWSERSTACK,f.gridTypes.GRID_TYPE_HEADSPIN,f.gridTypes.GRID_TYPE_SAUCELABS,f.gridTypes.GRID_TYPE_TESTIM_TDC,f.gridTypes.GRID_TYPE_TESTIM_TVC,f.gridTypes.GRID_TYPE_P_CLOUDY];const b=({grids:e,item:t})=>{const s=e.find((e=>e._id===t.value))||{};return(0,i.jsxs)("span",{className:n.default.gridIconAndName,children:[(0,i.jsx)(m.GridImage,{gridType:s.type})," ",(0,i.jsx)("span",{className:n.default.ellipsis,children:t.name})]})};b.displayName="GridNameWithIcon";const _=({selectedGrid:e,isEditMode:s,wrapperClassName:d,initialGrid:f,error:m,onGridSelectedByState:_,onGridSelectedByUser:T,openGridsPage:E,onLoadingComplete:I,children:C,allowSearch:D,hideErrors:O,manageGridsUrl:A,autoSelectFirst:j,hideTitle:w,hideTopManageGridLink:R,disabled:P,customTitle:x,errorClassName:M,showGridIcon:N,containerClassName:F})=>{const L=(0,c.useDependencyInjector)(a.GridsService);const k=(0,c.useDependencyInjector)(h.ProjectsService);const B=(0,c.useDependencyInjector)(g.CompaniesService);const[U,G]=(0,r.useState)([]);const[V,H]=(0,r.useState)([]);(0,p.useAsyncEffect)((async i=>{try{let o=await L.getCompanyGrids();const n=B.tvcLicense;if(k.isMobile){const e=t.mobileGridType.filter((e=>L.isGridEnabled(e,n)));o=o.filter((t=>e.includes(t.type)))}else{o=o.filter((e=>L.isGridEnabled(e.type,n)))}H(o);if(!i()){return undefined}const r=o.map((({_id:e,name:t})=>({value:e,name:t})));I===null||I===void 0?void 0:I();if(r.length===0){G([t.NO_GRID_OPTION]);return _(t.NO_GRID_OPTION,S)}G(r);if(j){_(r[0])}if(e){return undefined}if(!s){if(L.preferredGrid){const e=r.find((({value:e})=>{var t;return e===((t=L.preferredGrid)===null||t===void 0?void 0:t._id)}));if(e){return _(e)}}if(r.length===1){return _(r[0])}}if(f){const e=r.find((({value:e})=>e===f));return _(e,e?undefined:y)}return undefined}catch(e){return v.error("failed to get grids",{err:e})}}),[]);const $=(0,r.useMemo)((()=>U.length===1&&U[0]===t.NO_GRID_OPTION),[U]);const W=(0,r.useMemo)((()=>s&&!e&&f!==""&&U.every((({value:e})=>e!==f))),[U,s,e,f]);return(0,i.jsxs)("div",{className:d,children:[C,(0,i.jsxs)(u.FieldLabel,{error:O?undefined:m,children:[(0,i.jsxs)("span",{className:n.default.gridLabel,children:[!w&&(0,i.jsx)("span",{children:x||"Grid"}),A&&!R&&(0,i.jsx)("a",{href:A,children:"Manage grids"})]}),(0,i.jsx)(l.Dropdown,{appendToBody:true,containerClassName:F,searchable:Boolean(D),disabled:$||P,value:e,placeholder:"Select grid",options:U,inputProps:{className:$||W?n.default.gridErrorInput:undefined},onChange:T,SelectedItemRenderComponent:({item:e})=>N?(0,i.jsx)(b,{item:e,grids:V}):(0,i.jsx)(i.Fragment,{children:e.name}),renderItem:({item:e})=>N?(0,i.jsx)(b,{item:e,grids:V}):(0,i.jsx)(i.Fragment,{children:e.name})}),!O&&(0,i.jsxs)(i.Fragment,{children:[$&&(0,i.jsxs)("span",{className:(0,o.default)(n.default.gridErrorMessage,M),children:["Connect a grid first. ",(0,i.jsx)("a",{onClick:E,href:A,children:"Manage grids"})]}),W&&(0,i.jsx)("span",{className:n.default.gridErrorMessage,children:y})]})]})]})};t.GridListSelector=_;t.GridListSelector.displayName="GridListSelector"},function(e,t,s){"use strict";s.r(t);t["default"]={gridErrorInput:"gridListSelector_gridErrorInput_G7hpA_VsZWN0b3It",gridErrorMessage:"gridListSelector_gridErrorMessage_2c0xp_VsZWN0b3It",gridIconAndName:"gridListSelector_gridIconAndName_1-aH5_VsZWN0b3It",ellipsis:"gridListSelector_ellipsis_1sTdt_VsZWN0b3It",gridLabel:"gridListSelector_gridLabel_X4bKO_VsZWN0b3It"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(562),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GridImage=void 0;const i=s(4);const o=s(563);const n=s(564);const r=s(565);const a=s(566);const c=s(567);const l=s(568);const u={testimHeadspin:r.default,browserstack:a.default,saucelabs:l.default,testimTDC:c.default,testimTVC:n.default};const d=({gridType:e,className:t})=>{const s=e in u?u[e]:o.default;return(0,i.jsx)("img",{src:s,className:t})};t.GridImage=d;t.GridImage.displayName="GridImage"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"8ba842706d.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"9cae1607f5.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"300a41f284.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"149c4f6d85.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"909f6d8746.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"64293cb1b9.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UploadAppsProgressToast=void 0;const i=s(4);const o=s(0);const n=s(0);const r=s(10);const a=s(570);const c=s(12);const l=s(67);const u=s(101);const d=s(571);const p=s(11);const h=s(103);const f=s(16);t.UploadAppsProgressToast=(0,c.observer)((({closeToast:e,animationContainer:t})=>{const s=(0,p.useDependencyInjector)(h.MobileAppsStore);const o=e=>e/1024/1024;(0,n.useEffect)((()=>{if(s.areAllRequestSettled){const t=setTimeout((()=>{e()}),2e4);return()=>clearTimeout(t)}return undefined}),[e,s.areAllRequestSettled]);return(0,i.jsxs)(l.Toast,{closeToast:e,animationContainer:t,hideClose:true,customToastClass:a.default.main,customToastBodyClass:a.default.body,children:[(0,i.jsx)(u.Collapsible,{headerClassName:a.default.header,headerIconClassName:(0,r.default)({[a.default.collapseIcon]:!s.areAllRequestSettled,[a.default.collapseIconWithClose]:s.areAllRequestSettled}),header:(0,i.jsx)("div",{children:"Uploading apps to grid"}),autoOpen:true,children:Array.from(s.uploadToGridRequests.entries()).map((([e,t])=>(0,i.jsx)(d.ItemAppUpload,{fileSize:o(t.app.fileSize),fileName:t.app.fileName,requestStatus:t.status,errorMessage:t.message,onDiscardClick:()=>s.abortUploadAppToGridRequest(e)},e)))}),s.areAllRequestSettled&&(0,i.jsxs)("button",{className:a.default.closeBtn,onClick:e,children:[" ",(0,i.jsx)(f.Icon,{icon:"close-thin",color:"while"})," "]})]})}));t.UploadAppsProgressToast.displayName="UploadAppsProgressToast"},function(e,t,s){"use strict";s.r(t);t["default"]={main:"UploadAppsProgressToast_main_2_p-V_NzVG9hc3Qt",body:"UploadAppsProgressToast_body_waBJw_NzVG9hc3Qt",header:"UploadAppsProgressToast_header_1JFMo_NzVG9hc3Qt",collapseIcon:"UploadAppsProgressToast_collapseIcon_lxOR6_NzVG9hc3Qt",collapseIconWithClose:"UploadAppsProgressToast_collapseIconWithClose_2pMb-_NzVG9hc3Qt",closeBtn:"UploadAppsProgressToast_closeBtn_1BncG_NzVG9hc3Qt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ItemAppUpload=void 0;const i=s(4);const o=s(0);const n=s(572);const r=s(228);const a=s(229);const c=s(157);const l=s(573);const u=s(230);const d=s(52);const p={pending:r.default,success:a.default,error:c.default,aborted:l.default};t.ItemAppUpload=({fileName:e,fileSize:t,onDiscardClick:s,requestStatus:r,errorMessage:a})=>{const c=(0,o.useMemo)((()=>p[r]),[r]);return(0,i.jsxs)("div",{className:n.default.main,children:[(0,i.jsxs)("div",{className:n.default.info,children:[(0,i.jsx)("img",{className:n.default.statusIcon,src:c}),(0,i.jsxs)("div",{children:[e&&(0,i.jsx)(d.Tooltip,{value:e,delay:200,children:(0,i.jsx)("div",{className:n.default.fileName,children:e})}),t&&(0,i.jsx)("div",{className:n.default.fileSize,children:`${Math.round(t)} MB`}),a&&(0,i.jsxs)("div",{className:n.default.errorMessage,children:[" ",a]})]})]}),r==="pending"&&(0,i.jsx)(u.DiscardFileAnchor,{onDiscardClick:s}),r==="error"&&(0,i.jsx)("div",{className:n.default.status,children:"Failed"}),r==="aborted"&&(0,i.jsx)("div",{className:n.default.status,children:"Canceled"})]})};t.ItemAppUpload.displayName="ItemAppUpload"},function(e,t,s){"use strict";s.r(t);t["default"]={main:"ItemAppUpload_main_3Ucn0_NzVG9hc3Qt",info:"ItemAppUpload_info_bUoSK_NzVG9hc3Qt",statusIcon:"ItemAppUpload_statusIcon_BYKQ5_NzVG9hc3Qt",fileName:"ItemAppUpload_fileName_ffepc_NzVG9hc3Qt",fileSize:"ItemAppUpload_fileSize_1fOo-_NzVG9hc3Qt",status:"ItemAppUpload_status_3Kw1g_NzVG9hc3Qt",errorMessage:"ItemAppUpload_errorMessage_300u0_NzVG9hc3Qt"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"16115d1aaf.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.tmaMobileService=void 0;const i=s(42);const o=s(143);class n{constructor(){this.activeSession=null;this.sessions=new Map}async deviceStatus(e){return i.httpRequest.get(`${(0,o.tmaBaseUrl)()}/devices/${e}/status`)}async startMirror(e){try{return i.httpRequest.postJson(`${(0,o.tmaBaseUrl)()}/device-interaction/${e}/screen-mirror`)}catch{return null}}async registerDevice(e,{udid:t}){if(this.activeSession){await this.deregisterDevice(this.activeSession)}this.sessions.set(e,t);const s=await this.startMirror(t);this.activeSession=e;return s}async deregisterDevice(e){const t=this.sessions.get(e);if(t){this.sessions.delete(e);await i.httpRequest.delete(`${(0,o.tmaBaseUrl)()}/device-interaction/${t}/screen-mirror`)}this.activeSession=null}}t.tmaMobileService=new n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FormModal=void 0;const i=s(4);const o=s(212);const n=s(0);const r=s(6);const a=s(211);const c=s(0);const l=s(30);const u=s(31);function d(e){const[t,s]=(0,c.useState)(true);const[d,p]=(0,c.useState)(0);const[h,f]=(0,c.useReducer)(((e,t)=>Object.assign({},e,t)),Object.keys(e.items).reduce(((t,s)=>{var i;return{...t,[s]:(i=e.items[s])===null||i===void 0?void 0:i.value}}),{}));const m=(0,c.useCallback)((()=>e.closeModal()),[e.closeModal]);const g=(0,c.useCallback)((()=>e.closeModal(h)),[e.closeModal,h]);const v=(0,c.useCallback)((({changes:e,isValid:t})=>{if(e){f(e)}if(t!==undefined){s(t)}}),[f,s]);const S=(0,c.useMemo)((()=>{var t;const s=(t=e.pages)===null||t===void 0?void 0:t[d];return s?r.pick(e.items,s.items):e.items}),[d,e.pages,e.items]);const y=(0,c.useMemo)((()=>r.omit(e,"items","pages","header","className")),[e]);const b=(0,c.useMemo)((()=>[o.default.formModal,e.className]),[e.className]);const _=()=>{var s,r,a,c,l,h;const f=(s=e.pages)===null||s===void 0?void 0:s[d];return(0,i.jsxs)(n.Fragment,{children:[((r=e.pages)===null||r===void 0?void 0:r.length)&&(0,i.jsxs)("div",{className:o.default.navigation,children:[d>0?(0,i.jsx)("a",{onClick:e=>{e.preventDefault();p(d-1)},children:(a=f===null||f===void 0?void 0:f.backText)!==null&&a!==void 0?a:"Back"}):null,d<e.pages.length-1?(0,i.jsx)("a",{onClick:e=>{e.preventDefault();p(d+1)},children:(c=f===null||f===void 0?void 0:f.nextText)!==null&&c!==void 0?c:"Next"}):null]}),(0,i.jsx)(u.Cta,{disabled:!t,onClick:g,children:(l=e.okText)!==null&&l!==void 0?l:"Ok"}),e.hideCancel!==true&&(0,i.jsx)(u.Cta,{variety:"secondary",onClick:m,children:(h=e.cancelText)!==null&&h!==void 0?h:"Cancel"})]})};_.displayName="Footer";const T=()=>{const t=typeof e.header==="string"?e.header:e.header(h,d);if(typeof t==="string"){return(0,i.jsx)("h3",{children:t})}return t};T.displayName="Header";return(0,i.jsx)(l.BaseModal,{...y,className:b,onSubmit:e.disableSubmitOnEnter?undefined:g,header:e.header&&(0,i.jsx)(T,{}),footer:(0,i.jsx)(_,{}),children:(0,i.jsx)(a.Form,{items:S,values:h,onChange:v,className:e.formClassName},d)})}t.FormModal=d;d.displayName="FormModal";d.defaultProps=l.BaseModal.defaultProps},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(577),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestUrlModal=void 0;const i=s(4);const o=s(578);const n=s(0);const r=s(30);const a=s(31);const c=s(44);const l=s(32);const u=s(74);const d=s(52);const p=s(16);const h=s(158);const f=e=>{var t;const[s,r]=(0,n.useState)((t=e.defaultUrl)!==null&&t!==void 0?t:"");return(0,i.jsxs)(h.HeadlessModal,{onSubmit:()=>e.closeModal({baseUrl:s}),closeModal:()=>e.closeModal(),blackMode:true,modalContentClassName:o.default.blackMode,children:[(0,i.jsx)("h3",{children:"Record test"}),(0,i.jsxs)(c.FieldLabel,{className:o.default.baseUrlLabel,children:[(0,i.jsx)("span",{children:"Please enter your app URL and start recording your test."}),(0,i.jsx)(l.Textbox,{autoFocus:true,placeholder:"https://yourapp.com",value:s,onChange:e=>r(e.target.value)})]}),(0,i.jsx)(a.Cta,{disabled:!s,onClick:()=>e.closeModal({baseUrl:s}),children:"START RECORDING"})]})};f.displayName="BlackTestUrlModal";const m=e=>{var t;const[s,h]=(0,n.useState)((t=e.defaultUrl)!==null&&t!==void 0?t:"");const[m,g]=(0,n.useState)(false);if(e.blackMode){return(0,i.jsx)(f,{...e})}return(0,i.jsxs)(r.BaseModal,{onSubmit:()=>e.closeModal({baseUrl:s}),closeModal:()=>e.closeModal(),header:(0,i.jsx)("h3",{children:e.title}),footer:e.showRememberUrl?(0,i.jsx)(a.Cta,{disabled:!s,onClick:()=>e.closeModal({baseUrl:s,saveTestUrlAsDefault:m}),children:"Create Test"}):(0,i.jsxs)("div",{children:[(0,i.jsx)(a.Cta,{disabled:!s,onClick:()=>e.closeModal({baseUrl:s}),children:"Ok"}),(0,i.jsx)(a.Cta,{variety:"secondary",onClick:()=>e.closeModal(),children:"Cancel"})]}),children:[(0,i.jsxs)(c.FieldLabel,{className:o.default.baseUrlLabel,children:[(0,i.jsx)("span",{children:"Your app URL"}),(0,i.jsx)(l.Textbox,{autoFocus:true,placeholder:"https://yourapp.com",value:s,onChange:e=>h(e.target.value)})]}),e.showRememberUrl&&(0,i.jsxs)(u.Checkbox,{wrapperClassName:o.default.label,onChange:()=>g(!m),checked:m,children:["Remember my decision (for this project)",(0,i.jsx)(d.Tooltip,{value:"You can always change this default in the settings (or override the URL only for a specific test by navigating to a different URL).",children:(0,i.jsx)(p.Icon,{icon:"info",className:o.default.icon})})]})]})};t.TestUrlModal=m;t.TestUrlModal.displayName="TestUrlModal"},function(e,t,s){"use strict";s.r(t);t["default"]={"base-url-label":"TestUrlModal_base-url-label_2sQjX_JsTW9kYWwt",baseUrlLabel:"TestUrlModal_base-url-label_2sQjX_JsTW9kYWwt",label:"TestUrlModal_label_3UZQs_JsTW9kYWwt",icon:"TestUrlModal_icon_3lh_f_JsTW9kYWwt",blackMode:"TestUrlModal_blackMode_2rFJO_JsTW9kYWwt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.MobileRecordingService=void 0;const d=s(15);const p=s(39);const h=s(2);const f=s(9);const m=s(29);const g=s(83);const v=s(27);const S=s(82);const y=s(117);const b=s(14);let _=class e{constructor(e,t,s,i,o,n){this.projectsService=e;this.companiesService=t;this.featureFlagsService=s;this.editedTestStore=i;this.mobileAgentService=o;this.setupMobileTestStore=n}async selectApplication({shouldOverrideApp:e=false}={}){const t=(()=>{var t;if(e){return"device"}if((t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.nativeApp){return"app"}return undefined})();await this.setupMobileTestStore.setupMobileTest(t)}async getConfig(){var e;await this.setupMobileTestStore.setupMobileTestIfNeeded();const{nativeApp:t}=(e=this.editedTestStore.scenario)!==null&&e!==void 0?e:{};const{device:s}=this.editedTestStore;if(!s||!t){return undefined}const i=await this.mobileAgentService.getMirroringInfo();return{isMobile:true,windowProps:i,recordingConfig:{app:t,editorSessionId:(0,y.getSessionId)(),storageType:this.companiesService.currentCompany.storageType,storageBaseUrl:this.companiesService.storageBaseUrl,projectId:this.projectsService.projectId,mobileCloseKeyboardOnSetTextInIos:this.featureFlagsService.flags.mobileCloseKeyboardOnSetTextInIos.isEnabled(),mobileCaptureScreenshotBeforeActionInRecord:this.featureFlagsService.flags.mobileCaptureScreenshotBeforeActionInRecord.isEnabled(),device:s}}}get mirroringInfo(){return(0,v.fromPromise)(this.mobileAgentService.getMirroringInfo())}};t.MobileRecordingService=_;i([h.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"mirroringInfo",null);t.MobileRecordingService=_=i([(0,f.injectable)(),o("design:paramtypes",[typeof(n=typeof d.ProjectsService!=="undefined"&&d.ProjectsService)==="function"?n:Object,typeof(r=typeof p.CompaniesService!=="undefined"&&p.CompaniesService)==="function"?r:Object,typeof(a=typeof b.FeatureFlagsService!=="undefined"&&b.FeatureFlagsService)==="function"?a:Object,typeof(c=typeof m.EditedTestStore!=="undefined"&&m.EditedTestStore)==="function"?c:Object,typeof(l=typeof g.MobileAgentService!=="undefined"&&g.MobileAgentService)==="function"?l:Object,typeof(u=typeof S.SetupMobileTestStore!=="undefined"&&S.SetupMobileTestStore)==="function"?u:Object])],_)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(581),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RestrictToChromeModal=void 0;const i=s(4);const o=s(0);const n=s(232);const r=s(70);const a=s(158);const c=s(582);const l=e=>(0,i.jsxs)(a.HeadlessModal,{closeModal:e.closeModal,blackMode:e.blackMode,children:[(0,i.jsx)("div",{children:(0,i.jsx)("img",{className:n.default.img,src:c.default})}),(0,i.jsx)("h3",{children:"Please use Chrome."}),(0,i.jsx)("div",{className:r.default.modalSection,children:e.blackMode?(0,i.jsx)("p",{children:"Youll need to use the Google Chrome browser to access the playground. Dont worry, we still support running cross-browser tests."}):(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:n.default.bold,children:"This feature is unavailable on your current browser"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("a",{href:"https://www.google.com/chrome/",children:"Download Chrome"})," for an ideal experience"]})]})})]});t.RestrictToChromeModal=l;t.RestrictToChromeModal.displayName="RestrictToChromeModal"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"14e3857e06.png"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestResultService=void 0;const i=s(125);const o="testResult:updated";class n extends i.BaseSocketService{init(e,t){super.init(e,"/testResult",t)}listenTo(e,t,s,i){function o(e){if(e.resultId===t&&e.testId===s){i(e)}}this._socket.on(e,o.bind(this))}emitJoinRoom(e,t){return this.emitPromise("testResult:join",{resultId:e,testId:t},`testResult:${e}`)}joinToTestResult(e,t){this.joinRoom(e,t);return this.emitJoinRoom(e,t)}async leaveTestResult(e,t){await this.emitPromise("testResult:leave",{resultId:e,testId:t},`testResult:${e}`);const s=this._socket.removeAllListeners();this.leaveRoom(e);return s}listenToSetupStepResult(e,t,s){this.listenTo("testResult:setupStep:updated",e,t,(e=>s(e.setupStep)))}listenToTestRunConfig(e,t,s){this.listenTo("testResult:runConfig:saved",e,t,(e=>s(e.runConfig)))}listenToTestRunParams(e,t,s){this.listenTo("testResult:runParams:saved",e,t,(e=>s({runParams:e.runParams,runParamsUrl:e.runParamsUrl})))}listenToStepResult(e,t,s){this.listenTo("testResult:step:updated",e,t,(e=>s(e.step)))}listenToTestResultStatus(e,t,s){this.listenTo(o,e,t,(e=>s(e.testResult.status)))}listenToTestResult(e,t,s){this.listenTo(o,e,t,(e=>s(e.testResult)))}saveRunConfigAndRunParams(e,t,s,i){return this.emitPromise("testResult:runParamsAndRunConfig:save",{runParamsUrl:i,runConfig:s,resultId:e,testId:t},`testResult:${e}`)}updateSetupStep(e,t,s){return this.emitPromise("testResult:setupStep:update",{setupStep:s,resultId:e,testId:t},`testResult:${e}`)}updateTestResult(e,t,s){return this.emitPromise("testResult:update",{testResult:s,resultId:e,testId:t},`testResult:${e}`)}async updateTestCompleted(e,t,s){await this.waitUntilAllStartsWithKeysFulfilled(`stepResult:${e}`);return await this.updateTestResult(e,t,s)}updateStepResult(e,t,s,i){i.stepResultId=s;i.eventTime=Date.now();return this.emitPromise("testResult:step:update",{stepResultId:s,step:i,resultId:e,testId:t},`stepResult:${e}:${s}`)}}t.TestResultService=n},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});const r=s(6);const a=s(2);const c=s(5);const l=["group","sleep","cli-action-code-step","cli-api-code-step","cli-wait-for-code-step","cli-validation-code-step","email-validation-step","email-generator"];class u{constructor(){this.cache=new Map;this.stepResultsTab=new Map}addStepResult(e,t,s){if(!e){return}this.cache.clear();if(!this.stepResultsTab.has(e)){this.stepResultsTab.set(e,{stepResultIds:new Set,tabOrder:s})}this.stepResultsTab.get(e).stepResultIds.add(t)}hasMoreThanOneTabInResults(){return this.stepResultsTab.size>1}getStepResultTabNumber(e){const t=Array.from(this.stepResultsTab.values()).find((t=>t.stepResultIds.has(e)));if(!t){return undefined}return t.tabOrder}calcStepResultTabNumber(e,t){if(!t){return undefined}if(!this.hasMoreThanOneTabInResults()){return 0}const s=t.stepResultId;const i=t.id;if(this.cache.has(s)){return this.cache.get(s)}if(t.type!==c.commonConstants.scenario.SHARED_STEP_INSTANCE){const e=this.getStepResultTabNumber(s);this.cache.set(s,e);return e}const o=t.path?`${t.path}:${i}`:i;const n=e.getInnerStepsResults(o).filter((e=>!r.includes(l,e.type)));const a=r.remove(n,(e=>e.type===c.commonConstants.scenario.SHARED_STEP_INSTANCE));const u=r.chain(n).uniq().filter(Boolean).map((e=>this.getStepResultTabNumber(e.stepResultId))).filter(r.isNumber).value();if(u.length>1||u[0]===-1){this.cache.set(s,-1);return-1}const d=a.map((t=>this.calcStepResultTabNumber(e,t)));const p=new Set(d.filter(r.isNumber).concat(u));const h=p.size>1;if(h){this.cache.set(s,-1);return-1}const[f]=p;this.cache.set(s,f);return f}}t.default=u;i([a.observable,o("design:type",typeof(n=typeof Map!=="undefined"&&Map)==="function"?n:Object)],u.prototype,"stepResultsTab",void 0)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(586),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AgentConnectionModal=void 0;const i=s(4);const o=s(0);const n=s(587);const r=s(10);const a=s(0);const c=s(218);const l=s(30);const u=s(28);const d=s(67);const p=s(31);const h=s(11);const f=s(62);const m=s(5);const g=s(15);const v={connect:"npm i -g @testim/testim-cli && testim connect",start:"npx --package @testim/testim-cli testim start"};const S=({okButton:e,onError:t,closeModal:s})=>{const o=(0,h.useDependencyInjector)(f.hostServiceFactory);const n=async()=>{try{const e=o().activeHost;const t=await e.send(m.commonConstants.scenario.CHECK_AGENT_CONNECTION);s(t)}catch(e){t()}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Cta,{onClick:n,children:e}),(0,i.jsx)(p.Cta,{variety:"secondary",onClick:()=>s(),children:"Cancel"})]})};S.displayName="AgentConnectionModalFooter";const y=({closeModal:e,title:t,body:s,mode:p="connect",okButton:f="Run"})=>{const m=(0,h.useDependencyInjector)(u.ModalService);const y=(0,h.useDependencyInjector)(g.ProjectsService);const[b,_]=(0,a.useState)(false);const T=(0,a.useMemo)((()=>{if(t){return t}if(y.isMobile){return"Run test locally"}return"Run test with CLI action"}),[y,t]);const E=(0,a.useMemo)((()=>{if(s){return s}if(y.isMobile){return"To run this test locally, please execute the following command:"}return"This test contains one or more CLI action steps. To run this test locally, please execute the following CLI command:"}),[y,s]);const I=o.useCallback((()=>{m.openToast(d.Toast,{children:"Copied to clipboard successfully",timeout:2e3,icon:{type:"V",backgroundType:"success"}})}),[m]);return(0,i.jsxs)(l.BaseModal,{closeModal:e,className:(0,r.default)(n.default.modal,{[n.default.modalError]:b}),bodyClassName:n.default.modalBody,header:(0,i.jsx)("h3",{children:T}),footer:(0,i.jsx)(S,{okButton:f,closeModal:e,onError:()=>_(true)}),children:[b&&(0,i.jsxs)("div",{className:n.default.errorSection,children:[(0,i.jsx)("div",{children:"Failed to connect with Testim CLI."}),(0,i.jsx)("div",{children:"Please run the command below and try again."})]}),(0,i.jsx)("div",{className:n.default.message,children:E}),(0,i.jsx)(c.TextboxWithCopy,{readOnly:true,value:v[p],className:n.default.command,buttonClassName:n.default.commandButton,onCopy:I})]})};t.AgentConnectionModal=y;t.AgentConnectionModal.displayName="AgentConnectionModal"},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"AgentConnection_modal_2Jqlp_5lY3Rpb24t","modal-error":"AgentConnection_modal-error_3zkzj_5lY3Rpb24t",modalError:"AgentConnection_modal-error_3zkzj_5lY3Rpb24t",message:"AgentConnection_message_2zf6e_5lY3Rpb24t",command:"AgentConnection_command_xDIwh_5lY3Rpb24t","command-button":"AgentConnection_command-button_1XbTd_5lY3Rpb24t",commandButton:"AgentConnection_command-button_1XbTd_5lY3Rpb24t","error-section":"AgentConnection_error-section_1IWDM_5lY3Rpb24t",errorSection:"AgentConnection_error-section_1IWDM_5lY3Rpb24t"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.HiddenParamsService=void 0;const c=s(2);const l=s(9);const u=s(55);const d=s(15);const p=s(28);const h=s(45);let f=class e{constructor(e,t,s){this.projectsService=e;this.modalService=t;this.premiumFeaturesService=s}get isHiddenParamsEnabled(){return this.premiumFeaturesService.canUseHiddenParameters}getHiddenParams(){if(!this.isHiddenParamsEnabled){return[]}return this.projectsService.projectDefaults.hiddenParams||[]}isContainingHiddenParams(e={}){const t=this.getHiddenParams();return Object.keys(e).some((e=>t.includes(e)))}openRerunDialog(){return this.modalService.openModal(h.MessageModal,{title:"Rerun with same params",body:"This test can't run again with same params because it has hidden parameters. Running it again from here will be without those params.",okText:"Run without hidden parameters",cancelText:"Cancel"}).promise}};t.HiddenParamsService=f;i([c.computed,o("design:type",Object),o("design:paramtypes",[])],f.prototype,"isHiddenParamsEnabled",null);t.HiddenParamsService=f=i([(0,l.injectable)(),o("design:paramtypes",[typeof(n=typeof d.ProjectsService!=="undefined"&&d.ProjectsService)==="function"?n:Object,typeof(r=typeof p.ModalService!=="undefined"&&p.ModalService)==="function"?r:Object,typeof(a=typeof u.PremiumFeaturesService!=="undefined"&&u.PremiumFeaturesService)==="function"?a:Object])],f)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ParamsMetadataManager=t.ScopedMetadata=void 0;const i=s(590);const o=s(7);const n=s(5);const r=s(6);const a=o.Logger.getLogger("ParamsMetadataManager");class c{constructor(e,t,s,i){this.globalScope=e;this.testScope=t;this.groupScope=s;this.testDataScope=i}static mergeMetadata(e,t){if(!e){return t}if(!t){return e}return new c(Object.assign(t.globalScope,e.globalScope),Object.assign(t.testScope,e.testScope),c.mergeGroupScope(e.groupScope,t.groupScope),Object.assign(t.testDataScope,e.testDataScope))}static mergeGroupScope(e,t){for(let s=0;s<Math.max(e.length,t.length);++s){if(t.length<=s){t.push(e[s])}else{Object.assign(t[s],e[s]||{})}}return t}}t.ScopedMetadata=c;class l{constructor(e,t){this.globalScopeMetadata={};this.testScopeMetadata={};this.groupScopeMetadata=[];this.testDataScopeMetadata={};this.ignoreScopeDepthLevels=0;if(t){this.globalScopeMetadata=t.globalScope;this.testScopeMetadata=t.testScope;this.groupScopeMetadata=t.groupScope;this.testDataScopeMetadata=t.testDataScope;this.ignoreScopeDepthLevels=this.groupScopeMetadata.length}this.hiddenParamNames=e||[]}get metadata(){return new c(this.globalScopeMetadata,this.testScopeMetadata,this.groupScopeMetadata,this.testDataScopeMetadata)}static hasHiddenParams(e){const t=e[n.commonConstants.test.PARAMS_METADATA_FIELD];if(!t){return false}const s=this.getFlatContextMetadata(t);const i=r.omit(e,n.commonConstants.test.PARAMS_METADATA_FIELD);return Object.keys(i).findIndex((e=>{var t;return(t=s[e])===null||t===void 0?void 0:t.isHidden}))!==-1}static getFlatContextMetadata(e){return Object.assign({},e.testDataScope,e.globalScope,e.testScope,...e.groupScope)}mergeTestDataMetadata(e){this.mergeContextMetadata(e,"test-data",this.testDataScopeMetadata)}createParamsExports(e){const t={exportsGlobal:{},exportsTest:{},contextData:{},testData:{},stepData:{}};for(const[s,i]of Object.entries(e)){const e=this.findParamScope(s);if(e){switch(e){case"group":Object.assign(t.contextData,{[s]:i});break;case"test":Object.assign(t.exportsTest,{[s]:i});break;case"global":Object.assign(t.exportsGlobal,{[s]:i});break;case"test-data":Object.assign(t.testData,{[s]:i});break;default:a.error(`Unrecognized 'ParamScopes' value: ${e}`);break}}else{a.error(`No param scope found for parameter '${s}'`)}}return t}findParamScope(e){if(this.groupScopeMetadata.some((t=>Object.keys(t).includes(e)))){return"group"}if(Object.keys(this.testScopeMetadata).includes(e)){return"test"}if(Object.keys(this.globalScopeMetadata).includes(e)){return"global"}if(Object.keys(this.testDataScopeMetadata).includes(e)){return"test-data"}return undefined}mergeContexts(e,t,s){this.mergeContextMetadata(e,"global",this.globalScopeMetadata);if(t){this.mergeContextMetadata(t,"test",this.testScopeMetadata)}if(s){if(this.groupScopeMetadata.length===0){this.incrementGroupScopeDepth()}this.mergeContextMetadata(s,"group",this.groupScopeMetadata[0])}}incrementGroupScopeDepth(){if(this.ignoreScopeDepthLevels){this.ignoreScopeDepthLevels--;return}this.groupScopeMetadata.unshift({})}decrementGroupScopeDepth(){this.groupScopeMetadata.shift()}mergeContextMetadata(e,t,s){if(!e){a.error(`No context data found for scope '${t}'`,{inputContext:e,scope:t,trackedMetadata:s,this:this,stack:(new Error).stack});return}Object.keys(e).reduce(((e,s)=>{e[s]=new i.ParamMetadata(t,this.hiddenParamNames.includes(s));return e}),s)}}t.ParamsMetadataManager=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ParamMetadata=void 0;class i{constructor(e,t){this.scope=e;this.isHidden=t}}t.ParamMetadata=i},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HookIndicationToast=t.HIDE_HOOK_POPUP=void 0;const i=s(4);const o=s(0);const n=s(67);const r=s(11);const a=s(162);const c=s(74);const l=s(16);const u=s(594);const d=s(597);t.HIDE_HOOK_POPUP="hide-hook-popup";const p=({closeToast:e,animationContainer:t})=>{const s=(0,r.useDependencyInjector)(a.HooksService);const[p,h]=(0,o.useState)(false);return(0,i.jsx)(n.Toast,{customToastBodyClass:d.default.toastBody,closeToast:e,animationContainer:t,hideClose:true,children:(0,i.jsxs)("div",{className:d.default.toastWrapper,children:[(0,i.jsx)("span",{className:d.default.info,children:(0,i.jsx)(l.Icon,{icon:"info",className:d.default.infoIcon})}),(0,i.jsxs)("div",{className:d.default.textWrapper,children:[(0,i.jsx)("div",{className:d.default.toastInnerSection,children:(0,i.jsx)("p",{children:"This step is a hook and therefore can't be edited."})}),(0,i.jsx)(u.LineSeparator,{}),(0,i.jsxs)("div",{className:d.default.toastInnerSection,children:[(0,i.jsx)(c.Checkbox,{wrapperClassName:d.default.checkbox,onChange:e=>{h(e.target.checked)},checked:p,children:"Don't show this message again"}),(0,i.jsx)("button",{className:d.default.button,onClick:()=>s.closeIndicationToast(p),children:"GOT IT"})]})]})]})})};t.HookIndicationToast=p;t.HookIndicationToast.displayName="HookIndicationToast"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(595),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LineSeparator=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(596);const a=({withSpacing:e,doubleSpacing:t})=>(0,i.jsx)("hr",{className:(0,o.default)(r.default.separator,{[r.default.withSpacing]:e,[r.default.doubleSpacing]:t})});t.LineSeparator=a},function(e,t,s){"use strict";s.r(t);t["default"]={separator:"LineSeparator_separator_3HBpU_BhcmF0b3It",withSpacing:"LineSeparator_withSpacing_37EMT_BhcmF0b3It",doubleSpacing:"LineSeparator_doubleSpacing_2SplN_BhcmF0b3It"}},function(e,t,s){"use strict";s.r(t);t["default"]={toastBody:"HookIndicationToast_toastBody_1XzRq_9uVG9hc3Qt",toastWrapper:"HookIndicationToast_toastWrapper_1nMIw_9uVG9hc3Qt",info:"HookIndicationToast_info_3BzDd_9uVG9hc3Qt",infoIcon:"HookIndicationToast_infoIcon_3tW5O_9uVG9hc3Qt",textWrapper:"HookIndicationToast_textWrapper_3vMHk_9uVG9hc3Qt",toastInnerSection:"HookIndicationToast_toastInnerSection_1KRZL_9uVG9hc3Qt",checkbox:"HookIndicationToast_checkbox_1KB6K_9uVG9hc3Qt",button:"HookIndicationToast_button_17Uxp_9uVG9hc3Qt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.UILabFeaturesService=void 0;const d=s(9);const p=s(2);const h=s(27);const f=s(5);const m=s(14);const g=s(159);const v=s(22);const S=s(15);const y=s(33);const b=s(7);const _=s(55);const T=b.Logger.getLogger("ui-lab-features-service");const E=[{name:"Link Directly to a Shared Step",featureFlagName:"sharedStepDirectNavigationMigrated",description:"Enables users to navigate directly from the shared steps library to a test using the shared step.",imageUrl:s(599).default,docsUrl:"https://help.testim.io/docs/link-directly-to-a-shared-step"},{name:"Test Flow View",featureFlagName:"showTestVisualizationMigrated",description:"Visualize your tests in a new, graphical way. Drill down into the test case for details.",imageUrl:s(600).default,docsUrl:"https://help.testim.io/docs/test-flow-view"},{name:"Reports improvements",featureFlagName:"newReportFilters",description:"Get better insights about your tests with advanced filters and up to one year of data.",imageUrl:s(601).default,docsUrl:"https://help.testim.io/docs/managerial-reports"},{name:"Scheduler notifications via webhook",featureFlagName:"schedulerWebhookNotification",description:"Enable schedulers results notifications via webhook.",turnOffMessage:"Scheduled runs results notifications will no longer be pushed via webhook",imageUrl:s(602).default,docsUrl:"https://help.testim.io/docs/schedulers-notification-via-webhook"},{name:"Auto Improve",featureFlagName:"shouldEnableAutoImprove",description:'Auto-improve enhances element stability by tracking and improving smart locator scores to adjust for changes to the element attributes and DOM."',imageUrl:s(603).default,docsUrl:f.commonConstants.documentationUrls.AUTO_IMPROVE}];if(false){}let I=class e extends y.EventEmitter{constructor(e,t,s,i,o){super();this.labFeaturesService=e;this.premiumFeaturesService=t;this.projectsService=s;this.testimServices=i;this.featureFlagsService=o}get isLabsEnabledForCurrentCompany(){return this.premiumFeaturesService.premiumFeatures.enableLabFeatures||false}get isLoaded(){return this.labFeatures.state==="fulfilled"}get labFeatures(){const e=this.projectsService.projectId;if(!e){return h.fromPromise.resolve([])}const t=this.premiumFeaturesService.premiumFeatures;return(0,h.fromPromise)(this.loadLabFeatures(e,t))}async loadLabFeatures(e,t){const s=await this.labFeaturesService.loadLabFeatures(e,t);this.trigger(f.commonConstants.labFeatures.PROJECT_LAB_FEATURES_LOADED,{projectId:e});return E.map((e=>{let t=s.find((t=>e.featureFlagName===t.featureFlagName));if(!t){s.push({enabled:false,sunsetViewed:false,featureFlagName:e.featureFlagName});t=s.find((t=>e.featureFlagName===t.featureFlagName))}return Object.assign(t||{},e)})).filter((e=>this.featureFlagsService.flags[e.featureFlagName].getValue()==="labs"))}isFeatureAvailableForProject(e){if(this.isLoaded){return this.labFeaturesService.isFeatureAvailableForProject(e)}return false}async toggleLabFeature(e,t){const s=this.projectsService.projectId;const i=e.enabled;try{e.enabled=t;await this.testimServices.labFeatures.updateLabFeatureProject({projectId:s,featureFlagName:e.featureFlagName,name:e.name,enabled:t});this.trigger(f.commonConstants.labFeatures.PROJECT_LAB_FEATURES_CHANGED,{projectId:s})}catch(s){e.enabled=i;T.error("failed updating lab feature",{featureFlagName:e.featureFlagName,isEnabled:t,e:s});throw s}}};t.UILabFeaturesService=I;i([(0,p.computed)({keepAlive:true}),o("design:type",Boolean),o("design:paramtypes",[])],I.prototype,"isLabsEnabledForCurrentCompany",null);i([(0,p.computed)({keepAlive:true}),o("design:type",Boolean),o("design:paramtypes",[])],I.prototype,"isLoaded",null);i([(0,p.computed)({keepAlive:true}),o("design:type",typeof(u=typeof h.IPromiseBasedObservable!=="undefined"&&h.IPromiseBasedObservable)==="function"?u:Object),o("design:paramtypes",[])],I.prototype,"labFeatures",null);t.UILabFeaturesService=I=i([(0,d.injectable)(),o("design:paramtypes",[typeof(n=typeof g.LabFeaturesService!=="undefined"&&g.LabFeaturesService)==="function"?n:Object,typeof(r=typeof _.PremiumFeaturesService!=="undefined"&&_.PremiumFeaturesService)==="function"?r:Object,typeof(a=typeof S.ProjectsService!=="undefined"&&S.ProjectsService)==="function"?a:Object,typeof(c=typeof v.TestimServicesApi!=="undefined"&&v.TestimServicesApi)==="function"?c:Object,typeof(l=typeof m.FeatureFlagsService!=="undefined"&&m.FeatureFlagsService)==="function"?l:Object])],I)},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"93ed6c94d7.jpg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"83c8f27ef1.png"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"89335114b8.jpg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"d4f59c7436.jpg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"c8b3fa02c0.jpg"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(605),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HiddenHooksModal=void 0;const i=s(4);const o=s(235);const n=({hiddenHooksNames:e,...t})=>(0,i.jsx)(o.ErrorModal,{title:"Could not run test",body:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:"You are are trying to run with hook that points to a hidden shared step."}),(0,i.jsx)("div",{children:"Please unhide these shared steps:"}),(0,i.jsx)("br",{}),(0,i.jsx)("ul",{children:e.map((e=>(0,i.jsx)("li",{children:e},e)))})]}),...t});t.HiddenHooksModal=n;t.HiddenHooksModal.displayName="HiddenHooksModal"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ErrorModalWithPersistMessage=void 0;const i=s(4);const o=s(0);const n=s(236);const r=s(164);const a=e=>(0,i.jsx)(r.ErrorModal,{...e,body:(0,i.jsxs)(i.Fragment,{children:[e.body||"Something went wrong, please try again or contact support",(0,i.jsx)("br",{}),"If this problem persists please contact us at ",(0,i.jsx)("a",{href:"mailto:info@testim.io",className:n.default.contactLink,children:"info@testim.io"})]})});t.ErrorModalWithPersistMessage=a;t.ErrorModalWithPersistMessage.displayName="ErrorModalWithPersistMessage"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NoPermissionModal=void 0;const i=s(4);const o=s(0);const n=s(608);const r=s(164);const a=({closeModal:e})=>(0,i.jsx)(r.ErrorModal,{className:n.default.permissionModal,closeModal:e,hideFooter:true,title:"No Permission",subTitle:"It looks like you don't have permission to view this item.",body:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:n.default.permissionSection,children:"What can you do?"}),(0,i.jsxs)("ul",{className:n.default.permissionSection,children:[(0,i.jsx)("li",{children:" Ask for permission from project owner"}),(0,i.jsx)("li",{children:" Sign in with the correct account"})]}),(0,i.jsx)("div",{className:n.default.permissionFooter,children:(0,i.jsxs)("span",{children:["For further assistance and more information please see ",(0,i.jsx)("a",{href:"https://help.testim.io/docs/",target:"_blank",rel:"noreferrer noopener",children:"our docs"}),"."]})})]})});t.NoPermissionModal=a},function(e,t,s){"use strict";s.r(t);t["default"]={"permission-modal":"NoPermissionError_permission-modal_3ZKMh_MtZXJyb3It",permissionModal:"NoPermissionError_permission-modal_3ZKMh_MtZXJyb3It","permission-section":"NoPermissionError_permission-section_l4yFQ_MtZXJyb3It",permissionSection:"NoPermissionError_permission-section_l4yFQ_MtZXJyb3It","permission-footer":"NoPermissionError_permission-footer_34ypQ_MtZXJyb3It",permissionFooter:"NoPermissionError_permission-footer_34ypQ_MtZXJyb3It"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.parseHttpClientErrorMessage=t.getHandledErrorType=void 0;const i=s(6);const o=s(5);const n=s(97);function r(e,t=null){const{ELEMENT_NOT_FOUND:s,ELEMENT_NOT_VISIBLE:n,TAB_NOT_FOUND:r,FRAME_NOT_FOUND:a,JS_ASSERTION_FAILED:c,API_FAILURE:l,COULD_NOT_GET_BROWSER:u,BROWSER_TYPE_NOT_SUPPORTED:d,PAGE_NOT_AVAILABLE:p,JS_SYNTAX_ERROR:h,FAILED_OPACITY:f,FRAME_NOT_VISIBLE:m,ELEMENT_OUTSIDE_OF_VIEWPORT:g,ELEMENT_HAS_ZERO_HEIGHT_OR_WIDTH:v,GENERIC_ELEMENT_HIDDEN:S,UNKNOWN_MOBILE_ATTRIBUTE:y}=o.commonConstants.stepResult;const b=[s,n,r,a,c,l,f,m,g,v,S,y];const _=[{type:u,reason:"Test couldn't get browser"},{type:n,reason:"Element is not visible"},{type:s,reason:"Element not found"},{type:r,reason:"could not find tab"},{type:c,reason:"Assertion failed"}];const T=[{type:d,regex:/^browser type .+ is not supported$/gi},{type:p,regex:/^page .+ is not available$/gi},{type:h,regex:/^error while running step: SyntaxError.+/gi},{type:a,regex:/^could not find frame.+/gi},{type:l,regex:/^Api request failed.+/gi}];if(t&&b.includes(t)){return b[b.indexOf(t)]}let E=i.find(_,(t=>t.reason===e));if(E){return E.type}E=i.find(T,(t=>t.regex.test(e)));if(E){return E.type}return o.commonConstants.stepResult.UNKNOWN_ERROR}t.getHandledErrorType=r;function a(e,t){let s=t;if(e instanceof n.TypedHttpError&&e.status===400&&typeof e.response==="string"){s=e.response}return s}t.parseHttpClientErrorMessage=a},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(237),t);o(s(611),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConnectionToBackground=void 0;const i=s(118);const o=s(8);const n=s(5);const r=s(131);const a=s(238);const c=s(237);const l=20;function u({external:e},t){const s=({data:e})=>{if(e===c.EXTENSION_LOADED){t()}};if(e){window.addEventListener("message",s);return}i.browser.runtime.onMessage.addListener(s)}function d(){const e=100;const t=2e3;const s=1.2;return{lastWait:null,space:e,async wait(){const e=this.lastWait?Date.now()-this.lastWait:null;await o.utils.delay(this.space-(e!==null&&e!==void 0?e:this.space));this.lastWait=Date.now();if(this.space<t){this.space*=s}},reset(){this.lastWait=null;this.space=e}}}function p(e){const t=`${e}:${o.utils.guid()}`;return t}class h{constructor(e,{external:t}={}){this.context=e;this._queue=new r.ActionsQueue((()=>this._connected));this._connected=Promise.resolve(false);const s=d();let o=l;const{runtime:h}=i.browser!==null&&i.browser!==void 0?i.browser:{};const f={name:p("switchboard-connection-to-bg")};const m=t?()=>h===null||h===void 0?void 0:h.connect(n.TESTIM_EXTENSION_ID,f):()=>h===null||h===void 0?void 0:h.connect(f);const g=async()=>{var e,t;if(await this._connected){return}this._port=m();this._connected=new Promise((e=>{var t;const i=t=>{var n,r;if((t===null||t===void 0?void 0:t.type)===c.PING_MSG){e(true);(n=this._port)===null||n===void 0?void 0:n.onMessage.removeListener(i);s.reset();o=l;const{exposedServices:t}=this.msgProcessor;const a={context:this.context,exposedServices:t};(r=this._port)===null||r===void 0?void 0:r.postMessage({type:c.PONG_MSG,data:a})}};(t=this._port)===null||t===void 0?void 0:t.onMessage.addListener(i)}));const i=e=>{if(!(0,r.hasMetadata)(e)){return}if(this.msgProcessor.debug){(0,a.logMessage)("received <<","background",e)}this.msgProcessor.processMessage((0,r.stampMessage)(e,this.context,"background"))};(e=this._port)===null||e===void 0?void 0:e.onDisconnect.addListener((async e=>{this._connected=Promise.resolve(false);e.onMessage.removeListener(i);if(o<=0){return}await s.wait();o--;g()}));(t=this._port)===null||t===void 0?void 0:t.onMessage.addListener(i);await this._connected;this._queue.doAll()};g();u({external:t},(()=>{this._connected=Promise.resolve(false);g()}))}fromBackground(e){var t;return Boolean((t=e.metadata)===null||t===void 0?void 0:t.stamps[this.context])}async addToQueue(e){let t=0;const s=()=>{var i,o;try{t++;(i=this._port)===null||i===void 0?void 0:i.postMessage(e);if(this.msgProcessor.debug){(0,a.logMessage)("post >>","background",e)}}catch(e){if((o=e===null||e===void 0?void 0:e.message)===null||o===void 0?void 0:o.toLowerCase().includes("disconnected")){this._connected=Promise.resolve(false);if(t<3){this._queue.add(s)}return}(0,c.throwMaxLengthIfNeeded)(e);throw e}};await this._queue.add(s)}async forward(e){if(this.fromBackground(e)){return}await this.addToQueue(e)}async backward(e){if(this.fromBackground(e)){await this.addToQueue(e)}}}t.ConnectionToBackground=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Switchboard=t.getKeysDeep=void 0;const i=s(613);const o=s(131);class n extends Error{constructor(e,t){super(`Multiple registration\n    You are trying to register connections for broker in context: "${t}", but it's already registered to context: "${e}".\n    Make sure you are not importing something you shouldn't`)}}function r(e){const t=new Set;let s=e;do{Object.getOwnPropertyNames(s).forEach((e=>t.add(e)));s=Object.getPrototypeOf(s)}while(Object.getPrototypeOf(s));t.delete("constructor");return Array.from(t)}t.getKeysDeep=r;const a={CALL:"call",GET:"get",SET:"set"};class c{constructor(e){this.contextConnectionMap=e;this._debug=false;this.actionsQueue=new o.ActionsQueue((()=>Boolean(this._broker)));this.on=(...e)=>{let t=false;let s;this.actionsQueue.add((()=>{var i;if(!t){s=(i=this._broker)===null||i===void 0?void 0:i.on(...e)}}));return()=>{s===null||s===void 0?void 0:s();t=true}};this.trigger=(...e)=>new Promise(((t,s)=>{this.actionsQueue.add((()=>{var i;(i=this._broker)===null||i===void 0?void 0:i.trigger(...e).then(t).catch(s)}))}));this.registerToScope=(...e)=>{this.actionsQueue.add((()=>{var t;(t=this._broker)===null||t===void 0?void 0:t.registerToScope(...e)}))}}scoped(e){return{trigger:(t,s,i)=>this.trigger(t,s,{...i,additionalScopes:(0,o.combineScopes)(e,i===null||i===void 0?void 0:i.additionalScopes)}),on:(t,s,i)=>this.on(t,s,{...i,additionalScopes:(0,o.combineScopes)(e,i===null||i===void 0?void 0:i.additionalScopes)}),getRemote:(t,s)=>this.getRemote(t,{...s,scope:(0,o.combineScopes)(e,s===null||s===void 0?void 0:s.scope)})}}getRemote(e,{scope:t,ignoreTimeoutByDefault:s}={}){const i=this;return new Proxy({},{get(n,r){const c=e=>{if(s){return undefined}return t=>{Object.assign(t,{stack:e===null||e===void 0?void 0:e.replace(/^Error\n.*?\n/,"Error: TIMEOUT\n")});throw t}};const l=(s,i)=>({onTimeout:c(i),...s,additionalScopes:(0,o.combineScopes)(t,s===null||s===void 0?void 0:s.additionalScopes),recipientServiceKey:e});const{stack:u}=Error();const d=(t,s)=>i.trigger(`${e}:${a.CALL}:${r}`,t,l(s,u));d.get=t=>{const{stack:s}=Error();return i.trigger(`${e}:${a.GET}:${r}`,undefined,l(t,s))};d.set=(t,s)=>{const{stack:o}=Error();return i.trigger(`${e}:${a.SET}:${r}`,t,l(s,o))};return d}})}expose(e,t,{exposedFields:s,...i}={}){queueMicrotask((async()=>{await this.registerServiceToBroker(e);r(t).forEach((o=>{if(!s||s.includes(o)){this._broker.on(`${e}:${a.CALL}:${String(o)}`,(async(e,s)=>{const i=await t[o].call(t,e);s(i)}),i);this._broker.on(`${e}:${a.GET}:${String(o)}`,((e,s)=>{s(t[o])}),i);this._broker.on(`${e}:${a.SET}:${String(o)}`,((e,s)=>{t[o]=e;s(t[o])}),i)}}))}))}connect(e){if(this._broker){throw new n(this._broker.context,e)}const t=this.contextConnectionMap[e]();this._broker=new i.Broker(e,t);this._broker.debug=this._debug;this.actionsQueue.doAll()}debug(){this._debug=true;Object.defineProperty(window,"$broker",{get:()=>this._broker})}registerServiceToBroker(e){return new Promise(((t,s)=>{this.actionsQueue.add((()=>{var i;(i=this._broker)===null||i===void 0?void 0:i.registerService(e).then(t).catch(s)}))}))}}t.Switchboard=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Broker=void 0;const i=s(6);const o=s(77);const n=s(8);const r=s(614);const a=s(131);const c=s(239);const l=s(7);const u=l.Logger.getLogger("switchboard:broker");const d=c.switchboardEvents.ERROR;function p(e,t){const s=JSON.stringify(e.data);const i=[];for(let e=0;e<s.length;e+=t){i.push(s.slice(e,e+t))}return i.map(((t,s)=>{const o={...e.metadata,chunkData:{total:i.length,index:s}};return{...e,metadata:o,data:t}}))}class h{get exposedServices(){return Array.from(this._exposedServices)}constructor(e,t){this.context=e;this._connections=t;this.debug=false;this._localActions=new r.ActionsService;this._transactions={};this._scopes=new Set;this._exposedServices=new Set;this._chunks=new Map;this.on=(e,t,{additionalScopes:s}={})=>{if(s){return this._localActions.on(e,((e,i,o)=>{if([s].flat().some((e=>o.scopes.includes(e)))){return t(e,i,o)}return undefined}))}return this._localActions.on(e,t)};this.registerService=e=>{if(this._exposedServices.has(e)){throw new Error(`You already expose "${e}" in this context`)}this._exposedServices.add(e);return this.trigger(c.switchboardEvents.EXPOSED,{key:e,context:this.context})};this.registerToScope=e=>{this._scopes.add(e)};this.trigger=async(e,t,s={})=>{const{timeout:i,onTimeout:n,retries:r,retryOptions:c,noConsoleLog:l,additionalScopes:u,recipientServiceKey:d}=s;try{return await o((()=>{const{transactionId:s,promise:o}=this.createTransaction(i!==null&&i!==void 0?i:2*1e3);const n={type:e,data:t,metadata:{transactionId:s,sender:this.context,stamps:{},noConsoleLog:l,scopes:Array.from(this._scopes).concat(u!==null&&u!==void 0?u:[]),recipientServiceKey:d}};this.forward(n);return o}),{retries:r||0,factor:1,...c})}catch(e){if(e instanceof a.BrokerTimeoutError){return n===null||n===void 0?void 0:n(e)}throw e}};this.processMessage=e=>{if(this._scopes.size>0&&e.metadata.scopes.every((e=>!this._scopes.has(e)))){return}const t=this.joinChunks(e);if(!t){return}if(!t.metadata.responder){this.forward(t);return}if(t.metadata.sender===this.context){this.resolveTransaction(t);return}this.backward(t)};this.callLocalActions=async e=>{const t={...e,metadata:{...e.metadata}};let s=false;const o=e=>{s=true;t.metadata.responder=this.context;t.data=e;this.processMessage(t)};const n=this._localActions.trigger(e,o);if(n===undefined){return}try{const e=await n;if(!s){o(e)}}catch(e){t.metadata.responder=this.context;t.data=i.pick(e,["message","stack"]);t.type=d;this.processMessage(t)}};this.forward=async e=>{const t=()=>this.callLocalActions(e);const s=()=>this._connections.forEach((async t=>{try{return await t.forward(e)}catch(s){if(s instanceof a.ConnectionMaxSizeError){const i=p(e,s.maxSize);i.forEach((e=>t.forward(e)));return undefined}throw s}}));const{recipientServiceKey:i}=e.metadata;if(!i){s();await t();return}if(this._exposedServices.has(i)){await t()}else{s()}};this.backward=e=>{this._connections.forEach((async t=>{try{return await t.backward(e)}catch(s){if(s instanceof a.ConnectionMaxSizeError){const i=p(e,s.maxSize);i.forEach((e=>t.backward(e)));return undefined}throw s}}))};this.createTransaction=e=>{const t=n.utils.guid();let s;const i=new Promise(((i,o)=>{this._transactions[t]={resolve:i,reject:o};s=setTimeout((()=>{o(new a.BrokerTimeoutError(e))}),e)})).finally((()=>{delete this._transactions[t];clearTimeout(s)}));return{transactionId:t,promise:i}};this.parseError=e=>{if(e.message||e.stack){const t=new Error(e.message);t.stack=e.stack;return t}if(typeof e==="string"){return new Error(e)}return new Error(JSON.stringify(e))};this.resolveTransaction=e=>{const{type:t,data:s,metadata:{transactionId:i}}=e;const o=this._transactions[i];if(o){if(t===d){o.reject(this.parseError(s))}else{o.resolve(s)}return true}return false};this.on(c.switchboardEvents.EXPOSED,(({key:t,context:s})=>{if(e!==s&&this._exposedServices.has(t)){throw new Error(`You already expose "${t}" in "${e}"`)}}));t.forEach((e=>{e.msgProcessor=this}))}joinChunks(e){if(!e.metadata.chunkData){return e}const{index:t,total:s}=e.metadata.chunkData;if(!this._chunks.has(e.metadata.transactionId)){this._chunks.set(e.metadata.transactionId,[])}const i=this._chunks.get(e.metadata.transactionId);i[t]=e;if(!(i.length===s&&i.every((e=>e!==undefined)))){return undefined}this._chunks.delete(e.metadata.transactionId);try{const t=JSON.parse(i.map((e=>e.data)).join(""));const s={...e.metadata};delete s.chunkData;return{...e,metadata:s,data:t}}catch(e){u.error("failed to parse chunks",{error:e,chunks:i});return undefined}}}t.Broker=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ActionsService=void 0;function i(e){return typeof(e===null||e===void 0?void 0:e.then)==="function"}class o{constructor(){this._listeners=new Map;this.on=(e,t)=>{const s=Symbol("uuid");if(!this._listeners.has(e)){this._listeners.set(e,new Map)}this._listeners.get(e).set(s,t);return()=>{var t;(t=this._listeners.get(e))===null||t===void 0?void 0:t.delete(s)}};this.trigger=({data:e,type:t,metadata:s},o)=>{const n=this._listeners.get(t);if(!n){return undefined}return new Promise(((t,r)=>{for(const a of n.values()){const n=a(e,o,s);if(!i(n)&&n!==undefined){t(n)}else if(i(n)){n.then((e=>{if(e!==undefined){t(e)}})).catch(r)}}}))}}}t.ActionsService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.normalizeLocalTmaDevice=void 0;const i=e=>{var t,s;if(!e){throw new Error("Device is undefined")}return{udid:e.udid,name:e.name,model:e.model,height:e.height,width:e.width,resolution:`${e.width}x${e.height}`,geo:"local",manufacturer:e.model,osVersion:e.osVersion,type:e.deviceType||"",osType:e.deviceType.toLocaleLowerCase(),isLandscape:false,scaleFactor:(t=e.scaleFactor)!==null&&t!==void 0?t:1,isVirtual:(s=e.virtual)!==null&&s!==void 0?s:false,minApiVersion:e.minApiVersion}};t.normalizeLocalTmaDevice=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getPlaybackTreeBuilder=void 0;function i(){return new Promise(((e,t)=>{Promise.all([s.e(0),s.e(4),s.e(2)]).then((t=>e(s(316).playbackTreeBuilder)).bind(null,s)).catch((e=>t(e)))}))}t.getPlaybackTreeBuilder=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestStreamSocketIO=void 0;const i=s(5);const o=s(125);const{socketEventTypes:n}=i.commonConstants;class r extends o.BaseSocketService{init(e,t,s){super.init(e,"/testStream",t,s)}emitJoinRoom(e){return this.emitPromise("join:room",{testId:e},`test-stream:${e}`)}joinToTestStream(e){this.joinRoom(e,e);return this.emitJoinRoom(e)}async leaveTestStream(e){await this.emitPromise("leave:room",{testId:e},`test-stream:${e}`);this._socket.removeAllListeners();this.leaveRoom(e)}listenTo(e,t,s){function i(e){if(e.testId===t){s(e)}}this._socket.on(e,i.bind(this))}listenToStepAdded(e,t){this.listenTo(n.STEP_ADDED,e,t)}listenToStepUpdated(e,t){this.listenTo(n.STEP_UPDATED,e,t)}listenToTestUpdated(e,t){this.listenTo(n.TEST_UPDATED,e,t)}listenToTestConfigUpdated(e,t){this.listenTo(n.TEST_CONFIG_UPDATED,e,t)}}t.TestStreamSocketIO=r},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E;Object.defineProperty(t,"__esModule",{value:true});t.StepsAdder=void 0;const I=s(6);const C=s(2);const D=s(165);const O=s(84);const A=s(9);const j=s(28);const w=s(21);const R=s(7);const P=s(8);const x=s(14);const M=s(49);const N=s(15);const F=s(5);const L=s(39);const k=s(34);const B=s(63);const U=s(643);const G=s(80);const V=s(85);const H=s(29);const $=s(33);const W=s(104);const J=s(653);const Y=s(163);const z=s(661);const q=s(92);const X=s(43);const Z=s(26);const Q=s(662);const K=s(78);const ee=R.Logger.getLogger("steps adder");class te extends Error{}const se={type:"evaluate-expression",expression:""};let ie=class e extends $.EventEmitter{constructor(e,t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v){super();this.recordingStore=e;this.modalService=t;this.analyticsService=s;this.hostService=i;this.featureFlagsService=o;this.userService=n;this.projectsService=r;this.branchesService=a;this.companiesService=c;this.notificationDisplayService=l;this.editorSelectionService=u;this.editedTestStore=d;this.playbackStore=p;this.foldersStore=h;this.autoGroupingEditorService=f;this.testController=m;this.urlStateService=g;this.productTourService=v;this.STEP_ADDITION_MAPPING={hover:{stepData:{autoScroll:true,shouldAccountForMouseOffsetInHover:true},applyStepChanges:e=>this.addStepWithElement(e)},"debug-lab-feature":{stepData:{}},refresh:{stepData:{}},"date-generator":{stepData:{}},"generate-random-field":{stepData:{}},mfa:{stepData:{},applyStepChanges:async e=>await this.saveMfaSecretToStep(e.step)},sleep:{stepData:{}},"email-generator":{stepData:{}},"wait-for-text-validation":{stepData:{autoScroll:true},applyStepChanges:e=>this.addStepWithElement(e),isValidation:false},"ios-wait-for-text-validation":{stepData:{autoScroll:true},applyStepChanges:e=>this.addStepWithElement(e),isValidation:false},"android-wait-for-text-validation":{stepData:{autoScroll:true},applyStepChanges:e=>this.addStepWithElement(e),isValidation:false},"text-validation":{stepData:{autoScroll:true},applyStepChanges:e=>this.addStepWithElement(e),isValidation:true},"ios-text-validation":{stepData:{autoScroll:true,expression2:se},applyStepChanges:e=>this.addStepWithElement(e),isValidation:true},"android-text-validation":{stepData:{autoScroll:true,expression2:se},applyStepChanges:e=>this.addStepWithElement(e),isValidation:true},"ios-reset-app":{stepData:{}},"android-reset-app":{stepData:{}},"mobile-hide-keyboard":{stepData:{}},"ios-mobile-home-button":{stepData:{}},"android-mobile-home-button":{stepData:{}},"ios-attr-validation":this.mobileAttributeValidation(),"android-attr-validation":this.mobileAttributeValidation(),"android-back-button":{stepData:{}},"android-scroll-to-text":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"ios-scroll-to-text":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"wait-for-simple-ui-verification":{stepData:{action:"element"},applyStepChanges:e=>this.setStepLocator(e,"addStepWithElement",this.locatorMetadataGeneratorForUiStep(e.step))},"simple-ui-verification":{stepData:{},applyStepChanges:e=>{if(e.step.action!=="element"){return undefined}return this.setStepLocator(e,"addStepWithElement",this.locatorMetadataGeneratorForUiStep(e.step))}},screenshot:{stepData:{screenshotType:"debugger-full-page"}},"wait-for-element-validation":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"element-validation":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"wait-for-negative-element-validation":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"extract-text":{stepData:{extractTextParamName:"value",extractTextMode:"entireString",autoScroll:true,exportScope:F.commonConstants.exportScopes.TEST},applyStepChanges:e=>this.addStepWithElement(e)},"android-extract-text":{stepData:{extractTextParamName:"value",extractTextMode:"entireString",autoScroll:true,exportScope:F.commonConstants.exportScopes.TEST},applyStepChanges:e=>this.addStepWithElement(e)},"android-set-text":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"ios-set-text":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e)},"android-code-verification":{stepData:async()=>{const e=await this.modalService.openFormModal({header:"Code Verification",items:{text:{props:{autoFocus:true},type:"textbox",label:"Insert value",value:"",validate:e=>{if(!e.trim()){return"Please insert a value"}return""}}}}).promise;if(!e){throw new te}return{text:e.text||""}}},"ios-extract-text":{stepData:{extractTextParamName:"value",extractTextMode:"entireString",autoScroll:true,exportScope:F.commonConstants.exportScopes.TEST},applyStepChanges:e=>this.addStepWithElement(e)},"accessibility-validation-step":{stepData:{},applyStepChanges:e=>this.addAccessibilityStep(e),isValidation:true},"negative-element-validation":{stepData:{},applyStepChanges:e=>this.addStepWithElement(e),isValidation:true},"checkbox-validation":{stepData:{autoScroll:true},applyStepChanges:e=>this.addStepWithElement(e),isValidation:true},"radio-validation":{stepData:{autoScroll:true},applyStepChanges:e=>this.addStepWithElement(e),isValidation:true},"css-prop-validation":{stepData:{autoScroll:true},applyStepChanges:async e=>{await this.addStepWithElement(e);const t=await this.modalService.openFormModal({header:"Css Property Validation",items:{cssPropName:{type:"textbox",label:"Property name",props:{placeholder:"e.g. color, background-color, font-family"},value:"",validate:e=>{if(!e){return"Missing property name"}return undefined}},expectedCssPropValue:{type:"textbox",label:"Expected value",props:{placeholder:"Expected value"},value:"",validate:e=>{if(!e){return"Missing expected value"}return undefined}}}}).promise;if(!t){throw new te}const{cssPropName:s,expectedCssPropValue:i}=t;e.step.update({cssPropName:{type:"evaluate-expression",expression:P.utils.escapeAndRemoveQuotes(s.trim())},expectedCssPropValue:{type:"evaluate-expression",expression:P.utils.escapeAndRemoveQuotes(i.trim())}})},isValidation:true},"html-attr-validation":{stepData:{autoScroll:true},applyStepChanges:async e=>{await this.addStepWithElement(e);const t=await this.modalService.openFormModal({header:"HTML Attribute Validation",items:{htmlAttrName:{type:"textbox",label:"Attribute name",props:{placeholder:"e.g. href, src, alt, title"},value:"",validate:e=>{if(!e){return"Missing attribute name"}return undefined}},expectedHtmlAttrValue:{type:"textbox",label:"Expected value",props:{placeholder:"Expected value"},value:""}}}).promise;if(!t){throw new te}const{htmlAttrName:s,expectedHtmlAttrValue:i}=t;const o=i.trim();e.step.update({htmlAttrName:{type:"evaluate-expression",expression:P.utils.escapeAndRemoveQuotes(s.trim())},expectedHtmlAttrValue:{type:"evaluate-expression",expression:P.utils.isRegExp(o)?o:P.utils.escapeAndRemoveQuotes(o)}})},isValidation:true},"random-value-generator":{stepData:{prefixExpression:se,suffixExpression:se}},"get-cookie":{stepData:{cookieName:se,variableName:"myCookie",exportScope:F.commonConstants.exportScopes.TEST}},"set-cookie":{stepData:{isNewCookie:true,cookieName:se,value:se,domain:se,path:se},editAfterAdding:true},navigation:{stepData:async({position:e})=>{const t=e===0&&!this.urlStateService.params.stepId;const s=await this.modalService.openFormModal({header:"Add Navigation Action",subHeader:t?"To change the test's base URL, update the test configuration in the first step's properties":undefined,items:{url:{props:{autoFocus:true},type:"textbox",label:"Enter URL (e.g http://www.google.com)",value:""},...this.featureFlagsService.flags.navigateInNewTab.isEnabled()&&{openInNewTab:{type:"checkbox",label:"Open URL in a new tab",value:false}}}}).promise;if(!(s===null||s===void 0?void 0:s.url)){return undefined}if(s===null||s===void 0?void 0:s.openInNewTab){this.analyticsService.track(this.analyticsService.NAVIGATE_NEW_TAB_EVENT)}return{targetElement:{isDocument:true},openInNewTab:s.openInNewTab,expression:P.utils.escapeText(s.url)}}},"sfdc-step-login":{stepData:()=>({name:"Log in",sfdcData:{type:"login"}}),editAfterAdding:true},"sfdc-step-loginas":{stepData:()=>({name:"Log in as",sfdcData:{type:"loginAs",useCurrentPageOnLogin:false,useCurrentPageOnLogout:false}}),editAfterAdding:true},"sfdc-step-launchapp":{stepData:()=>({name:"Launch app",sfdcData:{type:"launchApp"}}),editAfterAdding:true},"sfdc-step-logout":{stepData:()=>({name:"Log out",sfdcData:{type:"logout"}})},"sfdc-step-wait-for-page-load":{stepData:()=>({name:"Wait for page load",sfdcData:{type:"waitForSfdc"}})},"sfdc-step-closeconsoletabs":{stepData:()=>({name:"Close console tabs",sfdcData:{type:"closeConsoleTabs"}}),editAfterAdding:true},"sfdc-step-findrecord":{stepData:()=>({name:"Find and go to record",sfdcData:{type:"findRecord"}}),editAfterAdding:true},"sfdc-step-sobjectcreate":{stepData:()=>({name:"Create SObject",sfdcData:{type:"sobjectCreate"}}),editAfterAdding:true},"sfdc-step-sobjectedit":{stepData:({position:e})=>{var t,s,i;let o;let n;const r=["sfdc-step-findrecord","sfdc-step-sobjectcreate","sfdc-step-sobjectvalidate"];if(e&&e>0){n=(i=(s=(t=this.editedTestStore)===null||t===void 0?void 0:t.test)===null||s===void 0?void 0:s.scenario)===null||i===void 0?void 0:i.steps[e-1]}if(P.utils.isSfdcStep(n)&&r.includes(n.type||"")&&"sObjectPath"in n.sfdcData){o=n.sfdcData.sObjectPath}return{name:"Edit SObject",sfdcData:{type:"sobjectEdit",action:"editInline",sObjectPath:o}}},editAfterAdding:true},"sfdc-step-sobjectvalidate":{stepData:({position:e})=>{var t,s,i,o;let n;let r;let a;const c=["sfdc-step-findrecord","sfdc-step-sobjectcreate","sfdc-step-sobjectedit"];if(e&&e>0){a=(i=(s=(t=this.editedTestStore)===null||t===void 0?void 0:t.test)===null||s===void 0?void 0:s.scenario)===null||i===void 0?void 0:i.steps[e-1]}if(P.utils.isSfdcStep(a)&&c.includes(a.type||"")&&"sObjectPath"in a.sfdcData){n=a.sfdcData.sObjectPath;if(((o=this.productTourService.currentStep)===null||o===void 0?void 0:o.tourName)==="sfdc-create-first-test"&&"fieldData"in a.sfdcData){r=(a.sfdcData.fieldData||[]).map((e=>{if(e.action.mode==="fill"){return{...e,action:Q.DEFAULT_VERIFY_ACTION_MODE}}return e}))}}return{name:"Validate SObject",sfdcData:{type:"sobjectValidate",sObjectPath:n,fieldData:r,section:"details"}}},editAfterAdding:true},"sfdc-step-sobjectdelete":{stepData:()=>({name:"Delete SObject",sfdcData:{type:"sobjectDelete"}}),editAfterAdding:true},"sfdc-step-quickaction":{stepData:()=>({name:"Quick action",sfdcData:{type:"sobjectQuickAction"}}),editAfterAdding:true},"sfdc-document-validation":{stepData:()=>({name:"Document validation",sfdcData:{type:"documentValidationAction"}}),editAfterAdding:true},"sfdc-step-relatedlistaction":{stepData:()=>({name:"Related list action",sfdcData:{type:"relatedListAction"}}),editAfterAdding:true},"sfdc-step-convert-lead-to-opportunity":{stepData:()=>({name:"Convert lead to opportunity",sfdcData:{type:"convertLeadToOpportunity",account:{useDefault:true,sObjectPath:""},contact:{useDefault:true,sObjectPath:""},opportunity:{useDefault:true,sObjectPath:""}}}),editAfterAdding:true},"sfdc-step-apex-action":{stepData:{name:"Salesforce Apex action"},editAfterAdding:true},"sfdc-step-permission-validation":{stepData:()=>({name:"Permission validation",sfdcData:{type:"permissionValidationAction"}}),editAfterAdding:true},"sfdc-step-quotelineeditor":{stepData:()=>({name:"Quote line editor action",sfdcData:{type:"quoteLineEditorAction",rowFilterType:"row"}}),editAfterAdding:true},"sfdc-internal-test-step":{stepData:{name:"Internal JS test"}}};this.SHARED_STEP_ADDITION_MAPPING={"api-validation":{stepData:()=>({enablePostCode:true,sendViaWebApp:!this.projectsService.isMobile}),isValidation:true},"api-action":{stepData:()=>({enablePostCode:false,sendViaWebApp:!this.projectsService.isMobile})},"validation-code-step":{stepData:{}},"cli-wait-for-download-file":{stepData:{}},"wait-for-code-step":{stepData:{}},"action-code-step":{stepData:{}},"cli-wait-for-code-step":{stepData:{}},"cli-action-code-step":{stepData:{}},"email-validation-step":{stepData:{emailParamName:{type:"evaluate-expression",expression:"emailAddress"}},isValidation:true},"cli-validation-code-step":{stepData:{},isValidation:true},"cli-validation-download-file":{stepData:{},isValidation:true},"network-validation-step":{stepData:{},isValidation:true},"salesforce-apex-action":{stepData:{}},"accessibility-validation-shared-step":{stepData:{},applyStepChanges:e=>this.addAccessibilityStep(e),isValidation:true},"marketplace-wrapper":{stepData:{}},"execute-driver-script":{stepData:{}}}}async saveMfaSecretToStep(e,t){var s,i;const o=this.projectsService.projectId;const n=await this.modalService.openFormModal({header:(s=t===null||t===void 0?void 0:t.header)!==null&&s!==void 0?s:"MFA key",className:t===null||t===void 0?void 0:t.className,items:{mfaSecret:{type:"textbox",label:(i=t===null||t===void 0?void 0:t.label)!==null&&i!==void 0?i:"Multi-Factor Authentication key",props:{placeholder:"<my key>"},value:"",validate:P.utils.validateSalesforceMfaSecret}}}).promise;if(!n){throw new te}try{const{secretId:t}=await X.testimServices.secrets.saveSecret(o,n.mfaSecret);e.update({secrets:{mfaSecret:t}})}catch(e){ee.error("Failed to save MFA secret",e);throw new te}}async addStepByConfig(e,{stepData:t,isValidation:s,editAfterAdding:i,applyStepChanges:o},n,r,a){var c;t=await(typeof t==="function"?t({position:n}):t);if(!t){return undefined}if(a){t=Object.assign({},t,a)}const l=await this.addStep({stepData:{type:e,...t},parentId:r,position:n,addedFromUI:true});try{if(o&&l){await o({step:l,parentId:r,position:n})}}catch(e){if(e instanceof te){return this.recordingStore.deleteSteps((c=l===null||l===void 0?void 0:l.id)!==null&&c!==void 0?c:"")}throw e}if(s){this.onValidationAdded()}this.analyticsService.stepAddedFromMenu(e);l===null||l===void 0?void 0:l.setDirty();this.recordingStore.updateAUTStepsCount();ee.log(`${e} step created`,{stepData:t});if(i){this.recordingStore.openStepInEditor(l)}return l}async addSharedStepWithModal(e,{stepData:t,isValidation:s,applyStepChanges:i},o,n,r){var a,c;t=await(typeof t==="function"?t({position:o}):t);if(!t){return undefined}const l=await this.modalService.openModal(U.CreateSharedStepModal,{title:"Add step",entityTypeName:"step",okText:"Create step",cancelText:"Cancel"}).promise;if(!l){return undefined}const{stepName:u,allowReuse:d,parentFolderInfoId:p}=l;if(n){t=Object.assign({},t,n)}const h=this.addNewSharedStep(e,t,o,this.recordingStore.insertionContainer.id,u,{...r,hidden:!d});const f=(a=this.editedTestStore.scenario)===null||a===void 0?void 0:a.findStepById(h,true);if(s){this.onValidationAdded()}try{if(i&&f){const e=f.getStepContent();await i({step:e,parentId:e.parentId,position:o})}}catch(e){if(e instanceof te){this.recordingStore.deleteSteps((c=f===null||f===void 0?void 0:f.id)!==null&&c!==void 0?c:"");return undefined}throw e}this.analyticsService.stepAddedFromMenu(e);f===null||f===void 0?void 0:f.setDirty();this.recordingStore.updateAUTStepsCount();ee.log(`${e} step created`,{stepData:t});this.recordingStore.openStepInEditor(f);await this.moveStepFromRootToFolder({sharedStepInfoId:f.sharedStepInfoId,parentFolderInfoId:p});return f}async addStepByType({type:e,position:t,parentId:s,stepData:i,sharedStepInfoData:o}){const n=this.STEP_ADDITION_MAPPING[e];const r=this.SHARED_STEP_ADDITION_MAPPING[e];let a;this.editedTestStore.addStepLoaderAtPosition(t,s!==null&&s!==void 0?s:this.recordingStore.insertionContainer.id);if(n){a=await this.addStepByConfig(e,n,t,s,i)}if(r){a=await this.addSharedStepWithModal(e,r,t,i,o)}if(e==="group"){this.addGroup(t)}this.editedTestStore.removeStepLoaderAtPosition(t,s!==null&&s!==void 0?s:this.recordingStore.insertionContainer.id);return a}locatorMetadataGeneratorForUiStep(e){var t,s;return{stepData:(t=e===null||e===void 0?void 0:e.getSerializableObject)===null||t===void 0?void 0:t.call(e),resolution:(s=this.editedTestStore.test)===null||s===void 0?void 0:s.testConfig.resolution,projectId:this.projectsService.projectId,currentBranch:this.branchesService.branch,storageType:this.companiesService.storageType,storageBaseUrl:this.companiesService.storageBaseUrl}}addStepWithoutSync(e){const t=this.recordingStore.addStepWithoutSync(e);return this._addStep(t,e.addedFromUI)}async addStep(e){this.editedTestStore.addStepLoaderAtPosition(e.position,this.recordingStore.insertionContainer.id);const t=await this.recordingStore.addStep(e);this.editedTestStore.removeStepLoaderAtPosition(e.position,this.recordingStore.insertionContainer.id);return this._addStep(t,e.addedFromUI)}_addStep(e,t=false){if(!e){return undefined}if(t){this.trigger(F.commonConstants.scenario.ADD_STEP_MANUALLY,e)}const s=this.playbackStore.getAndDeletePendingResult(e.id);if(s){e.setResult(s)}return e}addNewSharedStep(e,t,s,i,o,n={}){const r=this.testController.addNewSharedStep({...t,type:e},s,i,o,n);this.hostService.sendAsync(F.commonConstants.scenario.PURGE_LAST_STEP_DATA);this.trigger(F.commonConstants.scenario.ADD_SHARED_STEP_MANUALLY,{sharedStepInstanceId:r.id});this.recordingStore.updateAUTStepsCount();return r.id}onValidationAdded(){const e="validations";if(!this.userService.getGuideTask(e)){this.analyticsService.track("progress-bar-beginner-validation-completed");this.userService.updateGuideTasks(e).catch((()=>{}))}}addGroup(e){const t=this.editorSelectionService.currentSelection;if(t.length>0&&this.recordingStore.insertionContainer!==this.editorSelectionService.selectedStepOrTestConfig){this.addGroupFromSelection()}else{this.addEmptyGroupWithNameModal(e)}}async addGroupFromSelection(){const e=this.editorSelectionService.currentSelection;const t=Boolean(this.projectsService.projectDefaults.saveStepSignatures);const s=this.branchesService.branch;const i=this.editedTestStore.test;if(!i){return}const o=i.isNewTest();const n=this.modalService;try{const i=await n.openModal(J.CreateGroupModal,{allowAutoGroup:t,currentBranch:s,isNewTest:o}).promise;if(!i){return}let r;if(i.replaceMode==="create"){const t=e.steps.map((e=>e.id));r=await this.createGroup({name:i.groupName,allowReuse:i.allowReuse,stepIds:t});await this.moveStepFromRootToFolder({sharedStepInfoId:r.sharedStepInfoId,parentFolderInfoId:i.parentFolderInfoId})}else{r=await this.replaceSelectionWithGroup(e,i.replacingStepId,i.replacingStepName)}if(i.shouldAutoGroup){await this.autoGroupingEditorService.processGroupCreation({...i,group:r});return}this.editorSelectionService.clearSelection();this.analyticsService.track(`${i.replaceMode}-group`)}catch(e){ee.error("addGroupFromSelection has thrown an error",e)}}async addEmptyGroupWithNameModal(e){const t=this.recordingStore.insertionContainer.getStepContent();const s=t.steps?t.steps.length:this.currentStepIndex();const i=typeof e==="number"?e:s;const o=await this.modalService.openModal(U.CreateSharedStepModal,{title:"Group Name",entityTypeName:"group",okText:"Confirm",cancelText:"Cancel"}).promise;if(!o){return undefined}this.analyticsService.track("create-group");const n=await this.addEmptyGroup(i,t.id,{allowReuse:o.allowReuse,name:o.stepName});await this.moveStepFromRootToFolder({sharedStepInfoId:n.sharedStepInfoId,parentFolderInfoId:o.parentFolderInfoId});return n}async addEmptyGroup(e,t,{name:s,allowReuse:i}){return this.createGroup({name:s,allowReuse:i,stepIds:[],parentId:t,position:e})}currentStepIndex(){var e;if(this.editorSelectionService.selectedStepOrTestConfig instanceof K.TestConfig){return 0}let t;const s=((e=this.editedTestStore.scenario)===null||e===void 0?void 0:e.steps)||[];for(t=0;t<s.length;t++){if(this.editorSelectionService.selectedStepOrTestConfig===s[t]){return t+1}}return t}async createGroup({name:e,allowReuse:t,stepIds:s,position:i,parentId:o}){const n=this.testController.groupSteps(s,{name:e||"untitled group",allowReuse:t,parentId:o,position:i});this.trigger(F.commonConstants.scenario.ADD_GROUP_MANUALLY);await this.recordingStore.updateAUTStepsCount();return n}async replaceSelectionWithGroup(e,t,s){const i=e.steps.map((e=>e.id));const o={steps:e.steps,name:s||"",sharedStepInfoId:t};const n=e.parent;const r=Math.min(...i.map((e=>n.findStepIndex({id:e}))));this.recordingStore.deleteSteps(i);await this.addSharedStepInstance({sharedStepInfoId:t,classType:"group",name:s,position:r,parentId:n.id});this.trigger(F.commonConstants.scenario.ADD_GROUP_MANUALLY);return o}async addSharedStepInstance({sharedStepInfoId:e,classType:t,name:s,position:i,parentId:o}){const n={type:"shared-step-instance",sharedStepInfoId:e,classType:t,name:s};const r=await this.addStep({stepData:n,parentId:o,position:i});return r}async moveStepFromRootToFolder({sharedStepInfoId:e,parentFolderInfoId:t}){if(!t){return undefined}return this.foldersStore.addChildrenToFolder({treeType:"sharedSteps",folderInfoId:t,children:[{type:F.FOLDER_CHILD_TYPES.SHARED_STEP,id:e}]})}addStepWithElement(e){return this.setStepLocator(e,"addStepWithElement")}async setStepLocator({step:e,parentId:t,position:s},i,o){t||(t=this.recordingStore.insertionContainer.id);try{await this.hostService.send(i,{stepId:e.id,type:e.type,...o})}catch(i){const o=(t,s)=>{var i,o;if(!I.isNumber(s)){return null}let n=null;const r=(i=this.editedTestStore.scenario.findStepById(t,true))===null||i===void 0?void 0:i.getStepContent();if(r&&Array.isArray(r.steps)){const t=r.steps.filter((t=>t.id!==e.id));if(s>=t.length){s-=1}s=Math.max(0,s);n=(o=t[s])===null||o===void 0?void 0:o.id}return n};const n=o(t,s);const r=n?{stepId:n}:undefined;this.notificationDisplayService.sendNotification(i instanceof Error?i.message:i,r);throw new te}if(!e.element){throw new te}}addAccessibilityStep(e){if(e.step.mode==="element"){return this.addStepWithElement(e)}return this.setStepLocator(e,F.commonConstants.scenario.ADD_ACCESSIBILITY_PAGE_VALIDATION_STEP,{stepData:e.step.getSerializableObject(),storageType:this.companiesService.storageType,storageBaseUrl:this.companiesService.storageBaseUrl})}mobileAttributeValidation(){return{stepData:{},applyStepChanges:async e=>{await this.addStepWithElement(e);const t=await this.modalService.openFormModal({header:"Element Attribute Validation",items:{attrName:{type:"textbox",label:"Attribute name",props:{placeholder:"e.g. checkable, checked, {class,className}, clickable"},value:"",validate:e=>{if(!e){return"Missing attribute name"}return undefined}},expectedAttrValue:{type:"textbox",label:"Expected value",props:{placeholder:"Expected value"},value:""}}}).promise;if(!t){throw new te}const{attrName:s,expectedAttrValue:i}=t;const o=i.trim();e.step.update({attrName:{type:"evaluate-expression",expression:P.utils.escapeAndRemoveQuotes(s.trim())},expectedAttrValue:{type:"evaluate-expression",expression:P.utils.isRegExp(o)?o:P.utils.escapeAndRemoveQuotes(o)}})},isValidation:true}}};t.StepsAdder=ie;i([C.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],ie.prototype,"addStepWithoutSync",null);i([C.action,o("design:type",Function),o("design:paramtypes",[Object,Object]),o("design:returntype",void 0)],ie.prototype,"_addStep",null);t.StepsAdder=ie=i([(0,A.injectable)(),o("design:paramtypes",[typeof(n=typeof O.RecordingStore!=="undefined"&&O.RecordingStore)==="function"?n:Object,typeof(r=typeof j.ModalService!=="undefined"&&j.ModalService)==="function"?r:Object,typeof(a=typeof w.AnalyticsService!=="undefined"&&w.AnalyticsService)==="function"?a:Object,typeof(c=typeof Y.EditorHostService!=="undefined"&&Y.EditorHostService)==="function"?c:Object,typeof(l=typeof x.FeatureFlagsService!=="undefined"&&x.FeatureFlagsService)==="function"?l:Object,typeof(u=typeof M.UserService!=="undefined"&&M.UserService)==="function"?u:Object,typeof(d=typeof N.ProjectsService!=="undefined"&&N.ProjectsService)==="function"?d:Object,typeof(p=typeof k.BranchesService!=="undefined"&&k.BranchesService)==="function"?p:Object,typeof(h=typeof L.CompaniesService!=="undefined"&&L.CompaniesService)==="function"?h:Object,typeof(f=typeof B.NotificationDisplayService!=="undefined"&&B.NotificationDisplayService)==="function"?f:Object,typeof(m=typeof G.EditorSelectionService!=="undefined"&&G.EditorSelectionService)==="function"?m:Object,typeof(g=typeof H.EditedTestStore!=="undefined"&&H.EditedTestStore)==="function"?g:Object,typeof(v=typeof W.PlaybackStore!=="undefined"&&W.PlaybackStore)==="function"?v:Object,typeof(S=typeof q.FoldersStore!=="undefined"&&q.FoldersStore)==="function"?S:Object,typeof(y=typeof z.AutoGroupingEditorService!=="undefined"&&z.AutoGroupingEditorService)==="function"?y:Object,typeof(b=typeof D.TestController!=="undefined"&&D.TestController)==="function"?b:Object,typeof(_=typeof Z.UrlStateService!=="undefined"&&Z.UrlStateService)==="function"?_:Object,typeof(T=typeof V.ProductTourService!=="undefined"&&V.ProductTourService)==="function"?T:Object])],ie)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IdSelector=void 0;const i=s(54);const o=s(105);const n=s(76);const r=s(132);const a=.3;const c=.9;class l extends o.CSSSelector{constructor(e,t){var s;super(e,t);this.useFixedEscapeId=false;this.elementId=e.elementId;this.useFixedEscapeId=e.useFixedEscapeId||false;this.userDefinedElementId=e.userDefinedElementId;this.evaluatedId=e.elementId;this.valueMatchingMethod=(s=e.valueMatchingMethod)!==null&&s!==void 0?s:{name:"Equals"}}isEdited(){return this._isValueEdited(this.userDefinedElementId)}evaluateComputedProperties(e){this.evaluatedId=e.executeOrDefault(this.elementId,this.userDefinedElementId)}updateMappedProperty(e,t){this.userDefinedElementId=e;this.valueMatchingMethod=t}getType(){return"IdSelector"}effectiveElementId(){return(0,n.displayFormat)(this.elementId,this.userDefinedElementId)}getDisplayValue(){return this.effectiveElementId()}_equals(e){if(e instanceof l){return this.elementId===e.elementId&&this.userDefinedElementId===e.userDefinedElementId&&this.valueMatchingMethod.name===e.valueMatchingMethod.name&&super._equals(e)}return false}getEscapedId(){return this.useFixedEscapeId?i.injectorUtils.escapeIDV2(this.evaluatedId):i.injectorUtils.escapeID(this.evaluatedId)}isSelectorValid(e){const t=e.getAttribute("id");if(t===null){return false}return(0,r.isValueMatched)(this.getEscapedId(),[t],this.valueMatchingMethod.name)}getQuery(){const e=this.valueMatchingMethod.name;return r.MATCHING_METHOD_DEFINITION[e].asSelector("id",this.getEscapedId())}getMatcherDescriptor(){return{key:"id",value:this.effectiveElementId()}}getDisplayName(){return this.valueMatchingMethod.name==="Equals"?"Id":`Id (${this.valueMatchingMethod.name})`}computeInitialScore(e){const{elementId:t}=e;if(t.match(/\d+/)){return a}return c}getSelfScore(){if(this.selfScore!==null){return this.selfScore}return this.computeInitialScore({elementId:this.effectiveElementId()})}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{valueMatchingMethod:{type:"dropdown",value:{...this.valueMatchingMethod,value:this.valueMatchingMethod.name},label:"Match If",props:{searchable:false,options:r.MATCHING_METHOD_OPTIONS_WITH_VALUES,appendToBody:true},validate:e=>e?undefined:"The Matching method is required"},userDefinedElementId:{type:"textbox",value:(0,n.scriptFormat)(this.elementId,this.userDefinedElementId),label:"Element ID",props:{autoFocus:true,placeholder:"identifier"},validate:e=>e.trim()?undefined:"The Element ID is required"}}}}updateProperties(e){const{userDefinedElementId:t,valueMatchingMethod:s}=e;this.valueMatchingMethod=s;if(typeof t==="string"){this.userDefinedElementId=t}return true}serialize(){return{...super.serialize(),elementId:this.elementId,useFixedEscapeId:this.useFixedEscapeId,userDefinedElementId:this.userDefinedElementId,valueMatchingMethod:{name:this.valueMatchingMethod.name}}}}t.IdSelector=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CSSClassSelector=void 0;const i=s(54);const o=s(132);const n=s(105);const r=s(76);const a=.5;class c extends n.CSSSelector{constructor(e,t){var s;super(e,t);this.cssClassName=e.cssClassName;this.userDefinedCssClassName=e.userDefinedCssClassName;this.evaluatedCssClassName=this.cssClassName;this.valueMatchingMethod=(s=e.valueMatchingMethod)!==null&&s!==void 0?s:{name:"Equals"}}isEdited(){return this._isValueEdited(this.userDefinedCssClassName)}getType(){return"CSSClassSelector"}effectiveCssClassName(){return(0,r.displayFormat)(this.cssClassName,this.userDefinedCssClassName)}evaluateComputedProperties(e){this.evaluatedCssClassName=e.executeOrDefault(this.cssClassName,this.userDefinedCssClassName)}updateMappedProperty(e,t){this.userDefinedCssClassName=e;this.valueMatchingMethod=t}getEscapedCssClassName(){return i.injectorUtils.escapeClass(this.evaluatedCssClassName)}getMatcherDescriptor(){return{key:"class",value:this.cssClassName}}getDisplayName(){return this.valueMatchingMethod.name==="Equals"?"Class":`Class (${this.valueMatchingMethod.name})`}getDisplayValue(){return this.effectiveCssClassName()}_matches(e){if(e instanceof c){return this.cssClassName===e.cssClassName&&this.userDefinedCssClassName===e.userDefinedCssClassName&&this.valueMatchingMethod.name===e.valueMatchingMethod.name&&super._matches(e)}return false}isSelectorValid(e){return(0,o.isValueMatched)(this.getEscapedCssClassName(),Array.from(e.classList),this.valueMatchingMethod.name)}getQuery(){const e=this.getValueMatchingMethod().name;if(e==="Equals"){return`.${this.getEscapedCssClassName()}`}let t=o.MATCHING_METHOD_DEFINITION[e].asSelector("class",this.getEscapedCssClassName());if(["Ends with","Starts with"].includes(e)){const s=e==="Starts with"?` ${this.getEscapedCssClassName()}`:`${this.getEscapedCssClassName()} `;t=`${t}, ${o.MATCHING_METHOD_DEFINITION.Contains.asSelector("class",s)}`}return t}getValueMatchingMethod(){return this.valueMatchingMethod}computeInitialScore(){return a}getSelfScore(){if(this.selfScore!==null){return this.selfScore}return this.computeInitialScore()}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{valueMatchingMethod:{type:"dropdown",value:{...this.valueMatchingMethod,value:this.valueMatchingMethod.name},label:"Match If",props:{searchable:false,options:o.MATCHING_METHOD_OPTIONS_WITH_VALUES,appendToBody:true},validate:e=>e?undefined:"The Matching method is required"},userDefinedCssClassName:{type:"textbox",value:(0,r.scriptFormat)(this.cssClassName,this.userDefinedCssClassName),label:"CSS Class",props:{autoFocus:true,placeholder:"identifier"},validate:e=>e.trim()?undefined:"The CSS Class is required"}}}}updateProperties(e){const{userDefinedCssClassName:t,valueMatchingMethod:s}=e;if(typeof t==="string"){this.userDefinedCssClassName=t}this.valueMatchingMethod=s;if(this.isAutomap){this.isAutomap=false}return true}serialize(){return{...super.serialize(),cssClassName:this.cssClassName,userDefinedCssClassName:this.userDefinedCssClassName,valueMatchingMethod:{name:this.valueMatchingMethod.name}}}}t.CSSClassSelector=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AttributeSelector=void 0;const i=s(105);const o=s(76);const n=s(132);const r=.5;const a=.15;const c=.65;const l=e=>e==="href"?{name:"Ends with"}:{name:"Equals"};class u extends i.CSSSelector{constructor(e,t){var s;super(e,t);this.attributeName=e.attributeName;this.attributeValue=e.attributeValue;this.valueMatchingMethod=(s=e.valueMatchingMethod)!==null&&s!==void 0?s:l(e.attributeName);this.userDefinedAttributeName=e.userDefinedAttributeName;this.userDefinedAttributeValue=e.userDefinedAttributeValue;this.evaluatedAttributeName=this.attributeName;this.evaluatedAttributeValue=this.attributeValue}isEdited(){return this._isValueEdited(this.userDefinedAttributeName)||this._isValueEdited(this.userDefinedAttributeValue)}evaluateComputedProperties(e){this.evaluatedAttributeName=e.executeOrDefault(this.attributeName,this.userDefinedAttributeName);this.evaluatedAttributeValue=e.executeOrDefault(this.attributeValue,this.userDefinedAttributeValue)}getType(){return"AttributeSelector"}updateMappedProperty(e,t){this.userDefinedAttributeValue=e;this.valueMatchingMethod=t}effectiveAttributeName(){return(0,o.displayFormat)(this.attributeName,this.userDefinedAttributeName)}effectiveAttributeValue(){return(0,o.displayFormat)(this.attributeValue,this.userDefinedAttributeValue)}getMatcherDescriptor(){return{key:this.attributeName,value:this.attributeValue}}getDisplayName(){const e=this.effectiveAttributeName();return this.valueMatchingMethod.name==="Equals"?e:`${e} (${this.valueMatchingMethod.name})`}getDisplayValue(){return this.effectiveAttributeValue()}_equals(e){if(e instanceof u){return this.attributeValue===e.attributeValue&&this.userDefinedAttributeValue===e.userDefinedAttributeValue&&this.valueMatchingMethod.name===e.valueMatchingMethod.name&&super._equals(e)}return false}_matches(e){if(e instanceof u){return this.attributeName===e.attributeName&&this.userDefinedAttributeName===e.userDefinedAttributeName&&super._matches(e)}return false}isSelectorValid(e){const t=this.getAttributeName();const s=this.getAttributeValue();const i=e.getAttribute(t);if(i===null){return false}return(0,n.isValueMatched)(s,[i],this.valueMatchingMethod.name)}getQuery(){const e=this.getAttributeName();const t=this.getAttributeValue();const s=this.getAttributeValueMatchingMethod();return n.MATCHING_METHOD_DEFINITION[s.name].asSelector(e,t)}getAttributeName(){function e(e,t,s){function i(e){return e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}return e.replace(new RegExp(i(t),"g"),s)}return this.evaluatedAttributeName.includes(":")?e(this.evaluatedAttributeName,":","\\:"):this.evaluatedAttributeName}getAttributeValue(){return this.evaluatedAttributeValue}getAttributeValueMatchingMethod(){return this.valueMatchingMethod}computeInitialScore(e){const{attributeName:t,attributeValue:s}=e;if(this.metaData.salesForceSelectrorFix&&t==="role"){return c}if(t.match(/\d+$/)||s.match(/\d+$/)){return a}return r}getSelfScore(){const e={attributeName:this.effectiveAttributeName(),attributeValue:this.effectiveAttributeValue()};if(this.selfScore!==null){if(this.metaData.salesForceSelectrorFix&&e.attributeName==="role"&&this.selfScore===r){return c}return this.selfScore}return this.computeInitialScore(e)}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{userDefinedAttributeName:{type:"textbox",value:(0,o.scriptFormat)(this.attributeName,this.userDefinedAttributeName),label:"Attribute Name",validate:e=>e.trim()?undefined:"The Attribute Name is required.",props:{autoFocus:true,placeholder:"attribute name"}},valueMatchingMethod:{type:"dropdown",value:{...this.valueMatchingMethod,value:this.valueMatchingMethod.name},label:"Match If",props:{searchable:false,options:n.MATCHING_METHOD_OPTIONS_WITH_VALUES,appendToBody:true},validate:e=>e?undefined:"The Matching method is required"},userDefinedAttributeValue:{type:"textbox",value:(0,o.scriptFormat)(this.attributeValue,this.userDefinedAttributeValue),label:"Value",validate:e=>e.trim()?undefined:"The Value is required",props:{autoFocus:false,placeholder:"attribute value"}}}}}updateProperties(e){this.userDefinedAttributeName=e.userDefinedAttributeName;this.userDefinedAttributeValue=e.userDefinedAttributeValue;this.valueMatchingMethod=e.valueMatchingMethod;return true}serialize(){return{...super.serialize(),attributeName:this.attributeName,attributeValue:this.attributeValue,valueMatchingMethod:{name:this.valueMatchingMethod.name},userDefinedAttributeName:this.userDefinedAttributeName,userDefinedAttributeValue:this.userDefinedAttributeValue}}}t.AttributeSelector=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TextContentSelector=void 0;const i=s(64);const o=s(76);const n=.6;class r extends i.RelativeSelector{constructor(e,t){super(e,t);this.textContent=e.textContent;this.userDefinedTextContent=e.userDefinedTextContent;this.evaluatedTextContent=this.textContent}isEdited(){return this._isValueEdited(this.userDefinedTextContent)}getType(){return"TextContentSelector"}getDisplayName(){return"Content"}evaluateComputedProperties(e){this.evaluatedTextContent=e.executeOrDefault(this.textContent,this.userDefinedTextContent)}getDisplayValue(){return(0,o.displayFormat)(this.textContent,this.userDefinedTextContent)}_equals(e){if(e instanceof r){return this.textContent===e.textContent&&e.userDefinedTextContent===this.userDefinedTextContent&&super._equals(e)}return false}isSelectorValid(e){const t=this.evaluatedTextContent;if(e.textContent===null){return e.textContent===t}return e.textContent.trim()===t}findElements(e){const t=e.getActualElement();const s=t.querySelectorAll("*");const i=s.length;const o=[];for(let e=0;e<i;e++){if(this.isSelectorValid(s[e])){o.push(s[e])}}return o}computeInitialScore(){return n}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{...super.serialize(),textContent:this.textContent,userDefinedTextContent:this.userDefinedTextContent}}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{userDefinedTextContent:{type:"textbox",value:(0,o.scriptFormat)(this.textContent,this.userDefinedTextContent),label:"Text Content",props:{autoFocus:true,placeholder:"text content"},validate:e=>e.trim()?undefined:"The Text Content is required"}}}}updateProperties(e){this.userDefinedTextContent=e.userDefinedTextContent;return true}}t.TextContentSelector=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InnerTextSelector=void 0;const i=s(54);const o=s(64);const n=s(76);const r=s(53);const a=s(132);const c=.9;class l extends o.RelativeSelector{constructor(e,t){var s;super(e,t);this.directInnerText=e.directInnerText;this.updatedInnerText=e.updatedInnerText;this.userDefinedInnerText=e.userDefinedInnerText;this.evaluatedInnerText=this.updatedInnerText||this.directInnerText;this.cachedExpression=undefined;this.valueMatchingMethod=(s=e.valueMatchingMethod)!==null&&s!==void 0?s:{name:"Equals"}}isEdited(){return this._isValueEdited(this.userDefinedInnerText)}get expression(){if(this.cachedExpression===undefined){try{const e=this.getRawInnerText();this.cachedExpression=i.injectorUtils.isRegExp(e)?i.injectorUtils.getRegExp(e):null}catch(e){this.cachedExpression=null}}return this.cachedExpression}getType(){return"InnerTextSelector"}getRawInnerText(){return this.updatedInnerText||this.directInnerText}getInnerText(){if(this.userDefinedInnerText){return this.evaluatedInnerText}return this.getRawInnerText()}getDisplayName(){if(this.valueMatchingMethod.name==="Equals"){return"Text"}return`Text (${this.valueMatchingMethod.name})`}getDisplayValue(){return(0,n.displayFormat)(this.getRawInnerText(),this.userDefinedInnerText)||""}evaluateComputedProperties(e){this.evaluatedInnerText=e.executeOrDefault(this.directInnerText,this.userDefinedInnerText)}_equals(e){if(e instanceof l){return this.userDefinedInnerText===e.userDefinedInnerText&&this.valueMatchingMethod.name===e.valueMatchingMethod.name&&this.getRawInnerText()===e.getRawInnerText()&&super._equals(e)}return false}isSelectorValid(e){var t;if(this.userDefinedInnerText||this.valueMatchingMethod.name!=="Equals"){const t=r.locatorBuilderUtils.getDirectInnerText(e);if(typeof t!=="string"||typeof this.evaluatedInnerText!=="string"){return false}const s=i.injectorUtils.clearWhiteSpaces(t);const o=i.injectorUtils.clearWhiteSpaces(this.evaluatedInnerText);return(0,a.isValueMatched)(o,[s],this.valueMatchingMethod.name)}const s=this.updatedInnerText?i.injectorUtils.getElementTextContent(e,(t=this.metaData)===null||t===void 0?void 0:t.ignoreHiddenTagsText):r.locatorBuilderUtils.getDirectInnerText(e);return this.expression?this.expression.test(s):i.injectorUtils.compareTexts(s,String(this.getRawInnerText()))}keepOnlyLeafNodes(e){const t=t=>e.find((e=>e!==t&&t.contains(e)));return e.filter((e=>!t(e)))}isNonTextableElement(e){const t=i.injectorUtils.getTagName(e);const s=["script","style","meta"];if(s.includes(t)){return true}const o=["audio","canvas","circle","ellipse","image","line","path","polygon","polyline","rect","video"];if(o.includes(t)&&e.childElementCount===0){return true}return false}findElements(e){const t=e.getActualElement();const s=t.querySelectorAll("*");const o=s.length;const n=[];const r=[];for(let e=0;e<o;e++){if(this.isNonTextableElement(s[e])){continue}if(this.isSelectorValid(s[e])){const t=this.userDefinedInnerText||this.valueMatchingMethod.name!=="Equals";if(!t&&this.updatedInnerText&&i.injectorUtils.isTextElement(s[e])){r.push(s[e])}else{n.push(s[e])}}}return this.keepOnlyLeafNodes(n).concat(r)}computeInitialScore(){return c}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{...super.serialize(),directInnerText:(this.directInnerText||"").toString(),userDefinedInnerText:this.userDefinedInnerText,valueMatchingMethod:{name:this.valueMatchingMethod.name}}}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{valueMatchingMethod:{type:"dropdown",value:{...this.valueMatchingMethod,value:this.valueMatchingMethod.name},label:"Match If",props:{searchable:false,options:a.MATCHING_METHOD_OPTIONS_WITH_VALUES,appendToBody:true},validate:e=>e?undefined:"The Matching method is required"},userDefinedInnerText:{type:"textbox",value:(0,n.scriptFormat)(this.getRawInnerText(),this.userDefinedInnerText),label:"Inner Text",props:{autoFocus:true,placeholder:"identifier"},validate:e=>e.trim()?undefined:"The Inner text is required"}}}}updateProperties(e){this.userDefinedInnerText=e.userDefinedInnerText;this.valueMatchingMethod=e.valueMatchingMethod;return true}}t.InnerTextSelector=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UrlSelector=void 0;const i=s(64);const o=.4;class n extends i.RelativeSelector{constructor(e,t){super(e,t);this.isSelectorValid=e=>{const t=e.getAttribute(this.attributeName);return t?this.matchUrls(this.attributeValue,t):false};this.attributeName=e.attributeName;this.attributeValue=e.attributeValue;this.tagName=e.tagName}getType(){return"UrlSelector"}getDisplayName(){return`${this.tagName}:${this.attributeName}`}getDisplayValue(){return this.attributeValue}_equals(e){return this.matchUrls(this.attributeValue,e.attributeValue)&&super._equals(e)}_matches(e){const t=["attributeName","tagName"];const s=t.filter((t=>e[t]===this[t]));return s.length===t.length&&super._matches(e)}matchUrls(e,t){let s;let i;try{s=a(e,this.dom.TESTIM_URL||{});i=a(t,this.dom.TESTIM_URL||{})}catch(s){return e===t}const o=s.hash===i.hash;const n=s.hostname===i.hostname;const r=c(s.pathname.slice(1),i.pathname.slice(1));return o&&r&&n}findElements(e){const t=e.getActualElement();if(!t){return[]}const s=t.querySelectorAll(`${this.tagName}[${this.attributeName}]`);return Array.prototype.filter.call(s,this.isSelectorValid)}computeInitialScore(){return o}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{...super.serialize(),attributeName:this.attributeName,attributeValue:this.attributeValue,tagName:this.tagName}}}t.UrlSelector=n;function r(e){if(/^[a-zA-Z]:\\/.test(e)){return false}return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(e)}function a(e,t){const{hash:s,pathname:i,hostname:o}=r(e)?new URL(e):new URL(`http://${t.hostname.replace(/\/$/,"")}/${e}`);return{hash:s,pathname:i,hostname:o}}function c(e,t){if(e===""||e==="/"||t===""||e==="/"){return e===t}return l(e,t)}function l(e,t){return e.endsWith(t)||t.endsWith(e)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HTMLSelector=void 0;const i=s(245);class o extends i.DomRootRelativeSelector{getType(){return"HTMLSelector"}getDisplayName(){return"HTML"}isSelectorValid(e){if(e.ownerDocument.body){return e.ownerDocument.body.parentElement===e}return e.ownerDocument.documentElement===e}locate(){if(this.dom.body){const e=this.dom.body.parentElement;return this._elementToLocateResult(e)}return this._elementToLocateResult(this.dom.documentElement)}findElements(){if(this.dom.body){return[this.dom.body.parentElement]}return[this.dom.documentElement]}}t.HTMLSelector=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BodySelector=void 0;const i=s(245);class o extends i.DomRootRelativeSelector{getType(){return"BodySelector"}getDisplayName(){return"Body"}isSelectorValid(e){return e.ownerDocument.body===e}locate(){const e=this.dom.body;return this._elementToLocateResult(e)}findElements(){return[this.dom.body]}}t.BodySelector=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NthTagSelector=void 0;const i=s(244);const o=s(64);const n=s(53);const r=s(54);const{getTagName:a}=r.injectorUtils;class c extends o.RelativeSelector{constructor(e,t){super(e,t);this.tagSelector=new i.TagSelector(Object.assign(e.tag,{dom:e.dom}),t);this.index=e.nth.index;this.siblingCount=e.nth.siblingCount}hasUserDefinedIndex(){return false}static get TYPE(){return"NthTagSelector"}getType(){return c.TYPE}findElements(e){return this._findElementsFromElement(e.getActualElement())}_childrenWithTag(e){return[...e.children].filter((e=>a(e,true)===this.tagSelector.tagName))}_findElementsFromElement(e){const t=this._childrenWithTag(e);if(this.index>=t.length){return[]}return[t[this.index]]}getDisplayName(){return"Nth Tag"}getDisplayValue(){return`${this.index+1}/${this.siblingCount} ${this.tagSelector.getDisplayValue()}`}_enrichResultSelectorResultData(e){const t=!n.locatorBuilderUtils.isEmptyResult(e.find(Boolean).element)&&this.siblingCount!==this._childrenWithTag(e[0].element).length;return{isDifferentSiblingCount:Boolean(t)}}_equals(e){return this.index===e.index&&this.siblingCount===e.siblingCount&&super._equals(e)&&this.tagSelector._equals(e.tagSelector)}isSelectorValid(e){return Boolean(this._findElementsFromElement(e).length)}computeInitialScore(){return.4}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{tag:this.tagSelector.serialize(),...super.serialize(),nth:{index:this.index,siblingCount:this.siblingCount}}}}t.NthTagSelector=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StyleSelector=void 0;const i=s(64);const o=.2;class n extends i.RelativeSelector{constructor(e){super(e);this.style=e.style}getType(){return"StyleSelector"}findElements(e){const t=e.getActualElement();const s=t.querySelectorAll("[style]");const i=s.length;const o=[];for(let e=0;e<i;e++){const t=this.getStyleName();const i=this.getStyleValue();const n=s[e].style;if(n[t]===i){o.push(s[e])}}return o}getDisplayName(){return"Style"}getDisplayValue(){return this.style}getStyleName(){return this.style.split(":")[0].trim()}getStyleValue(){return this.style.split(":").slice(1).join(":").trim()}isMatchable(){if(this.style===""){return false}return super.isMatchable()}_matches(e){if(!this.style||!e.style){return false}const t=this.getStyleName();const s=e.getStyleName();return t===s&&super._matches(e)}_equals(e){const t=this.getStyleValue();const s=e.getStyleValue();return t===s&&super._equals(e)}isSelectorValid(e){return e.style===this.style}computeInitialScore(){return o}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{...super.serialize(),style:this.style}}getMatcherDescriptor(){return{key:"style",value:this.style}}}t.StyleSelector=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NthChildSelector=void 0;const i=s(53);const o=s(64);const n=.1;const r={TOP:"top",BOTTOM:"bottom"};class a extends o.RelativeSelector{constructor(e){super(e);this.index=e.index;this.siblingCount=e.siblingCount;this.reverseIndex=e.reverseIndex||false;this.userDefinedIndex=e.userDefinedIndex}static get TYPE(){return"NthChildSelector"}isEdited(){return this.hasUserDefinedIndex()||this.reverseIndex}hasUserDefinedIndex(e=this){return!Number.isNaN(Number.parseInt(e.userDefinedIndex,10))}getType(){return a.TYPE}getDisplayName(){return"Index"}_enrichResultSelectorResultData(e){const t=!i.locatorBuilderUtils.isEmptyResult(e.find(Boolean).element)&&this.siblingCount!==e[0].element.parentNode.childElementCount;return{isDifferentSiblingCount:Boolean(t)}}mergeSelector(e,...t){if(this.hasUserDefinedIndex(e)){this.reverseIndex=e.reverseIndex;this.userDefinedIndex=e.userDefinedIndex}super.mergeSelector(e,...t)}_equals(e){let t;if(!this.hasUserDefinedIndex()&&!this.hasUserDefinedIndex(e)){t=this.index===e.index}else if(!this.hasUserDefinedIndex()){t=e.reverseIndex?e.userDefinedIndex===this.siblingCount-this.index+1:e.userDefinedIndex===this.index}else if(!this.hasUserDefinedIndex(e)){t=this.reverseIndex?this.userDefinedIndex===e.siblingCount-e.index+1:this.userDefinedIndex===e.index}else{t=this.reverseIndex===e.reverseIndex&&this.userDefinedIndex===e.userDefinedIndex}return t&&super._equals(e)}getDisplayValue(){const e=this.reverseIndex?"from bottom":"from top";const t=!this.hasUserDefinedIndex()?`${this.index+1}/${this.siblingCount}`:this.userDefinedIndex+1;return`${t} ${e}`}isEditable(){return true}getEditablePropertiesObject(){return{header:"Edit Locator",items:{userDefinedIndex:{type:"textbox",value:(!this.hasUserDefinedIndex()?this.index:this.userDefinedIndex)+1,label:"Index number",props:{autoFocus:true,placeholder:"index",type:"number"},validate:e=>parseInt(e,10)>0?undefined:"The Index number is required"},reverseIndex:{type:"radiobuttonGroup",props:{options:{top:{title:"Top"},bottom:{title:"Bottom"}}},label:"From:",value:this.reverseIndex?r.BOTTOM:r.TOP,inline:true}}}}updateProperties(e){const{userDefinedIndex:t,reverseIndex:s}=e;if(!this.hasUserDefinedIndex({userDefinedIndex:t})){return false}this.userDefinedIndex=Math.max(t-1,0);this.reverseIndex=s;return true}isSelectorValid(e){return e.parentNode?Array.prototype.indexOf.call(e.parentNode.children,e)===this.index:false}findElements(e){const t=e.getActualElement().children;if(t.length===0){return[]}let s=!this.hasUserDefinedIndex()?this.index:this.userDefinedIndex;if(this.reverseIndex===true){s=Math.max(t.length-1-s,0)}else{s=Math.min(s,t.length-1)}return[t[s]]}computeInitialScore(){return n}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{...super.serialize(),index:this.index,siblingCount:this.siblingCount,reverseIndex:this.reverseIndex,userDefinedIndex:this.userDefinedIndex}}}t.NthChildSelector=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UrlQueryParamSelector=void 0;const i=s(64);const o=.6;class n extends i.RelativeSelector{constructor(e){super(e);this.isSelectorValid=e=>{const t=e.getAttribute(this.attributeName);return t?this.isContainsQueryParam(t):false};this.queryParamName=e.queryParamName;this.queryParamValue=e.queryParamValue;this.attributeName=e.attributeName;this.tagName=e.tagName}getType(){return"UrlQueryParamSelector"}getDisplayName(){return"Query param"}getDisplayValue(){return`${this.queryParamName} = ${this.queryParamValue}`}_equals(e){return this.queryParamValue===e.queryParamValue&&super._equals(e)}_matches(e){const t=["queryParamName","attributeName","tagName"];const s=t.filter((t=>e[t]===this[t]));return s.length===t.length&&super._matches(e)}isContainsQueryParam(e){try{const t=new URL(e);let s=t.search||t.query||"";s=s.replace(/^\?/,"");const i=s.split("&").find((e=>e.startsWith(`${this.queryParamName}=`)));return i?i.split("=")[1]===this.queryParamValue:false}catch(e){return false}}findElements(e){const t=e.getActualElement();if(!t){return[]}const s=t.querySelectorAll(`${this.tagName}[${this.attributeName}]`);return Array.prototype.filter.call(s,this.isSelectorValid)}computeInitialScore(){return o}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}serialize(){return{...super.serialize(),queryParamName:this.queryParamName,queryParamValue:this.queryParamValue,attributeName:this.attributeName,tagName:this.tagName}}}t.UrlQueryParamSelector=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChildSelector=void 0;const i=s(7);const o=s(53);const n=s(64);const r=i.Logger.getLogger("selectorClasses");const a=1;class c extends n.RelativeSelector{constructor(e){super(e);this.indexInPath=Number(e.indexInPath)||1;this.length=Number(e.length)||-1}getType(){return"ChildSelector"}isMatchable(){return false}_matches(){return false}getDisplayName(){return"child"}getDisplayValue(){return this.parentsLocators[0].getDisplayText()}computeInitialScore(){return a}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}getChildElementLocator(){return this.parentsLocators[0]}findElements(e){const t=e.getRelativeParent().getActualElement();const s=e.getActualElement();const i=o.locatorBuilderUtils.getElementsPath(t,s);if(i[0]!==t){r.log("child element found is not relative to its expected relative",{path:i.map((e=>e.tagName))});return[]}if(this.length<0){return[i[this.indexInPath]]}const n=Math.max(i.length-(this.length-this.indexInPath),0);return i.slice(Math.min(n,this.indexInPath),1+Math.max(n,this.indexInPath))}serialize(){return{...super.serialize(),indexInPath:this.indexInPath,length:this.length}}}t.ChildSelector=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FrameVisibleSelector=void 0;const i=s(54);const o=s(105);const n=.4;class r extends o.CSSSelector{constructor(e){super(e);this.visible=e.visible}getType(){return"FrameVisibleSelector"}getDisplayName(){return"computed-visibility"}_equals(e){return this.visible===e.visible&&super._equals(e)}getDisplayValue(){return this.visible}computeInitialScore(){return n}getSelfScore(){if(Object.hasOwn(this,"selfScore")){return this.selfScore}return this.computeInitialScore()}isSelectorValid(e){return e.getAttribute(i.injectorUtils.TESTIM_VISIBILITY)===this.visible}getQuery(){return`[${i.injectorUtils.TESTIM_VISIBILITY}='${this.visible}']`}serialize(){return{...super.serialize(),visible:this.visible}}}t.FrameVisibleSelector=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FrameElementLocator=void 0;const i=s(53);const o=s(166);class n extends o.ElementLocator{buildLocatorResultObject(e,t,s,o){const n=super.buildLocatorResultObject(e,t,s,o);if(this.isTargetElement&&!i.locatorBuilderUtils.isEmptyResult(e.element)){const t=e.element.getAttribute(i.locatorBuilderUtils.TESTIM_FRAME_ID)||e.element.testim_frame_id_fallback;n.frameId=t}return n}serialize(){return{...super.serialize(),testimFrameId:this.testimFrameId,type:"FrameLocator"}}}t.FrameElementLocator=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AggregatedQueryResult=void 0;const i=s(53);const o=s(7);const n=o.Logger.getLogger("locator-result-objects");class r{constructor(){this.className="AggregatedQueryResult";this.foundParentsIds=[];this.foundScores=[];this.isTargetElement=false}setTargetElement(){this.isTargetElement=true}updateResultsWithNonRelativeSelectors(e,t){const s=Object.keys(t);if(s.length<=1){return}const o=e.filter((e=>!i.locatorBuilderUtils.isNthSelectorResult(e)));o.forEach((e=>{const o=e.queryResults.map((e=>e.testimElementDomId));const r=s.filter((e=>!(o.includes(e)||i.locatorBuilderUtils.isEmptyResultId(Number(e)))));if(r.length<=0){return}const a=Math.max.apply(null,e.queryResults.map((e=>e.score)));let c;try{c=r.filter((s=>e.selector.isSelectorValid(t[s].element)))}catch(t){c=[];n.error(`Exception in ${e.selector.type}.isSelectorValid`,t)}const l=o.length+c.length;const u=o.length/l;c.forEach((e=>{t[e].score+=a*u}));e.setValidatedElements(c)}))}calculateAggregatedResults(e){const t={};e.reduce(((e,t)=>{t.queryResults.forEach((t=>{const s=t.testimElementDomId;e[s]||(e[s]={element:t.element,score:0,maxParentScore:0});e[s].score+=t.score;e[s].maxParentScore=Math.max(t.parentScore,e[s].maxParentScore)}));return e}),t);this.updateResultsWithNonRelativeSelectors(e,t);const s=Object.keys(t).reduce(((e,s)=>t[s].score+e),0);const i=Object.keys(t).map((e=>{const i=t[e];const o=s>0?i.score/s:0;return{testimElementDomId:e,element:i.element,score:o,finalScore:i.maxParentScore*o,maxParentScore:i.maxParentScore}}));return this.fixScores(i,e)}fixScores(e,t){const s=e=>e.length>0&&e.every(this._isUneditedNthChildSelector);const o=()=>e.length===1&&i.locatorBuilderUtils.isEmptyResult(e[0].element);const n=e=>!i.locatorBuilderUtils.isEmptyResultId(e.foundElements.find(Boolean).id)||e.foundElements.length>1;const r=t.filter(n).filter(Boolean);if(s(r)){const t=.8;const s=.3;const o=e.find((e=>!i.locatorBuilderUtils.isEmptyResult(e.element)));const n=r.some((e=>!e.isDifferentSiblingCount));const a=n?t:s;o.finalScore*=a}if(o()){e[0].finalScore=0}return e}_isUneditedNthChildSelector(e){if(!i.locatorBuilderUtils.isNthSelectorResult(e))return false;return!e.selector.hasUserDefinedIndex()}getForceEmptyResultCriteria(e,t){const s=.75;const i=5;return e>=i&&t>=s}updateSelectorResultsWithRelativeElement(e,t){e.forEach((e=>{const s=e.queryResults.find((e=>e.testimElementDomId===t));if(s){e.setChosenParent(s.parentIndex)}else{const t=e.queryResults.sort(((e,t)=>{if(t.parentScore>e.parentScore){return 1}if(t.parentScore<e.parentScore){return-1}return 0}));e.setChosenParent(t.find(Boolean).parentIndex)}}))}getTextSelectorResultIfUnique(e){const t=e.filter((e=>i.locatorBuilderUtils.isInnerTextSelectorType(e.selectorType)));if(t.length!==1){return null}const s=t.find(Boolean);const o=s.queryResults.length===1;const n=s.queryResults.find(Boolean).parentIndex===0;return o&&n?s:null}getNumEmptyResults(e){const t=e=>e.foundParentsIds.length>0;const s=e=>e.foundElements.some((e=>i.locatorBuilderUtils.isEmptyResultId(e.id)));const o=e=>!!e.validatedElements&&e.validatedElements.length>0;return e.filter((e=>t(e)&&s(e)&&!o(e))).length}getBestFromSelectorResults(e){const t=e=>e.sort(((e,t)=>{if(t.finalScore>e.finalScore){return 1}if(t.finalScore<e.finalScore){return-1}return 0}));const s=e=>e.find((e=>!i.locatorBuilderUtils.isEmptyResult(e.element)));const o=()=>({element:i.locatorBuilderUtils.EMPTY_RESULT,finalScore:0,maxParentScore:1,score:0,testimElementDomId:i.locatorBuilderUtils.EMPTY_RESULT_ID});const n=this.calculateAggregatedResults(e);if(n.length===1){return n[0]}if(this.isTargetElement){const t=this.getTextSelectorResultIfUnique(e);if(t){const e=t.foundElements.find(Boolean).id;return n.find((t=>t.testimElementDomId===e))}}const r=t(n);const a=this.getNumEmptyResults(e);const c=this.getForceEmptyResultCriteria(a,a/e.length);return c?o():s(r)}getSerializableObject(){return{className:"AggregatedQueryResult",foundParentsIds:this.foundParentsIds}}}t.AggregatedQueryResult=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChildElementLocator=void 0;const i=s(166);class o extends i.ElementLocator{constructor(){super(...arguments);this.isChildLocator=true}getRelativeParent(){if(this.selectors.length>0){return this.selectors[0].parentsLocators[0]}return undefined}getDisplayText(){if(this.selectors.length===0){return""}const e=this.selectors.sort(((e,t)=>{if(t.getSelfScore()>e.getSelfScore()){return 1}if(t.getSelfScore()<e.getSelfScore()){return-1}return 0}));return`${e[0].getDisplayName()}=${e[0].getDisplayValue()}`}serialize(){return{...super.serialize(),type:"ChildElementLocator"}}}t.ChildElementLocator=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MaxWeightedMatch=void 0;const i=s(6);class o{_initDynamicProgrammingTable(e,t){const s=[];s[0]=[{score:1,assignments:[{i:0,j:0}]}];for(let e=1;e<t;e++){s[0][e]={score:1,assignments:[{i:0,j:0}]}}for(let t=1;t<e;t++){s[t]=[]}return s}_getBestCandidateForCurrentPosition(e,t,s,i,n){let r={assignments:s[e-1][t].assignments.concat({i:e,j:o.NO_MATCH,score:n}),score:s[e-1][t].score+n};const a=s[e-1];for(let s=1;s<=t;s++){const t=a[s-1];const o=t.score+i[e][s];if(o>r.score){r={score:o,assignments:t.assignments.concat({i:e,j:s,score:i[e][s]})}}}return r}_getCandidatesForCurrentPosition(e,t,s,n,r){const a={assignments:s[e-1][t].assignments.concat({i:e,j:o.NO_MATCH,score:r}),score:s[e-1][t].score+r};return i.range(1,t+1).map((t=>{const i=s[e-1][t-1];return{assignments:i.assignments.concat({i:e,j:t,score:n[e][t]}),score:i.score+n[e][t]}})).concat(a)}_calcDynamicProgrammingTable(e,t){const s=e.length;const i=e[0].length;const o=this._initDynamicProgrammingTable(s,i);for(let n=1;n<s;n++){for(let s=0;s<i;s++){const i=this._getBestCandidateForCurrentPosition(n,s,o,e,t);o[n][s]={score:i.score,assignments:i.assignments}}}return o}calcAssignment(e,t,s,i){return this.calcAssignmentAndScore(e,t,s,i).assignments}calcAssignmentAndScore(e,t,s,i){const o=this._calcDynamicProgrammingTable(e,i);return o[t][s]}}t.MaxWeightedMatch=o;o.NO_MATCH="NO_MATCH"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.BaseEventStep=void 0;const n=s(6);const r=s(2);const a=s(8);const c=s(72);const l=s(60);function u(e,t){const s=t.length;for(let i=0;i<s;++i){e.push(a.utils.clone(t[i]))}}class d extends c.Step{constructor(){super(...arguments);this.events=[]}get startTime(){var e;return((e=this.events[0])===null||e===void 0?void 0:e.timeStamp)||0}get lastEvent(){return this.events.at(-1)||null}get endTime(){return this.lastEvent?this.lastEvent.timeStamp:0}get _displayName(){return this.calcDisplayName()||super.getDisplayName()}getElementData(e,t,s){return{aggregateUpdateAction:true,...s,location:e||this.location,tabInfo:t||this.tabInfo}}_update(e){if(e.events){n.remove(this.events);u(this.events,e.events)}if(e.newEvents){u(this.events,e.newEvents)}if(e.element){const t=this.getElementData(e.location,e.tabInfo,e.element);if(this.element){this.element.update(t)}else{this.element=l.stepBuilder.buildStepFromData(t)}}if(e.trackActiveElement!==undefined){this.trackActiveElement=e.trackActiveElement}return super._update(e)}getDisplayName(){return this._displayName}calcDisplayName(){const e=this.lastEvent;return e===null||e===void 0?void 0:e.event}getSerializableObject(e){var t;return{...super.getSerializableObject(e),events:a.utils.clone(this.events),element:(t=this.element)===null||t===void 0?void 0:t.getSerializableObject(e),trackActiveElement:Boolean(this.trackActiveElement)}}}t.BaseEventStep=d;i([r.observable.shallow,o("design:type",Array)],d.prototype,"events",void 0);i([r.observable.ref,o("design:type",Object)],d.prototype,"element",void 0);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],d.prototype,"startTime",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],d.prototype,"lastEvent",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],d.prototype,"endTime",null);i([r.computed,o("design:type",Object),o("design:paramtypes",[])],d.prototype,"_displayName",null)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ImageUploader=void 0;const i=s(639);const o=s(640);const n=s(14);const r=s(61);const a=s(22);const c=r.container.get(n.FeatureFlagsService);const l=r.container.get(a.TestimServicesApi);const u=(e="cloudinary")=>{const t=c.flags.uploadRecImageToStorage.isEnabled();if(t){return new o.ImageUploaderStorage(l)}return new i.ImageUploaderCloudinary(l)};t.ImageUploader=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ImageUploaderCloudinary=void 0;const i=s(77);const o=s(8);const n=s(7);const r=s(247);const a=s(42);const c=n.Logger.getLogger("image-uploader-cloudinary");const l="https://api.cloudinary.com/v1_1/testim/";const u=`${l}image/upload`;const d="https://res.cloudinary.com/testim/image/upload";const p=6291e4;const h=5*1e3;const f=15*1e3;const m=15;const g=1e3;let v=0;class S extends r.BaseImageUploader{getRequestTimeout(e,t){const s=Math.ceil(e/p*1e3)*1e3;const i=v+(f-v)*(t/m);return Math.max(h,s,i)}getUploadTimeout(e){return(this.getRequestTimeout(e,0)+g)*m+1e3}async saveImageToServerPromise(e){const t=Math.ceil(Date.now()/1e3);const s=o.utils.guid();const n={file:encodeURI(e.imageURL),timestamp:t,upload_preset:"TestimEditor",public_id:s};let r=0;try{const e=await(0,i.default)((async()=>{const e=this.getRequestTimeout(n.file.length,r++);const t=await a.httpRequest.postForm(u,n,undefined,e);v=e;return t}),{retries:m,minTimeout:g});c.log("Baseline image saved to cloudinary",e);return`${d}/${s}.${e.format||"jpg"}`}catch(e){c.error("failed to save image to cloudinary",e);throw e}}}t.ImageUploaderCloudinary=S},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ImageUploaderStorage=void 0;const i=s(8);const o=s(247);const n=s(114);class r extends o.BaseImageUploader{async saveImageToServerPromise(e){const{imageURL:t,projectId:s}=e;const o="image/jpeg";const{data:r}=(0,n.convertDataURIToBinary)(t);if(!r){throw new Error("failed to convert image url")}const a=i.utils.guid();const c=`${a}.jpg`;const l=`rec-image/${c}`;const u=this.servicesApi.storage.getProjectArtifactPath(l,s);const d={fileName:c,mimeType:o,file:new Blob([r.buffer],{type:o})};await this.servicesApi.storage.uploadFile(u,d,undefined,undefined,{"rec-img":true});return u}}t.ImageUploaderStorage=r},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h;Object.defineProperty(t,"__esModule",{value:true});t.TmsService=void 0;const f=s(6);const m=s(9);const g=s(2);const v=s(22);const S=s(33);const y=s(45);const b=s(28);const _=s(5);const T=s(15);const E=s(29);const I=s(80);const C=s(34);const D=s(642);const O=s(124);const A=s(14);const j=s(38);const w=s(8);const{PROJECT_SELECTED:R,PROJECT_CHANGED:P,APP_LOGOUT:x}=_.commonConstants.scenario;const{TTM4J:M,XRAY:N}=_.commonConstants.TMS_PROVIDERS;const F=[M,N];let L=class e extends S.EventEmitter{constructor(e,t,s,i,o,n,r,a,c){super();this.projectsService=e;this.branchService=t;this.editedTestStore=s;this.modalService=i;this.testimServices=o;this.editorSelectionService=n;this.socketService=r;this.featureFlagsService=a;this.authenticationManager=c;this.tmsStreamSocketIO=new D.TmsStreamSocketIO;this.explicitUpdate=0;this.tmsFinishedMapping=false;this.isStreaming=false;this.hasStartedStreaming=false;this.howManyTestsToMap=0;this.connected=false;this.provider="";this.providers=[];this.projectsService.on([R,P],(()=>{this._initiated=false;this.tests=[];this.init()}));c.on(x,(()=>{this.tmsStreamSocketIO.closeSocket()}))}get isInitiated(){return this._initiated}get providerName(){return this.getProviderDisplayName(this.provider)}get isProviderTTM4J(){return this.provider===M}async init(){if(this._initiated){return}const[e,t]=await Promise.all([this.testimServices.tms.providers(this.projectsService.projectId),this.testimServices.tms.connected(this.projectsService.projectId)]);this.providers=(e||[]).filter((e=>{if(this.projectsService.isMobile){if(F.includes(e.id)){e.displayName=this.getProviderDisplayName(e.id);return e}return""}e.displayName=this.getProviderDisplayName(e.id);return e}));this.provider=t||"";this.connected=Boolean(this.provider);this._initiated=true;if(!this.featureFlagsService.flags.useNewWS.isEnabled()&&this.provider===M){this.tmsStreamSocketIO.init(this.projectsService.projectId,w.utils.getServicesUrl())}else{this.tmsStreamSocketIO.closeSocket()}}async connect(e,t){this.explicitUpdate++;const s=await this.testimServices.tms.connect(this.projectsService.projectId,e,t);this.provider=e;this.connected=true;return s}async disconnect(){this.explicitUpdate++;const e=await this.testimServices.tms.disconnect(this.projectsService.projectId);this.connected=false;this.provider="";return e}getProviderDisplayName(e){var t;const s={qtest:"qTest",testrail:"TestRail",ttm4j:"TTM For Jira",xray:"X-Ray"};return(t=s[e])!==null&&t!==void 0?t:f.capitalize(e)}async getProjects(){return await this.testimServices.tms.getProjects(this.projectsService.projectId)}async setProjectLink(e){this.explicitUpdate++;return await this.testimServices.tms.setProjectLink(this.projectsService.projectId,new Set(e))}async getTests(e){const t=await this.testimServices.tms.getTests(this.projectsService.projectId,e);this.tests=t;return this.tests}async setTests(e,t){this.howManyTestsToMap=t.length;this.isStreaming=true;this.hasStartedStreaming=true;const s=await this.testimServices.tms.setTests(this.projectsService.projectId,e,t);this.initTmsStreamSocketIO(s);return s}setMapTestsInDB(e,t){return this.testimServices.tms.setMapTestsInDB(this.projectsService.projectId,e,t)}async checkMappedTests(e,t){return await this.testimServices.tms.checkMappedTests(this.projectsService.projectId,e,this.branchService.branch,t)}get projectTMSObj(){this.explicitUpdate;return this.testimServices.tms.getProjectTMSObj(this.projectsService.projectId)}async getProjectLink(){return this.testimServices.tms.getProjectLink(this.projectsService.projectId)}get projectLink(){this.explicitUpdate;return this.getProjectLink()}async validateTMSIntegration(){var e,t,s;if(!((e=this.editedTestStore.scenario)===null||e===void 0?void 0:e.tms.provider)){return true}if(((t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.tms).tmsProjectId&&(!((s=this.editedTestStore.scenario)===null||s===void 0?void 0:s.tms.tmsTests)||this.editedTestStore.scenario.tms.tmsTests.length===0)){const e=await this.modalService.openModal(y.MessageModal,{title:`${this.providerName} was not connected`,icon:"warning",variety:"warning",body:`You did not select a test in the ${this.providerName} project. Are you sure you want to continue?`,okText:"Continue",cancelText:"Go back"}).promise;if(!e){this.editorSelectionService.forceSelectSetup()}return e}return true}async initTmsStreamSocketIO(e){await this.tmsStreamSocketIO.joinToTmsStream(e);this.listenToJobCompleted(e)}closeTmsStreamSocketIOSocket(){this.tmsStreamSocketIO.closeSocket()}listenToJobCompleted(e){return this.tmsStreamSocketIO.listenToJobCompleted(e,(e=>this.getTmsDataCompleted(e)))}async leaveTmsStreamSocketIO(e){return await this.tmsStreamSocketIO.leaveTmsStream(e)}getTmsDataCompleted(e){this.tmsData=e;this.isStreaming=false;this.tmsFinishedMapping=true;return e}resetTmsStream(){this.tmsData=null;this.isStreaming=false;this.hasStartedStreaming=false;this.tmsFinishedMapping=false;this.howManyTestsToMap=0}};t.TmsService=L;i([g.observable,o("design:type",Boolean)],L.prototype,"connected",void 0);i([g.observable,o("design:type",Object)],L.prototype,"provider",void 0);i([g.observable,o("design:type",Boolean)],L.prototype,"_initiated",void 0);i([g.observable,o("design:type",Object)],L.prototype,"explicitUpdate",void 0);i([g.observable,o("design:type",Object)],L.prototype,"tmsData",void 0);i([g.observable,o("design:type",Object)],L.prototype,"tmsFinishedMapping",void 0);i([g.observable,o("design:type",Object)],L.prototype,"isStreaming",void 0);i([g.observable,o("design:type",Object)],L.prototype,"hasStartedStreaming",void 0);i([g.observable,o("design:type",Object)],L.prototype,"howManyTestsToMap",void 0);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"isInitiated",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"providerName",null);i([g.computed,o("design:type",Object),o("design:paramtypes",[])],L.prototype,"isProviderTTM4J",null);i([(0,g.computed)({keepAlive:true,requiresReaction:true}),o("design:type",Object),o("design:paramtypes",[])],L.prototype,"projectTMSObj",null);i([(0,g.computed)({keepAlive:true,requiresReaction:true}),o("design:type",Object),o("design:paramtypes",[])],L.prototype,"projectLink",null);i([g.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],L.prototype,"getTmsDataCompleted",null);i([g.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],L.prototype,"resetTmsStream",null);t.TmsService=L=i([(0,m.injectable)(),o("design:paramtypes",[typeof(n=typeof T.ProjectsService!=="undefined"&&T.ProjectsService)==="function"?n:Object,typeof(r=typeof C.BranchesService!=="undefined"&&C.BranchesService)==="function"?r:Object,typeof(a=typeof E.EditedTestStore!=="undefined"&&E.EditedTestStore)==="function"?a:Object,typeof(c=typeof b.ModalService!=="undefined"&&b.ModalService)==="function"?c:Object,typeof(l=typeof v.TestimServicesApi!=="undefined"&&v.TestimServicesApi)==="function"?l:Object,typeof(u=typeof I.EditorSelectionService!=="undefined"&&I.EditorSelectionService)==="function"?u:Object,typeof(d=typeof O.UISocketService!=="undefined"&&O.UISocketService)==="function"?d:Object,typeof(p=typeof A.FeatureFlagsService!=="undefined"&&A.FeatureFlagsService)==="function"?p:Object,typeof(h=typeof j.AuthenticationService!=="undefined"&&j.AuthenticationService)==="function"?h:Object])],L)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TmsStreamSocketIO=void 0;const i=s(5);const o=s(125);const{socketEventTypes:n}=i.commonConstants;class r extends o.BaseSocketService{init(e,t,s){super.init(e,"/tmsStream",t,s)}closeSocket(){super.closeSocket()}emitJoinRoom(e){return this.emitPromise("join:room",{jobId:e},`tmsStream:${e}`)}joinToTmsStream(e){this.joinRoom(e,e);return this.emitJoinRoom(e)}async leaveTmsStream(e){await this.emitPromise("leave:room",{jobId:e},`tmsStream:${e}`);this._socket.removeAllListeners();this.leaveRoom(e)}listenTo(e,t,s){function i(e){if(e.jobId===t){s(e)}}this._socket.on(e,i.bind(this))}listenToJobInProgress(e,t){this.listenTo(n.TMS_MAPPING_IN_PROGRESS,e,t)}listenToJobCompleted(e,t){this.listenTo(n.TMS_MAPPING_COMPLETED,e,t)}}t.TmsStreamSocketIO=r},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(644),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CreateSharedStepModal=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(0);const a=s(30);const c=s(31);const l=s(44);const u=s(32);const d=s(645);const p=s(11);const h=s(106);const f=s(74);const m=s(14);const g=s(52);const v=s(16);const S=s(248);const y=s(12);const b=({okText:e,cancelText:t,disabled:s,submitModal:o,cancelModal:n})=>(0,i.jsxs)("div",{children:[(0,i.jsx)(c.Cta,{disabled:s,onClick:o,children:e!==null&&e!==void 0?e:"Ok"}),(0,i.jsx)(c.Cta,{variety:"secondary",onClick:n,children:t!==null&&t!==void 0?t:"Cancel"})]});b.displayName="Footer";const _=(0,y.observer)((e=>{var t;const s=(0,p.useDependencyInjector)(h.CustomReuseService);const n=(0,p.useDependencyInjector)(m.FeatureFlagsService);const[c,y]=(0,r.useState)((t=e.stepName)!==null&&t!==void 0?t:"");const[_,T]=(0,r.useState)(true);const[E,I]=(0,r.useState)({infoId:undefined,name:"Root"});const C=n.flags.preventSharedStepSameName.isEnabled();const D=_;const O=(0,r.useMemo)((()=>Boolean(c.length&&(!s.sharedSteps.find((({name:e})=>e===c))||!C))),[c,C,s.sharedSteps]);const A=!c.length||O?undefined:"This name already exist, please select a different name";const j=(0,r.useCallback)((()=>e.closeModal()),[e]);const w=(0,r.useCallback)((()=>{const t=_?E.infoId:undefined;e.closeModal({stepName:c,allowReuse:_,parentFolderInfoId:t})}),[_,E.infoId,e,c]);return(0,i.jsxs)(a.BaseModal,{className:(0,o.default)(d.default.createSharedStep),subHeader:e.subHeader,closeModal:j,onSubmit:w,bodyClassName:d.default.modalBody,closeOnClickOutside:false,closeOnEscape:false,header:(0,i.jsx)("h3",{children:e.title}),footer:(0,i.jsx)(b,{...e,cancelModal:j,submitModal:w,disabled:!O}),children:[(0,i.jsxs)(l.FieldLabel,{error:A,children:[(0,i.jsxs)("span",{children:["Name the new ",e.entityTypeName]}),(0,i.jsx)(u.Textbox,{autoFocus:true,placeholder:"Name",value:c,onChange:e=>y(e.target.value)})]}),(0,i.jsxs)(f.Checkbox,{wrapperClassName:d.default.label,onChange:()=>T(!_),checked:_,children:["Shared ",e.entityTypeName,(0,i.jsx)(g.Tooltip,{value:`This ${e.entityTypeName} will be available to reuse in this and other tests`,children:(0,i.jsx)(v.Icon,{icon:"info"})})]}),(0,i.jsx)(S.SharedStepFolderSelection,{entityTypeName:`shared ${e.entityTypeName}`,isFolderSelectionEnabled:D,selectedParentFolder:E,setSelectedParentFolder:I})]})}));t.CreateSharedStepModal=_;_.displayName="CreateSharedStepModal"},function(e,t,s){"use strict";s.r(t);t["default"]={createSharedStep:"createSharedStep_createSharedStep_3JlLQ_JlZFN0ZXAt",label:"createSharedStep_label_2BWAA_JlZFN0ZXAt",modalBody:"createSharedStep_modalBody_3ckk0_JlZFN0ZXAt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(647),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FolderSelectionModal=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(176);const a=s(16);const c=s(30);const l=s(648);const u=s(10);const d=s(31);const p=s(11);const h=s(92);const f=s(649);const m=s(12);const g=s(28);const v=s(5);const S=(0,m.observer)((({closeModal:e,treeType:t,initialFolder:s,isFolderDisabled:m,validateFolderSelection:S,className:y})=>{const b=(0,p.useDependencyInjector)(h.FoldersStore);const _=(0,p.useDependencyInjector)(g.ModalService);const[T,E]=(0,n.useState)(s);const[I,C]=(0,n.useState)();const[D,O]=(0,n.useState)();const[A,j]=(0,n.useState)();const w=I||T;const R=(0,n.useMemo)((()=>b.getItemBreadcrumbs(t,T)),[T,b,t]).value;const P=[...o.orderBy(T.childFolders.map((e=>({type:v.FOLDER_CHILD_TYPES.FOLDER,folder:e}))),"folder.name"),...o.orderBy(b.getNonFolderChildren(t,T).map((e=>({type:"non_folder",name:e.name}))),"name")];const x=(0,n.useRef)(null);const M=(0,n.useCallback)((async e=>{var s,i;const o=await b.getFolderContent(t,e);if(m===null||m===void 0?void 0:m(o)){return}E(o);C(undefined);j(undefined);(s=x.current)===null||s===void 0?void 0:s.scrollToPosition(0);(i=window.getSelection())===null||i===void 0?void 0:i.removeAllRanges()}),[m,b,t]);const N=(0,n.useCallback)((e=>{const t=(D===null||D===void 0?void 0:D.timeoutId)!==undefined&&D.clickedFolderId===e.folderInfoId;j(undefined);if(t){M(e.folderInfoId);clearTimeout(D.timeoutId);O(undefined)}else{C(e===I?undefined:e);O({timeoutId:setTimeout((()=>{clearTimeout(D===null||D===void 0?void 0:D.timeoutId);O(undefined)}),500),clickedFolderId:e.folderInfoId})}}),[D,M,I]);const F=({folder:e,style:t})=>(0,i.jsxs)("button",{className:(0,u.default)("ignore-disabled-style",l.default.folderRow,{[l.default.selected]:I===e}),style:t,title:e.name,disabled:m===null||m===void 0?void 0:m(e),onClick:()=>N(e),children:[(0,i.jsx)(a.Icon,{icon:"folder-high"}),(0,i.jsx)("p",{children:e.name})]});F.displayName="FolderListItem";const L=({name:e,style:t})=>(0,i.jsx)("div",{className:(0,u.default)(l.default.row,l.default.notSelectable),style:t,title:e,children:(0,i.jsx)("p",{children:e})});L.displayName="NonFolderListItem";const k=({index:e,key:t,style:s})=>{const o=P[e];return o.type===v.FOLDER_CHILD_TYPES.FOLDER?(0,i.jsx)(F,{style:s,folder:o.folder},t):(0,i.jsx)(L,{style:s,name:o.name},t)};const B=(0,n.useCallback)((()=>{const t=S===null||S===void 0?void 0:S(w);if(t){j(t);return}e({selectedFolderInfoId:w.folderInfoId,selectedFolderName:w.name})}),[e,w,S]);const U=(0,n.useCallback)((async()=>{const e=await _.openFormModal({header:"New folder",items:{name:{props:{autoFocus:true,placeholder:"Untitled folder"},type:"textbox",label:"New name",value:"",validate:e=>{if(!e){return"Missing folder name"}if(T.childFolders.find((t=>t.name===e))){return`Folder with name ${e} already exists`}return""}}}}).promise;if(!(e===null||e===void 0?void 0:e.name)){return}await b.createChildFolder({name:e.name,parentFolder:T,type:t})}),[_,b,T,t]);const G=(0,i.jsxs)("div",{className:l.default.footer,children:[(0,i.jsx)(d.Cta,{className:l.default.addFolder,color:"gray",onClick:U,children:(0,i.jsx)(a.Icon,{icon:"create-folder"})}),(0,i.jsxs)("div",{className:l.default.centerButtons,children:[(0,i.jsx)(d.Cta,{className:l.default.footerButton,onClick:B,disabled:Boolean(A),children:"SELECT"}),(0,i.jsx)(d.Cta,{className:l.default.footerButton,variety:"secondary",onClick:()=>e(),children:"CANCEL"})]})]});return(0,i.jsxs)(c.BaseModal,{closeModal:e,header:(0,i.jsx)("h3",{className:l.default.modalHeader,children:"Move to..."}),className:(0,u.default)(l.default.modal,y),bodyClassName:l.default.modalBody,subHeader:A,subHeaderClassName:l.default.errorSubheader,footer:G,children:[(0,i.jsx)(f.Breadcrumbs,{className:(0,u.default)(l.default.breadcrumbs,{[l.default.hiddenBreadcrumbs]:!T.folderInfoId}),path:R,nameCropping:"shorter",onItemSelected:M,onRootSelected:()=>M()}),(0,i.jsx)("div",{className:l.default.listContainer,children:P.length>0&&(0,i.jsx)(r.AutoSizer,{children:({width:e,height:t})=>(0,i.jsx)(r.List,{height:t,width:e,rowCount:P.length,rowHeight:60,rowRenderer:k,ref:x})})})]})}));t.FolderSelectionModal=S;S.displayName="FolderSelectionModal"},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"FolderSelectionModal_modal_EPLh4_9uTW9kYWwt",modalBody:"FolderSelectionModal_modalBody_2_ZEX_9uTW9kYWwt",modalHeader:"FolderSelectionModal_modalHeader_1mGN0_9uTW9kYWwt",errorSubheader:"FolderSelectionModal_errorSubheader_1Dki5_9uTW9kYWwt",breadcrumbs:"FolderSelectionModal_breadcrumbs_2tJ2P_9uTW9kYWwt",hiddenBreadcrumbs:"FolderSelectionModal_hiddenBreadcrumbs_3R6_1_9uTW9kYWwt",listContainer:"FolderSelectionModal_listContainer_3_aC6_9uTW9kYWwt",folderRow:"FolderSelectionModal_folderRow_3jMBK_9uTW9kYWwt",row:"FolderSelectionModal_row_1LMe8_9uTW9kYWwt",notSelectable:"FolderSelectionModal_notSelectable_2pue-_9uTW9kYWwt",selected:"FolderSelectionModal_selected_2VSkb_9uTW9kYWwt",footer:"FolderSelectionModal_footer_4Pa1C_9uTW9kYWwt",centerButtons:"FolderSelectionModal_centerButtons_ra3EX_9uTW9kYWwt",footerButton:"FolderSelectionModal_footerButton_mk2K-_9uTW9kYWwt",addFolder:"FolderSelectionModal_addFolder_1cV51_9uTW9kYWwt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(650),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Breadcrumbs=void 0;const i=s(4);const o=s(651);const n=s(10);const r=s(0);const a=s(0);const c=s(20);const l=s(16);const u=s(52);const d=s(12);const p=r.memo((()=>(0,i.jsx)(l.Icon,{icon:"angle-right",className:o.default.separatorIcon})));p.displayName="Separator";const h=r.memo((({item:e,onItemSelected:t})=>{const s=(0,a.useCallback)((()=>t===null||t===void 0?void 0:t(e.value)),[e,t]);return(0,i.jsx)("div",{title:e.name,onClick:s,className:(0,n.default)(o.default.tooltipItem,{[o.default.selectable]:Boolean(t)}),children:e.name})}));const f=({onItemSelected:e,items:t})=>(0,i.jsx)("div",{className:o.default.collapsedTooltip,children:t.map(((t,s)=>(0,i.jsx)(h,{item:t,onItemSelected:e},s)))});f.displayName="CollapsedTooltip";t.Breadcrumbs=(0,d.observer)((({showHome:e=true,path:t,onRootSelected:s,onItemSelected:d,className:h,nameCropping:m="shorter",collapsedDirection:g="bottom",childCount:v})=>{const S=(0,a.useRef)(null);const[y,b]=(0,a.useState)(0);const _=(0,a.useCallback)((()=>b((e=>Math.min(e+1,t.length-1)))),[t]);const T=(0,a.useCallback)((()=>b((e=>Math.max(e-1,0)))),[]);const{boundingRect:E}=(0,c.useMeasuredBoundingRect)(S);const[I,C]=(0,a.useState)(new Map);const D=Math.round(E.width);r.useLayoutEffect((()=>{C(new Map);b(0)}),[t,D]);r.useLayoutEffect((()=>{var e,t;const s=S.current.getBoundingClientRect();const i=(t=(e=S.current)===null||e===void 0?void 0:e.scrollWidth)!==null&&t!==void 0?t:0;const o=Math.round(s.width)>=i;I.set(y,o);if(!o){_();return}const n=y>0&&I.get(y-1)===undefined;if(n){T()}}),[D,T,_,y,I]);const O=(0,a.useMemo)((()=>t.slice(0,y)),[t,y]);const A=(0,a.useMemo)((()=>t.slice(y)),[t,y]);const j=Boolean(O.length);const w=(0,a.useCallback)((e=>()=>d===null||d===void 0?void 0:d(e.value)),[d]);return(0,i.jsxs)("div",{ref:S,className:(0,n.default)(o.default.container,o.default[m],h),children:[e&&(0,i.jsx)(l.Icon,{icon:"home",className:(0,n.default)(o.default.rootIcon,{[o.default.selectable]:Boolean(s)}),onClick:s}),(0,i.jsx)(p,{}),j&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Tooltip,{color:"white",trigger:"click",className:o.default.collapsedTooltipWrapper,direction:g,value:(0,i.jsx)(f,{items:O,onItemSelected:d}),children:(0,i.jsx)("div",{title:O.map((({name:e})=>e)).join("/\n"),className:o.default.collapsedWrapper,children:"..."})}),(0,i.jsx)(p,{})]}),A.map(((e,t)=>{const s=t===A.length-1;return(0,i.jsxs)("div",{className:(0,n.default)(o.default.singleItemContainer,{[o.default.lastPathItem]:s}),children:[(0,i.jsx)("div",{title:e.name,onClick:w(e),className:(0,n.default)(o.default.pathItem,{[o.default.shrink]:j,[o.default.selectable]:Boolean(d)&&!s}),children:e.name}),!s&&(0,i.jsx)(p,{})]},t)})),v&&(0,i.jsxs)("div",{className:(0,n.default)(o.default.itemCount,o.default.pathItem),children:[" (",v.count," ",v.type,")"]})]})}));t.Breadcrumbs.displayName="Breadcrumbs"},function(e,t,s){"use strict";s.r(t);t["default"]={selectable:"Breadcrumbs_selectable_2hunP_RjcnVtYnMt",container:"Breadcrumbs_container_1_ls__RjcnVtYnMt",none:"Breadcrumbs_none_1uEhu_RjcnVtYnMt",shorter:"Breadcrumbs_shorter_jB9P3_RjcnVtYnMt",longer:"Breadcrumbs_longer_Tfkqg_RjcnVtYnMt",singleItemContainer:"Breadcrumbs_singleItemContainer_2NIlw_RjcnVtYnMt",rootIcon:"Breadcrumbs_rootIcon_3LCCH_RjcnVtYnMt",separatorIcon:"Breadcrumbs_separatorIcon_2zyo6_RjcnVtYnMt",collapsedWrapper:"Breadcrumbs_collapsedWrapper_1T4tU_RjcnVtYnMt",pathItem:"Breadcrumbs_pathItem_2eVN5_RjcnVtYnMt",shrink:"Breadcrumbs_shrink_2H4S7_RjcnVtYnMt",lastPathItem:"Breadcrumbs_lastPathItem_1oGJB_RjcnVtYnMt",itemCount:"Breadcrumbs_itemCount_36JZU_RjcnVtYnMt",collapsedTooltipWrapper:"Breadcrumbs_collapsedTooltipWrapper_2XRsn_RjcnVtYnMt",collapsedTooltip:"Breadcrumbs_collapsedTooltip_2_diL_RjcnVtYnMt",tooltipItem:"Breadcrumbs_tooltipItem_2dq2T_RjcnVtYnMt"}},function(e,t,s){"use strict";s.r(t);t["default"]={folderSelection:"SharedStepFolderSelection_folderSelection_3dhWZ_xlY3Rpb24t",hidden:"SharedStepFolderSelection_hidden_2msWj_xlY3Rpb24t",selectFolderButton:"SharedStepFolderSelection_selectFolderButton_1ymI5_xlY3Rpb24t",folderSelectionModal:"SharedStepFolderSelection_folderSelectionModal_1fWOR_xlY3Rpb24t"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(654),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CreateGroupModal=void 0;const i=s(4);const o=s(0);const n=s(0);const r=s(655);const a=s(659);const c=s(30);const l=s(168);const u=s(34);const d=s(11);const p=s(10);const h=s(660);function f(e){if(!e.allowReuse&&e.replaceMode==="create"&&e.shouldAutoGroup){e.shouldAutoGroup=false}return e}function m(e,t){return t.isNewTest&&e.shouldAutoGroup&&e.currentPage==="createGroup"}function g(e,t,s){if(m(e,t)){return s({currentPage:"nameTest"})}return t.closeModal(f(e))}const v=e=>{const t=(0,d.useDependencyInjector)(u.BranchesService);const[s,v]=(0,n.useReducer)(((e,t)=>({...e,...t})),{allowReuse:true,parentFolderInfoId:undefined,parentFolderName:"Root",shouldAutoGroup:false,forkBranch:true,newBranchName:t.getNextBranchName(e.currentBranch),groupName:"",currentPage:"createGroup",isNameValid:false,branchError:"",replaceMode:"create"});const S=o.useMemo((()=>new h.DataCache),[]);const{closeModal:y}=e;const b=(0,n.useCallback)((()=>y()),[y]);const _=(0,n.useCallback)((()=>{y(f(s))}),[s,y]);const T=s.currentPage==="createGroup"?(0,r.createGroupPage)(s,e,v,m,g,S):(0,a.createNameTestPage)(s,v,_,b);return(0,i.jsx)(c.BaseModal,{bodyClassName:(0,p.default)({[l.default.allowOverflow]:s.currentPage==="createGroup"&&s.replaceMode==="existing"}),className:l.default.createGroupModal,closeModal:b,header:T.header,footer:T.footer,subHeader:T.subHeader,freezeHeight:true,onSubmit:_,children:T.body})};t.CreateGroupModal=v;t.CreateGroupModal.displayName="CreateGroupModal"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.createGroupPage=void 0;const i=s(4);const o=s(10);const n=s(168);const r=s(0);const a=s(74);const c=s(31);const l=s(44);const u=s(32);const d=s(16);const p=s(11);const h=s(106);const f=s(14);const m=s(21);const g=s(34);const v=s(656);const S=s(40);const y=s(20);const b=s(15);const _=s(22);const T=s(37);const E=s(248);const I=s(12);const C=({state:e,props:t,updateState:s,doNextAction:o,shouldChangePage:a})=>{const{closeModal:l}=t;const u=(0,r.useCallback)((e=>{e.preventDefault();s({replaceMode:"create",replacingStepId:""})}),[s]);const d=(0,r.useCallback)((()=>l()),[l]);const p=(0,r.useCallback)((()=>o(e,t,s)),[e,t,s,o]);const h=e.shouldAutoGroup&&!e.newBranchName||e.replaceMode==="existing"&&!e.replacingStepId||e.replaceMode==="create"&&!e.isNameValid||Boolean(e.branchError);return(0,i.jsxs)("div",{children:[e.replaceMode==="existing"&&(0,i.jsx)("a",{className:n.default.back,onClick:u,children:"Back"}),(0,i.jsx)(c.Cta,{disabled:h,onClick:p,children:a(e,t)?"Next":"Confirm"}),(0,i.jsx)(c.Cta,{variety:"secondary",onClick:d,children:"Cancel"})]})};const D=(0,I.observer)((({state:e,props:t,updateState:s,cache:o})=>{const n=(0,p.useDependencyInjector)(h.CustomReuseService);const a=(0,p.useDependencyInjector)(f.FeatureFlagsService);const c=(0,p.useDependencyInjector)(g.BranchesService);(0,r.useEffect)((()=>{let t="";try{if(e.newBranchName){c.assertNewBranchName(e.newBranchName)}}catch(e){t=e.message}s({branchError:t})}),[e.newBranchName,c,s]);(0,r.useEffect)((()=>{const t=a.flags.preventSharedStepSameName.isEnabled();const i=e.groupName;const o=Boolean(i.length&&(!n.sharedSteps.some((({name:e})=>e===i))||!t));s({isNameValid:o})}),[e.groupName,n.sharedSteps,a,s]);return(0,i.jsx)(O,{props:t,state:e,updateState:s,cache:o})}));function O({props:e,state:t,updateState:s,cache:c}){const h=!t.groupName.length||t.isNameValid?undefined:"This name already exist, please select a different name";const f=(0,p.useDependencyInjector)(m.AnalyticsService);const g=(0,p.useDependencyInjector)(b.ProjectsService);const v=(0,r.useCallback)((()=>{const e=!t.allowReuse;const i=e?t.parentFolderInfoId:undefined;const o=i?t.parentFolderName:"Root";s({allowReuse:e,parentFolderInfoId:i,parentFolderName:o})}),[t.allowReuse,t.parentFolderInfoId,t.parentFolderName,s]);const S=(0,r.useCallback)((()=>{const e=!t.shouldAutoGroup;f.userCheckedAutoGroup({isChecked:e});s({shouldAutoGroup:e})}),[s,f,t.shouldAutoGroup]);const y=(0,r.useCallback)((e=>s({newBranchName:e.target.value||""})),[s]);const _=(0,r.useCallback)((e=>t.replaceMode==="existing"&&e.target===e.currentTarget&&e.preventDefault()),[t.replaceMode]);const T=(0,r.useCallback)((({infoId:e,name:t})=>{s({parentFolderInfoId:e,parentFolderName:t})}),[s]);const I=(0,r.useMemo)((()=>({infoId:t.parentFolderInfoId,name:t.parentFolderName})),[t.parentFolderInfoId,t.parentFolderName]);return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)(l.FieldLabel,{className:(0,o.default)(n.default.firstLabel,{[n.default.replacer]:t.replaceMode==="existing"}),error:h,onClick:_,children:(0,i.jsx)(A,{groupName:t.groupName,updateState:s,replaceMode:t.replaceMode,replacingStepId:t.replacingStepId,cache:c,error:h})}),t.replaceMode==="create"&&(0,i.jsxs)(a.Checkbox,{wrapperClassName:n.default.label,onChange:v,checked:t.allowReuse,children:["Shared group",(0,i.jsx)(d.InfoIcon,{tooltip:"This step will be available to reuse in this and other tests",className:n.default.icon})]}),(t.allowReuse||t.replaceMode==="existing")&&e.allowAutoGroup&&!g.isMobile&&(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)(a.Checkbox,{wrapperClassName:n.default.label,onChange:S,checked:t.shouldAutoGroup,children:"Apply auto group on matching steps"}),t.shouldAutoGroup&&(0,i.jsx)(r.Fragment,{children:t.forkBranch&&(0,i.jsxs)(l.FieldLabel,{className:n.default.label,error:t.branchError,children:[(0,i.jsxs)("span",{children:["Branch Name ",(0,i.jsx)(d.InfoIcon,{className:n.default.icon,tooltip:"Auto grouping will create a new branch"})]}),(0,i.jsx)(u.Textbox,{placeholder:"New branch name",value:t.newBranchName,onChange:y})]})})]}),(0,i.jsx)(E.SharedStepFolderSelection,{entityTypeName:"shared group",isFolderSelectionEnabled:t.allowReuse,selectedParentFolder:I,setSelectedParentFolder:T})]})}function A({groupName:e,updateState:t,replacingStepId:s,replaceMode:a,cache:c,error:l}){const u=(0,r.useCallback)((e=>t({groupName:e.target.value})),[t]);const d=(0,r.useCallback)((()=>{setTimeout((()=>t({replaceMode:"existing"})))}),[t]);const h=(0,p.useDependencyInjector)(f.FeatureFlagsService);if(a==="create"){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Enter the name of the new group"}),(0,i.jsx)(v.TextboxWithInnerButton,{autoFocus:true,placeholder:"Group Name",value:e,id:"enterTheNameOfTheNewGroup",onChange:u,buttonClick:d,buttonContent:"Replace with existing",wrapperClassName:(0,o.default)(n.default.newGroupTextBox,{[n.default.buttonError]:l}),showButton:!h.flags.disableGroupReplace.isEnabled()})]})}return(0,i.jsx)(j,{updateState:t,replacingStepId:s,cache:c})}function j({updateState:e,replacingStepId:t,cache:s}){const o=(0,p.useDependencyInjector)(g.BranchesService);const a=(0,p.useDependencyInjector)(b.ProjectsService);const c=(0,p.useDependencyInjector)(_.TestimServicesApi);const[l,u]=(0,r.useState)(undefined);(0,y.useAsyncEffect)((async e=>{const t=a.projectId;const i=await s.getOrAsync("replace-group-list",(async()=>{const e=await c.project.getReplaceGroupList(t,o.branch);return e.map((e=>({name:e.name,value:e.id})))}));if(e()){u(i)}}),[o.branch,a.projectId,c]);const h=(0,r.useMemo)((()=>!l?undefined:l.find((e=>e.value===t))),[t,l]);const f=(0,r.useCallback)((t=>{e({replacingStepId:t.value,replacingStepName:t.name})}),[e]);if(l===undefined){return(0,i.jsx)("div",{className:n.default.groupLoaderWrapper,children:(0,i.jsx)(T.Loader,{})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{onClick:e=>{e.preventDefault()},children:["Replace with group",(0,i.jsx)(d.HoverableInfoIcon,{tooltipProps:{value:"Groups with parameters are currently not supported"},className:n.default.icon})]}),l.length===0?(0,i.jsx)("span",{children:"No relevant groups found"}):(0,i.jsx)(S.Dropdown,{options:l,value:h,placeholder:"Select group to replace with",onChange:f,appendToBody:true})]})}C.displayName="GroupSettingsFooter";D.displayName="GroupPage";O.displayName="GroupPageContent";A.displayName="GroupSelectorPart";j.displayName="GroupDropDown";function w(e,t,s,o,r,a){const c=e.replaceMode==="create"?"Group name":"Replace with existing group";return{header:(0,i.jsxs)("h3",{children:[c," ",o(e,t)&&(0,i.jsx)("span",{className:n.default.pagination,children:"(1/2)"})]}),footer:(0,i.jsx)(C,{state:e,props:t,updateState:s,doNextAction:r,shouldChangePage:o}),subHeader:undefined,body:(0,i.jsx)(D,{state:e,props:t,updateState:s,cache:a})}}t.createGroupPage=w},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(657),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TextboxWithInnerButton=void 0;const i=s(4);const o=s(0);const n=s(658);const r=s(10);const a=s(32);const c=({showButton:e=true,wrapperClassName:t,buttonContent:s,buttonClick:o,buttonClassName:c,buttonProps:l,...u})=>{if(e){return(0,i.jsxs)("div",{className:(0,r.default)(n.default.textboxWithInnerButton,{[n.default.borderRed]:u.hasError},t),children:[(0,i.jsx)(a.Textbox,{...u}),(0,i.jsx)("button",{type:"button",...l,onClick:o,onMouseDown:e=>e.preventDefault(),className:(0,r.default)(n.default.innerButton,c),children:s})]})}return(0,i.jsx)(a.Textbox,{...u})};t.TextboxWithInnerButton=c;t.TextboxWithInnerButton.displayName="TextboxWithInnerButton"},function(e,t,s){"use strict";s.r(t);t["default"]={textboxWithInnerButton:"textboxWithInnerButton_textboxWithInnerButton_gt-o5_JCdXR0b24t",borderRed:"textboxWithInnerButton_borderRed_N1UDG_JCdXR0b24t",innerButton:"textboxWithInnerButton_innerButton_1BpSU_JCdXR0b24t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.createNameTestPage=void 0;const i=s(4);const o=s(0);const n=s(168);const r=s(31);const a=s(44);const c=s(32);function l(e,t,s,r){return{header:(0,i.jsxs)("h3",{children:["Group name ",e.shouldAutoGroup&&(0,i.jsx)("span",{className:n.default.pagination,children:"(2/2)"})]}),footer:(0,i.jsx)(u,{state:e,submitModal:s,closeModal:r,updateState:t}),subHeader:e.forkBranch&&"Changes will only affect the new branch",body:(0,i.jsxs)(o.Fragment,{children:[(0,i.jsxs)(a.FieldLabel,{className:n.default.firstLabel,children:[(0,i.jsx)("span",{children:"Test name"}),(0,i.jsx)(c.Textbox,{autoFocus:true,placeholder:"Test Name",value:e.testName||"Untitled Test",onChange:e=>t({testName:e.target.value})})]}),(0,i.jsxs)(a.FieldLabel,{children:[(0,i.jsx)("span",{children:"Description"}),(0,i.jsx)(c.Textbox,{placeholder:"What is this test for",value:e.description||"",onChange:e=>t({description:e.target.value})})]})]})}}t.createNameTestPage=l;function u({state:e,submitModal:t,closeModal:s,updateState:a}){return(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("a",{className:n.default.back,onClick:t=>{t.preventDefault();a({...e,currentPage:"createGroup"})},children:"Back"}),(0,i.jsx)(r.Cta,{onClick:t,children:"Save"}),(0,i.jsx)(r.Cta,{variety:"secondary",onClick:s,children:"Cancel"})]})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataCache=void 0;const i=s(6);class o{constructor(e=100,t=6e4){this.maxSize=e;this.maxTime=t;this.cache=new Map}set(e,t){this.cache.set(e,{lastAccess:new Date,item:t});if(this.cache.size>this.maxSize){const[e,t]=i.minBy([...this.cache.entries()],(([e,t])=>t.lastAccess));this.cache.delete(e)}}get(e){const t=this.cache.get(e);if(!t){return undefined}const s=new Date;if(s.getTime()-t.lastAccess.getTime()>this.maxTime){this.cache.delete(e);return undefined}t.lastAccess=s;return t.item}clear(){this.cache.clear()}async getOrAsync(e,t){const s=this.get(e);if(s){return s}const i=await t();if(i){this.set(e,i)}return i}}t.DataCache=o},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p;Object.defineProperty(t,"__esModule",{value:true});t.AutoGroupingEditorService=void 0;const h=s(9);const f=s(29);const m=s(21);const g=s(34);const v=s(165);const S=s(63);const y=s(15);const b=s(84);const _=s(49);const T=s(8);let E=class e{constructor(e,t,s,i,o,n,r,a){this.recordingStore=e;this.analyticsService=t;this.userService=s;this.projectsService=i;this.branchesService=o;this.notificationDisplayService=n;this.editedTestStore=r;this.testController=a}processGroupCreation({forkBranch:e,newBranchName:t,testName:s,description:i,replaceMode:o,group:n}){const r=this.editedTestStore.test;const a=this.branchesService.branch;if(!r){return undefined}if(e){try{this.branchesService.assertNewBranchName(t)}catch(e){this.notificationDisplayService.sendNotification(e.message);throw e}}const c=r.isNewTest();this.analyticsService.userAutoGrouped();const l=c?s:r.name;const u=c?i:r.description;const d=e?t:a;return this.saveTestWithAutoGrouping(n,d,l,u,o)}async saveTestWithAutoGrouping(e,t,s,i,o="create"){try{const{forkData:n,testData:r}=this._preAutoGroupHandler(s,i,t);const a=await this.testController.autoGroup(this.projectsService.projectId,r,e,t,n,this.userService.getLoggedUserInfo(),o);return await this._postAutoGroupHandler(a.autoGroupResult,t,s)}catch(e){this.notificationDisplayService.sendNotification(e.message,{type:"error"});return undefined}finally{this.notificationDisplayService.removeNotifications(this.notificationDisplayService.WAIT_DISPLAY)}}_preAutoGroupHandler(e,t,s){const i={projectId:this.projectsService.projectId,fromBranchName:this.branchesService.branch,newBranchName:s};const o={name:e,description:t,message:"auto-grouping",projectId:this.projectsService.projectId};this.recordingStore.handleBeforeSave();this.notificationDisplayService.sendNotification("Auto grouping...",{type:"line-loader",disableCloseBtn:true},undefined,this.notificationDisplayService.WAIT_DISPLAY);return{forkData:i,testData:o}}async _postAutoGroupHandler(e,t,s){const i=2e3;const o=e=>({testCount:e.tests.length,groupCount:e.groups.length});function n(){const{testCount:t,groupCount:s}=o(e);const i=`${t} additional ${t!==1?"tests":"test"}`;const n=`${s} additional ${s!==1?"groups":"group"}`;if(t===0&&s===0){return"Auto grouper didn't find any additional matching groups"}if(t===0||s===0){return`Auto grouped ${t===0?n:i}`}return`Auto grouped ${i} and ${n}`}if(!e.skipFork){await this.branchesService.loadBranchesData();await this.branchesService.checkoutBranch(t);this.editedTestStore.updateTestAndTrigger({name:s});await T.utils.delay(i);return this.notificationDisplayService.sendNotification(n())}await Promise.resolve(this.editedTestStore.updateTestAndTrigger({name:s}));await this.recordingStore.clearTestAndReload();return this.notificationDisplayService.sendNotification(n())}};t.AutoGroupingEditorService=E;t.AutoGroupingEditorService=E=i([(0,h.injectable)(),o("design:paramtypes",[typeof(n=typeof b.RecordingStore!=="undefined"&&b.RecordingStore)==="function"?n:Object,typeof(r=typeof m.AnalyticsService!=="undefined"&&m.AnalyticsService)==="function"?r:Object,typeof(a=typeof _.UserService!=="undefined"&&_.UserService)==="function"?a:Object,typeof(c=typeof y.ProjectsService!=="undefined"&&y.ProjectsService)==="function"?c:Object,typeof(l=typeof g.BranchesService!=="undefined"&&g.BranchesService)==="function"?l:Object,typeof(u=typeof S.NotificationDisplayService!=="undefined"&&S.NotificationDisplayService)==="function"?u:Object,typeof(d=typeof f.EditedTestStore!=="undefined"&&f.EditedTestStore)==="function"?d:Object,typeof(p=typeof v.TestController!=="undefined"&&v.TestController)==="function"?p:Object])],E)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(663),t);o(s(665),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ActionSelection=t.DEFAULT_VERIFY_ACTION_MODE=void 0;const i=s(4);const o=s(664);const n=s(40);const r=s(12);const a=s(16);t.DEFAULT_VERIFY_ACTION_MODE={mode:"verify",param:{operator:"equal"}};const c={fill:"edit",verify:"v--circle",store:"extract-text",ignore:"aborted",reset:"rotate-left"};const l=({item:e})=>(0,i.jsxs)("div",{className:o.default.dropdownItem,children:[(0,i.jsx)(a.Icon,{icon:c[e.value]}),(0,i.jsx)("span",{children:e.name})]});l.displayName="FieldActionItem";const u=({item:e})=>(0,i.jsx)("div",{className:o.default.dropdownItemSelected,children:(0,i.jsx)(a.Icon,{icon:c[e.value]})});u.displayName="Selected FieldActionItem";const d=[{value:"fill",name:"Input"},{value:"verify",name:"Verify"},{value:"store",name:"Store"},{value:"ignore",name:"Ignore"},{value:"reset",name:"Reset"}];t.ActionSelection=(0,r.observer)((({onUpdate:e,onReset:s,action:a,stepType:c,metadata:p,fillable:h})=>{const f=(0,r.useLocalStore)((e=>({get options(){const t=[];if(e.metadata.type==="multipicklist"){t.push("store")}if(!h){t.push("fill")}return d.filter((e=>!t.includes(e.value)))},get fieldAction(){return d.find((t=>{var s;return t.value===((s=e.action)===null||s===void 0?void 0:s.mode)}))},onFieldActionUpdate(t){if(t.value==="reset"){e.onReset()}else{e.onUpdate(this.defaultAction(t.value))}},defaultAction(e){switch(e){case"fill":return{mode:"fill"};case"verify":return t.DEFAULT_VERIFY_ACTION_MODE;case"store":return{mode:"store",param:{scope:"test",type:"string"}};case"ignore":return{mode:"ignore"};default:throw new Error("Invalid Field Action Mode")}}})),{onUpdate:e,onReset:s,action:a,stepType:c,metadata:p});return(0,i.jsx)("div",{className:o.default.actionSelection,children:(0,i.jsx)(n.Dropdown,{className:o.default.sfdcDropDown,containerClassName:o.default.sfdcDropDownWrapper,searchable:false,options:f.options,value:f.fieldAction,onChange:f.onFieldActionUpdate,renderItem:l,SelectedItemRenderComponent:u})})}));t.ActionSelection.displayName="ActionSelection"},function(e,t,s){"use strict";s.r(t);t["default"]={actionSelection:"ActionSelection_actionSelection_2soTA_9tbW9uVUkt",dropdownItem:"ActionSelection_dropdownItem_YEJ3Q_9tbW9uVUkt",dropdownItemSelected:"ActionSelection_dropdownItemSelected_4uino_9tbW9uVUkt",sfdcDropDown:"ActionSelection_sfdcDropDown_1YGCo_9tbW9uVUkt",sfdcDropDownWrapper:"ActionSelection_sfdcDropDownWrapper_2EJFn_9tbW9uVUkt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ExpectedOutcome=void 0;const i=s(4);const o=s(10);const n=s(666);const r=s(0);const a=s(249);t.ExpectedOutcome=(0,r.memo)((({toggleLabels:e,toggleState:t=true,setToggleState:s})=>{const c=(0,r.useCallback)((e=>s(e.target.checked)),[s]);return(0,i.jsx)("div",{className:(0,o.default)(n.default.expectedOutcome),children:(0,i.jsx)(a.ToggleSwitch,{checked:t,onChange:c,variety:"regular",direction:"right",wrapperClassName:(0,o.default)(n.default.toggleWrapper),children:t?e.selected:e.unselected})})}));t.ExpectedOutcome.displayName="ExpectedOutcome"},function(e,t,s){"use strict";s.r(t);t["default"]={expectedOutcome:"ExpectedOutcome_expectedOutcome_2Fy5m_9tbW9uVUkt",toggleWrapper:"ExpectedOutcome_toggleWrapper_3dbCx_9tbW9uVUkt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ToggleSwitch=void 0;const i=s(4);const o=s(0);const n=s(250);const r=s(10);const a=s(6);const c=s(16);const l=["children","className","wrapperClassName","variety","dark","checkedIcon","uncheckedIcon","checkedIconClassname","uncheckedIconClassname"];const u=o.memo((e=>{var t;return(0,i.jsxs)("label",{className:(0,r.default)(n.default.toggleSwitchLabel,n.default[(t=e.direction)!==null&&t!==void 0?t:"left"],e.wrapperClassName,{[n.default.disabled]:e.disabled}),children:[(0,i.jsxs)("div",{className:(0,r.default)(n.default.switch,e.variety&&n.default[e.variety],e.theme!==undefined&&n.default[e.theme],{[n.default.checked]:e.checked,[n.default.disabled]:e.disabled}),children:[(0,i.jsx)("span",{className:(0,r.default)(n.default.state,{[n.default.checked]:e.checked})}),(0,i.jsx)("input",{type:"checkbox",className:(0,r.default)(n.default.checkbox,e.className),...a.omit(e,l)}),(e.variety==="icons"||e.variety==="small-icons")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.Icon,{icon:e.uncheckedIcon,className:(0,r.default)(n.default.iconUnchecked,e.uncheckedIconClassname,{[n.default.activated]:!e.checked})}),(0,i.jsx)(c.Icon,{icon:e.checkedIcon,className:(0,r.default)(n.default.iconChecked,e.checkedIconClassname,{[n.default.activated]:e.checked})})]})]}),e.children]})}));t.ToggleSwitch=u;u.displayName="ToggleSwitch"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.MarketplaceWrapperStep=void 0;const n=s(669);const r=s(91);const a=s(111);const c=s(51);const l=s(72);const u=s(2);class d extends r.SharedStepInstance{_update(e){if(e.sharedStepInfoId){this.sharedStepInfoId=e.sharedStepInfoId}a.ParameterStep.prototype._update.call(this,e);return this}getSharedStepClass(e){return this.isNew&&this.sharedStepClass?Promise.resolve(this.sharedStepClass):e.loadSharedStepClass(this.sharedStepInfoId)}getSharedStepInfo(e){return e.getInfoById(this.sharedStepInfoId)}getMarketplaceCustomization(e=c.sharedStepSingleton){var t,s;const i=this.getSharedStepInfo(e);if((t=i===null||i===void 0?void 0:i.marketplace)===null||t===void 0?void 0:t.customization){return n.marketplaceCustomizations[(s=i===null||i===void 0?void 0:i.marketplace)===null||s===void 0?void 0:s.customization]}return undefined}isParameterValueChanged(e){var t;return Boolean((t=e.updateClassParameters)===null||t===void 0?void 0:t.length)}async syncWithSharedStepClass(e){var t;const s=await this.getSharedStepClass(e);this.sharedStepClass=s;this.setMergedParameters(s);await((t=this.getMarketplaceCustomization(e))===null||t===void 0?void 0:t.onSyncWithSharedStepClass(this,e));return this}canEditStep(e,t){return Boolean(e.result&&this.getMarketplaceCustomization()&&t)}getClassParameterValues(){return this.parameterValues}getFrameLocators(){return[]}getDisplayName(){var e,t,s;return(s=(t=(e=this.getSharedStepInfo(c.sharedStepSingleton))===null||e===void 0?void 0:e.marketplace)===null||t===void 0?void 0:t.name)!==null&&s!==void 0?s:""}getStepPreview(){return this.getDisplayName()}getIcon(){var e,t,s;return(s=(t=(e=this.getSharedStepInfo(c.sharedStepSingleton))===null||e===void 0?void 0:e.marketplace)===null||t===void 0?void 0:t.icon)!==null&&s!==void 0?s:super.getIcon()}getStopOnError(){return l.Step.prototype.getStopOnError.call(this)}getTreatAsWarning(){return l.Step.prototype.getTreatAsWarning.call(this)}getStepCondition(){return this.condition}hasTimeoutOverrideOption(){var e,t;return(t=(e=this.sharedStepClass)===null||e===void 0?void 0:e.hasTimeoutOverrideOption())!==null&&t!==void 0?t:false}getFriendlyName(){var e,t,s;return(s=(t=(e=this.getSharedStepInfo(c.sharedStepSingleton))===null||e===void 0?void 0:e.marketplace)===null||t===void 0?void 0:t.name)!==null&&s!==void 0?s:""}getTestimDocsUrl(){var e,t;return(t=(e=this.getMarketplaceCustomization())===null||e===void 0?void 0:e.testimDocsUrl)!==null&&t!==void 0?t:""}}t.MarketplaceWrapperStep=d;i([u.observable.ref,o("design:type",void 0)],d.prototype,"sharedStepClass",void 0)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.marketplaceCustomizations=void 0;const i=s(5);const o=s(112);t.marketplaceCustomizations={"salesforce-auto-login":{propertyPanel:{custom:"salesforce-login",allowLoop:false,allowContext:false},testimDocsUrl:i.commonConstants.documentationUrls.SALESFORCE_AUTO_LOGIN_STEP,onSyncWithSharedStepClass:async(e,t)=>{const s=new o.RevisionsService;s.sharedStepService=t;const i=e.getStepContent();await Promise.all([...i].filter((({step:e})=>e.type==="shared-step-instance")).map((({step:e})=>s.assureSynchronizedStep(e))));[...i].filter((({step:e})=>e.type==="mfa")).forEach((({step:t})=>{if(t&&e.secrets){t.secrets=e.secrets}}))}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SFDC_TOURS=t.SFDC_TOUR_NAMES=void 0;const i=s(671);const o=s(785);const n=s(793);const r=s(794);const a=s(795);const c=s(272);const l=s(796);t.SFDC_TOUR_NAMES={SFDC_WELCOME_SCREEN:"sfdc-welcome-screen",SFDC_RUN_FIRST_TEST:"sfdc-run-first-test",SFDC_RUN_AND_SCHEDULE:"sfdc-run-and-schedule",SFDC_ACTIVATE_SCHEDULED_RUN:"sfdc-activate-scheduled-run",SFDC_PROJECT_NAVIGATION_MENU:"sfdc-project-navigation-menu",SFDC_LETS_START_SCREEN:"sfdc-lets-start-screen",SFDC_CREATE_ENVIRONMENT:"sfdc-create-environment",SFDC_INVITE_USER:"sfdc-invite-user",SFDC_CREATE_FIRST_TEST:"sfdc-create-first-test",SFDC_COMPLETE_SETTINGS:"sfdc-settings-section-updates",SFDC_MISSING_ENVIRONMENT:"sfdc-connect-environment",SFDC_MISSING_PERSONA:"sfdc-navigate-to-personas",SFDC_CREATE_SAMPLE_TESTS:"sfdc-create-sample-tests"};t.SFDC_TOURS={[t.SFDC_TOUR_NAMES.SFDC_WELCOME_SCREEN]:{steps:[o.tourGuideModal(i.WelcomeToTricentisTestAutomationDemo,"welcome-to-tta-for-salesforce-demo",false)],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_LETS_START_SCREEN]:{steps:[o.tourGuideModal(i.ConnectEnvironment,t.SFDC_TOUR_NAMES.SFDC_LETS_START_SCREEN,false)],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_COMPLETE_SETTINGS]:{steps:[o.tourGuideModal(i.ConnectSalesforceEnvironment,"setup-full")],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_MISSING_ENVIRONMENT]:{steps:[o.tourGuideModal(i.CreateFirstTestButNoEnvironmentOrPersona,"missing-environment")],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_MISSING_PERSONA]:{steps:[o.tourGuideModal(i.CreateFirstTestButNoPersona,"missing-personas"),o.sidebarItem("cog",["We need to add a login persona.","Click on the gear icon to go to the settings section."]),o.selectTab(2)],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_CREATE_ENVIRONMENT]:{steps:[o.nullStep(),o.headerButtonAddNewTest()],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_CREATE_FIRST_TEST]:{steps:[o.tourGuideModal(i.FirstTestTourIntroduction,"lets-start-screen"),o.stepModalAddStep(0,a.SFDC_STEP_TYPES.LOGIN,"Click here to create a log in step",n.default,"STEP 1/11"),o.propertyPanelClassNameArea("Select login persona",`.${r.default.profileSelector}`,{closePanel:true},undefined,"select-login-profile","STEP 2/11"),o.stepModalAddStep(1,a.SFDC_STEP_TYPES.LAUNCH_APP,"The next step is to launch an App",undefined,"STEP 3/11"),o.metadataSelection(c.Branch.Apps,{closePanel:true},"STEP 4/11"),o.stepModalAddStep(2,a.SFDC_STEP_TYPES.SOBJECT_CREATE,"Now let's create an object",undefined,"STEP 5/11"),...o.metadataSelections([c.Branch.Sobjects,c.Branch.RecordTypes],undefined,"STEP 6/11"),o.fillRequiredFields(undefined,"STEP 7/11"),o.closePanel("close-create-property-panel","STEP 8/11"),o.stepModalAddStep(3,a.SFDC_STEP_TYPES.SOBJECT_VALIDATE,"Add the Validate step",undefined,"STEP 9/11"),o.closePanel("close-validate-property-panel","STEP 10/11"),o.stepModalAddStep(4,a.SFDC_STEP_TYPES.LOGOUT,"Last thing to do is log out of Salesforce",undefined,"STEP 11/11"),o.saveTest({modalDefaults:{modalName:"newTestInfo",title:"My First Test",description:"A guided test creation"}})],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_RUN_FIRST_TEST]:{steps:[o.runTest()],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_RUN_AND_SCHEDULE]:{steps:[o.runTest(),o.nullStep(),o.tourGuideModal(i.ScheduleAfterSaveAndRun,"schedule-after-first-test",false)],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_ACTIVATE_SCHEDULED_RUN]:{steps:[o.nullStep(),o.scheduleToggle()],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_PROJECT_NAVIGATION_MENU]:{steps:[o.selectProject()],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_INVITE_USER]:{steps:[o.inviteUser()],autoStop:true},[t.SFDC_TOUR_NAMES.SFDC_CREATE_SAMPLE_TESTS]:{steps:[o.bySelector(`.${l.default.createButton}`,"The AI Test Creator automatically generates sample tests for your Salesforce Environment to get you started testing.",{analyticsTag:"create-sample-tests",extraTooltipStyles:{width:"310px",marginBottom:"10px"}})],autoStop:true}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ScheduleAfterSaveAndRun=t.ConnectSalesforceEnvironment=t.CreateFirstTestButNoEnvironmentOrPersona=t.CreateFirstTestButNoPersona=t.FirstTestTourIntroduction=t.WelcomeToTricentisTestAutomationDemo=t.ConnectEnvironment=void 0;const i=s(4);const o=s(0);const n=s(0);const r=s(672);const a=s(270);const c=s(252);const l=s(11);const u=s(26);const d=s(66);const p=s(79);const h=s(28);const f=s(34);const m=s(15);const g=s(271);const v=s(782);t.ConnectEnvironment=(0,n.memo)((()=>{const e=(0,l.useDependencyInjector)(c.SfdcTourService);const t=(0,l.useDependencyInjector)(u.UrlStateService);const s=(0,l.useDependencyInjector)(m.ProjectsService);return(0,i.jsx)(r.TourGuide,{slides:[{Media:a.CogWheels,smallTitle:"Let's connect your Salesforce environment!",textItems:["To create Salesforce aware tests, you need to first connect your Salesforce environment."],callToActions:[{text:"Let's go",clickAction:"nextSlide"}]},{Media:a.CogWheels,smallTitle:"Do you have the admin login credentials for Salesforce?",textItems:["If not, you can invite an admin or users who have the admin credentials to configure the Salesforce details with TTA for Salesforce."],callToActions:[{text:"Invite Users",variety:"secondary",clickAction:"onClick",onClick:()=>{e.handleContinuationResponse("DoYouHaveAdmin?","no",c.TOUR_NAMES.SFDC_INVITE_USER);t.go(d.projectTeam(s.projectId))}},{text:"Yes, I have",clickAction:"onClick",onClick:()=>{e.handleContinuationResponse("DoYouHaveAdmin?","yes",c.TOUR_NAMES.SFDC_CREATE_ENVIRONMENT);t.go(d.projectSettings(s.projectId,"salesforce"))}}]}]})}));t.WelcomeToTricentisTestAutomationDemo=(0,n.memo)((()=>{const e=(0,l.useDependencyInjector)(h.ModalService);const t=()=>{e.openModal(v.ReloadPageAfterInstallExtension)};const s=()=>{localStorage.setItem(p.INSTALL_EXTENSION_REFRESH_COOKIE,"true");e.openModal(g.InstallExtensionModal,{beforeClose:t,blackMode:true})};return(0,i.jsx)(r.TourGuide,{slides:[{Media:a.RocketLaptop,largeTitle:"Welcome",smallTitle:"to Tricentis Test Automation for Salesforce.",subTitle:"Test early. Test often. Test effectively.",textItems:["We're excited to have you here! Let's go to our Demo project to see how easy it is to run Salesforce tests."],callToActions:[{text:"Let's go",clickAction:"nextAndOnClick",onClick:s}]}]})}));t.FirstTestTourIntroduction=(0,n.memo)((()=>(0,i.jsx)(r.TourGuide,{slides:[{Media:a.PlusDocs,smallTitle:"Let's create our first test!",textItems:["Let's build a test! We have already gathered information about your account so this will be easy."],callToActions:[{text:"Create Later",variety:"secondary",clickAction:"exitTour"},{text:"Let's go",clickAction:"nextTourStep"}]}]})));const S=(0,n.memo)((({remaining:e,title:t,text:s})=>{const o=(0,l.useDependencyInjector)(c.SfdcTourService);const n=(0,l.useDependencyInjector)(u.UrlStateService);const h=(0,l.useDependencyInjector)(m.ProjectsService);return(0,i.jsx)(r.TourGuide,{slides:[{Media:a.CogWheels,smallTitle:t||"Let's create our first test! But...",textItems:[s||"Before that, you must perform the action's below:"],listItems:[e.includes("environment")&&(0,i.jsx)(i.Fragment,{children:"Connect and authorize your Salesforce environment."}),e.includes("persona")&&(0,i.jsx)(i.Fragment,{children:"Create a Login Persona."}),e.includes("extension")&&(0,i.jsxs)(i.Fragment,{children:["Install the ",(0,i.jsx)("a",{onClick:p.openInstallExtensionTab,children:"Tricentis Testim extension."})]})].filter(Boolean),callToActions:[e.includes("environment")?{text:"Let's go",clickAction:"onClick",onClick:()=>{var e;(e=o.productTourService)===null||e===void 0?void 0:e.startTourFromBeginning(c.TOUR_NAMES.SFDC_CREATE_ENVIRONMENT);n.go(d.projectSettings(h.projectId,"salesforce"))}}:{text:"Let's go",clickAction:"nextTourStep"}]}]})}));t.CreateFirstTestButNoPersona=(0,n.memo)((()=>(0,i.jsx)(S,{remaining:["persona"]})));t.CreateFirstTestButNoEnvironmentOrPersona=(0,n.memo)((()=>(0,i.jsx)(S,{remaining:["environment","persona"]})));t.ConnectSalesforceEnvironment=(0,n.memo)((()=>(0,i.jsx)(S,{title:"Let's configure your Salesforce details!",text:"To get set up to create Salesforce aware tests, you must perform the actions below:",remaining:["environment","persona"]})));t.ScheduleAfterSaveAndRun=(0,n.memo)((()=>{const e=(0,l.useDependencyInjector)(c.SfdcTourService);const t=(0,l.useDependencyInjector)(m.ProjectsService);const s=(0,l.useDependencyInjector)(f.BranchesService);const o=(0,l.useDependencyInjector)(u.UrlStateService);return(0,i.jsx)(r.TourGuide,{slides:[{Media:a.TadaEmoji,smallTitle:"Hurray, you have saved and run your test!",textItems:["You can now schedule this test to run in our Cloud. It's an efficient and effective way to test the quality of your Salesforce environments"],callToActions:[{text:"Let's Schedule",clickAction:"onClick",onClick:()=>{e.handleScheduledRunTour();o.go(d.schedulers(t.projectId,s.branch))}}]}]})}));S.displayName="ConfigurationSetup";t.ScheduleAfterSaveAndRun.displayName="ScheduleAfterSaveAndRun";t.CreateFirstTestButNoPersona.displayName="CreateFirstTestButNoPersona";t.CreateFirstTestButNoEnvironmentOrPersona.displayName="CreateFirstTestButNoEnvironmentOrPersona";t.ConnectSalesforceEnvironment.displayName="ConnectSalesforceEnvironment";t.ConnectEnvironment.displayName="ConnectEnvironment";t.WelcomeToTricentisTestAutomationDemo.displayName="WelcomeToTricentisTestAutomationDemo";t.FirstTestTourIntroduction.displayName="FirstTestTourIntroduction"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TourGuide=t.TourSlide=void 0;const i=s(4);const o=s(251);const n=s(0);const r=s(30);const a=s(31);const c=s(11);const l=s(252);const u=s(770);const d=({slide:e,slideIndex:t,changeSlide:s})=>{var n;const r=(0,c.useDependencyInjector)(l.SfdcTourService);const d=e=>{var i;(i=r.productTourService)===null||i===void 0?void 0:i.track("click-tour-guide-cta",{clickAction:e.clickAction});if(typeof e.clickAction==="number"){return s(e.clickAction)}switch(e.clickAction){case"onClick":return e.onClick();case"nextAndOnClick":r.advanceToNextStep();return e.onClick();case"nextSlide":return s(t+1);case"nextTourStep":return r.advanceToNextStep();case"exitTour":return r.exitTour();default:return null}};return(0,i.jsxs)(i.Fragment,{children:[e.Media?(0,i.jsx)(e.Media,{}):(0,i.jsx)("div",{className:o.default.minContentArea}),e.largeTitle&&(0,i.jsx)("div",{className:o.default.largeTitle,children:e.largeTitle}),e.smallTitle&&(0,i.jsx)("div",{className:o.default.smallTitle,children:e.smallTitle}),e.subTitle&&(0,i.jsx)("div",{className:o.default.subTitle,children:e.subTitle}),(0,i.jsx)("div",{className:o.default.minContentArea}),((n=e.textItems)===null||n===void 0?void 0:n.length)&&e.textItems.map(((e,t)=>(0,i.jsx)("div",{className:o.default.textItem,children:e},t))),(0,i.jsxs)("div",{className:o.default.minContentArea,children:[e.listItems&&(0,i.jsx)(u.OrderedList,{style:"bullet",items:e.listItems}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:o.default.cta,children:e.callToActions.filter((e=>e.shouldDisplay?e.shouldDisplay():true)).map(((e,t)=>(0,i.jsx)(a.Cta,{variety:e.variety,onClick:()=>d(e),children:e.text},t)))})]})]})};t.TourSlide=d;t.TourSlide.displayName="TourSlide";const p=({slides:e})=>{const[s,a]=(0,n.useState)(0);const u=(0,c.useDependencyInjector)(l.SfdcTourService);const d=()=>{u.exitTour()};return(0,i.jsx)(r.BaseModal,{bodyClassName:o.default.body,className:o.default.modal,closeOnEscape:false,closeOnClickOutside:false,closeModal:d,children:(0,i.jsx)(t.TourSlide,{slide:e[s],slideIndex:s,changeSlide:a})})};t.TourGuide=p;t.TourGuide.displayName="TourGuide"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T;Object.defineProperty(t,"__esModule",{value:true});t.SchedulerStore=void 0;const E=s(6);const I=s(66);const C=s(8);const D=s(674);const O=s(73);const A=s(9);const j=s(15);const w=s(253);const R=s(49);const P=s(21);const x=s(39);const M=s(28);const N=s(102);const F=s(85);const L=s(14);const k=s(55);const B=s(767);const U=s(22);const G=s(5);const V=s(29);const H=s(7);const $=s(154);const W=s(161);const J=s(20);const Y=s(26);const z=s(107);const q=s(768);const X=s(27);const Z=s(2);const Q=s(34);const K=s(48);const ee=s(769);const te=H.Logger.getLogger("schedulerStore");let se=class e{constructor(e,t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g){this.branchesService=e;this.projectsService=t;this.testimServices=s;this.urlState=i;this.configListStore=o;this.companiesService=n;this.analyticsService=r;this.runsService=a;this.editedTestStore=c;this.userService=l;this.gridsService=u;this.testListService=d;this.modalService=p;this.productTourService=h;this.featureFlagsService=f;this.premiumFeaturesService=m;this.testPlansStore=g;this.explicitUpdate=0;this.itemInListUpdate=0}initialize(){this.editedTestStore.on(G.commonConstants.scenario.TEST_SAVED,(async({wereAllStepsNewBeforeSave:e=false}={})=>{var t;const{test:s,scenario:i}=this.editedTestStore;if(!s||!i){return}const o=(t=i.baseUrl)!==null&&t!==void 0?t:s.baseUrl;await this.triggerToursAfterTestSave(s,e,o)}));return()=>{}}async triggerToursAfterTestSave(e,t,s){var i;if(this.premiumFeaturesService.isTtaSfdcEnabled&&t){if((await this.list).length>0){return}const e=((i=this.testListService.getTestList())!==null&&i!==void 0?i:[]).length;if(e>1){return}this.productTourService.startTourOncePerUser(O.TOUR_NAMES.SFDC_RUN_AND_SCHEDULE);return}if(this.userService.isManager()){if(this.productTourService.shouldStartToursForManagersAndDevelopers()){this.productTourService.startTourOncePerUser(O.TOUR_NAMES.LOCATORS_VIDEO)}return}if(this.userService.isDeveloper()){return}if(t){try{await this.suggestSchedulerCreationIfNeeded(e,s)}catch(e){te.error("failed to create suggestion scheduler",e)}}}get isPlaygroundModeState(){return(0,J.isPlaygroundModeState)(this.urlState)}get hasValidationError(){return(this.list.value||[]).some((e=>e.validationError))}decorateScheduler(e,t,s){var i,o;const n=(0,B.parseCronExp)(e.frequency);const r=n.type;const a=n.weekDays;const c=n.type===B.SCHEDULER_TYPES.MONITOR?(i=B.MONITOR_FREQUENCIES.find((e=>e.min===n.min&&e.hr===n.hr)))!==null&&i!==void 0?i:this.getMonitorFrequencies()[0]:this.getMonitorFrequencies()[0];const l=n.type===B.SCHEDULER_TYPES.NIGHTLY?(o=B.NIGHTLY_FREQUENCIES.find((e=>e.min===n.min&&e.hr===n.hr)))!==null&&o!==void 0?o:B.NIGHTLY_FREQUENCIES[0]:B.NIGHTLY_FREQUENCIES[0];const u=n.type===B.SCHEDULER_TYPES.MONITOR?c.name:l.name;const d=t===null||t===void 0?void 0:t.find((t=>t.id===e.testConfigId));const p=Boolean(e.notifiers&&e.notifiers.length>0);const h=p?(e.notifiers||[]).filter((e=>e.type==="email")).map((e=>({text:e.value}))):[];const f=p?(e.notifiers||[]).filter((({type:e,isSlackId:t})=>e==="slack"&&!t)).map((({value:e})=>e)):[];const m=p?(e.notifiers||[]).filter((({type:e,isSlackId:t})=>e==="slack"&&t)).map((({value:e})=>e)):[];const g=p?(e.notifiers||[]).filter((e=>e.type==="webhook")).map((({value:e})=>JSON.parse(e))):[];const v=(e.suites||[]).map((e=>typeof e==="string"?e:e.suite));const S=(e.labels||[]).map((e=>typeof e==="string"?e:e.label));const y=(e.resultLabels||[]).map((e=>({text:typeof e==="string"?e:e.label})));const b=S.map((e=>Object.assign({id:C.utils.guid(),name:e,isLabel:true})));const _=v.map((e=>Object.assign({id:C.utils.guid(),name:e,isSuite:true})));const T=E.chain(b).concat(_).filter(Boolean).orderBy("name").value();const I=T.map((e=>`${e.name}${e.isLabel?" (Label)":""}${e.isSuite?" (Suite)":""}`));const D=typeof e.lastResult==="string"?JSON.parse(e.lastResult):e.lastResult;const O=(D===null||D===void 0?void 0:D.success)?"Passed":"Failed";const A=Object.assign({},D,{status:O});const j=(0,B.testPlansWithDisplayName)(s,e.testPlans);return Object.assign({},e,{normalizedFrequency:u,normalizedTestConfig:d,normalizedType:r,normalizedWeekDays:a,normalizedMonitorFrequency:c,normalizedNightlyFrequency:l,normalizedResult:A,normalizedLabelsAndSuites:T,normalizedLabelsAndSuitesNames:I,normalizedNotifyEmails:h,normalizedNotifySlackChannels:f,normalizedNotifySlackChannelsById:m,normalizedNotifyWebhooks:g,notifyOnError:p,resultLabels:y,suites:v,labels:S,normalizedTestPlans:j,testPlansNames:j.map((e=>e.name)),validationError:e.validationError})}async suggestSchedulerCreationIfNeeded(e,t){var s,i;if(!this.schedulerRunsEnabledStatus.isEnabled||this.projectsService.isMobile){return}const o="Scheduled run";const n=(s=e.labels)===null||s===void 0?void 0:s.includes(o);const r=![...e.scenario].some((({step:e})=>!e.isGroupStep));const a=Number(this.userService.getPreferences().schedulerSuggestionsCount);const c=!n&&!r&&a>0;if(!c){return}this.analyticsService.track("suggest_scheduler_modal_opened");const l=await this.modalService.openModal(D.SuggestSchedulerModal,{baseUrl:t}).promise;if(this.testListService.getTestList()&&((i=this.testListService.getTestList())!==null&&i!==void 0?i:[]).length>1){this.productTourService.startTourOncePerNewUser(O.TOUR_NAMES.SECOND_TEST);await this.userService.completeProductTour(O.TOUR_NAMES.NEW_TEST)}else{this.productTourService.startTourOncePerNewUser(O.TOUR_NAMES.NEW_TEST);await this.userService.completeProductTour(O.TOUR_NAMES.SECOND_TEST)}if(!l){this.analyticsService.track("suggest_scheduler_modal_closed");this.userService.setSchedulerSuggestionsCount(0);return}this.analyticsService.track("suggest_scheduler_modal_run");const[u,d]=await Promise.all([this.gridsService.getCompanyGrids(),this.list,this.testListService.addLabelToTestsByIds([e.id],o),this.userService.setSchedulerSuggestionsCount(Math.max(a-1,0))]);const p=(()=>{var e;if(this.gridsService.preferredGrid){const e=this.gridsService.preferredGrid._id;const t=u.find((({_id:t})=>t===e));if(t){return e}}return(e=u[0])===null||e===void 0?void 0:e._id})();if(!p){return}const h=(()=>{if(!d||d.length===0){return undefined}return d.find((e=>e.name===o&&e.labels.includes(o)))})();if(h){await this.runSchedulers([h]);this.urlState.go(I.executions(this.projectsService.projectId,this.branchesService.branch));return}await this.createSchedulerFromSuggestion({baseUrl:l.baseUrl,captcha:l.captcha,name:o,gridId:p,label:o,runImmediately:true})}getTimeZoneAdjustedCronHour(){const e=new Date;const t=Math.round(e.getHours()+e.getTimezoneOffset()/60);return String(t<0?24+t:t)}async createSchedulerFromSuggestion({baseUrl:e,captcha:t,name:s,gridId:i,label:o,runImmediately:n}){const r=(0,B.buildCronExpression)({type:"NightlyRun",nightlyFrequency:{hr:this.getTimeZoneAdjustedCronHour(),min:String(0)},weekDays:{}});const a={schedulerId:C.utils.guid(),name:s,description:"",frequency:r,labels:[o],gridId:i,baseUrl:e,browser:"chrome",notifyOnError:true,notifyEmails:[this.userService.getUserEmail()],shouldNotifyEveryFailure:false,suites:[],parallel:1,retries:0,branch:G.MASTER_BRANCH,resultLabels:[],captcha:t};if(n){await this.createScheduler(a);await this.runSchedulers([a]);return this.urlState.go(I.executions(this.projectsService.projectId,this.branchesService.branch))}await this.createScheduler(a);const c=(await this.list)[0];return this.updateSchedulerEnable(c.schedulerId,false)}getMonitorFrequencies(){return this.companiesService.isInFreePlan()?B.MONITOR_FREE_FREQUENCIES:B.MONITOR_FREQUENCIES}getNightlyFrequencies(){return B.NIGHTLY_FREQUENCIES}async buildList(){try{const{projectId:e}=this.projectsService;const[t,s,i]=await Promise.all([this.testimServices.scheduler.getAll({projectId:e,isPlaygroundMode:this.isPlaygroundModeState}),this.configListStore.configList,this.testPlansStore.testPlans]);this.itemInListUpdate=0;return t.map((e=>(0,Z.observable)(this.decorateScheduler(e,s,i))))}catch(e){te.error("failed fetching scheduler list",{error:e});return[]}}get list(){const e=this.explicitUpdate;return(0,X.fromPromise)(this.buildList())}get schedulerRunsEnabledStatus(){if(this.runsService.isExecutionBlockedDueToQuota.value){return{isEnabled:false,reason:G.commonConstants.error.QUOTA_EXECUTION_BLOCKED}}return{isEnabled:true}}async createScheduler(e){const t=e;t.projectId=this.projectsService.projectId;t.token=this.projectsService.ciToken;await this.testimServices.scheduler.create(t);this.analyticsService.schedulerCreated(e);this.explicitUpdate++}async deleteSchedulers(e){const{projectId:t}=this.projectsService;const s=e.map((e=>e.schedulerId));await this.testimServices.scheduler.deleteSchedulers(t,s);this.analyticsService.schedulerDeleted(e);this.explicitUpdate++}async updateScheduler(e){const t=e;t.projectId=this.projectsService.projectId;t.token=this.projectsService.ciToken;await this.testimServices.scheduler.update(t);this.explicitUpdate++}async updateSchedulerEnable(e,t){const{projectId:s}=this.projectsService;const i=(await this.list).find((t=>t.schedulerId===e));await this.testimServices.scheduler.enable(s,e,this.projectsService.ciToken,t);if(i){i.enabled=t;this.itemInListUpdate++;this.explicitUpdate++}if(t){this.analyticsService.schedulerEnabled(e)}else{this.analyticsService.schedulerDisabled(e)}}async runSchedulers(e){const{projectId:t}=this.projectsService;if(!this.schedulerRunsEnabledStatus.isEnabled){te.warn('Scheduler was force-blocked after an attempt to run from the UI. This probably means that a "Play" button was not disabled even though the runs are blocked.',{projectId:t});throw new W.ExecutionBlockedError}const s=e=>({projectId:t,schedulerId:e.schedulerId,token:this.projectsService.ciToken,labels:e.labels,baseUrl:e.baseUrl,testConfigId:e.testConfigId,suites:e.suites,gridId:e.gridId,parallel:e.parallel,branch:e.branch,customExtensionUrl:e.customExtensionUrl,resultLabels:e.resultLabels,testTimeoutSec:e.testTimeoutSec,isManuallyTriggered:true});const i=e.map((e=>this.testimServices.remote.runScheduler(s(e))));await Promise.all(i);this.analyticsService.schedulerRun(e)}isTestPlanInSchedulerEnabled(){return this.featureFlagsService.flags.testPlanInScheduler.isEnabled()}async sfdcCreateFirstScheduler(){var e,t;const s=this.editedTestStore.test||((e=this.testListService.getTestList())===null||e===void 0?void 0:e[0]);if(!s){return}const i="Scheduled run";const o=(t=s.labels)===null||t===void 0?void 0:t.includes(i);if(o){return}const[n,r]=await Promise.all([this.gridsService.getCompanyGrids(),this.list,this.testListService.addLabelToTestsByIds([s.id],i)]);const a=(()=>{var e;if(this.gridsService.preferredGrid){const e=this.gridsService.preferredGrid._id;const t=n.find((({_id:t})=>t===e));if(t){return e}}return(e=n[0])===null||e===void 0?void 0:e._id})();if(!a||r.length>0||!s.baseUrl){return}await this.createSchedulerFromSuggestion({baseUrl:s.baseUrl,captcha:null,name:i,gridId:a,label:i,runImmediately:false})}};t.SchedulerStore=se;i([Z.observable,o("design:type",Object)],se.prototype,"explicitUpdate",void 0);i([Z.observable,o("design:type",Object)],se.prototype,"itemInListUpdate",void 0);i([Z.computed,o("design:type",Object),o("design:paramtypes",[])],se.prototype,"isPlaygroundModeState",null);i([Z.computed,o("design:type",Object),o("design:paramtypes",[])],se.prototype,"hasValidationError",null);i([Z.computed,o("design:type",typeof(T=typeof q.ObservablePromiseWithDefaultValue!=="undefined"&&q.ObservablePromiseWithDefaultValue)==="function"?T:Object),o("design:paramtypes",[])],se.prototype,"list",null);t.SchedulerStore=se=i([(0,A.injectable)(),(0,K.exposeGlobally)("schedulerStore"),o("design:paramtypes",[typeof(n=typeof Q.BranchesService!=="undefined"&&Q.BranchesService)==="function"?n:Object,typeof(r=typeof j.ProjectsService!=="undefined"&&j.ProjectsService)==="function"?r:Object,typeof(a=typeof U.TestimServicesApi!=="undefined"&&U.TestimServicesApi)==="function"?a:Object,typeof(c=typeof Y.UrlStateService!=="undefined"&&Y.UrlStateService)==="function"?c:Object,typeof(l=typeof z.ConfigListStore!=="undefined"&&z.ConfigListStore)==="function"?l:Object,typeof(u=typeof x.CompaniesService!=="undefined"&&x.CompaniesService)==="function"?u:Object,typeof(d=typeof P.AnalyticsService!=="undefined"&&P.AnalyticsService)==="function"?d:Object,typeof(p=typeof $.RunsService!=="undefined"&&$.RunsService)==="function"?p:Object,typeof(h=typeof V.EditedTestStore!=="undefined"&&V.EditedTestStore)==="function"?h:Object,typeof(f=typeof R.UserService!=="undefined"&&R.UserService)==="function"?f:Object,typeof(m=typeof N.GridsService!=="undefined"&&N.GridsService)==="function"?m:Object,typeof(g=typeof w.TestListService!=="undefined"&&w.TestListService)==="function"?g:Object,typeof(v=typeof M.ModalService!=="undefined"&&M.ModalService)==="function"?v:Object,typeof(S=typeof F.ProductTourService!=="undefined"&&F.ProductTourService)==="function"?S:Object,typeof(y=typeof L.FeatureFlagsService!=="undefined"&&L.FeatureFlagsService)==="function"?y:Object,typeof(b=typeof k.PremiumFeaturesService!=="undefined"&&k.PremiumFeaturesService)==="function"?b:Object,typeof(_=typeof ee.TestPlansStore!=="undefined"&&ee.TestPlansStore)==="function"?_:Object])],se)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(675),t)},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.SuggestSchedulerModal=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(852);const a=s(0);const c=s(30);const l=s(680);const u=s(31);const d=s(11);const p=s(22);const h=s(32);const f=s(44);const m=s(5);const g=s(39);const v=s(21);const S=s(16);const y=s(55);const b=({closeModal:e,baseUrl:t,captcha:s,isUrlAccessible:o,forceCaptcha:n})=>(0,i.jsxs)("div",{children:[(0,i.jsx)(u.Cta,{disabled:!o||!s&&n,onClick:()=>e({baseUrl:t,captcha:s}),children:"Run"}),(0,i.jsx)(u.Cta,{variety:"secondary",onClick:()=>e(),children:"Cancel"})]});b.displayName="SuggestSchedulerModalFooter";const _=e=>{const t=(0,d.useDependencyInjector)(v.AnalyticsService);const[s,n]=(0,a.useState)(e.baseUrl);const c=(0,a.useRef)(null);const u=({keyCode:t,target:s})=>{if(t===m.commonConstants.KEYS.enter){e.setBaseUrl(s.value)}};const p=s=>{t.track("suggest_scheduler_modal_confirm_captach");e.setCaptcha(s)};if(e.loading){return(0,i.jsxs)("div",{className:(0,o.default)(l.default.message,l.default.loading),children:[(0,i.jsx)(S.Icon,{icon:"loader"}),(0,i.jsxs)("div",{children:["Checking url ",s]})]})}if(e.isUrlAccessible){return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:(0,o.default)(l.default.message,l.default.success),children:[(0,i.jsx)(S.Icon,{icon:"validation"}),"Great! testim cloud servers can connect to this enviroment."]}),e.forceCaptcha&&(0,i.jsx)("div",{className:l.default.captcha,children:(0,i.jsx)(r.default,{sitekey:m.commonConstants.recaptcha.PUBLIC_KEY,ref:c,onChange:p,onExpired:()=>{var e;return(e=c.current)===null||e===void 0?void 0:e.reset()}})})]})}return(0,i.jsxs)(f.FieldLabel,{error:"Something went wrong, the url cant be reached. Please add it again",children:[(0,i.jsx)("span",{children:"URL to your accessible app"}),(0,i.jsx)(h.Textbox,{value:s,onChange:e=>n(e.target.value),onKeyDown:u,onBlur:t=>e.setBaseUrl(t.target.value)})]})};_.displayName="SuggestSchedulerModalContent";const T=t=>{const s=(0,d.useDependencyInjector)(p.TestimServicesApi);const o=(0,d.useDependencyInjector)(g.CompaniesService);const n=(0,d.useDependencyInjector)(y.PremiumFeaturesService);const[r,u]=(0,a.useState)(true);const[h,f]=(0,a.useState)(t.baseUrl);const[m,v]=(0,a.useState)("");const[S,T]=(0,a.useState)(false);const E=!e.env.airgap&&!o.isPayingPlan()&&!n.isTtaSfdcEnabled;(0,a.useEffect)((()=>{(async()=>{u(true);const{success:e}=await s.remote.testUrlAvailability(h);T(e);u(false)})()}),[h]);return(0,i.jsx)(c.BaseModal,{className:l.default.suggestScheduler,closeModal:()=>t.closeModal(),header:(0,i.jsx)("h3",{children:"HURRAY, YOUR FIRST SAVED TEST!"}),footer:(0,i.jsx)(b,{...t,captcha:m,forceCaptcha:E,baseUrl:h,isUrlAccessible:!r&&S}),children:(0,i.jsxs)("div",{className:l.default.modalContent,children:["Do you want us to start running this test daily?",(0,i.jsx)("br",{}),"If the test fails well notify you via email.",(0,i.jsx)(_,{loading:r,baseUrl:h,setBaseUrl:f,setCaptcha:v,forceCaptcha:E,isUrlAccessible:S})]})})};t.SuggestSchedulerModal=T;t.SuggestSchedulerModal.displayName="SuggestSchedulerModal"}).call(this,s(35))},,,,,function(e,t,s){"use strict";s.r(t);t["default"]={"suggest-scheduler":"suggestScheduler_suggest-scheduler_28LQm_hlZHVsZXIt",suggestScheduler:"suggestScheduler_suggest-scheduler_28LQm_hlZHVsZXIt","modal-content":"suggestScheduler_modal-content_CGfrR_hlZHVsZXIt",modalContent:"suggestScheduler_modal-content_CGfrR_hlZHVsZXIt",message:"suggestScheduler_message_1BdLr_hlZHVsZXIt",captcha:"suggestScheduler_captcha_1OREp_hlZHVsZXIt",loading:"suggestScheduler_loading_1R3OG_hlZHVsZXIt",rotate:"suggestScheduler_rotate_38NT9_hlZHVsZXIt",success:"suggestScheduler_success_Q2l2j_hlZHVsZXIt"}},function(e,t,s){"use strict";s.r(t);t["default"]={discardTestModal:"testList_discardTestModal_3wkcf_V0b21hdGUt",backToOpenedTestModal:"testList_backToOpenedTestModal_1h9F3_V0b21hdGUt"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c;Object.defineProperty(t,"__esModule",{value:true});t.LabelsStore=void 0;const l=s(2);const u=s(9);const d=s(22);const p=s(15);const h=s(26);const f=s(20);const m=s(27);const g=s(253);const v=s(61);const S=s(5);const y=s(6);let b=class e{constructor(e,t,s){this.testimServices=e;this.projectsService=t;this.urlState=s;this.explicitUpdate=0;this._isPlaygroundModeState=false;this._isPlaygroundModeState=(0,f.isPlaygroundModeState)(this.urlState)}async preformAction(e,t){if((0,y.isEmpty)(e)){return}const s=this.projectsService.projectId;await t(s,e);this.explicitUpdate++}async deleteLabels(e){await this.preformAction(e,(async(e,t)=>{const s=v.container.get(g.TestListService);await this.testimServices.label.delete(e,t);await s.getTestListAsync(true)}))}async addLabels(e){await this.preformAction(e,(async(e,t)=>await this.testimServices.label.create(e,t)))}get labels(){const e=this.explicitUpdate;return(0,m.fromPromise)(this.loadLabelList())}get labelsOrEmptyArray(){return this.labels.state!=="fulfilled"?[]:this.labels.value}get testListLabels(){const e=v.container.get(g.TestListService);return(0,m.fromPromise)((async()=>{const[t,s]=await Promise.all([this.labels,e.testList]);const i={};s.forEach((e=>{var t;(t=e.labels)===null||t===void 0?void 0:t.forEach((e=>{i[e]=i[e]+1||1}))}));return{values:t.filter((e=>i[e.name])),labelsCounter:i}})())}async loadLabelList(){if(this.projectsService.projectId===S.commonConstants.defaults.FAKE_CODE_PROJECT_ID&&this._isPlaygroundModeState){return[]}const e=await this.testimServices.label.getAll({projectId:this.projectsService.projectId});const t=Object.keys(e).sort(((e,t)=>e.localeCompare(t)));return t.map((e=>({name:e,title:e})))}};t.LabelsStore=b;i([l.observable,o("design:type",Object)],b.prototype,"explicitUpdate",void 0);i([l.computed,o("design:type",typeof(c=typeof m.IPromiseBasedObservable!=="undefined"&&m.IPromiseBasedObservable)==="function"?c:Object),o("design:paramtypes",[])],b.prototype,"labels",null);i([l.computed,o("design:type",Array),o("design:paramtypes",[])],b.prototype,"labelsOrEmptyArray",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],b.prototype,"testListLabels",null);t.LabelsStore=b=i([(0,u.injectable)(),o("design:paramtypes",[typeof(n=typeof d.TestimServicesApi!=="undefined"&&d.TestimServicesApi)==="function"?n:Object,typeof(r=typeof p.ProjectsService!=="undefined"&&p.ProjectsService)==="function"?r:Object,typeof(a=typeof h.UrlStateService!=="undefined"&&h.UrlStateService)==="function"?a:Object])],b)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d,p,h,f,m,g,v,S,y,b,_,T,E;Object.defineProperty(t,"__esModule",{value:true});t.StepLoader=void 0;const I=s(6);const C=s(66);const D=s(8);const O=s(7);const A=s(43);const j=s(20);const w=s(63);const R=s(112);const P=s(34);const x=s(91);const M=s(5);const N=s(80);const F=s(100);const L=s(84);const k=s(29);const B=s(129);const U=s(104);const G=s(165);const V=s(240);const H=s(51);const $=s(684);const W=s(73);const J=s(85);const Y=s(9);const z=s(2);const q=s(26);const X=s(27);const Z=s(78);const Q=s(21);const K=s(107);const ee=s(62);const te=s(15);const se=s(49);const ie=s(14);const oe=s(162);const{DEFAULT_PAGE_URL:ne,SMALL_SCREEN:re}=M.commonConstants.defaults;var ae;(function(e){e["TEST_RESULT_PARAMS_ERROR"]="Failed to load test run parameters"})(ae||(ae={}));let ce=class e{constructor(e,t,s,i,o,n,r,a,c,l,u,d,p,h,f,m,g,v,S){this.branchesService=e;this.notificationDisplayService=t;this.revisionsService=s;this.editorSelectionService=i;this.urlStateService=o;this.recordingStore=n;this.playbackStore=r;this.editedTestStore=a;this.testResultStore=c;this.testController=l;this.testStreamService=u;this.productTourService=d;this.userService=p;this.projectsService=h;this.hostService=f;this.analyticsService=m;this.configListStore=g;this.featureFlagsService=v;this.hooksService=S;this.isTestLoading=false;this.logger=O.Logger.getLogger("step-loader");this.loadUtils=new F.LoadUtils(A.testimServicesSingleton);(0,X.keepAlive)(this,"routeParams")}get routeParams(){const e=this.urlStateService.params;return{testId:e.testId,stepId:e.stepId,resultId:e["result-id"],revisionId:e["revision-id"],iterationId:e["iteration-id"],sharedStepInstance:e["shared-step-instance"],parentFolderId:e["parent-folder-id"],projectId:decodeURIComponent(e.projectId),branch:e.branch}}async init(){var e;const{testId:t,resultId:s,revisionId:i,projectId:o,branch:n,parentFolderId:r}=this.routeParams;this.currentTestId=this.editedTestStore.testId;this.isTestLoading=true;try{await this.branchesService.checkoutBranch(this.urlStateService.pathParams.branch);if(!t||t==="new"){return await this.createAndGoToNewTest({checkExtensionExists:false,parentFolderId:r})}if(t==="bugim"){return await this.createAndGoToBugimTest()}if(this.editedTestStore.testId===t&&!(this.editedTestStore.test&&s&&((e=this.editedTestStore.test)===null||e===void 0?void 0:e.resultId)!==s)){return await this.loadStep()}if(s){return await this.loadTestResult(t,s,o,n)}return await this.loadTest(t,o,n,i)}finally{this.isTestLoading=false;this.branchesService.setBranchChangedInEditorContext(false)}}clearAllEditorStates(){var e;this.editedTestStore.reset();this.recordingStore.stopRecording();this.playbackStore.stopPlaying();this.editorSelectionService.clearSelection();this.playbackStore.isRemoteRunning=false;this.playbackStore.isLocalCliRun=false;$.stepImageCacheService.clear();this.playbackStore.isPaused=false;this.recordingStore.insertionContainer=this.editedTestStore.scenario;this.notificationDisplayService.removeNotifications(this.notificationDisplayService.WAIT_DISPLAY);if((e=this.testController.missingSteps)===null||e===void 0?void 0:e.length){this.notificationDisplayService.sendNotification("Error on loading test, not all steps were loaded")}this.testResultStore.reset();this.recordingStore.startRecordingOnTestLoaded();this.productTourService.startTourOncePerNewUser(W.TOUR_NAMES.START_RECORDING)}async createAndGoToNewTest({baseUrl:e,testConfig:t,checkExtensionExists:s=true,parentFolderId:i}={}){var o;const n=this.featureFlagsService.flags.verboseNewTestLogs.isEnabled()?this.logger:{log:I.noop};e||(e=this.projectsService.defaultBaseUrl||"");t||(t=await this.configListStore.getDefaultConfigPerProjectType());const r=(o=this.projectsService.projectType)!==null&&o!==void 0?o:M.commonConstants.test.DESKTOP_WEB;this.clearAllEditorStates();if(s){await this.hostService.activeHost.canRecord()}this.playbackStore.stopPlaying();this.recordingStore.stopRecording();n.log("Creating new test",{baseUrl:e,testConfig:t,testType:r});try{const s=this.testController.createNewTest(this.userService.getLoggedUserInfo(),e,t,r);if(s){this.analyticsService.testCreated({id:s.id});const e=C.test(this.projectsService.projectId,this.branchesService.branch,s.id,undefined,i,this.urlStateService.params);n.log("navigating to newly created test url",{testUrl:e,location:window.location.href});this.urlStateService.go(e)}}catch(e){this.notificationDisplayService.sendNotification((e===null||e===void 0?void 0:e.message)||"Could not start a new test");throw e}return undefined}async createAndGoToBugimTest(){const e=this.urlStateService.params.baseUrl||ne;const t={height:parseInt(this.urlStateService.params.height||re.height,10),width:parseInt(this.urlStateService.params.width||re.width,10)};await this.createAndGoToNewTest({baseUrl:e,testConfig:new Z.TestConfig({resolution:t})});await this.recordingStore.toggleRecording({analyticsEventSource:"popup-new-test",defaultUrl:e});return undefined}async loadTestResultParams(e){const{runParams:t,runParamsUrl:s}=e;if(!I.isEmpty(t)||!s){return e}try{const t=await A.testimServicesSingleton.storage.downloadJSONFile(s,undefined,undefined,2);e.runParams=t}catch(t){this.logger.error(`Failed to load run params for test ${e.id}`,t);throw new Error(ae.TEST_RESULT_PARAMS_ERROR)}return e}async loadTestResult(e,t,s,i){var o;const n=Date.now();const{branchesService:r,notificationDisplayService:a,loadUtils:c,logger:l}=this;try{await r.waitForBranchesReady();this.clearAllEditorStates();const o=await c.loadResult(e,t,s,i);if(!o){throw new Error(`result ${t} does not exists`)}const a=Boolean(o.revisionStatus||o.revisions);const u=I.mapValues(o.revisions||o.revisionStatus,(e=>{if(typeof e==="object"){return e.revisionId}return e}));if(a&&o.sharedStepClasses){await H.sharedStepSingleton.setSharedStepClasses(o.sharedStepClasses);await this.hooksService.setHooksSharedStepClasses(o.runConfig,o.sharedStepClasses)}H.sharedStepSingleton.setCurrentRevisions(u);const d=await this.testController.loadTest({id:e,revisionId:u.test,branch:i,resultId:t,projectId:s,skipSharedSteps:a});try{await D.utils.promiseTimeout(this.testStreamService.listenToTestStream(d.id),1e4)}catch(e){l.warn("failed to start to listen to test stream",e)}if(o){this.testResultStore.testResult=await this.loadTestResultParams(o);this.playbackStore.onTestResultLoaded(o,e)}const p=await this.loadStep();this.isTestLoading=false;const h=Date.now()-n;if(h>1e3*10){l.log(`Loading result for test ${e} took ${h}`,{projectId:s,branch:i,testId:e,resultId:t})}return p}catch(t){if(!(0,j.isPlaygroundModeState)(this.urlStateService)){if(!await r.isItemInBranch(e)){a.sendNotification(`Test is not in branch ${i}`)}else if(((o=t===null||t===void 0?void 0:t.failure)===null||o===void 0?void 0:o.status)===404){a.sendNotification("Test result does not exist")}else if(Object.values(ae).includes(t.message)){a.sendNotification(t.message)}else{a.sendNotification("Failed loading result")}}this.urlStateService.go(C.test(s,i,e));return undefined}}async loadTest(e,t,s,i){const{notificationDisplayService:o,testController:n,urlStateService:r}=this;const a=r.pathTemplate;this.clearAllEditorStates();try{await n.loadTest({id:e,revisionId:i,branch:s,projectId:t,skipSharedSteps:false});return await this.loadStep()}catch(e){if((e===null||e===void 0?void 0:e.code)===M.commonConstants.error.CIRCULAR_SCENARIO_DETECTED){o.sendNotification(e.message);this.logger.error(e.message,e);r.go(C.testList(t,s));return undefined}if(r.pathTemplate===a){const e=this.branchesService.branchChangedInEditorContext?`Test does not exists on '${s}' branch`:"Error loading test";o.sendNotification(e);r.go(C.testList(t,s))}throw e}}getInnerStepPath(e,t){const s=I.chain(this.getStepHierarchy(e)).uniq().slice(t).value();return s.length>0?s.join(":"):null}getStepHierarchy(e){var t;return(t=this.editedTestStore.scenario)===null||t===void 0?void 0:t.getStepPath(e.id)}getStateStepPath(e){let t=this.urlStateService.params.path;if(!e.getStepContent().isGroupStep&&t){t=I.chain(t).split(":").dropRight().join(":").value()}const s=this.getInnerStepPath(e,1);return t||s}setInnerStepResultsOnHooks(e,t,s){const i=e.getStepContent();e.reset();if(i.getStepContent().isGroupStep){i.steps.forEach((e=>{if(e.screenImage){e.screenImage=""}}))}if(i.screenImage){i.screenImage=""}const o=this.urlStateService.searchParams.path.split(":");const n=o.some((e=>this.hooksService.hooksPathToIgnore.has(`${s}-${e}`)));if(n){return}let r;const a=t===M.HOOK.HANDLER.BEFORE_TEST||t===M.HOOK.HANDLER.AFTER_TEST;if(a){r=this.hooksService.getRelevantTestHooksResults(t)}else{r=this.hooksService.getHooksResultByStepId(s)}if(r.length<=1){return}if(!e.getStepContent().isGroupStep&&i){let s;r=r.filter((e=>e.id===i.id));const n=o.length>1&&r.length>1;const c=()=>{if(a||!this.hooksService.beforeAndAfterHooksAreSame){return 0}return t.startsWith("before")?0:1};const l=c();if(n){const e=r.find((e=>{var t;return(t=e.path)===null||t===void 0?void 0:t.includes(o.at(-1))}));s=e||r[l]}else{s=r[l]}if(s){i.setResult(s);e.setResult(s);return}}else{let t=[i.id];t=i.steps.filter((e=>e.type!=="group")).map((e=>e.id));let o=false;t.forEach((t=>{var i,n;if(o){this.hooksService.hooksPathToIgnore.add(`${s}-${t}`);return}const a=(n=(i=e===null||e===void 0?void 0:e.getStepContent())===null||i===void 0?void 0:i.findStepById)===null||n===void 0?void 0:n.call(i,t);if(a){const e=r.find((e=>e.id===a.id));if(e){a.setResult(e);if(!e.success){o=true}}}}))}const c=r.filter((e=>e.hookType===t));const l=c.find((e=>e.stepScreenshot))||c[0];if(!e.result&&e.id!==i.id&&l){e.setResult(l)}}setInnerStepResultsOnSteps(e){const{iterationId:t}=this.routeParams;const s=this.getStateStepPath(e);if(e.getStepContent().isGroupStep){e.reset()}try{const i=I.chain(s===null||s===void 0?void 0:s.split(":")).dropRight().value();const o=i.length>0?i.join(":"):null;const n=this.testResultStore.getStepResult(o,e.id,t);if(n){e.setResult(n)}}catch(t){this.logger.error(`failed to set result on step ${e.id}`,t)}const i=this.testResultStore.getInnerStepsResults(s);I.chain(i).groupBy("id").map((e=>{const s=e.map((e=>e.iterationId)).filter(Boolean);if(I.isEmpty(s)){return e[0]}const i=e.find((e=>e.iterationId===t));if(i){return i}const o=I.chain(e).filter((e=>e.iterationId&&(I.isEmpty(t)||e.iterationId.startsWith(`${t}:`)))).sortBy("iteration").value();const n=o.at(-1);if(n&&!n.whileLoopEvaluated){return n}const r=o[0]||{};const a=r.path?`${r.path}:${r.id}`:undefined;return this.testResultStore.getFirstIteration(r,a,t)})).forEach((t=>{var s,i;if(!t){return}const o=(i=(s=e===null||e===void 0?void 0:e.getStepContent())===null||s===void 0?void 0:s.findStepById)===null||i===void 0?void 0:i.call(s,t.id);if(o){o.setResult(t)}if(t.id===e.id){e.setResult(t)}})).value()}async getSynchronizedStep(e){if(e instanceof x.SharedStepInstance){return await this.revisionsService.assureSynchronizedStep(e)}return e}handleStepSet(e,t,s){const i=e;if(i.type==="setup"){return}this.editorSelectionService.setInitialSelection(i);if(t&&s){this.setInnerStepResultsOnHooks(i,t,s)}else{this.setInnerStepResultsOnSteps(i)}this.recordingStore.insertionContainer=i.getStepContent()}async loadStep(){var e,t,s;const{editedTestStore:i,branchesService:o,notificationDisplayService:n,logger:r}=this;const{testId:a}=this.routeParams;const c=i.scenario;const l=c&&(this.currentTestId!==a||o.branchChangedInEditorContext);const u=l?this.revisionsService.synchronizeAllStep(c):[];const d=I.flattenDeep(await u||[]);if(d.length>0){r.error("error while trying to load test, missing steps: ",d);n.sendNotification("Note: Some steps were not loaded")}let p;const h=this.urlStateService.params.stepId;const f=this.urlStateService.params.sharedStepId;let m=false;if(h){p=c===null||c===void 0?void 0:c.findStepById(h,true);const e=this.urlStateService.searchParams.hook;if(!p&&e){p=this.hooksService.hookSteps.get(e);if(p instanceof x.SharedStepInstance){p=p.findStepById(h,true)||p;m=true}}}else if(f){const e=[...c].find((e=>{var t;return e.step instanceof x.SharedStepInstance&&e.step.sharedStepInfoId===f||((t=e.sharedStep)===null||t===void 0?void 0:t.sharedStepInfoId)===f}));if(!e){return undefined}const t=e.path;const s=t.pop();this.urlStateService.pathParams.stepId=t.at(-1);this.urlStateService.searchParams.path=t.join(":");const i=this.urlStateService.pathParams.branch;const o=this.urlStateService.pathParams.projectId;const n=this.urlStateService.searchParams["shared-step-instance"];const r=this.urlStateService.searchParams["result-id"];const l=this.urlStateService.searchParams["iteration-id"];if(t.length){this.urlStateService.go(C.testResultWithStepPath(o,i,a,t.at(-1),t.join(":"),r,l,n,{},s));return undefined}}if(!p&&((e=i.testConfig)===null||e===void 0?void 0:e.id)===h){p=i.testConfig}if(!p&&h&&(0,j.isInEditor)(this.urlStateService.pathTemplate)){const e=this.urlStateService.params.branch;const t=this.urlStateService.params.projectId;const s=this.urlStateService.params.testId;const i=this.urlStateService.params["result-id"];if(o.branchChangedInEditorContext&&this.urlStateService.params.path){n.sendNotification(`Step does not exists on '${e}' branch`)}this.urlStateService.go(C.testResult(t,e,s,i));return undefined}const g=c===null||c===void 0?void 0:c.id;if(p){const e=this.urlStateService.navigationHistory;p.getParentUrl=()=>{var t;const s=e[0];const o=this.urlStateService.params.stepId;const n=this.urlStateService.params.path||"";const r=n.split(":").filter(Boolean);const c=this.urlStateService.searchParams["result-id"]||this.testResultStore.currentTestResultId;const l=this.urlStateService.searchParams["iteration-id"];const u=this.urlStateService.searchParams["shared-step-instance"];let d=this.urlStateService.searchParams.hook;let h=this.urlStateService.searchParams.hookedStepId;const f=e=>I.isEmpty(p.getStepPath(e));const v=()=>I.chain(e).filter((({fromTemplate:e})=>e===j.stepPathTemplate)).filter((({toParams:e})=>e.stepId===p.id)).filter((({toParams:e})=>e["result-id"]===c)).filter((({fromParams:e})=>e.stepId!==p.id)).map((({fromParams:e})=>e.stepId)).compact().find(f).value();const S=()=>I.chain(e).filter((({fromTemplate:e})=>e===j.stepPathTemplate)).map((({fromParams:e})=>e.stepId)).find((e=>r.includes(e))).value();const y=s&&s.fromTemplate===j.testPathTemplate&&s.fromParams.testId===this.routeParams.testId;let b=v()||S()||I.chain(r).dropRight().last().value();function _(e){var t;if(!l){return undefined}const s=(t=i.scenario)===null||t===void 0?void 0:t.getStepByPath(e);if(!s){return undefined}if(s.getStepWhileLoop()){return l.split(":").slice(0,-1).join(":")}return l}const T=this.hooksService.hookSteps.get(d);if(d&&!(T===null||T===void 0?void 0:T.findStepById(o,true))){d=undefined;h=undefined}const E=(t=s===null||s===void 0?void 0:s.fromParams)===null||t===void 0?void 0:t.hook;const D=Boolean(!d&&E);if(D){b=I.chain(r).dropRightWhile((e=>e===o)).last().value()}const O=I.chain(r).dropRightWhile((e=>e!==b)).value();if(b&&o!==b&&b!==g&&!y&&!I.isEmpty(O)){const e=O.join(":");const t=m||D?l:_(n);return C.testResultWithStepPath(this.projectsService.projectId,this.branchesService.branch,a,b,e,c,t,u,{hook:d,hookedStepId:h})}return C.testResult(this.projectsService.projectId,this.branchesService.branch,a,c!==null&&c!==void 0?c:"")}}try{const e=await this.getSynchronizedStep(p||c);const i=this.urlStateService.searchParams.hook;const o=this.urlStateService.searchParams.hookedStepId;this.handleStepSet(e,i,o);const n=this.urlStateService.navigationHistory[0];const r=(t=n===null||n===void 0?void 0:n.fromParams)===null||t===void 0?void 0:t.hookedStepId;const a=(s=n===null||n===void 0?void 0:n.fromParams)===null||s===void 0?void 0:s.hook;if(r&&a&&(!i&&!o)){this.hooksService.openLastSelectedHookStep(r,a);if(a===M.HOOK.HANDLER.AFTER_TEST){this.analyticsService.track("hook-aftertest-present",{afterTestAction:"fromAfterTest"})}}if(this.hooksService.seeErrorStepId){this.hooksService.onSeeErrorHookLoaded()}return e}catch(e){if(e&&e.code===M.commonConstants.error.CIRCULAR_SCENARIO_DETECTED){this.currentTestId="";n.sendNotification(e.message)}r.error("failed to load step: ",e);n.sendNotification("Could not load step");if(p===null||p===void 0?void 0:p.getParentUrl){this.urlStateService.go(p.getParentUrl());return undefined}this.urlStateService.go(C.testResult(this.projectsService.projectId,this.branchesService.branch,a,this.urlStateService.params["result-id"]));return undefined}}};t.StepLoader=ce;i([z.observable,o("design:type",Object)],ce.prototype,"isTestLoading",void 0);i([z.computed.struct,o("design:type",Object),o("design:paramtypes",[])],ce.prototype,"routeParams",null);i([z.action,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],ce.prototype,"clearAllEditorStates",null);i([z.action,o("design:type",Function),o("design:paramtypes",[Object,String,String]),o("design:returntype",void 0)],ce.prototype,"setInnerStepResultsOnHooks",null);i([z.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],ce.prototype,"setInnerStepResultsOnSteps",null);i([z.action,o("design:type",Function),o("design:paramtypes",[Object,String,String]),o("design:returntype",void 0)],ce.prototype,"handleStepSet",null);t.StepLoader=ce=i([(0,Y.injectable)(),o("design:paramtypes",[typeof(n=typeof P.BranchesService!=="undefined"&&P.BranchesService)==="function"?n:Object,typeof(r=typeof w.NotificationDisplayService!=="undefined"&&w.NotificationDisplayService)==="function"?r:Object,typeof(a=typeof R.RevisionsService!=="undefined"&&R.RevisionsService)==="function"?a:Object,typeof(c=typeof N.EditorSelectionService!=="undefined"&&N.EditorSelectionService)==="function"?c:Object,typeof(l=typeof q.UrlStateService!=="undefined"&&q.UrlStateService)==="function"?l:Object,typeof(u=typeof L.RecordingStore!=="undefined"&&L.RecordingStore)==="function"?u:Object,typeof(d=typeof U.PlaybackStore!=="undefined"&&U.PlaybackStore)==="function"?d:Object,typeof(p=typeof k.EditedTestStore!=="undefined"&&k.EditedTestStore)==="function"?p:Object,typeof(h=typeof B.TestResultStore!=="undefined"&&B.TestResultStore)==="function"?h:Object,typeof(f=typeof G.TestController!=="undefined"&&G.TestController)==="function"?f:Object,typeof(m=typeof V.TestStreamService!=="undefined"&&V.TestStreamService)==="function"?m:Object,typeof(g=typeof J.ProductTourService!=="undefined"&&J.ProductTourService)==="function"?g:Object,typeof(v=typeof se.UserService!=="undefined"&&se.UserService)==="function"?v:Object,typeof(S=typeof te.ProjectsService!=="undefined"&&te.ProjectsService)==="function"?S:Object,typeof(y=typeof ee.HostService!=="undefined"&&ee.HostService)==="function"?y:Object,typeof(b=typeof Q.AnalyticsService!=="undefined"&&Q.AnalyticsService)==="function"?b:Object,typeof(_=typeof K.ConfigListStore!=="undefined"&&K.ConfigListStore)==="function"?_:Object,typeof(T=typeof ie.FeatureFlagsService!=="undefined"&&ie.FeatureFlagsService)==="function"?T:Object,typeof(E=typeof oe.HooksService!=="undefined"&&oe.HooksService)==="function"?E:Object])],ce)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.stepImageCacheService=t.StepImageCacheService=void 0;const i=s(8);const o=s(43);const n=s(685);const r=s(42);const a=s(2);const c=s(314);const l=s(14);class u{constructor(){this.imageCache=new a.ObservableMap}get baselineImageCache(){return this.getOrCreateImageCache("baseline")}get resultImageCache(){return this.getOrCreateImageCache("result")}get lastSuccessfulResultCache(){return this.getOrCreateImageCache("lastSuccessfulResult")}get panelThumbnailCache(){return this.getOrCreateImageCache("panelThumbnail")}get stepButtonThumbnailCache(){return this.getOrCreateImageCache("stepButtonThumbnail")}get entireElementAreaInThumbnailCache(){return this.getOrCreateImageCache("entireElementAreaInThumbnail")}get logScreenshotCache(){return this.getOrCreateImageCache("logScreenshot")}getStepResultImage(e){if(!(e===null||e===void 0?void 0:e.result)){return undefined}return e.result.stepScreenshot||e.result.screenImage}getStepResultHighlightRectangle(e){if(!(e===null||e===void 0?void 0:e.result)){return undefined}return e.result.screenImageHighlight}getStepBaselineImage(e){if(!e){return undefined}return e.getScreenImage()}getStepBaselineHighlightRectangle(e){if(!e){return undefined}return e.getScreenImageHighlight()}tryToHeadImage(e,t){let s=10*1e3;let o=5;const n=1e3;async function a(){e.searchParams.set("time",String(Date.now()));try{return await r.httpRequest.head(e.toString())}catch(e){s-=n;o--;if(s<0||o<1){return r.httpRequest.head(t).catch((()=>{throw new Error("timeout while waiting for image head")}))}await i.utils.delay(n);return a()}}return a()}getImageObject(e){return new Promise(((t,s)=>{const i=new Image;i.onload=()=>{t(i)};i.onerror=()=>s(new Error("Failed to load image"));i.src=e}))}async createOptimalImage(e,t,s,o,r){const a=(0,c.convertTestResultArtifactUrlToCloudinaryOrMinio)(e,o,r);const u=i.utils.isDataUrl(a);const d=(0,n.imageManipulatorFactory)({isOnPrem:o,isDataUrl:u});const p=l.default.flags.useLocalImageManipulator.isEnabled();if(u||p){return d.highlightSelection(e,t,s)}if(!o&&!d.isCloudinaryImage(a)){return a}const h=await d.highlightSelection(a,t,s);return d.replaceWithJpeg(h)}async waitUntilUrlReturnSuccess(e,t,s){const n=await i.utils.buildArtifactUrlWithToken(e,i.utils.getServicesUrl(),o.testimServicesSingleton);const r=(0,c.convertTestResultArtifactUrlToCloudinaryOrMinio)(e,t,s);if(!n){return undefined}return this.tryToHeadImage(n,r)}async loadImage(e){const{imageCache:t,cacheKey:s,imageUrlOrDataUrl:o,highlightRectangle:n,highlightWithBorder:r,isOnPrem:a,storageBaseUrl:c}=e;if(!o){t.set(s,{isLoaded:true,isAvailable:false,ratio:1});return undefined}t.set(s,{isLoaded:false,isAvailable:false,ratio:1});try{if(!i.utils.isDataUrl(o)){await this.waitUntilUrlReturnSuccess(o,a,c)}let e=await this.createOptimalImage(o,n,r,a,c);let l;try{l=await this.getImageObject(e)}catch(t){if(e.endsWith(".jpg")&&o.endsWith(".png")){e=e.replace(/\.jpg$/,".png");l=await this.getImageObject(e)}else{throw t}}const{width:u,height:d}=l;this.imageLoadedSuccessfully(t,s,e,u,d)}catch(e){this.imageLoadFailed(t,s)}return undefined}buildResultCacheKey(e){if(!("result"in e)||!e||!e.result||!e.result.stepResultId){return undefined}return e.result.stepResultId}buildBaselineOrLastSuccessfulResultCacheKey(e){if(!(e===null||e===void 0?void 0:e.id)){return undefined}return e.id}async addBaselineImageToCache(e,t,s){if(!e){return undefined}const i=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!i||this.baselineImageCache.has(i)){return undefined}const o=this.getStepBaselineImage(e);const n=this.getStepBaselineHighlightRectangle(e);await this.loadImage({imageCache:this.baselineImageCache,imageUrlOrDataUrl:o,highlightRectangle:n,highlightWithBorder:true,isOnPrem:t,storageBaseUrl:s,cacheKey:i});return undefined}async forceRefreshBaselineImageInCache(e,t,s){const i=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(i){this.baselineImageCache.delete(i)}await this.addBaselineImageToCache(e,t,s)}async addResultImageToCache(e,t,s){if(!(e===null||e===void 0?void 0:e.result)){return undefined}const i=this.buildResultCacheKey(e);if(!i||this.resultImageCache.has(i)){return undefined}const o=this.getStepResultImage(e);const n=this.getStepResultHighlightRectangle(e);await this.loadImage({imageCache:this.resultImageCache,imageUrlOrDataUrl:o,highlightRectangle:n,highlightWithBorder:true,isOnPrem:t,storageBaseUrl:s,cacheKey:i});return undefined}stepAlreadyInLastSuccessfulCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);return Boolean(t&&this.lastSuccessfulResultCache.has(t))}async addLastSuccessfulResultImageToCache(e){const{lastSuccessfulResult:t,step:s,isOnPrem:i,storageBaseUrl:o}=e;if(!s){return undefined}if(this.stepAlreadyInLastSuccessfulCache(s)){return undefined}const n=this.buildBaselineOrLastSuccessfulResultCacheKey(s);this.lastSuccessfulResultCache.set(n,{isLoaded:false,isAvailable:false,ratio:1,compareImageIsLoading:false});const r=t.stepsResults||{};const a=Object.values(r).find((e=>e.id===s.id));if(!a){this.lastSuccessfulResultCache.set(n,{isLoaded:true,isAvailable:false,ratio:1,compareImageIsLoading:false});return undefined}const c=this.getStepResultImage({result:a});const l=this.getStepResultHighlightRectangle({result:a});await this.loadImage({imageCache:this.lastSuccessfulResultCache,imageUrlOrDataUrl:c,highlightRectangle:l,highlightWithBorder:true,isOnPrem:i,storageBaseUrl:o,cacheKey:n});this.lastSuccessfulResultCache.get(n).orgImageUrlOrDataUrl=c;return undefined}async addCompareToLastSuccessfulResultToCache(e){const{step:t}=e;if(!t){return undefined}const s=this.buildBaselineOrLastSuccessfulResultCacheKey(t);const n=this.lastSuccessfulResultCache.get(s);n.compareImageIsLoading=true;const r=this.getStepBaselineImage(t);const a=await i.utils.buildArtifactUrlWithToken(n.orgImageUrlOrDataUrl,i.utils.getServicesUrl(),o.testimServicesSingleton);const c=a&&a instanceof URL?a.toString():a;n.compareImageDataUrl=await this.compareLastSuccessfulResultToBaseline(c,r);n.compareImageIsLoading=false;return undefined}async compareLastSuccessfulResultToBaseline(e,t){if(!e||!t){return undefined}const[i,o]=await Promise.all([r.httpRequest.getBlob(e),r.httpRequest.getBlob(t)]);const{compareImages:n}=await Promise.resolve().then((()=>s(692)));const a=await n(o,i,{});return a.getImageDataUrl()}elementAlreadyInThumbnailCache(e,t){const s=this.buildBaselineOrLastSuccessfulResultCacheKey(e);return Boolean(s&&this.getOrCreateImageCache(t).has(s))}async addThumbnailToCache(e){const{isOnPrem:t,imageUrlOrDataUrl:s,elementRectangle:o,thumbnailSize:r,isInput:a,shouldHighlight:c,element:l,imageCache:u,type:d}=e;if(!s||!l||this.elementAlreadyInThumbnailCache(l,d)){return undefined}const p=this.buildBaselineOrLastSuccessfulResultCacheKey(l);const{width:h,height:f}=r;try{const e=i.utils.isDataUrl(s);const l=()=>{const i=(0,n.imageManipulatorFactory)({isOnPrem:t,isDataUrl:e});if(d==="entireElementAreaInThumbnail"){return i.getEntireElementAreaInThumbnail(s,o,r)}return i.thumbnailFromArea(s,o,r,a,c)};const m=l();u.set(p,{isLoaded:false,isAvailable:false,ratio:1,imageLoadPromise:m});const g=await m;this.imageLoadedSuccessfully(u,p,g,h,f)}catch(e){this.imageLoadFailed(u,p)}return undefined}addStepButtonThumbnailToCache(e){const{step:t}=e;const s={width:180,height:75};if(i.utils.isUiVerificationStep(t.type)){return this.addThumbnailToCache({...e,type:"entireElementAreaInThumbnail",imageCache:this.entireElementAreaInThumbnailCache,thumbnailSize:s,shouldHighlight:false})}return this.addThumbnailToCache({...e,type:"stepButtonThumbnail",imageCache:this.stepButtonThumbnailCache,thumbnailSize:s,shouldHighlight:true})}addPanelThumbnailToCache(e){return this.addThumbnailToCache({...e,type:"panelThumbnail",imageCache:this.panelThumbnailCache,thumbnailSize:{width:236,height:95},shouldHighlight:false})}async addLogScreenshotToCache(e,t,s,i){const o=e;if(!o||this.resultImageCache.has(o)){return undefined}const n=t.imageHighlight?{...t.imageHighlight,pixelRatio:t.pixelRatio||1}:undefined;await this.loadImage({imageCache:this.logScreenshotCache,imageUrlOrDataUrl:t.imageUrl,highlightRectangle:n,highlightWithBorder:false,isOnPrem:s,storageBaseUrl:i,cacheKey:o});return undefined}compareImageIsLoading(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);const s=this.lastSuccessfulResultCache.get(t);return s.compareImageIsLoading}imageLoadedSuccessfully(e,t,s,i,o){const n=e.get(t);if(!n){return undefined}e.set(t,{isAvailable:true,isLoaded:true,ratio:o/i,height:o,width:i,optUrlOrDataUrl:s});return undefined}imageLoadFailed(e,t){const s=e.get(t);if(!s){return undefined}s.isAvailable=false;s.isLoaded=true;return undefined}getOrCreateImageCache(e){if(this.imageCache.has(e)){return this.imageCache.get(e)}this.imageCache.set(e,new Map);return this.imageCache.get(e)}getBaselineImageFromCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!t){return undefined}return this.baselineImageCache.get(t)}getResultImageFromCache(e){const t=this.buildResultCacheKey(e);if(!t){return undefined}return this.resultImageCache.get(t)}getLastSuccessfulResultFromCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!t){return undefined}return this.lastSuccessfulResultCache.get(t)}getPanelThumbnailFromCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!t){return undefined}return this.panelThumbnailCache.get(t)}getStepButtonThumbnailFromCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!t){return undefined}return this.stepButtonThumbnailCache.get(t)}getEntireElementAreaInThumbnailFromCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!t){return undefined}return this.entireElementAreaInThumbnailCache.get(t)}getLogScreenshotFromCache(e){const t=this.buildBaselineOrLastSuccessfulResultCacheKey(e);if(!t){return undefined}return this.logScreenshotCache.get(t)}getImageDetailsFromCache(e,t){if(t==="baseline"){return this.getBaselineImageFromCache(e)}if(t==="result"){return this.getResultImageFromCache(e)}if(t==="lastSuccessfulResult"){return this.getLastSuccessfulResultFromCache(e)}if(t==="panelThumbnail"){return this.getPanelThumbnailFromCache(e)}if(t==="stepButtonThumbnail"){return this.getStepButtonThumbnailFromCache(e)}if(t==="entireElementAreaInThumbnail"){return this.getEntireElementAreaInThumbnailFromCache(e)}if(t==="logScreenshot"){return this.getLogScreenshotFromCache(e)}return undefined}isLoaded(e,t){const s=this.getImageDetailsFromCache(e,t);if(!s){return false}return s.isLoaded}isAvailable(e,t){const s=this.getImageDetailsFromCache(e,t);if(!s){return false}return s.isAvailable}getStepOptimalImage(e,t){const s=this.getImageDetailsFromCache(e,t);if(!(s===null||s===void 0?void 0:s.isLoaded)){return undefined}return s.optUrlOrDataUrl}async waitForStepOptimalImage(e,t){const s=this.getImageDetailsFromCache(e,t);if(!(s===null||s===void 0?void 0:s.isLoaded)){return await(s===null||s===void 0?void 0:s.imageLoadPromise)}return s.optUrlOrDataUrl}hasOriginal(e,t){if(t==="baseline"){return this.getStepBaselineImage(e)}if(t==="result"){return this.getStepResultImage(e)}return undefined}getLastSuccessfulStepOptimalImage(e){const t=this.getImageDetailsFromCache(e,"lastSuccessfulResult");if(!(t===null||t===void 0?void 0:t.isLoaded)){return undefined}return t.optUrlOrDataUrl}getCompareToLastSuccessfulStepOptimalImage(e){const t=this.getImageDetailsFromCache(e,"lastSuccessfulResult");if(!(t===null||t===void 0?void 0:t.isLoaded)){return undefined}return t.compareImageDataUrl}revokeObjectURLs(e){var t;for(const s of e.values()){if((t=s.optUrlOrDataUrl)===null||t===void 0?void 0:t.startsWith("blob:")){URL.revokeObjectURL(s.optUrlOrDataUrl)}}}clearLocateStepCache(e){if(!e){return}this.baselineImageCache.delete(e);this.panelThumbnailCache.delete(e);this.stepButtonThumbnailCache.delete(e);this.entireElementAreaInThumbnailCache.delete(e)}clear(){for(const e of this.imageCache.values()){this.revokeObjectURLs(e);e.clear()}}}t.StepImageCacheService=u;t.stepImageCacheService=new u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.imageManipulatorFactory=void 0;const i=s(686);const o=s(687);const n=s(688);const r=s(14);const a=e=>{const{isOnPrem:t,isDataUrl:s}=e;const a=r.default.flags.useLocalImageManipulator.isEnabled();if(s||a){return new n.ImageManipulatorLocal}if(t){return new o.ImageManipulatorGeneral}return new i.ImageManipulatorCloudinary};t.imageManipulatorFactory=a},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r;Object.defineProperty(t,"__esModule",{value:true});t.ImageManipulatorCloudinary=void 0;const a=s(169);const c=s(43);const l=s(8);const u=s(15);const d=s(14);const p=s(88);const h=s(7);const f=h.Logger.getLogger("image-manipulator-cloudinary");const m=c.testimServicesSingleton.utilityApis;const g="cloudinary_url_token";const v=2e4;class S extends a.BaseImageManipulator{async _getCloudinaryToken(){const e=this.projectsService.projectId;const t=e=>e>Date.now()+v;const s=l.utils.getStorage();const i=JSON.parse(s.getItem(g)||"{}");if(i&&i.projectId===e&&t(i.expiry)){return i.token}const o=Date.now();const n=await m.signCloudinaryImageUrl(e);s.setItem(g,JSON.stringify({projectId:e,token:n.token,expiry:n.duration_seconds*1e3+o}));return n.token}async buildUrl(e,t){let s=a.BaseImageManipulator.getImageName(e);let i="";if(!s){return""}const o=true&&s.match("-artifacts")&&this.featureFlagsService.flags.migrateCloudinaryAssets.isEnabled();if(o){s=s.replace("-artifacts","-assets");e=e.replace("testim/image/upload/","testim/image/authenticated/");const t=await this._getCloudinaryToken();i=`?${t}`}f.log("Image transformed using cloudinary");return this.replaceWithJpeg(`${this._getBaseUrl(e)+t.join("/")}/${s}${i}`)}_cropCloudinaryRectangle(e){return`c_crop,dpr_auto,${this._cloudinaryRectangle(e)}`}_highlight(e,t){if(!e){return[]}if(e.width===0){e.width=1}if(e.height===0){e.height=1}const s=t?3:0;const i=t?`,bo_${s}px_solid_magenta`:"";const o={left:e.left-s,top:e.top-s,width:e.width,height:e.height};const n=o.top+o.height;const r=o.left+o.width;const a="$id_current";const c=`if_ih_gt_${n}/if_iw_gt_${r}`;const l="e_colorize:50,co_black";const u=`l_$id,${this._cropCloudinaryRectangle(e)}`;const d=`fl_layer_apply,${this._cropCloudinaryRectangle(o)}${i},g_north_west`;const p="if_end/if_end";return[a,c,l,u,d,p]}_scaleToSize(e){return`c_scale,${this._cloudinarySize(e)}`}async _makeThumbnailScale(e,t){return await this.buildUrl(e,[this._scaleToSize(t)])}_highlightSelectionWithNoBorder(e,t){return this._highlight(this._roundRectangleSize(t),false)}async thumbnailFromArea(e,t,s,i,o){e=a.BaseImageManipulator.convertStorageToCloudinaryUrl(e);if(!this.isCloudinaryImage(e)){return e}t=this._roundRectangleSize(t);if(!t||t.width===0&&t.height===0){return await this._makeThumbnailScale(e,s)}const n=t.pixelRatio||1;let r=t.width-10>=s.width*n?2:1;const c=i?{x:t.left-10+s.width*r/2*n,y:t.top+t.height/2}:{x:t.left+t.width/2,y:t.top+t.height/2};const l=o?this._highlightSelectionWithNoBorder(e,t):[];const u=this._createRectangleFromCenterAndSize(c,s,n);r||(r=1);l.push(this._cropCloudinaryRectangle(this._scaleRectangle(u,r)),this._scaleToSize(u));return await this.buildUrl(e,l)}async highlightSelection(e,t,s){e=a.BaseImageManipulator.convertStorageToCloudinaryUrl(e);const i=this._roundRectangleSize(t);return await this.buildUrl(e,this._highlight(i,s))}async getEntireElementAreaInThumbnail(e,t,s){e=a.BaseImageManipulator.convertStorageToCloudinaryUrl(e);if(!this.isCloudinaryImage(e)){return e}t=this._roundRectangleSize(t);if(!t||t.width===0&&t.height===0){return e}const i=`c_fit,${this._cloudinarySize(s)},c_pad`;return await this.buildUrl(e,[this._cropCloudinaryRectangle(t),i])}}t.ImageManipulatorCloudinary=S;i([(0,p.lazyInject)(d.FeatureFlagsService),o("design:type",typeof(n=typeof d.FeatureFlagsService!=="undefined"&&d.FeatureFlagsService)==="function"?n:Object)],S.prototype,"featureFlagsService",void 0);i([(0,p.lazyInject)(u.ProjectsService),o("design:type",typeof(r=typeof u.ProjectsService!=="undefined"&&u.ProjectsService)==="function"?r:Object)],S.prototype,"projectsService",void 0)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ImageManipulatorGeneral=void 0;const i=s(169);const o=s(8);class n extends i.BaseImageManipulator{constructor(){super(...arguments);this.baseUrl=`${o.utils.getServicesUrl()}/manipulate/`}__buildUrl__(e,t){return`${this.baseUrl+t.join("&")}?url=${e}`}_highlight(e,t){if(!e){return[]}if(e.width===0){e.width=1}if(e.height===0){e.height=1}const s=3;const i={left:e.left-s,top:e.top-s,width:e.width,height:e.height};const o=["colorize=c_00000080","layer=x_c",`crop=${this._cloudinaryRectangle(e)}`];if(t){o.push(`border=w_${s},c_e70fe8`,`layer=x_${i.left},y_${i.top}`)}else{o.push(`layer=x_${e.left},y_${e.top}`)}return o}async thumbnailFromArea(e,t,s,o,n){e=i.BaseImageManipulator.convertStorageToCloudinaryUrl(e);t=this._roundRectangleSize(t);if(!t||t.width===0&&t.height===0){return this.__buildUrl__(e,[`scale=${this._cloudinarySize(s)}`])}const r=t.pixelRatio||1;const a=t.width-10>=s.width*r?2:1;const c=o?{x:t.left-10+s.width*a/2*r,y:t.top+t.height/2}:{x:t.left+t.width/2,y:t.top+t.height/2};const l=n?this._highlight(this._roundRectangleSize(t),false):[];const u=this._createRectangleFromCenterAndSize(c,s,r);l.push(`crop=${this._cloudinaryRectangle(this._scaleRectangle(u,a))}`,`scale=${this._cloudinarySize(u)}`);return this.__buildUrl__(e,l)}async highlightSelection(e,t,s){return this.__buildUrl__(i.BaseImageManipulator.convertStorageToCloudinaryUrl(e),this._highlight(this._roundRectangleSize(t),s))}async getEntireElementAreaInThumbnail(e,t,s){e=i.BaseImageManipulator.convertStorageToCloudinaryUrl(e);t=this._roundRectangleSize(t);if(!t||t.width===0&&t.height===0){return e}return this.__buildUrl__(e,[`crop=${this._cloudinaryRectangle(t)}`,`fit=${this._cloudinarySize(s)},p_auto`])}}t.ImageManipulatorGeneral=n},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.ImageManipulatorLocal=void 0;const r=s(88);const a=s(169);const c=s(22);let l;if(true){const e=s(689);const t=s(690);l=new e(new t)}class u extends a.BaseImageManipulator{async postMessageToWorker(e,t){let s={};const i=this.isCloudinaryImage(t.imageDataUrl);if(!i){s=this.testimServices.storage.getAuthHeader();t.imageDataUrl=`${this.testimServices.testimServerBaseUrl}/storage${t.imageDataUrl}`}const o=await l.postMessage(JSON.stringify({type:e,data:t,authHeader:s}));return URL.createObjectURL(o)}thumbnailFromArea(e,t,s,i,o){return this.postMessageToWorker("thumbnailFromArea",{imageDataUrl:e,elementRectangle:t,thumbnailSize:s,isInput:i,shouldHighlight:o})}highlightSelection(e,t,s){return this.postMessageToWorker("highlightSelection",{imageDataUrl:e,imageRectangle:t,addBorder:s})}async getEntireElementAreaInThumbnail(e,t,s){return this.postMessageToWorker("getEntireElementAreaInThumbnail",{imageDataUrl:e,elementRectangle:t,thumbnailSize:s})}}t.ImageManipulatorLocal=u;i([(0,r.lazyInject)(c.TestimServicesApi),o("design:type",typeof(n=typeof c.TestimServicesApi!=="undefined"&&c.TestimServicesApi)==="function"?n:Object)],u.prototype,"testimServices",void 0)},,function(e,t,s){e.exports=function(){return s(691)('(function(t){var e={};function a(n){if(e[n]){return e[n].exports}var r=e[n]={i:n,l:false,exports:{}};t[n].call(r.exports,r,r.exports,a);r.l=true;return r.exports}a.m=t;a.c=e;a.d=function(t,e,n){if(!a.o(t,e)){Object.defineProperty(t,e,{enumerable:true,get:n})}};a.r=function(t){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})};a.t=function(t,e){if(e&1)t=a(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);a.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n};a.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};a.d(e,"a",e);return e};a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};a.p="";return a(a.s=0)})([function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:true});const n=a(1);const r=a(3);const i=new n.ImageManipulatorLocalOffscreenCanvas;r((t=>{const e=JSON.parse(t);const{type:a,data:n,authHeader:r}=e;i.setAuthHeader(r);if(a==="highlightSelection"){const{imageDataUrl:t,imageRectangle:e,addBorder:a}=n;return i.highlightSelection(t,e,a)}if(a==="thumbnailFromArea"){const{imageDataUrl:t,elementRectangle:e,thumbnailSize:a,isInput:r,shouldHighlight:o}=n;return i.thumbnailFromArea(t,e,a,r,o)}if(a==="getEntireElementAreaInThumbnail"){const{imageDataUrl:t,elementRectangle:e,thumbnailSize:a}=n;return i.getEntireElementAreaInThumbnail(t,e,a)}return undefined}))},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.ImageManipulatorLocalOffscreenCanvas=void 0;const n=a(2);class r extends n.BaseImageManipulator{constructor(){super(...arguments);this._authHeader={}}setAuthHeader(t){this._authHeader=t}createCanvas(t,e){return new OffscreenCanvas(t,e)}drawImage(t,e,a,n=1){const r=this.createCanvas(e,a);const i=r.getContext("2d");i.globalAlpha=n;i.drawImage(t,0,0,e,a);return{canvas:r,ctx:i}}cropImage(t,e,a,n,r){const i=t.getImageData(e,a,r,n);const o=this.createCanvas(r,n);const s=o.getContext("2d");s.rect(0,0,r,n);s.fillStyle="white";s.fill();s.putImageData(i,0,0);return{canvas:o,ctx:s}}scaleToFit(t,e){const{width:a,height:n}=e;const r=Math.min(a/t.width,n/t.height);const i=a/2-t.width/2*r;const o=n/2-t.height/2*r;const s=this.createCanvas(a,n);const c=s.getContext("2d");c.drawImage(t,i,o,t.width*r,t.height*r);return{canvas:s,ctx:c}}addBorder(t,e,a="magenta",n=3){e.strokeStyle=a;e.lineWidth=n;e.strokeRect(0,0,t.width,t.height);return{canvas:t,ctx:e}}async getImageObject(t){const e=await fetch(t,{headers:this._authHeader});const a=await e.blob();return await createImageBitmap(a)}async convertImageDataUrlToBlob(t){const e=await this.getImageObject(t);const{width:a,height:n}=e;const{canvas:r}=this.drawImage(e,a,n);return r.convertToBlob({type:"image/jpeg",quality:1})}async makeThumbnailScale(t,e){const a=await this.getImageObject(t);const{canvas:n}=this.scaleToFit(a,e);return n.convertToBlob({type:"image/jpeg",quality:1})}async thumbnailFromArea(t,e,a,n,r){const i=this._roundRectangleSize(e);if(!i||i.width===0&&i.height===0){return this.makeThumbnailScale(t,a)}const o=i.pixelRatio||1;const s=i.width-10>=a.width*o?2:1;const c=n?{x:i.left-10+a.width*s/2*o,y:i.top+i.height/2}:{x:i.left+i.width/2,y:i.top+i.height/2};const h=await this.getImageObject(t);const{width:l,height:u}=h;const{ctx:g}=this.drawImage(h,l,u);let d=g;const m=this._createRectangleFromCenterAndSize(c,a,o);if(r){const{left:t,top:e,height:a,width:n}=i;const{canvas:r,ctx:o}=this.cropImage(g,t,e,a,n);const{ctx:s}=this.drawImage(h,l,u,.5);const c=o.getImageData(0,0,r.width,r.height);s.putImageData(c,t,e);d=s}const{left:f,top:p,height:v,width:y}=this._scaleRectangle(m,s);const{canvas:w}=this.cropImage(d,f,p,v,y);const{canvas:b}=this.scaleToFit(w.transferToImageBitmap(),m);return b.convertToBlob({type:"image/jpeg",quality:1})}async highlightSelection(t,e,a){if(!e){return this.convertImageDataUrlToBlob(t)}if(e.width===0){e.width=1}if(e.height===0){e.height=1}const n=await this.getImageObject(t);const{width:r,height:i}=n;const{ctx:o}=this.drawImage(n,r,i);const{canvas:s,ctx:c}=this.drawImage(n,r,i,.5);const{left:h,top:l,height:u,width:g}=e;const{canvas:d,ctx:m}=this.cropImage(o,h,l,u,g);if(a!==null&&a!==void 0?a:true){this.addBorder(d,m)}const f=m.getImageData(0,0,d.width,d.height);c.putImageData(f,h,l);return s.convertToBlob({type:"image/jpeg",quality:1})}async getEntireElementAreaInThumbnail(t,e,a){const n=this._roundRectangleSize(e);if(!n||n.width===0&&n.height===0){return this.convertImageDataUrlToBlob(t)}return this.thumbnailFromArea(t,e,a,false,true)}}e.ImageManipulatorLocalOffscreenCanvas=r},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.BaseImageManipulator=void 0;const n="https://res.cloudinary.com/testim/image/upload/remote_media/";class r{static isMigratedCloudinaryUrl(t){return Boolean(t.match(/(cloudinary\\.com).*test-projects-assets|test-result-assets/))}static isTestimImage(t){return/image\\.testim\\.io/.test(t)}static getImageName(t){var e,a,n,r;const i=(e=t.match("remote_media/.*"))===null||e===void 0?void 0:e.at(-1);const o=(a=t.match("test-result-artifacts/.*"))===null||a===void 0?void 0:a.at(-1);const s=(n=t.match("test-projects-artifacts/.*"))===null||n===void 0?void 0:n.at(-1);const c=(r=t.match("media_by_project/.*"))===null||r===void 0?void 0:r.at(-1);return i||c||o||s||t.split("/").at(-1)}_getBaseUrl(t){return t.replace(new RegExp(`${r.getImageName(t)}$`),"")}static convertStorageToCloudinaryUrl(t){return r.isTestimImage(t)?n+r.getImageName(t):t}_cloudinaryRectangle(t){return`x_${t.left},y_${t.top},w_${t.width},h_${t.height}`}_cloudinarySize(t){return`w_${t.width},h_${t.height}`}_roundRectangleSize(t){if(!t){return null}return{top:Math.round(t.top),left:Math.round(t.left),width:Math.round(t.width),height:Math.round(t.height),pixelRatio:t.pixelRatio}}_createRectangleFromCenterAndSize(t,e,a){return{left:Math.round(t.x-a*e.width/2),top:Math.round(t.y-a*e.height/2),width:Math.round(e.width*a),height:Math.round(e.height*a)}}_createCenteredRectangle(t,e,a){return{left:Math.round(Math.max(t.left+.5*(t.width-e),0)),top:Math.round(Math.max(t.top+.5*(t.height-a),0)),width:Math.round(e),height:Math.round(a)}}_scaleRectangle(t,e){return this._createCenteredRectangle(t,t.width*e,t.height*e)}isCloudinaryImage(t){return/res\\.cloudinary\\.com/.test(t)}replaceWithJpeg(t){if(r.isMigratedCloudinaryUrl(t)){return t}t=r.convertStorageToCloudinaryUrl(t);return`${t.match(/^(.*)(\\..*)$/)[1]}.jpg`}}e.BaseImageManipulator=r},function(t,e,a){"use strict";function n(t){return!!t&&(typeof t==="object"||typeof t==="function")&&typeof t.then==="function"}function r(t){function e(t,e,a,n){function r(e){if(typeof self.postMessage!=="function"){t.ports[0].postMessage(e)}else{self.postMessage(e)}}if(a){if(typeof console!=="undefined"&&"error"in console){console.error("Worker caught an error:",a)}r([e,{message:a.message}])}else{r([e,null,n])}}function a(t,e){try{return{res:t(e)}}catch(t){return{err:t}}}function r(t,r,i,o){var s=a(r,o);if(s.err){e(t,i,s.err)}else if(!n(s.res)){e(t,i,null,s.res)}else{s.res.then((function(a){e(t,i,null,a)}),(function(a){e(t,i,a)}))}}function i(a){var n=a.data;if(!Array.isArray(n)||n.length!==2){return}var i=n[0];var o=n[1];if(typeof t!=="function"){e(a,i,new Error("Please pass a function into register()."))}else{r(a,t,i,o)}}self.addEventListener("message",i)}t.exports=r}]);',s.p+"f2aacbf1d318fb93af3e.worker.js")}},,,,,function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(696),t);o(s(699),t);o(s(261),t);o(s(762),t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(697),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConfigInUseModal=void 0;const i=s(4);const o=s(0);const n=s(698);const r=s(81);const a=s(66);const c=s(27);const l=s(0);const u=s(63);const d=s(15);const p=s(22);const h=s(31);const f=s(16);const m=s(37);const g=s(11);const v=s(30);const S=s(45);const y=s(12);const b=s(34);t.ConfigInUseModal=(0,y.observer)((e=>{const t=(0,g.useDependencyInjector)(b.BranchesService);const s=(0,g.useDependencyInjector)(d.ProjectsService);const o=(0,g.useDependencyInjector)(u.NotificationDisplayService);const y=(0,g.useDependencyInjector)(p.TestimServicesApi);const _=(0,l.useMemo)((()=>(0,c.fromPromise)(y.testConfig.getConfigUsage(s.projectId,e.testConfig.id))),[]);const T=(0,l.useMemo)((()=>`Delete config ${e.testConfig.name}`),[e.testConfig]);(0,l.useEffect)((()=>{if(_.state==="rejected"){o.sendNotification("Error fetching test config usage");e.closeModal(false)}}),[_.state,o]);if(_.state!=="fulfilled"){return(0,i.jsx)(v.BaseModal,{className:n.default.loadingModal,closeModal:e.closeModal,header:(0,i.jsx)("h3",{children:T}),children:(0,i.jsxs)("div",{className:n.default.container,children:[`Validating config "${e.testConfig.name}" usage`,(0,i.jsx)(m.Loader,{})]})})}const{schedulers:E,testPlans:I,tests:C}=_.value;if(!E.length&&!I.length&&!C.length){return(0,i.jsx)(S.MessageModal,{closeModal:e.closeModal,title:T,body:`Are you sure you want to delete '${e.testConfig.name}' configuration?`,okText:"DELETE",cancelText:"CANCEL",variety:"normal",icon:"trash-v4",className:r.default.deletionModal})}return(0,i.jsx)(v.BaseModal,{closeModal:()=>e.closeModal(false),header:(0,i.jsx)("h3",{children:`Delete config ${e.testConfig.name}`}),subHeader:(0,i.jsxs)("div",{children:["The configuration you want to delete is used in the locations below and cannot be deleted.",(0,i.jsx)("br",{}),"Please replace all with a new config and try again"]}),subHeaderClassName:n.default.modalSubheader,className:n.default.modal,footer:(0,i.jsx)("div",{children:(0,i.jsx)(h.Cta,{onClick:()=>e.closeModal(false),children:"Ok"})}),children:(0,i.jsxs)("div",{className:n.default.linksContainer,children:[C.map((e=>{var t;return(0,i.jsxs)("a",{href:a.test(s.projectId,(t=e.branches[0])===null||t===void 0?void 0:t.branch,e._id),target:"_blank",rel:"noopener noreferrer",children:[e.name," ",(0,i.jsx)("span",{children:"Test"}),(0,i.jsx)(f.Icon,{icon:"new-tab"})]},e._id)})),E.map((e=>(0,i.jsxs)("a",{href:a.schedulers(s.projectId,t.branch,e.name),target:"_blank",rel:"noopener noreferrer",children:[e.name," ",(0,i.jsx)("span",{children:"Scheduler"}),(0,i.jsx)(f.Icon,{icon:"new-tab"})]},e.schedulerId))),I.map((e=>(0,i.jsxs)("a",{href:a.plans(s.projectId,undefined,e.name),target:"_blank",rel:"noopener noreferrer",children:[e.name," ",(0,i.jsx)("span",{children:"Test Plan"}),(0,i.jsx)(f.Icon,{icon:"new-tab"})]},e.testPlanId)))]})})}));t.ConfigInUseModal.displayName="ConfigInUseModal"},function(e,t,s){"use strict";s.r(t);t["default"]={loadingModal:"configInUse_loadingModal_21Edm_lnSW5Vc2Ut",container:"configInUse_container_1nd7m_lnSW5Vc2Ut",modal:"configInUse_modal_34_uc_lnSW5Vc2Ut",modalSubheader:"configInUse_modalSubheader_uoN3X_lnSW5Vc2Ut",linksContainer:"configInUse_linksContainer_3H7os_lnSW5Vc2Ut"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(700),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.EditTestConfigModal=void 0;const i=s(4);const o=s(6);const n=s(10);const r=s(56);const a=s(70);const c=s(12);const l=s(0);const u=s(30);const d=s(5);const p=s(701);const h=s(702);const f=s(716);const m=s(11);const g=s(15);const v=s(718);const S=s(725);t.EditTestConfigModal=(0,c.observer)((({selectedConfig:e,title:t,okText:s,closeModal:c})=>{const y=(0,m.useDependencyInjector)(g.ProjectsService);const[b,_]=(0,l.useState)(false);const[T,E]=(0,l.useState)("basic");const[I,C]=(0,l.useReducer)(((e,t)=>({...e,...t})),{name:e===null||e===void 0?void 0:e.name,browser:e===null||e===void 0?void 0:e.browser,os:e===null||e===void 0?void 0:e.os,resolution:e===null||e===void 0?void 0:e.resolution,stepTimeout:e===null||e===void 0?void 0:e.stepTimeout,stepDelay:e===null||e===void 0?void 0:e.stepDelay,setupStepTimeout:e===null||e===void 0?void 0:e.setupStepTimeout,applitoolsEnvironments:e===null||e===void 0?void 0:e.applitoolsEnvironments,applitoolsMatchLevel:e===null||e===void 0?void 0:e.applitoolsMatchLevel,applitoolsRCA:e===null||e===void 0?void 0:e.applitoolsRCA,applitoolsDiffs:e===null||e===void 0?void 0:e.applitoolsDiffs,applitoolsConcurrency:e===null||e===void 0?void 0:e.applitoolsConcurrency,applitoolsStepTimeout:e===null||e===void 0?void 0:e.applitoolsStepTimeout,mobile:e===null||e===void 0?void 0:e.mobile,nativeEvents:e===null||e===void 0?void 0:e.nativeEvents});const D=o.chain(d.commonConstants.HOOK.HANDLER).keyBy().mapValues((t=>{var s,i,o;const n={infoId:(s=e===null||e===void 0?void 0:e.hooks[t])===null||s===void 0?void 0:s.infoId,checked:Boolean((i=e===null||e===void 0?void 0:e.hooks[t])===null||i===void 0?void 0:i.infoId)};if(d.commonConstants.HOOK.CONDITIONED.includes(t)){n.condition=((o=e===null||e===void 0?void 0:e.hooks[t])===null||o===void 0?void 0:o.condition)||"always"}return n})).valueOf();const[O,A]=(0,l.useReducer)(((e,t)=>({...e,...t})),D);const j=(0,l.useMemo)((()=>y.isDemoOrReadOnly),[y]);const w=(0,l.useMemo)((()=>{const e=Object.values(d.commonConstants.HOOK.HANDLER).reduce(((e,t)=>{const s=O[t];if(s){const t=s.checked?Boolean(s.infoId):true;return e&&t}return e}),true);return e}),[O]);const R=(0,l.useMemo)((()=>{const e=o.chain(O).mapValues((e=>{if(!(e===null||e===void 0?void 0:e.infoId)){return undefined}return{infoId:e.infoId,condition:e.condition}})).pickBy((e=>e===null||e===void 0?void 0:e.infoId)).valueOf();const t=Object.assign({},{...I,hooks:{...e}});return t}),[O,I]);const P=(0,l.useCallback)((()=>{_(true);if(w){c({...R})}}),[c,w,R]);const x=(0,l.useMemo)((()=>{if(y.isMobile){return(0,i.jsx)(v.MobileConfig,{state:I,updateState:C,closeModal:c})}return(0,i.jsx)(f.BasicEditConfigView,{state:I,updateState:C})}),[y.isMobile,I]);const M=s==="CHANGE";const N=(0,l.useMemo)((()=>{var e,t;const{type:s,dynamicAllocation:i,staticAllocation:n,selectedGrid:r}=I.mobile||{};if(o.isEmpty(r)){return false}if(s==="static"){return!!((e=n===null||n===void 0?void 0:n.deviceUdid)===null||e===void 0?void 0:e.length)}if(s==="dynamic"){return(t=i===null||i===void 0?void 0:i.rules)===null||t===void 0?void 0:t.some((e=>!!e.operand))}return false}),[I.mobile]);const F=(0,l.useMemo)((()=>{if(y.isMobile){return N&&!!I.name}return!!I.name}),[N,y.isMobile,I.name]);return(0,i.jsx)(u.BaseModal,{className:(0,n.default)(r.default.modal,{[r.default.mobileModal]:y.isMobile}),bodyClassName:(0,n.default)(r.default.modalBody,{[r.default.advanced]:T==="advanced"}),closeModal:c,header:(0,i.jsx)("h3",{children:t}),subHeaderClassName:r.default.errorSubheader,footer:(0,i.jsx)(p.Footer,{submit:P,okText:s,closeModal:c,setCurrentPage:E,currentPage:T,disabledSubmit:j||!F}),children:(0,i.jsxs)("div",{children:[(0,i.jsx)(S.SharedResourceWarningBanner,{isEnabled:M,className:r.default.sharedResourceWarningBannerAdvancedView}),(0,i.jsx)("div",{className:(0,n.default)({[a.default.modalSection]:T==="basic"}),children:(0,i.jsx)("div",{className:r.default.form,children:T==="basic"?x:(0,i.jsx)(h.AdvancedEditConfigView,{updateHooksState:A,updateState:C,state:I,hooksState:O,shouldPresentErrors:b})})})]})})}));t.EditTestConfigModal.displayName="EditTestConfigModal"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Footer=void 0;const i=s(4);const o=s(56);const n=s(0);const r=s(31);t.Footer=(0,n.memo)((({closeModal:e,submit:t,setCurrentPage:s,currentPage:a,okText:c,disabledSubmit:l})=>{const u=(0,n.useCallback)((()=>s(a==="basic"?"advanced":"basic")),[a,s]);const d=(0,n.useMemo)((()=>a==="basic"?"Advanced":"Back"),[a]);return(0,i.jsxs)("div",{children:[(0,i.jsx)("a",{className:o.default.back,onClick:u,children:d}),(0,i.jsx)(r.Cta,{variety:"secondary",onClick:()=>e(),children:"Cancel"}),(0,i.jsx)(r.Cta,{onClick:t,disabled:l,children:c})]})}));t.Footer.displayName="Footer"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(703),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AdvancedEditConfigView=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(56);const a=s(0);const c=s(12);const l=s(16);const u=s(32);const d=s(44);const p=s(37);const h=s(11);const f=s(130);const m=s(5);const g=s(704);const v=s(256);const S=s(258);const y=s(14);const b=o.memo((({name:e,initialState:t="closed",children:s})=>{const[o,c]=(0,a.useState)(t==="open");const u=(0,a.useCallback)((()=>c((e=>!e))),[c]);return(0,i.jsxs)("div",{className:(0,n.default)(r.default.collapsibleSection,{[r.default.isOpen]:o}),children:[(0,i.jsxs)("button",{className:r.default.sectionHeader,onClick:u,children:[e,(0,i.jsx)(l.Icon,{icon:"arrow-down"})]}),(0,i.jsx)("div",{className:r.default.sectionContent,children:s})]})}));b.displayName="CollapsibleSection";t.AdvancedEditConfigView=(0,c.observer)((({state:e,hooksState:t,updateState:s,shouldPresentErrors:o,updateHooksState:n})=>{const c=(0,h.useDependencyInjector)(f.ApplitoolsService);const l=(0,h.useDependencyInjector)(y.FeatureFlagsService);const _=(0,a.useMemo)((()=>[{title:"Step timeout (ms)",value:e.stepTimeout,onChange:e=>s({stepTimeout:parseInt(e.target.value,10)||0})},{title:"Step delay (ms)",value:e.stepDelay,onChange:e=>s({stepDelay:parseInt(e.target.value,10)||0})},{title:"Setup step timeout (ms)",value:e.setupStepTimeout,onChange:e=>s({setupStepTimeout:parseInt(e.target.value,10)||0})}]),[s,e]);const T=(0,a.useMemo)((()=>c.isApplitoolsEnabled),[c.isApplitoolsEnabled]);const E=(0,a.useMemo)((()=>T?"closed":"open"),[T]);if(c.isApplitoolsConnected.state==="pending"){return(0,i.jsx)("div",{className:r.default.loaderWrapper,children:(0,i.jsx)(p.Loader,{})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b,{name:"General",initialState:E,children:_.map(((e,t)=>(0,i.jsxs)(d.FieldLabel,{className:r.default.formLabel,children:[(0,i.jsx)("span",{children:e.title}),(0,i.jsx)(u.Textbox,{value:e.value,onChange:e.onChange})]},`adv_item_${t}`)))}),l.flags.nativeClickConfig.isEnabled()&&(0,i.jsx)(b,{name:"Native events",initialState:E,children:(0,i.jsx)("div",{className:r.default.nativeEventsSection,children:(0,i.jsx)(S.NativeEventsSection,{config:e,onChange:s})})}),(0,i.jsx)(b,{name:"Before / After hooks",initialState:E,children:Object.values(m.commonConstants.HOOK.HANDLER).map((e=>(0,i.jsx)(g.ConfigHook,{hookName:e,hookValues:t[e],shouldPresentErrors:o,updateHooksState:n},e)))}),T&&(0,i.jsx)(b,{name:"Visual validation",children:(0,i.jsx)(v.ApplitoolsSection,{config:e,onChange:s,environmentRowClassName:r.default.environmentRow})})]})}));t.AdvancedEditConfigView.displayName="AdvancedEditConfigView"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConfigHook=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(56);const a=s(70);const c=s(44);const l=s(74);const u=s(122);const d=s(40);const p=s(5);const h=s(0);const f=s(11);const m=s(106);const g=s(14);const v=s(37);const S=s(12);t.ConfigHook=(0,S.observer)((({hookName:e,hookValues:t,shouldPresentErrors:s,updateHooksState:o})=>{const S=(0,f.useDependencyInjector)(m.CustomReuseService);const y=(0,f.useDependencyInjector)(g.FeatureFlagsService);const b=y.flags.enableGroupHooks.isEnabled()?S.sharedSteps:S.nonGroupSteps;const _=(0,h.useMemo)((()=>S.isSharedStepsReady?b.map((e=>({name:e.name,value:e}))):[]),[b,S.isSharedStepsReady]);const T=(0,h.useCallback)((s=>{let i=Object.assign({},t);if(!s.target.checked){i=undefined}else{i.checked=true;i.error=`Please add ${p.commonConstants.HOOK.SHORT_LABEL[e]} handler`}return o({[e]:i})}),[e,t,o]);const E=(0,h.useCallback)((s=>o({[e]:Object.assign({},t,{error:"",infoId:s.value.id})})),[e,t,o]);const I=(0,h.useCallback)((s=>{const i=s.target.value;return o({[e]:Object.assign({},t,{condition:i})})}),[e,t,o]);if(!S.isSharedStepsReady){return(0,i.jsx)("div",{children:(0,i.jsx)(v.Loader,{})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.FieldLabel,{className:(0,n.default)(r.default.fullLabel,r.default.reduceMarginBottom),children:(0,i.jsx)(l.Checkbox,{checked:Boolean(t===null||t===void 0?void 0:t.checked),onChange:T,className:r.default.enlargedCheckbox,children:p.commonConstants.HOOK.LABEL[e]})}),(t===null||t===void 0?void 0:t.checked)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.FieldLabel,{error:s?t===null||t===void 0?void 0:t.error:"",className:(0,n.default)(r.default.fullLabel,r.default.reduceMargin),children:(0,i.jsx)(d.Dropdown,{placeholder:"Select shared step",value:(t===null||t===void 0?void 0:t.infoId)&&_.find((e=>e.value.id===t.infoId)),options:_,onChange:E,appendToBody:true})},`${e}_error`),(t===null||t===void 0?void 0:t.infoId)&&p.commonConstants.HOOK.CONDITIONED.includes(e)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,n.default)(r.default.fullLabel,r.default.reduceMargin,a.default.modalSection),children:"Run on"}),Object.values(p.commonConstants.HOOK.CONDITION).map((e=>(0,i.jsx)(c.FieldLabel,{className:(0,n.default)(r.default.radioLabel,r.default.reduceMargin),children:(0,i.jsx)(u.RadioButton,{value:e,onChange:I,checked:(t===null||t===void 0?void 0:t.condition)===e,children:e})},e)))]}):""]})]})}));t.ConfigHook.displayName="ConfigHook"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ApplitoolsSection=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(10);const a=s(706);const c=s(56);const l=s(0);const u=s(40);const d=s(44);const p=s(16);const h=s(249);const f=s(32);const m=s(707);const g=s(713);const v=s(142);const S=s(11);const y=s(28);const b=s(21);const _=e=>({name:e,value:e});const T=v.APPLITOOLS_MATCH_LEVELS.map(_);const E=n.memo((()=>(0,i.jsx)("span",{className:a.default.multiLineTooltip,children:"Define additional environments besides the test configuration, to perform the Visual Validation. Feature requires Applitools licensing for Ultrafast Test Cloud."})));const I=n.memo((()=>(0,i.jsxs)("span",{className:a.default.multiLineTooltipNarrow,children:["Enables insights into the causes of visual mismatches.",(0,i.jsx)("br",{}),"Feature requires appropriate Applitools licensing."]})));const C=n.memo((()=>(0,i.jsx)("span",{className:a.default.multiLineTooltip,children:"Ignores visual differences caused by displacement (elements have shifted but not changed)"})));t.ApplitoolsSection=n.memo((({config:e,scope:t="test",stepAction:s,tooltipsDirection:n="top",className:D,environmentRowClassName:O,onChange:A})=>{const j=(0,S.useDependencyInjector)(y.ModalService);const w=(0,S.useDependencyInjector)(b.AnalyticsService);const R=(0,l.useCallback)((async()=>{const i=await j.openModal(g.AddNewApplitoolsEnvironmentModal).promise;if(!i){return}w.track(t==="test"?"confUpdatedVisualValidationEnvironments":"stepUpdatedVisualValidationEnvironments",{action:"added",stepType:s});const n=o.chain(e.applitoolsEnvironments).clone().push(i).value();A({applitoolsEnvironments:n})}),[j,w,t,s,e,A]);const P=(0,l.useCallback)((i=>()=>{const n=o.clone(e.applitoolsEnvironments);n.splice(i,1);w.track(t==="test"?"confUpdatedVisualValidationEnvironments":"stepUpdatedVisualValidationEnvironments",{action:"removed",stepType:s});A({applitoolsEnvironments:n})}),[w,t,s,e,A]);const x=(0,l.useCallback)((e=>{w.track(t==="test"?"confUpdatedVisualValidationMatchLevel":"stepUpdatedVisualValidationMatchLevel",{stepType:s,level:e.value});A({applitoolsMatchLevel:e.value})}),[w,t,s,A]);const M=(0,l.useCallback)((e=>{const i=e.target.checked;w.track(t==="test"?"confUpdatedVisualValidationRCA":"stepUpdatedVisualValidationRCA",{stepType:s,value:i});A({applitoolsRCA:i})}),[w,t,s,A]);const N=(0,l.useCallback)((e=>{const i=e.target.checked;w.track(t==="test"?"confUpdatedVisualValidationDisplacement":"stepUpdatedVisualValidationEnvironments",{stepType:s,value:i});A({applitoolsDiffs:i})}),[w,t,s,A]);const F=(0,l.useCallback)((e=>{const t=o.parseInt(e.target.value)||0;w.track("confUpdatedVisualValidationConcurrency",{value:t});A({applitoolsConcurrency:t})}),[w,A]);const L=(0,l.useCallback)((e=>{const t=o.parseInt(e.target.value)||0;w.track("confUpdatedVisualValidationStepTimeout",{value:t});A({applitoolsStepTimeout:t})}),[w,A]);return(0,i.jsxs)("div",{className:(0,r.default)(a.default.applitoolsSection,D),children:[t!=="wait-for-step"&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{className:a.default.addEnvBtn,onClick:R,children:[(0,i.jsx)(p.Icon,{icon:"plus2",className:a.default.addEnvIcon}),"Add Environment",(0,i.jsx)(p.InfoIcon,{className:a.default.addEnvInfo,variety:"info-inverted",direction:n,tooltip:(0,i.jsx)(E,{})})]}),e.applitoolsEnvironments.map(((e,t)=>(0,i.jsx)(m.ApplitoolsEnvironmentRow,{item:e,className:O,onDelete:P(t)},t)))]}),(0,i.jsxs)("div",{className:(0,r.default)({[a.default.twoItemsRow]:t==="test"}),children:[(0,i.jsxs)(d.FieldLabel,{className:(0,r.default)(a.default.enlargedMargins,c.default.applitoolsSectionInput),children:[(0,i.jsx)("span",{className:a.default.dropdownTitle,children:"Match level"}),(0,i.jsx)(u.Dropdown,{appendToBody:true,searchable:false,options:T,className:a.default.dropdown,containerClassName:c.default.dropdownContainer,value:_(e.applitoolsMatchLevel||v.APPLITOOLS_DEFAULT_MATCH_LEVEL),onChange:x})]}),t==="test"&&(0,i.jsxs)(d.FieldLabel,{className:(0,r.default)(a.default.enlargedMargins,c.default.applitoolsSectionInput),children:[(0,i.jsx)("span",{className:a.default.dropdownTitle,children:"Concurrency"}),(0,i.jsx)(f.Textbox,{type:"number",value:e.applitoolsConcurrency||"",onChange:F})]})]}),t!=="wait-for-step"&&(0,i.jsxs)(h.ToggleSwitch,{wrapperClassName:a.default.switchOption,className:a.default.toggleCheckbox,checked:e.applitoolsRCA,onChange:M,children:[(0,i.jsx)("span",{children:"Enable RCA"}),(0,i.jsx)(p.InfoIcon,{variety:"info-inverted",direction:n,tooltip:(0,i.jsx)(I,{})})]}),(0,i.jsxs)(h.ToggleSwitch,{wrapperClassName:a.default.switchOption,className:a.default.toggleCheckbox,checked:e.applitoolsDiffs,onChange:N,children:[(0,i.jsx)("span",{children:"Ignore displacement diffs"}),(0,i.jsx)(p.InfoIcon,{variety:"info-inverted",direction:n,tooltip:(0,i.jsx)(C,{})})]}),t==="test"&&(0,i.jsxs)(d.FieldLabel,{className:(0,r.default)(a.default.enlargedMargins,c.default.applitoolsSectionInput),children:[(0,i.jsx)("span",{className:a.default.dropdownTitle,children:"Visual validation timeout"}),(0,i.jsx)(f.Textbox,{type:"number",value:e.applitoolsStepTimeout||"",onChange:L})]})]})}));E.displayName="AdditionalEnvTooltip";I.displayName="RCATooltip";C.displayName="DisplacementTooltip";t.ApplitoolsSection.displayName="ApplitoolsSection"},function(e,t,s){"use strict";s.r(t);t["default"]={stepTimeoutInfo:"ApplitoolsSection_stepTimeoutInfo_3tQIS_NlY3Rpb24t",switchOption:"ApplitoolsSection_switchOption_vXNZw_NlY3Rpb24t",addEnvInfo:"ApplitoolsSection_addEnvInfo_60ApW_NlY3Rpb24t",applitoolsSection:"ApplitoolsSection_applitoolsSection_1XnXm_NlY3Rpb24t",dropdownTitle:"ApplitoolsSection_dropdownTitle_2MeQw_NlY3Rpb24t",dropdown:"ApplitoolsSection_dropdown_2hVuC_NlY3Rpb24t",twoItemsRow:"ApplitoolsSection_twoItemsRow_1b_KW_NlY3Rpb24t",enlargedMargins:"ApplitoolsSection_enlargedMargins_3iiGo_NlY3Rpb24t",addEnvIcon:"ApplitoolsSection_addEnvIcon_2Mvli_NlY3Rpb24t",addEnvBtn:"ApplitoolsSection_addEnvBtn_x8rmY_NlY3Rpb24t",toggleCheckbox:"ApplitoolsSection_toggleCheckbox_2refv_NlY3Rpb24t",multiLineTooltip:"ApplitoolsSection_multiLineTooltip_R9J07_NlY3Rpb24t",multiLineTooltipNarrow:"ApplitoolsSection_multiLineTooltipNarrow_o4yFX_NlY3Rpb24t"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(708),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ApplitoolsEnvironmentRow=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(10);const a=s(709);const c=s(710);const l=s(0);const u=s(257);const d={browser:"Browser",emulator:"Chrome emulation",ios:"iOS"};t.ApplitoolsEnvironmentRow=n.memo((({item:e,className:t,onDelete:s})=>{const n=(0,l.useMemo)((()=>{var t,s;if(e.envType==="browser"){const s=((t=u.BROWSER_OPTIONS.find((({value:t})=>e.type===t)))===null||t===void 0?void 0:t.name)||e.type;return`${s} | ${e.resolution.width}x${e.resolution.height}`}if(e.envType==="emulator")return`${e.device} | ${o.upperFirst(e.orientation)}`;if(e.envType==="ios"){const t=((s=u.IOS_VERSION_NAMES.find((({value:t})=>e.version===t)))===null||s===void 0?void 0:s.name)||e.version;return`${e.device} | ${o.upperFirst(e.orientation)} | ${t}`}return""}),[e]);return(0,i.jsxs)("div",{className:(0,r.default)(a.default.row,{[a.default.disabled]:!s},t),children:[(0,i.jsx)("div",{className:a.default.name,children:d[e.envType]}),(0,i.jsx)("div",{className:a.default.info,title:n,children:n}),s&&(0,i.jsx)(c.RoundIconButton,{icon:"trash-v4",className:a.default.icon,onClick:s})]})}))},function(e,t,s){"use strict";s.r(t);t["default"]={row:"ApplitoolsEnvironment_row_1xQ3M_Jvbm1lbnQt",icon:"ApplitoolsEnvironment_icon_M2ALN_Jvbm1lbnQt",disabled:"ApplitoolsEnvironment_disabled_3hXsO_Jvbm1lbnQt",name:"ApplitoolsEnvironment_name_2lkOe_Jvbm1lbnQt",info:"ApplitoolsEnvironment_info_3b6zT_Jvbm1lbnQt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(711),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RoundIconButton=t.RoundIconLink=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(712);const a=s(16);const c=s(6);t.RoundIconLink=o.memo((e=>(0,i.jsxs)("a",{className:(0,n.default)(r.default.roundButton,e.className,e.color?r.default[e.color]:"",e.variety?r.default[e.variety]:""),...c.omit(e,["children","className"]),children:[(0,i.jsx)(a.Icon,{icon:e.icon}),e.children]})));t.RoundIconLink.displayName="RoundIconLink";t.RoundIconButton=o.memo((({active:e=false,...t})=>{const s=(0,n.default)(r.default.roundButton,t.className,t.color?r.default[t.color]:"",t.variety?r.default[t.variety]:"",{[r.default.showHover]:!t.disabled,[r.default.disabled]:t.disabled,[r.default.active]:e});return(0,i.jsxs)("button",{className:s,...c.omit(t,["children","className","disabled"]),children:[(0,i.jsx)(a.Icon,{icon:t.icon}),t.children]})}));t.RoundIconButton.displayName="RoundIconButton"},function(e,t,s){"use strict";s.r(t);t["default"]={roundButton:"roundIconButton_roundButton_2hRiu_5CdXR0b24t",showHover:"roundIconButton_showHover_1WlKN_5CdXR0b24t",disabled:"roundIconButton_disabled_1JSh9_5CdXR0b24t",red:"roundIconButton_red_NC9pI_5CdXR0b24t",gray:"roundIconButton_gray_3-0Jc_5CdXR0b24t",blue:"roundIconButton_blue_3ou-f_5CdXR0b24t",medium:"roundIconButton_medium_3ZTic_5CdXR0b24t",large:"roundIconButton_large_3YDTN_5CdXR0b24t",active:"roundIconButton_active_3VxTQ_5CdXR0b24t"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(714),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AddNewApplitoolsEnvironmentModal=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(715);const a=s(0);const c=s(122);const l=s(30);const u=s(40);const d=s(44);const p=s(16);const h=s(31);const f=s(257);const m=s(133);const g={browser:{envType:"browser",resolution:undefined,type:undefined,device:undefined,orientation:undefined,version:undefined},emulator:{envType:"emulator",device:undefined,orientation:"portrait",resolution:undefined,type:undefined,version:undefined},ios:{envType:"ios",device:undefined,orientation:"portrait",version:"",resolution:undefined,type:undefined}};const v=m.RESOLUTIONS.map((e=>({name:e.name,value:e})));const S=o.memo((({orientation:e,onChange:t})=>{const s=(0,a.useCallback)((e=>()=>t(e)),[t]);return(0,i.jsxs)(d.FieldLabel,{className:r.default.noBottomMargin,children:[(0,i.jsx)("span",{className:r.default.subTitle,children:"Screen orientation"}),(0,i.jsx)("div",{className:r.default.orientationPicker,children:["portrait","landscape"].map((t=>(0,i.jsx)(c.RadioButton,{wrapperClassName:r.default.radio,checked:e===t,onChange:s(t),children:(0,i.jsx)(p.Icon,{icon:t,className:(0,n.default)(r.default.orientationIcon,r.default[t])})},t)))})]})}));S.displayName="ScreenOrientation";t.AddNewApplitoolsEnvironmentModal=o.memo((({closeModal:e})=>{const[t,s]=(0,a.useReducer)(((e,t)=>({...e,...t})),g.browser);const o=(0,a.useMemo)((()=>{if(t.envType==="browser"){return Boolean(t.type&&t.resolution)}if(t.envType==="emulator"){return Boolean(t.device&&t.orientation)}if(t.envType==="ios"){return Boolean(t.device&&t.orientation&&t.version)}return false}),[t]);const p=(0,a.useMemo)((()=>{var e;if(t.envType!=="ios"){return[]}const s=(e=Object.values(f.IOS_DEVICE_NAME).find((({value:e})=>{var s;return((s=t.device)===null||s===void 0?void 0:s.value)===e})))===null||e===void 0?void 0:e.supportedIosVersions;let i=[...f.IOS_VERSION_NAMES];if(s){i=i.filter((({value:e})=>s.includes(e)))}return i}),[t]);const m=(0,a.useCallback)((e=>()=>s(g[e])),[s]);const y=(0,a.useCallback)((()=>{var s,i,n,r;if(!o){return}const a={...t};a.type=(s=a.type)===null||s===void 0?void 0:s.value;a.resolution=(i=a.resolution)===null||i===void 0?void 0:i.value;a.device=(n=a.device)===null||n===void 0?void 0:n.value;a.version=(r=a.version)===null||r===void 0?void 0:r.value;e(a)}),[o,t,e]);return(0,i.jsxs)(l.BaseModal,{closeModal:e,className:r.default.modal,bodyClassName:r.default.body,header:(0,i.jsx)("h3",{children:"Add additional environments"}),footer:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.Cta,{onClick:y,disabled:!o,children:"Add"}),(0,i.jsx)(h.Cta,{onClick:()=>e(),variety:"secondary",children:"Cancel"})]}),children:[(0,i.jsx)("span",{className:r.default.explanation,children:"Select one of the environments options below"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.RadioButton,{checked:t.envType==="browser",onChange:m("browser"),wrapperClassName:(0,n.default)(r.default.radio,r.default.title),children:"Browser"}),t.envType==="browser"&&(0,i.jsxs)("div",{className:r.default.envPicker,children:[(0,i.jsxs)(d.FieldLabel,{className:r.default.noBottomMargin,children:[(0,i.jsx)("span",{className:r.default.subTitle,children:"Type"}),(0,i.jsx)(u.Dropdown,{optionsClassName:r.default.dropdownOptions,containerClassName:r.default.dropdownContainer,inputProps:{className:r.default.dropdownText},appendToBody:true,options:f.BROWSER_OPTIONS,value:t.type,onChange:e=>s({type:e}),placeholder:"Select type"})]}),(0,i.jsxs)(d.FieldLabel,{className:r.default.noBottomMargin,children:[(0,i.jsx)("span",{className:r.default.subTitle,children:"Resolution"}),(0,i.jsx)(u.Dropdown,{optionsClassName:r.default.dropdownOptions,containerClassName:r.default.dropdownContainer,inputProps:{className:r.default.dropdownText},appendToBody:true,options:v,value:t.resolution,onChange:e=>s({resolution:e}),placeholder:"Select resolution"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.RadioButton,{checked:t.envType==="emulator",onChange:m("emulator"),wrapperClassName:(0,n.default)(r.default.radio,r.default.title),children:"Chrome emulation"}),t.envType==="emulator"&&(0,i.jsxs)("div",{className:r.default.envPicker,children:[(0,i.jsxs)(d.FieldLabel,{className:r.default.noBottomMargin,children:[(0,i.jsx)("span",{className:r.default.subTitle,children:"Device"}),(0,i.jsx)(u.Dropdown,{optionsClassName:r.default.dropdownOptions,containerClassName:r.default.dropdownContainer,inputProps:{className:r.default.dropdownText},appendToBody:true,options:f.CHROME_EMULATION_DEVICE_NAME,value:t.device,onChange:e=>s({device:e}),placeholder:"Select device"})]}),(0,i.jsx)(S,{orientation:t.orientation,onChange:e=>s({orientation:e})})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.RadioButton,{checked:t.envType==="ios",onChange:m("ios"),wrapperClassName:(0,n.default)(r.default.radio,r.default.title),children:"iOS simulation"}),t.envType==="ios"&&(0,i.jsxs)("div",{className:r.default.envPicker,children:[(0,i.jsxs)(d.FieldLabel,{className:r.default.noBottomMargin,children:[(0,i.jsx)("span",{className:r.default.subTitle,children:"Device"}),(0,i.jsx)(u.Dropdown,{appendToBody:true,optionsClassName:r.default.dropdownOptions,containerClassName:r.default.dropdownContainer,options:f.IOS_DEVICE_NAME,value:t.device,onChange:e=>s({device:e}),placeholder:"Select device"})]}),(0,i.jsxs)(d.FieldLabel,{className:r.default.noBottomMargin,children:[(0,i.jsx)("span",{className:r.default.subTitle,children:"iOS version"}),(0,i.jsx)(u.Dropdown,{inputProps:{className:r.default.dropdownText},appendToBody:true,searchable:false,options:p,value:t.version,onChange:e=>s({version:e}),placeholder:"Select version"})]}),(0,i.jsx)(S,{orientation:t.orientation,onChange:e=>s({orientation:e})})]})]})]})}));t.AddNewApplitoolsEnvironmentModal.displayName="AddNewApplitoolsEnvironmentModal"},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"AddNewApplitoolsEnvironment_modal_OLhW__Jvbm1lbnQt",body:"AddNewApplitoolsEnvironment_body_2EPAq_Jvbm1lbnQt",radio:"AddNewApplitoolsEnvironment_radio_1Iia1_Jvbm1lbnQt",title:"AddNewApplitoolsEnvironment_title_jLtSS_Jvbm1lbnQt",explanation:"AddNewApplitoolsEnvironment_explanation_2PE9S_Jvbm1lbnQt",envPicker:"AddNewApplitoolsEnvironment_envPicker_93cYp_Jvbm1lbnQt",subTitle:"AddNewApplitoolsEnvironment_subTitle_2RPMm_Jvbm1lbnQt",dropdownText:"AddNewApplitoolsEnvironment_dropdownText_1UeL8_Jvbm1lbnQt",dropdownContainer:"AddNewApplitoolsEnvironment_dropdownContainer_3QBWp_Jvbm1lbnQt",dropdownOptions:"AddNewApplitoolsEnvironment_dropdownOptions_3xqIJ_Jvbm1lbnQt",orientationPicker:"AddNewApplitoolsEnvironment_orientationPicker_e81nC_Jvbm1lbnQt",orientationIcon:"AddNewApplitoolsEnvironment_orientationIcon_2LDGb_Jvbm1lbnQt",portrait:"AddNewApplitoolsEnvironment_portrait_1F1bF_Jvbm1lbnQt",landscape:"AddNewApplitoolsEnvironment_landscape_KByvF_Jvbm1lbnQt",noBottomMargin:"AddNewApplitoolsEnvironment_noBottomMargin_3VGIb_Jvbm1lbnQt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(717),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BasicEditConfigView=void 0;const i=s(4);const o=s(0);const n=s(56);const r=s(0);const a=s(6);const c=s(44);const l=s(32);const u=s(40);const d=s(133);const p=s(107);const h=s(11);t.BasicEditConfigView=o.memo((({updateState:e,state:t})=>{const s=(0,h.useDependencyInjector)(p.ConfigListStore);const f=s.browsers;const m=d.OSS.map((e=>({name:e.name,value:e})));const g=d.RESOLUTIONS.map((e=>({name:e.name,value:e})));const v=(0,r.useMemo)((()=>f.find((e=>e.name===t.browser))),[f,t.browser]);const S=(0,r.useMemo)((()=>g.find((e=>e.value.height===t.resolution.height&&e.value.width===t.resolution.width))),[g,t.resolution]);const y=(0,r.useMemo)((()=>m.find((e=>e.name===t.os))),[m,t.os]);return(0,i.jsxs)(o.Fragment,{children:[(0,i.jsxs)(c.FieldLabel,{className:n.default.formLabel,children:[(0,i.jsx)("span",{children:"Name"}),(0,i.jsx)(l.Textbox,{value:t.name,onChange:t=>e({name:t.target.value})})]}),(0,i.jsxs)(c.FieldLabel,{className:n.default.formLabel,children:[(0,i.jsx)("span",{children:"Browser"}),(0,i.jsx)(u.Dropdown,{value:v,options:f,onChange:t=>e({browser:t.name}),appendToBody:true})]}),(0,i.jsxs)(c.FieldLabel,{className:n.default.formLabel,children:[(0,i.jsx)("span",{children:"OS"}),(0,i.jsx)(u.Dropdown,{value:y,options:m,onChange:t=>e({os:t.name}),appendToBody:true})]}),(0,i.jsxs)(c.FieldLabel,{className:n.default.formLabel,children:[(0,i.jsx)("span",{children:"Resolution"}),(0,i.jsx)(u.Dropdown,{value:S,options:g,onChange:t=>e({resolution:(0,a.pick)(t.value,["width","height"])}),appendToBody:true})]})]})}));t.BasicEditConfigView.displayName="BasicEditConfigView"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileConfig=void 0;const i=s(4);const o=s(6);const n=s(10);const r=s(56);const a=s(719);const c=s(0);const l=s(44);const u=s(32);const d=s(12);const p=s(231);const h=s(720);const f=s(721);const m=s(11);const g=s(724);const v=s(102);const S=s(219);t.MobileConfig=(0,d.observer)((({updateState:e,state:t,closeModal:s})=>{var d,y;const b=(0,m.useDependencyInjector)(v.GridsService);const _=(0,m.useLocalStoreWithInjectedDependencies)(g.MobileConfigLocalStore);(0,c.useEffect)((()=>{_.onMount({state:t,updateState:e})}),[]);const T=(0,c.useCallback)((async e=>{var t;const s=await b.getCompanyGrids();const i=s.find((t=>t._id===e.value));const{_id:o,name:n,type:r,companyId:a}=i||{};if(o!==((t=_.selectedGrid)===null||t===void 0?void 0:t._id)){_.setSelectedGrid({_id:o,name:n,type:r,companyId:a});_.resetToDefaultValues()}}),[b,_]);const E=e=>{_.setConfigRules(e)};const I=()=>{s(false)};return(0,i.jsxs)("div",{className:a.default.container,children:[(0,i.jsxs)("div",{className:a.default.header,children:[(0,i.jsxs)(l.FieldLabel,{className:(0,n.default)(r.default.formLabel,a.default.configName),children:[(0,i.jsx)("span",{children:"Configuration Name"}),(0,i.jsx)(u.Textbox,{value:t.name,onChange:t=>e({name:t.target.value})})]}),(0,i.jsx)(p.GridListSelector,{customTitle:"Choose a grid",autoSelectFirst:(0,o.isEmpty)(t.mobile),selectedGrid:{name:((d=_.selectedGrid)===null||d===void 0?void 0:d.name)||"",value:((y=_.selectedGrid)===null||y===void 0?void 0:y._id)||""},onGridSelectedByState:T,onGridSelectedByUser:T,wrapperClassName:a.default.gridList,errorClassName:a.default.gridError,openGridsPage:I,manageGridsUrl:_.gridPageLink,hideTopManageGridLink:true,showGridIcon:true})]}),(0,i.jsxs)("div",{className:a.default.configType,children:[(0,i.jsx)("span",{children:"Configuration type"}),(0,i.jsx)("div",{className:a.default.configTypeOptions,children:(0,i.jsx)(S.RadioButtonGroup,{checked:_.configType,options:{dynamic:{title:"Dynamic allocation"},static:{title:"Static allocation"}},onChange:_.setConfigType})})]}),_.configType==="dynamic"&&(0,i.jsx)(f.RulesList,{rules:_.configRules,selectedGrid:_.selectedGrid,isDisabled:_.isRulesSectionDisabled,osVersionOptions:_.osVersionOptions,manufacturerOptions:_.manufacturerOptions,onRulesChange:E,isLoading:_.isLoading}),(0,i.jsx)(h.DeviceList,{list:_.deviceList,isLoading:_.isLoading,isRejected:_.isRejected,isViewMode:_.isViewMode,isRulesFilterActive:_.isRulesFilterActive,onItemSelected:_.toggleDeviceListItem,isMultiSelectionAllowed:_.isMultiSelectionAllowed,selectionMode:_.configType,onSelectAll:_.onSelectAll,onSearch:_.onDeviceListSearch,wrappedWithCollapsible:_.configType==="dynamic"})]})}));t.MobileConfig.displayName="MobileConfig"},function(e,t,s){"use strict";s.r(t);t["default"]={container:"MobileConfig_container_2M49U_VDb25maWct",header:"MobileConfig_header_23J4P_VDb25maWct",configName:"MobileConfig_configName_3YGWK_VDb25maWct",gridList:"MobileConfig_gridList_22FO8_VDb25maWct",gridError:"MobileConfig_gridError_UKA_t_VDb25maWct",configType:"MobileConfig_configType_sCwZ1_VDb25maWct",configTypeOptions:"MobileConfig_configTypeOptions_EHA-f_VDb25maWct"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DeviceList=void 0;const i=s(4);const o=s(259);const n=s(10);const r=s(0);const a=s(12);const c=s(74);const l=s(155);const u=s(37);const d=s(101);const p=s(122);const h=({isMultiSelectionAllowed:e,onSelectAll:t,isChecked:s,isSelectDisabled:r,headerTitle:a})=>(0,i.jsxs)("div",{className:o.default.deviceListHeader,children:[(0,i.jsx)("div",{className:(0,n.default)(o.default.column,o.default.headerText),children:!e?a:(0,i.jsx)(c.Checkbox,{onChange:t,checked:s,disabled:r,children:a})}),(0,i.jsx)("div",{className:(0,n.default)(o.default.column,o.default.headerText,o.default.osVersion),children:"OS Version"})]});h.displayName="DeviceListHeader";const f=({item:e,isSelectDisabled:t,onItemSelected:s,isMultiSelectionAllowed:r,selectionMode:a})=>{const l={onChange:()=>s(e),checked:e.isSelected,disabled:t};const u=!r?p.RadioButton:c.Checkbox;return(0,i.jsxs)("div",{className:o.default.deviceListRow,children:[a==="dynamic"?(0,i.jsx)(i.Fragment,{children:e.name}):(0,i.jsx)(u,{...l,children:e.name}),(0,i.jsxs)("div",{className:(0,n.default)(o.default.osVersion),children:[" ",e.osVersion]})]})};f.displayName="DeviceListItem";const m=({showSearchResult:e})=>(0,i.jsx)("div",{className:o.default.emptyStateWrapper,children:e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,n.default)(o.default.emptyStateHeader,o.default.emptyStateSearch),children:"Your search didnt match any result"}),(0,i.jsx)("div",{className:o.default.emptyStateBody,children:"Try a different search query or check your device pool."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:o.default.emptyStateHeader,children:"Nothing to display"}),(0,i.jsx)("div",{className:o.default.emptyStateBody,children:"Select a grid to start displaying devices available in your pool."})]})});m.displayName="EmptyDeviceList";const g=({list:e,onSearch:t,onItemSelected:s,onSelectAll:n,isLoading:a,isRejected:c,isViewMode:d,isRulesFilterActive:p,isMultiSelectionAllowed:g,selectionMode:v})=>{const S=(0,r.useMemo)((()=>e.length>0&&e.every((e=>e.isSelected))),[e]);const[y,b]=(0,r.useState)("");const _=(0,r.useMemo)((()=>e.length?`devices (${e.length} available)`:"devices"),[e]);const T=(0,r.useCallback)((e=>{t(e);b(e.currentTarget.value)}),[]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:o.default.searchWrapper,children:(0,i.jsx)(l.SearchInput,{value:y,changeHandler:T,searchClassName:o.default.search})}),(0,i.jsx)(h,{isMultiSelectionAllowed:g,headerTitle:_,isSelectDisabled:d,onSelectAll:n,isChecked:S}),(0,i.jsxs)("div",{className:o.default.list,children:[a&&(0,i.jsxs)("div",{className:o.default.loaderWrapper,children:[(0,i.jsx)(u.Loader,{})," "]}),c&&(0,i.jsx)("div",{children:"something went wrong please try again!"}),e.map((e=>(0,i.jsx)(f,{selectionMode:v,isMultiSelectionAllowed:g,onItemSelected:s,isSelectDisabled:d,item:e},e.udid))),e.length===0&&!a&&!c&&!y&&!p&&(0,i.jsx)(m,{}),e.length===0&&!a&&!c&&(y||p)&&(0,i.jsx)(m,{showSearchResult:true})]})]})};g.displayName="WrappedDeviceList";t.DeviceList=(0,a.observer)((({list:e,onSearch:t,onItemSelected:s,onSelectAll:n,isLoading:r,isRejected:a,isViewMode:c,isRulesFilterActive:l,wrappedWithCollapsible:u,isMultiSelectionAllowed:p,selectionMode:h})=>{const f=(0,i.jsx)(g,{list:e,onSearch:t,onItemSelected:s,onSelectAll:n,isLoading:r,isRejected:a,isViewMode:c,isRulesFilterActive:l,isMultiSelectionAllowed:p,selectionMode:h});if(u){return(0,i.jsx)("div",{className:o.default.wrapper,children:(0,i.jsx)(d.Collapsible,{header:"devices",headerClassName:o.default.header,headerIconClassName:o.default.headerIcon,autoOpen:true,children:(0,i.jsx)("div",{className:o.default.main,children:f})})})}return(0,i.jsxs)("div",{children:[" ",f," "]})}));t.DeviceList.displayName="DeviceList"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RulesList=void 0;const i=s(4);const o=s(260);const n=s(259);const r=s(0);const a=s(12);const c=s(101);const l=s(11);const u=s(722);const d=s(723);const p=s(37);t.RulesList=(0,a.observer)((({rules:e,selectedGrid:t,isDisabled:s,osVersionOptions:a,manufacturerOptions:h,onRulesChange:f,isLoading:m})=>{var g;const v=(0,l.useLocalStoreWithInjectedDependencies)(u.RulesLocalStore);(0,r.useEffect)((()=>{v.init({rules:e,osVersionOptions:a,manufacturerOptions:h,isDisabled:s})}),[s,h,a,e,v]);(0,r.useEffect)((()=>{f(v.rules)}),[f,v.rules]);return(0,i.jsx)("div",{className:o.default.rulesWrapper,children:(0,i.jsx)(c.Collapsible,{header:"RULES",headerClassName:n.default.header,headerIconClassName:n.default.headerIcon,disabled:s,autoOpen:Boolean((g=v.rules)===null||g===void 0?void 0:g.length),children:m?(0,i.jsxs)("div",{className:o.default.loaderWrapper,children:[(0,i.jsx)(p.Loader,{})," "]}):(0,i.jsxs)("div",{className:o.default.tableContainer,children:[(0,i.jsxs)("div",{className:o.default.tableHeader,children:[(0,i.jsx)("div",{children:"FIELD"}),(0,i.jsx)("div",{children:"OPERATOR"}),(0,i.jsx)("div",{children:"OPERAND"}),(0,i.jsx)("div",{className:o.default.iconColumn})]}),(0,i.jsx)("div",{className:o.default.tableContent,children:v.rules.map((e=>(0,i.jsx)(d.RuleListRow,{rule:e,valueOptions:v.getValueOptions(e.field.value,e.operator),selectedGrid:t},e.id)))})]})})})}));t.RulesList.displayName="RulesList"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r;Object.defineProperty(t,"__esModule",{value:true});t.RulesLocalStore=void 0;const a=s(9);const c=s(2);const l=s(78);const u=s(170);const d=s(6);let p=class e{constructor(){this.rules=[];this.isDisabled=false;this.osVersionOptions=[];this.manufacturerOptions=[]}init({rules:e,osVersionOptions:t,manufacturerOptions:s,isDisabled:i}){this.rules=(e===null||e===void 0?void 0:e.length)?e:u.initialRules;this.osVersionOptions=t;this.manufacturerOptions=s;this.isDisabled=i}deleteRule(e){var t;this.rules=(t=this.rules)===null||t===void 0?void 0:t.filter((t=>t.id!==e))}updateRule(e){this.rules=this.rules.map((t=>e.id===t.id?e:t))}getValueOptions(e,t){if(e==="os_version"){const e=this.osVersionOptions.slice().sort(((e,t)=>parseFloat(e.value)>parseFloat(t.value)?1:-1));return t.name==="equals"?[{name:"Any",value:"Any"},...e]:e}if(e==="manufacturer"){const e=(0,d.sortBy)(this.manufacturerOptions,["manufacturer","name"]);return t.name==="equals"?[{name:"Any",value:"Any"},...e]:e}return[]}};t.RulesLocalStore=p;i([c.observable,o("design:type",Array)],p.prototype,"rules",void 0);i([c.observable,o("design:type",Boolean)],p.prototype,"isDisabled",void 0);i([c.observable,o("design:type",Array)],p.prototype,"osVersionOptions",void 0);i([c.observable,o("design:type",Array)],p.prototype,"manufacturerOptions",void 0);i([c.action,o("design:type",Function),o("design:paramtypes",[typeof(n=typeof Omit!=="undefined"&&Omit)==="function"?n:Object]),o("design:returntype",void 0)],p.prototype,"init",null);i([c.action,o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",void 0)],p.prototype,"deleteRule",null);i([c.action,o("design:type",Function),o("design:paramtypes",[typeof(r=typeof l.MobileRule!=="undefined"&&l.MobileRule)==="function"?r:Object]),o("design:returntype",void 0)],p.prototype,"updateRule",null);t.RulesLocalStore=p=i([(0,a.injectable)()],p)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u,d;Object.defineProperty(t,"__esModule",{value:true});t.RuleListRow=void 0;const p=s(4);const h=s(260);const f=s(10);const m=s(9);const g=s(12);const v=s(11);const S=s(2);const y=s(32);const b=s(40);const _=s(5);const T=s(170);const E=s(15);let I=class e{constructor(e){this.projectsService=e;this.disposers=[(0,S.autorun)((()=>{if(this.rule.field.name==="Manufacturer"&&this.isSLorBSGrid){this.rule.field={name:"Device Name",value:"manufacturer"}}if((this.isBrowserStackGrid||this.isIosProject&&this.isSLorBSGrid)&&this.operator.value!=="regex"&&this.isManufacturerRule){this.rule.operator={name:"regex",value:"regex"}}if(this.isSauceLabsGrid&&this.isManufacturerRule&&this.operator.name==="equals"){this.rule.operator={name:"contains",value:"="}}}))]}onOperatorChange(e){this.rule.operator={name:e.name,value:e.value}}onOperandChange(e){if(typeof e==="object"&&"name"in e){this.rule.operand=e.value;return}this.rule.operand=e.target.value}setOperator(e){this.rule.operator=e}setOperand(e){if(typeof e==="object"&&"name"in e){this.rule.operand=e.value;return}this.rule.operand=e.target.value}get selectedOperatorsType(){if(this.isPcloudyGrid||this.isTestimTvcGrid){return"equals"}if(this.isSauceLabsGrid&&this.isManufacturerRule){return"string-regex"}if(this.isSLorBSGrid){return"regex"}if(!this.isSLorBSGrid&&this.operatorsType==="regex"){return"number"}return this.operatorsType}get isIosProject(){return this.projectsService.projectType==="ios"}get isSauceLabsGrid(){var e;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===_.gridTypes.GRID_TYPE_SAUCELABS}get isBrowserStackGrid(){var e;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===_.gridTypes.GRID_TYPE_BROWSERSTACK}get isSLorBSGrid(){return this.isSauceLabsGrid||this.isBrowserStackGrid}get isPcloudyGrid(){var e;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===_.gridTypes.GRID_TYPE_P_CLOUDY}get isTestimTvcGrid(){var e;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===_.gridTypes.GRID_TYPE_TESTIM_TVC}get operatorDropdown(){if(this.selectedOperatorsType==="number"){return T.numberOperators}if(this.selectedOperatorsType==="string-regex"){return T.stringOperatorsWithRegex}if(this.selectedOperatorsType==="regex"){return T.numberOperatorsWithRegex}if(this.selectedOperatorsType==="equals"){return T.equals}return T.stringOperators}get field(){return this.rule.field}get isManufacturerRule(){return this.field.value==="manufacturer"}get operator(){return this.rule.operator}get operand(){return{name:this.rule.operand,value:this.rule.operand}}get operatorsType(){return this.rule.operatorsType}get renderDropdownOperand(){var e;return((e=this.valueOptions)===null||e===void 0?void 0:e.length)&&this.operator.value!=="regex"}get renderTextboxOperand(){var e;return!((e=this.valueOptions)===null||e===void 0?void 0:e.length)||this.operator.value==="regex"}get renderStaticOperator(){return this.isManufacturerRule&&this.isBrowserStackGrid}get hideManufacturerRule(){return this.isManufacturerRule&&!this.isSLorBSGrid&&this.isIosProject}};i([S.observable,o("design:type",Object)],I.prototype,"rule",void 0);i([S.observable,o("design:type",Array)],I.prototype,"valueOptions",void 0);i([S.observable,o("design:type",Object)],I.prototype,"selectedGrid",void 0);i([S.action,o("design:type",Function),o("design:paramtypes",[typeof(r=typeof b.DropdownOption!=="undefined"&&b.DropdownOption)==="function"?r:Object]),o("design:returntype",void 0)],I.prototype,"onOperatorChange",null);i([S.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],I.prototype,"onOperandChange",null);i([S.action,o("design:type",Function),o("design:paramtypes",[typeof(l=typeof b.DropdownOption!=="undefined"&&b.DropdownOption)==="function"?l:Object]),o("design:returntype",void 0)],I.prototype,"setOperator",null);i([S.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],I.prototype,"setOperand",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"selectedOperatorsType",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isIosProject",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isSauceLabsGrid",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isBrowserStackGrid",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isSLorBSGrid",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isPcloudyGrid",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isTestimTvcGrid",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"operatorDropdown",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"field",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"isManufacturerRule",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"operator",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"operand",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"operatorsType",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"renderDropdownOperand",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"renderTextboxOperand",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"renderStaticOperator",null);i([S.computed,o("design:type",Object),o("design:paramtypes",[])],I.prototype,"hideManufacturerRule",null);I=i([(0,m.injectable)(),o("design:paramtypes",[typeof(n=typeof E.ProjectsService!=="undefined"&&E.ProjectsService)==="function"?n:Object])],I);t.RuleListRow=(0,g.observer)((({rule:e,valueOptions:t,selectedGrid:s})=>{const i=(0,v.useLocalStoreWithInjectedDependencies)(I);i.rule=e!==null&&e!==void 0?e:[];i.valueOptions=t;i.selectedGrid=s;const o=e=>{i.setOperator(e)};const n=e=>{i.setOperand(e)};if(i.hideManufacturerRule){return null}return(0,p.jsx)("div",{className:h.default.rowWrapper,children:(0,p.jsxs)("div",{className:h.default.tableRow,children:[(0,p.jsx)("div",{className:h.default.ruleName,children:(0,p.jsx)("span",{children:i.field.name})}),i.renderStaticOperator?(0,p.jsx)("div",{className:(0,f.default)(h.default.ruleName,h.default.operator),children:(0,p.jsx)("span",{children:i.operator.name})}):(0,p.jsx)(b.Dropdown,{value:i.operator,options:i.operatorDropdown,searchable:false,appendToBody:true,onChange:o}),i.renderDropdownOperand&&(0,p.jsx)(b.Dropdown,{value:i.operand,options:t,searchable:false,appendToBody:true,onChange:n}),i.renderTextboxOperand&&(0,p.jsx)(y.Textbox,{value:i.operand.value,onChange:n,className:h.default.textBox})]})})}));t.RuleListRow.displayName="RuleListRow"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:true});t.MobileConfigLocalStore=void 0;const d=s(6);const p=s(9);const h=s(27);const f=s(2);const m=s(5);const g=s(22);const v=s(15);const S=s(39);const y=s(66);const b=s(170);let _=class e{constructor(e,t,s){this.testimServicesApi=e;this.projectsService=t;this.companiesService=s;this.configRules=b.initialRules;this.configType="dynamic";this.searchValue="";this.selectedDevices=new f.ObservableMap;this.filterBySearchValue=e=>e.name.toLowerCase().includes(this.searchValue)||e.osVersion.includes(this.searchValue);this.disposers=[(0,f.autorun)((()=>{const e=d.isEmpty(this.selectedGrid)||!this.configType;if(e){return}this.updateState({isMobile:true,mobile:{dynamicAllocation:this.dynamicAllocation,staticAllocation:this.staticAllocation,type:this.configType,selectedGrid:this.selectedGrid}})}))]}setSelectedGrid(e){this.selectedGrid=e}setConfigRules(e){this.configRules=e}setSelectedDevicesFromState(e){var t;(t=e.deviceUdid)===null||t===void 0?void 0:t.split(",").forEach((e=>{this.selectedDevices.set(e,{udid:e,isSelected:true})}))}onMount({state:e,updateState:t}){this.updateState=t;const{selectedGrid:s,type:i,dynamicAllocation:o,staticAllocation:n}=e.mobile||{};if(!d.isEmpty(s)){this.setSelectedGrid(s)}if(i){this.setConfigType(i)}if(!d.isEmpty(n)){this.setSelectedDevicesFromState(n)}if(!d.isEmpty(o)){this.setConfigRules(o.rules)}}get isRulesFilterActive(){if(!this.configRules||this.configRules.length===0){return false}const[e,t]=this.configRules.map((e=>e.operand));return!!(e||t)}get staticAllocation(){if(this.configType!=="static"){return{}}if(this.isTestimMobileGrids){const e=Array.from(this.selectedDevices.keys());return{deviceUdid:e.join(",")}}const e=this.selectedDevices.values().next().value;if(e){return{deviceUdid:e.udid,deviceName:e.name,osVersion:e.osVersion}}return{}}get isTestimMobileGrids(){var e,t;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===m.gridTypes.GRID_TYPE_HEADSPIN||((t=this.selectedGrid)===null||t===void 0?void 0:t.type)===m.gridTypes.GRID_TYPE_TESTIM_TDC}get isBrowserStackOrSauceLabsGrids(){var e,t;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===m.gridTypes.GRID_TYPE_SAUCELABS||((t=this.selectedGrid)===null||t===void 0?void 0:t.type)===m.gridTypes.GRID_TYPE_BROWSERSTACK}get ispCloudyGrid(){var e;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===m.gridTypes.GRID_TYPE_P_CLOUDY}get isTestimVirtualGrid(){var e;return((e=this.selectedGrid)===null||e===void 0?void 0:e.type)===m.gridTypes.GRID_TYPE_TESTIM_TVC}get dynamicAllocation(){if(this.configType==="static"||!this.selectedGrid){return{}}if(this.isTestimMobileGrids){const{os_version:e,manufacturer:t}=this.generateHSorTDCSelectors();return{rules:this.configRules,selector:{osVersion:e,manufacturer:t}}}if(this.isBrowserStackOrSauceLabsGrids||this.isTestimVirtualGrid){const{os_version:e,manufacturer:t}=this.generateSelectors(this.buildFieldRegex);return{rules:this.configRules,deviceNameRegex:t,osVersionRegex:e}}if(this.ispCloudyGrid){const{os_version:e,manufacturer:t}=this.generateSelectors(this.buildPcloudyRule);return{rules:this.configRules,deviceNameRegex:t,osVersionRegex:e}}return{}}generateHSorTDCSelectors(){const e=d.groupBy(this.configRules,"field.value");const t={};for(const s of Object.keys(e)){const i=e[s];t[s]=(i===null||i===void 0?void 0:i.map((e=>{if(e.operand==="Any"){return""}if(e.operator.value==="regex"){return e.operand}return`${e.operator.value}${e.operand}`})).join(","))||""}return t}generateSelectors(e){const t=d.groupBy(this.configRules,"field.value");const s={};e=e.bind(this);for(const i of Object.keys(t)){const o=t[i];s[i]=o.reduce(((t,s)=>e(s)),"")}return s}buildFieldRegex(e){if(!e.operand){return""}if(e.operand==="Any"){return".*"}if(e.operator.value==="regex"){return e.operand}const t=e.operator.value;return`^(?${t}${e.operand}.*).*`}buildPcloudyRule(e){const t=this.projectsService.projectType==="ios";const s=e.field.value==="manufacturer";if(s&&t){return"apple"}if(!e.operand){return""}if(e.operand==="Any"){return".*"}return e.operand}resetToDefaultValues(){this.configType="static";this.selectedDevices.clear();this.configRules=b.initialRules}setConfigType(e){this.configType=e;this.selectedDevices.clear();this.setConfigRules(b.initialRules)}get isRulesSectionDisabled(){return this.configType==="static"}get manufacturerOptions(){if(this.mobileDevicesFromGrid.state==="fulfilled"){const e=this.mobileDevicesFromGrid.value.map((({manufacturer:e})=>e));return[...new Set(e)].map((e=>({name:e,value:e})))}return[]}get osVersionOptions(){if(this.mobileDevicesFromGrid.state==="fulfilled"){const e=this.mobileDevicesFromGrid.value.map((({osVersion:e})=>e));return[...new Set(e)].map((e=>({name:e,value:e})))}return[]}getValueToFilter(e,t){if(t.field.value==="os_version"&&t.operator.value==="os_version"){return Number(e.split(".")[0])}return e}filterDeviceListByRule(e,t){const s=this.getValueToFilter(e.operand,e);const i=this.getValueToFilter(t,e);if(s==="Any"){return true}switch(e.operator.value){case"=":return s===i;case"!":return s!==i;case">":return i>s;case">=":return i>=s;case"<":return i<s;case"<=":return i<=s;case"regex":try{return new RegExp(s,"i").test(i)}catch(e){return false}default:return true}}get deviceList(){var e;if(this.mobileDevicesFromGrid.state!=="fulfilled"){return[]}let t=[];t=this.mobileDevicesFromGrid.value.map((e=>({...e,isSelected:this.selectedDevices.has(e.udid)})));if((e=this.configRules)===null||e===void 0?void 0:e.length){const[e,s]=this.configRules;t=t.filter((t=>{let i=true;let o=true;if(e===null||e===void 0?void 0:e.operand){i=this.filterDeviceListByRule(e,t.osVersion)}if(s===null||s===void 0?void 0:s.operand){const e=this.isBrowserStackOrSauceLabsGrids&&s.operator.value==="regex"?t.name:t.manufacturer;o=this.filterDeviceListByRule(s,e)}return i&&o}))}if(this.searchValue){return t.filter(this.filterBySearchValue)}return d.orderBy(t,"isSelected","desc")}get mobileDevicesFromGrid(){return(0,h.fromPromise)(this.getMobileDevicesFromGrid())}async getMobileDevicesFromGrid(){if(!d.isEmpty(this.selectedGrid)){const{_id:e,companyId:t}=this.selectedGrid;const s=this.projectsService.projectType;return await this.testimServicesApi.grid.getMobileDevicesFromGrid({projectType:s,gridId:e,companyId:t})}return[]}get isLoading(){return this.mobileDevicesFromGrid.state==="pending"}get isRejected(){return this.mobileDevicesFromGrid.state==="rejected"}get isViewMode(){return this.configType==="dynamic"||this.mobileDevicesFromGrid.state==="pending"}get isMultiSelectionAllowed(){return this.isTestimMobileGrids&&this.configType==="static"}get gridPageLink(){return y.companyGrids(this.companiesService.companyId)}toggleDeviceListItem(e){if(this.isMultiSelectionAllowed){const t=this.selectedDevices.delete(e.udid);if(!t){this.selectedDevices.set(e.udid,e)}return}const t=this.selectedDevices.has(e.udid);this.selectedDevices.clear();if(!t){this.selectedDevices.set(e.udid,e)}}onSelectAll(e){if(!this.isMultiSelectionAllowed){return}if(e.target.checked){this.mobileDevicesFromGrid.value.forEach((e=>{this.selectedDevices.set(e.udid,{...e,isSelected:true})}))}else{this.selectedDevices.clear()}}onDeviceListSearch(e){this.searchValue=e.currentTarget.value.toLowerCase()}};t.MobileConfigLocalStore=_;i([f.observable.ref,o("design:type",Object)],_.prototype,"selectedGrid",void 0);i([f.observable.ref,o("design:type",Object)],_.prototype,"updateState",void 0);i([f.observable,o("design:type",Array)],_.prototype,"configRules",void 0);i([f.observable,o("design:type",String)],_.prototype,"configType",void 0);i([f.observable,o("design:type",String)],_.prototype,"searchValue",void 0);i([f.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],_.prototype,"setSelectedGrid",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Array]),o("design:returntype",void 0)],_.prototype,"setConfigRules",null);i([f.action,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],_.prototype,"setSelectedDevicesFromState",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isRulesFilterActive",null);i([f.computed.struct,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"staticAllocation",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isTestimMobileGrids",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isBrowserStackOrSauceLabsGrids",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"ispCloudyGrid",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isTestimVirtualGrid",null);i([f.computed.struct,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"dynamicAllocation",null);i([f.action.bound,o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",void 0)],_.prototype,"setConfigType",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isRulesSectionDisabled",null);i([f.computed.struct,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"manufacturerOptions",null);i([f.computed.struct,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"osVersionOptions",null);i([f.computed,o("design:type",Array),o("design:paramtypes",[])],_.prototype,"deviceList",null);i([f.computed,o("design:type",typeof(c=typeof h.IPromiseBasedObservable!=="undefined"&&h.IPromiseBasedObservable)==="function"?c:Object),o("design:paramtypes",[])],_.prototype,"mobileDevicesFromGrid",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isLoading",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isRejected",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isViewMode",null);i([f.computed,o("design:type",Object),o("design:paramtypes",[])],_.prototype,"isMultiSelectionAllowed",null);i([f.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],_.prototype,"toggleDeviceListItem",null);i([f.action.bound,o("design:type",Function),o("design:paramtypes",[typeof(l=typeof React!=="undefined"&&React.ChangeEvent)==="function"?l:Object]),o("design:returntype",void 0)],_.prototype,"onSelectAll",null);i([f.action.bound,o("design:type",Function),o("design:paramtypes",[typeof(u=typeof React!=="undefined"&&React.FormEvent)==="function"?u:Object]),o("design:returntype",void 0)],_.prototype,"onDeviceListSearch",null);t.MobileConfigLocalStore=_=i([(0,p.injectable)(),o("design:paramtypes",[typeof(n=typeof g.TestimServicesApi!=="undefined"&&g.TestimServicesApi)==="function"?n:Object,typeof(r=typeof v.ProjectsService!=="undefined"&&v.ProjectsService)==="function"?r:Object,typeof(a=typeof S.CompaniesService!=="undefined"&&S.CompaniesService)==="function"?a:Object])],_)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SharedResourceWarningBanner=void 0;const i=s(4);const o=s(10);const n=s(726);const r=s(16);const a=s(12);const c=s(34);const l=s(14);const u=s(11);t.SharedResourceWarningBanner=(0,a.observer)((({className:e,isEnabled:t=true})=>{const s=(0,u.useDependencyInjector)(c.BranchesService);const a=(0,u.useDependencyInjector)(l.FeatureFlagsService);t=a.flags.showSharedResourceWarning.isEnabled()&&t;const d=s.activeBranches.length;if(!t||d<2){return null}return(0,i.jsxs)("div",{className:(0,o.default)(n.default.bannerBody,e),children:[(0,i.jsx)(r.Icon,{className:n.default.warningIcon,icon:"warning"})," ",(0,i.jsx)("div",{className:n.default.text,children:"Modifying any field will affect all branches. Please be cautious."})]})}));t.SharedResourceWarningBanner.displayName="SharedResourceWarningBanner"},function(e,t,s){"use strict";s.r(t);t["default"]={bannerBody:"sharedResourceWarningBanner_bannerBody_3OOQL_dhcm5pbmct",warningIcon:"sharedResourceWarningBanner_warningIcon_26Czt_dhcm5pbmct",text:"sharedResourceWarningBanner_text_3mkyT_dhcm5pbmct"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.HooksSection=void 0;const c=s(4);const l=s(56);const u=s(2);const d=s(12);const p=s(9);const h=s(10);const f=s(0);const m=s(120);const g=s(14);const v=s(11);const S=s(5);const y=s(106);const b=s(37);const _={ALWAYS:"always",SUCCESS:"success",FAILURE:"failure"};const T=Object.values(S.commonConstants.HOOK.HANDLER);const E=Object.values(_);function I(e){return S.commonConstants.HOOK.CONDITIONED.includes(e)}function C({config:e,sharedSteps:t}){var s,i,o,n,r;const a={};for(const c of T){a[`${c}_on`]=Boolean((s=e.hooks[c])===null||s===void 0?void 0:s.infoId);a[c]=((i=e.hooks[c])===null||i===void 0?void 0:i.infoId)&&((o=t===null||t===void 0?void 0:t.find((t=>t.value.id===e.hooks[c].infoId)))===null||o===void 0?void 0:o.value);if(I(c)){for(const t of E){const s=t==="always"&&!["failure","success"].includes((n=e.hooks[c])===null||n===void 0?void 0:n.condition);a[`${c}_condition_${t}`]=((r=e.hooks[c])===null||r===void 0?void 0:r.condition)===t||s}}}return a}const D=(e,t)=>{var s;var i;if(!t){return e}const o={...e.hooks,...t.hooks};for(const e of T){if((s=t[e])===null||s===void 0?void 0:s.value){o[e]={infoId:t[e].value.id}}else if(t[`${e}_on`]===false){o[e]=null}if(I(e)&&o[e]){for(const s of E){if(t[`${e}_condition_${s}`]){o[e].condition=s}(i=o[e]).condition||(i.condition=_.ALWAYS)}}}t.hooks=o;return Object.assign({},e,t)};const O=({formValues:e,sharedSteps:t})=>{const s={hooks_message:{type:"message",label:"Before/After hooks",props:{className:(0,h.default)(l.default.separator,l.default.reduceMarginBottom,l.default.subHeader)}}};function i(t){for(const i of E){s[`${t}_condition_${i}`]={type:"radiobutton",label:i,value:e[`${t}_condition_${i}`],labelProps:{className:(0,h.default)(l.default.radioLabel,l.default.reduceMargin)},props:{name:`${t}_condition`},isVisible:(e,s)=>s[`${t}_on`]&&s[t]}}}for(const o of T){s[`${o}_on`]={type:"checkbox",label:S.commonConstants.HOOK.LABEL[o],value:e[`${o}_on`],labelProps:{className:(0,h.default)(l.default.fullLabel,l.default.reduceMarginBottom)}};s[o]={type:"dropdown",value:e[o],props:{options:t!==null&&t!==void 0?t:[],appendToBody:true,placeholder:"Select shared step"},labelProps:{className:(0,h.default)(l.default.fullLabel,l.default.reduceMargin)},isVisible:(e,t)=>t[`${o}_on`]};if(I(o)){s[`${o}_condition_message`]={type:"message",label:"Run on",props:{className:(0,h.default)(l.default.fullLabel,l.default.reduceMargin)},isVisible:(e,t)=>t[`${o}_on`]&&t[o]};i(o)}}return s};let A=class e{get sharedSteps(){const e=this.featureFlagsService.flags.enableGroupHooks.isEnabled()?this.customReuseService.sharedSteps:this.customReuseService.nonGroupSteps;return e.map((e=>({name:e.name,value:e})))}constructor(e,t){this.customReuseService=e;this.featureFlagsService=t;this.reactionDisposer=(0,u.reaction)((()=>({ready:e.isSharedStepsReady,config:this.editedConfig})),(({ready:e,config:t})=>{if(e&&t){const e=C({config:t,sharedSteps:this.sharedSteps});this.items=O({formValues:e,sharedSteps:this.sharedSteps});this.values=e}}),{fireImmediately:true})}onFormChanges({changes:e}){if(!e){return}this.values={...this.values,...e};const t=D(this.editedConfig,e);this.editedConfig.update(t)}dispose(){this.reactionDisposer()}};i([u.observable.ref,o("design:type",Object)],A.prototype,"items",void 0);i([u.observable.ref,o("design:type",typeof(a=typeof FormValues!=="undefined"&&FormValues)==="function"?a:Object)],A.prototype,"values",void 0);i([u.observable.ref,o("design:type",Object)],A.prototype,"editedConfig",void 0);i([u.computed,o("design:type",Object),o("design:paramtypes",[])],A.prototype,"sharedSteps",null);i([u.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],A.prototype,"onFormChanges",null);A=i([(0,p.injectable)(),o("design:paramtypes",[typeof(n=typeof y.CustomReuseService!=="undefined"&&y.CustomReuseService)==="function"?n:Object,typeof(r=typeof g.FeatureFlagsService!=="undefined"&&g.FeatureFlagsService)==="function"?r:Object])],A);t.HooksSection=(0,d.observer)((({config:e,className:t})=>{const s=(0,v.useLocalStoreWithInjectedDependencies)(A);(0,f.useEffect)((()=>{s.editedConfig=e}),[s,e]);if(!s.items||!s.values){return(0,c.jsx)("div",{className:l.default.loaderWrapper,children:(0,c.jsx)(b.Loader,{})})}return(0,c.jsx)(m.Form,{className:t,values:s.values,items:s.items,onChange:s.onFormChanges})}));t.HooksSection.displayName="HooksSection"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChangeTestDefaultConfig=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(56);const a=s(70);const c=s(0);const l=s(30);const u=s(31);const d=s(44);const p=s(20);const h=s(15);const f=s(11);const m=s(37);const g=s(763);const v=s(261);const S=s(107);const y=s(12);const b=s(130);const _=s(14);const T=({closeModal:e,selectedItem:t})=>(0,i.jsxs)("div",{children:[(0,i.jsx)(u.Cta,{disabled:!t,onClick:()=>e(t),children:"Change"}),(0,i.jsx)(u.Cta,{variety:"secondary",onClick:()=>e(),children:"Cancel"})]});T.displayName="Footer";t.ChangeTestDefaultConfig=(0,y.observer)((e=>{const t=(0,f.useDependencyInjector)(h.ProjectsService);const s=(0,f.useDependencyInjector)(S.ConfigListStore);const o=(0,f.useDependencyInjector)(b.ApplitoolsService);const u=(0,f.useDependencyInjector)(_.FeatureFlagsService);const[y,E]=(0,c.useState)(false);const[I,C]=(0,c.useState)(e.selectedConfig);const D=s.configList.value;const O=(0,c.useCallback)((()=>{E(true);C(s.buildNewTestConfig())}),[s,C]);const A=(0,c.useCallback)((e=>{E(false);C(e)}),[C]);return(0,i.jsxs)(l.BaseModal,{className:r.default.modal,closeModal:()=>e.closeModal(),header:(0,i.jsx)("h3",{children:"Change default config"}),footer:(0,i.jsx)(T,{...e,selectedItem:I}),children:[(0,i.jsx)("div",{className:a.default.modalSection,children:D?(0,i.jsxs)(d.FieldLabel,{children:[(0,i.jsx)("span",{children:"Default configuration"}),(0,i.jsx)(g.TestConfigDropDown,{configs:D,selectedConfig:I,onChange:A,onCreateNew:O})]}):(0,i.jsx)("div",{className:r.default.loader,children:(0,i.jsx)(m.Loader,{})})}),y&&(0,i.jsx)("div",{className:(0,n.default)(a.default.modalSection,r.default.separator),children:(0,i.jsx)(v.TestConfigForm,{editedConfig:I,editedSections:{basic:true,advanced:true,hooks:true,applitools:o.isApplitoolsEnabled,nativeEvents:u.flags.nativeClickConfig.isEnabled()}})}),(0,i.jsx)("div",{className:a.default.modalSection,children:!t.isMobileWeb?(0,i.jsxs)("span",{className:r.default.textComment,children:["Debugging & authoring is on Chrome, and you can run on all browser/OSes via the",!p.isEditorForceMode&&(0,i.jsx)("a",{href:"https://help.testim.io/docs/integrate-testim-to-your-ci",rel:"noopener noreferrer",target:"_blank",children:"CLI"}),p.isEditorForceMode&&(0,i.jsx)("span",{children:"scheduler"})]}):(0,i.jsx)("span",{className:r.default.textComment,children:"We open a Chrome window in an emulator mode, which mimics a mobile browser (including user-agent)"})})]})}));t.ChangeTestDefaultConfig.displayName="ChangeTestDefaultConfig"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestConfigDropDown=void 0;const i=s(4);const o=s(0);const n=s(56);const r=s(0);const a=s(40);const c=s(16);const l={name:"Custom (create new)",value:{}};const u=({item:e})=>(0,i.jsxs)("div",{className:n.default.dropDownItem,children:[e.name,e===l?(0,i.jsx)(c.Icon,{icon:"plus--circle",className:n.default.icon}):(0,i.jsx)("span",{className:n.default.resolution,children:`${e.value.resolution.width}x${e.value.resolution.height}`})]});u.displayName="DropdownItem";t.TestConfigDropDown=o.memo((({selectedConfig:e,configs:t,onChange:s,onCreateNew:o})=>{const n=(0,r.useMemo)((()=>[l].concat(t.map((e=>({name:e.name,value:e}))))),[t]);const c=(0,r.useMemo)((()=>n.find((t=>t.value===e))||{name:e.name,value:e}),[n,e]);const d=(0,r.useCallback)((e=>{if(e===l){o()}else{s(e.value)}}),[s,o]);return(0,i.jsx)(a.Dropdown,{options:n,value:c,onChange:d,searchable:false,appendToBody:true,renderItem:u})}));t.TestConfigDropDown.displayName="TestConfigDropDown"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(765),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TestIsRunningModal=void 0;const i=s(4);const o=s(0);const n=s(766);const r=s(12);const a=s(45);const c=s(11);const l=s(104);const u=s(29);const d=6e4;t.TestIsRunningModal=(0,r.observer)((({closeModal:e})=>{const t=(0,c.useDependencyInjector)(l.PlaybackStore);const s=(0,c.useDependencyInjector)(u.EditedTestStore);const p=(0,r.useLocalStore)((()=>({abortTest:false,timeoutId:undefined,get isWaitingLastExecutionToFinish(){return t.isWaitingLastExecutionToFinish},get testName(){return s.testName},onCloseModal(t){if(t){this.abortRunningTest()}else{e()}},abortRunningTest(){this.abortTest=true;t.stopPlaying();this.timeoutId=window.setTimeout((()=>{this.displayNotificationError();e()}),d)},displayNotificationError(){t.handleStopRunningTestError(this.testName)}})));o.useEffect((()=>{if(!p.isWaitingLastExecutionToFinish){e(true)}return()=>{clearTimeout(p.timeoutId)}}),[e,p.isWaitingLastExecutionToFinish,p.timeoutId]);return(0,i.jsx)(a.MessageModal,{closeModal:p.onCloseModal,title:(0,i.jsxs)("div",{className:n.default.header,title:p.testName,children:["Currently running ",p.testName]}),okText:"Ok",cancelText:"Cancel",body:(0,i.jsxs)("div",{className:n.default.content,children:[(0,i.jsxs)("div",{children:["Test - ",p.testName," is running."]}),(0,i.jsx)("div",{children:"Would you like to stop the current test and discard changes?"}),(0,i.jsx)("div",{children:"[Note: the stopping process may take a while]"})]}),displayFooterLoader:p.abortTest})}));t.TestIsRunningModal.displayName="TestIsRunningModal"},function(e,t,s){"use strict";s.r(t);t["default"]={content:"TestIsRunning_content_3lTOS_5nTW9kYWwt",header:"TestIsRunning_header_1Y_qP_5nTW9kYWwt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.formStateToUpdateSchedulerApi=t.formStateToCreateSchedulerApi=t.testPlansWithDisplayName=t.withDisplayName=t.getNotificationEmails=t.buildCronExpression=t.MONITOR_FREE_FREQUENCIES=t.MONITOR_FREQUENCIES=t.NIGHTLY_FREQUENCIES=t.parseCronExp=t.SCHEDULER_TYPES=void 0;const i=s(5);const o=s(8);t.SCHEDULER_TYPES={MONITOR:"Monitor",NIGHTLY:"NightlyRun"};const n=e=>{if(e==="*"){return{sun:true,mon:true,tue:true,wed:true,thu:true,fri:true,sat:true}}const t=e.split(",");const s={sun:false,mon:false,tue:false,wed:false,thu:false,fri:false,sat:false};if(t.includes("0")){s.sun=true}if(t.includes("1")){s.mon=true}if(t.includes("2")){s.tue=true}if(t.includes("3")){s.wed=true}if(t.includes("4")){s.thu=true}if(t.includes("5")){s.fri=true}if(t.includes("6")){s.sat=true}return s};const r=e=>{const s=e.split(" ");const i={min:s[0],hr:s[1],days:s[4]};if(i.min==="0"&&!i.hr.includes("*")){return{type:t.SCHEDULER_TYPES.NIGHTLY,hr:i.hr,min:i.min,weekDays:n(i.days)}}return{type:t.SCHEDULER_TYPES.MONITOR,hr:i.hr,min:i.min,weekDays:n(i.days)}};t.parseCronExp=r;t.NIGHTLY_FREQUENCIES=[{name:"00:00 GMT",hr:"0",min:"0"},{name:"01:00 GMT",hr:"1",min:"0"},{name:"02:00 GMT",hr:"2",min:"0"},{name:"03:00 GMT",hr:"3",min:"0"},{name:"04:00 GMT",hr:"4",min:"0"},{name:"05:00 GMT",hr:"5",min:"0"},{name:"06:00 GMT",hr:"6",min:"0"},{name:"07:00 GMT",hr:"7",min:"0"},{name:"08:00 GMT",hr:"8",min:"0"},{name:"09:00 GMT",hr:"9",min:"0"},{name:"10:00 GMT",hr:"10",min:"0"},{name:"11:00 GMT",hr:"11",min:"0"},{name:"12:00 GMT",hr:"12",min:"0"},{name:"13:00 GMT",hr:"13",min:"0"},{name:"14:00 GMT",hr:"14",min:"0"},{name:"15:00 GMT",hr:"15",min:"0"},{name:"16:00 GMT",hr:"16",min:"0"},{name:"17:00 GMT",hr:"17",min:"0"},{name:"18:00 GMT",hr:"18",min:"0"},{name:"19:00 GMT",hr:"19",min:"0"},{name:"20:00 GMT",hr:"20",min:"0"},{name:"21:00 GMT",hr:"21",min:"0"},{name:"22:00 GMT",hr:"22",min:"0"},{name:"23:00 GMT",hr:"23",min:"0"}];const a={name:"Every 1 hr",hr:"*",min:"*/60"};t.MONITOR_FREQUENCIES=[{name:"Every 5 min",hr:"*",min:"*/5"},{name:"Every 10 min",hr:"*",min:"*/10"},{name:"Every 15 min",hr:"*",min:"*/15"},{name:"Every 30 min",hr:"*",min:"*/30"},a,{name:"Every 2 hr",hr:"*/2",min:"0"}];t.MONITOR_FREE_FREQUENCIES=[a];const c=e=>{if(e.sun&&e.mon&&e.tue&&e.wed&&e.thu&&e.fri&&e.sat){return"*"}const t=[];if(e.sun){t.push("0")}if(e.mon){t.push("1")}if(e.tue){t.push("2")}if(e.wed){t.push("3")}if(e.thu){t.push("4")}if(e.fri){t.push("5")}if(e.sat){t.push("6")}return t.length===0?"*":t.join(",")};const l=({type:e,monitorFrequency:s,nightlyFrequency:i,weekDays:o})=>{const n=c(o);const r={min:"*",hr:"*",day:"*",month:"*",days:n};if(e===t.SCHEDULER_TYPES.MONITOR&&s){r.min=s.min;r.hr=s.hr}else if(e===t.SCHEDULER_TYPES.NIGHTLY&&i){r.min=i.min;r.hr=i.hr}return`${r.min} ${r.hr} ${r.day} ${r.month} ${r.days}`};t.buildCronExpression=l;function u(e,t,s){return s&&(e||t)?s.map((e=>e===null||e===void 0?void 0:e.text)):[]}t.getNotificationEmails=u;function d(e){return e.map((e=>({...e,displayText:e.name.trim()})))}t.withDisplayName=d;function p(e,t){return(t===null||t===void 0?void 0:t.map((t=>{const s=e.find((e=>e.testPlanId===t));return{name:(s===null||s===void 0?void 0:s.name)||t,id:t,displayText:(s===null||s===void 0?void 0:s.name)||t}})))||[]}t.testPlansWithDisplayName=p;function h(e){var s,o,n;const{type:r,monitorFrequency:a,nightlyFrequency:c,weekDays:l,turboMode:d,disableTimeoutRetry:p}=e;const h=(0,t.buildCronExpression)({type:r,monitorFrequency:a,nightlyFrequency:c,weekDays:l});const f=e.branch||i.MASTER_BRANCH;const m=((s=e.testPlans)===null||s===void 0?void 0:s.length)===0?((o=e.selectedGrid)===null||o===void 0?void 0:o.value)||e.gridId||"":"";const g=e.baseUrl||"";const v=e.labelsAndSuites.filter((({isLabel:e})=>e)).map((({name:e})=>e));const S=e.labelsAndSuites.filter((({isSuite:e})=>e)).map((({name:e})=>e));const y=e.testPlans.map((e=>e.id));const b=Number(e.parallel);const _=Number(e.retries);const T=Boolean(e.notifyOnError);const E=Boolean(e.notifyOnEvery);const I=u(T,E,e.notifyEmails);const C=e.notifySlackChannels||[];const D=e.notifySlackChannelsById||[];const O=((n=e.notifyWebhooks)===null||n===void 0?void 0:n.map((({url:e})=>e)))||[];const A=Boolean(e.shouldNotifyEveryFailure);const j=e.resultLabels.map((e=>e.text));const w=e.testTimeoutSec;const R=e.mobileApp||undefined;return{frequency:h,branch:f,gridId:m,baseUrl:g,mobileApp:R,labels:v,suites:S,parallel:b,retries:_,notifyOnError:T,notifyOnEvery:E,notifyEmails:I,notifySlackChannels:C,notifySlackChannelsById:D,notifyWebhooks:O,shouldNotifyEveryFailure:A,resultLabels:j,testTimeoutSec:w,turboMode:d,disableTimeoutRetry:p,testPlans:y}}function f(e,t){var s;const i=o.utils.guid();const n=((s=e.testConfig)===null||s===void 0?void 0:s.id)||"";const r=h(e);return{schedulerId:i,name:e.name,description:e.description,frequency:r.frequency,labels:r.labels,gridId:r.gridId,testConfigId:n,baseUrl:r.baseUrl,mobileApp:r.mobileApp,notifyOnError:r.notifyOnError,notifyEmails:r.notifyEmails,shouldNotifyEveryFailure:r.shouldNotifyEveryFailure,suites:r.suites,parallel:r.parallel,retries:r.retries,branch:r.branch,customExtensionUrl:undefined,resultLabels:r.resultLabels,testTimeoutSec:r.testTimeoutSec,captcha:t,notifySlackChannels:r.notifySlackChannels,notifySlackChannelsById:r.notifySlackChannelsById,notifyWebhooks:r.notifyWebhooks,notifyOnEvery:r.notifyOnEvery,turboMode:r.turboMode,disableTimeoutRetry:r.disableTimeoutRetry,disableCron:undefined,testPlans:r.testPlans}}t.formStateToCreateSchedulerApi=f;function m(e,t){var s;const i=e.showOverrideConfig&&((s=e.testConfig)===null||s===void 0?void 0:s.id)||"";const o=h(e);return{schedulerId:t,name:e.name,description:e.description,frequency:o.frequency,labels:o.labels,gridId:o.gridId,testConfigId:i,baseUrl:o.baseUrl,mobileApp:o.mobileApp,notifyOnError:o.notifyOnError,notifyEmails:o.notifyEmails,shouldNotifyEveryFailure:o.shouldNotifyEveryFailure,suites:o.suites,parallel:o.parallel,retries:o.retries,branch:o.branch,resultLabels:o.resultLabels,customExtensionUrl:undefined,testTimeoutSec:o.testTimeoutSec,notifySlackChannels:o.notifySlackChannels,notifySlackChannelsById:o.notifySlackChannelsById,notifyWebhooks:o.notifyWebhooks,notifyOnEvery:o.notifyOnEvery,turboMode:o.turboMode,disableTimeoutRetry:o.disableTimeoutRetry,testPlans:o.testPlans}}t.formStateToUpdateSchedulerApi=m},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true})},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.TestPlansStore=void 0;const r=s(6);const a=s(9);const c=s(2);const l=s(27);const u=s(43);const d=s(15);const p=e=>e==null?[]:typeof e==="string"&&JSON.parse(e)||e;const h=e=>typeof e==="string"?JSON.parse(e):e||{};let f=class e{constructor(e){this.projectsService=e;this.explicitUpdate=0}get testPlans(){const e=this.explicitUpdate;const t=this.projectsService.projectId;return(0,l.fromPromise)(this.getTestPlans(t))}async getTestPlans(e){const t=await u.testimServicesSingleton.testPlan.getAll(e);return t.map((e=>{var t;const s=h(e.lastResult);const i=!r.isEmpty(s)&&(s.success?"Passed":"Failed");const o={...s,status:i};delete e.lastResult;return{...e,normalizedResult:o,afterAllLabels:p(e.afterAllLabels),afterAllSuites:p(e.afterAllSuites),testLabels:p(e.testLabels),testSuites:p(e.testSuites),beforeAllLabels:p(e.beforeAllLabels),beforeAllSuites:p(e.beforeAllSuites),testConfigIds:p(e.testConfigIds),testPlanId:(t=e._id)!==null&&t!==void 0?t:e.testPlanId}}))}async createTestPlan(e){const t=this.projectsService.projectId;await u.testimServicesSingleton.testPlan.create({...e,projectId:t});this.explicitUpdate++}async updateTestPlan(e){const t=this.projectsService.projectId;await u.testimServicesSingleton.testPlan.update({...e,projectId:t});this.explicitUpdate++}async deleteTestPlans(e){const t=this.projectsService.projectId;const s=e.map((e=>e.testPlanId));await u.testimServicesSingleton.testPlan.delete(t,s);this.explicitUpdate++}};t.TestPlansStore=f;i([c.observable,o("design:type",Object)],f.prototype,"explicitUpdate",void 0);i([c.computed,o("design:type",Object),o("design:paramtypes",[])],f.prototype,"testPlans",null);t.TestPlansStore=f=i([(0,a.injectable)(),o("design:paramtypes",[typeof(n=typeof d.ProjectsService!=="undefined"&&d.ProjectsService)==="function"?n:Object])],f)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OrderedList=void 0;const i=s(4);const o=s(10);const n=s(0);const r=s(771);const a=({items:e,style:t})=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:(0,o.default)(r.default.list,r.default[t]),children:n.Children.map(e,((e,t)=>(0,i.jsx)("div",{children:e},t)))})});t.OrderedList=a;t.OrderedList.displayName="OrderedList"},function(e,t,s){"use strict";s.r(t);t["default"]={list:"OrderedList_list_3H7-n_JlZExpc3Qt",numbered:"OrderedList_numbered_2wCuB_JlZExpc3Qt",bullet:"OrderedList_bullet_3fogb_JlZExpc3Qt"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"e14750dc8c.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"5101fbe770.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"4d83d086ca.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"5ebab9679b.svg"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"7c2e2caf3f.svg"},function(e,t,s){"use strict";s.r(t);t["default"]={rocketLaptop:"Illustrations_rocketLaptop_13pqB_JhdGlvbnMt",plusDocs:"Illustrations_plusDocs_3X-Pr_JhdGlvbnMt",cogWheels:"Illustrations_cogWheels_FZSaL_JhdGlvbnMt",tadaEmoji:"Illustrations_tadaEmoji_15OwQ_JhdGlvbnMt",hourglass:"Illustrations_hourglass_9WUxR_JhdGlvbnMt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InstallExtensionModal=t.SFDCInstallExtensionModal=void 0;const i=s(4);const o=s(0);const n=s(779);const r=s(31);const a=s(79);const c=s(158);const l=s(780);const u=s(781);const d=s(55);const p=s(11);const h=s(30);const f=s(16);const m=({closeModal:e,beforeClose:t})=>{const s=()=>{if(t){t()}e()};return(0,i.jsx)(h.BaseModal,{bodyClassName:`${n.default.sfdc} ${n.default.body}`,closeOnEscape:false,closeOnClickOutside:false,closeModal:s,children:(0,i.jsxs)("div",{className:`${n.default.sfdc} ${n.default.content}`,children:[(0,i.jsx)(f.Icon,{onClick:s,className:n.default.close,icon:"close"}),(0,i.jsx)("img",{className:n.default.img,src:u.default}),(0,i.jsx)("div",{className:n.default.title,children:"Install the Tricentis Testim Extension from the Chrome Web Store."}),(0,i.jsx)("div",{className:n.default.text,children:"To start creating Salesforce tests in your browser you need to install the Tricentis Testim Chrome Extension."}),(0,i.jsx)("hr",{}),(0,i.jsx)(r.Cta,{variety:"large",onClick:a.openInstallExtensionTab,children:"Install Extension"}),(0,i.jsx)("div",{className:n.default.note,children:"*Don't worry, it complies with Google's Content Security policy and we won't use it for anything other than running a test. "})]})})};t.SFDCInstallExtensionModal=m;const g=({blackMode:e,closeModal:s,beforeClose:o})=>{const u=(0,p.useDependencyInjector)(d.PremiumFeaturesService);if(u.isTtaSfdcEnabled){return(0,i.jsx)(t.SFDCInstallExtensionModal,{closeModal:s,beforeClose:o})}const h=()=>{if(o){o()}s()};const f=()=>{window.location.reload()};return(0,i.jsxs)(c.HeadlessModal,{closeModal:h,blackMode:e,zIndex:Number(n.default.zIndexNotificationLayer)+1,children:[(0,i.jsx)("img",{className:n.default.img,src:l.default}),(0,i.jsx)("h3",{children:"Record amazingly stable tests"}),"Start by installing the Tricentis Testim extension* on your Chrome browser. You will need to reload this page after installing the extension.",(0,i.jsx)("div",{className:n.default.ctaWrapper,children:(0,i.jsx)(r.Cta,{variety:"large",onClick:a.openInstallExtensionTab,children:"Install Extension"})}),(0,i.jsx)(r.Cta,{className:n.default.linkLikeButton,onClick:f,children:"I have installed the extension, reload the page"}),(0,i.jsx)("div",{className:n.default.note,children:"*Don't worry, it complies with Google's Content Security policy and we won't use it for anything other than recording a test."})]})};t.InstallExtensionModal=g;t.InstallExtensionModal.displayName="InstallExtensionModal";t.SFDCInstallExtensionModal.displayName="SFDCInstallExtensionModal"},function(e,t,s){"use strict";s.r(t);t["default"]={zIndexNotificationLayer:"3012",ctaWrapper:"installExtension_ctaWrapper_2yTbj_RlbnNpb24t",img:"installExtension_img_2v8cT_RlbnNpb24t",note:"installExtension_note_1IfJB_RlbnNpb24t",sfdc:"installExtension_sfdc_3Rzvc_RlbnNpb24t",body:"installExtension_body_atNOS_RlbnNpb24t",content:"installExtension_content_1hpJY_RlbnNpb24t",close:"installExtension_close_21mii_RlbnNpb24t",title:"installExtension_title_1zlfS_RlbnNpb24t",text:"installExtension_text_1YXHz_RlbnNpb24t",linkLikeButton:"installExtension_linkLikeButton_1jRcD_RlbnNpb24t"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"7bc3b6e3e6.png"},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"cd6ff77766.svg"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(783),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ReloadPageAfterInstallExtension=void 0;const i=s(4);const o=s(0);const n=s(784);const r=s(30);const a=s(270);t.ReloadPageAfterInstallExtension=o.memo((()=>{const[e,t]=o.useState(false);o.useEffect((()=>{if(e){window.location.reload()}}),[e]);return(0,i.jsx)(r.BaseModal,{bodyClassName:`${n.default.sfdc} ${n.default.body}`,closeOnEscape:false,closeOnClickOutside:false,closeModal:()=>{},children:(0,i.jsxs)("div",{className:`${n.default.sfdc} ${n.default.content}`,children:[(0,i.jsx)(a.HourGlass,{onLoad:()=>t(true)}),(0,i.jsx)("div",{className:n.default.title,children:"Checking for extension!"}),(0,i.jsx)("div",{className:n.default.text,children:"Please wait while we check the Testim extension."})]})})}));t.ReloadPageAfterInstallExtension.displayName="ReloadPageAfterInstallExtension"},function(e,t,s){"use strict";s.r(t);t["default"]={sfdc:"ReloadPageAfterInstallExtension_sfdc_10Erk_RlbnNpb24t",body:"ReloadPageAfterInstallExtension_body_36NsF_RlbnNpb24t",content:"ReloadPageAfterInstallExtension_content_1s0gS_RlbnNpb24t",title:"ReloadPageAfterInstallExtension_title_2Xl_Z_RlbnNpb24t",text:"ReloadPageAfterInstallExtension_text_3QiCJ_RlbnNpb24t"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.scheduleToggle=t.bySelector=t.selectProject=t.inviteUser=t.selectTab=t.nullStep=t.saveTest=t.runTest=t.runTestWithIllustration=t.fillRequiredFields=t.closePanel=t.metadataSelection=t.metadataSelections=t.propertyPanelClassNameArea=t.stepModalAddStep=t.settingsTab=t.headerButtonAddNewTest=t.firstSfdcProfileCredentials=t.settingsPageCreateNewItem=t.sidebarItem=t.tourGuideModal=void 0;const i=s(4);const o=s(0);const n=s(786);const r=s(787);const a=s(6);const c=s(149);const l=s(206);const u=s(208);const d=s(788);const p=s(209);const h=s(789);const f=s(5);const m=s(148);const g=s(790);const v=s(251);const S=s(791);const y=s(272);const b=s(792);const _=s(250);const T=({text:e})=>(0,i.jsx)("div",{className:n.default.subtext,children:e});T.displayName="Subtext";const E=({text:e})=>(0,i.jsx)(i.Fragment,{children:(0,a.castArray)(e).map(((e,t)=>(0,i.jsx)("div",{className:n.default.message,children:e},t)))});E.displayName="Message";const I=(e,t,s)=>({message:e,selector:`.${c.default.appHeader}`,backdrop:false,containerClassName:v.default.productTourContainer,tooltipClassName:v.default.productTourTooltip,displayExitTourButton:s===undefined?true:s,analyticsTag:t});t.tourGuideModal=I;const C=(e,t,s,o)=>({...s&&{image:s},...o&&{subtext:()=>(0,i.jsx)(T,{text:o})},message:()=>(0,i.jsx)(E,{text:t}),direction:"right",selector:`.i-${e}`,leftBackgroundDiff:{width:-9,left:0,top:0},rightBackgroundDiff:{left:8,top:0},bottomBackgroundDiff:{width:17,left:-9,top:8},topBackgroundDiff:{width:17,left:-9,height:0,top:-8},extraTooltipStyles:{marginTop:"9px",marginLeft:"25px"},trigger:"click",applyTriggerToParentNode:true,backdrop:true,displayExitTourButton:true,analyticsTag:`sidebar-click-${e}-icon`});t.sidebarItem=C;const D=(e,t,s,o)=>({...s&&{image:s},...o&&{subtext:()=>(0,i.jsx)(T,{text:o})},message:()=>(0,i.jsx)(E,{text:e}),selector:`.${g.default.emptyPageCtaSelector}`,direction:"left",extraTooltipStyles:{marginTop:"5px",width:"320px"},trigger:"click",backdrop:true,displayExitTourButton:true,analyticsTag:`click-add-${t}-cta`});t.settingsPageCreateNewItem=D;const O=(e,t,s)=>({...t&&{image:t},...s&&{subtext:()=>(0,i.jsx)(T,{text:s})},message:()=>(0,i.jsx)(E,{text:e}),direction:"bottom",selector:`.${d.default.firstSfdcProfileCredentialsSelector}`,trigger:"click",noTip:true,backdrop:true,displayExitTourButton:true,analyticsTag:"click-add-credentials"});t.firstSfdcProfileCredentials=O;const A=()=>({message:()=>(0,i.jsx)(E,{text:"Click here to add a test"}),direction:"left",selector:`.${c.default.appHeader} .${m.default.buttons} button:last-child`,trigger:"click",backdrop:true,displayExitTourButton:true,analyticsTag:"click-add-new-test",tooltipClassName:n.default.headerButtonAddNewTest});t.headerButtonAddNewTest=A;const j=(e,t,s,o)=>({...s&&{image:s},...o&&{subtext:()=>(0,i.jsx)(T,{text:o})},message:()=>(0,i.jsx)(E,{text:t}),direction:"bottom",selector:`.${e}`,leftBackgroundDiff:{width:-11,left:0,top:0},rightBackgroundDiff:{left:11,top:0},bottomBackgroundDiff:{width:22,left:-11,top:10},topBackgroundDiff:{width:22,left:-11,height:0,top:-10},extraTooltipStyles:{marginTop:"25px"},trigger:"click",backdrop:true,displayExitTourButton:true,analyticsTag:(0,a.kebabCase)(String(e).split("Selector")[0])});t.settingsTab=j;const w=(e,t,s,o,n)=>({...o&&{image:o},...n&&{subtext:()=>(0,i.jsx)(T,{text:n})},message:()=>(0,i.jsx)(E,{text:s}),direction:"bottomLeft",selector:`.${f.globalSelectors.editorAddStep}>div:first-child`,trigger:"click",backdrop:true,extraTooltipStyles:{marginTop:"15px",width:"412px"},context:{editorMenu:{stepIndex:e,initialTab:"sfdcSteps",searchQuery:t}},displayExitTourButton:true,analyticsTag:`add-${(0,a.kebabCase)(t)}-pallet-item`});t.stepModalAddStep=w;const R=(e,t,s,o,n,r)=>({...r&&{subtext:()=>(0,i.jsx)(T,{text:r})},message:()=>(0,i.jsx)(E,{text:e}),direction:"bottom",selector:t,trigger:o||"handled-at-runtime",leftBackgroundDiff:{width:-20,left:0,top:0},rightBackgroundDiff:{left:20,top:0},bottomBackgroundDiff:{width:40,left:-20,top:5},topBackgroundDiff:{width:40,left:-20,height:0,top:-5},extraTooltipStyles:{marginTop:"20px"},backdrop:true,context:{endStepArgs:s||{}},displayExitTourButton:true,analyticsTag:n});t.propertyPanelClassNameArea=R;const P=(e,s,i)=>e.map(((e,o)=>(0,t.propertyPanelClassNameArea)((0,y.toolTipTextLookup)(e),`.${h.default.sfdcMetadataSelector}:nth-child(${o+1})`,s,undefined,(0,y.analyticsKeyLookup)(e),i)));t.metadataSelections=P;const x=(e,s,i)=>(0,t.propertyPanelClassNameArea)((0,y.toolTipTextLookup)(e),`.${h.default.sfdcMetadataSelector}:last-child`,s,undefined,(0,y.analyticsKeyLookup)(e),i);t.metadataSelection=x;const M=(e,t)=>({...t&&{subtext:()=>(0,i.jsx)(T,{text:t})},message:()=>(0,i.jsx)(E,{text:"When you are done you can close this panel"}),direction:"topRight",selector:`.${r.default.sfdcPropertyPanelContainer}`,trigger:"handled-at-runtime",backdrop:true,extraTooltipStyles:{width:"700px"},displayExitTourButton:true,analyticsTag:e});t.closePanel=M;const N=(e,t)=>({...t&&{subtext:()=>(0,i.jsx)(T,{text:t})},message:()=>(0,i.jsx)(E,{text:e||"You'll need to complete any mandatory fields (bold with an asterisk *)."}),direction:"left",selector:`.${r.default.sfdcPropertyContents}`,leftBackgroundDiff:{width:-10,left:0,top:0},bottomBackgroundDiff:{width:10,left:-10,top:0},topBackgroundDiff:{width:10,left:-10,height:0,top:0},extraTooltipStyles:{marginRight:"30px"},trigger:"form-valid",backdrop:true,displayExitTourButton:true,analyticsTag:"fill-required-fields"});t.fillRequiredFields=N;const F=()=>({image:p.default,message:()=>(0,i.jsx)(E,{text:"Click play to run our test"}),selector:`.${l.default.mainPlayButton}`,trigger:"click",backdrop:false,extraTooltipStyles:{marginTop:"20px",width:"222px"},displayExitTourButton:false,analyticsTag:"run-test"});t.runTestWithIllustration=F;const L=()=>({message:()=>(0,i.jsx)(E,{text:'Click on the "Play" button to run this test.'}),selector:`.${l.default.mainPlayButton}`,trigger:"click",backdrop:true,backdropTransparent:true,extraTooltipStyles:{marginTop:"20px",width:"300px"},closeOnClickOutside:false,analyticsTag:"run-a-test"});t.runTest=L;const k=e=>({message:()=>(0,i.jsx)(E,{text:['Click on the "SAVE" button to save this test.']}),selector:`.${u.default.saveButton}:not([disabled])`,trigger:"click",backdrop:true,extraTooltipStyles:{marginTop:"25px",width:"257px"},direction:"bottomRight",analyticsTag:"save-test",context:e});t.saveTest=k;const B=e=>({message:()=>null,noTip:true,selector:"",analyticsTag:"wait-null-step",context:e});t.nullStep=B;const U=e=>({message:()=>(0,i.jsx)(E,{text:["Now we need to create a Persona so your tests can access your environments.","Click on the Personas button to go to the personas page."]}),selector:`.${S.default.tabs} span:nth-of-type(${e}) button`,trigger:"click",backdrop:true,extraTooltipStyles:{marginTop:"15px",marginLeft:"15px"},direction:"right",displayExitTourButton:true,analyticsTag:"click-salesforce-settings-tab"});t.selectTab=U;const G=()=>({message:()=>(0,i.jsx)(E,{text:["Without Admin login you will not be able to use the app to the fullest potential.",'Click the "+" icon to invite someone to your project.']}),selector:`.${b.default.headerToolbar} button`,trigger:"click",backdrop:true,extraTooltipStyles:{marginTop:"15px",marginRight:"20px"},direction:"left",displayExitTourButton:true,analyticsTag:"click-salesforce-settings-tab"});t.inviteUser=G;const V=()=>({message:()=>(0,i.jsx)(E,{text:"You can go to your Project from here."}),selector:`.${m.default.left}`,backdrop:false,trigger:"click",direction:"bottom",closeOnClickOutside:true,analyticsTag:"highlight-project-selector"});t.selectProject=V;const H=(e,t,s)=>({message:()=>(0,i.jsx)(E,{text:t}),selector:e,direction:"top",trigger:"click",backdrop:false,displayExitTourButton:false,...s});t.bySelector=H;const $=()=>({message:()=>(0,i.jsx)(E,{text:["Toggle to activate this as a scheduled test run.","Schedule your tests to run on a regular basis, triggered by events, with different browsers and resolutions, and save time by executing them across multiple virtual machines."]}),selector:`.${_.default.toggleSwitchLabel}`,extraTooltipStyles:{marginTop:"20px"},direction:"bottomRight",trigger:"click",backdrop:true,backdropTransparent:true,closeOnClickOutside:false,displayExitTourButton:false,analyticsTag:"click-scheduled-run-toggle-switch",tooltipClassName:n.default.scheduleToggle});t.scheduleToggle=$},function(e,t,s){"use strict";s.r(t);t["default"]={message:"Styles_message_1DzPN_RjVG91cnMt",subtext:"Styles_subtext_J0uHc_RjVG91cnMt",scheduleToggle:"Styles_scheduleToggle_1Kudw_RjVG91cnMt",headerButtonAddNewTest:"Styles_headerButtonAddNewTest_3dkEf_RjVG91cnMt"}},function(e,t,s){"use strict";s.r(t);t["default"]={sfdcPropertyPanelContainer:"SfdcPropertyPanelContainer_sfdcPropertyPanelContainer_VgyfS_R5UGFuZWwt",tabContainer:"SfdcPropertyPanelContainer_tabContainer_Ve9HZ_R5UGFuZWwt",tab:"SfdcPropertyPanelContainer_tab_NB3fY_R5UGFuZWwt",closeWrapper:"SfdcPropertyPanelContainer_closeWrapper_2040H_R5UGFuZWwt",iconLight:"SfdcPropertyPanelContainer_iconLight_2RCUI_R5UGFuZWwt",radioButtonGroup:"SfdcPropertyPanelContainer_radioButtonGroup_2W4GA_R5UGFuZWwt",sfdcPropertyContents:"SfdcPropertyPanelContainer_sfdcPropertyContents_2TAsm_R5UGFuZWwt",testimPropertiesPanel:"SfdcPropertyPanelContainer_testimPropertiesPanel_O4wc9_R5UGFuZWwt"}},function(e,t,s){"use strict";s.r(t);t["default"]={firstSfdcProfileCredentialsSelector:"SalesforceProfileEnvironmentCredentialsMissing_firstSfdcProfileCredentialsSelector_2Lu89_JvZmlsZXMt",profileButton:"SalesforceProfileEnvironmentCredentialsMissing_profileButton_1GxiM_JvZmlsZXMt",selected:"SalesforceProfileEnvironmentCredentialsMissing_selected_3MTa6_JvZmlsZXMt",menu:"SalesforceProfileEnvironmentCredentialsMissing_menu_1azVd_JvZmlsZXMt",warning:"SalesforceProfileEnvironmentCredentialsMissing_warning_19Jlu_JvZmlsZXMt"}},function(e,t,s){"use strict";s.r(t);t["default"]={sfdcLabel:"MetadataSelector_sfdcLabel_1jJcq_VsZWN0b3It",error:"MetadataSelector_error__f-xx_VsZWN0b3It",sfdcMetadataSelector:"MetadataSelector_sfdcMetadataSelector_1_Won_VsZWN0b3It",sfdcDropDownWrapper:"MetadataSelector_sfdcDropDownWrapper_3Tjt2_VsZWN0b3It",sfdcDropDown:"MetadataSelector_sfdcDropDown_211_V_VsZWN0b3It"}},function(e,t,s){"use strict";s.r(t);t["default"]={container:"EmptyPage_container_2LsVZ_B0eVBhZ2Ut",noContent:"EmptyPage_noContent_4GGrW_B0eVBhZ2Ut",secondaryText:"EmptyPage_secondaryText_3Bcdc_B0eVBhZ2Ut",seeDocs:"EmptyPage_seeDocs_ZJNDh_B0eVBhZ2Ut",emptyPageCtaSelector:"EmptyPage_emptyPageCtaSelector_2zrKo_B0eVBhZ2Ut"}},function(e,t,s){"use strict";s.r(t);t["default"]={tabs:"innerPageTabs_tabs_2txfz_FnZVRhYnMt",tabButton:"innerPageTabs_tabButton_OceQZ_FnZVRhYnMt",selectedTab:"innerPageTabs_selectedTab_1lNNh_FnZVRhYnMt",content:"innerPageTabs_content_ndunh_FnZVRhYnMt"}},function(e,t,s){"use strict";s.r(t);t["default"]={selectableList:"SelectableList_selectableList_3LcMu_JsZUxpc3Qt",filtersOpen:"SelectableList_filtersOpen_4h9cv_JsZUxpc3Qt",loader:"SelectableList_loader_3bqqi_JsZUxpc3Qt",header:"SelectableList_header_1xb1q_JsZUxpc3Qt",headerTop:"SelectableList_headerTop_12sqQ_JsZUxpc3Qt",headerToolbar:"SelectableList_headerToolbar_tWYyp_JsZUxpc3Qt",search:"SelectableList_search_3ukcs_JsZUxpc3Qt",resetSearch:"SelectableList_resetSearch_1hdTh_JsZUxpc3Qt",autocompleteIcon:"SelectableList_autocompleteIcon_83bj9_JsZUxpc3Qt",filterButton:"SelectableList_filterButton_3KVzK_JsZUxpc3Qt",toolbarSeparator:"SelectableList_toolbarSeparator_1-n1M_JsZUxpc3Qt",subheader:"SelectableList_subheader_2l-vV_JsZUxpc3Qt",searchResultHeader:"SelectableList_searchResultHeader__lk0c_JsZUxpc3Qt",seperator:"SelectableList_seperator_11kT7_JsZUxpc3Qt",close:"SelectableList_close_1vF4y_JsZUxpc3Qt",noResult:"SelectableList_noResult_209G3_JsZUxpc3Qt",noResultText:"SelectableList_noResultText_3f3wd_JsZUxpc3Qt",selectionDescription:"SelectableList_selectionDescription_14TvT_JsZUxpc3Qt",selectableListNotification:"SelectableList_selectableListNotification_2h4r0_JsZUxpc3Qt",error:"SelectableList_error_kA4yx_JsZUxpc3Qt",message:"SelectableList_message_T7MjX_JsZUxpc3Qt",icon:"SelectableList_icon_zHccz_JsZUxpc3Qt"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"e8f3cb2d0b.svg"},function(e,t,s){"use strict";s.r(t);t["default"]={loginContainer:"SfdcLoginPropertyPanel_loginContainer_3aKoX_R5UGFuZWwt",configure:"SfdcLoginPropertyPanel_configure_2GI9o_R5UGFuZWwt",profileSelector:"SfdcLoginPropertyPanel_profileSelector_Fg4cU_R5UGFuZWwt",create:"SfdcLoginPropertyPanel_create_15GtE_R5UGFuZWwt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SFDC_STEP_TYPES=void 0;t.SFDC_STEP_TYPES={LOGIN:"Log in",LOGIN_AS:"Log in as",LOGOUT:"Log out",LAUNCH_APP:"Launch app",CLOSE_CONSOLE_TABS:"Close console tabs",FIND_RECORD:"Find and go to record",WAIT_FOR_PAGE_LOAD:"Wait for page load",SOBJECT_CREATE:"Create",SOBJECT_VALIDATE:"Validate",SOBJECT_EDIT:"Edit",SOBJECT_DELETE:"Delete",SOBJECT_QUICK_ACTION:"Quick actions",SOBJECT_RELATED_LIST_ACTION:"Related list actions",CONVERT_LEAD_TO_OPPORTUNITY:"Convert lead to opportunity",APEX_ACTION:"Execute Apex",PERMISSION_VALIDATION:"Permission validation",QUOTE_LINE_EDITOR_ACTION:"Quote line editor action",DOCUMENT_VALIDATION:"Document validation"}},function(e,t,s){"use strict";s.r(t);t["default"]={createButton:"SfdcCreateSampleTestsButton_createButton_26aBY_xlVGVzdHMt"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.authenticationFromCache=void 0;const i=s(194);const o=s(8);const n=s(7);const r=s(5);const a=s(43);const c=n.Logger.getLogger("AuthenticationFromCache");function l(e){return Boolean(e===null||e===void 0?void 0:e.token)}class u{getCachedLoginData(){const e=o.utils.getStorage().getItem("loginData");let t={};if(e){try{t=JSON.parse(e)}catch(e){c.warn("error parsing local storage login data",{error:e})}}return t}async checkAuth(e){if(i.default.isTokenAlive(e,0)){return}const t=await a.testimServices.auth.getNewToken(e);Object.assign(e,t)}async loginFromCache(){const e=this.getCachedLoginData();if(!l(e)){throw new Error("no login data or token in cache")}i.default.setLoginData(e);if(e.uid===r.commonConstants.defaults.FAKE_CODE_USER_ID){return undefined}try{await this.checkAuth(e);i.default.login(e);return e}catch(e){i.default.logout();throw e}}}t.authenticationFromCache=new u},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(799),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ForkBranchToast=void 0;const i=s(4);const o=s(0);const n=s(800);const r=s(0);const a=s(224);const c={complete:{type:"V",backgroundType:"success"},"quick-complete":{type:"V",backgroundType:"success"},progress:{type:"merge",backgroundType:"primary"},failed:{type:"exc-mark",backgroundType:"error"}};const l=(e,t)=>{if(e==="failed")return`Failed creating branch ${t}`;if(e==="progress")return`Creating new branch ${t}`;return`Branch ${t} created`};const u=({closeToast:e,animationContainer:t,branchName:s,onCheckout:o,type:u,timeout:d=10*1e3})=>{const p=(0,r.useMemo)((()=>l(u,s)),[u,s]);const h=(0,i.jsx)("p",{className:n.default.ellipsisedMessage,title:p,children:p});const f=(0,r.useCallback)((()=>{e();o===null||o===void 0?void 0:o()}),[e,o]);return(0,i.jsx)(a.Toast,{closeToast:e,animationContainer:t,icon:c[u],timeout:d,children:u==="complete"?(0,i.jsxs)("div",{className:n.default.messageWithAction,children:[h,(0,i.jsxs)("p",{children:[" - ",(0,i.jsx)("button",{onClick:f,children:"Open branch"})]})]}):h})};t.ForkBranchToast=u;t.ForkBranchToast.displayName="ForkBranchToast"},function(e,t,s){"use strict";s.r(t);t["default"]={ellipsisedMessage:"forkBranchToast_ellipsisedMessage_3YqCs_tCcmFuY2gt",messageWithAction:"forkBranchToast_messageWithAction_2noy0_tCcmFuY2gt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(802),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChromePermissionsModal=void 0;const i=s(4);const o=s(803);const n=s(0);const r=s(120);const a=s(11);const c=s(62);const l=s(0);const u=e=>{const t=(0,a.useDependencyInjector)(c.hostServiceFactory);const s=(0,l.useCallback)(((s,i)=>{if(i){i.preventDefault()}if(s){const e=t().activeHost;e.openExtensionManager()}e.closeModal(Boolean(s))}),[t,e]);const n=(0,i.jsxs)("span",{children:[e.message,"Open ",(0,i.jsx)("a",{onClick:e=>s(true,e),href:"chrome://extensions",children:"Chrome Extensions"})," and",(0,i.jsx)("br",{}),'enable the "Allow $',e.permissionName,'" permission.']});return(0,i.jsx)(r.FormModal,{className:o.default.chromePermissions,closeModal:s,okText:"Allow",header:e.title,items:{message:{type:"message",label:n,props:{className:o.default.message}},image:{type:"image",props:{src:e.image}}}})};t.ChromePermissionsModal=u;t.ChromePermissionsModal.displayName="ChromePermissionsModal"},function(e,t,s){"use strict";s.r(t);t["default"]={chromePermissions:"chromePermissions_chromePermissions_nDauT_lzc2lvbnMt",message:"chromePermissions_message_11lvl_lzc2lvbnMt"}},function(e,t,s){"use strict";(function(e){var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:true});t.AppConfigManager=void 0;const n=s(2);const r=s(8);const a=s(7);const c=s(42);const l=s(43);const u=a.Logger.getLogger("main");class d{constructor(){this.promise=(async()=>{try{const e=await r.utils.promiseTimeout(c.httpRequest.getJson(`./config.json?${Date.now()}`),15e3);u.log("finished to read config file",e);this.appConfig=e!==null&&e!==void 0?e:{};const{SERVICES_URL:t}=this.appConfig;if(t){r.utils.updateServicesUrl(t);l.testimServicesSingleton.changeBaseUrl(t)}}catch(e){u.error("failed to get config",e)}})()}}i([n.observable,o("design:type",Object)],d.prototype,"appConfig",void 0);t.AppConfigManager=e.env.isMobileMirror?{}:new d}).call(this,s(35))},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r;Object.defineProperty(t,"__esModule",{value:true});t.UIFeatureFlagsService=void 0;const a=s(14);const c=s(5);const l=s(119);const u=s(38);const d=s(9);const p=s(33);let h=class e extends p.EventEmitter{constructor(e,t){super();this.featureFlagsService=a.default;let s=false;this.flags=this.featureFlagsService.flags;e.addCommandBinding(e.GLOBAL_LAYER,"featureFlagsDebug",(()=>{if(s||window.location.host==="localhost:3000"){const e=document.querySelector(".roxPushAside.roxTitle a");if(e){e.dispatchEvent(new MouseEvent("click"))}else{this.showOverrides()}}}));t.on(c.commonConstants.scenario.APP_LOGIN,(e=>{var t;s=Boolean((t=e.adminSettings)===null||t===void 0?void 0:t.isAdmin)}));t.on(c.commonConstants.scenario.APP_LOGOUT,(()=>{s=false}));this.setGitBranch()}get targetingObservable(){return this.featureFlagsService.targetingObservable}setStringCustomProperty(e,t){this.featureFlagsService.setStringCustomProperty(e,t)}setBooleanCustomProperty(e,t){this.featureFlagsService.setBooleanCustomProperty(e,t)}setProjectId(e){this.featureFlagsService.setProjectId(e)}setProjectType(e){this.featureFlagsService.setProjectType(e)}setCompanyId(e){this.featureFlagsService.setCompanyId(e)}setPlanType(e){this.featureFlagsService.setPlanType(e)}setIsPOC(e){this.featureFlagsService.setIsPOC(e)}setIsStartUp(e){this.featureFlagsService.setIsStartUp(e)}setCompanyProductType(e){this.featureFlagsService.setCompanyProductType(e)}setEmail(e){this.featureFlagsService.setEmail(e)}isAdmin(e){this.featureFlagsService.isAdmin(e)}showOverrides(){this.featureFlagsService.showOverrides();const e=document.querySelector(".roxPushAside.roxTitle a");const t=document.querySelector(".roxSearch input");if(!e){return}t===null||t===void 0?void 0:t.focus();const s=()=>{this.updateObservableOnClose();e.removeEventListener("click",s)};e.addEventListener("click",s)}updateObservableOnClose(){this.featureFlagsService.targetingObservable++}fetch(){return this.featureFlagsService.fetch()}setGitBranch(){this.featureFlagsService.setGitBranch()}};t.UIFeatureFlagsService=h;t.UIFeatureFlagsService=h=i([(0,d.injectable)(),o("design:paramtypes",[typeof(n=typeof l.KeyInputService!=="undefined"&&l.KeyInputService)==="function"?n:Object,typeof(r=typeof u.AuthenticationService!=="undefined"&&u.AuthenticationService)==="function"?r:Object])],h)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ModalProvider=void 0;const i=s(4);const o=s(0);const n=s(50);const r=s(11);const a=s(28);const c=s(12);const l=s(67);t.ModalProvider=(0,c.observer)((()=>{const e=(0,r.useDependencyInjector)(a.ModalService);return(0,i.jsxs)(o.Fragment,{children:[[...e.modalInstances.values()].map((e=>{const t=e.Component;return n.createPortal((0,i.jsx)(t,{closeModal:e.close,...e.props}),document.body)})),Boolean(e.toastInstancesLeft.size)&&n.createPortal((0,i.jsx)(l.ToastsWrapper,{position:"left",children:[...e.toastInstancesLeft.values()].map((({Component:e,removeToast:t,props:s,id:o,animationContainer:n})=>(0,i.jsx)(e,{closeToast:t,...s,animationContainer:n},o)))}),document.body),Boolean(e.toastInstancesRight.size)&&n.createPortal((0,i.jsx)(l.ToastsWrapper,{position:"right",children:[...e.toastInstancesRight.values()].map((({Component:e,removeToast:t,props:s,id:o,animationContainer:n})=>(0,i.jsx)(e,{closeToast:t,...s,animationContainer:n},o)))}),document.body)]})}));t.ModalProvider.displayName="ModalProvider"},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(808),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Recording=void 0;const i=s(4);const o=s(809);const n=s(12);const r=s(0);const a=s(11);const c=s(810);const l=s(69);const u=s(99);t.Recording=(0,n.observer)((()=>{const e=(0,a.useDependencyInjector)(l.BugimDataStore);const t=(0,a.useDependencyInjector)(u.BugimOutput);const s=(0,a.useDependencyInjector)(c.Analytics);const d=(0,n.useLocalStore)((()=>({annotateRequested:false,timer:"0:00",interval:-1,stepCount:Math.max(e.getStepCount(),0)||0,stopTimer:()=>{clearInterval(d.interval);d.interval=-1},startTimer:e=>{if(d.interval>0){return}d.interval=window.setInterval((()=>{const t=(Date.now()-e)/1e3;const s=Math.trunc(t%60);const i=s>=10?s:`0${s}`;const o=Math.trunc((t-s)/60);d.timer=`${o}:${i}`}))}})));const p=(0,r.useCallback)((()=>{s.stopRecord();window.location.hash="#/annotate"}),[s]);const h=(0,r.useCallback)((()=>{d.annotateRequested=true;d.stopTimer();e.setTimer(d.timer);t.requestAnnotation();t.recordCompleted()}),[d,e,t]);(0,r.useEffect)((()=>{e.subscribe("screenshotImage",(()=>p()));e.subscribe("stepCount",(e=>{d.stepCount=e}));if(e.getRecordStartTime()){d.startTimer(e.getRecordStartTime())}else{e.subscribe("RecordStartTime",(e=>d.startTimer(e)))}}),[e,p,d]);return(0,i.jsx)("div",{className:o.default.recording,children:!d.annotateRequested&&(0,i.jsxs)("div",{className:o.default.fab,onClick:h,children:[(0,i.jsx)("div",{className:o.default.stepCounter,children:d.stepCount}),(0,i.jsxs)("div",{className:o.default.fabContent,children:[(0,i.jsx)("div",{className:o.default.rectangle}),(0,i.jsx)("div",{className:o.default.timer,children:d.timer})]})]})})}))},function(e,t,s){"use strict";s.r(t);t["default"]={fab:"recording_fab_3v97M_NvcmRpbmct",rectangle:"recording_rectangle_3svTo_NvcmRpbmct",stepCounter:"recording_stepCounter_3tcNM_NvcmRpbmct",fabContent:"recording_fabContent_2ZY4n_NvcmRpbmct",text:"recording_text_2A380_NvcmRpbmct",recording:"recording_recording_2HPfW_NvcmRpbmct",timer:"recording_timer_2QYDN_NvcmRpbmct"}},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.Analytics=void 0;const r=s(9);const a=s(811);let c=class e{constructor(e){this.communicationService=e}_track(e){this.communicationService.analyticsTrack(e)}popupOpened(){this._track("opened")}login(){this._track("login")}logout(){this._track("logout")}startRecord(){this._track("start-record")}stopRecord(){this._track("stop-record")}captureScreenshot(){this._track("start-capture-screenshot")}openTestim(){this._track("open-testim")}createAutomatedTest(){this._track("create-automated-test")}};t.Analytics=c;t.Analytics=c=i([(0,r.injectable)(),o("design:paramtypes",[typeof(n=typeof a.CommunicationService!=="undefined"&&a.CommunicationService)==="function"?n:Object])],c)},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r,a;Object.defineProperty(t,"__esModule",{value:true});t.CommunicationService=void 0;const c=s(9);const l=s(79);const u=s(5);const d=s(812);const p=s(2);const h=s(8);const f=s(118);const m=20;let g=class e{constructor(e){this.extensionService=e;this.loginData=null;this.isSessionStarted=false;this.handlers={[u.commonConstants.host.SESSION_STARTED]:e=>{this.currentProjectId=e.currentProjectId;this.currentBranch=e.currentBranch;this.company=e.company;this.isMobileWeb=e.isMobileWeb;this.projectType=e.projectType;this.loginData=e.loginData;this.recBugimSessionIds=e.recBugimSessionIds;this.isSessionStarted=true;this.clickimBaseUrl=e.clickimBaseUrl||d.testimEnvironment.appBaseUrl},default:()=>({})}}executeCommand(e){var t,s;const i=e.command||"default";(s=(t=this.handlers)===null||t===void 0?void 0:t[i])===null||s===void 0?void 0:s.call(t,e.data)}_postMessage(e,t){var s;(s=this._port)===null||s===void 0?void 0:s.postMessage({command:e,data:t})}async initPort(e=m){const t="https://www.testim.io";const s=[/chrome\.google\.com\/webstore/,/chrome:\/\//,/about:blank/];let i=await this.extensionService.send({type:u.commonConstants.host.GET_ACTIVE_TAB});if(!i&&e--<=0){i=await this.extensionService.send({type:u.commonConstants.host.GET_LAST_ACTIVE_TAB});if(!i){throw new Error("Port initialization start out of retries")}}if(!i){await h.utils.delay(200);return this.initPort(e-1)}this.currentTab=i;if(i.id&&i.url&&s.some((e=>e.test(i.url)))){f.browser.tabs.updateAsync(i.id,{url:t}).finally((()=>window.close()))}else{return this.extensionService.openPort(`TestimBrowserAction_${i.id}`)}return null}async start(){this._port=await this.initPort();if(this._port){this._port.onMessage.addListener((e=>this.executeCommand(e)));this._port.onDisconnect.addListener((()=>{this.isSessionStarted=false}))}}logout(){this._postMessage(u.commonConstants.scenario.APP_LOGOUT);this.loginData=null}isLoggedIn(){var e,t,s;return Boolean(((t=(e=this.loginData)===null||e===void 0?void 0:e.authData)===null||t===void 0?void 0:t.uid)||((s=this.loginData)===null||s===void 0?void 0:s.uid))}get isRecording(){var e;return this.recBugimSessionIds?this.recBugimSessionIds.includes((e=this.currentTab.id)!==null&&e!==void 0?e:-1):false}analyticsTrack(e,t={}){var s;t.timestamp=new Date;e=`bugim-${e}`;const i=((s=this.loginData)===null||s===void 0?void 0:s.authData)?this.loginData.authData.uid:"not-logged-in-user";this._postMessage(u.commonConstants.bugim.ANALYTICS_TRACK,{eventName:e,userId:i,eventData:t})}recordBug(){this._postMessage(u.commonConstants.bugim.RECORD_BUG,{projectId:this.currentProjectId,branch:this.currentBranch,company:this.company,loginData:this.loginData})}captureScreenshot(){this._postMessage(u.commonConstants.bugim.CAPTURE_SCREENSHOT,{projectId:this.currentProjectId,branch:this.currentBranch,company:this.company,loginData:this.loginData})}restartCaptureScreenshot(){this._postMessage(u.commonConstants.bugim.RESTART_CAPTURE_SCREENSHOT)}restartRecordBug(){this._postMessage(u.commonConstants.bugim.RESTART_RECORD_BUG)}};t.CommunicationService=g;i([p.observable,o("design:type",Object)],g.prototype,"projectType",void 0);i([p.observable,o("design:type",String)],g.prototype,"clickimBaseUrl",void 0);i([p.observable,o("design:type",typeof(a=typeof chrome!=="undefined"&&(r=chrome.tabs)!==void 0&&r.Tab)==="function"?a:Object)],g.prototype,"currentTab",void 0);i([p.observable,o("design:type",Array)],g.prototype,"recBugimSessionIds",void 0);i([p.observable,o("design:type",Object)],g.prototype,"loginData",void 0);i([p.observable,o("design:type",Object)],g.prototype,"isSessionStarted",void 0);i([p.computed,o("design:type",Object),o("design:paramtypes",[])],g.prototype,"isRecording",null);t.CommunicationService=g=i([(0,c.injectable)(),o("design:paramtypes",[typeof(n=typeof l.ExtensionService!=="undefined"&&l.ExtensionService)==="function"?n:Object])],g)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.testimEnvironment=void 0;var i=s(813);Object.defineProperty(t,"testimEnvironment",{enumerable:true,get:function(){return i.testimEnvironment}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.testimEnvironment=void 0;t.testimEnvironment={isProduction:true,appBaseUrl:true?"https://app.testim.io/":undefined}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(815),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Annotate=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(273);const a=s(81);const c=s(12);const l=s(0);const u=s(20);const d=s(11);const p=s(69);const h=s(99);const f=s(174);const m=s(71);const g=s(28);const v=s(16);const S=s(52);const y=s(287);const b=s(45);const _=s(115);const T=s(838);const E="Untitled Bug";const I={arrow:"icon",text:"icon",rectangle:"className"};const C=Object.entries(I);const D=o.memo((({currentColor:e,onColorSelected:t})=>{const s=(0,l.useCallback)((e=>()=>t(e)),[t]);return(0,i.jsx)("div",{className:r.default.colorPicker,children:Object.entries(T.ANNOTATE_COLORS).map((([t,o])=>(0,i.jsx)("div",{style:{backgroundColor:o},className:r.default.color,onClick:s(o),children:e===o&&(0,i.jsx)(v.Icon,{icon:"V"})},t)))})}));t.Annotate=(0,c.observer)((()=>{const e=(0,d.useDependencyInjector)(p.BugimDataStore);const t=(0,d.useDependencyInjector)(h.BugimOutput);const s=(0,d.useDependencyInjector)(f.BugimAnalytics);const o=(0,d.useDependencyInjector)(m.BugtrackerManager);const c=(0,d.useDependencyInjector)(g.ModalService);const{currentColor:I,currentMode:O,onReady:A,setCurrentColor:j,changeMode:w,setScreenshot:R,getDataUrl:P}=(0,T.useFabricJSEditor)();const[x,M]=(0,l.useState)(true);const N=(0,l.useMemo)((()=>{var t,s;const i=e.getLoginData();const o=i.authData?(t=i.authData.adminSettings)===null||t===void 0?void 0:t.isAdmin:(s=i.adminSettings)===null||s===void 0?void 0:s.isAdmin;const n=(0,_.isDemoProjectId)(e.getProjectId());return n&&!o}),[e]);const F=(0,l.useCallback)((()=>M(false)),[M]);const L=(0,l.useCallback)((()=>{s.endAnnotation();const i=P();e.setAnnotateImage(i);t.addAnnotateStep(i);t.saveTest(E);e.subscribe("test",(()=>window.location.hash="#/publish"))}),[s,e,t,P]);const k=(0,l.useCallback)((async()=>{var t;s.openSettings();const i=((t=o.currentBugtracker)===null||t===void 0?void 0:t.config)||{};const n=await c.openModal(y.BugtrackerSettingsModal,{currentBugtracker:i,projectId:e.getProjectId(),userDetails:e.getLoginData()}).promise;if(n){o.setCurrent(n.bt);L()}}),[s,c,e,o,L]);const B=(0,l.useCallback)((()=>o.currentBugtracker?L():k()),[o.currentBugtracker,L,k]);const U=(0,l.useCallback)((async()=>{const e=await c.openModal(b.MessageModal,{title:"DISCARD BUG",body:"Do you really want to delete this bug?",okText:"DISCARD",cancelText:"CANCEL",variety:"normal",icon:"trash-v4",className:a.default.deletionModal}).promise;if(e){s.discardTest();t.discardIssue()}}),[c,s,t]);const G=(0,l.useCallback)((e=>()=>w(e)),[w]);(0,u.useAsyncEffect)((e=>{setTimeout((()=>{if(e()){F()}}),1e4)}),[F]);(0,l.useEffect)((()=>{const t=e.getScreenshotImage();R(t.image)}),[e,R]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:(0,n.default)(r.default.banner,{[r.default.hide]:!x}),children:[(0,i.jsx)(v.Icon,{onClick:F,icon:"close"}),(0,i.jsx)("span",{className:r.default.bannerText,children:"Add annotations to describe what's wrong or just publish"})]}),(0,i.jsxs)("div",{className:r.default.annotate,children:[(0,i.jsxs)("div",{className:r.default.annotateMenu,children:[C.map((([e,t])=>(0,i.jsx)(S.Tooltip,{direction:"left",value:`Add ${e}`,children:(0,i.jsxs)("div",{onClick:G(e),className:(0,n.default)(r.default.menuItem,{[r.default.active]:O===e}),children:[t==="icon"&&(0,i.jsx)(v.Icon,{icon:e}),t==="className"&&(0,i.jsx)("i",{className:r.default[e]})]})},e))),(0,i.jsx)(S.Tooltip,{direction:"left",color:"white",className:r.default.colorPickerTooltip,value:(0,i.jsx)(D,{currentColor:I,onColorSelected:j}),children:(0,i.jsxs)("div",{className:(0,n.default)(r.default.menuItem,r.default.last),children:[(0,i.jsx)("i",{style:{backgroundColor:I},className:r.default.circle}),(0,i.jsx)("span",{className:r.default.colorTooltipHoverHelper})," "]})}),(0,i.jsx)(S.Tooltip,{direction:"left",value:"Discard",children:(0,i.jsx)("div",{onClick:U,className:(0,n.default)(r.default.menuItem,r.default.delete),children:(0,i.jsx)(v.Icon,{icon:"delete"})})})]}),!N&&(0,i.jsxs)("div",{className:r.default.fab,onClick:B,children:[(0,i.jsx)("div",{className:r.default.stepCounter,children:e.getStepCount()||1}),(0,i.jsxs)("div",{className:r.default.fabContent,children:[(0,i.jsx)(v.Icon,{icon:"bugim",className:r.default.fabIcon}),(0,i.jsx)("div",{className:r.default.text,children:"Publish"})]})]})]}),(0,i.jsx)(T.FabricJSCanvas,{className:r.default.canvasContainer,onReady:A})]})}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GitHubBugtracker=void 0;const i=s(6);const o=s(275);const n=s(817);const r=s(7);const a=s(276);const c=s(42);const l=s(20);const u=r.Logger.getLogger("github-bugtracker");const d="https://services.testim.io";class p{constructor(e,t,s){this.config=e;this.bugimDataStore=s;this.logo=o.default;this.form=n.GithubForm;this.loginUrl=p.loginUrl}async isAuth(){try{const e=`${d}/integration/github/check?projectId=${this.bugimDataStore.getProjectId()}`;await c.httpRequest.get(e);u.log("github-auth",{url:e})}catch(e){u.error("github-auth",{err:e});const t=new Error;t.data=e;throw t}}async performLogin(){try{const e=await(0,l.openPopupAndWait)(this.loginUrl);if(e.installation_id){const t=`${d}/integration/github/install`;await c.httpRequest.putJson(t,{projectId:this.bugimDataStore.getProjectId(),installationId:e.installation_id})}}catch(e){u.error("Error while logging in to github",e)}}async getRepos(){try{const e=`${d}/integration/github/repos?projectId=${this.bugimDataStore.getProjectId()}`;const t=await c.httpRequest.get(e);u.log("github-repos",{url:e});return i.chain(t).castArray().filter("has_issues").value()}catch(e){u.error("github-repos",{err:e});const t=new Error;t.data=e;throw t}}createIssue(...e){return new a.GitHubIssue(...e)}getImagesFormat(e,t){const s=e?`- baseline\n![baseline](${e})\n`:"";const i=t?`- result\n![result](${t})\n`:"";return`\n${s}${i}`}getAnnotateImageFormat(e=""){return`\n- annotate\n![annotate](${e})\n`}getVideoAnnotate(e=""){return`\n![Link to video](${e})\n`}async publish(e){const t=Object.assign(e.toDTO(),{projectId:this.bugimDataStore.getProjectId()});try{const e=`${d}/integration/github/send`;const s=await c.httpRequest.postJson(e,t);u.log("github-publish",{payload:t,projectId:t.projectId});return{res:s,issueUrl:s.html_url}}catch(e){u.error("github-publish",{err:e});const s=new Error;s.errorDescription=(e===null||e===void 0?void 0:e.data)||(e===null||e===void 0?void 0:e.message)||e||"";s.payload=t;throw s}}}t.GitHubBugtracker=p;p.loginUrl="https://github.com/apps/testim-io"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GithubForm=void 0;const i=s(4);const o=s(0);const n=s(108);const r=s(0);const a=s(12);const c=s(11);const l=s(71);const u=s(20);const d=s(40);const p=s(8);const h=s(32);const f="An error occurred when contacting GitHub, please check your settings and try again";t.GithubForm=(0,a.observer)((({issue:e,openLoginToTracker:t,onError:s})=>{const o=(0,c.useDependencyInjector)(l.BugtrackerManager);const[a,m]=(0,r.useState)([]);const g=(0,r.useMemo)((()=>o.currentBugtracker),[o.currentBugtracker]);const v=(0,r.useCallback)((({value:t})=>{e.repo=t;e.model.selectedRepo=t}),[e]);const S=(0,r.useCallback)((t=>e.summary=t.target.value),[e]);const y=(0,r.useCallback)((t=>e.description=t.target.value),[e]);const b=(0,r.useCallback)((async()=>await p.utils.copyToClipboard(e.description)),[e.description]);(0,u.useAsyncEffect)((async i=>{try{const t=await g.getRepos();if(i()){e.repos=t;m(t.map((e=>({name:e.fullName,value:e}))))}}catch(e){if(!i()){return}if(e.data==="invalid token"||e==="invalid token"){t()}else{s(f)}}}),[e.explicitUpdate]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:n.default.issueField,children:[(0,i.jsxs)("div",{className:n.default.fieldName,children:["Repository (",a.length,")*"]}),(0,i.jsx)(d.Dropdown,{value:e.model.selectedRepo&&{name:e.model.selectedRepo.fullName,value:e.model.selectedRepo},onChange:v,className:n.default.fieldInput,placeholder:`Select Repository (${a.length})`,options:a,searchable:true})]}),(0,i.jsx)("div",{className:"line-separator"}),(0,i.jsxs)("div",{className:n.default.issueField,children:[(0,i.jsx)("div",{className:n.default.fieldName,children:"Summary*"}),(0,i.jsx)(h.Textbox,{className:n.default.fieldInput,type:"text",value:e.summary,onChange:S,name:"iSummary",placeholder:"Bug summary*",title:"Bug summary",autoFocus:true})]}),(0,i.jsxs)("div",{className:n.default.issueField,children:[(0,i.jsx)("div",{className:n.default.fieldName,children:"Description*"}),(0,i.jsx)("textarea",{className:n.default.fieldInput,value:e.description,onChange:y,name:"iDescription",style:{resize:"none",height:"215px"}})]}),(0,i.jsx)("div",{className:n.default.blueRight,onClick:b,children:"Copy to clipboard"})]})}))},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(819),t);o(s(280),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JiraBugtracker=void 0;const i=s(6);const o=s(277);const n=s(820);const r=s(88);const a=s(135);const c=s(7);const l=s(280);const u=c.Logger.getLogger("jira-bugtracker");const d="rest/auth/1/session";const p="rest/api/2/";class h{constructor(e){this.config=e;this.httpService=r.UIContainer.get(a.HttpForJiraService);this.logo=o.default;this.form=n.JiraForm;this.isAuth=i.debounce((async()=>{var e,t;const s=this.serverAddress+d;try{const e=await this.httpService.get(s);u.log("jira-auth",i.omit(e,"data"));return e}catch(o){const n=i.omit(o,"data");n.message=o.message;n.stack=o.stack;n.data=((t=(e=o.data)===null||e===void 0?void 0:e.errorMessages)===null||t===void 0?void 0:t[0])||o.message;u.error("jira-auth",{saneError:n});console.log(`jira-auth-string${JSON.stringify({err:n,url:s})}`);throw n}}),150);this.serverAddress=e.url;this._issues={}}set serverAddress(e){e=!e.startsWith("http")?`https://${e}`:e;e+=e.endsWith("/")?"":"/";try{const t=new URL(e);t.protocol="https:";this._address=t.toString()}catch{this._address=e}}get serverAddress(){return this._address}async getFields(e,t){var s,o;try{const n=await this.httpService.get(`${this.serverAddress}${p}issue/createmeta?projectIds=${e}&issuetypeIds=${t}&expand=projects.issuetypes.fields`);u.log("jira-get-fields",i.omit(n,"data"));if((s=n===null||n===void 0?void 0:n.data)===null||s===void 0?void 0:s.projects){const s=n.data.projects.find((({id:t})=>t===e));const i=(o=s===null||s===void 0?void 0:s.issuetypes)===null||o===void 0?void 0:o.find((({id:e})=>e===t));if(!i){return undefined}return Object.fromEntries(Object.entries(i.fields).filter((([,e])=>e.schema.custom!=="com.pyxis.greenhopper.jira:gh-lexo-rank")))}return undefined}catch(e){u.error("jira-get-fields",i.omit(e,"data"));throw e}}async getProjects(){try{const e=await this.httpService.get(`${this.serverAddress}${p}issue/createmeta`);u.log("jira-get-projects",i.omit(e,"data"));return e.data}catch(e){u.error("jira-get-projects",i.omit(e,"data"));throw e}}async publish(e,t){var s,o,n;const r=e.toDTO();try{const s=await this.httpService.postJson(`${this.serverAddress}${p}issue`,r);u.log("jira-publish",i.omit(s,"data"));const o=s.data;const n=`${this.serverAddress+p}issue/${o.id}/attachments`;o.issueUrl=`${this.serverAddress}browse/${o.key}`;this._issues[o.id]=o;try{if(e.annotatedImageBase64){t(n,e.annotatedImageBase64.split(",")[1],"screenshot.png","image/png",{"X-Atlassian-Token":"no-check"})}}catch(t){u.error("jira-image-upload",n,e.toDTO(),i.omit(o,"data"));return o}return o}catch(t){let i="";const a=((s=t===null||t===void 0?void 0:t.data)===null||s===void 0?void 0:s.errors)||((o=t===null||t===void 0?void 0:t.response)===null||o===void 0?void 0:o.errors);if(a){i=Object.entries(a).map((([e,t])=>`${e} - ${t}`)).join(", ")}else if((n=t===null||t===void 0?void 0:t.response)===null||n===void 0?void 0:n.errorMessages){i+=t.response.errorMessages.join("; ")}const c=Object.assign(new Error("jira bugTracker publish error"),{errorDescription:i,payload:r,fields:e.fields});u.error("jira-publish",{error:c});console.error(`jira-publish: ${JSON.stringify({error:c})}`);throw c}}getImagesFormat(e,t){const s=!!e;const i=!!t;let o="||";let n="|";if(s){o+="baseline||";n+=`!${e}|width=100%!|`}if(i){o+="result||";n+=`!${t}|width=100%!|`}return[o,n].join("\n")}getAnnotateImageFormat(e=""){return`||annotate||\n|!${e}|width=100%!|`}getVideoAnnotate(e=""){return`\n[Link to video|${e}]\n`}createIssue(...e){return new l.JiraIssue(...e)}init(){return Promise.all([this.getProjects(),this.isAuth()])}performLogin(){throw new Error("not implemented")}}t.JiraBugtracker=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JiraForm=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(175);const a=s(108);const c=s(12);const l=s(11);const u=s(821);const d=s(71);const p=s(40);const h=s(278);const f=s(32);const m=s(37);const g=o.memo((({item:e})=>(0,i.jsxs)("div",{className:r.default.jiraSelectChoice,children:[e.value.avatarUrls&&(0,i.jsx)("img",{src:e.value.avatarUrls["32x32"]}),e.value.iconUrl&&(0,i.jsx)("img",{src:e.value.iconUrl}),e.name]})));g.displayName="ItemRow";t.JiraForm=(0,c.observer)((({issue:e,openLoginToTracker:t,onError:s})=>{var c;const v=(0,l.useDependencyInjector)(d.BugtrackerManager);const S=(0,l.useLocalStoreWithInjectedDependencies)(u.JiraFormLocalStore);o.useEffect((()=>S.init(e,v,t,s)),[S,e,v,t,s]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:(0,n.default)(r.default.jiraField,a.default.issueField),children:[(0,i.jsx)("div",{className:a.default.fieldName,children:"Project*"}),(0,i.jsx)(p.Dropdown,{appendToBody:true,value:e.model.project&&{name:e.model.project.name,value:e.model.project},onChange:S.onProjectSelected,className:a.default.fieldInput,placeholder:"Select Project",options:S.projects,renderItem:g,SelectedItemRenderComponent:g,searchable:true})]}),(0,i.jsxs)("div",{className:(0,n.default)(r.default.jiraField,a.default.issueField),children:[(0,i.jsx)("div",{className:a.default.fieldName,children:"Type*"}),(0,i.jsx)(p.Dropdown,{appendToBody:true,value:e.model.issuetype&&{name:e.model.issuetype.name,value:e.model.issuetype},onChange:S.onTypeSelected,className:a.default.fieldInput,placeholder:"Select Type",options:S.issueTypes,searchable:true})]}),(0,i.jsx)("div",{className:a.default.lineSeparator}),(0,i.jsxs)("div",{className:(0,n.default)(r.default.jiraField,a.default.issueField),children:[(0,i.jsx)("div",{className:a.default.fieldName,children:"Summary*"}),(0,i.jsx)(f.Textbox,{className:a.default.fieldInput,value:e.summary,onChange:S.onSummaryChange,placeholder:"Bug Summary*",title:"Bug summary",autoFocus:true})]}),S.descriptionField&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.JiraField,{field:S.descriptionField,issue:e,serverAddress:S.serverAddress}),(0,i.jsx)("div",{className:a.default.blueRight,onClick:S.copyDescriptionToClipboard,children:"Copy to clipboard"})]}),(0,i.jsxs)("div",{className:(0,n.default)(r.default.dynamicFields,{[r.default.isLoading]:S.fields.state==="pending"}),children:[S.fields.state==="pending"&&(0,i.jsx)(m.Loader,{}),(c=S.dynamicFields)===null||c===void 0?void 0:c.map((t=>(0,i.jsx)(h.JiraField,{field:t,issue:e,serverAddress:S.serverAddress},t.key)))]})]})}));t.JiraForm.displayName="JiraForm"},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n,r;Object.defineProperty(t,"__esModule",{value:true});t.JiraFormLocalStore=void 0;const a=s(6);const c=s(9);const l=s(2);const u=s(27);const d=s(278);const p=s(8);const h=s(7);const f=s(69);const m="An error occurred when contacting Jira, please check your settings and try again";const g=h.Logger.getLogger("jiraFormLocalStore");const v=["summary","project","issuetype","description","attachment"];let S=class e{constructor(e){this.bugimDataStore=e;this.projects=[];this.disposers=[(0,l.reaction)((()=>{var e;return(e=this._issue)===null||e===void 0?void 0:e.model.project}),(e=>{if(!e){this._issue.model={};this._issue.fields=[];return}const t=this.findPreviouslySelected(e.issuetypes,"issuetype",this._issue)||this.lastIssue&&this.findPreviouslySelected(e.issuetypes,"issuetype")||e.issuetypes.find((({name:e})=>e==="Bug"))||e.issuetypes[0];this._issue.model.issuetype=a.cloneDeep(t)}),{name:"setDefaultIssueOnProjectChange"}),(0,l.reaction)((()=>this.descriptionKey),(e=>{if(!this._issue||!e){return}this._issue.model[e]=this._issue.description}),{name:"setDescriptionOnDescriptionKeyChange"}),(0,l.reaction)((()=>this.fields.value),(()=>{if(this.fields.state!=="fulfilled"||!this._issue){return}this._issue.fields=this.fields.value;a.toPairsIn(this._issue._savedModel).filter((([e])=>e!=="issuetype"&&e!=="project")).forEach((([e,t])=>this._issue.model[e]=t))}),{name:"setFieldsWithDefaultValuesOnFieldsChange"})]}dispose(){this.disposers.forEach((e=>e()))}async copyDescriptionToClipboard(){await p.utils.copyToClipboard(this._issue.model[this.descriptionKey])}init(e,t,s,i){this._issue=e;this.bugtrackerManager=t;this.openLoginToTracker=s;this.onError=i;this.loadProjects();return()=>{this._issue=undefined;this.bugtrackerManager=undefined;this.openLoginToTracker=undefined;this.onError=undefined}}onProjectSelected({value:e}){e.issuetypes=e.issuetypes.filter((({subtask:e})=>!e));this._issue.model.project=e}onTypeSelected({value:e}){var t;if(!((t=this._issue)===null||t===void 0?void 0:t.model)||!e){return}this._issue.model.issuetype=e}onSummaryChange(e){this._issue.summary=e.target.value}async loadProjects(){var e,t;try{const[e]=await this.bugtracker.init();(0,l.runInAction)((()=>{this.projects=e.projects.map((e=>({name:e.name,value:e})));const t=this.findPreviouslySelected(e.projects,"project",this._issue)||this.findPreviouslySelected(e.projects,"project")||e.projects[0];if(this._issue){t.issuetypes=t.issuetypes.filter((({subtask:e})=>!e));this._issue.model.project=t}}))}catch(s){g.error("bugtracker init error",a.omit(s,"data"));if(s.status===401){(e=this.openLoginToTracker)===null||e===void 0?void 0:e.call(this)}else{(t=this.onError)===null||t===void 0?void 0:t.call(this,m)}}}findPreviouslySelected(e,t,s=this.lastIssue){var i;return((i=s===null||s===void 0?void 0:s.model)===null||i===void 0?void 0:i[t])&&(e===null||e===void 0?void 0:e.find((({id:e})=>e===s.model[t].id)))}async loadAndPareFields(){var e;const{project:t,issuetype:s}=((e=this._issue)===null||e===void 0?void 0:e.model)||{};if(!t||!s){return undefined}try{const e=await this.bugtracker.getFields(t.id,s.id);g.log("jira-received-fields",e);if(!e){return undefined}Object.entries(e).forEach((([e,t])=>t.key||(t.key=e)));return e}catch(e){g.warn("jira get fields failed",a.omit(e,"data"));return undefined}}get dynamicFields(){if(this.fields.state!=="fulfilled"){return undefined}return a.filter(this.fields.value,(e=>!a.includes(v,e.key)&&(Boolean(this.descriptionKey)&&this.descriptionKey!==e.key)))}get issueTypes(){var e,t,s;return((s=(t=(e=this._issue)===null||e===void 0?void 0:e.model.project)===null||t===void 0?void 0:t.issuetypes)===null||s===void 0?void 0:s.map((e=>({name:e.name,value:e}))))||[]}get fields(){return(0,u.fromPromise)(this.loadAndPareFields())}get descriptionKey(){if(this.fields.state!=="fulfilled"||!this.fields.value){return undefined}const e=this.fields.value.description||a.find(this.fields.value,{schema:{type:"string",custom:d.JIRA_FIELD_NAMES.textarea}})||a.find(this.fields.value,{schema:{type:"string"}});return e===null||e===void 0?void 0:e.key}get descriptionField(){var e;if(this.fields.state!=="fulfilled"||!this.descriptionKey){return undefined}return(e=this.fields.value)===null||e===void 0?void 0:e[this.descriptionKey]}get serverAddress(){return this.bugtracker.serverAddress}get bugtracker(){var e;return((e=this.bugtrackerManager)===null||e===void 0?void 0:e.currentBugtracker)||{}}get lastIssue(){return this.bugimDataStore.getLastIssue()}};t.JiraFormLocalStore=S;i([l.observable,o("design:type",Array)],S.prototype,"projects",void 0);i([l.observable.ref,o("design:type",Object)],S.prototype,"_issue",void 0);i([l.action,o("design:type",Function),o("design:paramtypes",[Object,Object,typeof(r=typeof VoidFunction!=="undefined"&&VoidFunction)==="function"?r:Object,Function]),o("design:returntype",void 0)],S.prototype,"init",null);i([l.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],S.prototype,"onProjectSelected",null);i([l.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],S.prototype,"onTypeSelected",null);i([l.action.bound,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],S.prototype,"onSummaryChange",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"dynamicFields",null);i([l.computed,o("design:type",Array),o("design:paramtypes",[])],S.prototype,"issueTypes",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"fields",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"descriptionKey",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"descriptionField",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"serverAddress",null);i([l.computed,o("design:type",Object),o("design:paramtypes",[])],S.prototype,"bugtracker",null);t.JiraFormLocalStore=S=i([(0,c.injectable)(),o("design:paramtypes",[typeof(n=typeof f.BugimDataStore!=="undefined"&&f.BugimDataStore)==="function"?n:Object])],S)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JiraField=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(10);const a=s(175);const c=s(108);const l=s(0);const u=s(12);const d=s(11);const p=s(135);const h=s(279);const f=s(40);const m=s(823);const g=s(824);const v=s(121);const S=s(32);const y=n.memo((({item:e})=>{var t,s,o,n;return(0,i.jsxs)("div",{className:a.default.jiraSelectChoice,children:[((t=e.value)===null||t===void 0?void 0:t.iconUrl)&&(0,i.jsx)("img",{src:e.value.iconUrl}),e.name,((s=e.value)===null||s===void 0?void 0:s.key)&&(0,i.jsxs)("span",{children:[" (",e.value.key,")"]}),((o=e.value)===null||o===void 0?void 0:o.value)&&((n=e.value)===null||n===void 0?void 0:n.value)!==e.name&&(0,i.jsx)("span",{children:e.value.value})]})}));y.displayName="SelectRow";t.JiraField=(0,u.observer)((({serverAddress:e,field:t,issue:s})=>{var n,u,b;const _=(0,d.useDependencyInjector)(p.HttpForJiraService);const[T,E]=(0,l.useState)([]);const I=(0,l.useMemo)((()=>(0,h.getFieldType)(t)),[t]);const C=(0,l.useMemo)((()=>{var e;const i=(e=s.model)===null||e===void 0?void 0:e[t.key];if(!i){return undefined}return{name:o.isString(i)?i:(i===null||i===void 0?void 0:i.name)||(i===null||i===void 0?void 0:i.displayName),value:i}}),[s.model[t.key],t.key]);const D=(0,l.useCallback)((async s=>{let i=async()=>[];if(t.schema.custom===h.JIRA_FIELD_NAMES.sprint){i=(0,h.getJiraSprintDataGetter)(e,_)}if(t.schema.custom===h.JIRA_FIELD_NAMES.epic){i=(0,h.getJiraEpicDataGetter)(e,_)}const o=s.target.value||"";const n=await i(o);E(n.map((e=>({name:e.name,value:e}))))}),[t,e,_]);const O=(0,l.useCallback)((e=>s.model[t.key]=e),[t,s]);const A=(0,l.useCallback)((e=>O(e.target.value)),[O]);(0,l.useEffect)((()=>{if(!t.allowedValues){return}const e=t.allowedValues.map((e=>({name:e.name||e.value,value:e.value||e.id||e.name,extraText:e.name?e.value:undefined})));E(e)}),[t]);return(0,i.jsxs)("div",{className:(0,r.default)(a.default.jiraField,c.default.issueField),children:[(0,i.jsxs)("div",{className:c.default.fieldName,children:[t.name,t.required?"*":""]}),(0,i.jsxs)("div",{className:c.default.fieldInput,children:[I==="none"&&(0,i.jsx)("div",{className:a.default.jiraNone,children:"None"}),["user","multi-select-user"].includes(I)&&(0,i.jsx)(m.JiraUser,{field:t,model:s.model,multiple:I==="multi-select-user"}),I==="select"&&(0,i.jsx)(f.Dropdown,{appendToBody:true,value:C,onChange:O,options:T,inputProps:{onChange:D},renderItem:y,SelectedItemRenderComponent:y}),I==="multi-select"&&(0,i.jsx)(v.TagsInput,{appendToBody:true,tags:(n=s.model)===null||n===void 0?void 0:n[t.key],suggestions:T,searchCaseInsensitive:true,onTagsChange:O}),I==="labels"&&(0,i.jsx)(g.JiraLabel,{field:t,model:s.model}),I==="multiline"&&(0,i.jsx)("textarea",{value:(u=s.model)===null||u===void 0?void 0:u[t.key],onChange:A,name:t.key}),I===""&&(0,i.jsx)(S.Textbox,{value:(b=s.model)===null||b===void 0?void 0:b[t.key],onChange:A,name:t.key})]})]})}));t.JiraField.displayName="JiraField"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JiraUser=void 0;const i=s(4);const o=s(0);const n=s(175);const r=s(0);const a=s(12);const c=s(40);const l=s(11);const u=s(135);const d=s(7);const p=s(121);const h=d.Logger.getLogger("jira-user-field");const f=o.memo((({item:e})=>(0,i.jsxs)("div",{className:n.default.jiraSelectChoice,children:[e.value.avatarUrls&&(0,i.jsx)("img",{src:e.value.avatarUrls["32x32"]}),e.name]})));f.displayName="UserRow";t.JiraUser=(0,a.observer)((({multiple:e,field:t,model:s})=>{const o=(0,l.useDependencyInjector)(u.HttpForJiraService);const[n,a]=(0,r.useState)([]);const d=(0,r.useMemo)((()=>{var e;const s=((e=t.autoCompleteUrl)===null||e===void 0?void 0:e.replace("/null",""))||"";return s.substr(0,s.indexOf("/rest/api/"))}),[t]);const m=(0,r.useCallback)((async(e="%")=>{if(!d){return[]}if(e===""){e="%"}const t=`${d}/rest/api/latest/user/search?query=${encodeURIComponent(e)}`;const s=`${d}/rest/api/latest/user/search?username=${encodeURIComponent(e)}`;try{const e=await o.get(t).catch((()=>o.get(s)));const i=e.map((e=>({name:e.displayName,value:e})));a(i);return i}catch(e){h.warn("Jira field multi-select user request failed:",{url:t,err:e.message,stack:e.stack});return[]}}),[d,o,a]);const g=(0,r.useCallback)((e=>s[t.key]=e.value),[s,t]);const v=(0,r.useCallback)((e=>s[t.key]=e),[s,t]);if(!e){return(0,i.jsx)(c.Dropdown,{appendToBody:true,value:(s===null||s===void 0?void 0:s[t.key])&&{name:s===null||s===void 0?void 0:s[t.key].displayName,value:s===null||s===void 0?void 0:s[t.key]},onChange:g,options:m,renderItem:f,SelectedItemRenderComponent:f})}return(0,i.jsx)(p.TagsInput,{appendToBody:true,tags:s===null||s===void 0?void 0:s[t.key],suggestions:n,onTagsChange:v,onInputChanged:m})}));t.JiraUser.displayName="JiraUser"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JiraLabel=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(0);const a=s(12);const c=s(11);const l=s(135);const u=s(7);const d=s(121);const p=u.Logger.getLogger("jira-label");t.JiraLabel=(0,a.observer)((({field:e,model:t})=>{const s=(0,c.useDependencyInjector)(l.HttpForJiraService);const[n,a]=(0,r.useState)([]);const u=(0,r.useCallback)((async(t="")=>{var i;const n=((i=e.autoCompleteUrl)===null||i===void 0?void 0:i.replace("/null",""))||"";if(!n){return}try{const e=await s.getJson(`${n}${encodeURIComponent(t)}`)||{};if(!e.suggestions){e.suggestions=[]}if(e.suggestions.every((({label:e})=>e!==t))){e.suggestions.push({label:t,isNew:true})}const i=o.chain(e.suggestions).uniqBy("label").map((e=>({name:e.label,value:e.label,extraText:e.isNew?"Create new label:":"",extraTextPrepended:true}))).value();a(i||[])}catch(e){p.warn("Jira label getting suggestions failed:",{url:n,searchItem:t,err:e})}}),[e,s]);const h=(0,r.useCallback)((s=>t[e.key]=s),[t,e]);(0,r.useEffect)((()=>{u()}),[]);return(0,i.jsx)(d.TagsInput,{appendToBody:true,tags:t===null||t===void 0?void 0:t[e.key],suggestions:n,onInputChanged:u,onTagsChange:h})}));t.JiraLabel.displayName="JiraLabel"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SlackBugtracker=void 0;const i=s(282);const o=s(826);const n=s(283);const r=s(42);const a="https://services.testim.io";class c{constructor(e,t,s,n){this.config=e;this.bugimDataStore=s;this.featureFlagsService=n;this.loginUrl=c.getLoginUrl(this.featureFlagsService.flags.slackClientId.getValue());this.logo=i.default;this.form=o.SlackForm}static getLoginUrl(e="5076786919.191811168726"){return`https://slack.com/oauth/v2/authorize?client_id=${e}&scope=incoming-webhook`}async isAuth(){try{return await r.httpRequest.get(`${a}/integration/slack/check?projectId=${this.bugimDataStore.getProjectId()}`)}catch(e){const t=new Error;t.data=e;throw t}}async getChannel(){return await r.httpRequest.get(`${a}/integration/slack/channel?projectId=${this.bugimDataStore.getProjectId()}`)}createIssue(...e){return new n.SlackIssue(...e)}getImagesFormat(){return""}getAnnotateImageFormat(){return""}getVideoAnnotate(e=""){return`\n![Link to video](${e})\n`}async publish(e){const t=e.toDTO();t.projectId=this.bugimDataStore.getProjectId();try{await r.httpRequest.postJson(`${a}/integration/slack/send`,t);return{issueUrl:null}}catch(e){const s=new Error;s.errorDescription=(e===null||e===void 0?void 0:e.data)||(e===null||e===void 0?void 0:e.message)||e||"";s.payload=t;throw s}}performLogin(){throw new Error("not implemented")}}t.SlackBugtracker=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SlackForm=void 0;const i=s(4);const o=s(0);const n=s(108);const r=s(0);const a=s(12);const c=s(11);const l=s(71);const u=s(20);const d=s(8);const p=s(32);const h="An error occurred when contacting Slack, please check your settings and try again";t.SlackForm=(0,a.observer)((({issue:e,openLoginToTracker:t,onError:s})=>{const o=(0,c.useDependencyInjector)(l.BugtrackerManager);const a=(0,r.useMemo)((()=>o.currentBugtracker),[o.currentBugtracker]);const f=(0,r.useCallback)((t=>e.summary=t.target.value),[e]);const m=(0,r.useCallback)((t=>e.description=t.target.value),[e]);const g=(0,r.useCallback)((async()=>await d.utils.copyToClipboard(e.description)),[e.description]);(0,u.useAsyncEffect)((async i=>{try{const t=await a.getChannel();if(i()){e.channel=t}}catch(e){if(!i()){return}if(e.data==="invalid token"||e==="invalid token"){t()}else{s(h)}}}),[e.explicitUpdate]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:n.default.issueField,children:[(0,i.jsx)("div",{className:n.default.fieldName,children:"Post to:"}),(0,i.jsx)("div",{className:n.default.fieldValue,children:e.channel})]}),(0,i.jsx)("div",{className:n.default.lineSeparator}),(0,i.jsxs)("div",{className:n.default.issueField,children:[(0,i.jsx)("div",{className:n.default.fieldName,children:"Summary*"}),(0,i.jsx)(p.Textbox,{className:n.default.fieldInput,type:"text",value:e.summary,onChange:f,placeholder:"Bug summary*",title:"Bug summary",autoFocus:true})]}),(0,i.jsxs)("div",{className:n.default.issueField,children:[(0,i.jsx)("div",{className:n.default.fieldName,children:"Description*"}),(0,i.jsx)("textarea",{className:n.default.fieldInput,value:e.description,onChange:m,style:{resize:"none",height:"215px"}})]}),(0,i.jsx)("div",{className:n.default.blueRight,onClick:g,children:"Copy to clipboard"})]})}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TrelloBugtracker=void 0;const i=s(285);const o=s(5);const n=s(286);const r=s(828);const a=s(7);const c=s(42);const l=s(20);const u="https://api.trello.com/1/";const d="ecbd02db7dc2c315741fd20c3e4506f8";const p=(e,t)=>`${u}${e}?key=${d}&token=${t}`;const h=a.Logger.getLogger("trelloBugtracker");class f{constructor(e,t){this.config=e;this.hostService=t;this.loginUrl=f.loginUrl;this.logo=i.default;this.form=r.TrelloForm}async performLogin(){const e=(0,l.openNewPopupWindow)(f.loginUrl,500,600);const t=async s=>{if(s.origin==="https://trello.com"){window.localStorage.setItem(o.commonConstants.integrations.trelloStorageKey,s.data);h.log("Trello token was token was stores on the browser's local storage");try{await this.hostService.sendBG(o.commonConstants.localStorage.SAVE,{[o.commonConstants.integrations.trelloStorageKey]:s.data})}catch(e){h.error("Error while storing in extension",e)}e===null||e===void 0?void 0:e.close();window.removeEventListener("message",t)}};window.addEventListener("message",t)}async getToken(){const e=await this.hostService.sendBG(o.commonConstants.localStorage.GET,"trelloToken");return e||"NO_TOKEN"}async isAuth(){try{const e=await this.getToken();await c.httpRequest.get(p("member/me/boards",e))}catch(e){const t=new Error;t.data=e;throw t}}async getBoards(){const e=await this.getToken();const t=await c.httpRequest.get(p("member/me/boards",e));return t}async getLists(e){const t=await this.getToken();const s=await c.httpRequest.get(p(`boards/${e}/lists`,t));return s}createIssue(...e){return new n.TrelloIssue(...e)}getImagesFormat(e,t){const s=e?`- baseline\n![baseline](${e})\n`:"";const i=t?`- result\n![result](${t})\n`:"";return`\n${s}${i}`}getAnnotateImageFormat(e=""){return`\n- annotate\n![annotate](${e})\n`}getVideoAnnotate(e=""){return`\n[Link to video|${e}]\n`}async publish(e){const t=e.toDTO();try{const e=await this.getToken();const s=await c.httpRequest.postJson(p("cards",e),t);return{...s,issueUrl:s.url}}catch(e){const s=new Error;s.errorDescription=(e===null||e===void 0?void 0:e.data)||(e===null||e===void 0?void 0:e.message)||e||"";s.payload=t;throw e}}}t.TrelloBugtracker=f;f.loginUrl=`https://trello.com/1/authorize?response_type=token&key=${d}&return_url=${window.location.origin}&callback_method=postMessage&scope=read%2Cwrite&expiration=never&name=Testim.io`},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TrelloForm=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(108);const a=s(0);const c=s(12);const l=s(11);const u=s(71);const d=s(20);const p=s(40);const h=s(8);const f=s(32);const m="An error occurred when contacting Trello, please check your settings and try again";t.TrelloForm=(0,c.observer)((({issue:e,openLoginToTracker:t,onError:s})=>{const n=(0,l.useDependencyInjector)(u.BugtrackerManager);const[c,g]=(0,a.useState)([]);const[v,S]=(0,a.useState)([]);const y=(0,a.useMemo)((()=>n.currentBugtracker),[n.currentBugtracker]);const b=(0,a.useCallback)(((t,s)=>t.find((t=>{var i,o;return((i=e._savedModel)===null||i===void 0?void 0:i[s])&&t.id===((o=e._savedModel)===null||o===void 0?void 0:o[s].id)}))),[e._savedModel]);const _=(0,a.useCallback)((t=>{e.model.selectedList=t===null||t===void 0?void 0:t.value;e.listId=(t===null||t===void 0?void 0:t.value.id)||""}),[e]);const T=(0,a.useCallback)((async e=>{try{const t=await y.getLists(e);const s=t.map((e=>({name:e.name,value:e})));S(s);const i=b(t,"selectedList");if(i){_({name:i.name,value:i})}}catch(e){s(m)}}),[y,S,b,_,s]);const E=(0,a.useCallback)((({value:t})=>{_(null);e.model.selectedBoard=t;T(t.id)}),[e,_,T]);const I=(0,a.useCallback)((t=>e.summary=t.target.value),[e]);const C=(0,a.useCallback)((t=>e.description=t.target.value),[e]);const D=(0,a.useCallback)((async()=>await h.utils.copyToClipboard(e.description)),[e.description]);(0,d.useAsyncEffect)((async e=>{try{const t=await y.getBoards();if(e()){const e=o.chain(t).filter((e=>!e.closed)).map((e=>({name:e.name,value:e}))).value();g(e);const s=b(t,"selectedBoard");if(s){E({name:s.name,value:s})}}}catch(i){if(!e()){return}if(i.data==="invalid token"||i==="invalid token"){t()}else{s(m)}}}),[e.explicitUpdate]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:r.default.issueField,children:[(0,i.jsxs)("div",{className:r.default.fieldName,children:["Board (",c.length,")*"]}),(0,i.jsx)(p.Dropdown,{value:e.model.selectedBoard&&{name:e.model.selectedBoard.name,value:e.model.selectedBoard},onChange:E,className:r.default.fieldInput,placeholder:`Select Board (${c.length})`,options:c,searchable:true})]}),(0,i.jsxs)("div",{className:r.default.issueField,children:[(0,i.jsxs)("div",{className:r.default.fieldName,children:["List (",v.length,")*"]}),(0,i.jsx)(p.Dropdown,{value:e.model.selectedList&&{name:e.model.selectedList.name,value:e.model.selectedList},onChange:_,className:r.default.fieldInput,placeholder:`Select List (${v.length})`,options:v,searchable:true})]}),(0,i.jsx)("div",{className:r.default.lineSeparator}),(0,i.jsxs)("div",{className:r.default.issueField,children:[(0,i.jsx)("div",{className:r.default.fieldName,children:"Summary*"}),(0,i.jsx)(f.Textbox,{className:r.default.fieldInput,type:"text",value:e.summary,onChange:I,placeholder:"Bug summary*",title:"Bug summary",autoFocus:true})]}),(0,i.jsxs)("div",{className:r.default.issueField,children:[(0,i.jsx)("div",{className:r.default.fieldName,children:"Description*"}),(0,i.jsx)("textarea",{className:r.default.fieldInput,value:e.description,onChange:C,style:{resize:"none",height:"215px"}})]}),(0,i.jsx)("div",{className:r.default.blueRight,onClick:D,children:"Copy to clipboard"})]})}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BugtrackerSettingsModal=void 0;const i=s(4);const o=s(0);const n=s(830);const r=s(30);const a=s(831);const c=({closeModal:e,...t})=>(0,i.jsx)(r.BaseModal,{closeModal:e,header:(0,i.jsx)("h3",{children:"Settings"}),containerClassName:n.default.container,className:n.default.modal,bodyClassName:n.default.body,children:(0,i.jsx)(a.Settings,{...t,onDone:e})});t.BugtrackerSettingsModal=c},function(e,t,s){"use strict";s.r(t);t["default"]={container:"BugtrackerSettingsModal_container_3nYTj_V0dGluZ3Mt",modal:"BugtrackerSettingsModal_modal_3VLsM_V0dGluZ3Mt",body:"BugtrackerSettingsModal_body_1jpVh_V0dGluZ3Mt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(832),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Settings=void 0;const i=s(4);const o=s(6);const n=s(0);const r=s(10);const a=s(833);const c=s(277);const l=s(285);const u=s(282);const d=s(275);const p=s(0);const h=s(12);const f=s(16);const m=s(31);const g=s(32);const v=s(11);const S=s(71);const y=s(14);const b=s(69);const _=s(174);const T=s(834);const E=s(284);const I=s(281);const C=s(274);const D=s(22);const O=s(62);const A={Jira:c.default,Trello:l.default,Slack:u.default,GitHub:d.default};t.Settings=(0,h.observer)((({projectId:e,userDetails:t,currentBugtracker:s,initialBugtracker:n,doneButtonText:c,hideFooterSeparator:l,onDone:u})=>{const d=(0,v.useDependencyInjector)(S.BugtrackerManager);const h=(0,v.useDependencyInjector)(y.FeatureFlagsService);const j=(0,v.useDependencyInjector)(b.BugimDataStore);const w=(0,v.useDependencyInjector)(_.BugimAnalytics);const R=(0,v.useDependencyInjector)(D.TestimServicesApi);const P=(0,v.useDependencyInjector)(O.HostService);const[x,M]=(0,p.useState)((()=>o.clone(n||s||{name:"Jira",url:""})));const[N,F]=(0,p.useState)(false);const[L,k]=(0,p.useState)(false);const[B,U]=(0,p.useState)(false);const[G,V]=(0,p.useState)(false);const H=(0,p.useCallback)((async()=>{await R.slackBugTracker.disconnect(e);F(false);k(true)}),[e,R.slackBugTracker]);const $=(0,p.useMemo)((()=>(t===null||t===void 0?void 0:t.name)||(t===null||t===void 0?void 0:t.email)||""),[t]);const W=(0,p.useMemo)((()=>x.name==="Jira"),[x]);const J=(0,p.useMemo)((()=>x.name==="Slack"),[x]);const Y=(0,p.useMemo)((()=>{var e;const t=((e=d.currentBugtracker)===null||e===void 0?void 0:e.config)||{};if(t.name===x.name&&t.url===x.url){return"Selected"}return c||"Done"}),[d.currentBugtracker,x,c]);const z=(0,p.useMemo)((()=>{var t;if(x.name==="Jira")return((t=x.url)===null||t===void 0?void 0:t.indexOf("://"))===-1?`http://${x.url}`:x.url;if(x.name==="Trello")return E.TrelloBugtracker.loginUrl;if(x.name==="Slack")return`${I.SlackBugtracker.getLoginUrl(h.flags.slackClientId.getValue())}&state=${e}`;if(x.name==="GitHub")return C.GitHubBugtracker.loginUrl;return""}),[x,h,e]);const q=(0,p.useMemo)((()=>{var e;const t=((e=d.currentBugtracker)===null||e===void 0?void 0:e.config)||{};const s=t.name!==x.name||x.name==="Jira"&&t.url!==x.url;return N&&s&&(x.name!=="Jira"||Boolean(x.url))}),[d.currentBugtracker,N,x]);const X=(0,p.useCallback)((()=>{F(false);k(false);U(false);V(false)}),[F,k,U,V]);const Z=(0,p.useCallback)((async()=>{X();if(!["Trello","Slack","GitHub"].includes(x.name)&&!x.url){return}const e=d.createBugtracker(x);if(e){try{V(true);await e.isAuth();F(true)}catch(e){if(e.data&&(e.status===401||e.data.status===401)){k(true)}else{U(true)}}finally{V(false)}}}),[x,d,X,V]);const Q=(0,p.useCallback)((()=>{const e=Object.assign({},x);d.setCurrent(e);u({bt:e})}),[d,x,u]);const K=(0,p.useCallback)((e=>()=>{var t;const s=((t=d.currentBugtracker)===null||t===void 0?void 0:t.config)||{};w.selectedBugtracker(e);M({name:e,url:s.name===e?s.url:""})}),[d.currentBugtracker,w,M]);const ee=(0,p.useCallback)((e=>{w.bugTrackerLinkOpened(x.name);e.preventDefault();const t=d.createBugtracker(x);t.performLogin()}),[w,x.name,P.activeHost]);const te=(0,p.useCallback)((e=>{const{value:t}=e.target;M({name:x.name,url:t});if(!t){X()}}),[x,M,X]);const se=(0,p.useMemo)((()=>o.debounce(Z,400)),[Z]);(0,p.useEffect)((()=>{j.setProjectId(e);if(s){d.setCurrent(s)}window.addEventListener("focus",se);return()=>window.removeEventListener("focus",se)}),[j,d,e,s,se]);(0,p.useEffect)((()=>{se();return()=>se.cancel()}),[se]);return(0,i.jsxs)("div",{className:a.default.bugtrackerSettings,children:[(0,i.jsx)("div",{className:a.default.viewIconContainer,children:(0,i.jsx)("div",{className:a.default.viewIcon,children:(0,i.jsx)(f.Icon,{icon:"bugim"})})}),(0,i.jsx)("div",{className:a.default.content,children:(0,i.jsx)("div",{children:s?(0,i.jsx)("div",{className:a.default.contextText,children:"Choose bug tracker"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:a.default.contextText,children:["Hello",$&&(0,i.jsxs)("span",{children:[" ",$.split(" ")[0],"!"]})]}),(0,i.jsxs)("div",{className:(0,r.default)(a.default.contextText,a.default.contextTextMoreInfo),children:["This is the first bug you publish.",(0,i.jsx)("br",{}),"Choose your tracker to publish bug automatically"]})]})})}),(0,i.jsx)("div",{className:a.default.bugtrackers,children:Object.entries(A).map((([e,t])=>(0,i.jsx)("button",{className:(0,r.default)(a.default.tracker,{[a.default.selected]:x.name===e}),onClick:K(e),children:(0,i.jsx)("img",{src:t,alt:""})},`tracker-${e}`)))}),(J||W)&&(0,i.jsx)("div",{className:a.default.settingsSeparator}),J&&(0,i.jsx)("div",{className:a.default.addToSlackContainer,children:(0,i.jsx)(T.AddToSlack,{loginUrl:z,disabled:N||G})}),W&&(0,i.jsxs)("div",{className:a.default.url,children:[(0,i.jsx)("label",{children:"Host"}),(0,i.jsx)(g.Textbox,{placeholder:"https://example.atlassian.net",onChange:te,value:x.url,className:a.default.urlInput}),N&&!G&&(0,i.jsx)(f.Icon,{className:a.default.check,icon:"check"}),B&&!G&&(0,i.jsx)(f.Icon,{className:a.default.close,icon:"close"}),L&&!G&&(0,i.jsx)(f.Icon,{className:a.default.excMark,icon:"exc-mark"})]}),(0,i.jsx)("div",{className:(0,r.default)(a.default.msg,{[a.default.nonSeparated]:["Trello","GitHub"].includes(x.name)}),children:G?(0,i.jsx)("div",{className:a.default.loadingMsg,children:"Authenticating..."}):(0,i.jsxs)(i.Fragment,{children:[N&&(0,i.jsx)("div",{className:a.default.successMsg,children:"You are logged in"}),J&&N&&(0,i.jsx)("button",{className:a.default.disconnectSlack,onClick:H,children:"Disconnect"}),B&&(0,i.jsx)("div",{className:a.default.errorMsg,children:"Host name is wrong. Please try again"}),L&&(0,i.jsxs)("div",{className:a.default.errorMsg,children:["You are not logged in to ",x.name,". Please ",(0,i.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:z,onClick:ee,children:"Login"})," and ",(0,i.jsx)("a",{onClick:se,children:"Try again"})]})]})}),(0,i.jsx)("div",{className:(0,r.default)(a.default.footer,{[a.default.hideFooterSeparator]:l}),children:(0,i.jsx)(m.Cta,{onClick:Q,disabled:!q,children:Y})})]})}))},function(e,t,s){"use strict";s.r(t);t["default"]={bugtrackerSettings:"Settings_bugtrackerSettings_205DB_V0dGluZ3Mt",settingsSeparator:"Settings_settingsSeparator_1bmda_V0dGluZ3Mt",viewIconContainer:"Settings_viewIconContainer_3E_WR_V0dGluZ3Mt",viewIcon:"Settings_viewIcon_yXSjj_V0dGluZ3Mt",content:"Settings_content_sxg_R_V0dGluZ3Mt",contextText:"Settings_contextText_3nUzd_V0dGluZ3Mt",contextTextMoreInfo:"Settings_contextTextMoreInfo_3aejs_V0dGluZ3Mt",bugtrackers:"Settings_bugtrackers_CH1XN_V0dGluZ3Mt",tracker:"Settings_tracker_2_v9J_V0dGluZ3Mt",selected:"Settings_selected_2hdJb_V0dGluZ3Mt",addToSlackContainer:"Settings_addToSlackContainer_1Gx_F_V0dGluZ3Mt",url:"Settings_url_ZspCM_V0dGluZ3Mt",check:"Settings_check_1U3qo_V0dGluZ3Mt",close:"Settings_close_1y-mT_V0dGluZ3Mt",excMark:"Settings_excMark_1Cfs-_V0dGluZ3Mt",urlInput:"Settings_urlInput_1TRzv_V0dGluZ3Mt",msg:"Settings_msg_1mzoo_V0dGluZ3Mt",nonSeparated:"Settings_nonSeparated_3wyQX_V0dGluZ3Mt",errorMsg:"Settings_errorMsg_StcgF_V0dGluZ3Mt",link:"Settings_link_1_yXA_V0dGluZ3Mt",successMsg:"Settings_successMsg_1qFAm_V0dGluZ3Mt",disconnectSlack:"Settings_disconnectSlack_3HUpW_V0dGluZ3Mt",loadingMsg:"Settings_loadingMsg_2rW-P_V0dGluZ3Mt",footer:"Settings_footer_24BSz_V0dGluZ3Mt",hideFooterSeparator:"Settings_hideFooterSeparator_Y7d26_V0dGluZ3Mt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(835),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AddToSlack=void 0;const i=s(4);const o=s(0);const n=s(10);const r=s(836);const a=s(837);t.AddToSlack=o.memo((({loginUrl:e,disabled:t})=>(0,i.jsx)("div",{className:r.default.addToSlack,children:(0,i.jsxs)("a",{className:(0,n.default)(r.default.addToSlackLink,{[r.default.disabled]:t}),href:t?undefined:e,target:"_blank",rel:"noreferrer",children:[(0,i.jsx)("img",{src:a.default,alt:""}),(0,i.jsxs)("span",{children:["Add to ",(0,i.jsx)("span",{className:r.default.slackText,children:"Slack"})]})]})})))},function(e,t,s){"use strict";s.r(t);t["default"]={addToSlack:"AddToSlack_addToSlack_2IYE6_RvU2xhY2st",addToSlackLink:"AddToSlack_addToSlackLink_3oxOW_RvU2xhY2st",disabled:"AddToSlack_disabled_1ApTV_RvU2xhY2st",slackText:"AddToSlack_slackText_1bkQe_RvU2xhY2st"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"f305996cde.png"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FabricJSCanvas=t.useFabricJSEditor=t.ANNOTATE_COLORS=void 0;const i=s(4);const o=s(0);const n=s(273);const r=s(0);const a=s(839);t.ANNOTATE_COLORS={RED:n.default.red,PINK:n.default.pink,GREY:n.default.grey,GREEN:n.default.green,BLACK:n.default.black,ORANGE:n.default.orange,BLUE:n.default.blue,LIME:n.default.lime,TURQUOISE:n.default.turquoise};const c={arrow:"crosshair",text:"text",rectangle:"crosshair",default:"crosshair"};const l=()=>{const[e,s]=(0,r.useState)(null);const[i,o]=(0,r.useState)(null);const[n,l]=(0,r.useState)(null);const[u,d]=(0,r.useState)(false);const[p,h]=(0,r.useState)();const[f,m]=(0,r.useState)(t.ANNOTATE_COLORS.PINK);const[g,v]=(0,r.useState)(null);const S=(0,r.useCallback)((()=>{const t=(e===null||e===void 0?void 0:e.getActiveObjects())||[];return t.length>0}),[e]);const y=(0,r.useCallback)((t=>{const s=1/window.devicePixelRatio;const i=new Image;i.onload=()=>{e===null||e===void 0?void 0:e.setDimensions({width:i.width*s,height:i.height*s});const t=new a.fabric.Image(i,{left:0,hasControls:false,evented:false,selectable:false,scaleX:s,scaleY:s,name:"screenshotImg"});e===null||e===void 0?void 0:e.add(t)};i.src=t}),[e]);const b=(0,r.useCallback)((t=>{let s=c[t]||c.default;if(g===t){s="default"}if(!e){return}v(g===t?null:t);e.defaultCursor=s;e.selection=g===t}),[g,e,v]);const _=(0,r.useCallback)((()=>{e===null||e===void 0?void 0:e.discardActiveObject();return(e===null||e===void 0?void 0:e.toDataURL({format:"png",multiplier:window.devicePixelRatio}))||""}),[e]);const T=(0,r.useCallback)((t=>{if(t.key==="Backspace"||t.key==="Delete"){const t=(e===null||e===void 0?void 0:e.getActiveObjects())||[];if(t.some((e=>e.isEditing))){return}if(t.length>0){e===null||e===void 0?void 0:e.discardActiveObject();for(const s of t){e===null||e===void 0?void 0:e.remove(s)}e===null||e===void 0?void 0:e.renderAll()}}}),[e]);const E=(0,r.useCallback)((t=>{d(true);if(S()||!e){return}const s=e.getPointer(t.e);h(e.getPointer(t.e));if(g==="arrow"){const t=[s.x,s.y,s.x,s.y];const i=new a.fabric.Line(t,{strokeWidth:4,fill:f,stroke:f,originX:"center",originY:"center",selectable:true,evented:true});e.add(i);const n=new a.fabric.Triangle({width:16,height:16,fill:f,left:s.x,top:s.y,selectable:true,evented:true,originX:"center",originY:"top"});e.add(n);o(i);l(n)}else if(g==="rectangle"){const t=new a.fabric.Rect({left:s.x,top:s.y,width:0,height:0,selectable:true,evented:true,stroke:f,strokeWidth:4,fill:"transparent"});t.on("scaling",(function(){var e,t,s,i;const o=((e=this.width)!==null&&e!==void 0?e:0)*((t=this.scaleX)!==null&&t!==void 0?t:0);const n=((s=this.height)!==null&&s!==void 0?s:0)*((i=this.scaleY)!==null&&i!==void 0?i:0);this.set({height:n,width:o,scaleX:1,scaleY:1})}));e.add(t);e.renderAll();o(t)}}),[e,f,g,d,S]);const I=(0,r.useCallback)((t=>{if(!u||S()||!e){return}const s=e.getPointer(t.e);if(g==="arrow"){let e=Math.sqrt(Math.pow(s.x-((p===null||p===void 0?void 0:p.x)||0),2)+Math.pow(s.y-((p===null||p===void 0?void 0:p.y)||0),2));e-=8;const t=Math.atan2(s.y-((p===null||p===void 0?void 0:p.y)||0),s.x-((p===null||p===void 0?void 0:p.x)||0));i===null||i===void 0?void 0:i.set({x2:((p===null||p===void 0?void 0:p.x)||0)+Math.cos(t)*e,y2:((p===null||p===void 0?void 0:p.y)||0)+Math.sin(t)*e});n===null||n===void 0?void 0:n.set({left:s.x,top:s.y,angle:t*180/Math.PI+90})}else if(g==="rectangle"){if(((p===null||p===void 0?void 0:p.x)||0)>s.x){i===null||i===void 0?void 0:i.set({left:Math.abs(s.x)})}if(((p===null||p===void 0?void 0:p.y)||0)>s.y){i===null||i===void 0?void 0:i.set({top:Math.abs(s.y)})}i===null||i===void 0?void 0:i.set({width:Math.abs(s.x-((p===null||p===void 0?void 0:p.x)||0)),height:Math.abs(s.y-((p===null||p===void 0?void 0:p.y)||0))})}e.renderAll()}),[u,e,g,p,i,n,S]);const C=(0,r.useCallback)((()=>{d(false);if(S()||!e){return}if(g==="text"){const t=new a.fabric.IText("Type Something...",{fontFamily:"MuseoSans",fontSize:25,left:p===null||p===void 0?void 0:p.x,top:p===null||p===void 0?void 0:p.y,fill:f,padding:10,editingBorderColor:"transparent"});e.add(t)}else if(g==="arrow"&&i&&n){const{x1:t,x2:s,y1:o,y2:r}=i;if(t!==s||o!==r){e.remove(i);e.remove(n);i.clone((t=>{n.clone((s=>{const i=new a.fabric.Group([t,s],{selectable:true,evented:true});e.add(i)}))}))}}else if(g==="rectangle"&&i){e.remove(i);i.clone((t=>e.add(t)))}}),[e,g,f,i,n,p,d,S]);(0,r.useEffect)((()=>{if(!e){return undefined}document.addEventListener("keydown",T);e.on("mouse:down",E);e.on("mouse:move",I);e.on("mouse:up",C);e.on("object:selected",(t=>{var s;e.uniformScaling=((s=t.target)===null||s===void 0?void 0:s.type)==="rect"}));return()=>{document.removeEventListener("keydown",T);e.off({"mouse:down":E,"mouse:move":I,"mouse:up":C})}}),[e,T,E,I,C]);return{onReady:e=>s(e),setCurrentColor:m,currentColor:f,changeMode:b,currentMode:g,setScreenshot:y,getDataUrl:_}};t.useFabricJSEditor=l;t.FabricJSCanvas=o.memo((({className:e,onReady:t})=>{const s=(0,r.useRef)(null);const o=(0,r.useRef)(null);(0,r.useEffect)((()=>{if(!(s===null||s===void 0?void 0:s.current)){return undefined}a.fabric.Object.prototype.set({cornerSize:6,borderColor:"transparent",cornerStrokeColor:"gray",cornerColor:"white",transparentCorners:false});const e=new a.fabric.Canvas(s===null||s===void 0?void 0:s.current);e.isDrawingMode=false;const i=()=>{var t,s;e.setHeight(((t=o.current)===null||t===void 0?void 0:t.clientHeight)||0);e.setWidth(((s=o.current)===null||s===void 0?void 0:s.clientWidth)||0);e.renderAll()};const n=()=>{i()};i();window.addEventListener("resize",n,false);t===null||t===void 0?void 0:t(e);return()=>{e.dispose();window.removeEventListener("resize",n)}}),[]);return(0,i.jsx)("div",{ref:o,className:e,children:(0,i.jsx)("canvas",{ref:s})})}))},,function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(841),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Publish=void 0;const i=s(4);const o=s(0);const n=s(81);const r=s(0);const a=s(12);const c=s(27);const l=s(11);const u=s(71);const d=s(174);const p=s(69);const h=s(99);const f=s(28);const m=s(287);const g=s(842);const v=s(45);const S=s(845);const y=s(5);t.Publish=(0,a.observer)((()=>{const e=(0,l.useDependencyInjector)(u.BugtrackerManager);const t=(0,l.useDependencyInjector)(d.BugimAnalytics);const s=(0,l.useDependencyInjector)(p.BugimDataStore);const o=(0,l.useDependencyInjector)(h.BugimOutput);const a=(0,l.useDependencyInjector)(f.ModalService);const[b,_]=(0,r.useState)(false);const[T,E]=(0,r.useState)();const[I,C]=(0,r.useState)(s.getProjectId());const[D,O]=(0,r.useState)(s.getVideoUrl());const[A,j]=(0,r.useState)("");const[w,R]=(0,r.useState)("");const P=(0,r.useMemo)((()=>{var e;const t=((e=s.getTest())===null||e===void 0?void 0:e.id)||"";return`https://app.testim.io/#/project/${I}/branch/${y.commonConstants.MASTER_BRANCH}/test/${t}`}),[s,I]);const x=(0,r.useMemo)((()=>s.getStepCount()||1),[s]);const M=(0,r.useMemo)((()=>s.getTimer()||"00:00"),[s]);const N=(0,r.useCallback)((async()=>{var i;t.openSettings();const o=((i=e.currentBugtracker)===null||i===void 0?void 0:i.config)||{};const n=await a.openModal(m.BugtrackerSettingsModal,{currentBugtracker:o,projectId:I,userDetails:s.getLoginData()}).promise;if(n){e.setCurrent(n.bt)}j("")}),[I,t,a,s,e]);const F=(0,r.useCallback)((async()=>{const e=await a.openModal(g.LoginToTrackerModal).promise;if(e==="openSettings"){N()}else if(e==="reload"&&T){T.explicitUpdate++}}),[a,T,N]);const L=(0,r.useCallback)((async()=>{const e=await a.openModal(v.MessageModal,{title:"DISCARD BUG",body:"Do you really want to delete this bug?",okText:"DISCARD",cancelText:"CANCEL",variety:"normal",icon:"trash-v4",className:n.default.deletionModal}).promise;if(e){o.discardIssue()}}),[a,o]);const k=(0,r.useCallback)((async()=>{if(!T){return}_(true);t.publish();try{T.annotatedImageBase64=s.getAnnotateImage();const t=(e,t,s,i,n)=>{o.uploadBase64AsBlob(e,t,s,i,n)};const i=await e.currentBugtracker.publish(T,t);s.setLastIssue(T);o.publishSuccess({issueTitle:T.summary,issueUrl:i.issueUrl});o.saveTest(T.summary);o.closeBugim()}catch(e){o.error(e);t.errorOnPublish();let s="Something went wrong, ";if(e.errorDescription){s+="please fix the following errors: ";R(e.errorDescription)}else{s+="please try again."}j(s);_(false)}}),[T,t,s,o,e.currentBugtracker,_,R,j]);(0,r.useEffect)((()=>{const t=e.currentBugtracker;if(!t){N()}return()=>{o.discardIssue()}}),[]);(0,r.useEffect)((()=>{const t=e.currentBugtracker;if(t){const i=s.getCurrentIssue()||{};const o=s.getTest();const n=t.createIssue(i);const{description:r,stepImage:a}=(0,S.bugDescription)({test:o,testUrl:P,wrapScreenshotUrl:e=>e||"",useStepDescriptionProperty:true});n.description=`${r}${e.currentBugtracker.getVideoAnnotate(D)}${e.currentBugtracker.getAnnotateImageFormat(a||"https://app.testim.io/assets/images/no-image.png")}`;n.summary=n.summary||"Untitled Bug";n.stepImage=a;E(n);const l=(0,c.deepObserve)(n,((e,t,i)=>s.setCurrentIssue(i)));return()=>l()}return()=>undefined}),[s,P,e.currentBugtracker]);(0,r.useEffect)((()=>{const e=e=>O(e);const t=e=>C(e);s.subscribe("video-url",e);s.subscribe("projectId",t);return()=>{s.unsubscribe("video-url",e);s.unsubscribe("projectId",t);o.discardIssue()}}),[s,o,O,C]);return(0,i.jsx)(S.PublishBug,{close:L,errors:{bugtrackerError:A,publishErrorDescription:w},isLoading:b,onError:j,openLoginToTracker:F,openSettings:N,publish:k,screenshot:s.getAnnotateImage(),stepCount:x,testUrl:P,issue:T,onVideoPlayed:t.playVideo,timer:M,videoUrl:D})}))},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(843),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LoginToTrackerModal=void 0;const i=s(4);const o=s(0);const n=s(844);const r=s(0);const a=s(12);const c=s(16);const l=s(31);const u=s(11);const d=s(71);const p=s(30);t.LoginToTrackerModal=(0,a.observer)((({closeModal:e})=>{const t=(0,u.useDependencyInjector)(d.BugtrackerManager);const s=(0,r.useMemo)((()=>t.currentBugtracker),[t.currentBugtracker]);const o=(0,r.useMemo)((()=>{const e=(s===null||s===void 0?void 0:s.loginUrl)||(s===null||s===void 0?void 0:s.config.url);return(e===null||e===void 0?void 0:e.indexOf("://"))===-1?`http://${e}`:e}),[s]);const a=(0,r.useCallback)((async t=>{t===null||t===void 0?void 0:t.preventDefault();if(s){try{await s.isAuth();e("reload")}catch(e){}}}),[s,e]);const h=(0,r.useCallback)((()=>window.open(o,"_blank","noopener noreferrer")),[o]);const f=(0,r.useCallback)((()=>e("openSettings")),[e]);(0,r.useEffect)((()=>{a();window.addEventListener("focus",a);return()=>window.removeEventListener("focus",a)}),[a]);return(0,i.jsxs)(p.BaseModal,{closeModal:e,closeOnClickOutside:false,closeOnEscape:false,containerClassName:n.default.container,bodyClassName:n.default.modalBody,header:(0,i.jsxs)("h3",{children:["LOGIN TO ",s===null||s===void 0?void 0:s.config.name]}),footer:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Cta,{onClick:h,children:["Login to ",s===null||s===void 0?void 0:s.config.name]}),(0,i.jsx)(l.Cta,{onClick:f,variety:"secondary",children:"Use another tracker"})]}),children:[(0,i.jsx)("div",{className:n.default.viewIcon,children:(0,i.jsx)(c.Icon,{icon:"key"})}),(0,i.jsxs)("div",{className:n.default.content,children:[(0,i.jsxs)("div",{children:["You are not logged in to your ",s===null||s===void 0?void 0:s.config.name," account"]}),(0,i.jsxs)("div",{className:n.default.description,children:["Please login and ",(0,i.jsx)("a",{href:"#",onClick:a,children:"try again."})]}),(s===null||s===void 0?void 0:s.config.name)==="Jira"&&(0,i.jsx)("div",{className:n.default.url,children:o})]})]})}));t.LoginToTrackerModal.displayName="LoginToTrackerModal"},function(e,t,s){"use strict";s.r(t);t["default"]={container:"LoginToTracker_container_239rw_RyYWNrZXIt",modalBody:"LoginToTracker_modalBody_1Nc0h_RyYWNrZXIt",content:"LoginToTracker_content_4Rqnd_RyYWNrZXIt",description:"LoginToTracker_description_3g7w8_RyYWNrZXIt",url:"LoginToTracker_url_3VjXq_RyYWNrZXIt",viewIcon:"LoginToTracker_viewIcon_39Sjk_RyYWNrZXIt"}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var o=Object.getOwnPropertyDescriptor(t,s);if(!o||("get"in o?!t.__esModule:o.writable||o.configurable)){o={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,o)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))i(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});o(s(846),t);o(s(849),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PublishBug=void 0;const i=s(4);const o=s(0);const n=s(847);const r=s(848);const a=s(0);const c=s(12);const l=s(30);const u=s(16);const d=s(37);const p=s(31);const h=s(11);const f=s(71);const m=o.memo((({logoImg:e,openSettings:t})=>(0,i.jsxs)("div",{className:n.default.header,children:[(0,i.jsx)("h3",{children:"PUBLISH BUG"}),(0,i.jsxs)("div",{className:n.default.settings,children:[e&&(0,i.jsx)("img",{className:n.default.btImg,src:e,alt:""}),(0,i.jsx)(u.Icon,{icon:"cog",onClick:t})]})]})));m.displayName="PublishHeader";t.PublishBug=(0,c.observer)((({close:e,publish:t,openSettings:s,openLoginToTracker:o,onError:c,onVideoPlayed:g,isLoading:v,errors:S,issue:y,testUrl:b,stepCount:_,screenshot:T,videoUrl:E,timer:I})=>{const C=(0,h.useDependencyInjector)(f.BugtrackerManager);const D=(0,a.useMemo)((()=>C.currentBugtracker),[C.currentBugtracker]);const O=(0,a.useMemo)((()=>D.form),[D]);return(0,i.jsxs)(l.BaseModal,{closeModal:e,className:n.default.modal,bodyClassName:n.default.modalGrid,header:(0,i.jsx)(m,{logoImg:D.logo,openSettings:s}),children:[(0,i.jsxs)("div",{className:n.default.content,children:[v&&(0,i.jsx)("div",{className:n.default.loaderWrapper,children:(0,i.jsx)(d.Loader,{})}),S.bugtrackerError&&(0,i.jsxs)("div",{className:n.default.errors,children:[S.bugtrackerError,S.publishErrorDescription&&(0,i.jsx)("div",{children:S.publishErrorDescription})]}),!v&&y&&(0,i.jsx)("div",{className:n.default.form,children:O&&(0,i.jsx)(O,{issue:y,openLoginToTracker:o,onError:c})})]}),(0,i.jsxs)("div",{className:n.default.attachments,children:[(0,i.jsx)("div",{className:n.default.attachmentsHeader,children:"INCLUDED WITH THIS BUG"}),(0,i.jsxs)("div",{className:n.default.linksAndVideo,children:[(0,i.jsxs)("div",{className:n.default.testLink,children:[(0,i.jsxs)("a",{className:n.default.testLinkImageContainer,href:b,target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)("img",{src:r.default}),(0,i.jsx)(u.Icon,{icon:"magic-link"})]}),(0,i.jsxs)("div",{className:n.default.linkText,children:[(0,i.jsx)("div",{className:n.default.linkHeader,children:"Automated Test"}),(0,i.jsxs)("div",{className:n.default.linkDescription,children:[_," steps recorded"]})]})]}),E&&(0,i.jsxs)("div",{className:n.default.videoLink,children:[(0,i.jsxs)("a",{className:n.default.videoContainer,href:E,onClick:g,target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)("video",{src:E,className:n.default.videoBug})," ",(0,i.jsx)(u.Icon,{icon:"running"})]}),(0,i.jsxs)("div",{className:n.default.linkText,children:[(0,i.jsx)("div",{className:n.default.linkHeader,children:"Bug video"}),(0,i.jsx)("div",{className:n.default.linkDescription,children:I})]})]})]}),(0,i.jsxs)("div",{className:n.default.screenshots,children:[(0,i.jsx)("div",{className:n.default.screenshotHeader,children:"1 SCREENSHOT"}),(0,i.jsx)("img",{className:n.default.screenshotImage,src:T})]})]}),(0,i.jsx)("div",{className:n.default.footer,children:(0,i.jsx)(p.Cta,{disabled:!(y===null||y===void 0?void 0:y.isValid)||v,onClick:t,children:"Publish"})})]})}));t.PublishBug.displayName="PublishBug"},function(e,t,s){"use strict";s.r(t);t["default"]={modal:"PublishBug_modal_Lt3pU_xpc2hCdWct",header:"PublishBug_header_rPSUK_xpc2hCdWct",settings:"PublishBug_settings_GF2DH_xpc2hCdWct",btImg:"PublishBug_btImg_1DZ4c_xpc2hCdWct",modalGrid:"PublishBug_modalGrid_3tv5E_xpc2hCdWct",content:"PublishBug_content_1LV0W_xpc2hCdWct",loaderWrapper:"PublishBug_loaderWrapper_3MYbV_xpc2hCdWct",errors:"PublishBug_errors_SDeKG_xpc2hCdWct",form:"PublishBug_form_28knV_xpc2hCdWct",attachments:"PublishBug_attachments_1Dxsv_xpc2hCdWct",attachmentsHeader:"PublishBug_attachmentsHeader_2q3Px_xpc2hCdWct",linksAndVideo:"PublishBug_linksAndVideo_3QF7z_xpc2hCdWct",testLink:"PublishBug_testLink_1qhoH_xpc2hCdWct",videoLink:"PublishBug_videoLink_2LOK8_xpc2hCdWct",testLinkImageContainer:"PublishBug_testLinkImageContainer_1fnJ0_xpc2hCdWct",videoContainer:"PublishBug_videoContainer_4gzGB_xpc2hCdWct",videoBug:"PublishBug_videoBug_RbjJs_xpc2hCdWct",linkText:"PublishBug_linkText_1ythh_xpc2hCdWct",linkHeader:"PublishBug_linkHeader_3cWa9_xpc2hCdWct",linkDescription:"PublishBug_linkDescription_7sdDG_xpc2hCdWct",screenshots:"PublishBug_screenshots_PaX_F_xpc2hCdWct",screenshotHeader:"PublishBug_screenshotHeader_1fkbf_xpc2hCdWct",screenshotImage:"PublishBug_screenshotImage_3EZY0_xpc2hCdWct",footer:"PublishBug_footer_2Gz-o_xpc2hCdWct"}},function(e,t,s){"use strict";s.r(t);t["default"]=s.p+"6ffea33ff3.png"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.bugDescription=t.getFailedStepOfTest=t.saveLastIssue=t.getLastIssue=void 0;const i=s(6);const o=e=>`Open reproducible bug scenario with Testim\n${e.testUrl}\nTested in ${e.browser}, ${e.resolution} resolution, ${e.os}\nSteps to reproduce:\n${e.description}`;const n=()=>{const e=localStorage.getItem("lastIssue");try{return JSON.parse(e||"{}")}catch{return{}}};t.getLastIssue=n;const r=e=>localStorage.setItem("lastIssue",JSON.stringify(e));t.saveLastIssue=r;const a=e=>e.steps.find((e=>{var t;return((t=e.result)===null||t===void 0?void 0:t.success)===false}));t.getFailedStepOfTest=a;const c=e=>{var s;const{useStepDescriptionProperty:n,testUrl:r,wrapScreenshotUrl:a}=e;if(!e.test){return{description:"",resultImage:"",stepImage:""}}const{scenario:c,baseUrl:l,testConfig:u}=e.test;const d=n?i.chain(c.steps).dropRight(1).map((e=>e.description)):i.chain(c.steps).map((e=>e.getDisplayName()));const p=d.filter().value();p.unshift(`Navigate to ${l||u.baseUrl}`);const h=p.reduce(((e,t,s)=>`${e}${s+1}. ${t.slice(0,57)}\n`),"");const f=i.capitalize(u.browser);const m=`${u.resolution.width}x${u.resolution.height}`;const g=u.os;const v=o({testUrl:r,browser:f,resolution:m,os:g,description:h});const S=(0,t.getFailedStepOfTest)(c)||c.steps.at(-1);const y=a((s=S===null||S===void 0?void 0:S.result)===null||s===void 0?void 0:s.stepScreenshot);const b=(S===null||S===void 0?void 0:S.screenImage)||a(S===null||S===void 0?void 0:S.getScreenImage());return{description:v,resultImage:y,stepImage:b}};t.bugDescription=c},function(e,t,s){"use strict";var i=this&&this.__decorate||function(e,t,s,i){var o=arguments.length,n=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,s,n):r(t,s))||n;return o>3&&n&&Object.defineProperty(t,s,n),n};var o=this&&this.__metadata||function(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)};var n;Object.defineProperty(t,"__esModule",{value:true});t.BugimInput=void 0;const r=s(9);const a=s(5);const c=s(69);let l=class e{constructor(e){this.handlers={};this.handlers={[a.commonConstants.scenario.ADD_STEP]:()=>e.setStepCount((e.getStepCount()||0)+1),[a.commonConstants.bugim.ANNOTATE]:t=>{e.setScreenshotImage(t);window.location.hash="#/annotate"},[a.commonConstants.bugim.CURRENT_DATA]:t=>{if(t.screenshotImage){e.setScreenshotImage(t.screenshotImage)}if(t.annotateImage){e.setAnnotateImage(t.annotateImage)}if(t.screenshotImage){e.setScreenshotImage(t.screenshotImage)}if(t.timer){e.setTimer(t.timer)}if(t.state){window.location.hash=`#/${t.state}`}},[a.commonConstants.bugim.LOGIN_DATA]:t=>e.setLoginData(t),[a.commonConstants.bugim.PROJECT_ID]:t=>e.setProjectId(t),[a.commonConstants.bugim.RECORD_START_TIME]:t=>e.setRecordStartTime(t),[a.commonConstants.bugim.TEST_DATA]:t=>{e.setTest(t);e.setRecordStartTime(t.createAt);e.setVideoUrl(t.fullCaptureVideoUrl);if(t.scenario){e.setStepCount(t.scenario.steps.length)}},default:()=>{}}}handleMessage(e){const{command:t,data:s}=e.data;(this.handlers[t]||this.handlers.default)(s)}start(){var e;window.addEventListener("message",(e=>this.handleMessage(e)));(e=window.top)===null||e===void 0?void 0:e.postMessage({command:a.commonConstants.bugim.FAB_IS_ON},"*")}};t.BugimInput=l;t.BugimInput=l=i([(0,r.injectable)(),o("design:paramtypes",[typeof(n=typeof c.BugimDataStore!=="undefined"&&c.BugimDataStore)==="function"?n:Object])],l)}]);