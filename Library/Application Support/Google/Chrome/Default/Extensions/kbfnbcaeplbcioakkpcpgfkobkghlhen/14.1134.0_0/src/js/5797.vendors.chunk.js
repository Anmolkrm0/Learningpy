/*! For license information please see 5797.vendors.chunk.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[5797],{46560:(e,t,i)=>{i.d(t,{B:()=>r});var n=i(27378);const r=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.646 7.646a.5.5 0 0 1 .708 0L12 11.293l3.646-3.647a.5.5 0 0 1 .708.708L12.707 12l3.647 3.646a.5.5 0 0 1-.708.708L12 12.707l-3.646 3.647a.5.5 0 0 1-.708-.708L11.293 12 7.646 8.354a.5.5 0 0 1 0-.708Z",fill:"#646B81"}))},17579:(e,t,i)=>{i.d(t,{N:()=>r});var n=i(27378);const r=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6a2 2 0 0 0-2 2v2h4V8a2 2 0 0 0-2-2Zm3 4V8a3 3 0 1 0-6 0v2H6.5a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5H15Zm-8 1v7h10v-7H7Z",fill:"#646B81"}))},42636:(e,t,i)=>{i.d(t,{Xy:()=>r,aU:()=>s,pY:()=>n});var n,r,s,o=i(31699),a=i(73975),l=i(45701),c=i(17889),u=i(57050),d=i(22232),m=i(8125),p=i(5114),h=i(87683),g=i(69693);!function(e){let t,i,n;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),function(e){e.create=function(e,t){return{id:e,kind:"string",value:t}}}(i=e.StringValue||(e.StringValue={})),function(e){e.create=function(e,t){return{id:e,kind:"radio",value:t}}}(n=e.RadioValue||(e.RadioValue={}))}(n||(n={})),function(e){e.match=e=>t=>{const i=t.kind;return"string"===i?e.string(t):"radio"===i?e.radio(t):void(0,d.L0)(i)}}(r||(r={})),function(e){function t(e){return"followUpQuestion"===e.kind}function i(e){return"quickAction"===e.kind}function r(e){return"skillAction"===e.kind}let s,d,f,v,y,b,x,S;e.isFollowUpQuestionActionValue=t,e.isQuickActionValue=i,e.isSkillActionValue=r,e.isListableActionValue=(0,m.Kg)(t,i,r),e.isUserPromptActionValue=function(e){return"userPrompt"===e.kind},e.isQuickRewriteActionValue=function(e){return"quickRewrite"===e.kind},e.isFollowUpQuestionActionInput=function(e){return"followUpQuestion"===e.kind},e.isQuickActionInput=function(e){return"quickAction"===e.kind},e.isSkillActionInput=function(e){return"skillAction"===e.kind},e.createFollowUpQuestionActionInputOrQuickActionInput=function(t,i,r,s){var a;const l=Array.from(new Set(i.map((e=>e.group)).filter((0,u.ff)(f.isPinned)))).findIndex((e=>t.group===e)),m=f.isPinned(t.group)?d.knownStores.pinned:d.knownStores.ideas,v={id:e.Id.create(t.id),iconUrl:t.iconUrl,store:{id:m,label:f.isPinned(t.group)?"":g.w.isQuickReply(r)?"Ways to reply":p.isSome(s)?`Work with: ${s.value}`:"Ideas for you",view:f.isPinned(t.group)?e.Store.View.pinned:e.Store.View.normal,rank:null!==(a=d.ranks[m])&&void 0!==a?a:Number.MAX_SAFE_INTEGER,maxCountBeforeClipping:g.w.isQuickReply(r)?p.none:p.some(3)},group:{id:f.Id.create(t.group),label:t.group,rank:l>-1?l:Number.MAX_SAFE_INTEGER},label:(0,o.sanitize)(t.label,{ALLOWED_TAGS:h.ap}),searchLabel:(0,o.sanitize)(t.label,{ALLOWED_TAGS:[]}),searchTags:t.searchTags,generatesTextType:p.fromNullable(t.generatesTextType)};if(1===t.args.length){const e=t.args[0],i={id:n.Id.create(e.name),label:e.label,hints:(0,u.zG)(p.fromNullable(e.hint),p.map((e=>({header:e.header,items:e.text}))))};return"string"===e.valueType?p.some(Object.assign(Object.assign({},v),{kind:"followUpQuestion",args:[Object.assign(Object.assign({},i),{kind:"string"})],generatesTextType:p.fromNullable(t.generatesTextType)})):"radioButtonGroup"===e.valueType?(0,u.zG)(e.radioButtonGroupValues,c.nI,p.map((e=>Object.assign(Object.assign({},v),{kind:"followUpQuestion",args:[Object.assign(Object.assign({},i),{kind:"radio",radioOptions:e})],generatesTextType:p.fromNullable(t.generatesTextType)})))):p.none}return 0===t.args.length?p.some(Object.assign(Object.assign({},v),{kind:"quickAction",args:[]})):p.none},function(e){e.create=function(e){return e},e.eq=a.yv}(s=e.Id||(e.Id={})),function(e){let t,i;!function(e){e.eq=a.yv}(t=e.Id||(e.Id={})),function(e){e.normal="normal",e.pinned="pinned"}(i=e.View||(e.View={})),e.knownStores={ideas:"ideas",pinned:"pinned",appActions:"app-actions"},e.ranks={[e.knownStores.ideas]:0,[e.knownStores.pinned]:1,[e.knownStores.appActions]:2}}(d=e.Store||(e.Store={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=a.yv}(t=e.Id||(e.Id={})),e.isPinned=function(e){return"pinned"===e}}(f=e.Group||(e.Group={})),function(e){e.fromTextInput=function(e,t){return Object.assign(Object.assign({},e),{args:[n.StringValue.create(e.args[0].id,t)]})},e.fromRadioInput=function(e,t){return Object.assign(Object.assign({},e),{args:[n.RadioValue.create(e.args[0].id,t)]})}}(v=e.FollowUpQuestionActionValue||(e.FollowUpQuestionActionValue={})),function(t){t.fromSkill=function(t,i){var n;const r=d.knownStores.appActions;return{kind:"skillAction",id:s.create(t.id),store:{id:r,label:"App actions",view:e.Store.View.normal,rank:null!==(n=d.ranks[r])&&void 0!==n?n:Number.MAX_SAFE_INTEGER,maxCountBeforeClipping:g.w.isQuickReply(i)?p.some(1):p.some(3)},group:{id:f.Id.create("app-actions"),label:"App actions",rank:Number.MAX_SAFE_INTEGER},iconUrl:t.iconUrl,label:(0,o.sanitize)(t.displayName,{ALLOWED_TAGS:h.ap}),searchLabel:(0,o.sanitize)(t.displayName,{ALLOWED_TAGS:[]}),searchTags:t.tags,generatesTextType:p.none,args:[],skill:t}}}(y=e.SkillActionInput||(e.SkillActionInput={})),function(e){e.ordByGroup=l.contramap((e=>e.group.rank))(l.ordNumber)}(b=e.ListableActionInput||(e.ListableActionInput={})),function(e){e.fromInput=function(e,t,i,r){return Object.assign(Object.assign({},e),{arg:n.StringValue.create(e.arg.id,t),useReferences:i,omitReferenceIds:r})}}(x=e.UserPromptActionValue||(e.UserPromptActionValue={})),function(e){e.fromInput=function(e){return Object.assign(Object.assign({},e),{args:[]})}}(S=e.QuickRewriteActionValue||(e.QuickRewriteActionValue={}))}(s||(s={}))},54157:(e,t,i)=>{var n;i.d(t,{C:()=>n}),function(e){let t;!function(e){e.feedbackSubmitted="feedbackSubmitted",e.voiceTagRemoved="voiceTagRemoved"}(t=e.Kind||(e.Kind={}))}(n||(n={}))},83289:(e,t,i)=>{i.d(t,{i:()=>n});var n,r=i(8125),s=i(22232);!function(e){let t;!function(e){e.mount="mount",e.unmount="unmount",e.toolbarCloseButtonClick="toolbarCloseButtonClick",e.toolbarGoBackButtonClick="toolbarGoBackButtonClick",e.toolbarVoiceButtonClick="toolbarVoiceButtonClick",e.setVoiceButtonClick="setVoiceButtonClick",e.voiceProfileCloseButtonClick="voiceProfileCloseButtonClick",e.voiceProfileUseVoiceButtonClick="voiceProfileUseVoiceButtonClick",e.toneToggleClick="toneToggleClick",e.styleToggleClick="styleToggleClick",e.roleTypeaheadSelectionChange="roleTypeaheadSelectionChange",e.dialectDropdownSelectionChange="dialectDropdownSelectionChange",e.promptFieldTextChange="promptFieldTextChange",e.promptFieldFocusChange="promptFieldFocusChange",e.promptFieldAndMenuFocusChange="promptFieldAndMenuFocusChange",e.actionBrickClick="actionBrickClick",e.promptSubmitButtonClick="promptSubmitButtonClick",e.generateStopButtonClick="generateStopButtonClick",e.promptFieldKeyPressEscape="promptFieldKeyPressEscape",e.promptFieldKeyPressEnter="promptFieldKeyPressEnter",e.promptFieldKeyPressArrowDown="promptFieldKeyPressArrowDown",e.promptFieldKeyPressArrowUp="promptFieldKeyPressArrowUp",e.promptMenuKeyPressArrowDown="promptMenuKeyPressArrowDown",e.promptMenuKeyPressArrowUp="promptMenuKeyPressArrowUp",e.resultCardInsertButtonClick="resultCardInsertButtonClick",e.resultCardRephraseButtonClick="resultCardRephraseButtonClick",e.resultCardDismissButtonClick="resultCardDismissButtonClick",e.resultCardToggleGenericVoiceButtonClick="resultCardToggleGenericVoiceButtonClick",e.errorCardOkButtonClick="errorCardOkButtonClick",e.openFeedbackFormButtonClick="openFeedbackFormButtonClick",e.feedbackFormChange="feedbackFormChange",e.feedbackFormSubmitButtonClick="feedbackFormSubmitButtonClick",e.reportOffensiveResultButtonClick="reportOffensiveResultButtonClick",e.reportOffensiveActionsButtonClick="reportOffensiveActionsButtonClick",e.resultCardHeaderClick="resultCardHeaderClick",e.collapsePromptMenuButtonClick="collapsePromptMenuButtonClick",e.creditsInfoHover="creditsInfoHover",e.creditsInfoClick="creditsInfoClick",e.resultCardHoverChange="resultCardHoverChange",e.resultCardFocusChange="resultCardFocusChange",e.resultCardCopy="resultCardCopy",e.reportMenuVisibilityChange="reportMenuVisibilityChange",e.referencesVisibilityChange="referencesVisibilityChange",e.voiceProfileTabChange="voiceProfileTabChange",e.voiceTagClick="voiceTagClick",e.voiceTagPopoverCloseButtonClick="voiceTagPopoverCloseButtonClick",e.voiceTagPopoverKeepButtonClick="voiceTagPopoverKeepButtonClick",e.voiceTagPopoverRemoveButtonClick="voiceTagPopoverRemoveButtonClick",e.applyVoiceToWritingCheckboxChange="applyVoiceToWritingCheckboxChange",e.voiceDialectDropdownSelectionChange="voiceDialectDropdownSelectionChange",e.voiceRoleDropdownSelectionChange="voiceRoleDropdownSelectionChange",e.voiceSelectionsSaveButtonClick="voiceSelectionsSaveButtonClick",e.voiceSelectionsCancelButtonClick="voiceSelectionsCancelButtonClick",e.voiceSelectionsEditButtonClick="voiceSelectionsEditButtonClick",e.surveyRatingSelectionChange="surveyRatingSelectionChange",e.surveyOpenAnswerChange="surveyOpenAnswerChange",e.surveySubmitButtonClick="surveySubmitButtonClick",e.surveyKeyPressShiftEnter="surveyKeyPressShiftEnter",e.surveyCancelButtonClick="surveyCancelButtonClick",e.surveyCloseButtonClick="surveyCloseButtonClick",e.regenerateWithoutReferenceButtonClick="regenerateWithoutReferenceButtonClick",e.restoreHistoryButtonClick="restoreHistoryButtonClick",e.userPromptSubmit="userPromptSubmit",e.radioOptionsSubmitButtonClick="radioOptionsSubmitButtonClick",e.radioOptionsCancelButtonClick="radioOptionsCancelButtonClick",e.removeSelectionContextClick="removeSelectionContextClick",e.selectionContextInteraction="selectionContextInteraction"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e},e.isResultAction=(0,r.Kg)(e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.reportOffensiveResultButtonClick),e.is(e.Kind.regenerateWithoutReferenceButtonClick)),e.isSurveyAction=(0,r.Kg)(e.is(e.Kind.surveyOpenAnswerChange),e.is(e.Kind.surveySubmitButtonClick),e.is(e.Kind.surveyKeyPressShiftEnter),e.is(e.Kind.surveyCancelButtonClick),e.is(e.Kind.surveyCloseButtonClick),e.is(e.Kind.surveyRatingSelectionChange)),e.isSurveyImplicitDismissAction=(0,r.Kg)(e.is(e.Kind.promptSubmitButtonClick),e.is(e.Kind.actionBrickClick),e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.resultCardHeaderClick))}(n||(n={})),(0,s.L0)(void 0)},33148:(e,t,i)=>{i.d(t,{JS:()=>r});var n,r,s=i(69243),o=i(59502),a=i(73915),l=i(8125),c=i(79662);!function(e){e.Codec=s.OT(s.dt({action:s.OT(s.Z_)}))}(n||(n={})),function(e){let t,i,n;!function(e){e.Codec=s.OT(s.dt({action:s.OT(s.i0("error"))})),e.is=function(t){return e.Codec.is(t)}}(t=e.Error||(e.Error={})),function(e){e.Codec=s.OT(s.dt({action:s.OT(s.i0("show_survey"))})),e.is=function(t){return e.Codec.is(t)}}(i=e.ShowSurvey||(e.ShowSurvey={})),function(e){let t,i;!function(e){e.Codec=s.OT(s.dt({action:s.OT(s.i0("cheetah")),id:s.OT(s.pk)})),e.is=e.Codec.is}(t=e.CheetahAck||(e.CheetahAck={})),function(e){e.is=a.n(c.Pb.extend(o.Schemable)({any:o.id(),sensitiveString:o.string,sensitiveDelta:o.id()}))(c.Pb.ServerMessageImplementations).is}(i=e.CheetahProtocolServerMessage||(e.CheetahProtocolServerMessage={})),e.is=(0,l.Kg)(t.is,i.is)}(n=e.CheetahInboundCAPIMessage||(e.CheetahInboundCAPIMessage={})),e.is=function(e){return t.is(e)||i.is(e)||n.is(e)}}(r||(r={}));r.CheetahInboundCAPIMessage.is},27278:(e,t,i)=>{var n;i.d(t,{_:()=>n}),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),e.isPending=function(e){return"pending"===e.kind},e.isReceived=function(e){return"received"===e.kind}}(n||(n={}))},83959:(e,t,i)=>{var n;i.d(t,{x:()=>n}),function(e){let t,i;!function(e){e.ok="ok",e.satisfied="satisfied",e.dissatisfied="dissatisfied"}(t=e.Mood||(e.Mood={})),function(e){e.resultCard="resultCard",e.quickReplyInitialActions="quickReplyInitialActions"}(i=e.Source||(e.Source={}))}(n||(n={}))},819:(e,t,i)=>{i.d(t,{_:()=>n});var n,r=i(5114),s=i(57050),o=i(8125);!function(e){let t,i;function n(e){return e.kind===t.activeLimited||e.kind===t.activeUnlimited}function a(e){return e.kind===t.passive}function l(e){return e.kind===t.unknown}function c(e){return n(e)||l(e)}function u(i){if(void 0===i)return{kind:t.unknown,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}};const n=e.Active.parseRefillDate(i.usage.refillDate);return i.usage.promptsRemaining<0?{kind:t.unknown,userSettings:i.settings}:1e4===i.usage.promptsAllocated&&i.usage.promptsRemaining>0?{kind:t.activeUnlimited,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}:i.usage.promptsRemaining>0?{kind:t.activeLimited,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}:{kind:t.passive,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}}!function(e){e.activeLimited="activeLimited",e.activeUnlimited="activeUnlimited",e.passive="passive",e.unavailable="unavailable",e.disabled="disabled",e.pending="pending",e.unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){const t=(0,o.HP)((e=>{const t=Date.parse(e);return isNaN(t)?0:t}));function i(e){const t=e-Date.now();return Math.floor(t/36e5)}e.parseRefillDate=function(e){return t(e)},e.hoursUntilRefillDate=i,e.daysUntilRefillDate=function(e){return Math.floor(i(e)/24)}}(i=e.Active||(e.Active={})),e.isActive=n,e.isActiveUnlimited=function(e){return e.kind===t.activeUnlimited},e.isPassive=a,e.isActiveOrPassive=(0,o.Kg)(n,a),e.isUnknown=l,e.isUsable=c,e.isVisible=function(e){return c(e)||a(e)},e.isDisabled=function(e){return e.kind===t.disabled},e.isUnavailable=function(e){return e.kind===t.pending||e.kind===t.unavailable||e.kind===t.disabled},e.fromUserState=u,e.updateUsage=function(e,t){return u({usage:t,settings:e.userSettings})},e.getPromptsAllocated=function(t){return(0,s.zG)(t,r.fromPredicate(e.isActiveOrPassive),r.map((e=>e.promptsAllocated)))}}(n||(n={}))},2847:(e,t,i)=>{i.d(t,{fz:()=>b,lu:()=>v,pm:()=>y});var n=i(8125);function r(e){return"error"===e.kind&&"assistant"===e.source}function s(e){return"error"===e.kind&&"capi"===e.source}function o(e){return"error"===e.kind&&"experiment"===e.source}function a(e){return"error"===e.kind&&"feedback"===e.source}function l(e){return"info"===e.kind&&"session"===e.source}function c(e){return"warning"===e.kind&&"session"===e.source}function u(e){return"error"===e.kind&&"session"===e.source}function d(e){return"info"===e.kind&&"skill"===e.source}function m(e){return"error"===e.kind&&"skill"===e.source}function p(e){return"error"===e.kind&&"uphook"===e.source}function h(e){return"info"===e.kind&&"userSurvey"===e.source}function g(e){return"warning"===e.kind&&"userSurvey"===e.source}function f(e){return"error"===e.kind&&"userSurvey"===e.source}const v=(0,n.Kg)(l,d,h),y=(0,n.Kg)(c,g);function b(e){return r(e)||s(e)||o(e)||a(e)||u(e)||m(e)||p(e)||f(e)}},34349:(e,t,i)=>{i.d(t,{b:()=>n});var n,r=i(5114),s=i(57050),o=i(8125);!function(e){let t,i,n;!function(e){e.create=function(e){return{kind:"error",source:"skill",name:"getSkillsFailed",rawError:e}},e.is=function(e){return"getSkillsFailed"===e.name}}(t=e.GetSkillsFailed||(e.GetSkillsFailed={})),function(e){e.create=function(e,t){return{kind:"error",source:"skill",name:"initSkillFailed",skillId:(0,s.zG)(e,r.map((e=>e.id)),r.toNullable),rawError:t}},e.is=function(e){return"initSkillFailed"===e.name}}(i=e.InitSkillFailed||(e.InitSkillFailed={})),function(e){e.create=function(e,t){return{kind:"error",source:"skill",name:"terminateSkillFailed",skillId:(0,s.zG)(e,r.map((e=>e.id)),r.toNullable),rawError:t}},e.is=function(e){return"terminateSkillFailed"===e.name}}(n=e.TerminateSkillFailed||(e.TerminateSkillFailed={})),e.toJSON=function(e){var r,a;const l={kind:e.kind,source:e.source,name:String(e.name)};return t.is(e)?JSON.stringify(Object.assign(Object.assign({},l),{rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(r=e.rawError.stack)&&void 0!==r?r:""})):(0,o.Kg)(i.is,n.is)(e)?JSON.stringify(Object.assign(Object.assign({},l),{skillId:e.skillId,rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(a=e.rawError.stack)&&void 0!==a?a:""})):(0,s.Rz)(e)}}(n||(n={}))},12422:(e,t,i)=>{i.d(t,{e:()=>n});var n,r=i(57050),s=i(8125);!function(e){let t,i,n;!function(e){e.create=function(e){return{kind:"info",source:"skill",name:"getSkillsSuccessful",skillIds:e.map((e=>e.id))}},e.is=function(e){return"getSkillsSuccessful"===e.name}}(t=e.GetSkillsSuccessful||(e.GetSkillsSuccessful={})),function(e){e.create=function(e){return{kind:"info",source:"skill",name:"initSkillSuccessful",skillId:e.id}},e.is=function(e){return"initSkillSuccessful"===e.name}}(i=e.InitSkillSuccessful||(e.InitSkillSuccessful={})),function(e){e.create=function(e){return{kind:"info",source:"skill",name:"terminateSkillSuccessful",skillId:e.id}},e.is=function(e){return"terminateSkillSuccessful"===e.name}}(n=e.TerminateSkillSuccessful||(e.TerminateSkillSuccessful={})),e.toJSON=function(e){const o={kind:e.kind,source:e.source,name:String(e.name)};return t.is(e)?JSON.stringify(Object.assign(Object.assign({},o),{skillIds:e.skillIds})):(0,s.Kg)(i.is,n.is)(e)?JSON.stringify(Object.assign(Object.assign({},o),{skillId:e.skillId})):(0,r.Rz)(e)}}(n||(n={}))},21189:(e,t,i)=>{i.d(t,{T:()=>n});var n,r=i(22232);!function(e){let t;!function(e){e.initial="initial",e.initialBTS="initialBTS",e.history="history",e.prompts="prompts",e.review="review",e.rewrite="rewrite",e.knowledgeHub="knowledgeHub",e.references="references"}(t=e.StepName||(e.StepName={})),function(e){e.isAssistantOnboardingStep=function(t){switch(t){case e.prompts:case e.review:case e.knowledgeHub:case e.references:case e.history:return!0;case e.initial:case e.initialBTS:case e.rewrite:return!1;default:return(0,r.L0)(t)}},e.isTooltipOnboardingStep=function(t){switch(t){case e.prompts:case e.review:case e.rewrite:case e.knowledgeHub:case e.references:case e.history:return!0;case e.initial:case e.initialBTS:return!1;default:return(0,r.L0)(t)}}}(t=e.StepName||(e.StepName={}))}(n||(n={}))},8122:(e,t,i)=>{i.d(t,{l:()=>n});var n,r=i(22232);!function(e){let t;!function(e){e.close="close",e.tryItOut="tryItOut",e.mount="mount"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e}}(n||(n={})),(0,r.L0)(void 0)},91984:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(95195),r=i(5114),s=i(64015),o=i(57050),a=i(69243);var l;!function(e){const t=["initial","initialBTS","prompts","review","rewrite","knowledgeHub","references","history"],i=["extension","editor","llamaMac","llamaWin"];function l(e,t){return`${e}|${t}`}function c(e,t,i){return`${e}|${t}|${i}`}function u(e){return r.isSome(y(e))}function d(e){return r.isSome(b(e))}const m=new a.Dy("CompletedStepName",(e=>"string"==typeof e&&u(e)),((e,t)=>"string"==typeof e&&u(e)?a.Vp(e):a.Rn(e,t)),a.yR),p=new a.Dy("LastSeenStepName",(e=>"string"==typeof e&&d(e)),((e,t)=>"string"==typeof e&&d(e)?a.Vp(e):a.Rn(e,t)),a.yR),h=a.OT(a.r$({completed:a.Bk(m),lastSeen:a.Bk(p)}));let g,f,v;function y(e){return(0,o.zG)(r.some(e.split("|")),r.filter((e=>2===e.length)),r.filter((e=>t.includes(e[0])&&i.includes(e[1]))))}function b(e){return(0,o.zG)(r.some(e.split("|")),r.filter((e=>3===e.length)),r.filter((e=>t.includes(e[0])&&i.includes(e[1]))),r.filterMap((e=>(0,o.zG)(parseInt(e[2],10),(t=>Number.isNaN(t)?r.none:r.some([e[0],e[1],t]))))))}function x(e,t,i){var n,r,s,o;return{extension:{completed:t.some((t=>t[0]===e&&"extension"===t[1])),lastSeen:null===(n=i.find((t=>t[0]===e&&"extension"===t[1])))||void 0===n?void 0:n[2]},editor:{completed:t.some((t=>t[0]===e&&"editor"===t[1])),lastSeen:null===(r=i.find((t=>t[0]===e&&"editor"===t[1])))||void 0===r?void 0:r[2]},llamaMac:{completed:t.some((t=>t[0]===e&&"llamaMac"===t[1])),lastSeen:null===(s=i.find((t=>t[0]===e&&"llamaMac"===t[1])))||void 0===s?void 0:s[2]},llamaWin:{completed:t.some((t=>t[0]===e&&"llamaWin"===t[1])),lastSeen:null===(o=i.find((t=>t[0]===e&&"llamaWin"===t[1])))||void 0===o?void 0:o[2]}}}e.emptyClientStep={completed:!1,lastSeen:void 0},function(e){function t(e){return t=>e(t.extension)||e(t.editor)||e(t.llamaMac)||e(t.llamaWin)}e.anyClient=t,e.anyClientCompleted=t((e=>e.completed))}(g=e.Step||(e.Step={})),e.emptyStep={extension:e.emptyClientStep,llamaMac:e.emptyClientStep,llamaWin:e.emptyClientStep,editor:e.emptyClientStep},e.codec=new a.Dy("UpstreamOnboarding",(e=>h.is(e)),((e,t)=>(0,o.zG)(h.validate(e,t),n.map((e=>{const t=(0,o.zG)(e.completed||[],s.UI(y),s.oA),i=(0,o.zG)(e.lastSeen||[],s.UI(b),s.oA);return{initial:x("initial",t,i),initialBTS:x("initialBTS",t,i),prompts:x("prompts",t,i),review:x("review",t,i),rewrite:x("rewrite",t,i),knowledgeHub:x("knowledgeHub",t,i),references:x("references",t,i),history:x("history",t,i)}})))),(e=>({completed:(0,o.zG)(Object.entries(e),s.tS((([e,t])=>function(e,t){return(0,o.zG)(Object.entries(t),s.tS((([t,i])=>i.completed?[l(e,t)]:[])))}(e,t)))),lastSeen:(0,o.zG)(Object.entries(e),s.tS((([e,t])=>function(e,t){return(0,o.zG)(Object.entries(t),s.tS((([t,i])=>i.lastSeen?[c(e,t,i.lastSeen)]:[])))}(e,t))))}))),e.decode=function(t){return(0,o.zG)(decodeURIComponent(t),(i=>{try{const t=JSON.parse(i);return e.codec.decode(t)}catch(e){return n.left(`Cannot decode raw onboarding state: ${t}.`)}}),n.getOrElse((()=>e.State.empty)))},e.encode=function(t){return encodeURIComponent(JSON.stringify(e.codec.encode(t)))},function(t){t.empty={initial:e.emptyStep,initialBTS:e.emptyStep,prompts:e.emptyStep,review:e.emptyStep,rewrite:e.emptyStep,knowledgeHub:e.emptyStep,references:e.emptyStep,history:e.emptyStep},t.toClientState=function(e,t){return{initial:e.initial[t],initialBTS:e.initialBTS[t],prompts:e.prompts[t],review:e.review[t],rewrite:e.rewrite[t],knowledgeHub:e.knowledgeHub[t],references:e.references[t],history:e.history[t]}},t.patch=function(e,t){return i=>({initial:Object.assign(Object.assign({},i.initial),{[t]:e.initial}),initialBTS:Object.assign(Object.assign({},i.initialBTS),{[t]:e.initialBTS}),prompts:Object.assign(Object.assign({},i.prompts),{[t]:e.prompts}),review:Object.assign(Object.assign({},i.review),{[t]:e.review}),rewrite:Object.assign(Object.assign({},i.rewrite),{[t]:e.rewrite}),knowledgeHub:Object.assign(Object.assign({},i.knowledgeHub),{[t]:e.knowledgeHub}),references:Object.assign(Object.assign({},i.references),{[t]:e.references}),history:Object.assign(Object.assign({},i.history),{[t]:e.history})})}}(f=e.State||(e.State={})),function(t){t.empty={initial:e.emptyClientStep,initialBTS:e.emptyClientStep,prompts:e.emptyClientStep,review:e.emptyClientStep,rewrite:e.emptyClientStep,knowledgeHub:e.emptyClientStep,references:e.emptyClientStep,history:e.emptyClientStep}}(v=e.ClientState||(e.ClientState={}))}(l||(l={}))},4068:(e,t,i)=>{i.d(t,{H:()=>n});var n,r=i(5114),s=i(64015),o=i(17889),a=i(57050);!function(e){let t,i;e.fromOuterContext=function(e){var i,n,l,c;const u=e=>(0,a.zG)(r.fromNullable(null==e?void 0:e.from),r.chain(s.YM),r.fold((()=>t.empty),t.fromNameAndEmailString)),d=e=>(0,a.zG)(r.fromNullable(null==e?void 0:e.to),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[]))),m=(0,a.zG)(r.fromNullable(e.items),r.chain(s.YM),r.getOrElseW((()=>{})));return{previousMessageInfo:{author:u(null==m?void 0:m.people),directRecipients:d(null==m?void 0:m.people),text:null!==(i=null==m?void 0:m.text)&&void 0!==i?i:""},title:null!==(n=e.title)&&void 0!==n?n:"",author:u(e.people),directRecipients:d(e.people),indirectRecipients:(0,a.zG)(r.fromNullable(null===(l=e.people)||void 0===l?void 0:l.cc),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[]))),undisclosedRecipients:(0,a.zG)(r.fromNullable(null===(c=e.people)||void 0===c?void 0:c.bcc),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[])))}},e.toOuterContext=function(t){return{title:t.title,people:{from:[e.Person.extractNameAndEmailString(t.author)],to:t.directRecipients.map(e.Person.extractNameAndEmailString),cc:t.indirectRecipients.map(e.Person.extractNameAndEmailString),bcc:t.undisclosedRecipients.map(e.Person.extractNameAndEmailString)},items:[{text:t.previousMessageInfo.text,people:{from:[e.Person.extractNameAndEmailString(t.previousMessageInfo.author)],to:t.previousMessageInfo.directRecipients.map(e.Person.extractNameAndEmailString)}}]}},e.empty={previousMessageInfo:{author:{name:"",email:""},directRecipients:[],text:""},title:"",author:{name:"",email:""},directRecipients:[],indirectRecipients:[],undisclosedRecipients:[]},function(e){e.empty={name:"",email:""},e.fromNameAndEmailString=function(t){return(0,a.zG)(r.fromNullable(t.match(/^([^<]*)<(.*)>$/)),r.map((e=>{var t,i,n,r;return{name:null!==(i=null===(t=e[1])||void 0===t?void 0:t.trim())&&void 0!==i?i:"",email:null!==(r=null===(n=e[2])||void 0===n?void 0:n.trim())&&void 0!==r?r:""}})),r.getOrElse((()=>e.empty)))},e.extractNameAndEmailString=function(e){const t=""!==e.email?`<${e.email}>`:"";return[e.name,t].filter((e=>""!==e)).join(" ")}}(t=e.Person||(e.Person={})),function(e){e.empty={author:{name:"",email:""},directRecipients:[],text:""}}(i=e.PreviousMessageInfo||(e.PreviousMessageInfo={}))}(n||(n={}))},63764:(e,t,i)=>{i.d(t,{s:()=>n});var n,r=i(5114);!function(e){let t;!function(e){e.create=e=>e}(t=e.Id||(e.Id={})),e.create=function(t){return Object.assign(Object.assign({},t),{id:e.Id.create(t.id),url:r.fromNullable(t.url),contextText:r.none})}}(n||(n={}))},14047:(e,t,i)=>{i.d(t,{x:()=>n});var n,r=i(73975),s=i(5114),o=i(64015),a=i(17889),l=i(57050),c=i(8709),u=i(8125),d=i(95195),m=i(65602),p=i(63764);!function(e){let t,i,n,h,g,f,v;function y(e){return"complete"===e.kind}function b(e){return"history"===e.kind}function x(e){return"inProgressOngoing"===e.kind}function S(e){return"inProgressPending"===e.kind}!function(e){e.create=function(e){return`${e}`},e.toPrimitive=function(e){return parseInt(e,10)},e.eq=r.yv}(t=e.Id||(e.Id={})),function(e){e.insert="insert",e.reportOffensive="reportOffensive"}(i=e.Feedback||(e.Feedback={})),function(e){e.insert="insert",e.copy="copy"}(n=e.PrimaryAction||(e.PrimaryAction={})),e.hasId=function(e){return"id"in e},e.isComplete=y,e.isHistory=b,e.isAIUsageNotification=function(e){return"aiUsageNotification"===e.kind},e.isStandardCompletedResult=(0,u.Kg)(y,b),e.isInProgressOngoing=x,e.isInProgressPending=S,e.isInProgressInterrupted=function(e){return"inProgressInterrupted"===e.kind},e.isInProgress=(0,u.Kg)(x,S),function(e){e.generic="generic",e.user="user"}(h=e.GeneratedTextVoice||(e.GeneratedTextVoice={})),function(t){t.createFromResultMessage=function(t){return(0,l.zG)(t.withVoiceText,(i=>{var n;const r=(0,l.zG)((0,m.DO)(null===(n=t.text)||void 0===n?void 0:n.delta),s.getOrElse((()=>new c.i)));return(0,l.zG)((0,m.DO)(null==i?void 0:i.delta),d.fromOption((()=>r)),d.map((i=>({generic:r,user:i,preferVoice:!0===(null==t?void 0:t.showVoiceTextByDefault)?e.GeneratedTextVoice.user:e.GeneratedTextVoice.generic}))))}))}}(g=e.ResultDelta||(e.ResultDelta={})),function(t){t.createFromCard=function(t){return{kind:"history",id:e.Id.create(t.id),header:"action"===t.title.kind?{label:t.title.label,iconUrl:""!==t.title.iconUrl.trim()?s.some(t.title.iconUrl):s.none,copiablePrompt:s.none}:{label:t.title.text,iconUrl:s.none,copiablePrompt:""!==t.title.text.trim()?s.some(t.title.text):s.none},replacementDelta:g.createFromResultMessage({text:t.text,withVoiceText:t.text.plain===t.withVoiceText.plain?void 0:t.withVoiceText,showVoiceTextByDefault:t.text.plain===t.withVoiceText.plain?void 0:t.showVoiceTextByDefault}),primaryAction:s.some(e.PrimaryAction.insert),references:(0,l.zG)(t.references,o.UI(p.s.create),a.c2)}}}(f=e.History||(e.History={})),function(e){e.fromInProgressResult=function(e,t){return Object.assign(Object.assign({},e),{kind:"aiUsageNotification",text:t})}}(v=e.AIUsageNotification||(e.AIUsageNotification={}))}(n||(n={}))},7903:(e,t,i)=>{i.d(t,{z:()=>n});var n,r=i(5114),s=i(69693);!function(e){let t,i;!function(e){e.restoreDisabled="restoreDisabled",e.unknown="unknown",e.hasHistory="hasHistory",e.noHistory="noHistory",e.historyRequested="historyRequested",e.historyRestored="historyRestored"}(t=e.HistoryStatus||(e.HistoryStatus={})),e.toStarting=function(e){return"starting"===e.kind?r.some(e):r.none},e.toStarted=function(e){return"started"===e.kind?r.some(e):r.none},e.isStartedWithInProgressResult=function(e){return"started"===e.kind&&r.isSome(e.inProgressResult)},function(e){e.initial={kind:"starting",mode:s.w.ideation,selectedRange:r.none,selectedText:r.none,quickReplyContext:r.none,historyStatus:t.unknown,writingExpertContext:r.none,error:r.none,textRevision:0}}(i=e.Starting||(e.Starting={}))}(n||(n={}))},99877:(e,t,i)=>{var n,r;i.d(t,{e:()=>n,n:()=>r}),function(e){e.initialActionsList="initialActionsList",e.followUpActionsList="followUpActionsList",e.creditsInfoButton="creditsInfoButton",e.promptInput="promptInput",e.promptMenuContent="promptMenuContent",e.skill="skill",e.referencesList="referencesList",e.historyButton="historyButton"}(n||(n={})),function(e){e.initialPopupAnchor="initialPopupAnchor",e.initialBTSPopupAnchor="initialBTSPopupAnchor",e.rewriteTooltipAnchor="rewriteTooltipAnchor"}(r||(r={}))},42724:(e,t,i)=>{var n;i.d(t,{n:()=>n}),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(n||(n={}))},86148:(e,t,i)=>{i.d(t,{x:()=>n});var n,r=i(80800),s=i(22232);!function(e){let t;!function(e){let t;!function(e){e.Rating="rating",e.Feedback="feedback",e.Completed="completed",e.Closed="closed"}(t=e.Type||(e.Type={})),e.isOpen=e=>e!==t.Closed,e.toCAPIStage=e=>{switch(e){case t.Rating:return r.v0.Survey.Data.OpenAnswerScoreSurvey.scoreStage;case t.Feedback:case t.Closed:case t.Completed:return r.v0.Survey.Data.OpenAnswerScoreSurvey.submitStage;default:(0,s.L0)(e)}}}(t=e.Stage||(e.Stage={}))}(n||(n={}))},3709:(e,t,i)=>{i.d(t,{L:()=>n,b:()=>r});var n,r,s=i(73975),o=i(5114),a=i(64015),l=i(48044),c=i(13853),u=i(22232);!function(e){let t,i,n,r,d,m;!function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(t=e.Tone||(e.Tone={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(i=e.Style||(e.Style={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(n=e.Role||(e.Role={})),function(e){let t,i;function n(e){switch(e){case t.american:return"American English";case t.australian:return"Australian English";case t.british:return"British English";case t.canadian:return"Canadian English";case t.indian:return"Indian English";default:return(0,u.L0)(e)}}function r(e){switch(e){case t.american:return"https://assets.grammarly.com/emoji/v1/1f1fa-1f1f8.svg";case t.australian:return"https://assets.grammarly.com/emoji/v1/1f1e6-1f1fa.svg";case t.british:return"https://assets.grammarly.com/emoji/v1/1f1ec-1f1e7.svg";case t.canadian:return"https://assets.grammarly.com/emoji/v1/1f1e8-1f1e6.svg";case t.indian:return"https://assets.grammarly.com/emoji/v1/1f1ee-1f1f3.svg";default:return(0,u.L0)(e)}}!function(e){e.fromString=function(t){switch(t){case"american":return e.american;case"australian":return e.australian;case"british":return e.british;case"canadian":return e.canadian;case"indian":return e.indian;default:return(0,u.L0)(t)}}}(t=e.Value||(e.Value={})),function(e){e.american="american",e.australian="australian",e.british="british",e.canadian="canadian",e.indian="indian"}(t=e.Value||(e.Value={})),function(e){e.create=function(e){return e},e.eq=s.yv}(i=e.Id||(e.Id={})),e.american={id:i.create(t.american),label:n(t.american),iconUrl:r(t.american)},e.australian={id:i.create(t.australian),label:n(t.australian),iconUrl:r(t.australian)},e.british={id:i.create(t.british),label:n(t.british),iconUrl:r(t.british)},e.canadian={id:i.create(t.canadian),label:n(t.canadian),iconUrl:r(t.canadian)},e.indian={id:i.create(t.indian),label:n(t.indian),iconUrl:r(t.indian)},e.all=function(){return[e.american,e.australian,e.british,e.canadian,e.indian]}}(r=e.Dialect||(e.Dialect={})),function(e){e.eq=s.MW({selectedStyle:i.Id.eq,selectedTonesPerStyle:l.Eh(i.Id.eq,c.Eh(t.Id.eq)),selectedRole:o.getEq(n.Id.eq),selectedDialect:r.Id.eq})}(d=e.Selections||(e.Selections={})),e.toLegacyVoiceProfile=function(e){return"legacyVoiceProfile"===e.kind?o.some(e):o.none},function(e){const t=s.MW({name:s.yv,state:s.yv}),i=s.MW({name:s.yv,tags:a.Eh(t)}),l=s.MW({name:s.yv,summary:s.yv,selected:s.vD,sections:a.Eh(i)}),c=a.Eh(l);e.eqByRoleDialectProfileAndIsEnabledByDefault=s.MW({profiles:c,selectedRole:o.getEq(n.Id.eq),selectedDialect:r.Id.eq,isEnabledByDefault:s.vD})}(m=e.NewSelections||(e.NewSelections={})),e.toNewVoiceProfile=function(e){return"newVoiceProfile"===e.kind?o.some(e):o.none}}(n||(n={})),function(e){e.createId=({tagName:e,sectionName:t,profileName:i})=>`${t}-${e}-${i}`}(r||(r={}))},79662:(e,t,i)=>{i.d(t,{Pb:()=>s});var n=i(71761),r=i(9090);const s=n;r.i},46733:(e,t,i)=>{i.d(t,{t:()=>x});var n,r=i(57050),s=i(14601),o=i(32952),a=i(85985),l=i(71032),c=i(12126),u=i(5114),d=i(62965),m=i(33148),p=i(8125),h=i(22232);!function(e){let t,i;!function(e){e.create=function(e,t){return{kind:"error",source:"capi",name:"unsanitizeTextOnInboundCAPIMessageFailed",capiMessageAction:e,rawError:t}},e.is=function(e){return"unsanitizeTextOnInboundCAPIMessageFailed"===e.name}}(t=e.UnsanitizeTextOnInboundCAPIMessageFailed||(e.UnsanitizeTextOnInboundCAPIMessageFailed={})),function(e){e.create=function(e,t){return{kind:"error",source:"capi",name:"sanitizeTextOnOutboundCAPIMessageFailed",capiMessageAction:e,rawError:t}},e.is=function(e){return"sanitizeTextOnOutboundCAPIMessageFailed"===e.name}}(i=e.SanitizeTextOnOutboundCAPIMessageFailed||(e.SanitizeTextOnOutboundCAPIMessageFailed={})),e.toJSON=function(e){var n;return(0,p.Kg)(t.is,i.is)(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),capiMessageAction:e.capiMessageAction,rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(n=e.rawError.stack)&&void 0!==n?n:""}):(0,h.L0)(e)}}(n||(n={}));var g=i(36991),f=i(8709),v=i(65602),y=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};function b(e,t){return y(this,void 0,void 0,(function*(){const i=yield(0,r.zG)(e,v.DO,u.map((e=>Promise.all(e.ops.map((e=>g.s.isInsertString(e)?t(e.insert).then((t=>Object.assign(Object.assign({},e),{insert:t}))):e))))),u.getOrElse((()=>Promise.resolve([]))));return new f.i([...i])}))}class x{constructor(e){this._params=e,this._sub=new s.w,this._relevantInboundCAPIMessages=new o.xQ,this.relevantInboundCAPIMessages=this._relevantInboundCAPIMessages.asObservable(),this._sub.add(this._getRelevantInboundCAPIMessagesObs().subscribe(this._relevantInboundCAPIMessages))}cheetahGetContext(e){const t=(0,r.zG)(u.fromNullable(this._params.dlpOptions),u.map((({sanitizeText:t})=>function(e,t){return y(this,void 0,void 0,(function*(){const i=e=>y(this,void 0,void 0,(function*(){if(e)return(yield Promise.all(Object.keys(e).map((i=>Promise.all(e[i].map((e=>t(e)))).then((e=>({peopleKey:i,sanitizedPeopleValues:e}))))))).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.peopleKey]:t.sanitizedPeopleValues})),{})}));return void 0===e?Promise.resolve(e):(e.title?t(e.title):Promise.resolve(void 0)).then((n=>y(this,void 0,void 0,(function*(){return e.items?{sanitizedTitle:n,sanitizedItems:yield Promise.all(e.items.map((e=>t(e.text).then((i=>e.title?t(e.title).then((e=>({sanitizedItemText:i,sanitizedItemTitle:e}))):{sanitizedItemText:i,sanitizedItemTitle:void 0})).then((({sanitizedItemText:t,sanitizedItemTitle:n})=>y(this,void 0,void 0,(function*(){return{text:t,title:n,people:yield i(e.people)}})))))))}:{sanitizedTitle:n,sanitizedItems:void 0}})))).then((({sanitizedTitle:t,sanitizedItems:n})=>y(this,void 0,void 0,(function*(){return{title:t,items:n,people:yield i(e.people)}}))))}))}(e.outerContext,t))),u.getOrElse((()=>Promise.resolve(e.outerContext))));return(0,r.zG)(d.Y3((()=>t),(e=>new Error(JSON.stringify(e)))),d.Vn((e=>(this._params.monitoringService.notify(n.SanitizeTextOnOutboundCAPIMessageFailed.create("cheetah:getContext",e)),e))),d.tS((t=>this._params.sendCAPIMessage({action:"cheetah:getContext",data:Object.assign(Object.assign({},e),{outerContext:t}),shouldInjectRev:!0,shouldInjectSessionId:!1}))))}cheetahAction(e){const t=(0,r.zG)(u.fromNullable(this._params.dlpOptions),u.map((({sanitizeText:t})=>function(e,t){return y(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>t(e.value).then((t=>Object.assign(Object.assign({},e),{value:t}))))))}))}(e.args,t))),u.getOrElse((()=>Promise.resolve(e.args)))),i=(0,r.zG)(u.fromNullable(this._params.dlpOptions),u.map((({sanitizeText:t})=>function(e,t){return y(this,void 0,void 0,(function*(){return void 0===e?Promise.resolve(e):t(e.text).then((t=>Object.assign(Object.assign({},e),{text:t})))}))}(e.previousText,t))),u.getOrElse((()=>Promise.resolve(e.previousText))));return(0,r.zG)(d.Y3((()=>t),(e=>new Error(JSON.stringify(e)))),d.tS((e=>d.Y3((()=>i.then((t=>({sanitizedArgs:e,sanitizedPreviousText:t})))),(e=>new Error(JSON.stringify(e)))))),d.Vn((e=>(this._params.monitoringService.notify(n.SanitizeTextOnOutboundCAPIMessageFailed.create("cheetah:action",e)),e))),d.tS((({sanitizedArgs:t,sanitizedPreviousText:i})=>this._params.sendCAPIMessage({action:"cheetah:action",data:Object.assign(Object.assign({},e),{args:t,previousText:i}),shouldInjectRev:!0,shouldInjectSessionId:!1}))))}cheetahGetHistory(){return this._params.sendCAPIMessage({action:"cheetah:getHistory",shouldInjectRev:!1,data:{},shouldInjectSessionId:!1})}cheetahGetUserState(){return this._params.sendCAPIMessage({action:"cheetah:getUserState",data:{},shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahInterrupt(e){return this._params.sendCAPIMessage({action:"cheetah:interrupt",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSearchReferences(e){return this._params.sendCAPIMessage({action:"cheetah:searchReferences",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoice(e){return this._params.sendCAPIMessage({action:"cheetah:setVoice",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoiceProfile(e){return this._params.sendCAPIMessage({action:"cheetah:setVoiceProfile",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}user_action(e){return this._params.sendCAPIMessage({action:"user_action",data:e,shouldInjectRev:!1,shouldInjectSessionId:!0})}set_context(e){return this._params.sendCAPIMessage({action:"set_context",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}submit_survey_result(e){return this._params.sendCAPIMessage({action:"submit_survey_result",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}dispose(){this._sub.unsubscribe()}_getRelevantInboundCAPIMessagesObs(){const e=this._params.inboundCAPIMessages.pipe(a.h(m.JS.is));return(0,r.zG)(u.fromNullable(this._params.dlpOptions),u.fold((()=>e),(({unsanitizeText:t})=>e.pipe(l.b((e=>c.D((0,r.zG)(e,(e=>"cheetah:setContext"===e.action&&e.context.intent?function(e,t){return y(this,void 0,void 0,(function*(){return void 0===e.context.intent?Promise.resolve(e):t(e.context.intent).then((t=>Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{intent:t})})))}))}(e,t):"cheetah:chunk"===e.action?function(e,t){return y(this,void 0,void 0,(function*(){return t(e.token).then((t=>Object.assign(Object.assign({},e),{token:t})))}))}(e,t):"cheetah:result"===e.action?function(e,t){return y(this,void 0,void 0,(function*(){const i=e.text;return(i?t(i.plain).then((e=>y(this,void 0,void 0,(function*(){return{unsanitizedTextPlain:e,unsanitizedTextDelta:yield b(i.delta,t)}})))):Promise.resolve({unsanitizedTextPlain:void 0,unsanitizedTextDelta:new f.i})).then((({unsanitizedTextPlain:i,unsanitizedTextDelta:n})=>y(this,void 0,void 0,(function*(){const r=e.withVoiceText;return r?{unsanitizedTextPlain:i,unsanitizedTextDelta:n,unsanitizedWithVoiceTextPlain:yield t(r.plain),unsanitizedWithVoiceTextDelta:yield b(r.delta,t)}:{unsanitizedTextPlain:i,unsanitizedTextDelta:n,unsanitizedWithVoiceTextPlain:void 0,unsanitizedWithVoiceTextDelta:new f.i}})))).then((({unsanitizedTextPlain:t,unsanitizedTextDelta:i,unsanitizedWithVoiceTextPlain:n,unsanitizedWithVoiceTextDelta:r})=>Object.assign(Object.assign({},e),{text:e.text?Object.assign(Object.assign({},e.text),{plain:null!=t?t:e.text.plain,delta:i}):void 0,withVoiceText:e.withVoiceText?Object.assign(Object.assign({},e.withVoiceText),{plain:null!=n?n:e.withVoiceText.plain,delta:r}):void 0})))}))}(e,t):Promise.resolve(e)),(t=>t.catch((t=>(this._params.monitoringService.notify(n.UnsanitizeTextOnInboundCAPIMessageFailed.create(e.action,new Error(`${t}`))),e))))))))))))}}},92627:(e,t,i)=>{i.d(t,{L:()=>p});var n=i(5114),r=i(57050),s=i(9922),o=i(85985),a=i(77176),l=i(60797),c=i(98403),u=i(38983),d=i(33148),m=i(819);class p{constructor(e,t){this._capiService=e,this._genAIFeaturesState=t,this._subs=new s.w.Keeper,this._availability=u.h.create({kind:m._.Kind.pending,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}}),this.availability=this._availability.view(),this._subs.push(this._genAIFeaturesState.subscribe((e=>this._availability.set(e.enabled?m._.fromUserState(e.userState):{kind:m._.Kind.unavailable,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}})))),this._subs.push((0,r.zG)(this._capiService.relevantInboundCAPIMessages,o.h(d.JS.CheetahInboundCAPIMessage.is),a.U((e=>"cheetah:setUserState"===e.action?n.some(e.state):n.none)),l.oA,a.U(m._.fromUserState)).subscribe(c.wW(this._availability))),this._subs.push((0,r.zG)(this._capiService.relevantInboundCAPIMessages,o.h(d.JS.CheetahInboundCAPIMessage.is),a.U((e=>{switch(e.action){case"cheetah:setContext":case"cheetah:result":return n.some(e.usage);default:return n.none}})),l.oA,a.U((e=>m._.updateUsage(this._availability.get(),e)))).subscribe(c.wW(this._availability)))}dispose(){this._subs.dispose()}}},63346:(e,t,i)=>{i.d(t,{W:()=>n});class n{constructor(e){this.namespace=e}static configureAllLoggers(e){n._isEnabled="prod"!==e.env}trace(e,t,i){this._printToConsole("trace",e,t,i)}warn(e,t,i){this._printToConsole("warn",e,t,i)}debug(e,t,i){this._printToConsole("debug",e,t,i)}info(e,t,i){this._printToConsole("info",e,t,i)}error(e,t,i){this._printToConsole("error",e,t,i)}fatal(e,t,i){this._printToConsole("fatal",e,t,i)}_getMsgWithNamespace(e){return`[${n._rootNamespace}.${this.namespace}]: ${e}`}_printToConsole(e,t,i,r){if("fatal"===e)return void console.error(t,i,r);if(!n._isEnabled)return;const s=this._getMsgWithNamespace(t);i&&r?console[e](s,i,r):!i&&r?console[e](s,r):i&&!r?console[e](s,i):console[e](s)}}n._rootNamespace="CheetahWeb",n._isEnabled=!1},35298:(e,t,i)=>{i.d(t,{j:()=>o});var n=i(14601),r=i(98403),s=i(38983);class o{constructor(e){this._hostAvailability=e,this._availability=s.h.create({contextUpdatesClient:!1,contextUpdatesServer:!1}),this.availability=this._availability.view(),this._sub=new n.w,this._sub=e.subscribe(r.wW(this._availability))}augment(e){this._sub.unsubscribe(),this._sub=e(this._hostAvailability).subscribe(r.wW(this._availability))}dispose(){this._sub.unsubscribe()}}},31409:(e,t,i)=>{i.d(t,{Z:()=>Se});var n,r,s,o,a=i(17771),l=i(64015),c=i(17889),u=i(62965),d=i(57050),m=i(28043),p=i(50628),h=i(84966),g=i(9922),f=i(98403),v=i(66310),y=i(55935),b=i(60797),x=i(66081),S=i(2834),k=i(40151),w=i(80900),C=i(5114),_=i(83078),I=i(22232),E=i(8125),A=i(38983),O=i(42636),R=i(27278),T=i(50687);!function(e){let t;function i(e){switch(e){case t.sensitiveResult:return{header:"Assistance is unavailable",text:"Assistance is unavailable for that text or prompt.\nTry something else."};case t.overload:return{header:"Couldn’t generate text",text:"We’re handling a lot of prompts right now and couldn’t generate that text.\nPlease try again later."};case t.unsupportedLanguage:return{header:"Hmm, don’t know that language",text:"Assistance is currently only available for English."};case t.critical:case t.timeout:case t.emptyResult:case t.truncatedResult:case t.usageExceeded:return{header:"Something went wrong",text:"We’re not sure what happened, but we couldn’t generate that text.\nPlease try again."};default:return(0,d.Rz)(e)}}!function(e){e.create=function(t){switch(t){case T.oS.Generic:return e.critical;case T.oS.Overflow:return e.truncatedResult;case T.oS.PromptsLimitExceeded:return e.usageExceeded;case T.oS.SensitiveContent:return e.sensitiveResult;case T.oS.ServerOverloaded:return e.overload;case T.oS.UnsupportedLanguage:return e.unsupportedLanguage;default:return(0,d.Rz)(t)}}}(t=e.Reason||(e.Reason={})),function(e){e.emptyResult="emptyResult",e.truncatedResult="truncatedResult",e.sensitiveResult="sensitiveResult",e.usageExceeded="usageExceeded",e.unsupportedLanguage="unsupportedLanguage",e.overload="overload",e.timeout="timeout",e.critical="critical"}(t=e.Reason||(e.Reason={})),e.create=function(e){const n=t.create(e.kind),r=(0,d.zG)(a.Y(C.Applicative)({header:(0,d.zG)(C.fromNullable(e.title),C.filter((e=>""!==e.trim()))),text:(0,d.zG)(C.fromNullable(e.text),C.filter((e=>""!==e.trim())))}),C.getOrElse((()=>i(n))));return Object.assign({reason:n},r)},e.createCriticalError=function(e){return{reason:t.critical,header:"Something went wrong",text:e?"We’re not sure what happened.\nPlease try again later.":"We’re not sure what happened, but we couldn’t generate that text.\nPlease try again."}},e.createEmptyResultError=function(){return Object.assign({reason:t.emptyResult},i(t.emptyResult))}}(n||(n={})),function(e){let t,i,n,r,s,o,a,l,c,u,m,p,h;!function(e){e.create=function(e){return{source:"session",kind:"error",name:"getContextFailed",sessionMode:e}},e.is=function(e){return"getContextFailed"===e.name}}(t=e.GetContextFailed||(e.GetContextFailed={})),function(e){e.create=function(e){return{source:"session",kind:"error",name:"getHistoryFailed",sessionMode:e}},e.is=function(e){return"getHistoryFailed"===e.name}}(i=e.GetHistoryFailed||(e.GetHistoryFailed={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"actionFailed",sessionMode:e,actionId:t}},e.is=function(e){return"actionFailed"===e.name}}(n=e.ActionFailed||(e.ActionFailed={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"waitForContextTimeout",sourceCommand:t,sessionMode:e}},e.is=function(e){return"waitForContextTimeout"===e.name}}(r=e.WaitForContextTimeout||(e.WaitForContextTimeout={})),function(e){e.create=function(e){return{source:"session",kind:"error",name:"waitForHistoryTimeout",sessionMode:e}},e.is=function(e){return"waitForHistoryTimeout"===e.name}}(s=e.WaitForHistoryTimeout||(e.WaitForHistoryTimeout={})),function(e){e.create=function(e){return{source:"session",kind:"error",name:"waitForResultTimeout",sessionMode:e}},e.is=function(e){return"waitForResultTimeout"===e.name}}(o=e.WaitForResultTimeout||(e.WaitForResultTimeout={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"waitForAckTimeout",sourceCommand:t,sessionMode:e}},e.is=function(e){return"waitForAckTimeout"===e.name}}(a=e.WaitForAckTimeout||(e.WaitForAckTimeout={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"setVoiceProfileFailed",sessionMode:e,rawError:t}},e.is=function(e){return"setVoiceProfileFailed"===e.name}}(l=e.SetVoiceProfileFailed||(e.SetVoiceProfileFailed={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"setNewVoiceProfileFailed",sessionMode:e,rawError:t}},e.is=function(e){return"setNewVoiceProfileFailed"===e.name}}(c=e.SetNewVoiceProfileFailed||(e.SetNewVoiceProfileFailed={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"capiErrorUnhandled",sessionMode:e,capiError:t}},e.is=function(e){return"capiErrorUnhandled"===e.name}}(u=e.CAPIErrorUnhandled||(e.CAPIErrorUnhandled={})),function(e){e.create=function(e,t,i){return{source:"session",kind:"error",name:"regenerateResultFailed",sessionMode:e,resultId:t,reason:i}},e.is=function(e){return"regenerateResultFailed"===e.name}}(m=e.RegenerateResultFailed||(e.RegenerateResultFailed={})),function(e){e.create=function(e,t){return{source:"session",kind:"error",name:"stopInProgressResultFailed",sessionMode:e,rawError:t}},e.is=function(e){return"stopInProgressResultFailed"===e.name}}(p=e.StopInProgressResultFailed||(e.StopInProgressResultFailed={})),function(e){e.create=function(e,t,i){return{source:"session",kind:"error",name:"getTextFailed",sessionMode:e,textRange:t,rawError:i}},e.is=function(e){return"getTextFailed"===e.name}}(h=e.GetTextFailed||(e.GetTextFailed={})),e.toJSON=function(e){var g,f;const v={kind:e.kind,source:e.source,name:String(e.name),sessionMode:e.sessionMode};return(0,E.Kg)(t.is,i.is,o.is,s.is)(e)?JSON.stringify(v):n.is(e)?JSON.stringify(Object.assign(Object.assign({},v),{actionId:e.actionId.toString()})):(0,E.Kg)(a.is,r.is)(e)?JSON.stringify(Object.assign(Object.assign({},v),{sourceCommand:e.sourceCommand})):(0,E.Kg)(l.is,c.is,p.is)(e)?JSON.stringify(Object.assign(Object.assign({},v),{rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(g=e.rawError.stack)&&void 0!==g?g:""})):u.is(e)?JSON.stringify(Object.assign(Object.assign({},v),{errorCode:e.capiError.error,errorSeverity:String(e.capiError.severity)})):m.is(e)?JSON.stringify(Object.assign(Object.assign({},v),{resultId:e.resultId,reason:e.reason})):h.is(e)?JSON.stringify(Object.assign(Object.assign({},v),{textRange:e.textRange,rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(f=e.rawError.stack)&&void 0!==f?f:""})):(0,d.Rz)(e)}}(r||(r={})),function(e){let t,i,n,r;!function(e){e.create=function(e){return{source:"session",kind:"info",name:"getContextSuccessful",sessionMode:e}},e.is=function(e){return"getContextSuccessful"===e.name}}(t=e.GetContextSuccessful||(e.GetContextSuccessful={})),function(e){e.create=function(e){return{source:"session",kind:"info",name:"getHistorySuccessful",sessionMode:e}},e.is=function(e){return"getHistorySuccessful"===e.name}}(i=e.GetHistorySuccessful||(e.GetHistorySuccessful={})),function(e){e.create=function(e,t){return{source:"session",kind:"info",name:"actionSuccessful",sessionMode:e,actionId:t}},e.is=function(e){return"actionSuccessful"===e.name}}(n=e.ActionSuccessful||(e.ActionSuccessful={})),function(e){e.create=function(e,t,i){return{source:"session",kind:"info",name:"getTextSuccessful",sessionMode:e,textRange:t,text:i}},e.is=function(e){return"getTextSuccessful"===e.name}}(r=e.GetTextSuccessful||(e.GetTextSuccessful={})),e.toJSON=function(e){const s={kind:e.kind,source:e.source,name:String(e.name),sessionMode:e.sessionMode};return(0,E.Kg)(t.is,i.is)(e)?JSON.stringify(s):n.is(e)?JSON.stringify(Object.assign(Object.assign({},s),{actionId:e.actionId.toString()})):r.is(e)?JSON.stringify(Object.assign(Object.assign({},s),{textRange:e.textRange,text:e.text})):(0,d.Rz)(e)}}(s||(s={})),function(e){let t,i,n,r;!function(e){e.create=function(e,t,i){return{source:"session",kind:"warning",name:"unexpectedChunkReceived",sessionMode:e,expectedInProgressResultId:t,receivedInProgressResultId:i}},e.is=function(e){return"unexpectedChunkReceived"===e.name}}(t=e.UnexpectedChunkReceived||(e.UnexpectedChunkReceived={})),function(e){e.create=function(e,t,i){return{source:"session",kind:"warning",name:"unexpectedResultReceived",sessionMode:e,expectedInProgressResultId:t,receivedInProgressResultId:i}},e.is=function(e){return"unexpectedResultReceived"===e.name}}(i=e.UnexpectedResultReceived||(e.UnexpectedResultReceived={})),function(e){e.create=function(e,t){return{source:"session",kind:"warning",name:"capiErrorHandled",sessionMode:e,capiError:t}},e.is=function(e){return"capiErrorHandled"===e.name}}(n=e.CAPIErrorHandled||(e.CAPIErrorHandled={})),function(e){e.create=function(e){return{kind:"warning",name:"regenerateResultContextNotFound",sessionMode:e,source:"session"}},e.is=function(e){return"regenerateResultContextNotFound"===e.name}}(r=e.RegenerateResultContextNotFound||(e.RegenerateResultContextNotFound={})),e.toJSON=function(e){const s={kind:e.kind,source:e.source,name:String(e.name),sessionMode:e.sessionMode};return r.is(e)?JSON.stringify(s):(0,E.Kg)(t.is,i.is)(e)?JSON.stringify(Object.assign(Object.assign({},s),{expectedInProgressResultId:C.toNullable(e.expectedInProgressResultId),receivedInProgressResultId:e.receivedInProgressResultId})):n.is(e)?JSON.stringify(Object.assign(Object.assign({},s),{errorCode:e.capiError.error,errorSeverity:String(e.capiError.severity)})):(0,d.Rz)(e)}}(o||(o={}));var P=i(34349),U=i(12422),B=i(63764),N=i(14047),z=i(7903),F=i(69693);function j(e){return F.w.isRewriteOrQuickRewrite(e.mode)}function G(e){return F.w.isQuickReply(e.mode)}function M(e){return F.w.isPushRewrite(e.mode)}var D,V=i(3709),H=i(95195),L=i(8709);!function(e){const t={"Cheetah/_System/Push/SimplifyRewrite":{copiablePrompt:C.none,iconUrl:C.some("https://assets.grammarly.com/cheetah/v1/actions/simplify.svg"),label:"Simplify your text"},"Cheetah/_System/Push/ImproveParagraph":{copiablePrompt:C.none,iconUrl:C.some("https://assets.grammarly.com/cheetah/v1/actions/improve.svg"),label:"Improve your text"}};e.toPreviousText=function(e){return(0,d.zG)(e,C.fromPredicate((e=>e.alertPname in t)),C.map((e=>({kind:"writerExpert",suggestionId:e.alertId,pname:e.alertPname,text:e.replacementText}))))},e.getInitialResult=function(e){const i=H.left((new L.i).insert(e.replacementText));return(0,d.zG)(C.fromNullable(t[e.alertPname]),C.map((t=>({kind:"complete",id:N.x.Id.create(0),header:t,replacementDelta:i,text:e.replacementText,references:C.none,source:C.none,changesSummary:C.none,timestamp:Date.now(),isRephraseable:!1,primaryAction:C.some(N.x.PrimaryAction.insert),boundaryContextId:C.none}))))}}(D||(D={}));var K=i(26320),$=i(33290);const W={CheetahFetchSkills:new $.Cc("cheetah_fetch_skills"),CheetahSelectionContextUpdates:new $.Cc("cheetah_selection_context_updates")};var Z=i(63346),q=i(30816),Y=i(31699),X=i(32426),Q=i(4068),J=i(65602),ee=i(87683);const te=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function ie(e,t,i,n,r){let s,o,a,l,c,u,d,m,p,h,g,f,v;for(;r>=64;){for(s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],m=t[7],h=0;h<16;h++)g=n+4*h,e[h]=(255&i[g])<<24|(255&i[g+1])<<16|(255&i[g+2])<<8|255&i[g+3];for(h=16;h<64;h++)p=e[h-2],f=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,p=e[h-15],v=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,e[h]=(f+e[h-7]|0)+(v+e[h-16]|0);for(h=0;h<64;h++)f=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&d)|0)+(m+(te[h]+e[h]|0)|0)|0,v=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&o^s&a^o&a)|0,m=d,d=u,u=c,c=l+f|0,l=a,a=o,o=s,s=f+v|0;t[0]+=s,t[1]+=o,t[2]+=a,t[3]+=l,t[4]+=c,t[5]+=u,t[6]+=d,t[7]+=m,n+=64,r-=64}return n}class ne{constructor(){this.digestLength=32,this.blockSize=64,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(let e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()}update(e,t=e.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let i=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[i++],t--;64===this.bufferLength&&(ie(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(i=ie(this.temp,this.state,e,i,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[i++],t--;return this}finish(e){if(!this.finished){const e=this.bytesHashed,t=this.bufferLength,i=e/536870912|0,n=e<<3,r=e%64<56?64:128;this.buffer[t]=128;for(let e=t+1;e<r-8;e++)this.buffer[e]=0;this.buffer[r-8]=i>>>24&255,this.buffer[r-7]=i>>>16&255,this.buffer[r-6]=i>>>8&255,this.buffer[r-5]=i>>>0&255,this.buffer[r-4]=n>>>24&255,this.buffer[r-3]=n>>>16&255,this.buffer[r-2]=n>>>8&255,this.buffer[r-1]=n>>>0&255,ie(this.temp,this.state,this.buffer,0,r),this.finished=!0}for(let t=0;t<8;t++)e[4*t+0]=this.state[t]>>>24&255,e[4*t+1]=this.state[t]>>>16&255,e[4*t+2]=this.state[t]>>>8&255,e[4*t+3]=this.state[t]>>>0&255;return this}digest(){const e=new Uint8Array(this.digestLength);return this.finish(e),e}_saveState(e){for(let t=0;t<this.state.length;t++)e[t]=this.state[t]}_restoreState(e,t){for(let t=0;t<this.state.length;t++)this.state[t]=e[t];this.bytesHashed=t,this.finished=!1,this.bufferLength=0}}new Uint8Array(32);function re(e,t){switch(e.historyStatus){case z.z.HistoryStatus.restoreDisabled:return e.historyStatus;case z.z.HistoryStatus.unknown:case z.z.HistoryStatus.noHistory:case z.z.HistoryStatus.hasHistory:return void 0!==t?t>0?z.z.HistoryStatus.hasHistory:z.z.HistoryStatus.noHistory:z.z.HistoryStatus.unknown;case z.z.HistoryStatus.historyRequested:case z.z.HistoryStatus.historyRestored:return"started"===e.kind&&void 0!==e.results.find(N.x.isHistory)?z.z.HistoryStatus.historyRestored:z.z.HistoryStatus.restoreDisabled;default:(0,I.L0)(e.historyStatus)}}function se(e,t=!1){return(0,d.zG)(e.replacementDelta,H.fold(d.yR,(({preferVoice:e,generic:i,user:n})=>t?e===N.x.GeneratedTextVoice.generic?i:n:i)),(e=>(0,J.l)(e,"")))}function oe(e){return u.fj((()=>"started"===e.kind?H.right(e):H.left(new Error("Session not started"))))}function ae(e,t,i,n){var r;const s=(0,d.zG)(z.z.toStarted(i),C.fold((()=>[]),(e=>e.voiceProfile.roles)));return{kind:"newVoiceProfile",userName:e.userName,title:e.title,subTitle:e.subTitle,profiles:e.profiles,isEnabledByDefault:e.myVoiceIsEnabledByDefault.state,isEnabledByDefaultLabel:e.myVoiceIsEnabledByDefault.label,dialects:V.L.Dialect.all(),roles:(0,d.zG)(null!==(r=t.roles)&&void 0!==r?r:[],l.UI((e=>({id:V.L.Role.Id.create(e),label:e}))),(e=>e.length>0?e:s)),selectedDialect:(0,d.zG)(z.z.toStarted(i),C.fold((()=>V.L.Dialect.Id.create(n)),(e=>e.voiceProfile.selectedDialect))),selectedRole:(0,d.zG)(C.fromNullable(t.selectedRole),C.map((e=>e.trim())),C.filter((e=>""!==e)),C.map(V.L.Role.Id.create)),needsSetup:!1}}function le(e,t,i){var n,r;const s=(0,d.zG)(z.z.toStarted(t),C.map((e=>e.voiceProfile)),C.chain(V.L.toLegacyVoiceProfile),C.fold((()=>[]),(e=>e.styles))),o=(0,d.zG)(z.z.toStarted(t),C.fold((()=>[]),(e=>e.voiceProfile.roles))),a=(0,d.zG)(null!==(n=e.styles)&&void 0!==n?n:[],l.UI((e=>({id:V.L.Style.Id.create(e.button.label),label:e.button.label,iconUrl:e.button.iconUrl,tones:e.tones.map((e=>({id:V.L.Tone.Id.create(e.label),label:e.label,iconUrl:e.iconUrl,description:e.description}))),maxTones:e.maxTones,description:e.button.description}))),(e=>e.length>0?e:s)),c=V.L.Style.Id.create(e.selectedStyle),u=a.find((e=>V.L.Style.Id.eq.equals(e.id,c)));return{kind:"legacyVoiceProfile",styles:a,roles:(0,d.zG)(null!==(r=e.roles)&&void 0!==r?r:[],l.UI((e=>({id:V.L.Role.Id.create(e),label:e}))),(e=>e.length>0?e:o)),selectedStyle:c,selectedTonesPerStyle:(new Map).set(c,new Set(e.selectedTones.filter((e=>null==u?void 0:u.tones.map((e=>e.id.toString())).includes(e))))),selectedRole:(0,d.zG)(C.fromNullable(e.selectedRole),C.map((e=>e.trim())),C.filter((e=>""!==e)),C.map(V.L.Role.Id.create)),dialects:V.L.Dialect.all(),selectedDialect:(0,d.zG)(z.z.toStarted(t),C.fold((()=>V.L.Dialect.Id.create(i)),(e=>e.voiceProfile.selectedDialect))),needsSetup:e.needSetup}}function ce(e,t,i,n){return[...(0,d.zG)(e,l.UI((t=>O.aU.createFollowUpQuestionActionInputOrQuickActionInput(t,e,i,n))),l.oA),...t.map((e=>O.aU.SkillActionInput.fromSkill(e,i)))]}function ue(e,t){const i=(0,d.zG)(e.args,l.YM,C.map((t=>({id:O.aU.Id.create(e.id),kind:"userPrompt",arg:{id:O.pY.Id.create(t.name),kind:"string",label:t.label,hints:(0,d.zG)(C.fromNullable(t.hint),C.map((e=>({header:e.header,items:e.text}))))},generatesTextType:C.some(T.cX.Insertable),useReferences:C.none,omitReferenceIds:C.none}))));return C.isNone(i)&&t.warn("_extractUserPromptAction() - failed to extract user prompt action, received empty action args",{promptAction:e}),i}function de(e){return{kind:"quickRewrite",id:O.aU.Id.create(e.id),label:(0,Y.sanitize)(e.label,{ALLOWED_TAGS:ee.ap}),iconUrl:e.iconUrl,generatesTextType:C.fromNullable(e.generatesTextType)}}function me(e){return(0,d.zG)(C.fromNullable(e),C.map((e=>(0,Y.sanitize)(e,{ALLOWED_TAGS:[...ee.ap,"person"]}))),C.map((e=>e.trim())),C.filter((e=>e.length>0)))}function pe(e){return{kind:N.x.isComplete(e)?"regular":N.x.isHistory(e)?"history":(0,I.L0)(e),text:se(e)}}const he=C.fromNullable;function ge(e){switch(e){case F.w.ideation:return T.s2.Ideation;case F.w.rewrite:return T.s2.Rewrite;case F.w.quickRewrite:return T.s2.QuickRewrite;case F.w.quickReply:return T.s2.QuickReply;case F.w.pushRewrite:return T.s2.PushRewrite;default:return(0,d.Rz)(e)}}function fe(e){const t=(0,d.zG)(e,C.fromPredicate((e=>function(e){return F.w.isIdeation(e.mode)}(e)&&!!e.documentUrl)),C.map((e=>e.documentUrl)),C.chain(C.fromNullable),C.chain(ye),C.map((e=>({pageIdHash:e})))),i=(0,d.zG)(e,C.fromPredicate(G),C.map((e=>Q.H.toOuterContext(e.quickReplyContext))));return C.getMonoid((0,X.getFirstSemigroup)()).concat(t,i)}function ve(e){return(0,d.zG)(e.quickReplyContext,C.map(Q.H.toOuterContext))}function ye(e){var t;return(0,d.zG)(null!==(t=function(e){var t;return null===(t=e.match(/^https:\/\/docs.google.com\/[a-zA-Z0-9-_]+\/d\/([a-zA-Z0-9-_]+)/))||void 0===t?void 0:t[1]}(e))&&void 0!==t?t:function(e){var t;const i=null!==(t=e.match(/^https:\/\/([a-zA-Z0-9-_]+).atlassian.net\/wiki\/spaces\/[a-zA-Z0-9-_]+\/pages\/([0-9]+)/))&&void 0!==t?t:[];return i[1]&&i[2]?`${i[1]}:${i[2]}`:void 0}(e),C.fromNullable,C.map(be))}function be(e){const t=(new TextEncoder).encode(e);return q.Buffer.from(function(e){const t=(new ne).update(e),i=t.digest();return t.clean(),i}(t)).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var xe=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};class Se{constructor(e){var t,i,n,o,a;if(this._params=e,this._subs=new g.w.Keeper,this._session=A.h.create(z.z.Starting.initial),this._resultById=new Map,this._contextIdByResultId=new Map,this._contextById=new Map,this._historyResultIdByGetContextMessageId=new Map,this._contextMessageIdsTriggeredBySelectionChanges=new Set,this._stateBlobByContextId=new Map,this._initialReceivedContext=null,this._upstreamDialect=A.h.create(V.L.Dialect.Id.create(V.L.Dialect.Value.american)),this._cheetahAckIds=new Set,this._searchReferencesUrlsById=new Map,this._cheetahAckHandlers=new Array,this._resultTimeout=void 0,this._contextTimeout=void 0,this._historyTimeout=void 0,this._cheetahAckTimeout=void 0,this._historyAckHandler=void 0,this._skills=[],this._resultTimeoutMs=null!==(t=this._params.resultTimeoutMs)&&void 0!==t?t:2e4,this._contextTimeoutMs=null!==(i=this._params.contextTimeoutMs)&&void 0!==i?i:2e4,this._historyTimeoutMs=null!==(n=this._params.historyTimeoutMs)&&void 0!==n?n:2e4,this._cheetahAckTimeoutMs=null!==(o=this._params.cheetahAckTimeoutMs)&&void 0!==o?o:2e4,this._logger=null!==(a=this._params.logger)&&void 0!==a?a:new Z.W(Se.name),this.session=this._session.view(),this._handleCAPIMessage=e=>{switch(e.action){case"error":return this._handleError(e);case"cheetah":return this._handleCheetahAck(e);case"cheetah:setContext":return this._handleCheetahSetContext(e);case"cheetah:chunk":return this._handleCheetahChunk(e);case"cheetah:result":return this._handleCheetahResult(e);case"cheetah:error":return this._handleCheetahError(e);case"cheetah:setUserState":return this._handleCheetahSetUserState(e);case"cheetah:searchReferencesResult":return this._handleCheetahSearchReferencesResult(e);case"cheetah:invalidateContext":return this._getContext();case"cheetah:setHistory":return this._handleCheetahSetHistory(e);case"show_survey":return;default:return(0,d.Rz)(e)}},j(this._params.startSessionOptions)){const e=this._params.textEditorService.selectedRange.get();(0,d.zG)(e,C.fold((()=>this._init()),(e=>(0,K.t)("getText",this._params.textEditorService.getText(e),this._logger,(t=>{this._params.monitoringService.notify(s.GetTextSuccessful.create(this._params.startSessionOptions.mode,e,t)),this._init({selectedRange:e,selectedText:t})}),(t=>{this._logger.warn("getText() - failed to get text from host, defaulting to empty text",{selectedRange:e,error:t}),this._params.monitoringService.notify(r.GetTextFailed.create(this._params.startSessionOptions.mode,e,t)),this._init()})))))}else this._init()}_init(e){this._session.set({kind:"starting",mode:this._params.startSessionOptions.mode,selectedRange:C.fromNullable(null==e?void 0:e.selectedRange),selectedText:(0,d.zG)(C.fromNullable(null==e?void 0:e.selectedText),C.filter((e=>e.length>0))),quickReplyContext:C.fromNullable(G(this._params.startSessionOptions)?this._params.startSessionOptions.quickReplyContext:void 0),writingExpertContext:C.fromNullable(M(this._params.startSessionOptions)?this._params.startSessionOptions.writingExpertContext:void 0),historyStatus:z.z.HistoryStatus.unknown,error:C.none,textRevision:0}),this._subs.push(this._params.capiService.relevantInboundCAPIMessages.subscribe((e=>this._handleCAPIMessage(e)))),this._subs.push(this._params.userService.user.view("dialect").subscribe((e=>f.wW(this._upstreamDialect)(V.L.Dialect.Id.create(e))))),this._subs.push(this._upstreamDialect.subscribe((e=>this._handleUpstreamDialectChange(e)))),this._subs.push(this._session.subscribe((e=>this._logger.debug("Session updated:",e)))),this._subs.push(this._session.pipe((0,m.x)(((e,t)=>e.kind===t.kind)),(0,p.P)((e=>"started"===e.kind))).subscribe((()=>{this._params.trackingService.trackReadyToInteract()}))),this._params.selectionContextAvailability&&(this._subs.push(this._params.selectionContextAvailability.view("contextUpdatesClient").pipe(v.w((e=>e?this._params.textEditorService.selectedRange.pipe(y.T(1),b.oA,x.e(500),S.b((e=>{this._handleSelectedRangeUpdate(e)}))):k.E))).subscribe()),this._subs.push(this._params.selectionContextAvailability.view("contextUpdatesClient").pipe(v.w((e=>e?this._params.textEditorService.textUpdated.pipe(S.b((()=>{this._handleTextUpdated()}))):k.E))).subscribe())),this._startSession(this._params.startSessionOptions)}_startSession(e,t){(0,K.t)("flush",this._params.textEditorService.flush(),this._logger,(()=>{const i=j(e)?this._params.textEditorService.selectedRange.get():C.fromNullable(void 0),n=fe(e),r=C.fromNullable(M(e)?e.writingExpertContext:void 0),s={generationMode:ge(e.mode),selectedRange:C.toUndefined(i),outerContext:C.toUndefined(n),stateBlob:t,metadata:e.metadata,previousText:(0,d.zG)(r,C.chain(D.toPreviousText),C.toUndefined)};if(this._params.skillService){const e={skills:this._params.skillService.getSkills(),shouldShowSkills:(0,d.zG)(this._params.experimentService?this._params.experimentService.isGateEnabled(W.CheetahFetchSkills):u.F2(!1),u.Vn((e=>new Error(e))))};(0,K.t)("getSkills",a.Y(K.L)(e),this._logger,(({skills:e,shouldShowSkills:t})=>{this._params.monitoringService.notify(U.e.GetSkillsSuccessful.create(e)),t&&(this._skills=e,(0,d.zG)(z.z.toStarted(this._session.get()),C.filter((e=>!e.activeContext.availableActions.some((e=>"skillAction"===e.kind)))),_.bw((e=>this._session.set(Object.assign(Object.assign({},e),{activeContext:Object.assign(Object.assign({},e.activeContext),{availableActions:e.activeContext.availableActions.concat(this._skills.map((e=>O.aU.SkillActionInput.fromSkill(e,this._session.get().mode))))})}))))))}),(e=>this._params.monitoringService.notify(P.b.GetSkillsFailed.create(e))))}this._getContext(s)}))}_handleSelectedRangeUpdate(e){this._logger.debug("_handleSelectedRangeUpdate()",{selectedRange:e}),(0,K.t)("getText",this._params.textEditorService.getText(e),this._logger,(t=>{t.length?(this._session.modify((i=>(0,d.zG)(i,z.z.toStarted,C.fold((()=>i),(i=>Object.assign(Object.assign({},i),{mode:F.w.rewrite,activeContext:Object.assign(Object.assign({},i.activeContext),{kind:"pending",isBoundary:!0,textRevision:C.some(i.textRevision)}),selectedRange:C.some(e),selectedText:(0,d.zG)(C.some(t),C.filter((e=>e.length>0)))})))))),this._getContext(void 0,void 0,!0)):this._session.modify((t=>Object.assign(Object.assign({},t),{selectedRange:C.some(e),selectedText:C.none})))}))}_handleTextUpdated(){this._logger.debug("_handleTextUpdated()"),this._session.modify((e=>(0,d.zG)(e,z.z.toStarted,C.fold((()=>e),(e=>Object.assign(Object.assign({},e),{textRevision:e.textRevision+1}))))))}submitAction(e,t){this._logger.debug("submitAction()",{actionValue:e,selectedVoice:t}),this._submitAction(e,void 0,void 0,void 0,void 0,t)}setVoiceProfile(e){return this._logger.debug("setVoiceProfile()",{voiceProfileSelections:e}),(0,d.zG)(oe(this._session.get()),u.UI((t=>(this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),e),activeContext:Object.assign(Object.assign({},t.activeContext),{kind:"pending"})})),t))),u.tS((t=>(0,d.zG)(this._params.capiService.cheetahSetVoice({voice:{selectedStyle:e.selectedStyle,selectedTones:Array.from(e.selectedTonesPerStyle.get(e.selectedStyle)||[]),selectedRole:(0,d.zG)(e.selectedRole,C.toUndefined),needSetup:!1}}),u.Pd((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!V.L.Dialect.Id.eq.equals(t.voiceProfile.selectedDialect,e.selectedDialect))),u.tS((t=>t?a.g(u.qA)((0,d.zG)(this._params.capiService.set_context({documentContext:{dialect:e.selectedDialect}}),u.Vn((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,d.zG)(this._params.userService.setDialect(e.selectedDialect),u.Vn((e=>new Error(`CAPIService.setDialect error: ${e.message}`))))):u.of(null))),u.Pd((e=>(this._params.monitoringService.notify(r.SetVoiceProfileFailed.create(this._session.get().mode,e)),e)),d.Q1)))))}setNewVoiceProfile(e){var{selectedDialect:t}=e,i=xe(e,["selectedDialect"]);return this._logger.debug("setNewVoiceProfile()",{dialect:t,voiceProfile:i}),(0,d.zG)(oe(this._session.get()),u.UI((e=>(this._session.set(Object.assign(Object.assign({},e),{activeContext:Object.assign(Object.assign({},e.activeContext),{kind:"pending"})})),e))),u.tS((e=>(0,d.zG)(this._params.capiService.cheetahSetVoiceProfile({role:(0,d.zG)(i.selectedRole,C.toUndefined),isEnabledByDefault:i.isEnabledByDefault,profiles:i.profiles}),u.Pd((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!V.L.Dialect.Id.eq.equals(e.voiceProfile.selectedDialect,t))),u.tS((e=>e?a.g(u.qA)((0,d.zG)(this._params.capiService.set_context({documentContext:{dialect:t}}),u.Vn((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,d.zG)(this._params.userService.setDialect(t),u.Vn((e=>new Error(`CAPIService.setDialect error: ${e.message}`))))):u.of(null))),u.Pd((e=>(this._params.monitoringService.notify(r.SetNewVoiceProfileFailed.create(this._session.get().mode,e)),e)),d.Q1)))))}stopInProgressResult(){return this._logger.debug("stopInProgressResult()"),(0,d.zG)(this._session.get(),u.DT(z.z.isStartedWithInProgressResult,(()=>new Error("Session has no in-progress result."))),u.tS((e=>(this._clearResultRelatedTimeouts(),this._session.modify((t=>Object.assign(Object.assign({},t),{activeContext:(0,d.zG)(e.results.length>0?this._extractLatestResultContext(e):this._extractInitialContext(),C.getOrElse((()=>e.activeContext))),inProgressResult:N.x.isInProgressPending(e.inProgressResult.value)?C.some(Object.assign(Object.assign({},e.inProgressResult.value),{kind:"inProgressInterrupted"})):N.x.isInProgressInterrupted(e.inProgressResult.value)?e.inProgressResult:N.x.isInProgressOngoing(e.inProgressResult.value)?C.none:(0,I.L0)(e.inProgressResult.value)}))),(0,d.zG)(e.inProgressResult.value,C.fromPredicate(N.x.isInProgressOngoing),C.fold((()=>u.of(-1)),(e=>this._params.capiService.cheetahInterrupt({promptId:N.x.Id.toPrimitive(e.id)}))))))),u.Pd((e=>(this._params.monitoringService.notify(r.StopInProgressResultFailed.create(this._session.get().mode,e)),e)),d.Q1))}regenerateResult(e,t,i){this._logger.debug("regenerateResult()",{resultId:e,options:t,selectedVoice:i}),(0,d.zG)(z.z.toStarted(this._session.get()),_.ew((()=>this._logger.warn("regenerateResult() - trying to regenerate result with a session that is not `started`, skipping",{session:this._session.get(),resultId:e}))),C.chain((t=>(0,d.zG)(C.fromNullable(this._resultById.get(e)),C.filter(N.x.isComplete),C.filter((e=>e.isRephraseable)),C.map((e=>({session:t,result:e}))),_.ew((()=>{this._logger.warn("regenerateResult() - could not find a rephraseable result for provided result ID, skipping",{session:t,resultId:e}),this._params.monitoringService.notify(r.RegenerateResultFailed.create(this._session.get().mode,e,"not-found"))}))))),C.chain((({session:t,result:i})=>(0,d.zG)(a.Y(C.option)({resultSource:i.source,boundaryContextId:i.boundaryContextId}),C.map((({resultSource:e,boundaryContextId:n})=>({resultSource:e,boundaryContextId:n,resultText:se(i),session:t}))),_.ew((()=>{this._logger.warn("regenerateResult() - trying to regenerate result without source action or boundaryContext",{session:t,result:i}),this._params.monitoringService.notify(r.RegenerateResultFailed.create(t.mode,e,"no-source-action"))}))))),C.map((({resultSource:n,boundaryContextId:r,resultText:s,session:a})=>{const l=n.actionValue,u=C.getMonoid(c.jG()).concat,m=(0,d.zG)(l,C.fromPredicate(O.aU.isUserPromptActionValue),C.fold((0,d.a9)(l),(e=>Object.assign(Object.assign({},e),{omitReferenceIds:u(e.omitReferenceIds,t.omitReferenceIds)})))),p=this._contextIdByResultId.get(e);void 0===p&&this._params.monitoringService.notify(o.RegenerateResultContextNotFound.create(a.mode)),this._submitAction(m,n.contextId,p,r,{kind:"regular",text:s},i),this._params.trackingService.trackResultRephrase(p)})))}searchReferences(e){const t=this._session.get();"started"===t.kind?t.detectedReferences.has(e)||(this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(e,C.none)})),this._setupCheetahAckHandler("searchReferences",(t=>{this._searchReferencesUrlsById.set(t,e)})),(0,K.t)("cheetahSearchReferences",this._params.capiService.cheetahSearchReferences({url:e}),this._logger)):this._logger.warn("searchReferences() - trying to search a reference with a session that is not `started`, skipping",{session:t})}dismissResult(e){this._logger.debug("dismissResult()",{resultId:e});const t=this._session.get();let i=null;if("started"===t.kind){if(this._resultById.delete(e)){const n=t.results.findIndex((t=>t.id===e));i=t.results[n];let r=t.activeContext,s=t.activeBoundaryContext,o=null;if(0===n&&t.results.length>1){this._logger.debug("dismissResult() - dismissing latest result, will try to restore context from previous result",{session:t,resultId:e});const i=C.toUndefined(this._extractPreviousResultContext(t)),n=(0,d.zG)(this._extractPreviousResultBoundaryContext(t),C.alt((()=>C.fromNullable(this._initialReceivedContext))),C.toUndefined),a=C.toUndefined(this._extractLatestResultBoundaryContext(t));i?n!==a?(this._logger.debug("dismissResult() - previous result was for different boundary context, will keep currently active boundary context",{session:t,resultId:e}),r=t.activeBoundaryContext):(this._logger.debug("dismissResult() - found context for previous result, will restore its context",{session:t,resultId:e,previousResultContext:i}),r=i,n&&(s=n)):t.results[1]&&N.x.isHistory(t.results[1])&&(0,d.zG)(C.fromNullable(this._contextIdByResultId.get(t.results[1].id)),C.chain((e=>C.fromNullable(this._contextById.get(e)))),C.isNone)?o=t.results[1].id:this._logger.warn("dismissResult() - could not find context for previous result, context will not be updated",{session:t,resultId:e})}else 1===t.results.length&&(r=t.activeBoundaryContext);this._session.set(Object.assign(Object.assign({},t),{activeContext:Object.assign(Object.assign({},r),{kind:null!==o?"pending":r.kind,availableActions:o?[]:r.availableActions}),activeBoundaryContext:s,results:t.results.filter((t=>!N.x.Id.eq.equals(t.id,e)))}));const a=this._contextIdByResultId.get(e);this._params.trackingService.trackResultDismiss(a,N.x.isHistory(i)?e:void 0),"aiUsageNotification"===i.kind&&this._params.trackingService.trackAINotificationDismiss("document"),o&&this._getContext(void 0,o)}else this._logger.warn("dismissResult() - could not find result for provided result ID, skipping",{session:t,resultId:e})}else this._logger.warn("dismissResult() - trying to dismiss result with a session that is not `started`, skipping",{session:t,resultId:e})}dismissError(){this._logger.debug("dismissError()"),this._session.lens("error").set(C.none)}restoreHistory(){this._getHistory()}trackResultInsert(e,t=!1){this._logger.debug("trackResultInsert()",{resultId:e});const i=this._resultById.get(e);if(i){const n=this._contextIdByResultId.get(e);this._params.trackingService.trackResultInsert(n,N.x.isHistory(i)?i.id:void 0,t)}else this._logger.warn("trackResultInsert() - could not find result for provided result ID, skipping",{resultId:e})}trackResultCopy(e){this._logger.debug("trackResultCopy()",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.trackingService.trackResultCopy(i,N.x.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultCopy() - could not find result for provided result ID, skipping",{resultId:e})}_trackResultGenerationCompleted(e){this._logger.debug("trackResultGenerationCompleted()",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.trackingService.trackResultGenerationCompleted(i,N.x.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultGenerationCompleted() - could not find result for provided result ID, skipping",{resultId:e})}trackResultOffensive(e){this._logger.debug("trackResultOffensive()",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.trackingService.trackResultOffensive(i,N.x.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultOffensive() - could not find result for provided result ID, skipping",{resultId:e})}trackActionsOffensive(){this._logger.debug("trackActionsOffensive()");const e=this._session.get();if("started"!==e.kind)return this._logger.warn("trackActionsOffensive() - tracking actions as offensive with a session that is not `started`, skipping");this._params.trackingService.trackActionsOffensive(e.activeContext.id)}getContextById(e){return C.fromNullable(this._contextById.get(e))}dismissActiveBoundaryContext(){if(this._logger.debug("dismissActiveBoundaryContext()"),(0,d.zG)(this._session.get(),z.z.toStarted,C.filter((e=>e.activeContext.id===e.activeBoundaryContext.id)),C.fold(d.W8,d.jv)))return this._logger.warn("dismissActiveBoundaryContext() - there are results within this boundary, can't remove");const e=C.toNullable((0,d.zG)(this._session.get(),z.z.toStarted,C.chain((e=>this._extractLatestResultContext(e))))),t=C.toNullable((0,d.zG)(this._session.get(),z.z.toStarted,C.chain((e=>this._extractLatestResultBoundaryContext(e))),C.alt((()=>this._extractInitialContext()))));this._session.modify((i=>(0,d.zG)(i,z.z.toStarted,C.fold((()=>i),(i=>e&&t?Object.assign(Object.assign({},i),{mode:i.results.length?i.mode:F.w.ideation,activeContext:e,activeBoundaryContext:t}):Object.assign(Object.assign({},i),{kind:"starting",activeContext:Object.assign(Object.assign({},i.activeContext),{selection:C.none,kind:"pending"}),activeBoundaryContext:void 0,selectedRange:C.none,selectedText:C.none})))))),e&&t||this._getContext()}dispose(){this._subs.dispose()}_getContext(e,t,i=!1){this._logger.debug("_getContext()",{data:e,fetchContextForHistoryCardId:t}),this._setupCheetahAckHandler("getContext",(e=>{this._setupContextTimeout("getContext"),void 0!==t&&this._historyResultIdByGetContextMessageId.set(e,t),i&&this._contextMessageIdsTriggeredBySelectionChanges.add(e)}));const n=this._session.get();(0,K.t)("cheetahGetContext",this._params.capiService.cheetahGetContext(null!=e?e:{generationMode:ge(i?F.w.rewrite:n.mode),selectedRange:C.toUndefined(n.selectedRange),outerContext:C.toUndefined(ve(n)),stateBlob:(0,d.zG)(z.z.toStarted(n),C.map((e=>e.activeContext)),C.fold(d.r5,(e=>this._stateBlobByContextId.get(e.id)))),previousText:!i&&"started"===n.kind&&n.results.length>0&&N.x.isStandardCompletedResult(n.results[0])?pe(n.results[0]):void 0}),this._logger,(()=>this._params.monitoringService.notify(s.GetContextSuccessful.create(this._session.get().mode))),(()=>this._params.monitoringService.notify(r.GetContextFailed.create(this._session.get().mode))))}_handleCheetahSetContext(e){var t,i;this._logger.debug("_handleCheetahSetContext()",{message:e}),this._clearContextTimeout();const n=this._session.get(),r=(0,d.zG)(C.fromNullable(null===(t=e.context)||void 0===t?void 0:t.voiceProfileSettings),C.fold((()=>le(e.context.voice,n,this._upstreamDialect.get())),(t=>ae(t,e.context.voice,n,this._upstreamDialect.get())))),s={id:R._.Id.create(e.context.id),availableActions:ce(e.context.availableActions,this._skills,n.mode,n.selectedText),userPromptAction:ue(e.context.promptAction,this._logger),quickRewriteAction:de(e.context.quickRewriteAction),intent:me(e.context.intent),documentOverview:he(e.context.documentOverview),specialView:C.fromNullable(e.context.specialView),selection:this._historyResultIdByGetContextMessageId.has(e.promptId)?C.none:(0,d.zG)(a.Y(C.option)({text:n.selectedText,range:n.selectedRange})),textRevision:(null===(i=this._params.selectionContextAvailability)||void 0===i?void 0:i.get().contextUpdatesClient)?C.some(n.textRevision):C.none},o=0===this._contextById.size,l=e.progressMessage?Object.assign(Object.assign({},s),{kind:"pending",isBoundary:!1}):Object.assign(Object.assign({},s),{kind:"received",isBoundary:o||this._contextMessageIdsTriggeredBySelectionChanges.has(e.promptId)});if(this._shouldSkipContextUpdate(e))return void this._logger.debug("skipping context update for missing history card");0===this._contextById.size&&R._.isReceived(l)&&(this._initialReceivedContext=l),this._contextById.set(l.id,l),this._stateBlobByContextId.set(l.id,e.context.stateBlob),this._bindContextToHistoryCardIfNeeded(e,l.id);const c=(0,d.zG)(n.writingExpertContext,C.chain(D.getInitialResult),_.bw((e=>{this._resultById.set(e.id,e),this._contextIdByResultId.set(e.id,l.id)})),C.fold((()=>[]),(e=>[e])));if(this._session.set(Object.assign(Object.assign({},n),{kind:"started",voiceProfile:r,activeContext:l,inProgressResult:"started"===n.kind?n.inProgressResult:C.none,results:"started"===n.kind?n.results:c,detectedReferences:"started"===n.kind?n.detectedReferences:new Map,activeBoundaryContext:l.isBoundary?l:"started"===n.kind?n.activeBoundaryContext:l})),o&&F.w.isQuickRewrite(n.mode)){const t=O.aU.QuickRewriteActionValue.fromInput(de(e.context.quickRewriteAction));this._logger.debug("_handleCheetahSetContext() - received initial context for quick rewrite session, submitting quick rewrite action",{session:n,message:e,quickRewriteAction:t}),this._submitAction(t)}}_shouldSkipContextUpdate(e){return(0,d.zG)(C.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),C.fold(d.jv,(e=>(0,d.zG)(z.z.toStarted(this._session.get()),C.map((e=>e.results)),C.fold(d.W8,(t=>!t.some((t=>t.id===e))))))))}_bindContextToHistoryCardIfNeeded(e,t){(0,d.zG)(C.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),C.filter((e=>(0,d.zG)(C.fromNullable(this._contextIdByResultId.get(e)),C.fold(d.W8,(e=>void 0===this._contextById.get(e)))))),_.bw((e=>this._contextIdByResultId.set(e,t))))}_handleCheetahSetUserState(e){this._logger.debug("_handleCheetahUserState()",{message:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{historyStatus:re(t,e.state.historyItems)})))}_getHistory(){if(this._logger.debug("_getHistory()"),void 0!==this._historyAckHandler)return this._logger.warn("_getHistory() called when a cheetah:getHistory request hasn't been ack'ed yet, skipping");this._historyAckHandler=()=>{this._historyAckHandler=void 0,this._setupHistoryTimeout()},this._setupCheetahAckHandler("getHistory",this._historyAckHandler),this._session.lens("historyStatus").set(z.z.HistoryStatus.historyRequested),(0,K.t)("cheetahGetHistory",this._params.capiService.cheetahGetHistory(),this._logger,(()=>this._params.monitoringService.notify(s.GetHistorySuccessful.create(this._session.get().mode))),(()=>this._params.monitoringService.notify(r.GetHistoryFailed.create(this._session.get().mode))))}_handleCheetahSetHistory(e){void 0!==this._historyAckHandler&&(this._removeCheetahAckHandler(this._historyAckHandler),this._historyAckHandler=void 0),this._clearHistoryTimeout();const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahSetHistory() - trying to handle `cheetah:setHistory` result with a session that is not `started`, skipping",{session:t});(0,d.zG)(e.cards,l.UI(N.x.History.createFromCard),l.GY,c.c2,C.fold((()=>this._session.lens("historyStatus").set(z.z.HistoryStatus.noHistory)),(e=>{e.forEach((e=>this._resultById.set(e.id,e))),this._session.set(Object.assign(Object.assign({},t),{activeContext:Object.assign(Object.assign({},t.activeContext),{kind:"pending",textRevision:C.none,availableActions:[],selection:C.none}),historyStatus:z.z.HistoryStatus.historyRestored,results:[...t.results,...e],selectedRange:C.none,selectedText:C.none})),this._getContext(void 0,e[0].id)})))}_handleCheetahChunk(e){this._logger.debug("_handleCheetahChunk()",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahChunk() - received chunk with a session that is not `started`, skipping",{session:t,message:e});const i=N.x.Id.create(e.promptId);(0,d.zG)(t.inProgressResult,C.filter(N.x.isInProgressOngoing),C.filter((e=>N.x.Id.eq.equals(e.id,i))),C.fold((()=>{const e=(0,d.zG)(t.inProgressResult,C.filter(N.x.isInProgressOngoing),C.map((e=>e.id)));this._params.monitoringService.notify(o.UnexpectedChunkReceived.create(this._session.get().mode,e,i))}),(i=>{this._clearResultRelatedTimeouts(),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:C.some(Object.assign(Object.assign({},i),{text:i.text+e.token}))})),this._setupResultTimeout()})))}_handleCheetahResult(e){this._logger.debug("_handleCheetahResult()",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahResult() - received result with a session that is not `started`, skipping",{session:t,message:e});const i=N.x.Id.create(e.promptId);(0,d.zG)(t.inProgressResult,C.filter(N.x.isInProgressOngoing),C.filter((e=>N.x.Id.eq.equals(e.id,i))),C.fold((()=>{const e=(0,d.zG)(t.inProgressResult,C.filter(N.x.isInProgressOngoing),C.map((e=>e.id)));this._params.monitoringService.notify(o.UnexpectedResultReceived.create(this._session.get().mode,e,i))}),(i=>{var r,s,o,a;if(this._clearResultRelatedTimeouts(),e.error||!e.text||""===e.text.plain){const i=e.error?n.create(e.error):n.createEmptyResultError();this._logger.warn("_handleCheetahResult() - received result with error, adding error to session",{session:t,message:e,error:i}),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:C.none,error:C.some(i)}))}else if(e.text.interrupted)this._logger.debug("_handleCheetahResult() - received result with interrupted text, skipping",{session:t,message:e});else{let n,l,c,u;if("aiUsageAlert"===(null===(s=null===(r=e.context)||void 0===r?void 0:r.specialView)||void 0===s?void 0:s.kind))n=N.x.AIUsageNotification.fromInProgressResult(i,e.text.plain);else{const t=(0,d.zG)(i.source,C.map((e=>e.actionValue.generatesTextType)),C.filter(_.FX(T.cX.Insertable)),C.map((()=>N.x.PrimaryAction.insert))),r=C.isSome(t);n=Object.assign(Object.assign({},i),{text:e.text.plain,kind:"complete",timestamp:Date.now(),replacementDelta:N.x.ResultDelta.createFromResultMessage(e),primaryAction:t,isRephraseable:r,references:(0,d.zG)(C.fromNullable(e.references),C.map((t=>t.map((t=>{var i;return Object.assign(Object.assign({},t),{id:B.s.Id.create(t.id),url:C.fromNullable(t.url),contextText:(0,d.zG)(C.fromNullable(null===(i=e.metadata)||void 0===i?void 0:i.knowledge_engine_references),C.chainNullableK((e=>{const i=Array.isArray(e)?e.find((e=>e.id===t.id)):void 0,n=null==i?void 0:i.contextText;return"string"==typeof n?n:void 0})))})}))))),changesSummary:C.fromNullable(e.changesSummary)})}this._logger.debug("_handleCheetahResult() - received complete result, saving complete result into history",{session:t,message:e,result:n}),e.context?(c=(null===(o=e.context)||void 0===o?void 0:o.voiceProfileSettings)?ae(null===(a=e.context)||void 0===a?void 0:a.voiceProfileSettings,e.context.voice,t,this._upstreamDialect.get()):le(e.context.voice,t,this._upstreamDialect.get()),l={kind:"received",id:R._.Id.create(e.context.id),availableActions:ce(e.context.availableActions,this._skills,t.mode,t.selectedText),userPromptAction:ue(e.context.promptAction,this._logger),intent:me(e.context.intent),documentOverview:he(e.context.documentOverview),specialView:C.fromNullable(e.context.specialView),selection:this._historyResultIdByGetContextMessageId.has(e.promptId)?C.none:(0,d.zG)(i.source,C.chain((({contextId:e})=>(0,d.zG)(C.fromNullable(this._contextById.get(e)),C.chain((({selection:e})=>e)))))),isBoundary:!1,textRevision:(0,d.zG)((0,d.zG)(i.boundaryContextId,C.chain((e=>C.fromNullable(this._contextById.get(e)))),C.chain((({textRevision:e})=>e))))},u=e.context.stateBlob,this._logger.debug("_handleCheetahResult() - received result with context, will update voice profile and context accordingly",{session:t,message:e,voiceProfile:c,context:l})):(this._logger.warn("_handleCheetahResult() - received result without context, keeping latest voice profile and context",{session:t,message:e}),c=t.voiceProfile,l=t.activeContext,u=this._stateBlobByContextId.get(t.activeContext.id)),this._contextById.set(l.id,l),void 0!==u&&this._stateBlobByContextId.set(l.id,u),this._resultById.set(n.id,n),this._contextIdByResultId.set(n.id,l.id),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:c,activeContext:l,inProgressResult:C.none,results:[n,...t.results]})),this._trackResultGenerationCompleted(n.id)}})))}_handleCheetahSearchReferencesResult(e){const t=this._session.get();if("started"===t.kind){const i=this._searchReferencesUrlsById.get(e.promptId);if(i){const n=e.references[0];n&&this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(i,C.some(B.s.create(n)))}))}else this._logger.warn("_handleCheetahSearchReferencesResult() - trying to handle a search references result that did not have a corresponding cheetah:searchReferences request, skipping",{message:e})}else this._logger.warn("_handleCheetahSearchReferencesResult() - trying to handle a search references result with a session that is not `started`, skipping",{session:t})}_handleCheetahError(e){this._logger.debug("_handleCheetahError",{message:e}),this._clearAllTimeouts();const t=n.create(e.error);this._logger.warn("_handleCheetahError - received error, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none,error:C.some(t)})))}_handleUpstreamDialectChange(e){this._logger.debug("_handleUpstreamDialectChange()",{upstreamDialect:e});const t=this._session.get();if("started"===t.kind){const i=V.L.Dialect.Id.create(e);this._logger.debug("_handleUpstreamDialectChange() - dialect changed on upstream services, updating selected dialect on voice profile",{session:t,selectedDialect:i}),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),{selectedDialect:i})}))}}_handleCheetahAck(e){this._logger.debug("_handleCheetahAck()",{message:e}),this._clearCheetahAckTimeout(),this._cheetahAckIds.add(e.id);const t=this._cheetahAckHandlers.length>0?this._cheetahAckHandlers[0]:void 0;t&&(this._logger.debug("_handleCheetahAck() - extracting `cheetah:ack` handler from queue and executing it",{message:e,cheetahAckHandlers:this._cheetahAckHandlers}),this._cheetahAckHandlers=this._cheetahAckHandlers.slice(1),t(e.id))}_handleError(e){if(this._cheetahAckIds.has(e.id))if(this._clearAllTimeouts(),e.error===h.jK.SESSION_NOT_INITIALIZED){const t=(0,d.zG)(z.z.toStarted(this._session.get()),C.map((e=>this._stateBlobByContextId.get(e.activeContext.id))),C.toUndefined);this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none}))),this._startSession(this._params.startSessionOptions,t),this._params.monitoringService.notify(o.CAPIErrorHandled.create(this._session.get().mode,e))}else{const t=n.createCriticalError((0,d.zG)(z.z.toStarting(this._session.get()),C.isSome));this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none,error:C.some(t)}))),this._params.monitoringService.notify(r.CAPIErrorUnhandled.create(this._session.get().mode,e))}else this._params.monitoringService.notify(r.CAPIErrorUnhandled.create(this._session.get().mode,e))}_submitAction(e,t,i,n,o,a){var l;this._logger.debug("_submitAction()",{actionValue:e,contextId:t,triggerContextId:i,boundaryContextId:n,previousText:o,selectedVoice:a});const m=this._session.get();if("started"===m.kind){const p=null!=t?t:m.activeContext.id,h=null!=n?n:m.activeBoundaryContext.id,g=this._stateBlobByContextId.get(p);if(void 0===g)return this._logger.warn("_submitAction() - cannot find state blob for context ID, skipping",{session:m,contextId:p,triggerContextId:i,contextStateBlob:g});const f="aiUsageNotification"===(null===(l=m.results[0])||void 0===l?void 0:l.kind)?m.results.slice(1):m.results;this._session.set(Object.assign(Object.assign({},m),{results:f,historyStatus:z.z.HistoryStatus.restoreDisabled,activeContext:Object.assign(Object.assign({},m.activeContext),{kind:"pending"}),inProgressResult:C.isSome(e.generatesTextType)?C.some({kind:"inProgressPending",header:{label:O.aU.isUserPromptActionValue(e)?e.arg.value:e.label,iconUrl:O.aU.isUserPromptActionValue(e)||""===e.iconUrl.trim()?C.none:C.some(e.iconUrl),copiablePrompt:O.aU.isUserPromptActionValue(e)&&""!==e.arg.value.trim()?C.some(e.arg.value):C.none},text:"",source:C.some({contextId:p,actionValue:e}),boundaryContextId:C.some(h)}):C.none,error:C.none})),this._setupCheetahAckHandler("action",(e=>{(0,d.zG)(z.z.toStarted(this._session.get()),C.chain((e=>e.inProgressResult)),C.filter((0,E.Kg)(N.x.isInProgressPending,N.x.isInProgressInterrupted)),C.fold((()=>(this._logger.warn("received `cheetah:ack` related to in-progress-pending result but we don't have an in-progress-pending result, skipping",{ackId:e}),u.of(void 0))),(t=>{if(N.x.isInProgressInterrupted(t))return this._logger.info("received `cheetah:ack` related to in-progress-interrupted result, sending `cheetah:interrupt`",{ackId:e}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none}))),this._params.capiService.cheetahInterrupt({promptId:e});if(N.x.isInProgressPending(t)){this._setupContextTimeout("action"),this._setupResultTimeout();const i=Object.assign(Object.assign({},t),{kind:"inProgressOngoing",id:N.x.Id.create(e)});return this._logger.debug("received `cheetah:ack` related to in-progress-pending result, transitioning result to in-progress-ongoing",{ackId:e,inProgressResult:i}),this._resultById.set(i.id,i),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.some(i)}))),u.of(void 0)}(0,I.L0)(t)})))()}));const v=Object.assign({contextId:p,triggerContextId:null!=i?i:m.activeContext.id,actionId:e.id,args:O.aU.isUserPromptActionValue(e)?[{name:e.arg.id,value:e.arg.value}]:(0,d.zG)(c.c2(e.args),C.fold((()=>[]),(e=>e.map((e=>({name:e.id,value:e.value})))))),stateBlob:g,previousText:null!=o?o:m.results.length>0&&N.x.isStandardCompletedResult(m.results[0])?pe(m.results[0]):void 0},a?{metadata:{selectedVoice:a}}:null),y=(0,d.zG)(e,C.fromPredicate(O.aU.isUserPromptActionValue),C.fold((0,d.a9)(v),(e=>Object.assign(Object.assign({},v),{useReferences:C.toUndefined(e.useReferences),omitReferenceIds:C.toUndefined(e.omitReferenceIds)}))));this._logger.debug("_submitAction() - sending `cheetah:action` to CAPI",{data:y}),(0,K.t)("cheetahAction",this._params.capiService.cheetahAction(y),this._logger,(()=>this._params.monitoringService.notify(s.ActionSuccessful.create(this._session.get().mode,e.id))),(()=>this._params.monitoringService.notify(r.ActionFailed.create(this._session.get().mode,e.id))))}else this._logger.warn("_submitAction() - submitting action with a session that is not `started`, skipping",{session:m,actionValue:e,contextId:t})}_extractLatestResultContext(e){return this._extractContextFromResults(e,0)}_extractLatestResultBoundaryContext(e){return this._extractBoundaryContextFromResults(e,0)}_extractPreviousResultContext(e){return this._extractContextFromResults(e,1)}_extractPreviousResultBoundaryContext(e){return this._extractBoundaryContextFromResults(e,1)}_extractContextFromResults(e,t){const i=(0,d.zG)(C.fromNullable(e.results[t]),C.map((e=>e.id)),C.chain((e=>C.fromNullable(this._contextIdByResultId.get(e)))),C.chain((e=>C.fromNullable(this._contextById.get(e)))));return C.isNone(i)&&this._logger.warn("_extractContextFromResults() - could not find context for result",{session:e,resultIndex:t}),i}_extractBoundaryContextFromResults(e,t){return(0,d.zG)(C.fromNullable(e.results[t]),C.filter(N.x.isComplete),C.chain((({boundaryContextId:e})=>e)),C.chain((e=>C.fromNullable(this._contextById.get(e)))),_.ew((()=>{this._logger.warn("_extractBoundaryContext() - could not find boundary context for result index")})))}_extractInitialContext(){return null!==this._initialReceivedContext?C.some(this._initialReceivedContext):(this._logger.warn("_extractInitialContext() - could not find initial context"),C.none)}_setupResultTimeout(){this._clearResultTimeout(),this._resultTimeout=w.H(this._resultTimeoutMs).subscribe((()=>{this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none,error:C.some(n.createCriticalError((0,d.zG)(z.z.toStarting(this._session.get()),C.isSome)))}))),this._params.monitoringService.notify(r.WaitForResultTimeout.create(this._session.get().mode))}))}_setupContextTimeout(e){this._logger.debug("_setupContextTimeout()",{sourceCommand:e}),this._clearContextTimeout(),this._contextTimeout=w.H(this._contextTimeoutMs).subscribe((()=>{const t=n.createCriticalError((0,d.zG)(z.z.toStarting(this._session.get()),C.isSome));this._logger.warn("waited too long to receive `cheetah:setContext`, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none,error:C.some(t)}))),this._params.monitoringService.notify(r.WaitForContextTimeout.create(this._session.get().mode,e))}))}_setupHistoryTimeout(){this._clearHistoryTimeout(),this._historyTimeout=w.H(this._historyTimeoutMs).subscribe((()=>{const e=n.createCriticalError((0,d.zG)(z.z.toStarting(this._session.get()),C.isSome));this._logger.warn("waited too long to receive `cheetah:setHistory`, adding error to session",{error:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{inProgressResult:C.none,error:C.some(e)}))),this._params.monitoringService.notify(r.WaitForHistoryTimeout.create(this._session.get().mode))}))}_setupCheetahAckTimeout(e){this._logger.debug("_setupCheetahAckTimeout()",{sourceCommand:e}),this._clearCheetahAckTimeout(),this._cheetahAckTimeout=w.H(this._cheetahAckTimeoutMs).subscribe((()=>{const t=n.createCriticalError((0,d.zG)(z.z.toStarting(this._session.get()),C.isSome));this._logger.warn("waited too long to receive an ACK for a `cheetah:*` command, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:C.none,error:C.some(t)}))),this._params.monitoringService.notify(r.WaitForAckTimeout.create(this._session.get().mode,e))}))}_clearResultTimeout(){var e;null===(e=this._resultTimeout)||void 0===e||e.unsubscribe(),this._resultTimeout=void 0}_clearContextTimeout(){var e;null===(e=this._contextTimeout)||void 0===e||e.unsubscribe(),this._contextTimeout=void 0}_clearHistoryTimeout(){var e;null===(e=this._historyTimeout)||void 0===e||e.unsubscribe(),this._historyTimeout=void 0}_clearCheetahAckTimeout(){var e;null===(e=this._cheetahAckTimeout)||void 0===e||e.unsubscribe(),this._cheetahAckTimeout=void 0}_clearResultRelatedTimeouts(){this._clearContextTimeout(),this._clearResultTimeout(),this._clearCheetahAckTimeout()}_clearAllTimeouts(){this._clearResultTimeout(),this._clearContextTimeout(),this._clearHistoryTimeout(),this._clearCheetahAckTimeout()}_setupCheetahAckHandler(e,t){this._setupCheetahAckTimeout(e),this._cheetahAckHandlers.push(t)}_removeCheetahAckHandler(e){this._cheetahAckHandlers=this._cheetahAckHandlers.filter((t=>t!==e)),0===this._cheetahAckHandlers.length&&this._clearCheetahAckTimeout()}}},84403:(e,t,i)=>{i.d(t,{c:()=>u});var n,r=i(57050),s=i(22232),o=i(5114),a=i(71249);!function(e){let t,i,n,l,c,u,d,m,p;!function(e){let t;!function(e){e.rephrase="rephrase",e.dismiss="dismiss",e.insert="insert",e.offensive="offensive",e.copy="copy",e.generationCompleted="generationCompleted"}(t=e.UserAction||(e.UserAction={}))}(t=e.Result||(e.Result={})),function(e){let t;!function(e){e.open="open",e.skip="skip",e.openFromBanner="openFromBanner",e.keepVoiceTag="keepTag",e.removeVoiceTag="removeTag",e.toggleToMyVoice="toggleToMyVoice",e.toggleToNeutral="toggleToNeutral"}(t=e.UserAction||(e.UserAction={}))}(i=e.VoiceProfile||(e.VoiceProfile={})),function(e){let t;!function(e){e.openStore="openStore",e.offensive="offensive"}(t=e.UserAction||(e.UserAction={}))}(n=e.Actions||(e.Actions={})),function(e){let t;!function(e){e.search="search"}(t=e.UserAction||(e.UserAction={}))}(l=e.Prompt||(e.Prompt={})),function(e){let t;!function(e){e.hover="hover",e.click="click"}(t=e.UserAction||(e.UserAction={}))}(c=e.UsageInfo||(e.UsageInfo={})),function(e){let t;!function(e){e.view="view"}(t=e.UserAction||(e.UserAction={}))}(u=e.HistoryButton||(e.HistoryButton={})),function(e){let t;!function(e){e.view="view",e.skip="skip",e.next="next"}(t=e.UserAction||(e.UserAction={}))}(d=e.Onboarding||(e.Onboarding={})),function(e){let t;!function(e){e.close="close",e.readyToInteract="readyToInteract"}(t=e.UserAction||(e.UserAction={}))}(m=e.Assistant||(e.Assistant={})),function(e){let t;!function(e){e.dontShowOnDocument="dontShowOnDocument",e.dontShowForever="dontShowForever"}(t=e.UserAction||(e.UserAction={}))}(p=e.AIUsageNotification||(e.AIUsageNotification={})),e.getComponentId=function(e,t,i,l={}){const c=(0,r.zG)(e.kind,(t=>{switch(t){case"result":return"card";case"voiceProfile":return"voice";case"actions":return e.userAction===n.UserAction.openStore?"group":"card";case"assistant":return"widget";case"onboardingPromptsTooltip":return"onboardingPromptTooltip";case"onboardingReviewTooltip":return"onboardingReviewtextTooltip";case"usageInfo":case"historyButton":case"prompt":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":return t;default:return(0,s.L0)(t)}}));return(0,r.zG)(o.fromNullable(i),o.map((e=>`cheetah:history-card:${e}`)),o.getOrElse((()=>`cheetah:${c}${t?`:${t}`:""}`)),(u=l,e=>(0,r.zG)(Object.entries(u),a.u4(e,((e,[t,i])=>{const n=e.includes("?")?"&":"?";return e+`${n}${t}=${i}`})))));var u},e.getUserAction=function(e){return(0,r.zG)(e.kind,(t=>{switch(t){case"actions":return e.userAction===n.UserAction.openStore?"All Ideas":e.userAction;case"assistant":return e.userAction===m.UserAction.close?"dismiss":e.userAction;case"result":case"voiceProfile":case"prompt":case"usageInfo":case"historyButton":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingPromptsTooltip":case"onboardingReviewTooltip":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":return e.userAction;default:return(0,s.L0)(t)}}))}}(n||(n={}));var l=i(26320),c=i(63346);class u{constructor(e,t=new c.W(u.name)){this._capiService=e,this._logger=t}trackResultInsert(e,t,i=!1){this._logger.debug("trackResultInsert()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultInsert() - tracking result insert without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.insert},e,t,{withVoiceProfile:i})}trackResultOffensive(e,t){this._logger.debug("trackResultOffensive()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultOffensive() - tracking result offensive without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.offensive},e,t)}trackResultDismiss(e,t){this._logger.debug("trackResultDismiss()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultDismiss() - tracking result dismiss without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.dismiss},e,t)}trackResultRephrase(e){this._logger.debug("trackResultRephrase()",{contextId:e}),e||this._logger.warn("trackResultRephrase() - tracking result rephrase without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.rephrase},e)}trackResultCopy(e,t){this._logger.debug("trackCopy()"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.copy},e,t)}trackResultGenerationCompleted(e,t){this._logger.debug("trackResultGenerationCompleted()"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.generationCompleted},e,t)}trackVoiceProfileOpen(e){this._logger.debug("trackVoiceProfileOpen()",{source:e}),this._trackUxInteraction({kind:"voiceProfile",userAction:"toolbar"===e?n.VoiceProfile.UserAction.open:n.VoiceProfile.UserAction.openFromBanner})}trackVoiceProfileSkip(){this._logger.debug("trackVoiceProfileSkip()"),this._trackUxInteraction({kind:"voiceProfile",userAction:n.VoiceProfile.UserAction.skip})}trackActionsOpenStore(){this._logger.debug("trackActionsOpenStore()"),this._trackUxInteraction({kind:"actions",userAction:n.Actions.UserAction.openStore})}trackActionsOffensive(e){this._logger.debug("trackActionsOffensive()"),e||this._logger.warn("trackActionsOffensive() - tracking actions offensive without context"),this._trackUxInteraction({kind:"actions",userAction:n.Actions.UserAction.offensive},e)}trackPromptSearch(){this._logger.debug("trackPromptSearch()"),this._trackUxInteraction({kind:"prompt",userAction:n.Prompt.UserAction.search})}trackUsageInfoClick(){this._logger.debug("trackUsageInfoClick()"),this._trackUxInteraction({kind:"usageInfo",userAction:n.UsageInfo.UserAction.click})}trackUsageInfoHover(){this._logger.debug("trackUsageInfoHover()"),this._trackUxInteraction({kind:"usageInfo",userAction:n.UsageInfo.UserAction.hover})}trackHistoryButtonView(){this._logger.debug("trackHistoryButtonView()"),this._trackUxInteraction({kind:"historyButton",userAction:n.HistoryButton.UserAction.view})}trackOnboardingPopupView(){this._logger.debug("trackOnboardingPopupView()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:n.Onboarding.UserAction.view})}trackOnboardingPopupSkip(){this._logger.debug("trackOnboardingPopupSkip()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:n.Onboarding.UserAction.skip})}trackOnboardingPopupNext(){this._logger.debug("trackOnboardingPopupNext()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:n.Onboarding.UserAction.next})}trackBTSOnboardingPopupView(){this._logger.debug("trackBTSOnboardingPopupView()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:n.Onboarding.UserAction.view})}trackBTSOnboardingPopupSkip(){this._logger.debug("trackBTSOnboardingPopupSkip()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:n.Onboarding.UserAction.skip})}trackBTSOnboardingPopupNext(){this._logger.debug("trackBTSOnboardingPopupNext()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:n.Onboarding.UserAction.next})}trackOnboardingPromptsTooltipView(){this._logger.debug("trackOnboardingPromptsTooltipView()"),this._trackUxInteraction({kind:"onboardingPromptsTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingReviewTooltipView(){this._logger.debug("trackOnboardingReviewTooltipView()"),this._trackUxInteraction({kind:"onboardingReviewTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingRewriteTooltipView(){this._logger.debug("trackOnboardingRewriteTooltipView()"),this._trackUxInteraction({kind:"onboardingRewriteTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingKnowledgeHubTooltipView(){this._logger.debug("trackOnboardingRewriteTooltipView()"),this._trackUxInteraction({kind:"onboardingKnowledgeHubTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingReferencesTooltipView(){this._logger.debug("trackOnboardingReferencesTooltipView()"),this._trackUxInteraction({kind:"onboardingReferencesTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingHistoryTooltipView(){this._logger.debug("trackOnboardingHistoryTooltipView()"),this._trackUxInteraction({kind:"onboardingHistoryTooltip",userAction:n.Onboarding.UserAction.view})}trackAssistantClose(){this._logger.debug("trackAssistantClose()"),this._trackUxInteraction({kind:"assistant",userAction:n.Assistant.UserAction.close})}trackVoiceProfileRemoveTag(){this._logger.debug("trackVoiceProfileRemoveTag()"),this._trackUxInteraction({kind:"voiceProfile",userAction:n.VoiceProfile.UserAction.removeVoiceTag})}trackVoiceProfileKeepTag(){this._logger.debug("trackVoiceProfileKeepTag()"),this._trackUxInteraction({kind:"voiceProfile",userAction:n.VoiceProfile.UserAction.keepVoiceTag})}trackAINotificationDismiss(e){this._logger.debug("trackAINotificationDismiss()"),this._trackUxInteraction({kind:"aiUsageNotification",userAction:"document"===e?n.AIUsageNotification.UserAction.dontShowOnDocument:n.AIUsageNotification.UserAction.dontShowForever})}trackReadyToInteract(){this._logger.debug("trackReadyToInteract()"),this._trackUxInteraction({kind:"assistant",userAction:n.Assistant.UserAction.readyToInteract})}trackMyVoiceCardToggle(e){this._logger.debug("trackMyVoiceCardToggle"),this._trackUxInteraction({kind:"voiceProfile",userAction:e?n.VoiceProfile.UserAction.toggleToMyVoice:n.VoiceProfile.UserAction.toggleToNeutral})}_trackUxInteraction(e,t,i,r={}){const s=n.getComponentId(e,t,i,r),o=n.getUserAction(e);this._logger.debug("_trackUxInteraction() - sending `user_action` to CAPI",{componentId:s,userAction:o,uxInteraction:e,contextId:t}),(0,l.t)("sendUserAction",this._capiService.user_action({componentId:s,userAction:o}),this._logger)}}},87311:(e,t,i)=>{i.d(t,{p:()=>f});var n,r,s,o=i(5114),a=i(57050),l=i(80800),c=i(9922),u=i(85985),d=i(38983),m=i(33148);!function(e){let t;!function(e){e.create=function(e,t,i){return{source:"userSurvey",kind:"error",name:"submitSurveyFailed",surveyPlacement:t,surveyType:e,surveyDetailedPlacement:i}},e.is=function(e){return"submitSurveyFailed"===e.name}}(t=e.SubmitSurveyFailed||(e.SubmitSurveyFailed={})),e.toJSON=function(e){return t.is(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),surveyType:e.surveyType,surveyPlacement:e.surveyPlacement}):(0,a.Rz)(e)}}(n||(n={})),function(e){let t;!function(e){e.create=function(e,t,i,n,r,s,o){return{source:"userSurvey",kind:"info",name:"submitSurveySuccessful",surveyPlacement:t,surveyStage:i,surveyType:e,surveyIsDismissed:n,surveyRating:r,surveyOpenAnswer:s,surveyDetailedPlacement:o}},e.is=function(e){return"submitSurveySuccessful"===e.name}}(t=e.SubmitSurveySuccessful||(e.SubmitSurveySuccessful={})),e.toJSON=function(e){var i,n;return t.is(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),surveyType:e.surveyType,surveyPlacement:e.surveyPlacement,surveyStage:e.surveyStage,surveyDetailedPlacement:null!==(i=e.surveyDetailedPlacement)&&void 0!==i?i:null,surveyRating:e.surveyRating?e.surveyRating.toString():null,surveyOpenAnswer:null!==(n=e.surveyOpenAnswer)&&void 0!==n?n:null,surveyIsDismissed:e.surveyIsDismissed?String(e.surveyIsDismissed):null}):(0,a.Rz)(e)}}(r||(r={})),function(e){let t;!function(e){e.create=function(e,t,i){return{source:"userSurvey",kind:"warning",name:"unexpectedSurveyFormatReceived",surveyPlacement:t,surveyType:e,surveyDetailedPlacement:i}},e.is=function(e){return"unexpectedSurveyFormatReceived"===e.name}}(t=e.UnexpectedSurveyFormatReceived||(e.UnexpectedSurveyFormatReceived={})),e.toJSON=function(e){return t.is(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),surveyType:e.surveyType,surveyPlacement:e.surveyPlacement}):(0,a.Rz)(e)}}(s||(s={}));var p=i(14047),h=i(86148),g=i(26320);class f{constructor(e){this._params=e,this._subs=new c.w.Keeper,this._activeSurvey=d.h.create(o.none),this.activeSurvey=this._activeSurvey.view(),this._init()}dispose(){this._subs.dispose()}submitSurveyResult(e){(0,g.t)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:e.rating,stage:h.x.Stage.toCAPIStage(e.stage),open_answer:o.getOrElse((()=>""))(e.openAnswer),detailed_placement:e.detailedPlacement,type:e.type}),void 0,(()=>this._params.monitoringService.notify(r.SubmitSurveySuccessful.create(e.type,e.placement,e.stage,!1,e.rating,o.getOrElse((0,a.a9)(""))(e.openAnswer),e.detailedPlacement))),(()=>this._params.monitoringService.notify(n.SubmitSurveyFailed.create(e.type,e.placement,e.detailedPlacement))))}dismissSurvey(e){(0,g.t)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:"declined",stage:h.x.Stage.toCAPIStage(e.stage),detailed_placement:e.detailedPlacement,type:e.type}),void 0,(()=>this._params.monitoringService.notify(r.SubmitSurveySuccessful.create(e.type,e.placement,e.stage,!0))),(()=>this._params.monitoringService.notify(n.SubmitSurveyFailed.create(e.type,e.placement,e.detailedPlacement))))}_init(){this._subs.push(this._params.capiService.relevantInboundCAPIMessages.pipe(u.h(m.JS.ShowSurvey.is)).subscribe((e=>this._handleShowSurvey(e))))}_handleShowSurvey(e){(0,a.zG)(e.survey,o.fromPredicate((e=>e.placement===l.v0.Survey.Data.BaseSurvey.Placement.ggo)),o.chain((e=>"open_answer_score"===e.type?o.some(e):o.none)),o.chain((e=>{var t;return"string"==typeof e.detailed_placement&&2===(null===(t=e.detailed_placement)||void 0===t?void 0:t.split(":").length)?o.some({survey:e,detailedPlacement:e.detailed_placement}):o.none})),o.chain((({survey:e,detailedPlacement:t})=>{const[i,n]=t.split(":"),r=Math.abs(Number.parseInt(n,10));return Number.isNaN(r)?o.none:o.some({survey:e,detailedPlacement:t,sessionId:i,resultId:p.x.Id.create(r)})})),o.fold((()=>this._params.monitoringService.notify(s.UnexpectedSurveyFormatReceived.create(e.survey.type,e.survey.placement,e.survey.detailed_placement))),(({survey:e,detailedPlacement:t,resultId:i})=>{this._activeSurvey.modify((()=>o.some({placement:e.placement,title:e.title,detailedPlacement:t,type:l.v0.Survey.Data.OpenAnswerScoreSurvey.type,resultId:i,maxScore:e.max_score,boxText:o.fromNullable(e.box_text),ratingLabels:e.score_labels,acknowledgmentTitle:o.fromNullable(e.acknowledgment_title),acknowledgment:o.fromNullable(e.acknowledgment),skipOpenAnswerFrom:e.skip_open_answer_from,openAnswer:o.fromNullable({placeholder:e.open_answer.placeholder,maxLen:e.open_answer.max_len,minLen:o.fromNullable(e.open_answer.min_len)})})))})))}}},80191:(e,t,i)=>{i.d(t,{G:()=>H,K:()=>V});var n=i(27378),r=i(95195),s=i(77176),o=i(22232),a=i(12187),l=i(5739),c=i(34217),u=i(83289),d=i(79001),m=i(13578),p=i(31278);const h=e=>n.createElement(p.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),n.createElement("path",{d:"M14 11.5H16.7929L8.92289 19.37L10.4851 13.1213L10.6404 12.5H10H7.20711L15.0771 4.62999L13.5149 10.8787L13.3596 11.5H14Z",stroke:m.XY.Content.Secondary.Default,strokeMiterlimit:"4.25735"})),g=e=>n.createElement(p.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),n.createElement("rect",{x:"4.5",y:"4.5",width:"6",height:"6",rx:"1.5",stroke:m.XY.Content.Secondary.Default}),n.createElement("rect",{x:"4.5",y:"13.5",width:"6",height:"6",rx:"1.5",stroke:m.XY.Content.Secondary.Default}),n.createElement("rect",{x:"13.5",y:"4.5",width:"6",height:"6",rx:"1.5",stroke:m.XY.Content.Secondary.Default}),n.createElement("path",{d:"M14.5513 15.8162L12.9269 16.3577C12.7902 16.4033 12.7902 16.5967 12.9269 16.6423L14.5513 17.1838C15.1485 17.3828 15.6172 17.8515 15.8162 18.4487L16.3577 20.0731C16.4033 20.2098 16.5967 20.2098 16.6423 20.0731L17.1838 18.4487C17.3828 17.8515 17.8515 17.3828 18.4487 17.1838L20.0731 16.6423C20.2098 16.5967 20.2098 16.4033 20.0731 16.3577L18.4487 15.8162C17.8515 15.6172 17.3828 15.1485 17.1838 14.5513L16.6423 12.9269C16.5967 12.7902 16.4033 12.7902 16.3577 12.9269L15.8162 14.5513C15.6172 15.1485 15.1485 15.6172 14.5513 15.8162Z",fill:m.XY.Content.Secondary.Default,stroke:m.XY.Content.Secondary.Default}));var f=i(87683),v=i(9546),y=i(62172),b=i(89894),x=i(94689),S=i(17430);const k="brick",w=(0,x.dD)({padding:`0 ${b.ux.rem(v.x)} 0 ${b.ux.rem(v.F2)}`},k),C={display:"flex",alignItems:"center",gap:b.ux.rem(v.x)},_=(0,x.dD)({minHeight:b.ux.rem(1.75),fontSize:b.ux.rem(.75),lineHeight:b.ux.rem(1.125),color:y.BlueGray80},k),I=(0,x.dD)({minHeight:b.ux.rem(2),fontSize:b.ux.rem(.875),lineHeight:b.ux.rem(1.375),color:m.XY.Content.Primary.Default},k),E=(0,x.dD)({boxShadow:`inset 0 0 0 ${b.ux.rem(.125)} ${S.Z.BrandGreen60}`},k),A=(0,x.dD)({boxShadow:"none",color:y.NeutralGray70,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{color:S.Z.BlueGray80,boxShadow:`inset 0 0 0 1px ${S.Z.BlueGray40}`,backgroundColor:S.Z.BlueGray5}}},k),O={textAlign:"left",whiteSpace:"initial",lineHeight:b.ux.rem(1.125),margin:`${b.ux.rem(.25)} 0 ${b.ux.rem(.25)} 0`},R=Object.assign({},(0,x.fx)(1.5)),T=b.ux.joinClasses([k,b.ux.style(w)]),P=b.ux.style(C),U=b.ux.style(_),B=b.ux.style(I),N=b.ux.style(E),z=b.ux.style(A),F=b.ux.style(O),j=b.ux.style(R),G=b.ux.style(R),M=(0,a.xb)(d.z.Secondary),D="actionBrick",V=".actionBrick",H=c.UI.Node.make((({view:e,notify:t})=>n.createElement(M,Object.assign({onClick:e("action").pipe(s.U((e=>t({kind:u.i.Kind.actionBrickClick,action:e})))),name:"actionBrick"},(0,a.Sh)(D,T,e("action").pipe(s.U((({kind:e})=>"go"===e?N:null))),e("mode").pipe(s.U((e=>"compact"===e?U:"standard"===e?B:(0,o.L0)(e)))),e("customViewOpts").pipe(s.U((e=>(null==e?void 0:e.isPinned)?z:null))))),n.createElement(l.F.div,{className:P},e("icon").pipe(s.U(r.fold((({kind:e})=>{switch(e){case"allResults":return n.createElement(g,{className:j});case"go":return n.createElement(h,{className:G});default:return(0,o.L0)(e)}}),(({url:e})=>n.createElement("img",{src:e,style:{width:20,height:20}}))))),n.createElement(l.F.span,Object.assign({className:F},(0,f.E)(e("label"))))))))},20491:(e,t,i)=>{i.d(t,{C$:()=>n,mP:()=>v});var n,r=i(27378),s=i(5114),o=i(9546),a=i(89894),l=i(77176),c=i(22232),u=i(5739),d=i(34217),m=i(83289),p=i(14047),h=i(4784),g=i(28518);!function(e){e.searchLabel="searchLabel",e.clickableSearchLabel="clickableSearchLabel",e.knowledgeHub="knowledgeHub"}(n||(n={}));const f=d.UI.Union.asOption(d.UI.Node.make((({notify:e,state:t})=>r.createElement(u.F.Fragment,null,t.pipe(l.U((t=>r.createElement(g.w,{key:"voiceButton",isMyVoice:t.selectedVoice===p.x.GeneratedTextVoice.user,onClick:e({kind:m.i.Kind.resultCardToggleGenericVoiceButtonClick,resultId:t.resultId,voice:t.selectedVoice})})))))))),v=d.UI.Knot.make(d.UI.Grid.make((({slots:e,notify:t,state:i})=>r.createElement(u.F.div,{className:y},i.pipe(l.U((e=>{switch(e.kind){case n.clickableSearchLabel:return r.createElement(h.$,{header:e.label,disabled:e.disabled,onClick:t({kind:m.i.Kind.resultCardHeaderClick,prompt:e.copiablePrompt})});case n.searchLabel:return r.createElement(h.L,{header:e.label,iconUrl:e.iconUrl,loading:!1});case n.knowledgeHub:return r.createElement(h.L,{header:"Knowledge Share content was used.",iconUrl:s.none,loading:!1});default:return(0,c.L0)(e)}}))),e.voiceButton))),{voiceButton:f}),y=a.ux.style({display:"grid",gridTemplateColumns:"1fr auto",gap:a.ux.rem(o.x)})},10517:(e,t,i)=>{i.d(t,{s:()=>a});var n=i(27378),r=i(13578),s=i(89894);const o=s.ux.style({whiteSpace:"break-spaces",overflowWrap:"anywhere",fontStyle:"normal",fontWeight:"normal",fontSize:s.ux.rem(.875),fontFeatureSettings:"'ss03' on",lineHeight:s.ux.rem(1.3125),color:r.XY.Content.Primary.Default}),a=({children:e})=>n.createElement("div",{className:o},e)},51739:(e,t,i)=>{i.d(t,{U:()=>_,r:()=>I});var n,r=i(27378),s=i(57050),o=i(62172),a=i(88392),l=i(36991),c=i(65223),u=i(89894),d=i(10517);!function(e){e.generatedText="generatedText",e.knowledgeHubTerm="knowledgeHubTerm",e.none="none"}(n||(n={}));const m=({insertOp:e})=>{const t=p(e.attributes),i=h(e.attributes);switch(t){case n.generatedText:return r.createElement(b,{style:i},e.insert);case n.knowledgeHubTerm:return r.createElement(x,{style:i},e.insert);case n.none:return y(e.attributes)?r.createElement(k,{style:i,href:e.attributes.link},e.insert):r.createElement(S,{style:i},e.insert);default:return(0,s.Rz)(t)}},p=e=>{switch(!0){case null==e?void 0:e[_.knowledgeHubTerm]:return n.knowledgeHubTerm;case null==e?void 0:e[_.generatedText]:return n.generatedText;default:return n.none}},h=e=>{const t={};return g(e)&&(t.fontWeight="bold"),f(e)&&(t.fontStyle="italic"),v(e)&&(t.textDecoration="underline"),y(e)&&(t.color=o.Blue60),t},g=e=>!0===(null==e?void 0:e.bold),f=e=>!0===(null==e?void 0:e.italic),v=e=>!0===(null==e?void 0:e.underline),y=e=>"string"==typeof(null==e?void 0:e.link),b=({children:e,style:t})=>r.createElement("span",{className:w,style:t},e),x=({children:e,style:t})=>r.createElement(c.u,{title:"from Knowledge Share"},r.createElement("span",{className:C,style:t},e)),S=({children:e,style:t})=>r.createElement("span",{style:t},e),k=({children:e,style:t,href:i})=>r.createElement("a",{style:t,href:i,target:"_blank",rel:"noreferrer"},e),w=u.ux.style({backgroundColor:o.Green0,borderRadius:u.ux.rem(a.fe)}),C=u.ux.style({backgroundColor:o.Blue0,borderRadius:u.ux.rem(a.fe)});var _;!function(e){e.generatedText="generatedText",e.knowledgeHubTerm="knowledgeHubTerm"}(_||(_={}));const I=({replacementDelta:e})=>r.createElement(d.s,null,e.map(((e,t)=>l.s.isInsert(e)?r.createElement(m,{key:t,insertOp:e}):null)))},4784:(e,t,i)=>{i.d(t,{$:()=>g,L:()=>v});var n=i(27378),r=i(5114),s=i(57050),o=i(9546),a=i(62172),l=i(13578),c=i(89894),u=i(12187),d=i(79001),m=i(39505),p=i(94689),h=i(87683);const g=({header:e,onClick:t,disabled:i})=>n.createElement(d.z.Tertiary,{compact:!0,disabled:i,onClick:t,className:w,name:"editResultPrompt",size:"small"},n.createElement("div",{className:C},n.createElement("div",Object.assign({className:I},(0,h.E)(e))),n.createElement("div",{className:S},"Edit")));var f;!function(e){e.FadeIn="FadeIn",e.FadeOut="FadeOut"}(f||(f={}));const v=({iconUrl:e,loading:t,header:i})=>{const[o,a]=n.useState({text:i,animationState:f.FadeIn});return n.useEffect((()=>{a((e=>Object.assign(Object.assign({},e),{animationState:e.text!==i?f.FadeOut:e.animationState})));const e=setTimeout((()=>a({text:i,animationState:f.FadeIn})),250);return()=>clearTimeout(e)}),[i]),n.createElement("div",{className:k},t?n.createElement(m.H,{className:_}):(0,s.zG)(e,r.fold(s.gn,(e=>n.createElement("img",{src:e,style:{width:c.ux.rem(1.25),height:c.ux.rem(1.25)}})))),n.createElement("span",Object.assign({"aria-live":"assertive"},(0,u.Sh)(I,o.animationState===f.FadeIn&&E,o.animationState===f.FadeOut&&A),(0,h.E)(o.text))))},y="editHeaderBtn",b="headerBtn",x=(0,p.dD)({height:c.ux.rem(1.5),lineHeight:c.ux.rem(1.125),padding:`0 ${c.ux.rem(o.F2)}`,margin:`0 ${c.ux.rem(-o.F2)}`,overflow:"hidden",$nest:{[`& .${y}`]:{opacity:0,pointerEvents:"none"},"&:focus, &:hover":{background:a.BlueGray0,[`& .${y}`]:{opacity:1,pointerEvents:"auto",color:l.XY.Content.Primary.Default}}}},b),S=y,k=c.ux.style({display:"flex",alignItems:"center",gap:c.ux.rem(o.x+o.yC),height:c.ux.rem(1.5),fontWeight:400,fontSize:c.ux.rem(.75),lineHeight:c.ux.rem(1.125),color:a.BlueGray60,overflow:"hidden"}),w=c.ux.joinClasses([b,c.ux.style(x)]),C=c.ux.style({display:"flex",justifyContent:"space-between",width:"100%",gap:c.ux.rem(o.F2)}),_=c.ux.style({marginBottom:`-${c.ux.rem(o.yC)}`,display:"inline-flex",alignItems:"center",justifyContent:"center"}),I=c.ux.style({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",transitionProperty:"opacity",transitionDuration:c.ux.seconds(.25)}),E=c.ux.style({opacity:1}),A=c.ux.style({opacity:0})},28518:(e,t,i)=>{i.d(t,{w:()=>h});var n=i(27378),r=i(62172),s=i(9546),o=i(13578),a=i(88392),l=i(89894),c=i(12187),u=i(79001),d=i(31278);const m=e=>n.createElement(d.a1,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),n.createElement("rect",{width:"16",height:"16",rx:"2"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.7072 5.41421L6.50008 12.6213L2.29297 8.41421L3.70718 7L6.50008 9.79289L12.293 4L13.7072 5.41421Z",fill:"white"}));var p=i(17430);const h=({isMyVoice:e,isAnimated:t=!1,isBadge:i=!1,label:r="Use my style",inactiveLabel:s=r,onClick:o})=>n.createElement(u.z.Tertiary,{name:"toggleVoice",onClick:o,size:"small",role:"checkbox","aria-checked":e,compact:!0,style:g(e,t,i)},n.createElement(m,Object.assign({width:16,height:16},(0,c.Sh)(f,e?v:y))),e?r:s);function g(e,t,i){return{base:{display:"flex",alignItems:"center",height:l.ux.rem(1.25),lineHeight:l.ux.rem(1.125),color:e?r.Green80:r.BlueGray60,backgroundColor:e?r.Green0:r.BlueGray0,padding:`0 ${l.ux.rem(s.F2)}`,transition:t?l.ux.seconds(.25):void 0,transitionProperty:t?"color, background-color":void 0},icon:{marginRight:l.ux.rem(s.x),minWidth:l.ux.rem(1),minHeight:l.ux.rem(1)},hovered:{backgroundColor:e?l.ux.color(p.Z.Green10).mix(l.ux.color(p.Z.BlueGray5)).toRGBA().toString():r.BlueGray10,color:e?r.Green80:r.BlueGray60},active:{backgroundColor:e?l.ux.color(p.Z.Green10).mix(l.ux.color(p.Z.BlueGray5)).toRGBA().toString():r.BlueGray10,color:e?r.Green80:r.BlueGray60},disabled:i?{opacity:1,cursor:"default"}:void 0}}const f=l.ux.style({marginRight:l.ux.rem(s.x),minWidth:l.ux.rem(1),minHeight:l.ux.rem(1),borderWidth:l.ux.px(1),borderStyle:"solid",borderColor:o.XY.Content.Secondary.Default,borderRadius:l.ux.rem(a.xB),overflow:"hidden",transitionProperty:"background border-color",transitionDuration:l.ux.seconds(.25),$nest:{svg:{stroke:"none"}}}),v=l.ux.style({background:r.Green60,borderColor:r.Green60,$nest:{path:{fill:r.White}}}),y=l.ux.style({background:r.White,borderColor:o.XY.Content.Secondary.Default,$nest:{path:{fill:"transparent"}}})},18027:(e,t,i)=>{i.d(t,{I:()=>su});var n=i(27378),r=i(34217),s=i(90845),o=i(99094),a=i(31278),l=i(77176),c=i(22232),u=i(5739),d=i(12187),m=i(83289),p=i(79001),h=i(5114),g=i(38983);const f=n.createContext({portalContainer:g.h.create(h.none)});var v=i(74204),y=i(57050),b=i(96465),x=i(34530);var S=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const k=e=>{var{placement:t,onMount:i,onMaxSizeChange:r,children:s}=e,o=S(e,["placement","onMount","onMaxSizeChange","children"]);const[a,l]=n.useState(null),c="initial"===t.kind?t:void 0,u=(d=r,n.useMemo((()=>({name:"maxSize",phase:"main",enabled:!0,requiresIfExists:["offset","preventOverflow","flip"],fn({state:e,name:t}){const i=(0,x.Z)(e),{x:n,y:r}=e.modifiersData.preventOverflow||{x:0,y:0},{width:s,height:o}=e.rects.popper,[a]=e.placement.split("-"),l="top"===a?"top":"bottom",c={width:s-i["left"===a?"left":"right"]-n,height:o-i[l]-r};e.modifiersData[t]=c,null==d||d(c)}})),[]));var d;const m=(0,b.n)(),{styles:p}=(0,v.D)(null==c?void 0:c.referenceElement,a,{placement:null==c?void 0:c.placement,modifiers:[u,{name:"preventOverflow",options:{padding:5,mainAxis:!0,altAxis:!0,tether:!1}},m,...(0,y.zG)((null==c?void 0:c.offset)||h.none,h.fold((()=>[]),(e=>[{name:"offset",options:{offset:e}}])))]});return n.createElement("div",Object.assign({dir:"ltr",ref:e=>{l(e),e&&e!==a&&i(e)},style:"initial"===t.kind?p.popper:{position:"fixed",top:t.referencePosition.top,left:t.referencePosition.left,bottom:t.referencePosition.bottom,right:t.referencePosition.right,transform:`translate(${t.translation.x}px, ${t.translation.y}px)`},tabIndex:0},o),s)};var w=i(62172),C=i(88392),_=i(9546),I=i(89894);const E="content",A="toolbar",O=e=>I.ux.color(w.BlueGray40).toRGBA().fade(e).toString(),R="#FCFCFC",T={fontFamily:"Inter, sans-serif",width:I.ux.rem(26.875),borderRadius:I.ux.rem(C.ze),background:"linear-gradient(180deg, #FCFCFC 0%, #FCFCFC 100%)",$nest:{"&[data-dragging='true']":{cursor:"grabbing",$nest:{[`.${E}`]:{pointerEvents:"none"},[`.${A}`]:{pointerEvents:"none"}}}}},P=Object.assign(Object.assign({},T),{boxShadow:`0px 0px 0px 0.5px ${w.BlueGray40}, 0px 0px 2px 0.5px ${O(.5)}, 0px 1px 8px 0.5px ${O(.1)}, 0px 2px 12px 0.5px ${O(.1)}, 0px 4px 20px 0.5px ${O(.25)}`,backdropFilter:`blur(${I.ux.rem(.34375)})`}),U={maxWidth:I.ux.rem(40),minWidth:I.ux.rem(18),width:I.ux.percent(100)},B={display:"flex",alignItems:"center",justifyContent:"space-between",gap:I.ux.rem(_.F2),padding:`0 ${I.ux.rem(_.x)}`,height:I.ux.rem(2.5),boxSizing:"border-box","--grammarly-app-region":"drag",$nest:{button:{"--grammarly-app-region":"no-drag"}}},N={borderBottom:`0.5px solid ${w.BlueGray10}`},z=I.ux.style(P),F=(I.ux.style(T),I.ux.style(P,U),I.ux.style(T,U),I.ux.joinClasses([A,I.ux.style(B)]),I.ux.joinClasses([A,I.ux.style(B,{cursor:"grab",$nest:{"&:active":{cursor:"grabbing"}}})])),j=I.ux.style(N),G=E,M=r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{ref:r,onMount:h}=s.P.useElWatcher();return n.createElement(f.Provider,{value:{portalContainer:r}},n.createElement(o.f.Context.Provider,{value:o.f.emptyWithName("cheetahAssistant")},n.createElement(u.F.Fragment,null,t.pipe(l.U((t=>"initial"===t.kind||"dragged"===t.kind?n.createElement(k,{placement:t,onFocus:i({kind:"focus",focused:!0}),onBlur:i({kind:"focus",focused:!1}),onMount:e=>{i({kind:"mount",element:e})(),h(e)},onMaxSizeChange:e=>i({kind:"maxSize",maxSize:e})(),"data-grammarly-part":"ideation-assistant","data-dragging":"dragged"===t.kind&&t.dragging,className:z},n.createElement("header",Object.assign({},(0,d.Sh)(F,t.contentOverflowUnderToolbar?j:null),{ref:e=>e&&i({kind:"dragHandleMount",element:e})()}),e.toolbar,n.createElement(p.z.Tertiary,{onClick:i({kind:m.i.Kind.toolbarCloseButtonClick}),compact:!0,size:"large",name:"toolbarClose","aria-label":"Close Assistant"},n.createElement(a.JO.Close,null))),n.createElement("main",{className:G},e.content)):"none"===t.kind?null:(0,c.L0)(t)))))))}));var D=i(60797),V=i(2834),H=i(93508),L=i(8125),K=i(64015),$=i(13578),W=i(85985),Z=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const q=n.forwardRef((function(e,t){var{children:i,style:r}=e,s=Z(e,["children","style"]);return n.createElement("section",Object.assign({className:I.ux.style({display:"flex",flexDirection:"column",padding:I.ux.rem(_.qp),gap:I.ux.rem(_.x),background:"transparent",border:`0.5px solid ${w.BlueGray10}`,borderRadius:I.ux.rem(C.xB+C.fe),backgroundColor:$.XY.Surface.Primary.Default,color:$.XY.Content.Primary.Default},r)},s,{ref:t}),i)}));var Y=i(87683);const X=e=>n.createElement(a.a1,{className:e.className,viewBox:"0 0 20 20",width:20,height:20},n.createElement("path",{d:"M8.58541 3.37143C9.36646 2.59038 10.6328 2.59038 11.4138 3.37143L16.6283 8.5859C17.4094 9.36695 17.4094 10.6333 16.6283 11.4143L11.4138 16.6288C10.6328 17.4098 9.36646 17.4098 8.58541 16.6288L3.37094 11.4143C2.58989 10.6333 2.58989 9.36695 3.37094 8.5859L8.58541 3.37143ZM11.4371 6.25011C11.4371 5.4562 10.7935 4.81261 9.99962 4.81261C9.20571 4.81261 8.56212 5.4562 8.56212 6.25011V10.6251C8.56212 11.3163 9.04996 11.8936 9.70011 12.0314C9.04996 12.1692 8.56212 12.7464 8.56212 13.4376C8.56212 14.2315 9.20571 14.8751 9.99962 14.8751C10.7935 14.8751 11.4371 14.2315 11.4371 13.4376C11.4371 12.7464 10.9493 12.1692 10.2991 12.0314C10.9493 11.8936 11.4371 11.3163 11.4371 10.6251V6.25011Z",fill:"#D31332",stroke:"#D31332"})),Q=({options:e,onSubmit:t,onCancel:i})=>{const[r,s]=n.useState(h.none),[o,a]=n.useState(!1);return n.createElement(u.F.form,{id:"radioOptionsForm",onSubmit:e=>{(0,y.zG)(r,h.fold((()=>a(!0)),t)),e.preventDefault()},className:I.ux.style(J)},n.createElement("fieldset",{className:re,style:{borderColor:o?w.Red60:"transparent"}},(0,y.zG)(e,K.UI((e=>n.createElement("span",{key:e,className:ee},n.createElement("input",{type:"radio",id:e,value:e,name:e,checked:(0,y.zG)(r,h.filter((t=>t===e)),h.isSome),onChange:()=>{a(!1),s(h.some(e))},style:{margin:`0 ${I.ux.rem(.5)} 0 0`}}),n.createElement("label",{htmlFor:e},e)))))),o&&n.createElement("div",{className:ne},n.createElement(X,{className:ie})," Make a selection"),n.createElement("div",{className:te},n.createElement(p.z.Primary,{type:"submit",form:"radioOptionsForm",name:"submitSelectedRadioOption",style:{base:J}},"Submit"),"  ",n.createElement(p.z.Tertiary,{onClick:i,name:"cancelRadioOptionSelection",style:{base:J}},"Cancel")))},J={fontSize:I.ux.rem(.875)},ee=I.ux.style({display:"inline-flex",alignItems:"center"}),te=I.ux.style({paddingTop:I.ux.rem(.5)}),ie=I.ux.style({minWidth:"unset",minHeight:"unset"}),ne=I.ux.style({color:w.Red60,lineHeight:I.ux.rem(1.5)}),re=I.ux.style({marginLeft:`calc(-1 * ${I.ux.rem(.25)})`,padding:I.ux.rem(.25),display:"flex",flexDirection:"column",gap:I.ux.rem(.5),width:"fit-content",border:"1px solid transparent",borderRadius:I.ux.rem(.25),margin:0}),se=r.UI.Node.make((({view:e,notify:t})=>n.createElement(q,{style:ae},n.createElement("div",{className:le},n.createElement(u.F.img,{src:e("iconUrl"),style:{width:16,height:16}}),n.createElement(u.F.span,Object.assign({},(0,Y.E)(e("header"))))),n.createElement(u.F.div,null,e("hintsHeader")),n.createElement(u.F.Fragment,null,e("hintsItems").pipe(l.U(K.UI((e=>n.createElement("li",{key:e},e)))),W.h(K.Od),l.U((e=>n.createElement("ul",{key:"action-followup-radio-list",className:ce},e))))),n.createElement(u.F.Fragment,null,e("radioOptions").pipe(D.oA,l.U((e=>n.createElement(Q,{key:"radioOptions",options:e,onSubmit:e=>t({kind:m.i.Kind.radioOptionsSubmitButtonClick,selectedOption:e})(),onCancel:t({kind:m.i.Kind.radioOptionsCancelButtonClick})})))))))),oe=r.UI.Union.asOption(se),ae={fontWeight:400,fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.3125)},le=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x),color:$.XY.Content.Secondary.Default,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125)}),ce=I.ux.style({padding:`0 0 0 ${I.ux.rem(_.sD+_.yC)}`,margin:0}),ue=e=>n.createElement(a.a1,Object.assign({width:"18",height:"18",viewBox:"0 0 18 18",fill:"#99A0B3"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0607 3.64286C9.5893 2.78571 8.4107 2.78571 7.93926 3.64286L3.16592 12.3214C2.69448 13.1786 3.28378 14.25 4.22667 14.25H13.7733C14.7162 14.25 15.3055 13.1786 14.8341 12.3214L10.0607 3.64286ZM8.25 6C8.25 5.58579 8.58579 5.25 9 5.25C9.41421 5.25 9.75 5.58579 9.75 6V9.75C9.75 10.1642 9.41421 10.5 9 10.5C8.58579 10.5 8.25 10.1642 8.25 9.75V6ZM9.75 12C9.75 12.4142 9.41421 12.75 9 12.75C8.58579 12.75 8.25 12.4142 8.25 12C8.25 11.5858 8.58579 11.25 9 11.25C9.41421 11.25 9.75 11.5858 9.75 12Z",stroke:"none"}));var de=i(94689);const me=r.UI.Node.make((({view:e,notify:t})=>n.createElement(q,null,n.createElement(u.F.div,{className:he},e("error").pipe(l.U((e=>n.createElement(n.Fragment,null,n.createElement(ue,{className:ve}),n.createElement("span",{className:ge},e.header)))))),n.createElement(u.F.div,{className:fe},e("error").pipe(l.U((e=>e.text)))),n.createElement(u.F.Fragment,null,e("showGotItButton").pipe(l.U((e=>e?n.createElement(p.z.Primary,{className:ye,name:"gotItButton",onClick:t({kind:m.i.Kind.errorCardOkButtonClick}),size:"small"},"OK"):null))))))),pe=r.UI.Union.asOption(me),he=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.F2)}),ge=I.ux.style({fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),fontWeight:700,color:$.XY.Content.Primary.Default}),fe=I.ux.style({fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),color:$.XY.Content.Secondary.Default,whiteSpace:"break-spaces",overflowWrap:"anywhere"}),ve=I.ux.style(Object.assign({padding:I.ux.rem(_.yC)},(0,de.fx)(1.125))),ye=I.ux.style({alignSelf:"flex-start"});var be=i(9223),xe=i(76974),Se=i(18702),ke=i(72125);const we=({children:e,customStyle:t})=>n.createElement(u.F.h1,{className:I.ux.style(Ce,t)},e),Ce={color:$.XY.Content.Secondary.Default,margin:0,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"};var _e=i(48258),Ie=i(2844),Ee=i(83078);var Ae=i(17430),Oe=i(15962);const Re=r.UI.Node.make((({state:e,notify:t})=>{const{onMount:i}=(0,_e.F)((0,y.ls)(V.b(t({kind:"singleCardFeedMounted"})),be.x(Oe.q.notifyFeedUnmount))),{onMount:r}=function(e,t){const{onMount:i,ref:n}=s.P.useElWatcher();return s.P.useSubscriptionTo(Ie.aj([n,t]).pipe(l.U((([t,i])=>(0,y.zG)(t,Ee.bw((t=>t.style.setProperty(e,i)))))))),{onMount:i}}("--cardWidth",xe.of("400"));return n.createElement(q,{style:{padding:0,paddingTop:I.ux.rem(_.qp)},ref:e=>{i(e),r(e)}},n.createElement(we,{customStyle:{padding:`0 ${I.ux.rem(_.qp)}`}},"Review suggestions"),n.createElement(u.F.Fragment,null,e.pipe(l.U((({item:e,prevItem:i,transitions:r})=>n.createElement(Se.P,{key:e.id,sduiRootId:e.id,content:e.content,designSystem:Object.assign(Object.assign({},ke.k),{nativeExperimentalGBConsistencyUpsellFooter:()=>n.createElement("div",null,"nativeExperimentalGBConsistencyUpsellFooter not implemented")}),notify:(i,n,r)=>t({kind:"sduiNotify",item:e,sourceId:i,actions:n,actionScope:r})(),transitions:Array.from(r),prevContent:(0,y.zG)(i,h.map((e=>e.content))),onAnimationEnd:t({kind:"singleCardAnimationEnd"}),onMount:t({kind:"sduiItemMounted",item:e})}))))))})),Te=r.UI.Node.make((()=>n.createElement(q,{style:ze},n.createElement("p",{className:Ne},"Looking good so far. Keep writing to see suggestions.")))),Pe=r.UI.Node.make((()=>n.createElement(q,{style:ze},n.createElement("p",{className:Ne},"All clear!")))),Ue=r.UI.Node.make((()=>n.createElement(q,{"aria-busy":"true",style:ze},n.createElement("p",{className:Ne},"Checking your text...")))),Be=r.UI.Union.make("kind",{none:r.UI.Node.empty,loadingState:Ue,emptyState:Te,successState:Pe,nonEmptyState:Re}),Ne=I.ux.style({margin:0,color:Ae.Z.TextBaseSubduedColor,fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.3125)}),ze={padding:`${I.ux.rem(_.qp)} ${I.ux.rem(_.mh)}`},Fe=I.ux.keyframes({"0%":{backgroundPositionX:"-300px"},"85%":{backgroundPositionX:"600px"},"100%":{backgroundPositionX:"600px"}}),je=e=>{var t,i,n;const r=I.ux.color(null!==(t=e.overlayGradientCenterColor)&&void 0!==t?t:"rgba(0, 0, 0, 1)"),s=I.ux.color(null!==(i=e.overlayGradientEndColor)&&void 0!==i?i:"rgba(255, 255, 255, 0)"),o=`rgba(${r.red()}, ${r.green()}, ${r.blue()}, ${r.alpha()})`,a=`rgba(${s.red()}, ${s.green()}, ${s.blue()}, ${s.alpha()})`;return I.ux.style({position:"absolute",top:0,left:0,bottom:0,right:0,pointerEvents:"none",mixBlendMode:null!==(n=e.overlayBlendMode)&&void 0!==n?n:"overlay",background:`linear-gradient(90deg, ${a} 0px, ${o} 120px, ${o} 150px, ${o} 170px, ${a} 300px)`,backgroundRepeat:"no-repeat",backgroundPositionX:"-300px",backgroundSize:1e3,animationDelay:"300ms",animationDuration:"1.5s",animationName:Fe,animationTimingFunction:"linear",animationIterationCount:"infinite"})},Ge=e=>n.createElement("div",{className:je(e)}),Me=r.UI.Node.make((({view:e})=>n.createElement(q,{"aria-busy":"true"},n.createElement(we,null,e("header")),n.createElement("div",{className:De},n.createElement(Ge,null))))),De=I.ux.style({height:I.ux.rem(.5),borderRadius:I.ux.rem(_.W9),background:w.BlueGray5,flexGrow:1,maxWidth:I.ux.rem(22.5),position:"relative",marginBottom:I.ux.rem(_.F2)}),Ve=r.UI.Node.make((({view:e})=>n.createElement(q,{style:Ke},n.createElement(we,null,e("header")),n.createElement(u.F.div,Object.assign({className:$e},(0,Y.E)(e("text"),[...Y.ap,"person"])))))),He=r.UI.Union.make("kind",{loading:Me,loaded:Ve}),Le=r.UI.Union.asOption(He),Ke={gap:I.ux.rem(_.yC)},$e=I.ux.style({color:$.XY.Content.Primary.Default,fontStyle:"normal",fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),fontFeatureSettings:"'ss01' on",$nest:{"& person":{color:w.Blue60,fontWeight:700,$nest:{"&::before":{content:"''",display:"inline-block",width:I.ux.rem(1),height:I.ux.rem(1),backgroundSize:"cover",verticalAlign:"text-bottom",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,${encodeURIComponent(`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.95768 3.00512C8.95983 3.00512 9.7855 3.83575 9.7855 4.8769V6.01259C9.7855 7.05374 8.95983 7.88437 7.95768 7.88437C6.95553 7.88437 6.12986 7.05374 6.12986 6.01259V4.8769C6.12986 3.83575 6.95553 3.00512 7.95768 3.00512ZM10.5847 4.8769C10.5847 3.40916 9.41586 2.20593 7.95768 2.20593C6.4995 2.20593 5.33067 3.40916 5.33067 4.8769V6.01259C5.33067 7.48032 6.4995 8.68355 7.95768 8.68355C8.20909 8.68355 8.45189 8.64779 8.68159 8.58107C8.68635 8.65317 8.69342 8.72016 8.70392 8.78578C8.81061 9.45248 9.17662 10.0499 9.72211 10.4478C9.88673 10.5679 10.0776 10.6652 10.3757 10.8171L11.2702 11.2732C11.6108 11.4469 11.7408 11.5145 11.8477 11.5924C12.2227 11.866 12.4743 12.2767 12.5477 12.7351C12.5589 12.8055 12.5645 12.8807 12.5672 12.995H9.90666C9.68597 12.995 9.50707 13.1739 9.50707 13.3946C9.50707 13.6152 9.68597 13.7941 9.90666 13.7941H12.9694C13.19 13.7941 13.3689 13.6152 13.3689 13.3946L13.369 13.3588C13.369 13.0242 13.369 12.81 13.3368 12.6088C13.2301 11.9421 12.8641 11.3446 12.3186 10.9468C12.154 10.8267 11.9632 10.7294 11.665 10.5775C11.6546 10.5721 11.644 10.5667 11.6332 10.5612L10.7705 10.1214C10.43 9.94773 10.2999 9.88006 10.1931 9.80215C9.81805 9.52861 9.56642 9.11785 9.49307 8.65949C9.4762 8.55408 9.47217 8.43819 9.47124 8.19619C10.1462 7.71137 10.5847 6.9116 10.5847 6.01259V4.8769Z" fill="${w.Blue60}"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7.91127 3.00512C6.90913 3.00512 6.08346 3.83575 6.08346 4.8769V6.01259C6.08346 7.05374 6.90913 7.88437 7.91127 7.88437C8.91342 7.88437 9.73909 7.05374 9.73909 6.01259V4.8769C9.73909 3.83575 8.91342 3.00512 7.91127 3.00512ZM5.28427 4.8769C5.28427 3.40916 6.45309 2.20593 7.91127 2.20593C9.36946 2.20593 10.5383 3.40916 10.5383 4.8769V6.01259C10.5383 7.48032 9.36946 8.68355 7.91127 8.68355C7.65987 8.68355 7.41706 8.64779 7.18737 8.58107C7.1826 8.65317 7.17553 8.72016 7.16503 8.78578C7.05834 9.45248 6.69233 10.0499 6.14684 10.4478C5.98222 10.5679 5.7914 10.6652 5.49326 10.8171L4.59875 11.2732C4.25818 11.4469 4.12811 11.5145 4.02129 11.5924C3.64626 11.866 3.39463 12.2767 3.32128 12.7351C3.31001 12.8055 3.30447 12.8807 3.30176 12.995H10.2779C10.4986 12.995 10.6775 13.1739 10.6775 13.3946C10.6775 13.6152 10.4986 13.7941 10.2779 13.7941H2.8996C2.67891 13.7941 2.50001 13.6152 2.50001 13.3946L2.5 13.3588C2.49996 13.0242 2.49994 12.81 2.53214 12.6088C2.63883 11.9421 3.00484 11.3446 3.55033 10.9468C3.71494 10.8267 3.90577 10.7294 4.2039 10.5775C4.21438 10.5721 4.22499 10.5667 4.23574 10.5612L5.09841 10.1214C5.43899 9.94773 5.56906 9.88006 5.67588 9.80215C6.0509 9.52861 6.30254 9.11785 6.37589 8.65949C6.39276 8.55408 6.39678 8.43819 6.39771 8.19619C5.72278 7.71137 5.28427 6.9116 5.28427 6.01259V4.8769Z" fill="${w.Blue60}"/></svg>`)}')`}}}}});var We=i(83959),Ze=i(99877);const qe=n.createContext({notifyUnmount:y.Q1});var Ye=i(53702),Xe=i(66310),Qe=i(80900),Je=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};function et(e){var{children:t,onOpenChange:i,title:r,placement:o="bottom end"}=e,a=Je(e,["children","onOpenChange","title","placement"]);const c=n.useMemo((()=>g.h.create(!1)),[]),d=n.useMemo((()=>c.pipe(W.h((e=>!0===e)),Xe.w((()=>Qe.H(250))),V.b((()=>c.set(!1))))),[c]);return s.P.useSubscriptionTo(d),n.createElement(f.Consumer,null,(({portalContainer:e})=>n.createElement(u.F.Fragment,null,e.view(h.fold(y.gn,(e=>n.createElement(Ye.v.Dropdown,Object.assign({title:c.pipe(l.U((0,L.RN)(void 0,r))),placement:o,portalContainer:e,onOpenChange:e=>{e||c.set(!0),null==i||i(e)}},a),t)))))))}const tt=e=>n.createElement(a.a1,Object.assign({width:"12",height:"15",viewBox:"0 0 12 15",fill:"#99A0B3"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.5 0.5C0.776142 0.5 1 0.723858 1 1V2H11.5C11.7022 2 11.8845 2.12182 11.9619 2.30866C12.0393 2.4955 11.9966 2.71055 11.8536 2.85355L8.70711 6L11.8536 9.14645C11.9966 9.28945 12.0393 9.5045 11.9619 9.69134C11.8845 9.87818 11.7022 10 11.5 10H1V14.5C1 14.7761 0.776142 15 0.5 15C0.223858 15 0 14.7761 0 14.5V1C0 0.723858 0.223858 0.5 0.5 0.5ZM1 9H10.2929L7.64645 6.35355C7.45118 6.15829 7.45118 5.84171 7.64645 5.64645L10.2929 3H1V9Z",stroke:"none"}));var it=i(14746);const nt="reportMenuBtnIcon",rt=(0,de.dD)((0,de.fx)(1.5),nt),st=({reportMenuButtonClassName:e,onClickReportOffensive:t,onClickProvideFeedback:i,onOpenChange:r})=>n.createElement(et,{"aria-label":"Provide feedback",title:"Provide feedback",name:"reportMenu",label:n.createElement(tt,{className:I.ux.joinClasses([nt,I.ux.style(rt)])}),theme:{button:I.ux.joinClasses([e,(0,it.P)({type:"tertiary",compact:!0,size:"small"})])},onAction:e=>{switch(e){case"provideFeedback":return i();case"reportOffensive":return t()}},onOpenChange:r},n.createElement(Ye.v.Item,{key:"provideFeedback",textValue:"provideFeedback"},n.createElement(a.JO.AssistantFeedback,null),"Share your thoughts"),n.createElement(Ye.v.Item,{key:"reportOffensive",textValue:"reportOffensive"},n.createElement(a.JO.Report,null),"Report as offensive"));var ot=i(75616),at=i(42636);const lt=e=>n.createElement(a.a1,Object.assign({width:"12",height:"15",viewBox:"0 0 12 15",fill:"#99A0B3"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.5 0.5C3.67157 0.5 3 1.17157 3 2V3H0.5C0.223858 3 0 3.22386 0 3.5C0 3.77614 0.223858 4 0.5 4H1.04536L1.82983 12.237C1.95203 13.5201 3.02968 14.5 4.31857 14.5H7.68143C8.97032 14.5 10.048 13.5201 10.1702 12.237L10.9546 4H11.5C11.7761 4 12 3.77614 12 3.5C12 3.22386 11.7761 3 11.5 3H9V2C9 1.17157 8.32843 0.5 7.5 0.5H4.5ZM8 3V2C8 1.72386 7.77614 1.5 7.5 1.5H4.5C4.22386 1.5 4 1.72386 4 2V3H8ZM2.04988 4H9.95012L9.17467 12.1422C9.10135 12.9121 8.45476 13.5 7.68143 13.5H4.31857C3.54524 13.5 2.89865 12.9121 2.82533 12.1422L2.04988 4Z",stroke:"none"})),ct=({style:e,contentStyle:t,children:i,header:r})=>n.createElement("div",{className:I.ux.style(ut,e)},r,n.createElement("div",{className:I.ux.style(dt,t)},i)),ut={background:"white",display:"flex",flexDirection:"column",gap:I.ux.rem(_.x)},dt={display:"flex",flexDirection:"row",flexWrap:"wrap",gap:I.ux.rem(_.x)};var mt=i(80191);const pt=r.UI.List.make(K.bw,mt.G);var ht=i(32952),gt=i(55721),ft=i(28043);function vt(e,t=0){const i=function(e){return e.trim().replace(/\s+/g," ")}(e).split(" ").reduce(((e,i,n,r)=>Object.assign(Object.assign({},e),{head:n<r.length-t?e.head.concat(i):e.head,tail:n>=r.length-t?e.tail.concat(i):e.tail})),{head:[],tail:[]});return{head:i.head.join(" "),tail:i.tail.join(" ")}}const yt=({children:e,maxTailWordsCount:t=0})=>{const i=vt(e,t);return n.createElement("div",{className:xt},n.createElement("span",{className:St},i.head,i.head.length&&i.tail.length?" ":null),i.tail.length?i.tail:null)},bt=({children:e,maxTailWordsCount:t=0})=>{const[i,r]=n.useState(t),{onMount:o,rect:a}=s.P.useRectWatcher(),l=n.useRef(null),c=n.useMemo((()=>vt(e,i)),[i]),u=n.useMemo((()=>new ht.xQ),[]);s.P.useSubscriptionTo(n.useMemo((()=>u.pipe(gt.p(100),ft.x(),V.b((e=>{r(e)})))),[]));const d=n.useMemo((()=>{return e=l.current,parseInt((null===(n=null===(i=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===i?void 0:i.getComputedStyle(e))||void 0===n?void 0:n.fontSize)||(null===(s=null===(r=null==e?void 0:e.ownerDocument)||void 0===r?void 0:r.defaultView)||void 0===s?void 0:s.getComputedStyle(e.ownerDocument.body).fontSize)||kt,10);var e,t,i,n,r,s}),[l.current]);return s.P.useSubscriptionTo(n.useMemo((()=>a.pipe(D.oA,ft.x(),W.h((e=>Boolean(e.width&&e.height))),V.b((e=>{if(e.width<9*d)u.next(0);else if(l.current&&l.current.clientWidth<l.current.scrollWidth){const n=l.current.clientWidth/(e.width||1/0);i&&n<.4?u.next(i-1):n>.6&&i<t&&u.next(i+1)}})))),[a])),n.createElement("div",{className:xt,ref:o},n.createElement("span",{className:St,ref:l},c.head,c.head.length&&c.tail.length?" ":null),c.tail.length?c.tail:null)},xt=I.ux.style({display:"flex",flexDirection:"row",whiteSpace:"nowrap",maxWidth:"100%",minWidth:0}),St=I.ux.style({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",flexShrink:10}),kt="16px";const wt=(0,d.xb)((({dynamic:e=!1,maxTailWordsCount:t=0,children:i})=>e?n.createElement(bt,{maxTailWordsCount:t},i):n.createElement(yt,{maxTailWordsCount:t},i))),Ct=({active:e,children:t})=>n.createElement("h1",{className:It},e?n.createElement("svg",{viewBox:"0 0 16 16",fill:"none",className:_t,"aria-hidden":"true"},n.createElement("rect",{width:"16",height:"16",rx:"5",fill:"#018374"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 13.5C9.5 13.7761 9.72386 14 10 14H11C12.6569 14 14 12.6569 14 11V10C14 9.72386 13.7761 9.5 13.5 9.5C13.2239 9.5 13 9.72386 13 10V11C13 12.1046 12.1046 13 11 13H10C9.72386 13 9.5 13.2239 9.5 13.5ZM9.5 2.5C9.5 2.77614 9.72386 3 10 3H11C12.1046 3 13 3.89543 13 5V6C13 6.27614 13.2239 6.5 13.5 6.5C13.7761 6.5 14 6.27614 14 6V5C14 3.34315 12.6569 2 11 2H10C9.72386 2 9.5 2.22386 9.5 2.5ZM6 2C6.27614 2 6.5 2.22386 6.5 2.5C6.5 2.77614 6.27614 3 6 3H5C3.89543 3 3 3.89543 3 5V6C3 6.27614 2.77614 6.5 2.5 6.5C2.22386 6.5 2 6.27614 2 6V5C2 3.34315 3.34315 2 5 2H6ZM6 13C6.27614 13 6.5 13.2239 6.5 13.5C6.5 13.7761 6.27614 14 6 14H5C3.34315 14 2 12.6569 2 11V10C2 9.72386 2.22386 9.5 2.5 9.5C2.77614 9.5 3 9.72386 3 10V11C3 12.1046 3.89543 13 5 13H6ZM5.5 6.5C5.5 6.22386 5.72386 6 6 6H10C10.2761 6 10.5 6.22386 10.5 6.5C10.5 6.77614 10.2761 7 10 7H6C5.72386 7 5.5 6.77614 5.5 6.5ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H8.5C8.77614 10 9 9.77614 9 9.5C9 9.22386 8.77614 9 8.5 9H6Z",fill:"white"})):n.createElement("svg",{viewBox:"0 0 16 16",fill:"none",className:_t,"aria-hidden":"true"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 13.5C9.5 13.7761 9.72386 14 10 14H11C12.6569 14 14 12.6569 14 11V10C14 9.72386 13.7761 9.5 13.5 9.5C13.2239 9.5 13 9.72386 13 10V11C13 12.1046 12.1046 13 11 13H10C9.72386 13 9.5 13.2239 9.5 13.5ZM9.5 2.5C9.5 2.77614 9.72386 3 10 3H11C12.1046 3 13 3.89543 13 5V6C13 6.27614 13.2239 6.5 13.5 6.5C13.7761 6.5 14 6.27614 14 6V5C14 3.34315 12.6569 2 11 2H10C9.72386 2 9.5 2.22386 9.5 2.5ZM6 2C6.27614 2 6.5 2.22386 6.5 2.5C6.5 2.77614 6.27614 3 6 3H5C3.89543 3 3 3.89543 3 5V6C3 6.27614 2.77614 6.5 2.5 6.5C2.22386 6.5 2 6.27614 2 6V5C2 3.34315 3.34315 2 5 2H6ZM6 13C6.27614 13 6.5 13.2239 6.5 13.5C6.5 13.7761 6.27614 14 6 14H5C3.34315 14 2 12.6569 2 11V10C2 9.72386 2.22386 9.5 2.5 9.5C2.77614 9.5 3 9.72386 3 10V11C3 12.1046 3.89543 13 5 13H6ZM5.5 6.5C5.5 6.22386 5.72386 6 6 6H10C10.2761 6 10.5 6.22386 10.5 6.5C10.5 6.77614 10.2761 7 10 7H6C5.72386 7 5.5 6.77614 5.5 6.5ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H8.5C8.77614 10 9 9.77614 9 9.5C9 9.22386 8.77614 9 8.5 9H6Z",fill:"#646B81"})),n.createElement(wt,{dynamic:!0,maxTailWordsCount:3},t)),_t=I.ux.style({width:I.ux.rem(1),height:I.ux.rem(1)}),It=I.ux.style({display:"grid",gridTemplateColumns:`${I.ux.rem(1)} auto`,justifyItems:"start",alignItems:"center",gap:I.ux.rem(_.x),color:$.XY.Content.Secondary.Default,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontWeight:"normal",margin:0}),Et=r.UI.Grid.make((({slots:e,state:t})=>n.createElement(u.F.Fragment,null,t.pipe(l.U((({label:t,view:i})=>i===at.aU.Store.View.normal?n.createElement(ct,{header:e.header,style:Ut,key:t},e.actions):i===at.aU.Store.View.pinned?n.createElement(ct,{style:Ft,key:t},e.actions):(0,c.L0)(i))))))),At=r.UI.Node.make((({view:e})=>n.createElement(we,null,e("label")))),Ot=r.UI.Node.make((({view:e,notify:t})=>n.createElement("div",{className:Bt},n.createElement(Ct,{active:!0},e("label")),n.createElement(p.z.Tertiary,{onClick:t({kind:m.i.Kind.removeSelectionContextClick}),compact:!0,size:"small",name:"removeContext",title:"Delete"},n.createElement(lt,{className:zt}))))),Rt=r.UI.Union.make("kind",{default:At,withSelectionContext:Ot}),Tt=r.UI.Knot.make(Et,{actions:pt,header:Rt}),Pt=r.UI.List.make(K.bw,Tt),Ut={background:"transparent",padding:`${I.ux.rem(_.x)} 0`},Bt=I.ux.style({display:"grid",gridTemplateColumns:`auto ${I.ux.rem(1)}`,justifyItems:"start",alignItems:"center",alignContent:"center",gap:I.ux.rem(_.x),paddingRight:I.ux.rem(_.x),height:I.ux.rem(1)}),Nt="ignoreIcon",zt=I.ux.joinClasses([Nt,I.ux.style((0,de.dD)((0,de.fx)(1.5),Nt))]),Ft=Object.assign(Object.assign({},Ut),{padding:`${I.ux.rem(_.x)} 0`,marginTop:I.ux.rem(-1*_.x),borderTop:`1px solid ${w.NeutralGray0}`}),jt=({style:e,mode:t="standard"})=>{const i="standard"==t?1:.875;return n.createElement("div",{className:I.ux.style({height:I.ux.rem(2*i),display:"flex",alignItems:"center",gap:I.ux.rem(_.x),padding:`0 ${I.ux.rem(_.x)} 0 ${I.ux.rem(_.F2)}`,borderRadius:I.ux.rem(_.F2),border:`1px solid ${w.BlueGray5}`,boxSizing:"border-box"},e)},n.createElement("div",{className:I.ux.style({width:I.ux.rem(1.5*i),height:I.ux.rem(1.5*i),borderRadius:I.ux.rem(1.5*i),background:w.BlueGray5})}),n.createElement("div",{className:I.ux.style({height:I.ux.rem(.5*i),borderRadius:I.ux.rem(_.W9),background:w.BlueGray5,flexGrow:1})}))},Gt=r.UI.Node.make((({view:e})=>n.createElement(q,{"aria-busy":"true"},n.createElement(u.F.Fragment,null,e("withContext").pipe(l.U((0,L.RN)(n.createElement(Ct,{active:!0},e("header")),n.createElement(we,null,e("header")))))),n.createElement(u.F.div,{className:Mt},n.createElement(Ge,null),e("isQuickReply").pipe(l.U((0,L.RN)(n.createElement(n.Fragment,null,n.createElement(jt,{style:{width:I.ux.rem(23)}}),n.createElement(jt,{style:{width:I.ux.rem(21.5)}}),n.createElement(jt,{style:{width:I.ux.rem(20.5)}})),n.createElement(n.Fragment,null,n.createElement(jt,{style:{width:I.ux.rem(8.375)}}),n.createElement(jt,{style:{width:I.ux.rem(9.3125)}}),n.createElement(jt,{style:{width:I.ux.rem(10.5)}}),n.createElement(jt,{style:{width:I.ux.rem(10.75)}}),n.createElement(jt,{style:{width:I.ux.rem(4.9375)}}))))))))),Mt=I.ux.style({display:"flex",flexWrap:"wrap",gap:I.ux.rem(_.x),position:"relative"}),Dt=r.UI.Knot.make(r.UI.Grid.make((({slots:e,notify:t,state:i})=>{const{notifyUnmount:r}=n.useContext(qe),{onMount:s}=(0,_e.F)((0,y.ls)(V.b((e=>t({kind:m.i.Kind.mount,name:Ze.e.initialActionsList,element:e})())),be.x((()=>r({kind:m.i.Kind.unmount,name:Ze.e.initialActionsList})))));return n.createElement(q,{style:Ht,ref:s},n.createElement(u.F.Fragment,null,i.pipe(l.U((({isQuickReply:e})=>e?n.createElement(st,{reportMenuButtonClassName:Lt,onClickProvideFeedback:t({kind:m.i.Kind.openFeedbackFormButtonClick,source:We.x.Source.quickReplyInitialActions}),onClickReportOffensive:t({kind:m.i.Kind.reportOffensiveActionsButtonClick}),onOpenChange:e=>t({kind:m.i.Kind.reportMenuVisibilityChange,trigger:ot.G.uiItem(Ze.e.initialActionsList),visible:e})()}):null))),e.actions))})),{actions:Pt}),Vt=r.UI.Union.make("kind",{none:r.UI.Node.empty,loading:Gt,loaded:Dt}),Ht={position:"relative",padding:`${I.ux.rem(_.F2)} ${I.ux.rem(_.qp)}`},Lt=I.ux.style({position:"absolute",top:I.ux.rem(_.qp),right:I.ux.rem(_.qp)}),Kt=r.UI.Node.make((({view:e})=>n.createElement(q,{style:Wt},n.createElement("div",{className:Zt},"This document"),n.createElement(u.F.div,{className:qt},e("title")),n.createElement(u.F.div,{className:Yt},e("summary"))))),$t=r.UI.Union.asOption(Kt),Wt={position:"relative",padding:`${I.ux.rem(_.x)} ${I.ux.rem(_.qp)}`,gap:I.ux.rem(_.x),fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC)},Zt=I.ux.style({borderBottom:`${I.ux.rem(_.W9)} solid ${$.XY.Boundaries.Secondary.Default}`,paddingBottom:I.ux.rem(_.F2),marginBottom:I.ux.rem(_.F2),color:$.XY.Content.Secondary.Default,userSelect:"none"}),qt=I.ux.style({fontSize:I.ux.rem(_.qp+_.yC),color:$.XY.Content.Secondary.Default,fontWeight:600}),Yt=I.ux.style({color:$.XY.Content.Primary.Default}),Xt=e=>n.createElement(a.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),n.createElement("path",{d:"M12 7L12 17",strokeLinecap:"round"}),n.createElement("path",{d:"M9 9L9 15",strokeLinecap:"round"}),n.createElement("path",{d:"M15 9L15 15",strokeLinecap:"round"}),n.createElement("path",{d:"M18 11L18 13",strokeLinecap:"round"}),n.createElement("path",{d:"M6 11L6 13",strokeLinecap:"round"})),Qt=r.UI.Node.make((({notify:e})=>n.createElement(q,{style:ti},n.createElement("div",{className:ii},"Set your voice"),n.createElement("div",{className:ni},"Choose how you want your generated text to sound."),n.createElement(p.z.Primary,{className:si,onClick:e({kind:m.i.Kind.setVoiceButtonClick}),name:"bannerVoiceProfile",size:"small"},n.createElement(Xt,{className:ri}),"Set voice")))),Jt=r.UI.Union.asOption(Qt),ei="setVoiceBtn",ti={gap:0,backgroundColor:"#D8F2EC",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"right",backgroundImage:"url('https://d201kpdrh73vuz.cloudfront.net/text-generation/voice-banner.png')"},ii=I.ux.style({fontWeight:700,fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),color:$.XY.Content.Primary.Default}),ni=I.ux.style({fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),color:$.XY.Content.Secondary.Default}),ri=I.ux.style({stroke:"white"}),si=I.ux.joinClasses([ei,I.ux.style((0,de.dD)({alignSelf:"flex-start",marginTop:I.ux.rem(_.x),padding:`0 ${I.ux.rem(_.x)} 0 ${I.ux.rem(_.F2)}`,lineHeight:I.ux.rem(1.125),gap:I.ux.rem(_.F2),$nest:{"& > i":Object.assign({marginLeft:0},(0,de.fx)(1.5))}},ei))]),oi=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:li},e.suggestions,e.voiceBanner,e.documentOverview,e.intent,e.actions))),ai=r.UI.Knot.make(oi,{suggestions:Be,voiceBanner:Jt,intent:Le,actions:Vt,documentOverview:$t}),li=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.x)});var ci=i(60135);const ui=r.UI.Knot.make(r.UI.Grid.make((({slots:e,notify:t})=>{const{notifyUnmount:i}=n.useContext(qe),{onMount:r}=(0,_e.F)((0,y.ls)(V.b((e=>t({kind:m.i.Kind.mount,name:Ze.e.followUpActionsList,element:e})())),be.x((()=>i({kind:m.i.Kind.unmount,name:Ze.e.followUpActionsList})))));return n.createElement("div",{className:I.ux.style(gi),ref:r},e.actions)})),{actions:pt}),di=I.ux.color(R),mi=r.UI.Node.make((()=>n.createElement("div",{"aria-busy":!0,className:I.ux.style(gi,{position:"relative"})},n.createElement(Ge,{overlayGradientEndColor:`rgba(${di.red()}, ${di.green()}, ${di.blue()}, 0)`,overlayGradientCenterColor:`rgba(${di.red()}, ${di.green()}, ${di.blue()}, 0.5)`,overlayBlendMode:"screen"}),n.createElement(jt,{style:{width:I.ux.rem(8.5)},mode:"compact"}),n.createElement(jt,{style:{width:I.ux.rem(9.25)},mode:"compact"}),n.createElement(jt,{style:{width:I.ux.rem(8)},mode:"compact"}),n.createElement(jt,{style:{width:I.ux.rem(4.5)},mode:"compact"})))),pi=r.UI.Union.make("kind",{none:r.UI.Node.empty,loading:mi,actions:ui}),hi=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(n.Fragment,null,e.actions))),{actions:pi}),gi={display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end",flexDirection:"row",width:"100%",gap:I.ux.rem(_.x),marginBottom:I.ux.rem(_.x)},fi=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(q,{style:xi},e.actions))),{actions:Pt}),vi=r.UI.Union.make("kind",{loading:Gt,loaded:fi}),yi=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",null,e.actions))),{actions:vi}),bi=r.UI.Union.asOption(yi),xi={position:"relative",padding:`${I.ux.rem(_.F2)} ${I.ux.rem(_.qp)}`},Si=r.UI.Union.make("kind",{followUp:hi,newContext:bi}),ki="primaryBtn",wi="rephraseBtn",Ci="dismissBtn",_i="reportBtn",Ii=({isActive:e,id:t,children:i,onHovered:r,onFocused:s,onCopy:o,customStyles:a})=>{const l=n.useRef(null);return n.createElement(q,{ref:l,style:Object.assign(Object.assign({},Ai),a),"data-active":e,"data-id":t,onMouseEnter:()=>null==r?void 0:r(!0),onMouseLeave:()=>null==r?void 0:r(!1),onFocus:()=>{var e;return null==s?void 0:s((null===(e=l.current)||void 0===e?void 0:e.contains((0,Y.vY)(document)))||!1)},onBlur:()=>{var e;return null==s?void 0:s((null===(e=l.current)||void 0===e?void 0:e.contains((0,Y.vY)(document)))||!1)},onCopy:o},i)},Ei={backgroundColor:$.XY.Surface.Primary.Default,$nest:{[`& .${Ci}, & .${_i}`]:{opacity:1,pointerEvents:"auto"},[`& ${(0,de.s4)(ki,de.Ki)}`]:{color:$.XY.Surface.Primary.Default,backgroundColor:Ae.Z.BrandGreen60,border:"1px solid transparent"}}},Ai={backgroundColor:"transparent",$nest:{"&:not(:last-of-type)":{borderBottom:`0.5px solid ${w.BlueGray10}`},[`& ${(0,de.s4)(ki,de.Ki)}`]:{lineHeight:I.ux.rem(1.125),backgroundColor:$.XY.Surface.Primary.Default,color:$.XY.Content.Secondary.Default,border:`1px solid ${w.BlueGray5}`,boxSizing:"border-box"},[`& ${(0,de.s4)(wi,de.Ki)}`]:{lineHeight:I.ux.rem(1.5)},[`& .${Ci}, & .${_i}`]:{opacity:0,pointerEvents:"none",justifyContent:"center"},"&:focus, &:hover":Object.assign({},Ei),"&[data-active='true']":Object.assign({},Ei)}},Oi=({header:e,footer:t,isActive:i,resultId:r,onHovered:s,onFocused:o,onCopy:a,body:l,customStyles:c})=>n.createElement(Ii,{id:r,isActive:i,onHovered:s,onFocused:o,customStyles:c,onCopy:a},e,l,t);var Ri=i(10517);const Ti=({text:e})=>""!==e.trim()?n.createElement(Ri.s,null,e):null,Pi=({onInsert:e,onRephrase:t,onDismiss:i,onProvideFeedback:r,onReportOffensive:s,onReportMenuVisibilityChange:o,disabled:a})=>n.createElement("div",{className:Bi},n.createElement("div",{className:zi},(0,y.zG)(e,h.map((e=>n.createElement(p.z.Primary,{className:Mi,name:"insertResult",onClick:e,size:"small",key:"insert"},"Insert"))),h.toNullable),(0,y.zG)(t,h.map((e=>n.createElement(p.z.Tertiary,{className:Di,name:"rephraseResult",onClick:e,disabled:a,size:"small",key:"rephase"},"Rephrase"))),h.toNullable)),n.createElement("div",{className:Fi},n.createElement(p.z.Tertiary,{onClick:i,className:ji,compact:!0,size:"small",name:"dismissResult",title:"Delete"},n.createElement(lt,{className:Vi})),n.createElement(st,{reportMenuButtonClassName:Gi,onClickProvideFeedback:r,onClickReportOffensive:s,onOpenChange:o}))),Ui="ignoreIcon",Bi=I.ux.style({gap:I.ux.rem(_.x),display:"flex",alignItems:"center",justifyContent:"space-between"}),Ni={display:"flex",alignItems:"center",gap:I.ux.rem(_.x)},zi=I.ux.style(Ni),Fi=I.ux.style(Ni),ji=Ci,Gi=_i,Mi=ki,Di=wi,Vi=I.ux.joinClasses([Ui,I.ux.style((0,de.dD)((0,de.fx)(1.5),Ui))]),Hi=r.UI.Grid.make((({state:e,notify:t,slots:i})=>n.createElement(u.F.Fragment,null,e.pipe(l.U((({disabled:e,result:r,originalAction:s})=>n.createElement(Oi,{resultId:r.id,body:n.createElement(n.Fragment,null,n.createElement("div",{className:I.ux.style({borderBottom:`0.5px solid ${w.BlueGray10}`})},n.createElement(Ti,{text:r.text}),n.createElement("div",{className:I.ux.style({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:I.ux.rem(.5),marginTop:I.ux.rem(.5),marginBottom:I.ux.rem(.75)})},i.actions)),(0,y.zG)(s,h.map((i=>n.createElement("div",null,n.createElement(Ti,{text:"Continue with your original prompt:"}),n.createElement("div",{className:I.ux.style({paddingTop:I.ux.rem(.125)})},n.createElement(Li,{disabled:e,action:i,onClick:t({kind:m.i.Kind.userPromptSubmit,prompt:i})}))))),h.toNullable)),header:n.createElement("h2",{className:I.ux.style({fontSize:I.ux.rem(1),marginBottom:I.ux.rem(.2),marginTop:0,lineHeight:I.ux.rem(1.5)})},"Review your AI use"),isActive:!0,footer:n.createElement(Pi,{onRephrase:h.none,onInsert:h.none,onDismiss:t({kind:m.i.Kind.resultCardDismissButtonClick,result:r}),onProvideFeedback:t({kind:m.i.Kind.openFeedbackFormButtonClick,source:We.x.Source.resultCard}),onReportOffensive:t({kind:m.i.Kind.reportOffensiveResultButtonClick,result:r}),onReportMenuVisibilityChange:e=>t({kind:m.i.Kind.reportMenuVisibilityChange,trigger:ot.G.card(r.id),visible:e})(),disabled:e}),customStyles:{borderColor:w.Gold40,borderTopWidth:I.ux.rem(.375)}}))))))),Li=({action:e,onClick:t,disabled:i})=>n.createElement("button",{onClick:t,disabled:i,className:I.ux.style({textDecoration:"underline",color:w.BlueGray60,background:I.ux.important("none"),border:"none",cursor:"pointer",lineHeight:I.ux.rem(1.375),fontSize:I.ux.rem(.875),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",textAlign:"left"})},'"',e.arg.value,'"'),Ki=r.UI.Knot.make(Hi,{actions:pt});var $i=i(95195),Wi=i(14047);const Zi=({className:e})=>n.createElement("div",Object.assign({role:"separator"},(0,d.Sh)(qi,e))),qi=I.ux.style({position:"relative",width:"100%",borderBottom:`0.5px solid ${w.BlueGray10}`});var Yi=i(51739);const Xi=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.784 6.21a.727.727 0 0 1 .006 1.029L9.203 17.943 4.21 12.895a.727.727 0 1 1 1.034-1.023l3.959 4.003 9.553-9.66a.727.727 0 0 1 1.028-.005Z",fill:"#646B81"})),Qi=({className:e,title:t,description:i})=>n.createElement("div",{className:I.ux.joinClasses([Ji,e])},n.createElement("div",{className:en},n.createElement("span",{className:sn},t)),n.createElement("ul",{className:tn},i.map(((e,t)=>n.createElement("li",{className:nn,key:t},n.createElement(Xi,{className:rn}),n.createElement("span",{className:on},e)))))),Ji=I.ux.style({display:"flex",flexDirection:"column"}),en=I.ux.style({display:"flex"}),tn=I.ux.style({display:"flex",flexDirection:"column",listStyle:"none",margin:0,padding:0,$nest:{"& li":{marginTop:I.ux.rem(_.F2)}}}),nn=I.ux.style({display:"flex",alignItems:"center"}),rn=I.ux.style({marginRight:I.ux.rem(_.x),width:I.ux.rem(_.mh),maxHeight:I.ux.rem(_.mh+_.yC),$nest:{"& path:first-of-type":{fill:w.Green60}}}),sn=I.ux.style({fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC),fontWeight:700,color:$.XY.Content.Secondary.Default}),on=I.ux.style({fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC),color:$.XY.Content.Secondary.Default,flex:1});var an=i(18208),ln=i(65223),cn=i(84);function un(e,t){var i,r;const[s,o]=(0,n.useState)(void 0);return(0,n.useEffect)((()=>{e.current&&e.current.scrollWidth>e.current.clientWidth&&o(t)}),[null===(i=e.current)||void 0===i?void 0:i.scrollWidth,null===(r=e.current)||void 0===r?void 0:r.clientWidth,t]),s}const dn=({title:e,url:t,contextText:i})=>{const r=n.useRef(null),s=un(r,e),o=(0,y.zG)(i,h.getOrElse((()=>s)));return(0,y.zG)(t,h.fold((()=>n.createElement(hn,{tooltip:o},n.createElement("span",{className:mn,ref:r},e))),(t=>n.createElement(hn,{tooltip:o},n.createElement("div",{className:pn},n.createElement(cn.d,{href:t,className:mn,ref:r},e))))))},mn=I.ux.style({display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",maxWidth:"100%",$nest:{"&:visited":{color:"inherit"}}}),pn=I.ux.style({display:"flex",alignItems:"center",width:"100%",overflow:"hidden"}),hn=({children:e,tooltip:t})=>t?n.createElement(ln.u,{align:"topCenter",title:n.createElement("div",{className:gn},t)},e):n.createElement(n.Fragment,null,e),gn=I.ux.style({maxWidth:I.ux.rem(80*_.F2),textAlign:"left",whiteSpace:"normal",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":5,"-webkit-box-orient":"vertical"}),fn=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M12 10.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm-10 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#646B81"})),vn=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.194 7.5H7.5v-1H11V10h-1V8.18a4.926 4.926 0 0 0-2.5 4.32 5.002 5.002 0 0 0 3.214 4.672l-.357.934A6.002 6.002 0 0 1 6.5 12.5a5.925 5.925 0 0 1 2.694-5Zm8.306 5c0-2.128-1.33-3.92-3.214-4.64l.357-.934c2.251.86 3.857 3.011 3.857 5.574a5.988 5.988 0 0 1-2.655 5H17.5v1H14V15h1v1.848a4.985 4.985 0 0 0 2.5-4.348Z",fill:"#646B81"})),yn=({onRegenerateWithoutReference:e})=>n.createElement(et,{name:"referenceMenu",title:"Reference menu","aria-label":"Reference menu",label:n.createElement(fn,null),theme:{button:bn},onAction:t=>{if("regenerateWithoutReference"===t)return e()}},n.createElement(Ye.v.Item,{key:"regenerateWithoutReference",textValue:"regenerateWithoutReference"},n.createElement(vn,{className:xn}),"Regenerate without this reference")),bn=(0,it.P)({type:"tertiary",compact:!0,size:"small"}),xn=I.ux.style({marginRight:I.ux.rem(_.x)}),Sn=({className:e,children:t})=>n.createElement("div",Object.assign({},(0,d.Sh)(kn,e)),t),kn=I.ux.style({color:w.BlueGray60,fontWeight:400,fontSize:I.ux.rem(.625),lineHeight:I.ux.rem(1),background:w.BlueGray0,borderRadius:I.ux.rem(C.fe),padding:`0 ${I.ux.rem(_.F2)}`,cursor:"default"}),wn=({privacyLevel:e})=>{switch(e.kind){case"public":return n.createElement(Cn,null);case"restricted":return n.createElement(_n,null);default:return(0,y.Rz)(e)}},Cn=()=>n.createElement(n.Fragment,null),_n=()=>n.createElement(ln.u,{align:"topLeft",title:n.createElement("div",{className:In},"This item has restricted access and is only visible to those added to the file")},n.createElement(Sn,{className:En},"Private")),In=I.ux.style({width:I.ux.rem(9),overflowWrap:"normal",whiteSpace:"normal",textAlign:"left"}),En=I.ux.style({border:`1px solid ${Ae.Z.BorderBaseSubduedColor}`,borderRadius:I.ux.rem(_.F2)}),An=({className:e,isOpen:t,references:i,onOpenChange:r,onRegenerateWithoutReference:s,onReferencesMount:o})=>{const{onMount:l}=(0,_e.F)(V.b(o));return n.createElement(u.F.div,{className:e,mount:l},n.createElement(p.z.Tertiary,{style:On,onClick:()=>r(!t),name:"collapseReferencesList",size:"small"},n.createElement("span",{className:Tn},i.length," ",an._6(i.length,"reference","references")),t?n.createElement(a.JO.Arrow,{direction:a.n4.up}):n.createElement(a.JO.Arrow,{direction:a.n4.down})),n.createElement("ul",{className:Pn,hidden:!t,"aria-hidden":!t},i.map((({id:e,privacyLevel:t,title:i,iconUrl:r,url:o,contextText:a},l)=>n.createElement("li",{key:l,className:Un},n.createElement("img",{src:r,className:Bn,alt:""}),n.createElement(dn,{title:i,url:o,contextText:a}),n.createElement("div",{className:Nn},n.createElement(wn,{privacyLevel:t}),void 0!==s?n.createElement(yn,{onRegenerateWithoutReference:()=>s(e)}):null))))))},On={base:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:I.ux.rem(_.F2),paddingRight:0}},Rn={fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC),color:$.XY.Content.Secondary.Default,userSelect:"none"},Tn=I.ux.style(Rn),Pn=I.ux.style({fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC),color:$.XY.Content.Primary.Default,margin:0,padding:0}),Un=I.ux.style({height:I.ux.rem(_.sD),display:"flex",alignItems:"center",borderRadius:I.ux.rem(C.xB)}),Bn=I.ux.style({minWidth:I.ux.rem(_.mh),height:I.ux.rem(_.mh),marginRight:I.ux.rem(_.x)}),Nn=I.ux.style({display:"flex",alignItems:"center",justifyContent:"space-between",marginLeft:"auto"}),zn=r.UI.Node.make((({state:e,notify:t})=>n.createElement(u.F.div,null,e.pipe(l.U((({selectedRange:e,selectedText:i})=>e?n.createElement(p.z.Tertiary,{title:"Select any text to work with it in Grammarly.",style:{base:jn},onClick:t({kind:m.i.Kind.selectionContextInteraction,range:e,visibility:"attention"}),onMouseEnter:t({kind:m.i.Kind.selectionContextInteraction,range:e,visibility:"visible"}),onMouseLeave:t({kind:m.i.Kind.selectionContextInteraction,range:e,visibility:"hidden"})},n.createElement(Ct,null,i)):n.createElement("div",{className:Gn},n.createElement(Ct,null,i)))))))),Fn=r.UI.Union.asOption(zn),jn={paddingLeft:I.ux.rem(_.qp),paddingRight:I.ux.rem(_.qp),paddingTop:I.ux.rem(_.F2),paddingBottom:I.ux.rem(_.F2),marginBottom:I.ux.rem(-_.F2),justifyContent:"flex-start",minHeight:0},Gn=I.ux.style({paddingLeft:I.ux.rem(_.qp),paddingRight:I.ux.rem(_.qp),paddingTop:I.ux.rem(_.F2),paddingBottom:I.ux.rem(_.F2),marginBottom:I.ux.rem(-_.F2)});var Mn=i(20491);const Dn=r.UI.Grid.make((({slots:e,state:t,notify:i})=>n.createElement(u.F.Fragment,null,e.contextHeader,t.pipe(l.U((({result:t,disabled:r,isActive:s,isReferencesOpen:o,isMyVoice:a})=>n.createElement(Oi,{resultId:t.id,body:n.createElement(Yi.r,{replacementDelta:(0,y.zG)(t.replacementDelta,$i.fold(y.yR,(e=>a?e.user:e.generic)))}),header:e.header,footer:n.createElement(n.Fragment,null,(0,y.zG)(Wi.x.isComplete(t)?t.changesSummary:h.none,h.map((e=>n.createElement(n.Fragment,null,n.createElement(Zi,{className:Hn}),n.createElement(Qi,{title:e.title,description:e.description,className:Ln})))),h.toNullable),n.createElement(Pi,{onRephrase:(0,y.zG)(t,h.fromPredicate(Wi.x.isComplete),h.filter((e=>e.isRephraseable)),h.map((e=>i({kind:m.i.Kind.resultCardRephraseButtonClick,result:e,selectedVoice:a?Wi.x.GeneratedTextVoice.user:Wi.x.GeneratedTextVoice.generic})))),onInsert:(0,y.zG)(t.primaryAction,h.filter((e=>e===Wi.x.PrimaryAction.insert)),h.map((()=>i({kind:m.i.Kind.resultCardInsertButtonClick,result:t,selectedVoice:a?Wi.x.GeneratedTextVoice.user:Wi.x.GeneratedTextVoice.generic})))),onDismiss:i({kind:m.i.Kind.resultCardDismissButtonClick,result:t}),onProvideFeedback:i({kind:m.i.Kind.openFeedbackFormButtonClick,source:We.x.Source.resultCard}),onReportOffensive:i({kind:m.i.Kind.reportOffensiveResultButtonClick,result:t}),onReportMenuVisibilityChange:e=>i({kind:m.i.Kind.reportMenuVisibilityChange,trigger:ot.G.card(t.id),visible:e})(),disabled:r}),(0,y.zG)(t.references,h.filter((e=>e.length>0)),h.map((e=>n.createElement(An,{className:Kn,isOpen:o,references:e,onOpenChange:e=>i({kind:m.i.Kind.referencesVisibilityChange,visible:e,resultId:t.id})(),onRegenerateWithoutReference:Wi.x.isComplete(t)?e=>i({kind:m.i.Kind.regenerateWithoutReferenceButtonClick,result:t,referenceId:e,selectedVoice:a?Wi.x.GeneratedTextVoice.user:Wi.x.GeneratedTextVoice.generic})():void 0,onReferencesMount:e=>i({kind:m.i.Kind.mount,name:Ze.e.referencesList,element:e})()}))),h.toNullable)),isActive:s,onHovered:e=>i({kind:m.i.Kind.resultCardHoverChange,hovered:e,resultId:t.id})(),onFocused:e=>i({kind:m.i.Kind.resultCardFocusChange,focused:e,resultId:t.id})(),onCopy:i({kind:m.i.Kind.resultCardCopy,resultId:t.id})}))))))),Vn=r.UI.Knot.make(Dn,{header:Mn.mP,contextHeader:Fn}),Hn=I.ux.style({margin:`${I.ux.rem(_.F2)} 0`}),Ln=I.ux.style({marginBottom:I.ux.rem(_.F2)}),Kn=I.ux.style({marginTop:I.ux.rem(_.x)});var $n=i(4784),Wn=i(28518);const Zn=r.UI.Node.make((({state:e})=>n.createElement(u.F.Fragment,null,e.pipe(l.U((({resultText:e,statusText:t,isMyVoiceStatus:i,sourceLabel:r,sourceIconUrl:s})=>n.createElement(Oi,{resultId:"in-progress",header:n.createElement(qn,null,n.createElement($n.L,{header:e.length>0?r:t,iconUrl:e.length>0?s:h.none,loading:0===e.length}),n.createElement(Wn.w,{isBadge:!0,isAnimated:!0,isMyVoice:i,label:"Use my style"})),body:e.length>0?n.createElement(n.Fragment,null,n.createElement(Ti,{text:e}),n.createElement(Xn,null)):null,isActive:!0}))))))),qn=({children:e})=>n.createElement("div",{className:Yn},e),Yn=I.ux.style({display:"grid",gridTemplateColumns:"1fr auto"}),Xn=()=>n.createElement("div",{className:I.ux.style({position:"relative",overflow:"hidden",height:I.ux.rem(.5),borderRadius:I.ux.rem(C.xB),background:w.BlueGray5,flexGrow:1})},n.createElement(Ge,null)),Qn=r.UI.Node.make((({state:e})=>n.createElement(u.F.Fragment,null,e.pipe(l.U((({result:e})=>n.createElement(Oi,{resultId:"in-progress",body:n.createElement(Ti,{text:e.text}),header:n.createElement($n.L,{header:"Working on it...",iconUrl:h.none,loading:!0}),isActive:!0}))))))),Jn=r.UI.Union.make("kind",{regularCardInProgress:Qn,myVoiceCardInProgress:Zn}),er=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(n.Fragment,null,e.header,e.content))),{content:Jn,header:Fn}),tr=r.UI.Union.asOption(er);var ir=i(86148),nr=i(31542),rr=i(15073),sr=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const or="#161719",ar="#646B81",lr=e=>{var{children:t,style:i,dataGrammarlyPart:r="ui-kit-iframe"}=e,s=sr(e,["children","style","dataGrammarlyPart"]);const[o,a]=n.useState(null),l=n.useCallback((e=>{var t,i;let n=null;"contentDocument"in e.target&&(n=null!==(i=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==i?i:null),a(n),n&&(n.style.margin="0",n.style.height="100vh",n.style.overflowY="hidden")}),[]),c=n.useContext(rr.u.Context);return n.useEffect((()=>{const e=c.subscribe((e=>{o&&rr.u.setRootCssVar(o,h.some(e))}));return()=>e.unsubscribe()}),[o]),n.createElement("iframe",Object.assign({},s,{style:Object.assign({},i),onLoad:l,srcDoc:"<html><body></body></html>","data-grammarly-part":r}),o&&(0,nr.createPortal)(t,o))},cr=1.375,ur=({fitContentHeight:e,text:t,ariaLabel:i,onChange:r,placeholder:s,disabled:o,className:a,onFocus:l,onBlur:c,onKeyDownEnter:u,autofocus:d,onKeyUpEscape:m,onKeyDownArrowUp:p,onKeyDownArrowDown:h,onKeyDownShiftEnter:g,theme:f})=>{var v,y,b,x,S,k,w,_,E,A,O,R,T,P,U;const B=cr*(s?s.length:1)+(null!==(y=null===(v=null==f?void 0:f.padding)||void 0===v?void 0:v.top)&&void 0!==y?y:0)+(null!==(x=null===(b=null==f?void 0:f.padding)||void 0===b?void 0:b.bottom)&&void 0!==x?x:0),[N,z]=n.useState({kind:"rem",value:B}),[F,j]=n.useState(null);return n.useEffect((()=>{F&&void 0!==d&&(F.focus(),F.selectionStart=t.length,F.selectionEnd=t.length)}),[d,F]),n.useLayoutEffect((()=>{if(""===t)z({kind:"rem",value:B});else{const e=null==F?void 0:F.scrollHeight;z(e?{kind:"px",value:e}:{kind:"rem",value:B})}}),[t,F,s]),n.createElement(lr,{className:a,style:{height:e?"rem"===N.kind?I.ux.rem(N.value):I.ux.px(N.value):void 0,maxHeight:(null==f?void 0:f.maxHeight)?I.ux.rem(f.maxHeight):"none",minHeight:(null==f?void 0:f.minHeight)?I.ux.rem(f.minHeight):"none"},title:`${i} container`},n.createElement("style",{dangerouslySetInnerHTML:{__html:`\n      .container {\n        position: relative;\n        width: 100%;\n        height: 100%;\n      }\n      .textarea {\n        box-sizing: border-box;\n        border-radius: ${I.ux.rem(C.xB)};\n        overflow-y: auto;\n        padding: ${I.ux.rem(null!==(k=null===(S=null==f?void 0:f.padding)||void 0===S?void 0:S.top)&&void 0!==k?k:0)} ${I.ux.rem(null!==(_=null===(w=null==f?void 0:f.padding)||void 0===w?void 0:w.right)&&void 0!==_?_:0)} ${I.ux.rem(null!==(A=null===(E=null==f?void 0:f.padding)||void 0===E?void 0:E.bottom)&&void 0!==A?A:0)} ${I.ux.rem(null!==(R=null===(O=null==f?void 0:f.padding)||void 0===O?void 0:O.left)&&void 0!==R?R:0)};\n        width: 100%;\n        height: 100%;\n        border: none;\n        background: transparent;\n        resize: none;\n        font-family: Inter, sans-serif;\n        font-size: ${null!==(T=null==f?void 0:f.fontSize)&&void 0!==T?T:I.ux.rem(.875)};\n        font-weight: 400;\n        color: ${null!==(P=null==f?void 0:f.color)&&void 0!==P?P:or};\n      }\n      .textarea::placeholder {\n        color: ${ar};\n      }\n      .textarea:focus {\n        outline: none;\n      }\n      .placeholder {\n        position: absolute;\n        top: 0px;\n        left: 0px;\n        width: 100%;\n        height: 100%;\n        background: transparent;\n        font-family: Inter, sans-serif;\n        font-size: ${I.ux.rem(.875)};\n        font-weight: 400;\n        z-index: -1;\n        color: ${ar};\n      }\n      `}}),n.createElement("div",{className:"container"},n.createElement("textarea",{"aria-label":i,className:"textarea",style:{lineHeight:null!==(U=null==f?void 0:f.lineHeight)&&void 0!==U?U:I.ux.rem(cr)},value:t,ref:j,onChange:e=>r(e.target.value),placeholder:1===(null==s?void 0:s.length)?s[0]:void 0,disabled:o,onFocus:()=>null==l?void 0:l(),onBlur:()=>null==c?void 0:c(),onKeyDown:e=>{var t;u&&"Enter"===e.key&&!e.shiftKey?(e.preventDefault(),e.stopPropagation(),u()):"ArrowUp"===e.key&&p&&(dr(t=e.currentTarget)&&0===t.selectionStart)?(e.preventDefault(),e.stopPropagation(),p()):"ArrowDown"===e.key&&h&&function(e){return dr(e)&&e.selectionStart===e.value.length}(e.currentTarget)?(e.preventDefault(),e.stopPropagation(),h()):"Enter"===e.key&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),null==g||g())},onKeyUp:e=>{m&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),m())}}),((null==s?void 0:s.length)||0)>1&&""===t?n.createElement("div",{className:"placeholder",style:{lineHeight:I.ux.rem(cr)}},(s||[]).map(((e,t)=>n.createElement(n.Fragment,{key:t},e,n.createElement("br",null))))):null))};function dr(e){return e.selectionStart===e.selectionEnd}const mr=({placeholder:e,error:t,openAnswer:i,onOpenAnswerChange:r,onSubmitButtonClick:s,onCancelButtonClick:o,onKeypressShiftEnter:a})=>n.createElement("form",{className:hr,onSubmit:e=>e.preventDefault()},n.createElement(ur,{className:yr,placeholder:[null!=e?e:""],text:i,onChange:r,ariaLabel:"Open ended answer",fitContentHeight:!0,theme:{fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125)},onKeyDownShiftEnter:a}),(0,y.zG)(t,h.fold((()=>null),(e=>n.createElement("div",{className:br},e)))),n.createElement("div",{className:pr},n.createElement("input",{type:"submit",value:"Submit",hidden:!0}),n.createElement(p.z.Secondary,{style:{base:Object.assign(Object.assign({},gr),fr),hovered:vr},onClick:s},"Submit"),n.createElement(p.z.Tertiary,{style:{base:gr},onClick:o},"Dismiss"))),pr=I.ux.style({display:"flex",justifyContent:"flex-start",alignItems:"center"}),hr=I.ux.style({width:I.ux.percent(100)}),gr={minHeight:I.ux.rem(_.sD),lineHeight:I.ux.rem(_.sD)},fr={color:$.C$.Engagement.Primary.Default,fontWeight:"bold",boxShadow:`inset 0 0 0 1px ${$.C$.Engagement.Primary.Default}`,marginRight:I.ux.rem(_.x)},vr={color:$.XY.Surface.Primary.Default,backgroundColor:$.C$.Engagement.Primary.Default},yr=I.ux.style({border:`1px solid ${w.BlueGray10}`,minHeight:I.ux.rem(7.5*_.F2),backgroundColor:w.White,borderRadius:I.ux.rem(_.x),width:I.ux.percent(100),padding:`${I.ux.rem(1.25*_.F2)} ${I.ux.rem(_.x)}`,boxSizing:"border-box"}),br=I.ux.style({color:$.vU.DangerAndDeletion.Primary.Default,fontSize:I.ux.rem(.75),marginBottom:I.ux.rem(_.F2)});var xr=i(77678),Sr=i(56377);const kr=e=>n.createElement(a.a1,Object.assign({width:"18",height:"17",viewBox:"0 0 18 17",fill:"none"},e),n.createElement("path",{d:"M9 1L11.069 6.15226L16.6085 6.52786L12.3477 10.0877L13.7023 15.4721L9 12.52L4.29772 15.4721L5.65228 10.0877L1.39155 6.52786L6.931 6.15226L9 1Z",fill:"transparent",stroke:w.NeutralGray50,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})),wr=({rating:e,ratingLabels:t,maxScore:i})=>(0,y.zG)(e,h.fold((()=>t.length>=i&&i>1?n.createElement("div",{className:Ir},n.createElement("span",{className:_r},t[0]),n.createElement("span",{className:_r},t[i-1])):null),(e=>e-1>=0&&t.length>=e?n.createElement("div",{className:Cr},n.createElement("span",null,t[e-1])):null))),Cr=I.ux.style({display:"flex",justifyContent:"center",alignItems:"center",width:"100%",fontWeight:"bold",fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(.875)}),_r=I.ux.style({color:w.NeutralGray50}),Ir=I.ux.style({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(.875)});var Er=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const Ar=({disabled:e,rating:t,ratingLabels:i,maxScore:r,onSelectionChange:s})=>{const[o,a]=n.useState(h.none),l=n.useMemo((()=>[]),[]),c=t=>{e||s(t+1)},u=t=>{e||a(h.some(t+1))},d=()=>{e||a(h.none)};return n.createElement(n.Fragment,null,n.createElement("div",{className:Or,role:"slider","aria-valuemin":0,"aria-valuenow":(0,y.zG)(t,h.getOrElse((()=>0))),"aria-valuemax":5,"aria-valuetext":(0,y.zG)(t,h.fold((()=>"Not yet rated"),(e=>i[e-1])))},Array.from({length:r}).map(((s,a)=>n.createElement(Rr,{key:a,onClick:()=>c(a),style:{maxWidth:I.ux.percent(r>0?100/r:0)},isFilled:(0,y.zG)(t,h.fold((()=>!1),(e=>a<e)))||(0,y.zG)(o,h.fold((()=>!1),(e=>a<e))),onMouseEnter:()=>u(a),onMouseLeave:d,onFocus:()=>u(a),onBlur:d,isSelected:(0,y.zG)(t,h.fold((()=>!1),(e=>a+1===e))),isFocusable:(0,y.zG)(t,h.fold((()=>0===a),(e=>a+1===e))),ariaLabel:`Rate this generated output as ${i[a]}`,ref:e=>l.push(e),onKeyDown:t=>((t,i)=>{var n,s,a,u;e||("ArrowRight"!==t.key&&"ArrowUp"!==t.key||((0,y.zG)(o,h.fold((()=>!1),(e=>e<r)))?null===(n=l[i+1])||void 0===n||n.focus():null===(s=l[0])||void 0===s||s.focus()),"ArrowLeft"!==t.key&&"ArrowDown"!==t.key||((0,y.zG)(o,h.fold((()=>!1),(e=>e>1)))?null===(a=l[i-1])||void 0===a||a.focus():null===(u=l[4])||void 0===u||u.focus()),"Enter"!==t.key&&" "!==t.key||c(i))})(t,a),disabled:e})))),n.createElement(wr,{rating:(0,y.zG)(t,h.fold((0,y.a9)(o),(0,y.a9)(t))),ratingLabels:i,maxScore:r}),n.createElement(Sr.L,{small:!0}))},Or=I.ux.style({display:"flex",width:I.ux.percent(100),justifyContent:"center"}),Rr=n.forwardRef(((e,t)=>{var{isFilled:i,ariaLabel:r,disabled:s,isSelected:o,isFocusable:a}=e,l=Er(e,["isFilled","ariaLabel","disabled","isSelected","isFocusable"]);return n.createElement("button",Object.assign({className:Tr,role:"radio","aria-label":r,disabled:s,"aria-checked":o,tabIndex:a?0:-1,ref:t},l),n.createElement(kr,{className:i?Pr:""}))}));Rr.displayName="StarButton";const Tr=I.ux.style({border:"none",background:"none",cursor:"pointer",padding:0,borderRadius:I.ux.rem(_.F2),width:I.ux.rem(_.Lw),$nest:{"&:focus-visible":{outlineStyle:"none",boxShadow:`0 0 0 2px ${$.XY.Content.Secondary.Default}`}}}),Pr=I.ux.style({$nest:{"& path":{fill:xr.CoreYellow50,stroke:xr.CoreYellow50}}});var Ur=i(59769),Br=i(46560);const Nr=({stage:e,rating:t,initialTitle:i,acknowledgment:r,acknowledgmentTitle:s,onCloseButtonClick:o,className:a})=>n.createElement("div",{className:I.ux.joinClasses([zr,a])},n.createElement(Ur._,{className:jr,fill:"#000"}),n.createElement(Gr,{stage:e,rating:t,initialTitle:i,acknowledgment:r,acknowledgmentTitle:s}),n.createElement(p.z.Tertiary,{"aria-label":"Close survey",style:{base:{marginLeft:"auto",padding:0,minWidth:I.ux.rem(_.qp),minHeight:I.ux.rem(_.qp)},hovered:{backgroundColor:w.BlueGray10},active:{backgroundColor:w.BlueGray10}},onClick:o},n.createElement(Br.B,null))),zr=I.ux.style({display:"flex",alignItems:"center"}),Fr=I.ux.style({fontSize:I.ux.rem(.75)}),jr=I.ux.style({marginRight:I.ux.rem(_.qp),$nest:{"& path:first-of-type":{fill:w.NeutralGray70}}}),Gr=({stage:e,rating:t,initialTitle:i,acknowledgmentTitle:r,acknowledgment:s})=>{switch(e){case ir.x.Stage.Type.Rating:return n.createElement("span",{className:Fr},i);case ir.x.Stage.Type.Feedback:return n.createElement("span",{className:Fr},"Your rating:"," ",Array.from({length:t}).map((()=>"⭐")).join(" "));case ir.x.Stage.Type.Completed:return n.createElement("span",{className:Fr},(0,y.zG)(r,h.fold((()=>n.createElement("b",null,"Thank you!")),(e=>n.createElement("b",null,e))))," ",(0,y.zG)(s,h.fold((()=>"Your feedback helps us improve."),(e=>e))));case ir.x.Stage.Type.Closed:return null;default:return(0,c.L0)(e)}},Mr=r.UI.Union.asOption(r.UI.Node.make((({notify:e,state:t})=>n.createElement(u.F.Fragment,null,t.pipe(l.U((t=>n.createElement(Dr,Object.assign({},t,{onRatingSelectionChange:t=>{e({kind:m.i.Kind.surveyRatingSelectionChange,rating:t})()},onOpenAnswerChange:t=>e({kind:m.i.Kind.surveyOpenAnswerChange,openAnswer:t})(),onSubmitButtonClick:e({kind:m.i.Kind.surveySubmitButtonClick}),onKeypressShiftEnter:e({kind:m.i.Kind.surveyKeyPressShiftEnter}),onCancelButtonClick:e({kind:m.i.Kind.surveyCancelButtonClick}),onCloseButtonClick:e({kind:m.i.Kind.surveyCloseButtonClick})}))))))))),Dr=({survey:e,stage:t,transitionStage:i,rating:r,errors:s,openAnswer:o,onOpenAnswerChange:a,onRatingSelectionChange:l,onCloseButtonClick:c,onCancelButtonClick:u,onSubmitButtonClick:d,onKeypressShiftEnter:m})=>n.createElement("div",{className:Vr},n.createElement(Nr,{className:I.ux.joinClasses([i===ir.x.Stage.Type.Feedback?Kr:void 0,t===ir.x.Stage.Type.Feedback?$r:void 0]),stage:t,rating:(0,y.zG)(r,h.getOrElse((0,y.a9)(1))),initialTitle:e.title,acknowledgment:e.acknowledgment,acknowledgmentTitle:e.acknowledgmentTitle,onCloseButtonClick:c}),t!==ir.x.Stage.Type.Completed&&n.createElement(n.Fragment,null,n.createElement("div",{className:I.ux.joinClasses([Wr,i===ir.x.Stage.Type.Feedback?Kr:void 0,t===ir.x.Stage.Type.Feedback?$r:void 0])},n.createElement("div",{className:qr,hidden:t!==ir.x.Stage.Type.Rating},n.createElement(Ar,{onSelectionChange:l,rating:r,disabled:h.isSome(r),maxScore:e.maxScore,ratingLabels:e.ratingLabels})),(0,y.zG)(e.openAnswer,h.fold((0,y.a9)("(Optional) Please share your feedback to help us improve."),(e=>e.placeholder)),(e=>n.createElement("div",{className:Zr,hidden:t!==ir.x.Stage.Type.Feedback},n.createElement(mr,{placeholder:e,onSubmitButtonClick:d,onKeypressShiftEnter:m,onCancelButtonClick:u,onOpenAnswerChange:a,openAnswer:o,error:(0,y.zG)(s,h.chain((e=>e.openAnswerError)))}))))))),Vr=I.ux.style({backgroundColor:w.BlueGray0,border:`1px solid ${w.BlueGray10}`,borderRadius:I.ux.rem(_.F2),padding:`${I.ux.rem(_.x)} ${I.ux.rem(_.mh)}`}),Hr=I.ux.keyframes({from:{opacity:1},to:{opacity:.3}}),Lr=I.ux.keyframes({from:{opacity:.3},to:{opacity:1}}),Kr=I.ux.style({animation:`${Hr} 0.3s ease-in-out`}),$r=I.ux.style({animation:`${Lr} 0.3s ease-in-out`}),Wr=I.ux.style({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:I.ux.rem(_.yC)}),Zr=I.ux.style({width:I.ux.percent(100)}),qr=I.ux.style({maxWidth:I.ux.percent(100),width:"fit-content",paddingTop:I.ux.rem(_.F2)}),Yr=r.UI.Grid.make((({slots:e,view:t})=>{const{ref:i,onMount:r}=s.P.useElWatcher(),o=n.useMemo((()=>Ie.aj([i.pipe(D.oA,l.U((e=>h.fromNullable((0,Y.$Q)(e,3)))),D.oA),t("scrollToken").pipe(ft.x())]).pipe(l.U(ci.li),V.b((e=>{e.scrollTop=e.scrollHeight-e.clientHeight})))),[i]);return s.P.useSubscriptionTo(o),n.createElement("div",{className:rs,ref:r},e.intent,e.results,e.userSurvey,e.belowResults)})),Xr=r.UI.Union.make("kind",{complete:Vn,aiUsageNotification:Ki}),Qr=r.UI.List.make(K.bw,Xr),Jr=r.UI.Union.asOption(r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:ss},e.history))),Qr)),es=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(n.Fragment,null,e.actions))),{actions:Si}),ts=r.UI.Union.make("kind",{inProgressResult:tr,error:pe,actions:es}),is=r.UI.Union.asOption(ts),ns=r.UI.Knot.make(Yr,{intent:Le,results:Jr,userSurvey:Mr,belowResults:is}),rs=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.x)}),ss=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.x)});var os=i(16118),as=i(39505);const ls={padding:0,height:I.ux.rem(14.625),overflow:"hidden",boxSizing:"border-box",maxHeight:"inherit"},cs=I.ux.style({height:"100%",borderRadius:I.ux.rem(C.xB+C.fe)}),us=I.ux.style({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),ds=I.ux.style({border:"none",borderRadius:I.ux.rem(C.xB+C.fe),margin:"0",height:"100%",width:"100%"}),ms=I.ux.style({color:$.XY.Content.Secondary.Default,fontSize:I.ux.rem(.75),fontFamily:"Inter",fontWeight:700,lineHeight:I.ux.rem(1.125)}),ps=I.ux.style({color:$.XY.Content.Secondary.Default,fontSize:I.ux.rem(.75),fontFamily:"Inter",lineHeight:I.ux.rem(1.125)}),hs=I.ux.style({visibility:"hidden",position:"absolute"}),gs=r.UI.Node.make((({view:e,notify:t})=>{const{notifyUnmount:i}=n.useContext(qe),{ref:r,onMount:o}=(0,_e.F)((0,y.ls)(V.b((e=>t({kind:m.i.Kind.mount,name:Ze.e.skill,element:e})())),be.x((()=>i({kind:m.i.Kind.unmount,name:Ze.e.skill}))))),a=n.useMemo((()=>e("status").pipe(os.G(),W.h((([e,t])=>"loading"===e&&"ready"===t)),Xe.w((()=>r.pipe(D.oA,V.b((e=>e.focus()))))))),[r]);return s.P.useSubscriptionTo(a),n.createElement(u.F.Fragment,null,e("size").pipe(l.U((t=>n.createElement(q,{style:Object.assign(Object.assign({},ls),{height:t.height})},n.createElement(u.F.Fragment,null,e("status").pipe(l.U((t=>"loading"===t||"ready"===t?n.createElement(n.Fragment,null,n.createElement("div",Object.assign({},(0,d.Sh)(cs,us,"ready"===t?hs:void 0)),n.createElement(as.H,null),n.createElement("span",{className:ps},"Loading...")),n.createElement(u.F.Fragment,null,e("srcUrl").pipe(l.U((e=>n.createElement("iframe",Object.assign({key:e,src:e,ref:o,allow:`clipboard-write ${e}`},(0,d.Sh)(ds,"loading"===t?hs:void 0)))))))):"error"===t?n.createElement("div",Object.assign({},(0,d.Sh)(cs,us)),n.createElement(ue,null),n.createElement("span",{className:ms},"Something went wrong"),n.createElement("span",{className:ps},"Please try again.")):(0,y.Rz)(t))))))))))})),fs=r.UI.Union.asOption(gs),vs=r.UI.Union.make("kind",{error:pe,initial:ai,actionFollowup:oe,results:ns,skill:fs}),ys=41.25,bs=r.UI.Grid.make((({slots:e,state:t,view:i,notify:r})=>{const{rect:o,onMount:a}=s.P.useRectWatcher(),c=n.useMemo((()=>o.pipe(D.oA,V.b((e=>r({kind:"contentSizeChange",height:e.height})())))),[o]);return s.P.useSubscriptionTo(c),n.createElement(u.F.div,{mount:a,onScroll:e=>r({kind:"contentScroll",scrollTop:e.currentTarget.scrollTop})(),style:{overflow:i("canScroll").pipe(l.U((0,L.RN)("auto","hidden"))),maxHeight:t.pipe(l.U((({assistantMaxHeight:e,promptHeight:t})=>function(e,t,i=.25){const n=(0,y.zG)(e,h.map((e=>`min(${I.ux.px(e)}, ${I.ux.rem(ys)})`)),h.getOrElse((()=>I.ux.rem(ys)))),r=(0,y.zG)(t,h.fold((()=>I.ux.rem(3)),(e=>I.ux.px(e)))),s=`calc(${I.ux.rem(vo+yo+2.5)} + ${r})`;return`calc(${n} - ${s} - ${I.ux.rem(i)})`}(e,t))),H.O(I.ux.rem(34.75)))}},e.content)})),xs=r.UI.Knot.make(bs,{content:vs}),Ss=r.UI.Union.asOption(xs);const ks=({title:e,url:t})=>{const i=n.useRef(null),r=un(i,e);return(0,y.zG)(t,h.fold((()=>n.createElement("span",{className:ws,title:r,ref:i},e)),(t=>n.createElement(cn.d,{className:ws,title:r,ref:i,href:t},e))))},ws=I.ux.style({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",$nest:{"&:visited":{color:"inherit"}}}),Cs=r.UI.Node.make((({state:e})=>n.createElement(u.F.Fragment,null,e.pipe(l.U((({detectedReferences:e})=>n.createElement(q,{style:Is},n.createElement("span",{className:Es},"Detected references"),n.createElement("ul",{className:As},e.map((({title:e,iconUrl:t,url:i},r)=>n.createElement("li",{key:r,className:Os},n.createElement("img",{src:t,className:Rs,alt:""}),n.createElement(ks,{title:e,url:i})))))))))))),_s=r.UI.Union.asOption(Cs),Is={position:"relative",padding:`${I.ux.rem(_.F2)} ${I.ux.rem(_.qp)}`,gap:0},Es=I.ux.style({fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC),color:$.XY.Content.Secondary.Default,userSelect:"none"}),As=I.ux.style({fontSize:I.ux.rem(_.qp),lineHeight:I.ux.rem(_.mh+_.yC),color:$.XY.Content.Primary.Default,margin:0,padding:0}),Os=I.ux.style({height:I.ux.rem(_.sD),display:"flex",alignItems:"center",borderRadius:I.ux.rem(C.xB)}),Rs=I.ux.style({minWidth:I.ux.rem(_.mh),height:I.ux.rem(_.mh),marginRight:I.ux.rem(_.x)});var Ts=i(819);const Ps=e=>n.createElement(a.a1,Object.assign({width:"18",height:"18",viewBox:"0 0 18 18",fill:Ae.Z.BrandGreen60},e),n.createElement("path",{d:"M17.1056 9.44721L0.992696 17.5037C0.607324 17.6963 0.174955 17.3439 0.285972 16.9276L1.83393 11.1228C1.93505 10.7436 2.24864 10.4586 2.63576 10.394L9.52041 9.2466C9.79894 9.20018 9.79894 8.79982 9.52041 8.7534L2.63576 7.60596C2.24864 7.54144 1.93505 7.25644 1.83393 6.87723L0.285971 1.07239C0.174955 0.656082 0.607322 0.303661 0.992694 0.496347L17.1056 8.55279C17.4741 8.73705 17.4741 9.26295 17.1056 9.44721Z",stroke:"none"})),Us=e=>n.createElement(a.a1,Object.assign({width:"32",height:"32",fill:$.XY.Content.Secondary.Default,viewBox:"0 0 32 32"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 16a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm1 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-11-3a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-4Z",stroke:"none"})),Bs="goBtn",Ns="stopBtn",zs={top:_.x,right:3.5*_.qp,bottom:_.x,left:_.qp},Fs=I.ux.style({display:"flex",position:"relative",alignItems:"flex-start",padding:0,gap:I.ux.rem(_.F2),justifyContent:"space-between"}),js=I.ux.style({flexGrow:1,$nest:{"&[data-hasheader='false']":{paddingTop:I.ux.rem(_.F2+_.W9)}}}),Gs=I.ux.style({width:I.ux.percent(100),border:"none"}),Ms={position:"absolute",bottom:I.ux.rem(_.x),right:I.ux.rem(_.qp)},Ds=(0,de.dD)(Ms,Ns),Vs=(0,de.dD)(Object.assign(Object.assign({},Ms),{$nest:{"&[data-disabled='true']":{opacity:1,$nest:{"& svg":{fill:w.BlueGray30}}}}}),Bs),Hs=I.ux.joinClasses([Bs,I.ux.style(Vs)]),Ls=I.ux.joinClasses([Ns,I.ux.style(Ds)]),Ks=r.UI.Node.make((({state:e,view:t,notify:i})=>{const{onMount:r}=(0,_e.F)(V.b((e=>i({kind:m.i.Kind.mount,name:Ze.e.promptInput,element:e})())));return n.createElement(u.F.div,{className:Fs,mount:r},n.createElement(u.F.div,{className:js,"data-hasheader":t("hasHeader")},e.pipe(l.U((({placeholder:e,kind:t,text:r,autofocusToken:s,genAIAvailability:o})=>n.createElement(ur,{text:r,theme:{padding:zs,maxHeight:18.25,minHeight:2},ariaLabel:"custom prompt",className:Gs,placeholder:"ready"===t?h.toUndefined(e):void 0,fitContentHeight:!0,autofocus:s,onChange:e=>i({kind:m.i.Kind.promptFieldTextChange,text:e})(),onKeyDownEnter:"ready"===t?i({kind:m.i.Kind.promptFieldKeyPressEnter,text:r}):y.Q1,onKeyUpEscape:i({kind:m.i.Kind.promptFieldKeyPressEscape}),onFocus:i({kind:m.i.Kind.promptFieldFocusChange,focused:!0}),onBlur:i({kind:m.i.Kind.promptFieldFocusChange,focused:!1}),onKeyDownArrowUp:i({kind:m.i.Kind.promptFieldKeyPressArrowUp}),onKeyDownArrowDown:i({kind:m.i.Kind.promptFieldKeyPressArrowDown}),disabled:Ts._.isUnavailable(o)}))))),e.pipe(l.U((({kind:e,text:t,genAIAvailability:r})=>"waitingForResult"===e?n.createElement(p.z.Tertiary,{className:Ls,onClick:i({kind:m.i.Kind.generateStopButtonClick}),name:"generateStop",compact:!0,size:"large"},n.createElement(Us,null)):"ready"===e?n.createElement(p.z.Tertiary,{className:Hs,onClick:i({kind:m.i.Kind.promptSubmitButtonClick,text:t}),disabled:""===t.trim()||Ts._.isUnavailable(r),name:"promptSend",compact:!0,size:"large"},n.createElement(Ps,null)):null))))})),$s=r.UI.Union.asOption(r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Ws},e.content))),(0,y.zG)(Pt,r.UI.patch("header")((()=>r.UI.Union.make("kind",{default:At,withSelectionContext:At})))))),Ws=I.ux.style({padding:`${I.ux.rem(_.F2)} ${I.ux.rem(_.qp)}`}),Zs=r.UI.List.make(K.bw,mt.G),qs=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Xs},e.customPromptGo,n.createElement("div",{className:Qs},e.searchResults)))),Ys=r.UI.Knot.make(qs,{searchResults:Zs,customPromptGo:mt.G}),Xs=I.ux.style({background:"transparent",padding:I.ux.rem(_.qp),display:"flex",flexDirection:"column",alignItems:"flex-start",gap:I.ux.rem(_.x)}),Qs=I.ux.style({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:I.ux.rem(_.x)}),Js=r.UI.Union.make("kind",{searchResults:Ys,actionsStore:$s}),eo=r.UI.Knot.make(r.UI.Grid.make((({slots:e,view:t,notify:i})=>n.createElement(u.F.div,{className:io,style:{maxHeight:t("maxHeight")}},n.createElement(p.z.Tertiary,{compact:!0,className:no,onClick:i({kind:m.i.Kind.collapsePromptMenuButtonClick}),name:"collapsePromptMenu",size:"small"},n.createElement(a.JO.Arrow,{direction:a.n4.down,className:oo})),n.createElement("div",{ref:e=>e&&i({kind:m.i.Kind.mount,name:Ze.e.promptMenuContent,element:e})(),onKeyDown:e=>{"ArrowDown"===e.key?i({kind:m.i.Kind.promptMenuKeyPressArrowDown})():"ArrowUp"===e.key&&i({kind:m.i.Kind.promptMenuKeyPressArrowUp})()}},e.content)))),{content:Js}),to=r.UI.Union.asOption(eo),io=I.ux.style({overflowY:"scroll",borderBottom:`0.5px solid ${$.XY.Boundaries.Secondary.Default}`}),no=I.ux.style({position:"absolute",top:I.ux.rem(_.x),right:I.ux.rem(_.x),zIndex:1,$nest:{"&:not(:hover)":{backgroundColor:I.ux.important(w.White)}}}),ro="arrowIcon",so=(0,de.dD)((0,de.fx)(1.5),ro),oo=I.ux.joinClasses([ro,I.ux.style(so)]),ao=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const{onMount:r,rect:o}=s.P.useRectWatcher(),a=n.useMemo((()=>o.pipe(V.b((e=>i({kind:"promptHeightChange",height:(0,y.zG)(e,h.map((e=>e.height)))})())))),[o]);s.P.useSubscriptionTo(a);const c=n.useRef(null);return n.createElement(u.F.div,{className:uo},n.createElement(u.F.div,{mount:c,className:po,"data-expanded":t("menuExpanded"),onFocus:()=>{var e;return i({kind:m.i.Kind.promptFieldAndMenuFocusChange,focused:(null===(e=c.current)||void 0===e?void 0:e.contains((0,Y.vY)(document)))||!1})()},onBlur:()=>{var e;return i({kind:m.i.Kind.promptFieldAndMenuFocusChange,focused:(null===(e=c.current)||void 0===e?void 0:e.contains((0,Y.vY)(document)))||!1})()}},e.promptMenu,n.createElement("div",{ref:r},e.promptField)),Ie.aj([o,t("menuExpanded")]).pipe(l.U((([e,t])=>(0,y.zG)(e,h.filter((()=>t)),h.fold(y.gn,(e=>n.createElement("div",{className:ho,style:{height:e.height}}))))))))})),lo=r.UI.Knot.make(ao,{promptField:Ks,promptHeader:r.UI.Node.empty,promptMenu:to}),co=r.UI.Union.asOption(lo),uo=I.ux.style({position:"relative"}),mo=e=>I.ux.color(w.BlueGray40).toRGBA().fade(e).toString(),po=I.ux.style({background:"white",boxShadow:`0px 0px 0px 0.5px ${w.BlueGray40}, 0px 0px 2px 0.5px ${mo(.5)}, 0px 1px 6px 0.5px ${mo(.25)}`,borderRadius:I.ux.rem(C.xB+C.fe),$nest:{"&[data-expanded='true']":{position:"absolute",bottom:0,width:"100%"}}}),ho=I.ux.style({opacity:0,pointerEvents:"none"}),go=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:bo},e.content,e.detectedReferences,e.prompt))),fo=r.UI.Knot.make(go,{content:Ss,detectedReferences:_s,prompt:co}),vo=_.x,yo=_.x,bo=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(yo)}),xo=e=>n.createElement(a.a1,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),n.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_4506_11023_disheartening_emoji)",stroke:"none"}),n.createElement("path",{d:"M8.97126 19.5491C10.9569 18.1193 14.0431 18.1193 16.0295 19.5491C16.3344 19.7674 16.5155 19.5315 16.4184 19.3455C14.4879 15.6555 10.5121 15.6555 8.58164 19.3455C8.48451 19.5315 8.66564 19.7674 8.97126 19.5491Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M19.895 12.8239C17.9806 13.5491 15.4865 12.8809 14.1909 11.2954C13.9925 11.0531 13.7945 11.2046 13.8328 11.376C14.5936 14.775 17.807 15.6364 20.1654 13.0721C20.2839 12.9435 20.1886 12.7133 19.895 12.8239Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M10.8091 11.2954C9.51351 12.8813 7.01976 13.5491 5.10501 12.8239C4.81176 12.7133 4.71614 12.9431 4.83464 13.0721C7.19301 15.6364 10.4064 14.775 11.1673 11.376C11.2059 11.2046 11.0079 11.0531 10.8091 11.2954Z",fill:"#302C3B",stroke:"none"}),n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_4506_11023_disheartening_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFA027"}),n.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),n.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),n.createElement("stop",{offset:"1",stopColor:"#FFE261"})))),So=e=>n.createElement(a.a1,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),n.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_4506_11027_neutral_emoji)",stroke:"none"}),n.createElement("path",{d:"M17.3266 17.25H7.6726C6.7336 17.25 6.7336 15.75 7.6726 15.75H17.3266C18.2656 15.75 18.2656 17.25 17.3266 17.25Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M8.7496 12.1875C9.68158 12.1875 10.4371 11.1801 10.4371 9.9375C10.4371 8.69486 9.68158 7.6875 8.7496 7.6875C7.81762 7.6875 7.0621 8.69486 7.0621 9.9375C7.0621 11.1801 7.81762 12.1875 8.7496 12.1875Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M16.2496 12.1875C17.1816 12.1875 17.9371 11.1801 17.9371 9.9375C17.9371 8.69486 17.1816 7.6875 16.2496 7.6875C15.3176 7.6875 14.5621 8.69486 14.5621 9.9375C14.5621 11.1801 15.3176 12.1875 16.2496 12.1875Z",fill:"#302C3B",stroke:"none"}),n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_4506_11027_neutral_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFA027"}),n.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),n.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),n.createElement("stop",{offset:"1",stopColor:"#FFE261"})))),ko=e=>n.createElement(a.a1,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),n.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_11994_841_smiling_emoji)",stroke:"none"}),n.createElement("path",{d:"M5.82085 15.8453C7.89191 15.8453 9.57085 14.1663 9.57085 12.0953C9.57085 10.0242 7.89191 8.34528 5.82085 8.34528C3.74978 8.34528 2.07085 10.0242 2.07085 12.0953C2.07085 14.1663 3.74978 15.8453 5.82085 15.8453Z",fill:"url(#paint1_radial_11994_841_smiling_emoji)",stroke:"none"}),n.createElement("path",{d:"M19.1792 15.75C21.2502 15.75 22.9292 14.0711 22.9292 12C22.9292 9.92893 21.2502 8.25 19.1792 8.25C17.1081 8.25 15.4292 9.92893 15.4292 12C15.4292 14.0711 17.1081 15.75 19.1792 15.75Z",fill:"url(#paint2_radial_11994_841_smiling_emoji)",stroke:"none"}),n.createElement("path",{d:"M14.0844 9.3015C15.5 7.72425 17.7012 7.7235 19.1176 9.3015C19.3344 9.543 19.4634 9.282 19.3944 9.07725C18.0181 5.0055 15.1831 5.0055 13.8069 9.07725C13.7379 9.282 13.8669 9.54262 14.0844 9.3015Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M5.88312 9.3015C7.29949 7.72425 9.49999 7.7235 10.9164 9.3015C11.1331 9.543 11.2629 9.282 11.1931 9.07725C9.81687 5.0055 6.98187 5.0055 5.60562 9.07725C5.53699 9.282 5.66562 9.54262 5.88312 9.3015Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M17.1961 13.647C14.3352 15.7061 10.6614 15.705 7.802 13.647C7.397 13.356 7.15512 13.6706 7.28487 13.9178C9.4805 18.1151 15.5187 18.1144 17.7147 13.9178C17.8437 13.6703 17.6026 13.3556 17.1961 13.647Z",fill:"#302C3B",stroke:"none"}),n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_11994_841_smiling_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFA027"}),n.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),n.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),n.createElement("stop",{offset:"1",stopColor:"#FFE261"})),n.createElement("radialGradient",{id:"paint1_radial_11994_841_smiling_emoji",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.82103 12.0952) scale(3.75 3.75)"},n.createElement("stop",{stopColor:"#F18D84"}),n.createElement("stop",{offset:"0.2514",stopColor:"#F29180",stopOpacity:"0.7486"}),n.createElement("stop",{offset:"0.5118",stopColor:"#F49E73",stopOpacity:"0.4882"}),n.createElement("stop",{offset:"0.7755",stopColor:"#F8B25F",stopOpacity:"0.2245"}),n.createElement("stop",{offset:"1",stopColor:"#FDCA47",stopOpacity:"0"})),n.createElement("radialGradient",{id:"paint2_radial_11994_841_smiling_emoji",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(19.179 12) scale(3.75)"},n.createElement("stop",{stopColor:"#F18D84"}),n.createElement("stop",{offset:"0.2514",stopColor:"#F29180",stopOpacity:"0.7486"}),n.createElement("stop",{offset:"0.5118",stopColor:"#F49E73",stopOpacity:"0.4882"}),n.createElement("stop",{offset:"0.7755",stopColor:"#F8B25F",stopOpacity:"0.2245"}),n.createElement("stop",{offset:"1",stopColor:"#FDCA47",stopOpacity:"0"})))),wo=(e,t)=>(0,d.Sh)(_o,e===t&&Io),Co=I.ux.style({display:"flex",flexDirection:"row",justifyContent:"space-between",paddingLeft:I.ux.rem(_.mh),paddingRight:I.ux.rem(_.mh)}),_o=I.ux.style({width:I.ux.rem(5),height:I.ux.rem(5),cursor:"pointer",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",gap:I.ux.rem(_.x),borderRadius:I.ux.rem(C.HP),fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),$nest:{"&:hover":{backgroundColor:$.XY.Surface.Secondary.Default}}}),Io=I.ux.style({backgroundColor:w.Blue10,$nest:{"&:hover":{backgroundColor:w.Blue10}}}),Eo=I.ux.style(Object.assign({},(0,de.fx)(1.5))),Ao="submitBtn",Oo={padding:I.ux.rem(_.mh),gap:I.ux.rem(_.mh)},Ro={color:$.XY.Content.Primary.Default,fontWeight:700,fontSize:I.ux.rem(1.25),lineHeight:I.ux.rem(1.5),margin:0},To={border:`${I.ux.px(1)} solid ${w.NeutralGray20}`,borderRadius:I.ux.rem(C.xB),padding:`${I.ux.rem(_.x+_.yC)} ${I.ux.rem(_.x)}`,height:I.ux.rem(8)},Po={display:"flex",alignItems:"flex-start",$nest:{"& input[type='checkbox']":{margin:`${I.ux.rem(_.W9)} ${I.ux.rem(_.x)} 0 0`,minWidth:I.ux.rem(1),minHeight:I.ux.rem(1)},"& label":{color:$.XY.Content.Primary.Default,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125)}}},Uo=Object.assign({width:I.ux.percent(100)},(0,de.dD)({fontSize:I.ux.rem(.875)},Ao)),Bo={display:"flex",flexDirection:"column",gap:I.ux.rem(_.x)},No=Oo,zo=I.ux.style(Ro),Fo=I.ux.style(To),jo=I.ux.style(Po),Go=(I.ux.style({fontWeight:700}),I.ux.joinClasses([Ao,I.ux.style(Uo)])),Mo=I.ux.style(Bo),Do=(0,d.xb)((({selectedScore:e,onSelectScore:t})=>n.createElement("div",{className:Co},n.createElement("div",Object.assign({},wo(We.x.Mood.dissatisfied,e),{onClick:()=>t(We.x.Mood.dissatisfied)}),n.createElement(xo,{className:Eo}),"I dislike it"),n.createElement("div",Object.assign({},wo(We.x.Mood.ok,e),{onClick:()=>t(We.x.Mood.ok)}),n.createElement(So,{className:Eo}),"It′s OK"),n.createElement("div",Object.assign({},wo(We.x.Mood.satisfied,e),{onClick:()=>t(We.x.Mood.satisfied)}),n.createElement(ko,{className:Eo}),"I like it!")))),Vo=(0,d.xb)(ur),Ho=(0,d.xb)(q),Lo=r.UI.Node.make((({state:e,view:t,notify:i})=>{const r="domainCheckbox"+an.fg(5);return n.createElement(Ho,{style:No},n.createElement("h1",{className:zo},"How do you like Grammarly?"),n.createElement(Do,{selectedScore:t("formData").pipe(l.U((e=>e.mood))),onSelectScore:e=>i({kind:m.i.Kind.feedbackFormChange,feedbackData:{mood:e}})()}),n.createElement(Vo,{ariaLabel:"tell us why",className:Fo,placeholder:["How can we improve?"],fitContentHeight:!1,text:t("formData").pipe(l.U((({message:e})=>null!=e?e:""))),onChange:e=>i({kind:m.i.Kind.feedbackFormChange,feedbackData:{message:e}})()}),e.pipe(l.U((({formData:e,domain:t,source:s})=>n.createElement("div",{className:Mo},(0,y.zG)(t,h.fold(y.gn,(t=>n.createElement("div",{className:jo},n.createElement("input",{type:"checkbox",id:r,checked:void 0!==e.domain,onChange:i({kind:m.i.Kind.feedbackFormChange,feedbackData:{domain:void 0!==e.domain?void 0:t}})}),n.createElement("label",{htmlFor:r},"Include the domain ",n.createElement("b",null,t)," with my feedback to help improve Grammarly."))))),(0,y.zG)(h.fromNullable(void 0!==e.mood?Object.assign(Object.assign({},e),{mood:e.mood,source:s}):null),h.fold((()=>n.createElement(p.z.Primary,{disabled:!0,className:Go,onClick:y.Q1},"Submit")),(e=>n.createElement(p.z.Primary,{disabled:!1,className:Go,onClick:i({kind:m.i.Kind.feedbackFormSubmitButtonClick,feedbackData:e})},"Submit")))))))))}));var Ko=i(54157),$o=i(44443);const Wo=e=>n.createElement(a.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:w.Green30},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM18.2071 9.20711C18.5976 8.81658 18.5976 8.18342 18.2071 7.79289C17.8166 7.40237 17.1834 7.40237 16.7929 7.79289L10 14.5858L8.20711 12.7929C7.81658 12.4024 7.18342 12.4024 6.79289 12.7929C6.40237 13.1834 6.40237 13.8166 6.79289 14.2071L10 17.4142L18.2071 9.20711Z",stroke:"none"})),Zo=r.UI.Node.make((({view:e,notify:t})=>n.createElement(u.F.div,{className:Yo,"data-id":e("id")},e("kind").pipe(l.U((e=>{switch(e){case Ko.C.Kind.feedbackSubmitted:return n.createElement(n.Fragment,null,n.createElement(Wo,{className:Xo}),n.createElement("div",null,"Thanks for the feedback!"));case Ko.C.Kind.voiceTagRemoved:return n.createElement(n.Fragment,null,n.createElement(Wo,{className:Xo}),n.createElement("div",null,"Removed"));default:return(0,c.L0)(e)}}))),e("id").pipe(l.U((e=>n.createElement($o.x,{name:"notificationClose",onClick:t({kind:"dismissNotification",id:e}),size:"small"}))))))),qo=I.ux.keyframes({from:{transform:`translateY(${I.ux.rem(.25)})`,opacity:0},to:{transform:"translateY(0)",opacity:1}}),Yo=I.ux.style({background:$.S5.Surface.Primary.Default,color:$.S5.Content.Primary.Default,borderRadius:I.ux.rem(C.xB+C.fe),display:"flex",flexDirection:"row",alignItems:"center",padding:`${I.ux.rem(_.x)} ${I.ux.rem(_.qp)}`,gap:I.ux.rem(_.qp),fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),animation:`${qo} 0.1s ease-in`}),Xo=I.ux.style(Object.assign({},(0,de.fx)(1.5))),Qo=r.UI.List.make(K.bw,Zo),Jo=r.UI.Grid.make((({slots:e,view:t})=>n.createElement(u.F.div,{className:t("contentOverflowUnderToolbar").pipe(l.U((0,L.RN)(na,ia)))},e.content))),ea=r.UI.Knot.make(Jo,{content:Qo}),ta={position:"absolute",top:0,right:I.ux.rem(_.x),display:"flex",flexDirection:"column",gap:I.ux.rem(_.x),zIndex:1e3,transition:"top 0.1s ease-in"},ia=I.ux.style(ta),na=I.ux.style(ta,{top:I.ux.rem(_.F2)});var ra=i(17889),sa=i(3709),oa=i(45930),aa=i(78674),la=i(44361);const ca={border:`1px solid ${$.S5.InteractiveNeutral.Primary.Default}`,borderRadius:I.ux.rem(C.xB),width:I.ux.rem(15),height:I.ux.rem(2),boxSizing:"border-box",position:"relative"},ua={padding:`${I.ux.rem(_.F2)} ${I.ux.rem(_.F2+_.Ze)} ${I.ux.rem(_.F2)} ${I.ux.rem(_.qp)}`,width:"100%",height:"100%",border:"none",background:"transparent",position:"relative",cursor:"pointer",display:"flex",alignItems:"center"},da={fontWeight:400,fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),color:$.XY.Content.Primary.Default},ma=Object.assign(Object.assign({position:"absolute",top:I.ux.rem(_.F2),right:I.ux.rem(_.x)},(0,de.fx)(1.5)),{$nest:{"& svg":{stroke:$.XY.Content.Secondary.Default}}}),pa=e=>I.ux.color(w.BlueGray40).toRGBA().fade(e).toString(),ha={padding:I.ux.rem(_.F2),background:"white",boxShadow:`0px 0px 0px 0.5px ${w.BlueGray40}, 0px 0px 2px 0.5px ${pa(.5)}, 0px 1px 6px 0.5px ${pa(.25)}`,borderRadius:I.ux.rem(C.xB),width:I.ux.rem(15),boxSizing:"border-box",overflowY:"auto",maxHeight:I.ux.rem(8.125),zIndex:9999,$nest:{"& > ul":{listStyle:"none",padding:0,margin:0,$nest:{"& > li":{padding:0,margin:0}}}}},ga={border:"none",background:"transparent",width:"100%",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),color:$.XY.Content.Primary.Default,padding:`${I.ux.rem(.1875)} ${I.ux.rem(_.qp)}`,borderRadius:I.ux.rem(C.xB),display:"flex",justifyContent:"flex-start",$nest:{"&:hover":{background:w.Blue0}}},fa=I.ux.style(ca),va=I.ux.style(ua),ya=I.ux.style(da),ba=I.ux.style(ha),xa=I.ux.style(ga),Sa=I.ux.style(ma),ka=new oa.X(999999);function wa({label:e,selection:t,className:i,placeholder:r,options:o,onSelectionChange:l,renderOption:c}){const[u,m]=n.useState(!1),p=n.useRef(ka.newId().toString()),h=n.useRef(ka.newId().toString()),g=n.useRef(null),[f,y]=n.useState(null),[b,x]=n.useState(null),{styles:S,attributes:k}=(0,v.D)(f,b,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}}]}),w=n.useMemo((()=>new ht.xQ),[]),C=n.useMemo((()=>w.pipe(aa.b(100),W.h((e=>!e)),V.b((()=>{m(!1)})))),[w,m]);return s.P.useSubscriptionTo(C),n.createElement("div",Object.assign({},(0,d.Sh)(fa,i),{ref:y}),n.createElement("button",{ref:g,className:va,onClick:()=>{var e;m(!0),w.next(!0),null===(e=g.current)||void 0===e||e.focus()},onFocus:()=>{m(!0),w.next(!0)},onBlur:()=>w.next(!1),type:"button","aria-haspopup":"listbox","aria-owns":p.current,"aria-expanded":u,"aria-labelledby":h.current},n.createElement("div",{id:h.current,className:ya},t?c?c(t):e(t):r),n.createElement(a.JO.Arrow,{direction:a.n4.down,className:Sa})),u&&n.createElement("div",Object.assign({ref:x,style:S.popper},k.popper,{className:ba,onFocus:()=>w.next(!0),onBlur:()=>w.next(!1)}),n.createElement("ul",{"aria-label":"menu-options",role:"listbox",id:p.current},o.map(((t,i)=>{const r=e(t);return n.createElement("li",{key:i,"aria-label":r,role:"option"},n.createElement("button",{className:xa,onClick:(0,la.m)((()=>{l(t),m(!1)}))},c?c(t):e(t)))})))))}var Ca=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const _a=e=>{var{text:t,onChange:i,placeholder:r,disabled:s,className:o,onFocus:a,onBlur:l,onKeyPressEnter:c,autofocus:u,onKeyUpEscape:d}=e,m=Ca(e,["text","onChange","placeholder","disabled","className","onFocus","onBlur","onKeyPressEnter","autofocus","onKeyUpEscape"]);const[p,h]=n.useState(null);return n.useEffect((()=>{p&&void 0!==u&&p.focus()}),[u,p]),n.createElement(lr,{className:o,style:{height:I.ux.rem(1.375)}},n.createElement("style",{dangerouslySetInnerHTML:{__html:`\n      .textBox {\n        box-sizing: border-box;\n        border-radius: ${I.ux.rem(C.xB)};\n        overflow-y: auto;\n        width: 100%;\n        height: 100%;\n        border: none;\n        padding: 0;\n        background: transparent;\n        resize: none;\n        font-family: Inter, sans-serif;\n        font-size: ${I.ux.rem(.875)};\n        font-weight: 400;\n        color: ${or};\n      }\n      .textBox::placeholder {\n        color: ${ar};\n      }\n      .textBox:focus {\n        outline: none;\n      }\n      `}}),n.createElement("input",Object.assign({},m,{className:"textBox",style:{lineHeight:I.ux.rem(1.375)},value:t,ref:h,onChange:e=>i(e.target.value),placeholder:r,disabled:s,onFocus:()=>null==a?void 0:a(),onBlur:()=>null==l?void 0:l(),onKeyPress:e=>{c&&"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),e.stopPropagation(),c())},onKeyDown:e=>{d&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),d())}})))},Ia={padding:`${I.ux.rem(_.F2)} ${I.ux.rem(_.F2+_.Ze)} ${I.ux.rem(_.F2)} ${I.ux.rem(_.qp)}`,border:`1px solid ${$.S5.InteractiveNeutral.Primary.Default}`,borderRadius:I.ux.rem(C.xB),width:I.ux.rem(15),height:I.ux.rem(2),boxSizing:"border-box",position:"relative"},Ea={position:"absolute",right:I.ux.rem(_.x),top:I.ux.rem(.1875),border:"none",background:"transparent",display:"flex",alignItems:"center",cursor:"pointer",width:I.ux.rem(1.5),height:I.ux.rem(1.5),padding:0},Aa=Object.assign(Object.assign({},(0,de.fx)(1.5)),{$nest:{"& svg":{stroke:$.XY.Content.Secondary.Default}}}),Oa=e=>I.ux.color(w.BlueGray40).toRGBA().fade(e).toString(),Ra={padding:I.ux.rem(_.F2),background:"white",boxShadow:`0px 0px 0px 0.5px ${w.BlueGray40}, 0px 0px 2px 0.5px ${Oa(.5)}, 0px 1px 6px 0.5px ${Oa(.25)}`,borderRadius:I.ux.rem(C.xB),width:I.ux.rem(15),boxSizing:"border-box",overflowY:"auto",maxHeight:I.ux.rem(8.125),zIndex:9999,$nest:{"& > ul":{listStyle:"none",padding:0,margin:0,$nest:{"& > li":{padding:0,margin:0}}}}},Ta={border:"none",background:"transparent",width:"100%",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),color:$.XY.Content.Primary.Default,padding:`${I.ux.rem(.1875)} ${I.ux.rem(_.qp)}`,borderRadius:I.ux.rem(C.xB),display:"flex",justifyContent:"flex-start",$nest:{"&:hover":{background:w.Blue0},"& mark":{backgroundColor:"unset",fontWeight:"bold"}}},Pa={width:I.ux.percent(100),border:"none"},Ua=I.ux.style(Ia),Ba=I.ux.style(Ea),Na=I.ux.style(Aa),za=I.ux.style(Ra),Fa=I.ux.style(Ta),ja=I.ux.style({whiteSpace:"pre"}),Ga=I.ux.style(Pa),Ma=new oa.X(999999);function Da({text:e,placeholder:t,clearButton:i,selectOnBlur:r,label:o,options:l,className:c,filterBy:u=((e,t)=>o(e).toLowerCase().includes(t.toLowerCase())),onInputChange:m,onSelectionChange:p}){const[h,g]=n.useState(!1),f=n.useRef(Ma.newId().toString()),[y,b]=n.useState(null),[x,S]=n.useState(null),{styles:k,attributes:w}=(0,v.D)(y,x,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}}]}),C=l.filter((t=>u(t,e.trim()))),_=h&&C.length>0,I=n.useMemo((()=>new ht.xQ),[]);return s.P.useSubscriptionTo(I.pipe(aa.b(50),W.h((e=>!e)),V.b((()=>{g(!1),r&&""!==e.trim()&&p(C.length>0?C[0]:null)})))),n.createElement("div",Object.assign({},(0,d.Sh)(Ua,c),{ref:b}),n.createElement(_a,{className:Ga,placeholder:t,onChange:m,text:e,onFocus:()=>{g(!0),I.next(!0)},onBlur:()=>I.next(!1),role:"combobox","aria-haspopup":"listbox","aria-owns":f.current,"aria-expanded":_}),""!==e.trim()&&!!i&&n.createElement("button",{onClick:(0,la.m)((()=>p(null))),className:Ba,"aria-label":"Clear",type:"button"},n.createElement(a.JO.Close,{className:Na})),_&&n.createElement("div",Object.assign({ref:S,style:k.popper},w.popper,{className:za,onFocus:()=>I.next(!0),onBlur:()=>I.next(!1)}),n.createElement("ul",{"aria-label":"menu-options",role:"listbox",id:f.current},C.map((t=>{const i=o(t);return n.createElement("li",{key:i,"aria-label":i,role:"option"},n.createElement("button",{className:Fa,onClick:(0,la.m)((()=>{p(t),g(!1)}))},n.createElement(Va,{label:i,pattern:e})))})))))}const Va=({label:e,pattern:t})=>{if(""===t.trim())return n.createElement(n.Fragment,null,e);const i=t.trim(),r=e.split(new RegExp(i,"i")),s=(0,y.zG)(r.map(((e,t)=>({token:e,mark:!1,end:t*i.length+r.slice(0,t).join("").length+e.length}))),K.iD({token:"",mark:!0,end:0})).map(((t,n,r)=>t.mark&&n>0?{token:e.slice(r[n-1].end,r[n-1].end+i.length),mark:!0}:{token:t.token,mark:!1})).filter((e=>e.token.length>0));return n.createElement(n.Fragment,null,s.map(((e,t)=>e.mark?n.createElement("mark",{key:t,className:ja},e.token):n.createElement("span",{key:t,className:ja},e.token))))};const Ha=e=>n.createElement(a.a1,Object.assign({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},e),n.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeWidth:".857",d:"m4 4 2 2m2 2L6 6m0 0 2-2M6 6 4 8"})),La=({kind:e,label:t,description:i,iconUrl:r,isUnselectable:s,onToggle:o})=>n.createElement(ln.u,{title:i},n.createElement("button",{disabled:"disabled"===e,className:Ka,"data-kind":e,"data-unselectable":s,onClick:(0,la.m)((()=>{"disabled"!==e&&o("selected"!==e&&("unselected"===e||(0,c.L0)(e)))}))},r?n.createElement("img",{src:r,style:{width:20,height:20}}):null,n.createElement("span",null,t),s&&"selected"===e?n.createElement(Ha,{className:$a}):null)),Ka=I.ux.style({display:"flex",alignItems:"center",justifyContent:"center",gap:I.ux.rem(_.x),padding:`${I.ux.rem(_.F2)} ${I.ux.rem(.625)} ${I.ux.rem(_.F2)} ${I.ux.rem(_.x)}`,background:$.XY.Surface.Primary.Default,border:`${I.ux.px(1)} solid transparent`,borderRadius:I.ux.rem(1.875),fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),boxSizing:"border-box",$nest:{"&[data-kind='unselected']":{border:`${I.ux.px(1)} solid ${w.BlueGray5}`,color:$.XY.Content.Primary.Default,cursor:"pointer"},"&[data-kind='disabled']":{border:`${I.ux.px(1)} solid ${w.BlueGray5}`,color:w.BlueGray40,cursor:"default"},"&[data-kind='selected']":{border:`${I.ux.px(2)} solid ${Ae.Z.BrandGreen60}`,padding:`${I.ux.rem(.1875)} ${I.ux.rem(.5625)} ${I.ux.rem(.1875)} ${I.ux.rem(.4375)}`,position:"relative",$nest:{"&[data-unselectable='true']":{cursor:"pointer"}}}}}),$a=I.ux.style(Object.assign(Object.assign({position:"absolute",top:I.ux.rem(-(_.F2+_.W9)),right:I.ux.rem(-(_.F2+_.W9)),boxSizing:"content-box"},(0,de.fx)(.75)),{border:`${I.ux.rem(.125)} solid white`,borderRadius:"50%",background:Ae.Z.BrandGreen60,display:"flex",alignItems:"center",justifyContent:"center"})),Wa=({chips:e,className:t,onToggle:i})=>n.createElement(u.F.div,Object.assign({},(0,d.Sh)(Za,t)),e.pipe(l.U(K.UI((e=>n.createElement(La,Object.assign({},e,{onToggle:t=>i(e,t),key:e.label}))))))),Za=I.ux.style({display:"flex",flexWrap:"wrap",gap:I.ux.rem(_.F2),$nest:{div:{marginTop:I.ux.rem(_.F2)}}}),qa={margin:0,padding:I.ux.rem(_.mh),gap:I.ux.rem(_.mh)},Ya={color:$.XY.Content.Primary.Default,fontWeight:700,fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),margin:0},Xa={color:$.XY.Content.Secondary.Default,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125)},Qa={marginTop:I.ux.rem(_.x)},Ja={color:w.BlueGray60,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125)},el={display:"flex",justifyContent:"flex-end",gap:I.ux.rem(_.x)},tl={fontSize:I.ux.important(I.ux.rem(.875))},il={marginTop:I.ux.rem(_.x)},nl={marginTop:I.ux.rem(_.x)},rl={display:"flex",alignItems:"center",gap:I.ux.rem(_.x)},sl={width:I.ux.rem(1.5),height:I.ux.rem(1.5),display:"flex",alignItems:"center",justifyContent:"center"},ol=qa,al=I.ux.style(Ya),ll=I.ux.style(Qa),cl=I.ux.style(Xa),ul=I.ux.style(Ja),dl=I.ux.style(el),ml=I.ux.style(tl),pl=I.ux.style(tl),hl=I.ux.style(il),gl=I.ux.style(nl),fl=I.ux.style(rl),vl=I.ux.style(sl),yl=r.UI.Node.make((({view:e,state:t,notify:i})=>n.createElement(q,{style:ol},n.createElement("section",null,n.createElement("h2",{className:al},"Formality"),n.createElement(Wa,{className:ll,chips:e("styles").pipe(l.U(K.UI((e=>Object.assign(Object.assign({},e),{isUnselectable:!1}))))),onToggle:e=>i({kind:m.i.Kind.styleToggleClick,id:e.id})()})),n.createElement("section",null,n.createElement("h2",{className:al},"Tone"),n.createElement(u.F.div,{className:cl},"Select up to"," ",e("maxSelectableTones").pipe(l.U((e=>{return t=e,Number.isInteger(t)&&t>=0&&t<10?function(e){return["zero","one","two","three","four","five","six","seven","eight","nine"][e]}(e):`${e}`;var t})))),n.createElement(Wa,{className:ll,chips:e("tones").pipe(l.U(K.UI((e=>Object.assign(Object.assign({},e),{isUnselectable:!0}))))),onToggle:(e,t)=>i({kind:m.i.Kind.toneToggleClick,selected:t,id:e.id})()})),n.createElement(u.F.Fragment,null,t.pipe(l.U((e=>(0,y.zG)(e.roles,ra.c2,h.fold(y.gn,(t=>n.createElement("section",null,n.createElement("h2",{className:al},"Your profession"),n.createElement(Da,{className:hl,placeholder:"Product designer",text:e.roleTypeaheadText,onInputChange:e=>i({kind:"updateRoleTypeaheadText",text:e})(),onSelectionChange:e=>i({kind:m.i.Kind.roleTypeaheadSelectionChange,role:h.fromNullable(e)})(),options:t,label:e=>e.label,clearButton:!0,selectOnBlur:!0}))))))))),n.createElement("section",null,n.createElement("h2",{className:al},"I write in"),n.createElement(u.F.Fragment,null,t.pipe(l.U((({dialects:e,selectedDialect:t})=>n.createElement(wa,{className:gl,options:e.filter((e=>!sa.L.Dialect.Id.eq.equals(e.id,t.id))),selection:t,onSelectionChange:e=>i({kind:m.i.Kind.dialectDropdownSelectionChange,dialect:e})(),label:e=>e.label,renderOption:e=>n.createElement("div",{className:fl},n.createElement("div",{className:vl},n.createElement("img",{src:e.iconUrl,style:{width:I.ux.rem(1),height:I.ux.rem(1)}})),e.label)})))))),n.createElement(u.F.Fragment,null,e("description").pipe(l.U((e=>""!==e.trim()?n.createElement("div",{className:ul},e):null)))),n.createElement(u.F.div,{className:dl},n.createElement(p.z.Tertiary,{className:pl,onClick:i({kind:m.i.Kind.voiceProfileCloseButtonClick}),name:"closeVoiceProfile"},"Close"),e("applyButtonEnabled").pipe(l.U((e=>n.createElement(p.z.Primary,{className:ml,onClick:i({kind:m.i.Kind.voiceProfileUseVoiceButtonClick}),disabled:!e,name:"applyVoiceProfile"},"Use this voice"))))))));var bl,xl=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(bl||(bl={}));const Sl=({tabs:e,activeTabId:t,onActiveTabChange:i,children:r})=>n.createElement(n.Fragment,null,n.createElement("div",{className:wl,role:"tablist"},e.map((e=>n.createElement("button",{key:e.id,onClick:()=>i(e.id),tabIndex:0,className:Cl,id:`tab-${e.id}`,"aria-label":`${e.label} ${e.id===t?"Selected.":""}`,"aria-controls":`tabpanel-${e.id}`,"aria-selected":t===e.id,role:"tab",type:"button"},e.label)))),r),kl=e=>{var{id:t,isActive:i,children:r,className:s,style:o}=e,a=xl(e,["id","isActive","children","className","style"]);return n.createElement("div",Object.assign({role:"tabpanel",id:`tabpanel-${t}`,"aria-labelledby":`tab-${t}`,hidden:!i,style:i?o:void 0,className:i?s:void 0},a),r)},wl=I.ux.style({display:"flex",alignContent:"flex-start",gap:I.ux.rem(_.x)}),Cl=I.ux.style({cursor:"pointer",border:"none",display:"flex",alignItems:"center",background:"transparent",borderBottom:`${I.ux.rem(_.yC)} solid transparent`,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),height:I.ux.rem(1.5),color:Ae.Z.TextBaseSubduedColor,$nest:{'&[aria-selected="true"]':{borderBottomColor:Ae.Z.TextBaseSubduedColor,fontWeight:700},'&[aria-selected="false"]:hover':{borderBottomColor:w.BlueGray10}}});function _l({label:e,enabled:t,onChange:i}){return n.createElement("div",{className:Il},n.createElement("input",{type:"checkbox",id:"voice-checkbox",checked:t,onChange:i}),n.createElement("label",{htmlFor:"voice-checkbox"},e))}const Il=I.ux.style({display:"flex",alignItems:"flex-start",$nest:{"& input[type='checkbox']":{margin:`${I.ux.rem(_.W9)} ${I.ux.rem(_.x)} 0 0`,minWidth:I.ux.rem(1),minHeight:I.ux.rem(1),accentColor:w.Green80,cursor:"pointer"},"& label":{color:$.XY.Content.Primary.Default,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),cursor:"pointer"}}});var El=i(17579);const Al={editBtn:"editBtn",cancelBtn:"cancelBtn",saveBtn:"saveBtn"},Ol={base:{backgroundColor:Ae.Z.BlueGray0}},Rl={gap:0,backgroundImage:"url(https://assets.grammarly.com/cheetah/v1/voice-profile/cheetah-my-voice-bg.svg)",backgroundPosition:"right",backgroundRepeat:"no-repeat",backgroundSize:"auto 100%",$nest:{[`.${Al.editBtn}`]:{opacity:0,pointerEvents:"none",$nest:{"&:focus":{opacity:1,pointerEvents:"auto"}}},[`&:hover .${Al.editBtn}, &:focus .${Al.editBtn}`]:{opacity:1,pointerEvents:"auto"}}},Tl=e=>I.ux.style({display:"flex",justifyContent:"space-between",marginBottom:e?I.ux.rem(_.x):I.ux.rem(_.yC+_.F2)}),Pl=I.ux.style({margin:0,fontSize:I.ux.rem(1.25),lineHeight:I.ux.rem(1.5),fontWeight:700}),Ul=I.ux.style({display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between"}),Bl=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.x)}),Nl=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.F2)}),zl=I.ux.style({color:Ae.Z.TextBaseSubduedColor,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),margin:0}),Fl=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x)}),jl=I.ux.style({width:I.ux.rem(1.5),height:I.ux.rem(1.5),display:"flex",alignItems:"center",justifyContent:"center",$nest:{"& img":{width:I.ux.rem(1),height:I.ux.rem(1)}}}),Gl=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.F2)}),Ml=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.F2),height:I.ux.rem(1.5),color:Ae.Z.TextBaseSubduedColor,fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.3125),fontWeight:500}),Dl=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x)});var Vl=i(6356);const Hl=({children:e,theme:t,body:i,placement:r,active:s,onCloseButtonClick:o})=>{const a=n.useRef(null);return n.createElement(n.Fragment,null,n.createElement(Vl.J,{placement:r,reference:s&&a.current||void 0,theme:t},n.createElement($o.x,{onClick:o,name:"tooltipClose",className:Ll,size:"small"}),i),n.cloneElement(e,{ref:a}))},Ll=I.ux.style({position:"absolute",top:I.ux.rem(_.x),right:I.ux.rem(_.x)}),Kl=n.forwardRef((function({name:e,active:t,onClick:i},r){return n.createElement("button",{role:"button",tabIndex:0,"aria-label":e,"aria-pressed":t,"data-active":t,onClick:i,ref:r,className:$l},e)})),$l=I.ux.style({display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",height:I.ux.rem(2),borderRadius:I.ux.rem(C.xB),border:`${I.ux.rem(_.yC)} solid transparent`,padding:`${I.ux.rem(_.yC+_.F2)} ${I.ux.rem(_.x)}`,backgroundColor:Ae.Z.Green0,color:Ae.Z.Green90,lineHeight:I.ux.rem(1.3125),fontSize:I.ux.rem(.875),$nest:{"&:hover":{backgroundColor:I.ux.color(Ae.Z.Green10).mix(I.ux.color(Ae.Z.BlueGray5)).toRGBA().toString(),color:Ae.Z.Green80},'&[data-active="true"]':{outline:`${I.ux.rem(_.yC)} solid ${Ae.Z.Green80}`}}}),Wl=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M18.5 11.25a.958.958 0 0 1-.064.34l-2.248 4.267a1.009 1.009 0 0 1-.938.643H9.5c-.554 0-1-.446-1-1V10a1 1 0 0 1 .294-.706l4.586-4.587.432.432a.664.664 0 0 1 .188.433l-.016.175-.654 3.151a.5.5 0 0 0 .49.602H18c.274 0 .5.226.5.5v1.25ZM6 9.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h1Z",stroke:"#646B81",strokeLinejoin:"round"})),Zl=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M5 12.75c0-.114.023-.233.065-.34l2.247-4.267.01-.017.007-.017c.155-.357.51-.609.921-.609H14c.554 0 1 .446 1 1V14a1 1 0 0 1-.294.706l-4.586 4.587-.432-.432a.664.664 0 0 1-.188-.433l.016-.175.654-3.151.124-.602H5.5A.503.503 0 0 1 5 14v-1.25Zm12.5 1.75a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5h-1Z",stroke:"#646B81"})),ql=({onKeepClick:e,onRemoveClick:t})=>n.createElement("div",{className:Yl},n.createElement("h1",{className:Xl},"Does this sound like you?"),n.createElement("div",{className:Ql},n.createElement(p.z.Primary,{onClick:e,style:Jl},n.createElement(Wl,null),"Yes, keep it"),n.createElement(p.z.Primary,{onClick:t,style:Jl},n.createElement(Zl,null),"No, remove it"))),Yl=I.ux.style({display:"flex",flexDirection:"column",alignItems:"flex-start"}),Xl=I.ux.style({fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.375),fontWeight:700,margin:`0 0 ${I.ux.rem(_.mh)} 0`}),Ql=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x)}),Jl={base:{gap:I.ux.rem(_.F2),padding:`0 ${I.ux.rem(_.x)} 0 ${I.ux.rem(_.F2)}`,color:Ae.Z.TextBaseDefault,backgroundColor:$.XY.Surface.Primary.Default},hovered:{color:Ae.Z.TextBaseDefault,backgroundColor:Ae.Z.BlueGray5},active:{color:Ae.Z.TextBaseDefault,backgroundColor:Ae.Z.BlueGray5}},ec=({profile:e,activeProfileName:t,activeTagId:i,onCloseButtonClick:r,onKeepClick:s,onRemoveClick:o,onVoiceTagClick:a})=>n.createElement(kl,{id:bl.Id.create(e.name),isActive:e.name===h.toNullable(t),className:tc},e.summary,n.createElement("div",{className:nc},e.sections.map((t=>n.createElement("div",{key:t.name},t.name,n.createElement("div",{className:rc},0===t.tags.length?n.createElement("div",{className:ic},"Detected qualities will appear here"):t.tags.map((l=>n.createElement(Hl,{key:l.name,active:(0,y.zG)(i,h.fold(y.jv,(i=>i===sa.b.createId({tagName:l.name,sectionName:t.name,profileName:e.name})))),onCloseButtonClick:r,body:n.createElement(ql,{onKeepClick:s,onRemoveClick:()=>o(l.name,e.name,t.name)})},n.createElement(Kl,{name:l.name,active:(0,y.zG)(i,h.fold(y.jv,(i=>i===sa.b.createId({tagName:l.name,sectionName:t.name,profileName:e.name})))),onClick:()=>a(l.name,e.name,t.name)})))))))))),tc=I.ux.style({fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.3125),display:"flex",flexDirection:"column",gap:I.ux.rem(_.qp),paddingTop:I.ux.rem(_.x)}),ic=I.ux.style({padding:`0 ${I.ux.rem(_.x)}`,background:Ae.Z.BlueGray0,color:Ae.Z.TextBaseSubduedColor,borderRadius:I.ux.rem(C.xB),height:I.ux.rem(2),fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.3125),display:"flex",justifyContent:"center",alignItems:"center"}),nc=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.qp)}),rc=I.ux.style({marginTop:I.ux.rem(_.x),display:"flex",flexWrap:"wrap",gap:I.ux.rem(_.F2)}),sc=(0,d.xb)((({onEditButtonClick:e,onSaveButtonClick:t,onCancelButtonClick:i,onDialectDropdownChange:r,onRoleDropdownChange:s,userName:o,isEditing:a,selectedRole:l,roles:c,dialects:u,selectedDialect:d})=>n.createElement(q,{style:Rl},n.createElement("div",{className:Tl(a)},n.createElement("h1",{className:Pl},o),a?null:n.createElement(p.z.Secondary,{onClick:e,className:Al.editBtn,style:Ol,size:"small"},"Edit")),a?n.createElement("div",{className:Ul},n.createElement("div",{className:Bl},0!==c.length&&n.createElement("div",{className:Nl},n.createElement("h2",{className:zl},"My role"),n.createElement(wa,{placeholder:"Select a role...",options:c,selection:h.toUndefined(l),onSelectionChange:s,label:e=>e.id,renderOption:e=>e.id})),n.createElement("div",{className:Nl},n.createElement("h2",{className:zl},"I write in"),n.createElement(wa,{options:u,selection:d,onSelectionChange:r,label:e=>e.label,renderOption:e=>n.createElement("div",{className:Fl},n.createElement("div",{className:jl},n.createElement("img",{src:e.iconUrl,alt:""})),e.label)}))),n.createElement("div",{className:Dl},n.createElement(p.z.Tertiary,{onClick:i},"Cancel"),n.createElement(p.z.Primary,{onClick:t},"Save"))):n.createElement("div",{className:Gl},(0,y.zG)(l,h.fold(y.gn,(e=>n.createElement("div",{className:Ml},n.createElement(El.N,null),n.createElement("span",null,e.label))))),n.createElement("div",{className:Ml},n.createElement("div",{className:jl},n.createElement("img",{src:d.iconUrl,alt:""})),n.createElement("span",null,d.label)))))),oc=r.UI.Node.make((({view:e,state:t,notify:i})=>n.createElement("div",{className:ac},n.createElement(sc,{onEditButtonClick:i({kind:m.i.Kind.voiceSelectionsEditButtonClick}),onDialectDropdownChange:e=>i({kind:m.i.Kind.voiceDialectDropdownSelectionChange,dialect:e})(),onRoleDropdownChange:e=>i({kind:m.i.Kind.voiceRoleDropdownSelectionChange,role:e})(),onSaveButtonClick:i({kind:m.i.Kind.voiceSelectionsSaveButtonClick}),onCancelButtonClick:i({kind:m.i.Kind.voiceSelectionsCancelButtonClick}),userName:e("userName"),isEditing:e("isEditing"),selectedRole:e("selectedRole"),selectedDialect:e("selectedDialect"),roles:e("roles"),dialects:e("dialects")}),n.createElement(q,{style:lc},n.createElement(u.F.div,null,t.pipe(l.U((e=>n.createElement(n.Fragment,null,n.createElement("div",{className:cc},n.createElement("div",null,n.createElement("h1",{className:uc},e.title),n.createElement("h2",{className:dc},e.subTitle)),n.createElement(Sl,{key:"Tabs",tabs:e.profiles.map((e=>({id:bl.Id.create(e.name),label:e.name}))),activeTabId:bl.Id.create(h.toNullable(e.activeProfileName)||""),onActiveTabChange:e=>i({kind:m.i.Kind.voiceProfileTabChange,profileName:e})()})),e.profiles.map((t=>n.createElement(ec,{key:t.name,profile:t,activeProfileName:e.activeProfileName,activeTagId:e.activeTagId,onCloseButtonClick:i({kind:m.i.Kind.voiceTagPopoverCloseButtonClick}),onKeepClick:i({kind:m.i.Kind.voiceTagPopoverKeepButtonClick}),onRemoveClick:(e,t,n)=>i({kind:m.i.Kind.voiceTagPopoverRemoveButtonClick,tagName:e,profileName:t,sectionName:n})(),onVoiceTagClick:(e,t,n)=>i({kind:m.i.Kind.voiceTagClick,tagName:e,profileName:t,sectionName:n})()})))))))),n.createElement(Zi,null),n.createElement(u.F.Fragment,null,t.pipe(l.U((({isEnabledByDefault:e,isEnabledByDefaultLabel:t})=>n.createElement(_l,{enabled:e,label:t,onChange:i({kind:m.i.Kind.applyVoiceToWritingCheckboxChange,checked:!e})}))))))))),ac=I.ux.style({display:"flex",flexDirection:"column",gap:I.ux.rem(_.x),maxHeight:I.ux.rem(35),overflowY:"scroll"}),lc={gap:I.ux.rem(_.mh)},cc=I.ux.style({display:"flex",justifyContent:"space-between",alignItems:"flex-start"}),uc=I.ux.style({fontSize:I.ux.rem(.875),lineHeight:I.ux.rem(1.3125),fontWeight:700,margin:0}),dc=I.ux.style({color:Ae.Z.TextBaseSubduedColor,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),margin:0}),mc=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:gc},e.notifications,e.content))),pc=r.UI.Union.make("kind",{chat:fo,legacyVoiceProfile:yl,newVoiceProfile:oc,feedbackForm:Lo}),hc=r.UI.Knot.make(mc,{content:pc,notifications:ea}),gc=I.ux.style({position:"relative",padding:I.ux.rem(_.x),paddingTop:0}),fc=e=>n.createElement(a.a1,{className:e.className,viewBox:"0 0 22 22",width:22,height:22},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 11C22 17.0749 17.0753 22 11 22C4.92513 22 0 17.0749 0 11C0 4.92465 4.92513 0 11 0C17.0753 0 22 4.92465 22 11Z",fill:"#018374",stroke:"none"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.4371 13.3755C12.5021 13.7356 12.8407 13.9824 13.2066 13.9824H14.3592L15.0274 13.8887C13.9584 15.4569 12.1023 16.1786 10.0731 15.8601C8.42114 15.6008 7.00214 14.4831 6.40336 12.9221C5.04414 9.37866 7.63201 5.99545 11.0042 5.99545C12.7618 5.99545 14.3037 7.05097 15.1876 8.29349C15.4224 8.63162 15.8868 8.72871 16.2254 8.49388C16.5468 8.27101 16.6405 7.84775 16.4473 7.51488C15.2249 5.60662 13.0282 4.38562 10.558 4.5511C7.34171 4.76679 4.73901 7.39866 4.55392 10.6169C4.33918 14.3617 7.30966 17.4192 11.0042 17.4192C12.945 17.4192 14.6825 16.5741 15.8662 15.2068L15.7261 15.9911V16.6999C15.7261 17.0653 15.9724 17.4044 16.3325 17.4694C16.8055 17.5545 17.2168 17.1934 17.2168 16.7362V12.4912H13.1698C12.7126 12.4912 12.3515 12.903 12.4371 13.3755Z",fill:"white",stroke:"none"})),vc=r.UI.Node.make((({notify:e,view:t})=>n.createElement("div",{className:yc},n.createElement(p.z.Tertiary,{compact:!0,onClick:e({kind:m.i.Kind.toolbarGoBackButtonClick}),name:"goBack"},n.createElement(a.JO.Arrow,{direction:a.n4.left})),n.createElement(u.F.div,{className:bc},t("activeViewIconUrl").pipe(l.U(h.fold(y.gn,(e=>n.createElement("img",{src:e,style:{width:I.ux.rem(1.25),height:I.ux.rem(1.25)}}))))),t("activeViewLabel").pipe(l.U(h.fold(y.gn,(e=>n.createElement("span",null,e))))))))),yc=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x),color:w.BlueGray60,fontWeight:400,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125)}),bc=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x)});var xc=i(49708),Sc=i(598),kc=i(13444),wc=i(2768);const Cc=r.UI.Node.make((({state:e,notify:t})=>{const{ref:i,onMount:r}=s.P.useElWatcher(),o=n.useMemo((()=>i.pipe(D.oA,Xe.w((e=>xc.R(e,"mouseenter").pipe(Sc.c(xe.of(null).pipe(kc.g(500),wc.R(xc.R(e,"mouseleave"))))))),V.b(t({kind:m.i.Kind.creditsInfoHover})))),[i]);s.P.useSubscriptionTo(o);const{onMount:a}=(0,_e.F)(V.b((e=>t({kind:m.i.Kind.mount,name:Ze.e.creditsInfoButton,element:e})())));return n.createElement(u.F.Fragment,null,e.pipe(l.U((({user:e,genAIAvailability:i})=>{const s=Ts._.isActive(i)?function(e){const t=`${Number(e.promptsRemaining).toLocaleString()}/${Number(e.promptsAllocated).toLocaleString()} prompts left. `,i=Ts._.Active.daysUntilRefillDate(e.refillDate),n=Ts._.Active.hoursUntilRefillDate(e.refillDate);return i>0?t+`Next refill in ${i} ${an._6(i,"day","days")}.`:n>0?t+`Next refill in ${n} ${an._6(n,"hour","hours")}.`:t+"Next refill in less than an hour."}(i):e.isPremium?"To get more prompts, contact support.":"To get more prompts, upgrade to Premium.",o=Ts._.isActive(i)?`${Number(i.promptsRemaining).toLocaleString()} ${an._6(i.promptsRemaining,"prompt","prompts")}`:e.isPremium?"0 prompts":n.createElement(n.Fragment,null,"0 prompts. ",n.createElement("span",{className:Ec},"Upgrade"));return e.isPremium&&Ts._.isActive(i)?n.createElement(n.Fragment,null,Ts._.isActiveUnlimited(i)?null:n.createElement(ln.u,{title:s},n.createElement("div",{ref:r,className:Ic},o))):n.createElement(p.z.Tertiary,{onClick:t({kind:m.i.Kind.creditsInfoClick}),title:s,name:"creditsInfo",mount:a},n.createElement("div",{ref:r},o))}))))})),_c=r.UI.Union.asOption(Cc),Ic=I.ux.style({padding:`${I.ux.rem(_.x)}`,fontSize:I.ux.rem(.75),lineHeight:I.ux.rem(1.125),color:$.XY.Content.Secondary.Default,cursor:"default"}),Ec=I.ux.style({color:w.Blue60}),Ac=e=>n.createElement(a.a1,Object.assign({width:"17",height:"16",viewBox:"0 0 17 16",fill:Ae.Z.TextBaseSubduedColor},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.5 8C2.5 4.41015 5.41015 1.5 9 1.5C12.5899 1.5 15.5 4.41015 15.5 8C15.5 11.5899 12.5899 14.5 9 14.5C7.85901 14.5 6.73812 14.1997 5.75 13.6292C5.51085 13.4911 5.42892 13.1853 5.56699 12.9462C5.70506 12.707 6.01085 12.6251 6.25 12.7631C7.08611 13.2459 8.03455 13.5 9 13.5C9.96545 13.5 10.9139 13.2459 11.75 12.7631C12.5861 12.2804 13.2804 11.5861 13.7631 10.75C14.2459 9.91389 14.5 8.96545 14.5 8C14.5 4.96243 12.0376 2.5 9 2.5C5.96243 2.5 3.5 4.96243 3.5 8V8.29289L4.64645 7.14645C4.84171 6.95118 5.15829 6.95118 5.35355 7.14645C5.54882 7.34171 5.54882 7.65829 5.35355 7.85355L3.35355 9.85355L3 10.2071L2.64645 9.85355L0.646447 7.85355C0.451184 7.65829 0.451184 7.34171 0.646447 7.14645C0.841709 6.95118 1.15829 6.95118 1.35355 7.14645L2.5 8.29289V8ZM9 4C9.27614 4 9.5 4.22386 9.5 4.5V7.5H11.5C11.7761 7.5 12 7.72386 12 8C12 8.27614 11.7761 8.5 11.5 8.5H9H8.5V8V4.5C8.5 4.22386 8.72386 4 9 4Z",stroke:"none"})),Oc=r.UI.Node.make((({view:e,notify:t})=>{const{onMount:i}=(0,_e.F)(V.b((e=>t({kind:m.i.Kind.mount,name:Ze.e.historyButton,element:e})())));return n.createElement(p.z.Tertiary,{mount:i,onClick:t({kind:m.i.Kind.restoreHistoryButtonClick}),disabled:e("disabled"),compact:!0,style:Tc,size:"medium",name:"restoreHistory",title:"Pick up where you left off"},n.createElement(Ac,null))})),Rc=r.UI.Union.asOption(Oc),Tc={base:{boxShadow:`0px 0px 1px ${I.ux.color(w.BlueGray40).toRGBA().fade(.5).toString()}, 0px 0.5px 8px -0.5px ${I.ux.color(w.BlueGray40).toRGBA().fade(.5).toString()}`}},Pc=e=>n.createElement(a.a1,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),n.createElement("path",{d:"M11.1439 8.77381C8.92013 10.9976 5.96543 11.6484 5.12591 10.8089C4.2864 9.96935 4.93718 7.01465 7.16097 4.79086C9.38476 2.56707 12.3395 1.91629 13.179 2.7558C14.0185 3.59531 13.3677 6.55002 11.1439 8.77381Z",stroke:"#646B81"}),n.createElement("path",{d:"M10.0977 5.83569L2.09766 13.8357",stroke:"#646B81",strokeLinecap:"round"}),n.createElement("path",{d:"M7 14C8.81333 12.6019 11.768 10.8841 11 13.9999C12.0667 13.0012 13.744 10.9621 14 12.6398",stroke:"#646B81",strokeLinecap:"round",strokeLinejoin:"round"})),Uc=r.UI.Node.make((({view:e,notify:t})=>n.createElement(p.z.Tertiary,{className:zc,onClick:t({kind:m.i.Kind.toolbarVoiceButtonClick}),name:"toolbarVoiceProfile"},n.createElement(Pc,null),n.createElement(u.F.span,null,e("styleLabel"))))),Bc="voiceBtn",Nc=(0,de.dD)({padding:0,paddingRight:I.ux.rem(_.x),paddingLeft:I.ux.rem(_.x),minHeight:I.ux.rem(1.625),lineHeight:I.ux.rem(1.625),border:I.ux.px(1),borderStyle:"solid",borderColor:w.BlueGray20,borderRadius:I.ux.rem(.8125),gap:I.ux.rem(_.F2),flexWrap:"nowrap",$nest:{"& > i":Object.assign({},(0,de.fx)(1.5))}},Bc),zc=I.ux.joinClasses([Bc,I.ux.style(Nc)]),Fc="logo",jc="sepAndRight",Gc=I.ux.style({display:"flex",alignItems:"center",justifyContent:"space-between",width:I.ux.percent(100),height:I.ux.percent(100),gap:I.ux.rem(_.x),position:"relative",overflow:"hidden"}),Mc=I.ux.style({display:"flex",alignItems:"center",gap:I.ux.rem(_.x),paddingRight:I.ux.rem(_.x)}),Dc=I.ux.style({display:"flex",flexDirection:"row",alignItems:"center",gap:I.ux.rem(_.x)}),Vc={height:I.ux.rem(1),borderLeft:`1px solid ${w.BlueGray20}`},Hc=I.ux.style(Vc),Lc=I.ux.style({display:"flex",flexDirection:"row",alignItems:"center",gap:I.ux.rem(_.F2)}),Kc=I.ux.joinClasses([I.ux.style({display:"flex",alignItems:"center",justifyContent:"center",height:I.ux.rem(2)}),Fc]),$c=I.ux.style({display:"flex",flexDirection:"row",alignItems:"center"}),Wc=(I.ux.style(Object.assign(Object.assign({},Vc),{marginLeft:I.ux.rem(_.x),marginRight:I.ux.rem(_.F2)})),I.ux.joinClasses([I.ux.style({display:"flex",alignItems:"center"}),jc])),Zc=(I.ux.style({display:"flex",flexDirection:"row",alignItems:"center",height:I.ux.rem(2)}),r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Dc},e.back,n.createElement("div",{className:Hc}),e.voice)))),qc=r.UI.Knot.make(Zc,{back:vc,voice:Uc}),Yc=()=>n.createElement("div",{className:$c},n.createElement(fc,{className:Kc})),Xc=r.UI.Node.make(Yc),Qc=r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Lc},n.createElement(Yc,null),n.createElement("div",{className:Wc},e.content)))),Uc),Jc=r.UI.Union.make("kind",{logoOnly:Xc,logoAndVoiceButton:Qc,backButton:vc,backButtonAndVoiceButton:qc}),eu=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Mc},e.historyButton,e.credits))),tu=r.UI.Knot.make(eu,{historyButton:Rc,credits:_c}),iu=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Gc},e.left,e.right))),nu=r.UI.Knot.make(iu,{left:Jc,right:tu}),ru=r.UI.Knot.make(M,{toolbar:nu,content:hc});function su(e){return r.UI.Knot.make(r.UI.Grid.make((({slots:t})=>n.createElement(qe.Provider,{value:{notifyUnmount:t=>e.notify(t)}},t.assistant))),{assistant:ru})}},39670:(e,t,i)=>{i.d(t,{Q:()=>It});var n,r,s=i(5114),o=i(57050),a=i(38983),l=i(34217),c=i(24203),u=i(90845),d=i(38194),m=i(24209),p=i(2834),h=i(49143),g=i(2844),f=i(77176),v=i(60797),y=i(66310),b=i(85089),x=i(93508),S=i(85985),k=i(49708),w=i(83401),C=i(22232),_=i(83289),I=i(28043),E=i(2768),A=i(55721),O=i(39719),R=i(67434),T=i(87683);function P(e){return(0,o.ls)(d.B(),(t=>{return m.T(t.pipe(p.b((t=>function(e,t){switch(e.kind){case"focus":return t.position.onFocusChange(e.focused);case"mount":return t.position.onMount(e.element);case"maxSize":return t.position.onMaxHeightChange(e.maxSize.height);case"dragHandleMount":break;case _.i.Kind.toolbarCloseButtonClick:return t.notify(e);default:return(0,C.L0)(e)}}(t,e))),h.l()),t.pipe((i=e.position,(0,o.ls)(f.U((e=>"dragHandleMount"===e.kind?s.some(e.element):s.none)),v.oA,(0,o.ls)(S.h((e=>!!e)),I.x(),y.w((e=>k.R(e,"mousedown").pipe(S.h((e=>!e.button)),p.b((e=>e.preventDefault())),f.U((t=>({element:e,startPos:{x:t.clientX,y:t.clientY}}))),y.w((e=>k.R((0,T.Jj)(e.element),"mousemove").pipe(E.R(k.R((0,T.Jj)(e.element),"mouseup",{capture:!0})),A.p(10),f.U((({clientX:t,clientY:i})=>({kind:"dragInProgress",element:e.element,startPos:e.startPos,delta:{x:t-e.startPos.x,y:i-e.startPos.y}}))),O.l({kind:"dragDone"}))))))),R.R(((e,t)=>"dragDone"===t.kind?{translate:e.translate,lastTranslate:e.translate,dragging:!1,dragStart:!1,dragEnd:e.dragging}:{dragging:!0,dragStart:!e.dragging,dragEnd:!1,lastTranslate:e.lastTranslate,translate:{x:t.delta.x+e.lastTranslate.x,y:t.delta.y+e.lastTranslate.y}}),n.create())),(a=i,(0,o.ls)(d.B(),(e=>(0,o.zG)(m.T(e.pipe(S.h((e=>r.l1Distance(r.fromCartesian(e.translate),r.fromCartesian(e.lastTranslate))>=3)),p.b((e=>a.onDrag(e.translate)))),e.pipe(S.h((e=>e.dragEnd)),p.b((()=>a.onDragEnd())))),h.l())))),h.l()))),t.pipe(function(e){return(0,o.ls)(f.U((e=>"mount"===e.kind?s.some(e.element):s.none)),v.oA,y.w((e=>b.YC(e).pipe(x.O(null),f.U((()=>e.getBoundingClientRect()))))),p.b((t=>e.onResize(t))),h.l())}(e.position)),t.pipe((0,o.ls)(f.U((e=>"mount"===e.kind?s.some(e.element):s.none)),v.oA,f.U(s.some),u.P.FocusTrap.dynamicFocusTrap(u.P.FocusTrap.InitialFocus.none,U,B),h.l())),g.aj([e.position.state,e.assistant.state,e.routing.activeView]).pipe(f.U((([e,{contentOverflowUnderToolbar:t},i])=>Object.assign(Object.assign({},e),{contentOverflowUnderToolbar:t&&"voiceProfile"!==i&&"feedbackForm"!==i})))));var i,a}))}function U(e){var t;if(e instanceof HTMLIFrameElement){const i=null===(t=e.contentWindow)||void 0===t?void 0:t.document;if(i){const e=i.body.querySelector("textarea:not([disabled]), input:not([disabled])");e&&"focus"in e&&"function"==typeof e.focus&&e.focus()}}else e.focus()}function B(e,t){return e instanceof HTMLIFrameElement?e.contentDocument?k.R(e.contentDocument.body,t):w.C:k.R(e,t)}!function(e){e.create=function(){return{translate:{x:0,y:0},lastTranslate:{x:0,y:0},dragging:!1,dragStart:!1,dragEnd:!1}}}(n||(n={})),function(e){e.fromCartesian=function({x:e,y:t}){return{top:t,left:e}},e.l1Distance=function(e,t){return Math.abs(e.top-t.top)+Math.abs(e.left-t.left)}}(r||(r={}));var N=i(819),z=i(42636);function F(e){return l.Z.composeOption((t=e,l.Z.fromSideEffect((e=>t.notify(e)),t.assistant.state.view("selectedAction").view(s.chain((e=>(0,o.zG)(e.args[0].hints,s.map((t=>({header:e.label,iconUrl:e.iconUrl,hintsHeader:t.header,hintsItems:t.items,radioOptions:z.Xy.match({string:()=>s.none,radio:e=>s.some(e.radioOptions)})(e.args[0])}))))))).pipe(v.oA))),(()=>e.assistant.state.view("selectedAction").view(s.chain((e=>e.args[0].hints)))));var t}var j=i(41398);function G(e){const t=e.assistant.state.view("session").pipe(f.U((e=>e.error)));return l.Z.composeOption(function(e,t){const i=e.routing.activeView.view((e=>"loadingError"!==e));return l.Z.fromSideEffect((t=>e.notify(t)),t.pipe(j.M(i),f.U((([e,t])=>({error:e,showGotItButton:t})))))}(e,t.pipe(v.oA)),(()=>t))}var M=i(76974),D=i(48725);function V(e){const t=(0,o.zG)(e,s.map(D.v.unwrap),s.map((e=>e.singleCardFeedViewModel)));return e=>m.T(e.pipe(f.U((e=>e.action)),p.b((e=>{var i,n,r,o;switch(e.kind){case"sduiNotify":return null===(i=s.toNullable(t))||void 0===i?void 0:i.processActions(e.actions,e.item,e.actionScope,e.sourceId);case"sduiItemMounted":return null===(n=s.toNullable(t))||void 0===n?void 0:n.onItemMount(e.item);case"singleCardAnimationEnd":return null===(r=s.toNullable(t))||void 0===r?void 0:r.onAnimationEnd();case"singleCardFeedMounted":return null===(o=s.toNullable(t))||void 0===o?void 0:o.onFeedMount();default:(0,C.L0)(e)}})),h.l()),(0,o.zG)(t,s.fold((()=>M.of({kind:"none"})),(e=>e.state.view((e=>"nonEmptyState"===e.kind?{kind:"nonEmptyState",item:e.focused,prevItem:e.prevFocusedItem,transitions:e.transitions}:e))))))}var H=i(69693);function L(e){const t=e.state.view("session").view((0,o.ls)(s.fromPredicate((e=>H.w.isQuickReply(e.mode))),s.chain((e=>(0,o.zG)("started"===e.kind?(0,o.zG)(e.activeContext.intent,s.map((e=>({kind:"loaded",text:e})))):s.some({kind:"loading"}),s.map((e=>Object.assign(Object.assign({},e),{header:"Sender’s intent"}))))))));return l.Z.composeOption(l.Z.composeUnion({loading:()=>t.pipe(v.oA),loaded:()=>t.pipe(f.U(s.chain((e=>"loaded"===e.kind?s.some({text:e.text,header:e.header}):s.none))),v.oA)},(()=>t.pipe(v.oA))),(()=>t))}var K=i(17889),$=i(35292),W=i(17771),Z=i(64015),q=i(7903),Y=i(95195);function X(e,t,i,n){return l.Z.fromSideEffect((t=>e.notify(t)),g.aj([t,e.assistant.state.view("textBox")]).pipe(f.U((([e,t])=>({icon:"backendAction"===e.kind?Y.right({url:e.action.iconUrl}):Y.left({kind:e.kind}),label:"backendAction"===e.kind?e.action.label:"allResults"===e.kind?"More":"go"===e.kind?`”${t.trim()}”`:(0,C.L0)(e),action:e,mode:i,customViewOpts:n})))))}function Q(e,t,i,n){return l.Z.composeList(Z.Ot,(()=>t.pipe(f.U(s.getOrElse((()=>[]))))),(t=>X(e,M.of(t),i,n)))}function J(e,t){return l.Z.composeList(Z.Ot,(()=>t.pipe(f.U((e=>(0,o.zG)(e,Z.Su(((e,t)=>({category:t,isFirst:0===e})))))))),(({category:t,isFirst:i})=>function(e,t,i){const n=e.assistant.state.view((({session:e,contextualActions:t})=>(0,o.zG)(W.g(s.option)((0,o.zG)(e,q.z.toStarted,s.chain((e=>e.activeBoundaryContext.selection))),t),s.fold(o.jv,o.W8))));return l.Z.composeKnot({root:()=>M.of({label:t.label,view:t.view}),actions:Q(e,M.of(s.some(t.actions)),"standard",{isPinned:t.view===z.aU.Store.View.pinned}),header:l.Z.composeUnion({default:()=>M.of({label:t.label}),withSelectionContext:l.Z.fromSideEffect((t=>e.notify(t)),M.of({label:t.label}))},(()=>n.pipe(f.U((e=>({kind:e&&i?"withSelectionContext":"default"}))))))})}(e,t,i)))}function ee(e,t=o.W8,i=s.some(3)){const n=(0,o.zG)(K.hX((e=>t(e.action)))(e),s.getOrElseW((()=>Z.cS)));return(0,o.zG)(i,s.filter((e=>n.length>e)),s.map((e=>K.Ss(Z.ke(e)(n),{kind:"allResults",filterPredicate:t}))),s.getOrElseW((()=>n)))}function te(e){const t=e.assistant.state.view("session").view((e=>H.w.isQuickReply(e.mode))),i=e.assistant.state.view("session").view("selectedText"),n=e.assistant.state.view("contextualActions").view((e=>(0,o.zG)(e,s.map(K.UI($.Dj.BackendAction.make)),s.map(K.IR($.Dj.BackendAction.ordByActionStore)),s.map(K.UI((e=>({label:e[0].action.store.label,actions:ee(e,(t=>z.aU.Store.Id.eq.equals(t.store.id,e[0].action.store.id)),e[0].action.store.maxCountBeforeClipping),view:e[0].action.store.view})))))));return l.Z.composeUnion({none:()=>M.of(null),loading:()=>a.h.combine(t,i,((e,t)=>({header:e?"Ways to reply":s.isSome(t)?`Work with: ${t.value}`:"Ideas for you",isQuickReply:e,withContext:s.isSome(t)}))),loaded:ie(e,n,t)},(()=>a.h.combine(n,e.assistant.state.view("session"),((e,t)=>s.isSome(e)?"started"===t.kind&&"pending"===t.activeContext.kind?{kind:"loading"}:{kind:"loaded"}:"started"===t.kind?{kind:"none"}:{kind:"loading"}))))}function ie(e,t,i){return l.Z.composeKnot({root:l.Z.fromSideEffect((t=>e.notify(t)),i.view((e=>({isQuickReply:e})))),actions:J(e,t.pipe(v.oA))})}function ne(e){const t=e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.chain((e=>e.activeContext.documentOverview))));return l.Z.composeOption((()=>(0,o.zG)(t,v.oA)),(()=>t))}function re(e){const t=e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.fold(o.jv,(e=>e.voiceProfile.needsSetup))));return l.Z.composeOption(l.Z.fromSideEffect((t=>e.notify(t)),null),(()=>t.view((e=>e?s.some(null):s.none))))}function se(e){return l.Z.composeKnot({suggestions:V(e.revision),voiceBanner:re(e),intent:L(e.assistant),actions:te(e),documentOverview:ne(e)})}var oe=i(14047),ae=i(27278);function le(e){const t=e.assistant.state.view("contextualActions").view((e=>(0,o.zG)(e,s.map(K.UI($.Dj.BackendAction.make)),s.map((e=>ee(e,(0,o.ff)(z.aU.isSkillActionInput)))),s.chain(K.c2))));return l.Z.composeUnion({none:()=>M.of(null),loading:()=>M.of(null),actions:l.Z.composeKnot({root:l.Z.fromSideEffect((t=>e.notify(t)),null),actions:Q(e,t,"compact")})},(()=>a.h.combine(t,e.assistant.state.view("genAIAvailability"),e.assistant.state.view("session"),((e,t,i)=>(0,o.zG)(q.z.toStarted(i),s.map((e=>e.activeContext)),s.fold((()=>"none"),(i=>(0,o.zG)(e,s.filter((()=>!N._.isUnavailable(t))),s.fold((()=>N._.isUnavailable(t)||!ae._.isPending(i)?"none":"loading"),(()=>"actions"))))),(e=>({kind:e})))))))}var ce=i(8125);function ue(e){return()=>e.assistant.state.view("session").view("selectedText").pipe(f.U((e=>({header:s.isSome(e)?`Work with: ${e.value}`:"Ideas for you",isQuickReply:!1,withContext:s.isSome(e)}))))}function de(e){const t=e.assistant.state.view("contextualActions").view((e=>(0,o.zG)(e,s.chain(K.hX((0,ce.ff)(z.aU.isSkillActionInput))),s.map(K.UI($.Dj.BackendAction.make)),s.map(K.IR($.Dj.BackendAction.ordByActionStore)),s.map(K.UI((e=>({label:e[0].action.store.label,actions:ee(e,(t=>z.aU.Store.Id.eq.equals(t.store.id,e[0].action.store.id))),view:e[0].action.store.view})))))));return l.Z.composeKnot({actions:J(e,t.pipe(v.oA))})}function me(e){return l.Z.composeOption(l.Z.composeKnot({actions:l.Z.composeUnion({loading:ue(e),loaded:de(e)},(()=>e.assistant.state.view("session").view(q.z.toStarted).pipe(f.U(s.map((e=>"pending"===e.activeContext.kind?{kind:"loading"}:{kind:"loaded"}))),v.oA)))}),(()=>e.assistant.state.view("session").view(q.z.toStarted)))}function pe(e){return l.Z.composeUnion({followUp:l.Z.composeKnot({actions:le(e)}),newContext:me(e)},(()=>e.assistant.state.view("session").view(q.z.toStarted).pipe(f.U((e=>(0,o.zG)(e,s.map((e=>e.activeContext.isBoundary&&s.isSome(e.activeContext.textRevision)?"newContext":"followUp"))))),v.oA,f.U((e=>({kind:"followUp"===e?"followUp":"newContext"}))))))}var he=i(24713),ge=i(26328);function fe(e,t){return l.Z.fromSideEffect((t=>e.notify(t)),t)}function ve(e,t){const i=function(e,t){return e.assistant.state.view((({genAIAvailability:e,session:i})=>(0,o.zG)(q.z.toStarted(i),s.map((i=>{const n=N._.isPassive(e)||N._.isUnavailable(e),r=(0,o.zG)(i.activeContext.userPromptAction,s.chain((e=>(0,o.zG)(t.header.copiablePrompt,s.map((t=>z.aU.UserPromptActionValue.fromInput(e,t,s.none,s.none)))))));return{actions:(0,o.zG)(ge.nI(i.activeContext.availableActions.filter((0,ce.Kg)(z.aU.isFollowUpQuestionActionInput,z.aU.isQuickActionInput))),s.filter((()=>!n)),s.map(ge.UI($.Dj.BackendAction.make))),originalAction:r,disabled:n,result:t}}))))).pipe(v.oA)}(e,t),n=i.pipe(he.j("actions"));return l.Z.composeKnot({root:fe(e,i),actions:Q(e,n,"standard")})}var ye=i(36991),be=i(80900),xe=i(17343),Se=i(51739);const ke=(e,t,i)=>{const n=e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.chain((e=>s.fromNullable(e.results[i+1]))),s.filter(oe.x.isComplete),s.chain((e=>e.boundaryContextId)))),r=t.pipe(j.M(n),f.U((([e,t])=>(0,o.zG)(e,s.filter((e=>oe.x.isComplete(e)||oe.x.isInProgress(e))),s.chain((e=>e.boundaryContextId)),s.filter((e=>!!s.isNone(t)||e!==t.value)))))),a=r.pipe(f.U(s.chain((t=>e.assistant.getContextById(t))))),c=a.pipe(f.U((e=>(0,o.zG)(e,s.chain((e=>e.selection))))));return l.Z.composeOption(l.Z.fromSideEffect((t=>e.notify(t)),g.aj([a,e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.map((({textRevision:e})=>e))))]).pipe(f.U((([e,t])=>W.Y(s.option)({selection:(0,o.zG)(e,s.chain((({selection:e})=>e))),currentTextRevision:t,contextTextRevision:(0,o.zG)(e,s.map((({textRevision:e})=>e)))}))),v.oA,f.U((({selection:e,currentTextRevision:t,contextTextRevision:i})=>({selectedText:e.text,selectedRange:s.isSome(i)&&t===i.value?e.range:void 0}))))),(()=>c))};var we=i(20491);function Ce(e,t,i,n){return l.Z.composeKnot({root:l.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.view((({genAIAvailability:e,activeCards:n,session:r,referencesVisibility:s,overrideCardVoice:a})=>{var l,c;return{disabled:N._.isUnavailable(e),result:t,isActive:(0,o.zG)(!!n.has(t.id)||0===n.size&&i&&!_e(q.z.toStarted(r))),isReferencesOpen:null!==(l=s.get(t.id))&&void 0!==l&&l,isMyVoice:(null!==(c=a.get(t.id))&&void 0!==c?c:(0,o.zG)(t.replacementDelta,Y.fold((()=>oe.x.GeneratedTextVoice.generic),(e=>e.preferVoice))))===oe.x.GeneratedTextVoice.user}}))),header:l.Z.composeKnot({root:l.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.pipe(y.w((e=>{const i=(0,o.zG)(t.header.copiablePrompt,s.fold((()=>({kind:we.C$.searchLabel,label:t.header.label,iconUrl:t.header.iconUrl})),(i=>({kind:we.C$.clickableSearchLabel,label:t.header.label,disabled:N._.isUnavailable(e.genAIAvailability),copiablePrompt:i}))));return oe.x.isComplete(t)&&function(e){return(0,o.zG)(e.replacementDelta,Y.fold(o.yR,(e=>e.generic)),(e=>e.ops.some((e=>{var t;return ye.s.isInsert(e)&&!!(null===(t=e.attributes)||void 0===t?void 0:t[Se.U.knowledgeHubTerm])}))))}(t)&&t.timestamp+3e3>Date.now()?be.H(t.timestamp+3e3-Date.now()).pipe(xe.h(i),x.O({kind:we.C$.knowledgeHub})):M.of(i)})))),voiceButton:l.Z.composeOption(l.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.pipe(f.U((e=>{var i;return{selectedVoice:null!==(i=e.overrideCardVoice.get(t.id))&&void 0!==i?i:(0,o.zG)(t.replacementDelta,Y.fold((()=>oe.x.GeneratedTextVoice.generic),(e=>e.preferVoice))),resultId:t.id}})))),(()=>M.of((0,o.zG)(t.replacementDelta,s.fromEither))))}),contextHeader:ke(e,M.of(s.some(t)),n)})}function _e(e){return(0,o.zG)(e,s.fold(o.jv,(e=>s.isSome(e.inProgressResult)||s.isSome(e.error))))}var Ie=i(3709),Ee=i(12126),Ae=i(87938),Oe=i(77843);const Re=[{text:"Working on it...",isMyVoice:!1},{text:"Applying your style...",isMyVoice:!0},{text:"Using your preferred words...",isMyVoice:!0},{text:"Structuring sentences your way...",isMyVoice:!0},{text:"Adjusting your formality...",isMyVoice:!0},{text:"Dotting the i’s and crossing the t’s...",isMyVoice:!0}];function Te(e){const t=e.state.view("session").view(q.z.toStarted).view(s.chain((e=>e.inProgressResult))),i=t.pipe(v.oA,f.U((e=>e.text)),x.O("")),n=t.pipe(f.U(s.map((e=>e.header.label))),v.oA,x.O("")),r=t.pipe(f.U(s.chain((e=>e.header.iconUrl)))),o=Ee.D(Re).pipe(Ae.j(((e,t)=>Oe.F(3e3*t)))),a=o.pipe(f.U((e=>e.text))),l=o.pipe(f.U((e=>e.isMyVoice)));return()=>g.aj([i,a,l,n,r]).pipe(f.U((([e,t,i,n,r])=>({resultText:e,statusText:t,sourceLabel:n,sourceIconUrl:r,isMyVoiceStatus:i||e.length>0}))))}function Pe(e){return()=>e.assistant.state.view("session").view(q.z.toStarted).view((0,o.ls)(s.chain((e=>e.inProgressResult)),s.map((e=>({result:e}))))).pipe(v.oA)}function Ue(e){const t=e.assistant.state.view("session").view(q.z.toStarted).view(s.chain((0,o.ls)((e=>e.voiceProfile),Ie.L.toNewVoiceProfile,s.map((e=>e.isEnabledByDefault))))).view(s.getOrElse(o.jv));return l.Z.composeUnion({regularCardInProgress:Pe(e),myVoiceCardInProgress:Te(e.assistant)},(()=>t.pipe(f.U((e=>e?{kind:"myVoiceCardInProgress"}:{kind:"regularCardInProgress"})))))}function Be(e){const t=e.assistant.state.view("session").view(q.z.toStarted).view((0,o.ls)(s.chain((e=>e.inProgressResult)),s.map((e=>({result:e})))));return l.Z.composeOption(function(e){return l.Z.composeKnot({content:Ue(e),header:ke(e,e.assistant.state.view("session").view(q.z.toStarted).view(s.chain((e=>e.inProgressResult))),-1)})}(e),(()=>t))}var Ne=i(83078),ze=i(86148);function Fe(e,t){return l.Z.composeOption(l.Z.fromSideEffect((t=>e.notify(t)),e.userSurvey.state.pipe(f.U((e=>(0,o.zG)(e.activeSurvey,s.map((t=>({survey:t,state:e})))))),v.oA,f.U((({survey:e,state:t})=>({survey:e,stage:t.stage,transitionStage:t.transitionStage,rating:t.rating,openAnswer:(0,o.zG)(t.openAnswer,s.getOrElse((0,o.a9)(""))),ratingLabels:(0,o.zG)(t.activeSurvey,s.fold((0,o.a9)([]),(e=>e.ratingLabels))),errors:t.errors}))))),(()=>a.h.combine(e.userSurvey.state,t,(({activeSurvey:e,stage:t},i)=>(0,o.zG)(e,s.filter((e=>(0,o.zG)(i,Ne.FX(e.resultId))&&t!==ze.x.Stage.Type.Closed)))))))}function je(e,t){return l.Z.composeList(Z.Ot,(()=>t.pipe(f.U((0,o.ls)(Z.ke(50),Z.Su(((e,t)=>({result:t,isLast:0===e,index:e}))),Z.GY)))),(({result:t,isLast:i,index:n})=>function(e,t,i,n){return l.Z.composeUnion({complete:Ce(e,t,i,n),aiUsageNotification:ve(e,t)},(()=>M.of(oe.x.isAIUsageNotification(t)?{kind:"aiUsageNotification"}:{kind:"complete"})))}(e,t,i,n)))}function Ge(e,t){return l.Z.composeOption(je(e,t.view(s.getOrElse((()=>[])))),(()=>t))}function Me(e){const t=e.assistant.state.view("session").view(q.z.toStarted).pipe(f.U(s.map((e=>s.isSome(e.error)?"error":"started"==e.kind&&s.isSome(e.inProgressResult)?"inProgressResult":"actions"))));return l.Z.composeOption(function(e,t){return l.Z.composeUnion({inProgressResult:Be(e),actions:l.Z.composeKnot({actions:pe(e)}),error:G(e)},(()=>t.pipe(v.oA,f.U((e=>({kind:e}))))))}(e,t),(()=>t))}function De(e){const t=e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.map((e=>e.results)),s.chain(K.c2)));return l.Z.composeKnot({root:()=>e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.chain((e=>e.inProgressResult)),s.map((e=>e.text)))).pipe(v.oA,x.O(""),f.U((e=>({scrollToken:e})))),intent:L(e.assistant),results:Ge(e,t),userSurvey:Fe(e,t.view(s.map((0,o.ls)(K.YM,(e=>e.id))))),belowResults:Me(e)})}function Ve(e){const t=e.skill.state.view(s.map((e=>({displayName:e.skill.displayName,status:e.status,srcUrl:e.skill.srcUrl,size:e.size}))));return l.Z.composeOption(function(e,t){return l.Z.fromSideEffect((t=>e.notify(t)),t)}(e,t.pipe(v.oA)),(()=>t))}function He(e,t){return l.Z.composeUnion({error:G(e),initial:se(e),results:De(e),actionFollowup:F(e),skill:Ve(e)},(()=>t.pipe(v.oA,f.U((e=>({kind:e}))))))}function Le(e,t,i,n){const r=a.h.combine(e.assistant.state,e.routing.activeView,(({genAIAvailability:e,session:t},i)=>{switch(i){case"loading":return s.some("initial");case"loadingError":return s.some("error");case"beforeResults":return s.isSome(t.error)?s.some("error"):N._.isUnavailable(e)?s.none:s.some("initial");case"actionSelected":return s.some("actionFollowup");case"afterResults":return s.some("results");case"voiceProfile":case"legacyVoiceProfile":case"feedbackForm":return s.none;case"skill":return s.some("skill");default:return(0,C.L0)(i)}}));return l.Z.composeOption(function(e,t,i,n,r){return l.Z.composeKnot({root:l.Z.fromSideEffect((t=>{switch(t.kind){case"contentScroll":return e.assistant.contentOverflowUnderToolbar(t.scrollTop>0);case"contentSizeChange":return i.set(s.some(t.height+8));default:(0,C.L0)(t)}}),a.h.combine(n,r,e.assistant.state.view("canScroll"),((e,t,i)=>({assistantMaxHeight:e,promptHeight:t,canScroll:i})))),content:He(e,t)})}(e,r,t,i,n),(()=>r))}function Ke(e){const t=e.assistant.state.view("detectedReferences");return l.Z.composeOption(function(e){return()=>e.assistant.state.view("detectedReferences").pipe(f.U(s.getOrElse((0,o.a9)([]))),f.U((e=>({detectedReferences:e}))))}(e),(()=>t))}var $e=i(19751),We=i(598);const Ze=new(i(45930).X)(999999);var qe;function Ye(e){const t=e.promptMenu.state.pipe(R.R(((e,t)=>(0,o.zG)(t,s.fold((()=>e),(()=>e+1)))),0));return l.Z.fromSideEffect((t=>e.notify(t)),g.aj([e.assistant.state,t,e.routing.activeView]).pipe(f.U((([e,t,i])=>{return{kind:(0,o.zG)(q.z.toStarted(e.session),s.fold((()=>"loading"),(e=>(0,o.zG)(e.inProgressResult,s.fold((()=>"ready"),(()=>"waitingForResult")))))),genAIAvailability:e.genAIAvailability,placeholder:(n=e,(0,o.zG)(n.selectedAction,s.chain((e=>""!==e.args[0].label.trim()?s.some([e.args[0].label]):s.none)),s.alt((()=>(0,o.zG)(n.userPromptAction,s.map((e=>[e.arg.label]))))))),hasHeader:!1,text:e.textBox,autofocusToken:qe.create(`${i}_${(0,o.zG)(q.z.toStarted(e.session),s.chain((e=>e.inProgressResult)),s.fold((()=>"done"),(()=>"inProgress")))}_${(0,o.zG)(e.selectedAction,s.fold((()=>"no-selected-action"),(()=>"selected-action")))}_${e.promptAutofocusToken}_promptMenuOpen:${t}`)};var n})),I.x()))}!function(e){e.create=function(e){return null!=e?e:Ze.newId()}}(qe||(qe={}));var Xe,Qe=i(60135),Je=i(23441);function et(e){return(0,o.zG)(e,Z.pO((e=>{const{init:t,rest:i}=Z.zT((t=>z.aU.Group.Id.eq.equals(t.group.id,e[0].group.id)))(e);return[t,i]})),Z.UI((e=>W.Y(s.Applicative)({label:(0,o.zG)(e,Z.YM,s.map((e=>e.group.label))),view:s.some(z.aU.Store.View.normal),actions:(0,o.zG)(e,Z.UI($.Dj.BackendAction.make),K.c2),withContext:s.some(!1)}))),Z.oA,K.c2,s.getOrElse((()=>[{label:e[0].group.label,view:z.aU.Store.View.normal,actions:[$.Dj.BackendAction.make(e[0])],withContext:!1}])))}function tt(e,t){const i=t.pipe(f.U((0,o.ls)(s.map(K.DY(z.aU.ListableActionInput.ordByGroup)),s.map(et))));return l.Z.composeOption(J(e,i.pipe(v.oA)),(()=>i))}function it(e,t){return l.Z.composeKnot({searchResults:Q(e,t.pipe(f.U(s.map(K.UI($.Dj.BackendAction.make)))),"standard"),customPromptGo:X(e,M.of({kind:"go"}),"standard")})}function nt(e,t){return l.Z.composeOption(l.Z.composeKnot({root:l.Z.fromSideEffect((t=>e.notify(t)),g.aj([t.pipe(v.oA),e.assistant.state.view("textBox")]).pipe((0,o.ls)(S.h((([e,t])=>!Je.t.isSearchResults(e)||t.trim().length>0)),f.U(Qe.li)))),content:l.Z.composeUnion({searchResults:it(e,t.pipe(f.U((0,o.ls)(s.filter(Je.t.isSearchResults),s.chain((e=>K.hX(e.filterPredicate)(e.actions))))))),actionsStore:tt(e,t.pipe(f.U((0,o.ls)(s.filter(Je.t.isActionsStore),s.chain((e=>K.hX(e.filterPredicate)(e.actions)))))))},(()=>t.pipe(v.oA)))}),(()=>t))}function rt(e,t,i){const n=g.aj([e.routing.activeView,e.assistant.state.view("selectedAction")]).pipe(f.U((([e,t])=>"loadingError"===e||"skill"===e||(0,o.zG)(t,s.filter((e=>"followUpQuestion"===e.kind&&z.Xy.match({radio:()=>!0,string:()=>!1})(e.args[0]))),s.isSome)?s.none:s.some(!0))));return l.Z.composeOption(function(e,t,i){const n=g.aj([e.promptMenu.state,t]).pipe(f.U((([e,t])=>(0,o.zG)(W.Y(s.Applicative)({maxHeight:t,menu:e}),s.map((({menu:e,maxHeight:t})=>Object.assign(Object.assign({},e),{maxHeight:t})))))),$e.shareReplay({bufferSize:1,refCount:!0}));return l.Z.composeKnot({root:l.Z.fromSideEffect((t=>{switch(t.kind){case"promptHeightChange":return i.set(t.height);case _.i.Kind.promptFieldAndMenuFocusChange:return e.notify(t);default:(0,C.L0)(t)}}),n.pipe(f.U((e=>({menuExpanded:s.isSome(e)}))))),promptField:Ye(e),promptHeader:()=>M.of(null),promptMenu:nt(e,n)})}(e,n.pipe(v.oA,We.c(t)),i),(()=>n))}function st(e,t=Xe.empty){const i=a.h.create(s.none),n=a.h.create(s.none);return l.Z.composeKnot({content:Le(e,i,t.assistantMaxHeight,n),detectedReferences:Ke(e),prompt:rt(e,i,n)})}!function(e){e.empty={assistantMaxHeight:a.h.create(s.none)}}(Xe||(Xe={}));var ot,at,lt,ct=i(83959);function ut(e,t=ot.empty){return l.Z.fromSideEffect((t=>e.notify(t)),e.feedbackForm.stagingFeedbackFormData.view((e=>{var i;return{formData:e,domain:t.showDomainCheckbox,source:null!==(i=null==e?void 0:e.source)&&void 0!==i?i:ct.x.Source.resultCard}})))}function dt(e){return l.Z.composeKnot({root:()=>e.assistant.state.view((({contentOverflowUnderToolbar:e})=>({contentOverflowUnderToolbar:e}))),content:(t=e.notifications,l.Z.composeList(Z.Ot,(()=>t.state.view(Z.GY)),(e=>function(e,t){return l.Z.fromSideEffect((e=>{if("dismissNotification"===e.kind)return t.dismiss(e.id);(0,C.L0)(e.kind)}),e)}(e,t))))});var t}function mt(e){const t=a.h.create("");return l.Z.fromSideEffect((i=>{"updateRoleTypeaheadText"===i.kind?(t.set(i.text),""===i.text&&e.notify({kind:_.i.Kind.roleTypeaheadSelectionChange,role:s.none})):(i.kind===_.i.Kind.roleTypeaheadSelectionChange&&t.set((0,o.zG)(i.role,s.fold((()=>""),(e=>e.label)))),e.notify(i))}),a.h.combine(e.assistant.state.view("session"),e.voiceProfile.state.view("stagingVoiceProfile"),t,((e,t,i)=>(0,o.zG)(W.Y(s.Applicative)({voiceProfile:(0,o.zG)(q.z.toStarted(e),s.map((e=>e.voiceProfile)),s.chain(Ie.L.toLegacyVoiceProfile)),stagingVoiceProfile:t}),s.fold((()=>({tones:[],styles:[],roles:[],maxSelectableTones:0,applyButtonEnabled:!1,description:"",roleTypeaheadText:"",dialects:Ie.L.Dialect.all(),selectedDialect:Ie.L.Dialect.american})),(({stagingVoiceProfile:e,voiceProfile:t})=>(0,o.zG)(t.styles,Z.Ew((t=>t.id===e.selectedStyle)),(n=>({styles:(0,o.zG)(t.styles,Z.UI((t=>Object.assign(Object.assign({},t),{kind:t.id===e.selectedStyle?"selected":"unselected"})))),tones:(0,o.zG)(n,s.fold((()=>[]),(t=>(0,o.zG)(t.tones,Z.UI((i=>Object.assign(Object.assign({},i),{kind:(0,o.zG)(s.fromNullable(e.selectedTonesPerStyle.get(e.selectedStyle)),s.getOrElse((()=>new Set)),(e=>e.has(i.id)?"selected":e.size>=t.maxTones?"disabled":"unselected"))}))))))),roles:t.roles,maxSelectableTones:(0,o.zG)(n,s.fold((()=>3),(e=>e.maxTones))),applyButtonEnabled:!Ie.L.Selections.eq.equals(e,t),description:"These voice settings will apply to any text you generate.",roleTypeaheadText:(0,o.zG)(e.selectedRole,s.filter((()=>""===i)),s.chain((e=>s.fromNullable(t.roles.find((t=>t.id===e))))),s.fold((()=>i),(e=>e.label))),dialects:t.dialects,selectedDialect:t.dialects.find((t=>Ie.L.Dialect.Id.eq.equals(t.id,e.selectedDialect)))||Ie.L.Dialect.american})))))))))}function pt(e){return l.Z.fromSideEffect((t=>e.notify(t)),a.h.combine(e.assistant.state.view("session"),e.voiceProfile.state.view("stagingNewVoiceProfile"),((e,t)=>(0,o.zG)(W.Y(s.Applicative)({sessionVoiceProfile:(0,o.zG)(q.z.toStarted(e),s.map((e=>e.voiceProfile)),s.chain(Ie.L.toNewVoiceProfile)),stagingVoiceProfile:t}),s.fold((()=>({userName:"",title:"",subTitle:"",roles:[],dialects:Ie.L.Dialect.all(),selectedDialect:Ie.L.Dialect.american,isEnabledByDefault:!0,isEnabledByDefaultLabel:"",profiles:[],activeProfileName:s.none,activeTagId:s.none,isEditing:!1,selectedRole:s.none})),(({sessionVoiceProfile:e,stagingVoiceProfile:t})=>({userName:e.userName,title:e.title,subTitle:e.subTitle,isEnabledByDefault:t.isEnabledByDefault,isEnabledByDefaultLabel:e.isEnabledByDefaultLabel,profiles:t.profiles,roles:(0,o.zG)(ht(t,e),s.fold((()=>e.roles),(t=>e.roles.filter((e=>e.id!==t.id))))),dialects:(0,o.zG)(gt(t,e),(t=>e.dialects.filter((e=>e.id!==t.id)))),selectedRole:ht(t,e),selectedDialect:gt(t,e),activeProfileName:t.activeProfileName,activeTagId:t.activeTagId,isEditing:s.isSome(t.stagingSelections)})))))))}function ht(e,t){return(0,o.zG)(e.stagingSelections,s.chain((e=>e.selectedRole)),s.alt((()=>e.selectedRole)),s.chain((e=>s.fromNullable(t.roles.find((t=>Ie.L.Role.Id.eq.equals(t.id,e)))))))}function gt(e,t){return(0,o.zG)(e.stagingSelections,s.fold((()=>e.selectedDialect),(e=>e.selectedDialect)),(e=>t.dialects.find((t=>Ie.L.Dialect.Id.eq.equals(t.id,e)))||Ie.L.Dialect.american))}function ft(e,t=at.empty){return l.Z.composeKnot({content:vt(e,t),notifications:dt(e)})}function vt(e,t=at.empty){return l.Z.composeUnion({chat:st(e,t.chatFlowOptions),legacyVoiceProfile:mt(e),newVoiceProfile:pt(e),feedbackForm:ut(e,t.feedbackFormFlowOptions)},(()=>e.routing.activeView.view((e=>({kind:"voiceProfile"===e?"newVoiceProfile":"legacyVoiceProfile"===e?"legacyVoiceProfile":"feedbackForm"===e?e:"chat"})))))}function yt(e){const t=e.assistant.state.view((e=>(0,o.zG)(e.genAIAvailability,s.fromPredicate(N._.isActiveOrPassive),s.filter((()=>s.isSome(q.z.toStarted(e.session)))))));return l.Z.composeOption(function(e,t,i){return l.Z.fromSideEffect((t=>e.notify(t)),(0,o.zG)(g.aj([t,i]),f.U((([e,t])=>({user:e,genAIAvailability:t})))))}(e,e.assistant.state.view("user"),t.pipe(v.oA)),(()=>a.h.combine(t,e.routing.activeView,((e,t)=>(0,o.zG)(e,s.filter((()=>"voiceProfile"!==t&&"feedbackForm"!==t&&"skill"!==t)))))))}function bt(e){return l.Z.fromSideEffect((t=>e.notify(t.action.action)),a.h.combine(e.assistant.state.view("session"),e.routing.activeView,((e,t)=>"started"!==e.kind||"loading"!==t&&"beforeResults"!==t||e.historyStatus!==q.z.HistoryStatus.hasHistory&&e.historyStatus!==q.z.HistoryStatus.historyRequested?s.none:s.some({disabled:e.historyStatus===q.z.HistoryStatus.historyRequested}))))}function xt(e){return l.Z.composeKnot({left:St(e),right:l.Z.composeKnot({historyButton:bt(e),credits:yt(e)})})}function St(e){const t=a.h.combine(e.assistant.state,e.routing.activeView,(({session:e},t)=>(0,o.zG)(q.z.toStarted(e),s.fold((()=>"logoOnly"),(()=>"loadingError"===t?"logoOnly":"loading"===t||"beforeResults"===t||"afterResults"===t?"logoAndVoiceButton":"voiceProfile"===t||"feedbackForm"===t||"legacyVoiceProfile"===t||"skill"===t?"backButton":"actionSelected"===t?"backButtonAndVoiceButton":(0,C.L0)(t))))));return l.Z.composeUnion({logoOnly:()=>M.of(null),logoAndVoiceButton:_t(e),backButton:kt(e),backButtonAndVoiceButton:Ct(e)},(()=>t.pipe(x.O("logoOnly"),f.U((e=>({kind:e}))))))}function kt(e){return l.Z.fromSideEffect((t=>e.notify(t)),a.h.combine(e.routing.activeView,e.skill.state,((e,t)=>"voiceProfile"===e||"legacyVoiceProfile"===e?{activeViewIconUrl:s.none,activeViewLabel:s.some("Style")}:"feedbackForm"===e?{activeViewIconUrl:s.none,activeViewLabel:s.some("Share your thoughts")}:"skill"===e?(0,o.zG)(t,s.fold((()=>({activeViewIconUrl:s.none,activeViewLabel:s.none})),(e=>({activeViewIconUrl:s.some(e.skill.iconUrl),activeViewLabel:s.some(e.skill.displayName)})))):{activeViewIconUrl:s.none,activeViewLabel:s.none})))}function wt(e){return(0,o.zG)(e,s.fold((()=>""),(e=>(0,o.zG)(Ie.L.toLegacyVoiceProfile(e),s.fold((()=>"Style"),(e=>(0,o.zG)(s.fromNullable(e.styles.find((t=>Ie.L.Style.Id.eq.equals(t.id,e.selectedStyle)))),s.fold((()=>""),(e=>e.label)))))))))}function Ct(e){return l.Z.fromSideEffect((t=>e.notify(t.action)),e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.map((e=>e.voiceProfile)))).pipe(f.U((e=>({back:{activeViewIconUrl:s.none,activeViewLabel:s.none},voice:{styleLabel:wt(e)}})))))}function _t(e){return l.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.view("session").view((0,o.ls)(q.z.toStarted,s.map((e=>e.voiceProfile)))).pipe(f.U((e=>({kind:"logoAndVoiceButton",styleLabel:wt(e)})))))}function It(e,t=lt.empty){return l.Z.composeKnot({assistant:l.Z.composeKnot({root:P(e),content:ft(e,Object.assign(Object.assign({},t.contentFlowOptions),{chatFlowOptions:{assistantMaxHeight:a.h.combine(t.contentFlowOptions.chatFlowOptions.assistantMaxHeight,e.position.state,((e,t)=>(0,o.zG)(e,s.alt((()=>(0,o.zG)(t,c.G,s.chain((e=>e.assistantMaxHeight))))))))}})),toolbar:xt(e)})})}!function(e){e.empty={showDomainCheckbox:s.none}}(ot||(ot={})),function(e){e.empty={chatFlowOptions:Xe.empty,feedbackFormFlowOptions:ot.empty}}(at||(at={})),function(e){e.empty={contentFlowOptions:at.empty}}(lt||(lt={}))},79001:(e,t,i)=>{i.d(t,{z:()=>n});var n,r=i(27378),s=i(64757),o=i(12187),a=i(44361),l=i(14746),c=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){e.Primary=e=>{var{className:t,compact:i,theme:n,children:u,onClick:d,size:m,style:p}=e,h=c(e,["className","compact","theme","children","onClick","size","style"]);return r.createElement(s.zx.Primary,Object.assign({},(0,o.Sh)((0,l.P)({compact:i,theme:null!=n?n:"light",size:null!=m?m:"large",type:"primary",style:p}),t),h,{onClick:(0,a.m)(d)}),u)},e.Secondary=e=>{var{className:t,compact:i,theme:n,children:u,onClick:d,size:m,style:p}=e,h=c(e,["className","compact","theme","children","onClick","size","style"]);return r.createElement(s.zx.Ghost,Object.assign({},(0,o.Sh)((0,l.P)({compact:i,theme:null!=n?n:"light",size:null!=m?m:"large",type:"secondary",style:p}),t),h,{onClick:(0,a.m)(d)}),u)},e.Tertiary=e=>{var{className:t,compact:i,theme:n,children:u,onClick:d,size:m,style:p}=e,h=c(e,["className","compact","theme","children","onClick","size","style"]);return r.createElement(s.zx.Tertiary,Object.assign({},(0,o.Sh)((0,l.P)({compact:i,theme:null!=n?n:"light",size:null!=m?m:"large",type:"tertiary",style:p}),t),h,{onClick:(0,a.m)(d)}),u)}}(n||(n={}))},14746:(e,t,i)=>{i.d(t,{P:()=>p});var n=i(13578),r=i(62172),s=i(88392),o=i(9546),a=i(89894),l=i(94689),c=i(17430);const u="button",d=e=>({minWidth:a.ux.rem(e),minHeight:a.ux.rem(e),lineHeight:a.ux.rem(e)}),m=e=>{var t,i,m;const p=(t,i)=>{var n;return Object.assign({"& > i":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e.compact?{marginLeft:0}:{marginLeft:a.ux.rem(-.25)}),"small"===e.size?{minWidth:a.ux.rem(1.5)}:{}),"medium"===e.size?{minWidth:a.ux.rem(1.75)}:{}),"large"===e.size?{minWidth:a.ux.rem(2)}:{}),t),"&[data-disabled='true']":Object.assign({opacity:.4,cursor:"not-allowed"},null===(n=e.style)||void 0===n?void 0:n.disabled)},i)};return(0,l.to)(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({borderRadius:a.ux.rem(s.xB),fontSize:null!==(m=null===(i=null===(t=e.style)||void 0===t?void 0:t.base)||void 0===i?void 0:i.fontSize)&&void 0!==m?m:a.ux.rem(.75),textAlign:"center",padding:`0 ${a.ux.rem(o.x)}`,userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center"},e.compact?{padding:0}:{}),"small"===e.size?d(1.5):{}),"medium"===e.size?d(1.75):{}),"large"===e.size?d(2):{}),"primary"===e.type?((e,t)=>Object.assign(Object.assign({color:n.XY.Content.OnPrimary.Default,backgroundColor:c.Z.BrandGreen60,transitionProperty:"border, background, color",fontWeight:"bold"},null==t?void 0:t.base),{$nest:e((null==t?void 0:t.icon)||{},{"&:not([data-disabled='true'])":{$nest:{"&[data-hovered='true']":Object.assign({backgroundColor:c.Z.BrandGreen80},null==t?void 0:t.hovered),"&:focus-visible":Object.assign({boxShadow:`0 0 0 2px ${n.XY.Surface.Primary.Default}, 0 0 0 4px ${c.Z.BrandGreen80}`},null==t?void 0:t.focusVisible),"&[data-active='true'], &:active":Object.assign({backgroundColor:c.Z.BrandGreen60,color:n.XY.Surface.Primary.Default},null==t?void 0:t.active)}}})}))(p,e.style):{}),"secondary"===e.type?((e,t)=>Object.assign(Object.assign({backgroundColor:"transparent",fontWeight:"normal",color:r.BlueGray80,stroke:r.BlueGray80,boxShadow:`inset 0 0 0 1px ${r.BlueGray5}`,transitionProperty:"border, background, color"},null==t?void 0:t.base),{$nest:e(Object.assign({stroke:a.ux.important(r.BlueGray80),fill:a.ux.important(r.BlueGray80)},null==t?void 0:t.icon),{"&:not([data-disabled='true'])":{$nest:{"&[data-hovered='true']":Object.assign({backgroundColor:r.BlueGray0},null==t?void 0:t.hovered),"&:focus-visible":Object.assign({boxShadow:`inset 0 0 0 1px ${r.BlueGray80}, 0 0 0 1px ${r.BlueGray80}, 0 0 0 2px ${n.XY.Surface.Primary.Default}, 0 0 0 4px ${r.BlueGray80}`},null==t?void 0:t.focusVisible),"&[data-active='true'], &:active":Object.assign({backgroundColor:"transparent",color:r.BlueGray80},null==t?void 0:t.active)}}})}))(p,e.style):{}),"tertiary"===e.type?((e,t,i)=>Object.assign(Object.assign({backgroundColor:"transparent",fontWeight:"normal",color:n.XY.Content.Secondary.Default,transitionProperty:"border, background, color"},null==i?void 0:i.base),{$nest:t(Object.assign({stroke:a.ux.important(n.XY.Content.Secondary.Default),fill:a.ux.important(n.XY.Content.Secondary.Default)},null==i?void 0:i.icon),{"&:not([data-disabled='true'])":{$nest:Object.assign(Object.assign({"&[data-hovered='true'], &[data-active='true'], &:active":Object.assign({backgroundColor:r.BlueGray0,color:n.XY.Content.Secondary.Default},null==i?void 0:i.active)},"dark"===e.theme?{"&[data-hovered='true'], &[data-active='true'], &:active":Object.assign({backgroundColor:a.ux.color(r.BlueGray0).toRGBA().fade(.2).toString()},null==i?void 0:i.active)}:{}),{"&:focus-visible":Object.assign({boxShadow:`0 0 0 2px ${n.XY.Surface.Primary.Default}, 0 0 0 4px ${n.XY.Content.Secondary.Default}`},null==i?void 0:i.focusVisible)})}})}))(e,p,e.style):{}),u,l._7)},p=e=>a.ux.joinClasses([u,a.ux.style(m(e))])},44443:(e,t,i)=>{i.d(t,{x:()=>h});var n=i(27378),r=i(31278),s=i(12187),o=i(79001),a=i(13578),l=i(89894),c=i(94689);const u="closeBtn",d="closeIcon",m=(0,c.dD)({$nest:{[`& .${d}`]:Object.assign(Object.assign({},(0,c.fx)(1.5)),{stroke:l.ux.important(a.S5.Content.Primary.Default)})}},u),p={closeButton:l.ux.joinClasses([u,l.ux.style(m)]),closeIcon:d},h=({name:e,className:t,size:i,onClick:a})=>n.createElement(o.z.Tertiary,Object.assign({},(0,s.Sh)(p.closeButton,t),{onClick:a,compact:!0,size:i,theme:"dark",name:e}),n.createElement(r.JO.Close,{className:p.closeIcon}))},84:(e,t,i)=>{i.d(t,{d:()=>o});var n=i(27378),r=i(18208),s=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const o=n.forwardRef((function(e,t){var{children:i,rel:o}=e,a=s(e,["children","rel"]);const l=n.useMemo((()=>r.fg(10)),[]);return n.createElement(n.Fragment,null,n.createElement("span",{hidden:!0,id:l},"Opens an external site in a new window"),n.createElement("a",Object.assign({},a,{"aria-describedby":l,target:"_blank",rel:null!=o?o:"noopener noreferrer",ref:t}),i))}))},39505:(e,t,i)=>{i.d(t,{H:()=>u});var n=i(27378),r=i(89894),s=i(31278),o=i(12187),a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const l=r.ux.keyframes({from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}),c=r.ux.style({animation:`${l} 1s linear infinite`,width:r.ux.rem(1),height:r.ux.rem(1),minWidth:r.ux.rem(1),minHeight:r.ux.rem(1)}),u=e=>{const{className:t}=e,i=a(e,["className"]);return n.createElement(s.a1,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},(0,o.Sh)(c,t),i),n.createElement("circle",{cx:"8",cy:"8",r:"5",stroke:"#C2C6D4",strokeWidth:"2"}),n.createElement("path",{d:"M13 8C13 8.76694 12.8236 9.5236 12.4844 10.2114C12.1452 10.8993 11.6523 11.4999 11.0438 11.9668C10.4354 12.4336 9.72765 12.7543 8.97545 12.9039C8.22325 13.0535 7.44671 13.0281 6.7059 12.8296",stroke:"#05735A",strokeWidth:"2",strokeLinecap:"round"}))}},6356:(e,t,i)=>{i.d(t,{J:()=>c});var n=i(27378),r=i(74204),s=i(13578),o=i(9546),a=i(89894),l=i(74357);const c=({reference:e,children:t,placement:i,offset:s,theme:o,boundaryAreaPadding:a})=>{var c,u;const[p,h]=n.useState(null),[g,f]=n.useState(null),v=(0,l.s)(),{styles:y,attributes:b,state:x}=(0,r.D)(e,p,{placement:null!=i?i:"top",modifiers:[{name:"offset",options:{offset:[0,12+(null!=s?s:0)]}},{name:"arrow",options:{element:g,padding:12}},{name:"preventOverflow",options:{padding:null!=a?a:5}},v]});return e?n.createElement("div",Object.assign({ref:h,style:y.popper},b.popper,{className:d(o)}),n.createElement("div",{ref:f,style:y.arrow,className:m(null==o?void 0:o.bgColor),"data-placement":(null===(c=null==x?void 0:x.placement)||void 0===c?void 0:c.startsWith("bottom"))?"bottom":(null==x?void 0:x.placement.startsWith("top"))?"top":(null==x?void 0:x.placement.startsWith("right"))?"right":(null===(u=null==x?void 0:x.placement)||void 0===u?void 0:u.startsWith("left"))?"left":void 0}),t):null},u=a.ux.keyframes({from:{opacity:0},to:{opacity:1}});function d(e){var t,i,n;return a.ux.style({animation:`${u} linear 0.1s`,background:null!==(t=null==e?void 0:e.bgColor)&&void 0!==t?t:s.S5.Surface.Primary.Default,borderRadius:a.ux.rem(o.x),width:null==e?void 0:e.width,color:null!==(i=null==e?void 0:e.fgColor)&&void 0!==i?i:s.S5.Content.Primary.Default,padding:null!==(n=null==e?void 0:e.padding)&&void 0!==n?n:a.ux.rem(o.mh),fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),display:"flex",flexDirection:"column",gap:a.ux.rem(o.yC),$nest:{"&[data-popper-reference-hidden='true']":{visibility:"hidden"}}})}function m(e=s.S5.Surface.Primary.Default,t=a.ux.rem(.5),i=a.ux.rem(-.5)){return a.ux.style({$nest:{"&[data-placement='bottom']":{top:i,borderLeft:`${t} solid transparent`,borderRight:`${t} solid transparent`,borderBottom:`${t} solid ${e}`},"&[data-placement='top']":{bottom:i,borderLeft:`${t} solid transparent`,borderRight:`${t} solid transparent`,borderTop:`${t} solid ${e}`},"&[data-placement='right']":{left:i,borderTop:`${t} solid transparent`,borderBottom:`${t} solid transparent`,borderRight:`${t} solid ${e}`},"&[data-placement='left']":{right:i,borderTop:`${t} solid transparent`,borderBottom:`${t} solid transparent`,borderLeft:`${t} solid ${e}`}}})}},96465:(e,t,i)=>{i.d(t,{n:()=>r});var n=i(27378);function r(){return n.useMemo((()=>({name:"forcePopperUpdateEffect",phase:"afterMain",enabled:!0,fn:()=>{},effect:({instance:e})=>{const t=setTimeout((()=>e.forceUpdate()),0);return()=>clearTimeout(t)}})),[])}},74357:(e,t,i)=>{i.d(t,{s:()=>n});const n=i(96465).n},48258:(e,t,i)=>{i.d(t,{F:()=>l});var n=i(27378),r=i(90845),s=i(80544),o=i(79692),a=i(60797);function l(e){const{ref:t,onMount:i}=r.P.useElWatcher(),l=n.useMemo((()=>t.pipe(s.QV(o.E),a.oA,e)),[t]);return r.P.useSubscriptionTo(l),{ref:t,onMount:i}}},69438:(e,t,i)=>{i.d(t,{T:()=>Se});var n=i(34217),r=i(27378),s=i(13578),o=i(2834),a=i(21189),l=i(8122),c=i(79001),u=i(84),d=i(31278),m=i(12187),p=i(89894),h=i(94689);const g="closeBtn",f="closeIcon",v=(0,h.dD)({$nest:{[`& .${f}`]:Object.assign(Object.assign({},(0,h.fx)(1.5)),{stroke:p.ux.important(s.vU.InteractiveNeutral.Primary.Default)})}},g),y=p.ux.joinClasses([g,p.ux.style(v)]),b=({name:e,className:t,size:i,onClick:n})=>r.createElement(c.z.Tertiary,Object.assign({},(0,m.Sh)(y,t),{onClick:n,compact:!0,size:i,theme:"light",name:e}),r.createElement(d.JO.Close,{className:f}));var x=i(48258),S=i(88392),k=i(9546);const w=({className:e})=>r.createElement("span",Object.assign({},(0,m.Sh)(C,e)),"New"),C=p.ux.style({color:s.S5.Content.OnPrimary.Default,fontWeight:700,fontSize:p.ux.rem(.75),lineHeight:p.ux.rem(1),justifyContent:"center",alignItems:"center",background:"linear-gradient(226.37deg, #BBD86D 0%, #41D9B5 100%)",borderRadius:p.ux.rem(S.HP),padding:`${p.ux.rem(k.yC)} ${p.ux.rem(k.x)}`,textTransform:"uppercase",width:"fit-content",cursor:"default"});var _=i(74204),I=i(62172),E=i(74357);const A=r.forwardRef((function({placement:e,style:t,arrowColor:i},n){return r.createElement("div",{ref:n,style:{width:33}},r.createElement("svg",{width:33,height:12,viewBox:"0 0 33 12.5",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:Object.assign(Object.assign(Object.assign({position:"absolute"},t),{transform:`${(null==t?void 0:t.transform)||""} rotate(${O(e)}deg)`.trimStart()}),R(e))},r.createElement("path",{d:"M0.5 3.41877e-07C3.5 3.41877e-07 29.5 3.41877e-07 32.5 3.41877e-07C28.5 3.41877e-07 26.4111 0.903505 24.1814 3.69994L17.5562 11.4728C16.957 12.1757 15.8652 12.1757 15.2661 11.4728L8.64084 3.69994C6.41113 0.903505 4.5 3.41877e-07 0.5 3.41877e-07Z",fill:i||"white"})))}));function O(e){return(null==e?void 0:e.startsWith("right"))?90:(null==e?void 0:e.startsWith("bottom"))?180:(null==e?void 0:e.startsWith("left"))?270:0}function R(e){return(null==e?void 0:e.startsWith("bottom"))?{top:-12}:(null==e?void 0:e.startsWith("top"))?{bottom:-12}:(null==e?void 0:e.startsWith("right"))?{transformOrigin:"top left",top:-16.5,left:0}:(null==e?void 0:e.startsWith("left"))?{transformOrigin:"top right",top:-16.5,right:0}:{}}const T=(0,m.xb)((({reference:e,placement:t,offset:i,boundaryAreaPadding:n,className:s,arrowColor:o,children:a})=>{const[l,c]=r.useState(null),[u,d]=r.useState(null),p=(0,E.s)(),{styles:h,attributes:g,state:f}=(0,_.D)(e,l,{placement:t,modifiers:[{name:"offset",options:{offset:[0,12+(null!=i?i:0)]}},{name:"arrow",options:{element:u,padding:12}},{name:"preventOverflow",options:{padding:null!=n?n:5}},p]});return r.createElement("div",Object.assign({dir:"ltr",ref:c,style:h.popper},g.popper,(0,m.Sh)(U,s)),r.createElement(A,{ref:d,style:h.arrow,placement:null==f?void 0:f.placement,arrowColor:o}),a)})),P=e=>p.ux.color(I.BlueGray40).toRGBA().fade(e).toString(),U=p.ux.style({filter:`drop-shadow(0px 0px 0.5px ${I.BlueGray40}) drop-shadow(0px 0px 2px ${P(.5)}) drop-shadow(0px 1px 6px ${P(.25)})`,borderRadius:p.ux.rem(S.xB+S.fe)}),B="tryItOutBtn",N="skipBtn",z=p.ux.rem(S.xB+S.fe),F={width:p.ux.rem(25.875),background:s.XY.Surface.Primary.Default},j={display:"flex",flexDirection:"column",gap:p.ux.rem(k.F2),padding:`${p.ux.rem(k.mh)} ${p.ux.rem(k.x0)} ${p.ux.rem(k.sD)} ${p.ux.rem(k.sD)}`,color:s.XY.Content.Primary.Default},G={display:"flex",flexDirection:"row",alignItems:"center",gap:p.ux.rem(k.x),fontWeight:"bold",fontSize:p.ux.rem(1),lineHeight:p.ux.rem(1.5)},M={fontSize:p.ux.rem(.875),lineHeight:p.ux.rem(1.375)},D={display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderBottomLeftRadius:z,borderBottomRightRadius:z,padding:`${p.ux.rem(k.qp)} ${p.ux.rem(k.sD)} ${p.ux.rem(k.qp)} ${p.ux.rem(k.sD)}`,backgroundColor:s.XY.Surface.Secondary.Default,color:s.XY.Content.Secondary.Default,fontSize:p.ux.rem(.875),lineHeight:p.ux.rem(1.3125),$nest:{a:{color:"inherit"}}},V={width:p.ux.rem(12),lineHeight:p.ux.rem(1.25)},H=Object.assign({marginRight:p.ux.rem(.5)},(0,h.dD)({fontSize:p.ux.rem(.875)},N)),L=(0,h.dD)({fontSize:p.ux.rem(.875),fontWeight:"bold"},B),K={position:"absolute",top:p.ux.rem(k.x),right:p.ux.rem(k.x)},$=p.ux.style(F),W=p.ux.style(j),Z=p.ux.style(G),q=p.ux.style(M),Y=p.ux.style(D),X=p.ux.style(V),Q=p.ux.style({display:"flex",flexDirection:"row",alignItems:"flex-end"}),J=p.ux.joinClasses([N,p.ux.style(H)]),ee=p.ux.joinClasses([B,p.ux.style(L)]),te=p.ux.style({display:"inline"}),ie=p.ux.style(K),ne=(e=a.T.StepName.initial)=>n.UI.Grid.make((({slots:t,view:i,notify:n})=>{const{onMount:a}=(0,x.F)(o.b((t=>n({kind:l.l.Kind.mount,step:e,element:t})())));return r.createElement(T,{className:$,reference:i("reference"),placement:i("placement"),offset:i("offset"),boundaryAreaPadding:i("boundaryAreaPadding"),arrowColor:s.XY.Surface.Secondary.Default},r.createElement("div",{ref:a},t.content),r.createElement("div",{className:Y},r.createElement("div",{className:X},t.footerText),r.createElement("div",{className:Q},r.createElement(c.z.Tertiary,{onClick:n({kind:l.l.Kind.close,step:e}),className:J,name:"skip"},"Skip"),r.createElement(c.z.Primary,{onClick:n({kind:l.l.Kind.tryItOut,step:e}),className:ee,name:"tryItOut"},"Try it out"))))})),re=n.UI.Node.make((({notify:e})=>r.createElement(r.Fragment,null,r.createElement(b,{onClick:e({kind:l.l.Kind.close,step:a.T.StepName.initial}),name:"onboardingClose",size:"medium",className:ie}),r.createElement("div",{className:W},r.createElement(w,null),r.createElement("div",{className:Z},r.createElement("div",null,"Write faster with GrammarlyGO")),r.createElement("div",{className:q},"Brainstorm, write, and rewrite with generative AI assistance at your fingertips."))))),se=n.UI.Node.make((()=>r.createElement(r.Fragment,null,"If you use GrammarlyGO,"," ",r.createElement(u.d,{href:"https://grammarly.com/terms",className:te},"additional terms")," ","apply."))),oe=n.UI.Knot.make(ne(),{content:re,footerText:se}),ae=n.UI.Node.make((({notify:e})=>r.createElement(r.Fragment,null,r.createElement(b,{onClick:e({kind:l.l.Kind.close,step:a.T.StepName.initialBTS}),name:"onboardingClose",size:"medium",className:ie}),r.createElement("div",{className:W},r.createElement(w,null),r.createElement("div",{className:Z},r.createElement("div",null,"Write better papers faster (for free!)")),r.createElement("div",{className:q},"Start with a brainstorm, then get instant feedback, revisions, and citations to ace your assignment."))))),le=n.UI.Knot.make(ne(a.T.StepName.initialBTS),{content:ae,footerText:n.UI.Node.empty});var ce=i(57050),ue=i(41398),de=i(77176),me=i(44443),pe=i(6356);function he(e){switch(e){case a.T.StepName.knowledgeHub:return p.ux.rem(16);case a.T.StepName.references:return p.ux.rem(17.8);default:return p.ux.rem(13.75)}}const ge=(0,m.xb)((({reference:e,placement:t,offset:i,boundaryAreaPadding:n,children:o,name:a})=>r.createElement(pe.J,{reference:e,placement:t,offset:i,boundaryAreaPadding:n,theme:{bgColor:I.Green80,fgColor:s.S5.Content.Primary.Default,padding:p.ux.rem(k.mh),width:he(a)}},o))),fe={[a.T.StepName.prompts]:{title:"Start with a prompt",description:e=>e?`Choose a suggested prompt, or type your own to get started. You’ll get ${Number(e).toLocaleString()} each month.`:"Choose a suggested prompt, or type your own to get started."},[a.T.StepName.review]:{title:"How does this sound?",description:"Adjust it to your liking with additional prompts. Don’t forget to check for any inaccuracies. "},[a.T.StepName.rewrite]:{title:"Want help rewriting?",description:"Select your text to rewrite it with GrammarlyGO."},[a.T.StepName.knowledgeHub]:{title:"Using organizational language?",description:"Prompt GrammarlyGO using terms and project names from Knowledge Share to automatically insert organizational context."},[a.T.StepName.references]:{title:"GrammarlyGO now incorporates your organizational knowledge",description:"Review the references for accuracy and relevance and regenerate the response without any references that seem irrelevant or outdated."},[a.T.StepName.history]:{title:"Return to recent history",description:"Pick up where you left off with your latest prompts."}},ve=n.UI.Node.make((({state:e,view:t,notify:i})=>{const{onMount:n}=(0,x.F)((0,ce.ls)(ue.M(t("name")),de.U((([e,t])=>({element:e,stepName:t}))),o.b((({element:e,stepName:t})=>i({kind:l.l.Kind.mount,step:t,element:e})()))));return r.createElement(ge,{name:t("name"),reference:t("reference"),placement:t("placement"),offset:t("offset"),boundaryAreaPadding:t("boundaryAreaPadding")},e.pipe(de.U((e=>r.createElement(r.Fragment,null,r.createElement(me.x,{onClick:i({kind:l.l.Kind.close,step:e.name}),name:"tooltipClose",className:xe,size:"small"}),r.createElement("div",{className:be},fe[e.name].title),r.createElement("div",{ref:n},e.name===a.T.StepName.prompts?fe[e.name].description(e.promptsAllocated):fe[e.name].description))))))})),ye=n.UI.Union.asOption(ve),be=p.ux.style({fontWeight:700}),xe=p.ux.style({position:"absolute",top:p.ux.rem(k.x),right:p.ux.rem(k.x)}),Se=n.UI.Union.make("kind",{none:n.UI.Node.empty,initial:oe,initialBTS:le,tooltip:ye})},72715:(e,t,i)=>{i.d(t,{A:()=>y});var n=i(5114),r=i(57050),s=i(76974),o=i(22232),a=i(34217),l=i(21189),c=i(60797);const u=e=>a.Z.fromSideEffect((t=>e.notify(t)),e.activeStep.pipe(c.oA)),d=e=>{const t=u(e);return a.Z.composeKnot({root:t,content:t,footerText:t})},m=e=>{const t=u(e);return a.Z.composeKnot({root:t,content:t,footerText:t})};var p=i(77176),h=i(85985),g=i(41398),f=i(96327);function v(e){return a.Z.composeOption(function(e){return a.Z.fromSideEffect((t=>e.notify(t)),e.activeStep.pipe(c.oA,h.h(f.X.isTooltipOnboardingStep),g.M(e.promptsAllocated.pipe(p.U(n.toUndefined))),p.U((([e,t])=>Object.assign(Object.assign({},e),{promptsAllocated:t})))))}(e),(()=>e.activeStep.pipe(p.U(n.filter(f.X.isTooltipOnboardingStep)))))}function y(e){return a.Z.composeUnion({none:()=>s.of(null),initial:d(e),initialBTS:m(e),tooltip:v(e)},(()=>e.activeStep.view(b).view((e=>({kind:e})))))}function b(e){return(0,r.zG)(e,n.filter((e=>e.show)),n.fold((()=>"none"),(e=>{switch(e.name){case l.T.StepName.initial:return"initial";case l.T.StepName.initialBTS:return"initialBTS";case l.T.StepName.prompts:case l.T.StepName.review:case l.T.StepName.rewrite:case l.T.StepName.knowledgeHub:case l.T.StepName.references:case l.T.StepName.history:return"tooltip";default:return(0,o.L0)(e.name)}})))}},94689:(e,t,i)=>{i.d(t,{Ki:()=>l,_7:()=>a,dD:()=>c,fx:()=>r,s4:()=>s,to:()=>o});var n=i(89894);function r(e,t){return Object.assign(Object.assign({},function(e){return{width:n.ux.rem(e),minWidth:n.ux.rem(e)}}(e)),function(e){return{height:n.ux.rem(e),minHeight:n.ux.rem(e)}}(null!=t?t:e))}function s(e,t){return`.${e}`.repeat(t)}function o(e,t,i){return{$nest:{[`&${s(t,i)}`]:e}}}const a=6,l=a+1;function c(e,t){return o(e,t,l)}},65602:(e,t,i)=>{i.d(t,{DO:()=>c,l:()=>u});var n=i(5114),r=i(57050),s=i(69243),o=i(8709),a=i(36991);const l=s.OT(s.dt({ops:s.Bk(s.G0([s.dt({insert:s.OT(s.Z_)}),s.dt({retain:s.OT(s.pk)}),s.dt({delete:s.OT(s.pk)})]))}));function c(e){return(0,r.zG)(e,n.fromPredicate(l.is),n.map((e=>new o.i([...e.ops]))))}function u(e,t){return e.reduce(((e,t)=>(a.s.isInsertString(t)?(e.text=`${e.text.substring(0,e.index)}${t.insert}${e.text.substring(e.index)}`,e.index+=t.insert.length):a.s.isDelete(t)?e.text=`${e.text.substring(0,e.index)}${e.text.substring(e.index+t.delete)}`:a.s.isRetain(t)?e.index+=t.retain:function(e){var t;return a.s.isInsertEmbed(e)&&!0===(null===(t=e.insert)||void 0===t?void 0:t.linebreak)}(t)&&(e.text=`${e.text.substring(0,e.index)}\n${e.text.substring(e.index)}`,e.index+=1),e)),{text:t,index:0}).text}},17430:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(62172);const r=Object.assign(Object.assign({},n),{BrandGreen60:"#018374",BrandGreen80:"#017467",BorderBaseSubduedColor:"#CDD1DC",TextBaseSubduedColor:"#646B81",TextBaseDefault:"#161719"})},87683:(e,t,i)=>{i.d(t,{$Q:()=>o,E:()=>u,Jj:()=>s,Re:()=>l,ap:()=>c,vY:()=>a});var n=i(31699),r=i(77176);function s(e){const t=function(e){const t=e.ownerDocument;if(t)return t;throw new Error("target does not have ownerDocument")}(e).defaultView;if(t)return t;throw new Error("active document is detached from a window")}function o(e,t=3){if(e&&t>0){const i=function(e){const t=(null===(r=null===(n=(i=e).ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===r?void 0:r.getComputedStyle(i))||null;var i,n,r;return t?"auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowY||"scroll"===t.overflowY||"auto"===t.overflowX||"scroll"===t.overflowX:null}(e);return i?e:null===i?null:o(null==e?void 0:e.parentElement,t-1)}return null}function a(e){var t,i;return null===(i=(null===(t=e.activeElement)||void 0===t?void 0:t.shadowRoot)||e)||void 0===i?void 0:i.activeElement}function l(e){return e instanceof HTMLElement}const c=["b","i"];function u(e,t=c){return"string"==typeof e?{dangerouslySetInnerHTML:{__html:(0,n.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}}:{dangerouslySetInnerHTML:e.pipe(r.U((e=>({__html:(0,n.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}))))}}},2735:(e,t,i)=>{function n(e){const t=e;return null!=t&&(void 0!==t.message&&void 0!==t.name||void 0!==t.stack)}i.d(t,{x:()=>n})},44361:(e,t,i)=>{function n(e){return t=>{(null==t?void 0:t.isTrusted)&&(null==e||e(t))}}i.d(t,{m:()=>n})},54596:(e,t,i)=>{var n;i.d(t,{e:()=>n}),function(e){e.set=function(e,t){return i=>Object.assign(Object.assign({},i),{[e]:t})}}(n||(n={}))},26320:(e,t,i)=>{i.d(t,{L:()=>c,t:()=>l});var n=i(95195),r=i(62965),s=i(57050),o=i(2735),a=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};function l(e,t,i,r,s){return a(this,void 0,void 0,(function*(){try{const o=yield t();n.isLeft(o)?(null==i||i.error("runTaskEither() - error running task",{taskName:e,result:o}),null==s||s(o.left)):(null==i||i.debug("runTaskEither() - task successful",{taskName:e,result:o.right}),null==r||r(o.right))}catch(t){null==i||i.error("runTaskEither() - promise rejection running task",(0,o.x)(t)?t:new Error(String(t)),{taskName:e})}}))}const c={URI:r.ov,map:r.dO.map,ap:(e,t)=>(0,s.zG)(e,r.ap(t))}},65924:(e,t,i)=>{i.d(t,{s:()=>Z});var n,r=i(32952),s=i(5114),o=i(38983),a=i(14601),l=i(83289),c=i(57050);!function(e){let t;!function(e){e.create=function(e){return{source:"feedback",kind:"error",name:"submitFeedbackFailed",rawError:e}},e.is=function(e){return"submitFeedbackFailed"===e.name}}(t=e.SubmitFeedbackFailed||(e.SubmitFeedbackFailed={})),e.toJSON=function(e){var i;return t.is(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(i=e.rawError.stack)&&void 0!==i?i:""}):(0,c.Rz)(e)}}(n||(n={}));var u=i(63346),d=i(26320);class m{constructor(e){var t;this._params=e,this._state=o.h.create({}),this._subs=new a.w,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new u.W(m.name),this.stagingFeedbackFormData=this._state.view(),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case l.i.Kind.openFeedbackFormButtonClick:return this._openFeedbackForm(e.source);case l.i.Kind.feedbackFormChange:return this._updateFeedbackForm(e.feedbackData);case l.i.Kind.feedbackFormSubmitButtonClick:return this._submitFeedbackForm(e.feedbackData);default:return}}_openFeedbackForm(e){this._params.routingViewModel.push("feedbackForm"),this._state.set({source:e})}_updateFeedbackForm(e){this._state.modify((t=>Object.assign(Object.assign({},t),e)))}_submitFeedbackForm(e){this._params.routingViewModel.pop(),this._state.set({}),(0,d.t)("submitFeedback",this._params.feedbackService.submitFeedback(e),this._logger,void 0,(e=>this._params.monitoringService.notify(n.SubmitFeedbackFailed.create(e))))}}var p,h=i(73975);!function(e){e.eq=h.yv}(p||(p={}));var g=i(35292),f=i(64015),v=i(80900),y=i(85985),b=i(2834),x=i(28043),S=i(8125),k=i(54157);class w{constructor(e,t,i=3e3,n=1){this._assistantUIActions=e,this._activeView=t,this._notificationsDurationMs=i,this._maxNotificationsCountAtOnce=n,this._state=o.h.create([]),this._notificationsSubs=new Map,this._subs=new a.w,this._nextToastId=0,this.state=this._state.view(),this._subs.add(this._showFeedbackSubmittedToast().subscribe()),this._subs.add(this._clearNotificationsOnViewChange().subscribe()),this._subs.add(this._removeVoiceTagNotification().subscribe())}dismiss(e){var t;null===(t=this._notificationsSubs.get(e))||void 0===t||t.unsubscribe(),this._notificationsSubs.delete(e),this._state.modify(f.hX((t=>t.id!==e)))}clearAll(){this._notificationsSubs.forEach((e=>e.unsubscribe())),this._notificationsSubs.clear(),this._state.set([])}dispose(){this._subs.unsubscribe(),this.clearAll()}_showNotification(e){const t=this._nextToastId++;this._notificationsSubs.set(t,v.H(this._notificationsDurationMs).subscribe((()=>this.dismiss(t)))),this._state.modify((0,c.ls)(f.QI({kind:e,id:t}),f.ke(this._maxNotificationsCountAtOnce)))}_showFeedbackSubmittedToast(){return this._assistantUIActions.pipe(y.h((0,S.Kg)(l.i.is(l.i.Kind.feedbackFormSubmitButtonClick),l.i.is(l.i.Kind.reportOffensiveResultButtonClick),l.i.is(l.i.Kind.reportOffensiveActionsButtonClick))),b.b((()=>this._showNotification(k.C.Kind.feedbackSubmitted))))}_removeVoiceTagNotification(){return this._assistantUIActions.pipe(y.h(l.i.is(l.i.Kind.voiceTagPopoverRemoveButtonClick)),b.b((()=>this._showNotification(k.C.Kind.voiceTagRemoved))))}_clearNotificationsOnViewChange(){return this._activeView.pipe(x.x(),b.b((e=>{"feedbackForm"!==e&&"voiceProfile"!==e||this.clearAll()})))}}var C=i(23441),_=i(17889);class I{constructor(e,t){this._initialView=e,this._viewEq=t,this._viewStack=o.h.create([this._initialView]),this.activeView=this._viewStack.view(_.YM)}push(e){this._viewStack.modify((t=>this._viewEq.equals(e,t[0])?t:_.QI(e,t)))}pop(){this._viewStack.modify((0,c.ls)(_.pW,(([e,t])=>(0,c.zG)(_.c2(t),s.getOrElse((()=>[e]))))))}replace(e){this._viewStack.modify((t=>(0,c.zG)(_.QI(e,_.Gb(t)))))}}var E=i(62965),A=i(42636),O=i(34349),R=i(12422),T=i(99877);class P{constructor(e,t,i,n){this._assistantUIActions=e,this._router=t,this._monitoringService=i,this._skillService=n,this._subs=new a.w,this._state=o.h.create(s.none),this.state=this._state.view(),this._skillService&&this._subs.add(this._skillService.skillRequests.subscribe((e=>{e.close?(this._onSkillClosed(),this._state.set(s.none)):e.size&&this._state.modify(s.map((t=>Object.assign(Object.assign({},t),{size:e.size}))))}))),this._subs.add(this._assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case l.i.Kind.actionBrickClick:if("backendAction"===e.action.kind&&A.aU.isSkillActionInput(e.action.action)){const t=e.action.action.skill;this._onSkillOpened(),this._state.set(s.some({skill:t,status:"loading",size:{width:416,height:245}}))}break;case l.i.Kind.mount:e.name===T.e.skill&&(0,d.t)("initSkill",(0,c.zG)((0,c.zG)(this._state.get(),E.Yo((()=>new Error("Cannot init Skill. No Skill state available.")))),E.tS((t=>this._skillService?(0,c.zG)(this._skillService.initSkill(t.skill,e.element),E.UI((e=>Object.assign(Object.assign({},t),{size:e})))):E.t$(new Error("Cannot init Skill. No `SkillService` available."))))),void 0,(e=>{this._state.set(s.some(Object.assign(Object.assign({},e),{status:"ready"}))),this._monitoringService.notify(R.e.InitSkillSuccessful.create(e.skill))}),(e=>{this._state.modify(s.map((e=>Object.assign(Object.assign({},e),{status:"error"})))),this._monitoringService.notify(O.b.InitSkillFailed.create((0,c.zG)(this._state.get(),s.map((e=>e.skill))),e))}));break;case l.i.Kind.unmount:e.name===T.e.skill&&(0,d.t)("terminateSkill",(0,c.zG)((0,c.zG)(this._state.get(),E.Yo((()=>new Error("Cannot terminate Skill. No Skill state available.")))),E.tS((e=>this._skillService?(0,c.zG)(this._skillService.terminateSkill(e.skill),E.UI((()=>e))):E.t$(new Error("Cannot terminate Skill. No `SkillService` available."))))),void 0,(e=>{this._state.set(s.none),this._monitoringService.notify(R.e.TerminateSkillSuccessful.create(e.skill))}),(e=>{this._state.set(s.none),this._monitoringService.notify(O.b.TerminateSkillFailed.create((0,c.zG)(this._state.get(),s.map((e=>e.skill))),e))}))}}_onSkillOpened(){this._router.push("skill")}_onSkillClosed(){"skill"===this._router.activeView.get()&&this._router.pop()}}var U,B=i(22232),N=i(86148);!function(e){e.empty={activeSurvey:s.none,stage:N.x.Stage.Type.Rating,transitionStage:N.x.Stage.Type.Rating,rating:s.none,errors:s.none,openAnswer:s.none}}(U||(U={}));class z{constructor(e){this._params=e,this._state=o.h.create(U.empty),this._subs=new a.w,this._stageTimeoutClear=void 0,this.state=this._state.view(),this._updateStageAfterTransition(),this._subscribeToActiveSurvey(),this._subs.add(this._params.assistantUIActions.subscribe((e=>{(0,S.Kg)(l.i.isSurveyAction,l.i.isSurveyImplicitDismissAction)(e)&&this._handleUIAction(e)})))}get _activeSurvey(){return this.state.get().activeSurvey}_subscribeToActiveSurvey(){this._subs.add(this._params.userSurveyService.activeSurvey.subscribe((e=>{(0,c.zG)(e,s.map((e=>{(0,c.zG)(this._activeSurvey,s.fold((()=>this._updateActiveSurvey(e)),(t=>{t.detailedPlacement!==e.detailedPlacement&&this._updateActiveSurvey(e)})))})))})))}_updateActiveSurvey(e){this._state.set(Object.assign(Object.assign({},U.empty),{activeSurvey:s.some(e)}))}_handleUIAction(e){switch(e.kind){case l.i.Kind.surveySubmitButtonClick:case l.i.Kind.surveyKeyPressShiftEnter:this._onSurveyCompleted();break;case l.i.Kind.surveyCancelButtonClick:case l.i.Kind.surveyCloseButtonClick:this._onDismissExplicitly();break;case l.i.Kind.surveyOpenAnswerChange:this._onOpenAnswerChange(e.openAnswer);break;case l.i.Kind.surveyRatingSelectionChange:this._onRatingSelectionChange(e.rating);break;case l.i.Kind.promptSubmitButtonClick:case l.i.Kind.actionBrickClick:case l.i.Kind.resultCardInsertButtonClick:case l.i.Kind.resultCardRephraseButtonClick:case l.i.Kind.resultCardHeaderClick:case l.i.Kind.resultCardDismissButtonClick:this._onDismissImplicitly();break;default:(0,B.L0)(e)}}_onRatingSelectionChange(e){(0,c.zG)(this._activeSurvey,s.map((e=>e.skipOpenAnswerFrom)),s.map((t=>{e<t?this._state.modify((t=>Object.assign(Object.assign({},t),{rating:s.some(e),transitionStage:N.x.Stage.Type.Feedback}))):this._state.modify((t=>Object.assign(Object.assign({},t),{rating:s.some(e),transitionStage:N.x.Stage.Type.Completed}))),this._reportCompleting()})))}_onOpenAnswerChange(e){(0,c.zG)(this._activeSurvey,s.chain((({openAnswer:e})=>e)),s.map((({maxLen:t})=>{e.length<=t&&this._state.modify((t=>Object.assign(Object.assign({},t),{openAnswer:s.some(e),errors:s.none})))})))}_onSurveyCompleted(){(0,c.zG)(this._activeSurvey,s.chain((({openAnswer:e})=>e)),s.chain((({minLen:e})=>e)),s.fold((()=>this._complete()),(e=>{(0,c.zG)(this._state.get().openAnswer,s.fold((()=>this._setOpenAnswerError("This field is required.")),(t=>{t.length<e?this._setOpenAnswerError(e>0?`Please enter at least ${e} characters.`:"This field is required."):this._complete()})))})))}_complete(){this._reportCompleting(),this._state.lens("transitionStage").set(N.x.Stage.Type.Completed)}_reportCompleting(){(0,c.zG)(this._activeSurvey,s.chain((e=>(0,c.zG)(this._state.get().rating,s.map((t=>({survey:e,rating:t})))))),s.map((({survey:e,rating:t})=>this._params.userSurveyService.submitSurveyResult({rating:t,openAnswer:this._state.get().openAnswer,placement:e.placement,detailedPlacement:e.detailedPlacement,stage:this.state.get().stage,type:e.type}))))}_setOpenAnswerError(e){this._state.lens("errors").set(s.some({openAnswerError:s.some(e)}))}_onDismissExplicitly(){(0,c.zG)(this._activeSurvey,s.map((e=>{const t=this.state.get().stage;t===N.x.Stage.Type.Rating&&this._params.userSurveyService.dismissSurvey({placement:e.placement,detailedPlacement:e.detailedPlacement,type:e.type,stage:t})}))),this._state.lens("transitionStage").set(N.x.Stage.Type.Closed)}_onDismissImplicitly(){this._state.lens("transitionStage").set(N.x.Stage.Type.Closed)}_updateStageAfterTransition(){this._subs.add(this._state.subscribe((e=>{this._clearStageTimeout(),this._stageTimeoutClear=setTimeout((()=>{this._state.lens("stage").set(e.transitionStage)}),F[e.transitionStage])})))}_clearStageTimeout(){void 0!==this._stageTimeoutClear&&(clearTimeout(this._stageTimeoutClear),this._stageTimeoutClear=void 0)}dispose(){this._subs.unsubscribe(),this._clearStageTimeout()}}const F={[N.x.Stage.Type.Rating]:0,[N.x.Stage.Type.Feedback]:300,[N.x.Stage.Type.Completed]:0,[N.x.Stage.Type.Closed]:0};var j=i(1178),G=i(17771),M=i(48044),D=i(13853),V=i(83078),H=i(7903),L=i(3709);var K,$=i(54596);class W{constructor(e){var t;this._params=e,this._subs=new a.w,this._state=o.h.create({stagingNewVoiceProfile:s.none,stagingVoiceProfile:s.none}),this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new u.W(W.name),this.state=this._state.view(),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case l.i.Kind.toolbarGoBackButtonClick:return this._handleGoBack();case l.i.Kind.toolbarVoiceButtonClick:return this._openVoiceProfile("toolbar");case l.i.Kind.setVoiceButtonClick:return this._openVoiceProfile("banner");case l.i.Kind.voiceProfileCloseButtonClick:return this._closeVoiceProfile();case l.i.Kind.voiceProfileUseVoiceButtonClick:return this._applyVoiceProfile();case l.i.Kind.toneToggleClick:return this._toggleTone(e.id,e.selected);case l.i.Kind.styleToggleClick:return this._selectStyle(e.id);case l.i.Kind.roleTypeaheadSelectionChange:return this._selectRole((0,c.zG)(e.role,s.map((e=>e.id))));case l.i.Kind.dialectDropdownSelectionChange:return this._selectDialect(e.dialect.id);case l.i.Kind.voiceProfileTabChange:return this._switchNewVoiceProfileTab(e.profileName);case l.i.Kind.voiceTagPopoverRemoveButtonClick:return this._removeVoiceTag(e);case l.i.Kind.voiceTagPopoverCloseButtonClick:return this._closeVoiceTagPopover();case l.i.Kind.voiceTagPopoverKeepButtonClick:return this._keepVoiceTagPopover();case l.i.Kind.applyVoiceToWritingCheckboxChange:return this._updateMyVoiceIsEnabled(e.checked);case l.i.Kind.voiceTagClick:return this._toggleVoiceTag(e);case l.i.Kind.voiceDialectDropdownSelectionChange:return this._selectNewVoiceDialect(e.dialect.id);case l.i.Kind.voiceRoleDropdownSelectionChange:return this._selectNewVoiceRole(e.role.id);case l.i.Kind.voiceSelectionsSaveButtonClick:return this._saveNewVoiceSelections();case l.i.Kind.voiceSelectionsCancelButtonClick:return this._cancelNewVoiceSelectionChanges();case l.i.Kind.voiceSelectionsEditButtonClick:return this._editNewVoiceSelections();case l.i.Kind.promptFieldKeyPressEscape:case l.i.Kind.toolbarCloseButtonClick:return this._trySaveNewProfileIfChanged();default:return}}_handleGoBack(){(0,c.zG)(H.z.toStarted(this._params.sessionService.session.get()),V.bw((e=>{"newVoiceProfile"===e.voiceProfile.kind?(this._trySaveNewProfileIfChanged(),this._state.lens("stagingNewVoiceProfile").set(s.none)):"legacyVoiceProfile"===e.voiceProfile.kind&&this._state.lens("stagingVoiceProfile").set(s.none)})))}_createVoiceProfile(e){var t;return"newVoiceProfile"===e.kind?$.e.set("stagingNewVoiceProfile",s.some({selectedRole:e.selectedRole,selectedDialect:e.selectedDialect,isEnabledByDefault:e.isEnabledByDefault,profiles:e.profiles,activeTagId:s.none,activeProfileName:s.fromNullable(null===(t=e.profiles.find((e=>e.selected)))||void 0===t?void 0:t.name),stagingSelections:s.none})):$.e.set("stagingVoiceProfile",s.some({selectedStyle:e.selectedStyle,selectedTonesPerStyle:e.selectedTonesPerStyle,selectedRole:e.selectedRole,selectedDialect:e.selectedDialect,needsSetup:e.needsSetup}))}_openVoiceProfile(e){(0,c.zG)(H.z.toStarted(this._params.sessionService.session.get()),V.bw((t=>{this._params.trackingService.trackVoiceProfileOpen(e),this._params.routingViewModel.push("newVoiceProfile"===t.voiceProfile.kind?"voiceProfile":"legacyVoiceProfile"),this._state.modify(this._createVoiceProfile(t.voiceProfile))})))}_closeVoiceProfile(){this._params.trackingService.trackVoiceProfileSkip(),this._params.routingViewModel.pop(),this._state.lens("stagingVoiceProfile").set(s.none)}_applyVoiceProfile(){const e=this._state.get().stagingVoiceProfile;this._params.routingViewModel.pop(),this._state.lens("stagingVoiceProfile").set(s.none),(0,c.zG)(e,V.bw((e=>{(0,d.t)("setVoiceProfile",this._params.sessionService.setVoiceProfile(e),this._logger)})))}_toggleTone(e,t){this._state.lens("stagingVoiceProfile").modify(s.map((i=>{return Object.assign(Object.assign({},i),{selectedTonesPerStyle:(0,c.zG)(i.selectedTonesPerStyle,t?(n=L.L.Style.Id.eq,(e,t)=>i=>(0,c.zG)(i,M.cq(n)(e,(0,c.ls)(s.some,t)),s.getOrElse((()=>(0,c.zG)(i,M.ZQ(n)(e,t(s.none)))))))(i.selectedStyle,s.fold((()=>new Set([e])),D.$T(L.L.Tone.Id.eq)(e))):(0,c.ls)(M.cq(L.L.Style.Id.eq)(i.selectedStyle,D.Od(L.L.Tone.Id.eq)(e)),s.getOrElse((()=>i.selectedTonesPerStyle))))});var n})))}_selectStyle(e){this._state.lens("stagingVoiceProfile").modify(s.map((t=>Object.assign(Object.assign({},t),{selectedStyle:e}))))}_selectRole(e){this._state.lens("stagingVoiceProfile").modify(s.map((t=>Object.assign(Object.assign({},t),{selectedRole:e}))))}_selectDialect(e){this._state.lens("stagingVoiceProfile").modify(s.map((t=>Object.assign(Object.assign({},t),{selectedDialect:e}))))}_editNewVoiceSelections(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{stagingSelections:s.some({selectedDialect:e.selectedDialect,selectedRole:e.selectedRole})})))}_cancelNewVoiceSelectionChanges(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{stagingSelections:s.none})))}_saveNewVoiceSelections(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{selectedDialect:(0,c.zG)(e.stagingSelections,s.fold((()=>e.selectedDialect),(e=>e.selectedDialect))),selectedRole:(0,c.zG)(e.stagingSelections,s.fold((()=>e.selectedRole),(e=>e.selectedRole))),stagingSelections:s.none})))}_selectNewVoiceRole(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{stagingSelections:(0,c.zG)(t.stagingSelections,s.map((t=>Object.assign(Object.assign({},t),{selectedRole:s.some(e)}))))})))}_selectNewVoiceDialect(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{stagingSelections:(0,c.zG)(t.stagingSelections,s.map((t=>Object.assign(Object.assign({},t),{selectedDialect:e}))))})))}_updateNewProfileStateIfAny(e){this._state.lens("stagingNewVoiceProfile").modify(s.map(e))}_keepVoiceTagPopover(){this._params.trackingService.trackVoiceProfileKeepTag(),this._closeVoiceTagPopover()}_closeVoiceTagPopover(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{activeTagId:s.none})))}_toggleVoiceTag({tagName:e,sectionName:t,profileName:i}){this._updateNewProfileStateIfAny((n=>Object.assign(Object.assign({},n),{activeTagId:s.toNullable(n.activeTagId)===L.b.createId({tagName:e,sectionName:t,profileName:i})?s.none:s.some(L.b.createId({tagName:e,sectionName:t,profileName:i}))})))}_updateMyVoiceIsEnabled(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{isEnabledByDefault:e})))}_removeVoiceTag({tagName:e,profileName:t,sectionName:i}){this._params.trackingService.trackVoiceProfileRemoveTag(),this._updateNewProfileStateIfAny((n=>Object.assign(Object.assign({},n),{profiles:(0,c.zG)(n.profiles,f.UI((n=>n.name===t?Object.assign(Object.assign({},n),{sections:n.sections.map((t=>t.name===i?Object.assign(Object.assign({},t),{tags:t.tags.filter((t=>t.name!==e))}):t))}):n)))})))}_switchNewVoiceProfileTab(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{activeProfileName:s.some(e)})))}_trySaveNewProfileIfChanged(){(0,c.zG)(G.Y(s.option)({editedVoiceProfile:this._state.view("stagingNewVoiceProfile").get(),sessionVoiceProfile:(0,c.zG)(H.z.toStarted(this._params.sessionService.session.get()),s.map((e=>e.voiceProfile)),s.chain(L.L.toNewVoiceProfile))}),s.filter((({editedVoiceProfile:e,sessionVoiceProfile:t})=>!L.L.NewSelections.eqByRoleDialectProfileAndIsEnabledByDefault.equals(e,t))),V.bw((({editedVoiceProfile:e})=>{(0,d.t)("setNewVoiceProfile",this._params.sessionService.setNewVoiceProfile({selectedDialect:e.selectedDialect,selectedRole:e.selectedRole,isEnabledByDefault:e.isEnabledByDefault,profiles:e.profiles}),this._logger)})))}}!function(e){e.create=function(e){const t=(0,j.UF)(e),i=new r.xQ,n=new I("loading",p.eq),a=new g.A2(Object.assign({assistantUIActions:i,routingViewModel:n},t)),l=new W({assistantUIActions:i,trackingService:t.trackingService,sessionService:t.sessionService,monitoringService:t.monitoringService,logger:t.logger,routingViewModel:n}),c=new m({assistantUIActions:i,feedbackService:t.feedbackService,monitoringService:t.monitoringService,logger:t.logger,routingViewModel:n}),u=new C.A(i,t.genAIAvailabilityService,t.sessionService,t.trackingService,(()=>s.isSome(a.state.get().selectedAction)),(()=>a.focusPromptField())),d=new w(i,n.activeView),h=new z({userSurveyService:t.userSurveyService,assistantUIActions:i}),f=new P(i,n,t.monitoringService,t.skillService);return t.selectionContextAvailabilityService&&t.selectionContextAvailabilityService.augment((e=>o.h.combine(e,n.activeView,((e,t)=>"afterResults"===t||"beforeResults"===t?e:{contextUpdatesClient:!1,contextUpdatesServer:!1})))),{assistant:a,promptMenu:u,notifications:d,voiceProfile:l,feedbackForm:c,userSurvey:h,skill:f,revision:s.fromNullable(t.revisionEngine),routing:n,actions:i.asObservable(),notify:e=>i.next(e),dispose:()=>{a.dispose(),u.dispose(),d.dispose(),l.dispose(),c.dispose(),h.dispose(),f.dispose()}}}}(K||(K={}));var Z,q=i(24203),Y=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){e.create=function(e){const{positionInfo:t,handlers:i}=e,n=Y(e,["positionInfo","handlers"]),r=K.create(Object.assign(Object.assign({},n),{handlers:{close:()=>i.close()}})),s=new q.u(t,{onFocusChange:e=>i.onFocusChange(e)});return Object.assign(Object.assign({},r),{position:s,dispose:()=>{s.dispose(),r.dispose()}})}}(Z||(Z={}))},35292:(e,t,i)=>{i.d(t,{Dj:()=>_,A2:()=>F});var n,r=i(95195),s=i(45701),o=i(64015),a=i(17889),l=i(57050),c=i(14601),u=i(24209),d=i(60797),m=i(77176),p=i(19751),h=i(78674),g=i(85985),f=i(98403),v=i(2834),y=i(5114),b=i(83078),x=i(38983),S=i(42636),k=i(83289);!function(e){let t;!function(e){e.create=function(e){return{source:"assistant",kind:"error",name:"assistantCloseFailed",rawError:e}},e.is=function(e){return"assistantCloseFailed"===e.name}}(t=e.AssistantCloseFailed||(e.AssistantCloseFailed={})),e.toJSON=function(e){var i;return t.is(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(i=e.rawError.stack)&&void 0!==i?i:""}):(0,l.Rz)(e)}}(n||(n={}));var w,C=i(8125);!function(e){let t,i;!function(e){e.create=function(e){return{source:"uphook",kind:"error",name:"reportUphookShowFailed",rawError:e}},e.is=function(e){return"reportUphookShowFailed"===e.name}}(t=e.ReportUphookShowFailed||(e.ReportUphookShowFailed={})),function(e){e.create=function(e){return{source:"uphook",kind:"error",name:"reportUphookClickFailed",rawError:e}},e.is=function(e){return"reportUphookClickFailed"===e.name}}(i=e.ReportUphookClickFailed||(e.ReportUphookClickFailed={})),e.toJSON=function(e){var n;return(0,C.Kg)(t.is,i.is)(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name),rawErrorName:e.rawError.name,rawErrorMessage:e.rawError.message,rawErrorStack:null!==(n=e.rawError.stack)&&void 0!==n?n:""}):(0,l.Rz)(e)}}(w||(w={}));var _,I,E=i(14047),A=i(7903),O=i(99877),R=i(63346),T=i(65602),P=i(54596),U=i(26320),B=i(75616),N=i(1178),z=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){let t;!function(e){e.make=function(e){return{kind:"backendAction",action:e}},e.ordByActionStore=s.contramap((e=>e.action.store.rank))(s.ordNumber)}(t=e.BackendAction||(e.BackendAction={}))}(_||(_={})),function(e){e.create=function(){return{textBox:"",selectedAction:y.none,contentOverflowUnderToolbar:!1,promptAutofocusToken:0,cardsState:{hoveredCard:y.none,focusedCard:y.none},reportMenuVisible:y.none,referencesVisibility:new Map,detectedReferences:y.none,overrideCardVoice:new Map}}}(I||(I={}));class F{constructor(e){var t;this._params=e,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new R.W(F.name),this._state=x.h.create(I.create()),this._subs=new c.w,this._reportMenuVisibleDebounced=x.h.create(y.none),this.state=x.h.combine(this._state,this._params.userService.user,this._params.genAIAvailabilityService.availability,this._params.sessionService.session,this._reportMenuVisibleDebounced,((e,t,i,n,r)=>{var{cardsState:s,reportMenuVisible:a,textBox:c}=e,u=z(e,["cardsState","reportMenuVisible","textBox"]);return Object.assign(Object.assign({},u),{textBox:c,user:t,genAIAvailability:i,session:n,userPromptAction:(0,l.zG)(A.z.toStarted(n),y.chain((e=>e.activeContext.userPromptAction))),activeCards:new Set((0,l.zG)([s.hoveredCard,(0,l.zG)(s.focusedCard,b.vx((0,l.zG)(r,y.chain(B.G.toCard))))],o.oA)),canScroll:y.isNone(a),contextualActions:(0,N.F_)(n),detectedReferences:(0,N.fM)(n,c)})})),this._subs.add(this.state.subscribe((e=>this._logger.debug("State update",e)))),this._subs.add(this._updateActiveView().subscribe()),this._subs.add(u.T(this._state.view("reportMenuVisible").pipe(d.oA,m.U(y.some)),this._state.view("reportMenuVisible").pipe(p.skipBy(y.getEq(B.G.eq)),h.b(250),g.h(y.isNone))).subscribe(f.wW(this._reportMenuVisibleDebounced))),this._subs.add(this._params.routingViewModel.activeView.subscribe((()=>this._state.modify((0,l.ls)(P.e.set("reportMenuVisible",y.none),P.e.set("cardsState",{hoveredCard:y.none,focusedCard:y.none})))))),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}contentOverflowUnderToolbar(e){this._state.lens("contentOverflowUnderToolbar").set(e)}focusPromptField(){this._state.lens("promptAutofocusToken").modify((e=>e+1))}getContextById(e){return this._params.sessionService.getContextById(e)}dispose(){this._subs.unsubscribe()}_updateActiveView(){return u.T(this._params.sessionService.session.view((0,l.ls)(A.z.toStarting,y.chain((e=>e.error)),b.bw((()=>this._params.routingViewModel.replace("loadingError"))))),this._state.view("selectedAction").pipe(d.oA,v.b((()=>this._params.routingViewModel.push("actionSelected")))),this._params.sessionService.session.view((0,l.ls)(A.z.toStarted,y.filter((()=>y.isNone(this._state.get().selectedAction))),y.map((e=>e.results.length>0||y.isSome(e.inProgressResult))),b.bw((e=>this._params.routingViewModel.replace(e?"afterResults":"beforeResults"))))))}_handleUIAction(e){switch(e.kind){case k.i.Kind.toolbarCloseButtonClick:return void this._close(e);case k.i.Kind.toolbarGoBackButtonClick:case k.i.Kind.radioOptionsCancelButtonClick:return this._goBack();case k.i.Kind.promptFieldTextChange:return this._updateTextBox(e.text);case k.i.Kind.actionBrickClick:return this._executeAction(e.action);case k.i.Kind.promptSubmitButtonClick:return this._go(y.none);case k.i.Kind.userPromptSubmit:return this._go(y.some(e.prompt));case k.i.Kind.radioOptionsSubmitButtonClick:return this._submitSelectedAction({selectedRadioOption:e.selectedOption});case k.i.Kind.generateStopButtonClick:return this._stop();case k.i.Kind.resultCardInsertButtonClick:return this._insert(e.result,e.selectedVoice);case k.i.Kind.resultCardRephraseButtonClick:return this._rephrase(e.result,e.selectedVoice);case k.i.Kind.resultCardDismissButtonClick:return this._dismissResult(e.result);case k.i.Kind.errorCardOkButtonClick:return this._dismissError();case k.i.Kind.reportOffensiveResultButtonClick:return this._reportOffensiveResult(e.result);case k.i.Kind.reportOffensiveActionsButtonClick:return this._reportOffensiveActions();case k.i.Kind.resultCardHeaderClick:return this._clickResultHeader(e.prompt);case k.i.Kind.creditsInfoHover:return this._params.trackingService.trackUsageInfoHover();case k.i.Kind.creditsInfoClick:return this._onCreditsInfoClick();case k.i.Kind.resultCardHoverChange:return this._onCardHover(e.resultId,e.hovered);case k.i.Kind.resultCardFocusChange:return this._onCardFocus(e.resultId,e.focused);case k.i.Kind.resultCardCopy:return this._onCardCopy(e.resultId);case k.i.Kind.resultCardToggleGenericVoiceButtonClick:return this._onToggleGenericVoice(e.resultId,e.voice);case k.i.Kind.reportMenuVisibilityChange:return this._onCardReportMenuVisibilityChange(e.trigger,e.visible);case k.i.Kind.referencesVisibilityChange:return this._onCardReferencesVisibilityChange(e.resultId,e.visible);case k.i.Kind.regenerateWithoutReferenceButtonClick:return this._regenerateWithoutReference(e.result,e.referenceId,e.selectedVoice);case k.i.Kind.mount:return this._handleMount(e);case k.i.Kind.promptFieldKeyPressEscape:return this._onPromptFieldKeyPressEscape(e);case k.i.Kind.promptFieldKeyPressEnter:return e.text.trim().length>0?this._go(y.none):this._tryInsertLatestResult();case k.i.Kind.restoreHistoryButtonClick:return this._params.sessionService.restoreHistory();case k.i.Kind.removeSelectionContextClick:return this._params.sessionService.dismissActiveBoundaryContext();case k.i.Kind.selectionContextInteraction:return this._params.textEditorService.setContextHighlight(e.range,e.visibility);default:return}}_handleMount(e){e.name===O.e.creditsInfoButton?(0,U.t)("reportUphookShow",this._params.uphookService.reportUphookShow(this._params.userService.user.get()),this._logger,void 0,(e=>this._params.monitoringService.notify(w.ReportUphookShowFailed.create(e)))):e.name===O.e.historyButton&&this._params.trackingService.trackHistoryButtonView()}_onCardHover(e,t){this._state.lens("cardsState").lens("hoveredCard").modify(t?()=>y.some(e):y.filter((t=>t!==e)))}_onCardFocus(e,t){this._state.lens("cardsState").lens("focusedCard").modify(t?()=>y.some(e):y.filter((t=>t!==e)))}_onCardCopy(e){this._params.sessionService.trackResultCopy(e)}_onCardReportMenuVisibilityChange(e,t){this._state.modify((i=>Object.assign(Object.assign({},i),{reportMenuVisible:t?y.some(e):(0,l.zG)(i.reportMenuVisible,y.filter((t=>!B.G.eq.equals(t,e)))),cardsState:Object.assign(Object.assign({},i.cardsState),{hoveredCard:(0,l.zG)(B.G.toCard(e),y.fold((()=>i.cardsState.hoveredCard),(e=>t?i.cardsState.hoveredCard:(0,l.zG)(i.cardsState.hoveredCard,y.filter((t=>t!==e))))))})})))}_onCardReferencesVisibilityChange(e,t){this._state.lens("referencesVisibility").modify((i=>new Map(i).set(e,t)))}_onToggleGenericVoice(e,t){this._state.lens("overrideCardVoice").modify((i=>{var n;const r=new Map(i),s=(null!==(n=i.get(e))&&void 0!==n?n:t)===E.x.GeneratedTextVoice.generic?E.x.GeneratedTextVoice.user:E.x.GeneratedTextVoice.generic;return r.set(e,s),this._params.trackingService.trackMyVoiceCardToggle(s===E.x.GeneratedTextVoice.user),r}))}_close(e){k.i.is(k.i.Kind.toolbarCloseButtonClick)(e)&&this._params.trackingService.trackAssistantClose(),(0,U.t)("close",this._params.handlers.close(),this._logger,void 0,(e=>this._params.monitoringService.notify(n.AssistantCloseFailed.create(e))))}_goBack(){"actionSelected"===this._params.routingViewModel.activeView.get()&&this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:y.none,textBox:""}))),this._params.routingViewModel.pop()}_updateTextBox(e){this._state.lens("textBox").set(e),this._searchReferences(e)}_executeAction(e){if("backendAction"===e.kind)if(S.aU.isFollowUpQuestionActionInput(e.action)){const t=e.action;this._state.modify((e=>Object.assign(Object.assign({},e),{textBox:"",selectedAction:y.some(t)})))}else S.aU.isQuickActionInput(e.action)?(this._state.modify((e=>Object.assign(Object.assign({},e),{textBox:"",selectedAction:y.none}))),this._params.sessionService.submitAction(e.action,y.toUndefined(this._lastResultSelectedVoice()))):S.aU.isSkillActionInput(e.action)||(0,l.Rz)(e.action);else"allResults"===e.kind||("go"===e.kind?this._go(y.none):(0,l.Rz)(e))}_handleAIUsageNotificationOnPromptSubmit(){(0,l.zG)(A.z.toStarted(this._params.sessionService.session.get()),y.chain((e=>e.activeContext.specialView)),y.filter((e=>"aiUsageAlert"===e.kind)),b.bw((()=>this._params.trackingService.trackAINotificationDismiss("document"))))}_go(e){y.isSome(e)?(this._handleAIUsageNotificationOnPromptSubmit(),this._params.sessionService.submitAction(b.MH(e),y.toUndefined(this._lastResultSelectedVoice()))):y.isSome(this._state.get().selectedAction)?this._submitSelectedAction({textBox:this._state.get().textBox}):(this._handleAIUsageNotificationOnPromptSubmit(),this._submitUserPromptAction())}_stop(){this._params.sessionService.stopInProgressResult()()}_insert(e,t){(0,U.t)("insertText",this._params.textEditorService.insertText((0,T.l)((0,l.zG)(e.replacementDelta,r.fold(l.yR,(e=>t===E.x.GeneratedTextVoice.user?e.user:e.generic))),"")),this._logger,(()=>{this._params.sessionService.trackResultInsert(e.id,t===E.x.GeneratedTextVoice.user)}))}_tryInsertLatestResult(){(0,l.zG)(A.z.toStarted(this._params.sessionService.session.get()),y.map((e=>e.results)),y.chain(o.YM),y.filter(E.x.isStandardCompletedResult),b.bw((e=>this._insert(e,(0,l.zG)(this._lastResultSelectedVoice(),y.getOrElse((()=>E.x.GeneratedTextVoice.generic)))))))}_onPromptFieldKeyPressEscape(e){(0,l.zG)(A.z.toStarted(this._params.sessionService.session.get()),y.chain((e=>e.inProgressResult)),y.fold((()=>this._close(e)),(()=>this._stop())))}_rephrase(e,t){this._params.sessionService.regenerateResult(e.id,{omitReferenceIds:y.none},t)}_dismissResult(e){this._params.sessionService.dismissResult(e.id),this._state.modify((t=>Object.assign(Object.assign({},t),{reportMenuVisible:(0,l.zG)(t.reportMenuVisible,y.filter((t=>!B.G.eq.equals(t,B.G.card(e.id))))),cardsState:{hoveredCard:(0,l.zG)(t.cardsState.hoveredCard,y.filter((t=>t!==e.id))),focusedCard:(0,l.zG)(t.cardsState.hoveredCard,y.filter((t=>t!==e.id)))}})))}_dismissError(){this._params.sessionService.dismissError()}_reportOffensiveResult(e){this._params.sessionService.trackResultOffensive(e.id)}_reportOffensiveActions(){this._params.sessionService.trackActionsOffensive()}_clickResultHeader(e){this._state.modify((t=>Object.assign(Object.assign({},t),{textBox:e,promptAutofocusToken:t.promptAutofocusToken+1})))}_onCreditsInfoClick(){this._params.trackingService.trackUsageInfoClick(),(0,U.t)("reportUphookClick",this._params.uphookService.reportUphookClick(this._params.userService.user.get()),this._logger,void 0,(e=>this._params.monitoringService.notify(w.ReportUphookClickFailed.create(e))))}_submitSelectedAction(e){(0,l.zG)(this._state.get().selectedAction,y.chain((t=>(0,l.zG)(t.args[0],S.Xy.match({string:()=>{var i;return(0,l.zG)(y.fromNullable(null===(i=e.textBox)||void 0===i?void 0:i.trim()),y.filter((e=>e.length>0)),y.map((e=>S.aU.FollowUpQuestionActionValue.fromTextInput(t,e))))},radio:()=>(0,l.zG)(y.fromNullable(e.selectedRadioOption),y.map((e=>S.aU.FollowUpQuestionActionValue.fromRadioInput(t,e))))})))),b.bw((e=>{this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:y.none,textBox:""}))),this._params.sessionService.submitAction(e,y.toUndefined(this._lastResultSelectedVoice()))})))}_lastResultSelectedVoice(){return(0,l.zG)(A.z.toStarted(this._params.sessionService.session.get()),y.map((e=>e.results)),y.chain(o.YM),y.chain((e=>y.fromNullable(this._state.lens("overrideCardVoice").view((t=>t.get(e.id))).get()))))}_submitUserPromptAction(){(0,l.zG)(this._state.get().textBox.trim(),y.fromPredicate((e=>""!==e)),y.chain((e=>(0,l.zG)(A.z.toStarted(this._params.sessionService.session.get()),y.chain((t=>(0,l.zG)(t.activeContext.userPromptAction,y.map((i=>({text:e,session:t,userPromptAction:i}))))))))),b.bw((({text:e,session:t,userPromptAction:i})=>{this._state.lens("textBox").set(""),this._params.sessionService.submitAction(S.aU.UserPromptActionValue.fromInput(i,e,(0,l.zG)((0,N.fM)(t,e),y.map(o.DZ((e=>(0,l.zG)(e.url,y.map((t=>({url:t,referenceId:e.id}))))))),y.chain(a.nI)),y.none),y.toUndefined(this._lastResultSelectedVoice()))})))}_regenerateWithoutReference(e,t,i){this._params.sessionService.regenerateResult(e.id,{omitReferenceIds:y.some([t])},i)}_searchReferences(e){(0,l.zG)((0,N.Yl)(e),b.bw((e=>e.forEach((e=>this._params.sessionService.searchReferences(e))))))}}},24203:(e,t,i)=>{i.d(t,{u:()=>g,G:()=>h});var n=i(5114),r=i(57050),s=i(14601),o=i(2768),a=i(85985),l=i(2834),c=i(49708),u=i(38983),d=i(54596);function m(e=document){return{top:0,left:0,height:e.documentElement.clientHeight,width:e.documentElement.clientWidth}}function p(e,t){return i=>{const n=function(e,t){const i=e.left<t.left?t.left:e.left+e.width>t.left+t.width?t.left+t.width-e.width:e.left,n=e.top<t.top?t.top:e.top+e.height>t.top+t.height?t.top+t.height-e.height:e.top;return Object.assign(Object.assign({},e),{left:i,top:n})}({left:e.left+i.x,top:e.top+i.y,width:e.width,height:e.height},t);return{x:n.left-e.left,y:n.top-e.top}}}function h(e){return(0,r.zG)(e,n.fromPredicate((e=>"initial"===e.kind||"dragged"===e.kind)))}class g{constructor(e,t){this._positionInfo=e,this._handlers=t,this._internalState=u.h.create({managedPositionInfo:n.none,assistant:n.none,dragState:n.none,assistantMaxHeight:n.none}),this.state=this._internalState.view((e=>(0,r.zG)(e.dragState,n.map((t=>{return i=t,n=e.assistantMaxHeight,{kind:"dragged",dragging:i.dragging,referencePosition:i.translationOrigin,assistantMaxHeight:n,translation:p(Object.assign(Object.assign({},i.assistantSize),{top:i.viewportSize.height-i.translationOrigin.bottom-i.assistantSize.height,left:i.viewportSize.width-i.translationOrigin.right-i.assistantSize.width}),Object.assign({left:0,top:0},i.viewportSize))(i.translation)};var i,n})),n.alt((()=>(0,r.zG)(e.managedPositionInfo,n.map((t=>({kind:"initial",referenceElement:t.referenceElement,placement:t.placement,offset:t.offset,assistantMaxHeight:e.assistantMaxHeight})))))),n.getOrElse((()=>({kind:"none"})))))),this._subs=new s.w,this._subs.add(this._positionInfo.pipe(o.R(this._internalState.view("dragState").pipe(a.h(n.isSome))),l.b((e=>this._internalState.lens("managedPositionInfo").set(n.some(e))))).subscribe()),this._subs.add(c.R(self,"resize").pipe(l.b((()=>this._internalState.lens("dragState").modify(n.map(d.e.set("viewportSize",(0,r.zG)(m(),(({width:e,height:t})=>({width:e,height:t}))))))))).subscribe())}onFocusChange(e){this._handlers.onFocusChange(e)}onMount(e){this._internalState.lens("assistant").set(n.some(e))}onResize(e){this._internalState.lens("dragState").modify(n.map(d.e.set("assistantSize",(0,r.zG)(e,(({width:e,height:t})=>({width:e,height:t}))))))}onMaxHeightChange(e){this._internalState.lens("assistantMaxHeight").set(n.some(e))}onDrag(e){this._internalState.modify((t=>Object.assign(Object.assign({},t),{dragState:(0,r.zG)(t.dragState,n.map((0,r.ls)(d.e.set("translation",e),d.e.set("dragging",!0))),n.alt((()=>(0,r.zG)(t.assistant,n.map((e=>({assistantRect:e.getBoundingClientRect(),viewportSize:(0,r.zG)(m(),(({width:e,height:t})=>({width:e,height:t})))}))),n.map((({assistantRect:t,viewportSize:i})=>({dragging:!0,viewportSize:i,assistantSize:{width:t.width,height:t.height},translation:e,translationOrigin:{bottom:i.height-(t.top+t.height),right:i.width-(t.left+t.width)}})))))))})))}onDragEnd(){this._internalState.lens("dragState").modify(n.map(d.e.set("dragging",!1)))}dispose(){this._subs.unsubscribe()}}},23441:(e,t,i)=>{i.d(t,{t:()=>T,A:()=>U});var n=i(64015),r=i(17889),s=i(57050),o=i(14601),a=i(32952),l=i(78674),c=i(85985),u=i(41398),d=i(2834),m=i(98403),p=i(16118),h=i(77176),g=i(60797),f=i(2844),v=i(66310),y=i(76974),b=i(93508),x=i(5114),S=i(83078),k=i(22232),w=i(38983),C=i(83289),_=i(819),I=i(7903),E=i(80191),A=i(87683),O=i(45701);function R(e){return e.split(/\s+/).map((e=>e.trim())).filter((e=>""!==e))}var T,P=i(1178);!function(e){e.isActionsStore=function(e){return"actionsStore"===e.kind},e.isSearchResults=function(e){return"searchResults"===e.kind}}(T||(T={}));class U{constructor(e,t,i,S,C,E){var A,T,U;this._genAIAvailabilityService=t,this._sessionService=i,this._trackingService=S,this._focusPromptField=E,this._subs=new o.w,this._state=w.h.create(x.none),this._userTyped=new a.xQ,this._promptOrMenuFocused=new a.xQ,this._promptMenuActions=new a.xQ,this._promptMenuContainer=x.none,this._cachedActionBricks=x.none,this.state=this._state.view(),this._subs.add(this._userTyped.pipe(l.b(150),c.h((()=>!C())),u.M(this._state.view((0,s.ls)(x.map((e=>e.filterPredicate)),x.getOrElse((()=>s.W8))))),d.b((([e,t])=>this._promptMenuActions.next({kind:"showSearchResults",search:e,filterPredicate:t})))).subscribe()),this._subs.add((A=this._promptMenuActions,T=this._sessionService.session,U=this._genAIAvailabilityService.availability,f.aj([A.pipe(v.w((e=>"showSearchResults"===e.kind?T.view(I.z.toStarted).pipe(h.U((t=>(0,s.zG)(t,x.filter((()=>""!==e.search.trim())),x.chain((t=>{return i=t.activeContext.availableActions,o=e.search,(0,s.zG)(i,n.DZ((e=>(0,s.zG)(function(e,t,i){const r=R(e),o=[...R(t),...(0,s.zG)(i,n.tS((e=>R(e))))],a=r.map((()=>null));let l=0;for(const e of o){if(l>=r.length)break;e.toLowerCase().includes(r[l].toLowerCase())&&(a[l]=0,++l)}return a.includes(null)?x.none:x.some(a.map((e=>null!=e?e:0)).reduce(((e,t)=>e+t),0))}(o,e.searchLabel,e.searchTags),x.map((t=>({data:e,matchScore:t})))))),n.DY(O.contramap((({matchScore:e})=>e))(O.ordNumber)),n.UI((({data:e})=>e)),r.c2);var i,o})),x.map((t=>({kind:"searchResults",actions:t,filterPredicate:e.filterPredicate}))))))):"showActionsStore"===e.kind?T.view((0,s.ls)(P.F_,x.map((t=>({kind:"actionsStore",actions:t,filterPredicate:e.filterPredicate}))))):"close"===e.kind?y.of(x.none):(0,k.L0)(e))),b.O(x.none)),U]).pipe(h.U((([e,t])=>(0,s.zG)(e,x.filter((()=>!_._.isUnavailable(t)))))))).subscribe(m.wW(this._state))),this._subs.add(this._promptOrMenuFocused.pipe(l.b(100),c.h((e=>!e))).subscribe((()=>this._promptMenuActions.next({kind:"close"})))),this._subs.add(this.state.pipe(p.G(),c.h((([e,t])=>x.isNone(e)&&x.isSome(t))),h.U((([e,t])=>t)),g.oA).subscribe((e=>{"actionsStore"===e.kind?this._trackingService.trackActionsOpenStore():"searchResults"===e.kind&&this._trackingService.trackPromptSearch()}))),this._subs.add(this._promptMenuActions.pipe(c.h((e=>"close"===e.kind))).subscribe((()=>this._invalidateActionBricks()))),this._subs.add(e.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case C.i.Kind.mount:return void(this._promptMenuContainer=x.some(e.element));case C.i.Kind.promptMenuKeyPressArrowDown:return this._onPromptMenuKeyPressArrowDown();case C.i.Kind.promptMenuKeyPressArrowUp:return this._onPromptMenuKeyPressArrowUp();case C.i.Kind.promptFieldKeyPressArrowUp:return this._focusLastBrick();case C.i.Kind.promptFieldKeyPressArrowDown:return this._focusFirstBrick();case C.i.Kind.promptFieldTextChange:return this._invalidateActionBricks(),this._userTyped.next(e.text);case C.i.Kind.collapsePromptMenuButtonClick:case C.i.Kind.promptSubmitButtonClick:return this._promptMenuActions.next({kind:"close"});case C.i.Kind.promptFieldKeyPressEnter:return void(e.text.trim().length>0&&this._promptMenuActions.next({kind:"close"}));case C.i.Kind.actionBrickClick:return"allResults"===e.action.kind?this._promptMenuActions.next({kind:"showActionsStore",filterPredicate:e.action.filterPredicate}):this._promptMenuActions.next({kind:"close"});case C.i.Kind.promptFieldAndMenuFocusChange:return this._promptOrMenuFocused.next(e.focused);default:return}}_invalidateActionBricks(){this._cachedActionBricks=x.none}_getActionBricks(){return(0,s.zG)(this._cachedActionBricks,x.getOrElse((()=>{const e=(0,s.zG)(this._promptMenuContainer,x.fold((()=>[]),(e=>n.nI(Array.from(e.querySelectorAll(E.K)).filter(A.Re)))));return this._cachedActionBricks=x.some(e),e})))}_onPromptMenuKeyPressArrowDown(){var e;const t=this._getActionBricks(),i=(0,A.vY)((null===(e=x.toNullable(this._promptMenuContainer))||void 0===e?void 0:e.ownerDocument)||document);return(0,s.zG)(x.fromNullable(t.findIndex((e=>e===i))),S.bw((e=>{var i;e+1>=t.length?this._focusPromptField():null===(i=t[e+1])||void 0===i||i.focus()})))}_onPromptMenuKeyPressArrowUp(){var e;const t=this._getActionBricks(),i=(0,A.vY)((null===(e=x.toNullable(this._promptMenuContainer))||void 0===e?void 0:e.ownerDocument)||document);return(0,s.zG)(x.fromNullable(t.findIndex((e=>e===i))),S.bw((e=>{var i;e-1<0?this._focusPromptField():null===(i=t[e-1])||void 0===i||i.focus()})))}_focusFirstBrick(){var e;null===(e=this._getActionBricks()[0])||void 0===e||e.focus()}_focusLastBrick(){var e;const t=this._getActionBricks();null===(e=t[t.length-1])||void 0===e||e.focus()}}},75616:(e,t,i)=>{i.d(t,{G:()=>n});var n,r=i(57050),s=i(95195),o=i(73975),a=i(5114),l=i(14047);!function(e){e.eq=s.getEq(o.yv,l.x.Id.eq),e.card=function(e){return s.right(e)},e.uiItem=function(e){return s.left(e)},e.toCard=function(e){return a.fromEither(e)},e.toUIItem=function(e){return(0,r.zG)(e,s.fold(a.some,(()=>a.none)))}}(n||(n={}))},1178:(e,t,i)=>{i.d(t,{F_:()=>u,UF:()=>p,Yl:()=>m,fM:()=>d});var n=i(64015),r=i(17889),s=i(57050),o=i(5114),a=i(83078),l=i(62965),c=i(7903);function u(e){return(0,s.zG)(c.z.toStarted(e),o.filter((e=>(0,s.zG)(e.activeContext.specialView,a.wo((({kind:e})=>"aiUsageAlert"!==e))))),o.map((e=>e.activeContext.availableActions)),o.chain(r.c2))}function d(e,t){return(0,s.zG)(c.z.toStarted(e),o.chain((e=>(0,s.zG)(m(t),o.map(n.DZ((t=>{var i;return null!==(i=e.detectedReferences.get(t))&&void 0!==i?i:o.none}))),o.chain(r.c2)))))}function m(e){return(0,s.zG)(e.split(/\s/).filter((e=>e.length>3&&e.includes("."))),r.nI)}function p(e){return Object.assign(Object.assign({},e),{handlers:Object.assign(Object.assign({},e.handlers),{close:()=>(0,s.zG)(l.fF((()=>new Promise((e=>setTimeout(e))))),l.tS(e.handlers.close))})})}},33104:(e,t,i)=>{i.d(t,{k:()=>N});var n,r=i(5114),s=i(14601),o=i(85985),a=i(64015),l=i(57050),c=i(93508),u=i(16118),d=i(77176),m=i(60797),p=i(41398),h=i(66310),g=i(80544),f=i(79692),v=i(2834),y=i(24209),b=i(67434),x=i(17343),S=i(40151),k=i(8125),w=i(22232),C=i(83078),_=i(83289),I=i(21189),E=i(8122),A=i(14047),O=i(7903),R=i(69693);function T(e,t,i,n,r=1e3){return e.pipe(o.h(E.l.is(E.l.Kind.mount)),o.h((e=>i(e.step))),h.w((({step:e})=>t.pipe(d.U(C.FX(e)),h.w((e=>e?n.pipe(x.h(Date.now())):S.E)),o.h((e=>Date.now()-e>=r)),x.h(e)))))}!function(e){e.completeInitialOrRewriteStepOnSessionInit=({session:e,stepsSeenOnThisSession:t})=>e.pipe(c.O(r.none),u.G(),d.U((([e,t])=>r.isNone(e)&&r.isSome(t)?r.some(t):r.none)),m.oA,p.M(t),h.w((([e,t])=>(0,l.zG)([t.has(I.T.StepName.initial)?r.some(I.T.StepName.initial):r.none,t.has(I.T.StepName.initialBTS)?r.some(I.T.StepName.initialBTS):r.none,R.w.isRewriteOrQuickRewrite(e.value.mode)?r.some(I.T.StepName.rewrite):r.none],a.oA)))),e.completeReviewStepOnSecondResultReceived=({session:e,activeStep:t})=>e.pipe(d.U((0,l.ls)(r.chain(O.z.toStarted),r.fold((()=>0),(e=>e.results.length)))),u.G(),o.h((([e,t])=>1===e&&2===t)),p.M(t),d.U((([e,t])=>(0,l.zG)(t,r.filter((e=>e===I.T.StepName.review))))),m.oA),e.completeActiveAssistantStepOnSessionEnd=({session:e,activeStep:t,visibleForMs:i,onboardingUIActions:n})=>T(n,t.pipe(g.QV(f.E)),I.T.StepName.isAssistantOnboardingStep,e.pipe(u.G(),o.h((([e,t])=>r.isSome(e)&&r.isNone(t)))),i),e.completeStepOnCloseClick=({onboardingUIActions:e,trackingService:t})=>e.pipe(o.h(E.l.is(E.l.Kind.close)),d.U((e=>(e.step===I.T.StepName.initial&&t.trackOnboardingPopupSkip(),e.step===I.T.StepName.initialBTS&&t.trackBTSOnboardingPopupSkip(),e.step)))),e.completeInitialStepOnTryItOutClick=({onboardingUIActions:e,trackingService:t})=>e.pipe(o.h(E.l.is(E.l.Kind.tryItOut)),d.U((e=>(e.step===I.T.StepName.initial&&t.trackOnboardingPopupNext(),e.step===I.T.StepName.initialBTS&&t.trackBTSOnboardingPopupNext(),e.step)))),e.completeReviewStepOnResultInteraction=({assistantUIActions:e})=>e.pipe(o.h(_.i.isResultAction),o.h((e=>A.x.isStandardCompletedResult(e.result))),d.U((()=>I.T.StepName.review))),e.completeHistoryStepOnHistoryRestore=({assistantUIActions:e})=>e.pipe(o.h(_.i.is(_.i.Kind.restoreHistoryButtonClick)),d.U((()=>I.T.StepName.history))),e.completeAssistantStepsOnUserActions=({assistantUIActions:e,activeStep:t})=>e.pipe(o.h((0,k.Kg)(_.i.is(_.i.Kind.actionBrickClick),_.i.is(_.i.Kind.promptSubmitButtonClick),_.i.is(_.i.Kind.promptFieldKeyPressEnter),_.i.is(_.i.Kind.toolbarVoiceButtonClick),_.i.is(_.i.Kind.setVoiceButtonClick),_.i.is(_.i.Kind.openFeedbackFormButtonClick))),p.M(t),d.U((([e,t])=>(0,l.zG)(t,r.filter(I.T.StepName.isAssistantOnboardingStep)))),m.oA),e.completeInitialStepOnDispose=({onboardingUIActions:e,activeStep:t,disposed:i,visibleForMs:n})=>T(e,t,(e=>e===I.T.StepName.initial||e===I.T.StepName.initialBTS),i,n);const t=e=>t=>i=>t(i).pipe(v.b((t=>{var n;return null===(n=i.logger)||void 0===n?void 0:n.debug(`${e} - step to complete: ${t}`)})));function i(e){return e.pipe(b.R(((e,t)=>({seen:new Set(e.seen).add(t),step:e.seen.has(t)?r.none:r.some(t)})),{seen:new Set,step:r.none}),d.U((e=>e.step)),m.oA)}e.defaultCompletionSources=[t("session init")(e.completeInitialOrRewriteStepOnSessionInit),t("second result received")(e.completeReviewStepOnSecondResultReceived),t("session end")(e.completeActiveAssistantStepOnSessionEnd),t("user closed step")(e.completeStepOnCloseClick),t("user clicked try-it-out")(e.completeInitialStepOnTryItOutClick),t("user interacted with results")(e.completeReviewStepOnResultInteraction),t("user interacted with assistant")(e.completeAssistantStepsOnUserActions),t("user restored history")(e.completeHistoryStepOnHistoryRestore),t("feature disposed")(e.completeInitialStepOnDispose)],e.extractStepsToComplete=function(e,t){return y.T(...e.map((e=>e(t)))).pipe(i)}}(n||(n={}));var P=i(96327),U=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};class B extends P.o{constructor(e,t){super(e),this._onDispose=t}dispose(){super.dispose(),this._onDispose()}}function N(e){var{assistantUIActions:t,trackingService:i,completeOnboardingStep:a,stepCompletionSources:l,disposed:c,logger:u}=e,d=U(e,["assistantUIActions","trackingService","completeOnboardingStep","stepCompletionSources","disposed","logger"]);const m=new s.w,p=new B(Object.assign(Object.assign({},d),{assistantMountActions:t.pipe(o.h(_.i.is(_.i.Kind.mount))),assistantUnmountActions:t.pipe(o.h(_.i.is(_.i.Kind.unmount)))}),(()=>m.unsubscribe()));return m.add(n.extractStepsToComplete(null!=l?l:n.defaultCompletionSources,{onboardingUIActions:p.uiActions,assistantUIActions:t,activeStep:p.activeStep.view(r.map((e=>e.name))),stepsSeenOnThisSession:p.stepsSeenOnThisSession,session:d.session,trackingService:i,disposed:c,logger:u}).subscribe((e=>{a(e)}))),m.add(function(e,t){return e.pipe(o.h(E.l.is(E.l.Kind.mount)),v.b((e=>{switch(e.step){case I.T.StepName.initial:return t.trackOnboardingPopupView();case I.T.StepName.initialBTS:return t.trackBTSOnboardingPopupView();case I.T.StepName.prompts:return t.trackOnboardingPromptsTooltipView();case I.T.StepName.review:return t.trackOnboardingReviewTooltipView();case I.T.StepName.rewrite:return t.trackOnboardingRewriteTooltipView();case I.T.StepName.knowledgeHub:return t.trackOnboardingKnowledgeHubTooltipView();case I.T.StepName.references:return t.trackOnboardingReferencesTooltipView();case I.T.StepName.history:return t.trackOnboardingHistoryTooltipView();default:return(0,w.L0)(e.step)}})))}(p.uiActions,i).subscribe()),p}},96327:(e,t,i)=>{i.d(t,{X:()=>n,o:()=>w});var n,r=i(5114),s=i(57050),o=i(14601),a=i(32952),l=i(98403),c=i(60797),u=i(77176),d=i(93508),m=i(16118),p=i(85985),h=i(2844),g=i(28043),f=i(41398),v=i(67434),y=i(22232),b=i(38983),x=i(21189),S=i(91984),k=i(99877);!function(e){e.isTooltipOnboardingStep=function(e){return x.T.StepName.isTooltipOnboardingStep(e.name)}}(n||(n={}));class w{constructor(e){var t,i,n,v,w,I;this._params=e,this._subs=new o.w,this._assistantElements=b.h.create({}),this._externalElements=b.h.create({}),this._hideAssistantTooltips=b.h.create(!1),this._nextCandidateStep=b.h.create(r.none),this.stepsSeenOnThisSession=b.h.create(new Set),this._uiActions=new a.xQ,this.uiActions=this._uiActions.asObservable(),this.activeStep=b.h.combine(this._nextCandidateStep,this._assistantElements,this._externalElements,this._hideAssistantTooltips,((e,t,i,n)=>(0,s.zG)(e,r.chain((e=>function(e,t,i,n){switch(e){case x.T.StepName.initial:return(0,s.zG)(r.fromNullable(i[k.n.initialPopupAnchor]),r.map((e=>({name:x.T.StepName.initial,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!0}))));case x.T.StepName.initialBTS:return(0,s.zG)(r.fromNullable(i[k.n.initialBTSPopupAnchor]),r.map((e=>({name:x.T.StepName.initialBTS,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!0}))));case x.T.StepName.rewrite:return(0,s.zG)(r.fromNullable(i[k.n.rewriteTooltipAnchor]),r.map((e=>({name:x.T.StepName.rewrite,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!0}))));case x.T.StepName.prompts:return(0,s.zG)(r.fromNullable(t[k.e.initialActionsList]),r.map((e=>({name:x.T.StepName.prompts,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case x.T.StepName.review:return(0,s.zG)(r.fromNullable(t[k.e.followUpActionsList]),r.map((e=>({name:x.T.StepName.review,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case x.T.StepName.knowledgeHub:return(0,s.zG)(r.fromNullable(t[k.e.promptInput]),r.map((e=>({name:x.T.StepName.knowledgeHub,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case x.T.StepName.references:return(0,s.zG)(r.fromNullable(t[k.e.referencesList]),r.map((e=>({name:x.T.StepName.references,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case x.T.StepName.history:return(0,s.zG)(r.fromNullable(t[k.e.historyButton]),r.map((e=>({name:x.T.StepName.history,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));default:return(0,y.L0)(e)}}(e,t,i,n)))))),this.promptsAllocated=this._params.promptsAllocated,this._subs.add((t=this.activeStep,i=this._params.upstreamOnboardingState,n=this._params.session,v=this._params.textStats,w=this._params.forceDisabledOnboardingSteps,I=this._params.client,h.aj([n,i,v.pipe(_()),n.pipe(u.U(r.isSome),g.x(),f.M(i),u.U((([e,t])=>e?r.some(t):r.none)))]).pipe(u.U((([e,i,n,o])=>{if(r.isNone(e)){const e=!(0,s.zG)(t.get(),r.map((e=>e.name===x.T.StepName.initial)),r.getOrElse(s.jv))&&!w.has(x.T.StepName.initialBTS)&&!i.initialBTS[I].completed&&void 0===i.initialBTS[I].lastSeen,o=!w.has(x.T.StepName.initial)&&!i.initial[I].completed&&void 0===i.initial[I].lastSeen&&!i.initialBTS[I].completed&&void 0===i.initialBTS[I].lastSeen,a=!w.has(x.T.StepName.rewrite)&&!i.rewrite[I].completed&&(i.initial[I].completed||i.initialBTS[I].completed)&&n>=30;return e?r.some(x.T.StepName.initialBTS):o?r.some(x.T.StepName.initial):a?r.some(x.T.StepName.rewrite):r.none}return S.Z.Step.anyClientCompleted(i.prompts)||w.has(x.T.StepName.prompts)?S.Z.Step.anyClientCompleted(i.review)||w.has(x.T.StepName.review)?S.Z.Step.anyClientCompleted(i.history)||w.has(x.T.StepName.history)||!C(o)?S.Z.Step.anyClientCompleted(i.knowledgeHub)||w.has(x.T.StepName.knowledgeHub)||!C(o)?S.Z.Step.anyClientCompleted(i.references)||w.has(x.T.StepName.references)||!C(o)?r.none:r.some(x.T.StepName.references):r.some(x.T.StepName.knowledgeHub):r.some(x.T.StepName.history):r.some(x.T.StepName.review):r.some(x.T.StepName.prompts)})))).subscribe(l.wW(this._nextCandidateStep))),this._subs.add(this._params.assistantMountActions.subscribe((({name:e,element:t})=>this._assistantElements.modify((i=>Object.assign(Object.assign({},i),{[e]:{reference:t,placement:e===k.e.historyButton?"bottom":"left"}})))))),this._subs.add(this._params.assistantUnmountActions.subscribe((({name:e})=>this._assistantElements.modify((t=>Object.assign(Object.assign({},t),{[e]:void 0})))))),this._subs.add(this._params.externalElements.subscribe(l.wW(this._externalElements))),this._subs.add(this._params.hideAssistantOnboardingTooltips.subscribe(l.wW(this._hideAssistantTooltips))),this._subs.add(this.activeStep.pipe(c.oA).subscribe((e=>this.stepsSeenOnThisSession.modify((t=>new Set([...t,e.name])))))),this._subs.add(this._params.session.pipe(u.U(r.isSome),d.O(!1),m.G(),p.h((([e,t])=>e&&!t))).subscribe((()=>this._assistantElements.set({}))))}notify(e){this._uiActions.next(e)}dispose(){this._subs.unsubscribe()}}function C(e){return(0,s.zG)(e,r.fold(s.jv,(({prompts:e,review:t})=>{const i={prompts:S.Z.Step.anyClientCompleted(e),review:S.Z.Step.anyClientCompleted(t)};return Object.values(i).every(s.yR)})))}function _(){return(0,s.ls)(c.oA,u.U((e=>e.wordCount)),d.O(0),m.G(),v.R(((e,[t,i])=>(0,s.zG)(Math.abs(i-t),(t=>t<=2?e+t:e))),0),d.O(0),g.x())}},48725:(e,t,i)=>{i.d(t,{v:()=>se,h:()=>ge});var n=i(64681),r=i(32952),s=i(5114),o=i(13853),a=i(57050),l=i(14601),c=i(2844),u=i(77176),d=i(2834),m=i(85321),p=i(12126),h=i(23063),g=i(49143),f=i(91224),v=i(76974),y=i(38194),b=i(19751),x=i(66310),S=i(93508),k=i(85985),w=i(16118),C=i(60797),_=i(24209),I=i(73975),E=i(38983),A=i(31384);const O=I.MW({visibleAlerts:o.Eh(I.yv),emphasizedAlerts:o.Eh(I.yv)});class R{constructor(e){this._params=e,this._subs=new l.w,this._feedMounted=E.h.create(!1),this._subs.add((0,a.zG)(function(e,t){const i=e.pipe(y.B()),n=i.pipe(u.U(s.chain((e=>e.focusedItemId))),b.skipBy(s.getEq(I.yv))).pipe(x.w((()=>t.pipe(S.O(null)))));return c.aj([i,n]).pipe(u.U((([e,t])=>(0,a.zG)(e,s.map((({items:e,focusedItemId:i})=>({visibleAlerts:new Set(Array.from(e.values()).flatMap((e=>e.alertIds))),emphasizedAlerts:new Set(null!=t?t:(0,a.zG)(i,s.chain((t=>{var i;return s.fromNullable(null===(i=e.get(t))||void 0===i?void 0:i.alertIds)})),s.getOrElse((()=>[]))))})))))),b.skipBy(s.getEq(O)))}(c.aj([this._params.feedState,this._feedMounted]).pipe(u.U((([e,t])=>t?e:s.none))),this._params.resetEmphasizedAlerts),T,d.b((e=>{var t;return null===(t=this._params.logger)||void 0===t?void 0:t.debug("AlertVisibilityChanges",e)})),m.zg((({changes:e,isReset:t})=>t?p.D(this._params.alertService.setAlertsVisibility(e)).pipe(h.q(1),g.l(),f.K((t=>v.of((0,A.i1)(e,t))))):p.D(this._params.alertService.updateAlertsVisibility(e)).pipe(h.q(1),g.l(),f.K((t=>v.of((0,A.rd)(e,t)))))))).subscribe((e=>this._params.monitoringService.notify(e))))}notifyFeedMount(){this._feedMounted.set(!0)}notifyFeedUnmount(){this._feedMounted.set(!1)}dispose(){this._subs.unsubscribe()}}function T(e){return e.pipe(b.skipBy(s.getEq(O)),y.B(),(e=>{const t=e.pipe(k.h(s.isNone),u.U((()=>({isReset:!0,changes:[]})))),i=e.pipe(S.O(s.none),w.G(),k.h((([e,t])=>s.isNone(e)&&s.isSome(t))),u.U((([e,t])=>t)),C.oA,u.U((e=>({isReset:!0,changes:(0,a.zG)(Array.from(e.visibleAlerts).filter((t=>!e.emphasizedAlerts.has(t))).map((e=>({alertId:e,visibility:"visible"}))).concat(Array.from(e.emphasizedAlerts).map((e=>({alertId:e,visibility:"emphasized"})))))})))),n=e.pipe(S.O(s.none),w.G(),k.h((([e,t])=>s.isNone(e)&&s.isSome(t))),x.w((([t,i])=>e.pipe(S.O(i),C.oA,w.G(),u.U((([e,t])=>{const i=o.e5(I.yv)(o.Lf(I.yv).concat(t.visibleAlerts,t.emphasizedAlerts))(o.Lf(I.yv).concat(e.visibleAlerts,e.emphasizedAlerts)),n=o.e5(I.yv)(e.emphasizedAlerts)(t.emphasizedAlerts),r=o.e5(I.yv)(t.emphasizedAlerts)(e.emphasizedAlerts),s=o.Lf(I.yv).concat(o.e5(I.yv)(e.visibleAlerts)(t.visibleAlerts),(0,a.zG)(r,o.hX((e=>t.visibleAlerts.has(e)))));return{isReset:!1,changes:[...Array.from(i).map((e=>({alertId:e,visibility:"hidden"}))),...Array.from(s).map((e=>({alertId:e,visibility:"visible"}))),...Array.from(n).map((e=>({alertId:e,visibility:"emphasized"})))]}}))))));return _.T(t,i,n)}))}var P=i(95195),U=i(45701),B=i(64015),N=i(48044),z=i(41398),F=i(67434),j=i(98403),G=i(2768),M=i(83078),D=i(92843),V=i(31442),H=i(21038),L=i(28811),K=i(63346);function $(e){return null!=e}var W=i(66374),Z=i(94996),q=i(44212),Y=i(17160),X=i(78929),Q=i(26393),J=i(24055),ee=i(71078),te=i(19125);class ie{constructor(e=new K.W(ie.name)){this._logger=e,this._alertIds=new Set}hasAlert(e){return this._alertIds.has(e)}processChanges(e){for(const t of e)(0,ee.BG)(t)?this._alertIds.add(t.alertId):(0,ee.nq)(t)?this._alertIds.delete(t.alertId):(0,ee.Jg)(t)&&this._alertIds.clear();e.length>0&&this._logger.debug("Alert collection change",new Set(this._alertIds))}}class ne{constructor(e){var t;this._params=e,this._subs=new l.w,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new K.W(ne.name),this._sduiEvents=new r.xQ,this._alertCollection=new ie(this._params.logger),this._sduiManager=new X.G(this._sduiEvents.asObservable(),s.fromPredicate((e=>this._alertCollection.hasAlert(e)))),this.state=this._sduiManager.state,this.onAlertsRefEmpty=this._sduiManager.onAlertsRefEmpty,this.pushRemovedRoot=e=>this._sduiManager.pushRemovedRoot(e),this.pushRemovedAlerts=([e,t])=>this._sduiManager.pushRemovedAlerts([e,t]),this.pushSwitchView=e=>this._sduiManager.pushSwitchView(e),this._subs.add(this._processAlertChanges()),this._subs.add(this._processInboundSDUIMessages()),this._subs.add(this._sduiManagerLifecycleOnAlertsRefEmpty()),this._subs.add(this._sduiEvents.subscribe((e=>this._logger.debug("sdui event",e))))}dispose(){this._subs.unsubscribe(),this._sduiManager.dispose()}_processInboundSDUIMessages(){const e=e=>(0,a.zG)(e.sdui,Q.ab.dslRootParser,P.bimap((t=>(this._params.monitoringService.notify(A.jk(e.sduiRootId,t)),t)),a.yR),s.fromEither);return p.D(this._params.sduiService.sduiItemCollectionChanges).pipe(q.u(),u.U((t=>(0,te.tC)(t)?(0,a.zG)(t,e,s.map((e=>({kind:J.e.SduiEventKind.Add,sdui:e,sduiRootId:J.e.RawSduiItem.Id.create(t.sduiRootId),rev:0})))):(0,te.Y9)(t)?(0,a.zG)(t,e,s.map((e=>({kind:J.e.SduiEventKind.Update,sdui:e,sduiRootId:J.e.RawSduiItem.Id.create(t.sduiRootId),rev:0})))):(0,te.zi)(t)?s.some({kind:J.e.SduiEventKind.Remove,sduiRootId:J.e.RawSduiItem.Id.create(t.sduiRootId),rev:0}):(0,te.H$)(t)?s.none:(0,a.Rz)(t))),C.oA).subscribe(this._sduiEvents)}_sduiManagerLifecycleOnAlertsRefEmpty(){return this._sduiManager.onAlertsRefEmpty.subscribe(this._params.onAlertsRefEmpty)}_processAlertChanges(){return p.D(this._params.alertService.alertCollectionChanges).pipe(Y.e(0),q.u()).subscribe((e=>{this._alertCollection.processChanges(e);const t=e.reduce(((e,t)=>{var i;return(0,ee.nq)(t)&&"textChange"===t.reason&&e.set("textChange",(null!==(i=e.get("textChange"))&&void 0!==i?i:[]).concat(H.j.AlertId.from(t.alertId))),e}),new Map);e.length>0&&(this._sduiManager.notifyAlertsChanged(),t.size>0&&this._logger.debug("optimistically removing alerts",t),t.forEach(((e,t)=>this.pushRemovedAlerts([e,t]))))}))}}class re{constructor(e){var t;this._params=e,this._sub=new l.w,this._disposed=new r.xQ,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new K.W(re.name),this._sduiManagerProxy=new ne({sduiService:this._params.sduiService,alertService:this._params.alertService,monitoringService:this._params.monitoringService,onAlertsRefEmpty:e=>this._onSDUIManagerProxyAlertsRefEmpty(e)}),this._sduiFeedManager=new V._(this._sduiManagerProxy.state),this.feedState=this._getFeedState(),this._sduiFeedManagerLifecycleOnSelectedAlertIdChanged(),this._sduiFeedManagerLifecycleOnFeedEmpty(),this._sduiFeedManagerLifecycleOnFeedRemoved(),this._sduiFeedManagerLifecycleOnInitialFeedReady(),this._sub.add(this.feedState.subscribe((e=>this._logger.debug("feed state updated",e))))}_onSDUIManagerProxyAlertsRefEmpty(e){(0,a.zG)(this.feedState.get(),s.chain((e=>e.focusedItemId)),s.filter((t=>t===e.sduiRootId)),M.bw((()=>this._processActions(e.emptyStrongAlertRef.onEmpty,e.sduiId,e.emptyStrongAlertRef.alertIds,e.sduiId))))}_sduiFeedManagerLifecycleOnSelectedAlertIdChanged(){this._sub.add(p.D(this._params.alertService.selectedAlertId).pipe(k.h($),u.U((e=>(0,a.zG)(this.feedState.get(),s.chain((t=>{var i;return s.fromNullable(null===(i=Array.from(t.items.values()).find((t=>t.alertIds.includes(H.j.AlertId.from(e)))))||void 0===i?void 0:i.id)}))))),C.oA,z.M(this.feedState.view(s.chain((e=>e.focusedItemId)))),k.h((([e,t])=>e!==s.toNullable(t)))).subscribe((([e])=>this._sduiFeedManager.focusCard(e))))}_sduiFeedManagerLifecycleOnFeedEmpty(){this._sub.add(this._sduiFeedManager.onFeedEmpty.subscribe((e=>{var t;"assistantFeed"===e.content.type?this._processActions(null!==(t=e.content.onEmpty)&&void 0!==t?t:[],e.id,[],e.id):this._params.monitoringService.notify(Z._d())})))}_sduiFeedManagerLifecycleOnFeedRemoved(){this._sub.add(this._sduiFeedManager.onFeedRemove.subscribe((e=>{"assistantFeed"===e.content.type?this._processActions(e.content.onRemove,e.id,[],e.id):this._params.monitoringService.notify(Z.cd())})))}_getFeedState(){const e=E.h.create(s.none);return this._sub.add(this._sduiFeedManager.feed.pipe(F.R(((e,{feedId:t,feedOrd:i,cards:n,itemIdToSelect:r})=>{const o=new Set,l=(0,a.zG)(n,D.v.reduce(e.items,((e,t,i)=>(o.add(i),e)),((e,t,i)=>(0,a.zG)(e,N.ZQ(H.j.Item.Id.eq)(i.id,i))),((e,t,i)=>(0,a.zG)(e,N.ZQ(H.j.Item.Id.eq)(i,t))))),c=(0,a.zG)(Array.from(l.values()),B.DY(U.contramap((e=>e.content))(i)),B.UI((e=>e.id))),u=Array.from(o.keys()).reduce(((e,t)=>(0,a.zG)(e,N.EG(H.j.Item.Id.eq)(t))),l),d=c.filter((e=>!o.has(e)));return{feedId:t,items:u,orderedItemIds:d,focusedItemId:(0,a.zG)(r,s.fold((()=>(0,a.zG)(e.focusedItemId,s.fold((()=>d.length>0&&0===e.orderedItemIds.length?s.some(d[0]):s.none),(e=>o.has(e)?function(e,t,i){const n=t.findIndex((t=>t===e));if(n<0)return s.none;for(let e=n+1;e<t.length;++e)if(!i.has(t[e]))return s.some(t[e]);for(let e=n-1;e>=0;--e)if(!i.has(t[e]))return s.some(t[e]);return s.none}(e,c,o):s.some(e))))),(0,a.ls)(s.fromNullable,s.fold((()=>s.fromNullable(d[0])),(e=>d.includes(H.j.Item.Id.from(e))?s.some(H.j.Item.Id.from(e)):s.fromNullable(d[0]))))))}}),{feedId:H.j.Item.Id.from(""),items:new Map,orderedItemIds:[],focusedItemId:s.none}),u.U(s.some)).subscribe(j.wW(e))),e.view()}_sduiFeedManagerLifecycleOnInitialFeedReady(){var e;const t=null!==(e=this._params.sduiService.initialFeed)&&void 0!==e?e:{feedId:"default-feed",cardId:null};this._sub.add(this._sduiManagerProxy.state.pipe(k.h((e=>s.isSome(L.a.find((e=>e.id===t.feedId))(e))&&(!t.cardId||s.isSome(L.a.find((e=>e.id===t.cardId))(e))))),h.q(1)).subscribe((()=>{var e;return this._processActions([{type:"pushAssistantFeed",feedId:t.feedId,cardId:null!==(e=t.cardId)&&void 0!==e?e:void 0}],H.j.Item.Id.from("CheetahWeb:FeedService"),[],"CheetahWeb:FeedService")})))}_switchViewWithinFocusedItem(e){(0,a.zG)(this.feedState.get(),s.chain((e=>e.focusedItemId)),s.filter((t=>e.sduiRootId!==t)),M.bw((t=>this._sduiManagerProxy.pushSwitchView(Object.assign(Object.assign({},e),{sduiRootId:t})))))}_switchViewWithinCurrentFeed(e){(0,a.zG)(this._sduiFeedManager.currentFeed,s.filter((({feedId:t})=>e.sduiRootId!==t)),M.bw((({feedId:t})=>this._sduiManagerProxy.pushSwitchView(Object.assign(Object.assign({},e),{sduiRootId:t})))))}_processActions(e,t,i,n){this._logger.debug("_processActions()",{actions:e,itemId:t,alertIdsInScope:i,sourceId:n}),e.forEach((r=>{var o;switch(r.type){case"notify":{const e=null!==(o=r.sourceId)&&void 0!==o?o:n;p.D(this._params.capiService.user_action({userAction:r.userAction,componentId:e})()).pipe(h.q(1),G.R(this._disposed)).subscribe(a.Q1,(t=>this._params.monitoringService.notify(A.bn(e,r.userAction,t))));break}case"applyAlerts":{const e=i.map((e=>({alertId:e,alternativeIndex:r.alternativeIndex})));p.D(this._params.alertService.applyAlerts(e)).pipe(h.q(1),G.R(this._disposed)).subscribe((()=>this._params.monitoringService.notify(W.$S(e))),(t=>this._params.monitoringService.notify(A.tg(e,t))));break}case"removeAlerts":{const t=e.some((e=>"applyAlerts"===e.type)),n=i.map((e=>({alertId:e,removalReason:t?"alertApplied":"other"})));p.D(this._params.alertService.removeAlerts(n)).pipe(h.q(1),G.R(this._disposed)).subscribe((()=>{this._sduiManagerProxy.pushRemovedAlerts([i.map(H.j.AlertId.from),"removeAlerts"]),this._params.monitoringService.notify(W.q6(n))}),(e=>this._params.monitoringService.notify(A.I(n,e))));break}case"highlightAlert":return this._params.setEmphasizedAlerts([i[0]]);case"removeRoot":this._sduiManagerProxy.pushRemovedRoot([t,"removeRoot"]);break;case"pushAssistantFeed":(0,a.zG)(this._sduiFeedManager.pushFeed(H.j.Item.Id.from(r.feedId),r.cardId),P.bimap((e=>this._params.monitoringService.notify(A.cu(e,r.feedId,r.cardId))),(()=>this._params.monitoringService.notify(W.Np(r.feedId,r.cardId)))));break;case"popAssistantFeed":this._sduiFeedManager.popFeed(s.fromNullable(r.fallbackFeed));break;case"focusAssistantCard":this._sduiFeedManager.focusCard(r.cardId);break;case"prevCard":(0,a.zG)(this.feedState.get(),s.chain((e=>(0,a.zG)(e.focusedItemId,s.map((t=>e.orderedItemIds.findIndex((e=>e===t)))),s.chain((t=>s.fromNullable(e.orderedItemIds[t-1])))))),M.bw((e=>this._sduiFeedManager.focusCard(e))));break;case"nextCard":(0,a.zG)(this.feedState.get(),s.chain((e=>(0,a.zG)(e.focusedItemId,s.map((t=>e.orderedItemIds.findIndex((e=>e===t)))),s.chain((t=>s.fromNullable(e.orderedItemIds[t+1])))))),M.bw((e=>this._sduiFeedManager.focusCard(e))));break;case"openLink":case"upgradeToPremium":case"nativeOpenAssistant":case"openCreateSnippetModal":case"newRevision":case"copyToClipboard":case"interactPopover":case"closePopover":case"hideHighlights":case"showHighlights":case"closeCard":case"openGrammarlyGo":case"openToneDetector":case"selectAlternative":case"stopApplyingAlerts":case"transition":case"openSettings":case"openFeedback":case"enablePlagiarismCheck":case"disablePlagiarismCheck":case"openLearnMore":break;case"switchView":{const e={where:r.where,selected:r.selected,sduiRootId:t};this._sduiManagerProxy.pushSwitchView(e),this._switchViewWithinFocusedItem(e),this._switchViewWithinCurrentFeed(e);break}default:(0,a.Rz)(r)}}))}processActions(e,t,i,n){this._processActions(e,t.id,null!=i?i:t.alertIds,null!=n?n:t.id)}onItemFocused(e,t){this._sduiFeedManager.notifyCardFocused(e.id),t&&this.processActions(t,e)}dispose(){this._disposed.next(void 0),this._sub.unsubscribe(),this._sduiManagerProxy.dispose(),this._sduiFeedManager.dispose()}}var se,oe=i(80900),ae=i(40151),le=i(8125),ce=i(40330),ue=i(79880),de=i(15962);class me{constructor(e){this._params=e,this._subs=new l.w,this._transitions=E.h.create([]),this._internalFeedState=E.h.combine(this._params.feedService.feedState,this._transitions,((e,t)=>(0,a.zG)(e,s.chain((e=>(0,a.zG)(e.focusedItemId,s.chain((t=>s.fromNullable(e.items.get(t)))),s.map((i=>{const n=e.orderedItemIds.findIndex((e=>e===i.id)),r=0===n,o=n===e.orderedItemIds.length-1;return{kind:"nonEmptyState",focused:Object.assign(Object.assign({},i),{content:(0,a.zG)(pe(i.content,r,o),s.chain(he),s.getOrElse((()=>i.content)))}),transitions:t,isFirst:r,isLast:o}})))))))).view(),this._state=E.h.create({kind:"loadingState"}),this.state=this._state.view(),this._subs.add(this._handleNonEmptyState()),this._subs.add(this._resetLoadingAndSuccessStates()),this._subs.add(this._handleSuccessState())}processActions(e,t,i,n){e.find((e=>"prevCard"===e.type||"nextCard"===e.type))&&this._transitions.set(e.filter(ce.zx.Action.isTransitionAction)),this._params.feedService.processActions(e.map((e=>{switch(e.type){case"positionedClick":case"hoverStateChanged":return;default:return e}})).filter(le.$K),t,i.alertRefs,n)}onItemMount(e){var t;this._params.feedService.onItemFocused(e,null===(t=s.toUndefined(function(e){if("assistantCard"===e.content.type)return s.some(e.content);if("strongAlertRef"===e.content.type&&"assistantCard"===e.content.child.type)return s.some(e.content.child);return s.none}(e)))||void 0===t?void 0:t.onFocus)}onFeedMount(){const e=de.q.registerFeedUnmountHandler((()=>{de.q.unregisterFeedUnmountHandler(e),this._params.alertVisibilityManager.notifyFeedUnmount()}));this._params.alertVisibilityManager.notifyFeedMount()}onAnimationEnd(){this._transitions.set([])}dispose(){this._subs.unsubscribe()}_handleNonEmptyState(){return this._internalFeedState.pipe(S.O(s.none),w.G(),u.U((([e,t])=>(0,a.zG)(t,s.map((t=>Object.assign(Object.assign({},t),{prevFocusedItem:(0,a.zG)(e,s.map((e=>e.focused)))})))))),C.oA).subscribe(j.wW(this._state))}_handleSuccessState(){return this._internalFeedState.pipe(w.G(),k.h((([e,t])=>s.isSome(e)&&s.isNone(t))),u.U((()=>({kind:"successState"})))).subscribe(j.wW(this._state))}_resetLoadingAndSuccessStates(){return this._state.view("kind").pipe(x.w((e=>"loadingState"===e||"successState"===e?oe.H(1e3).pipe(u.U((()=>({kind:"emptyState"})))):ae.E))).subscribe(j.wW(this._state))}}function pe(e,t,i){return Q.ab.map(e,(e=>{if("button"===e.type&&e.name.value===String(ue.MU.ButtonPrev)){const i=t?ue.BN.Disabled:ue.BN.Enabled;return Object.assign(Object.assign({},e),{state:i})}if("button"===e.type&&e.name.value===String(ue.MU.ButtonNext)){const t=i?ue.BN.Disabled:ue.BN.Enabled;return Object.assign(Object.assign({},e),{state:t})}return e}))}function he(e){return Q.ab.map(e,(e=>"button"===e.type&&"learn-more"===e.name.value?Object.assign(Object.assign({},e),{state:ue.BN.Hidden}):e))}function ge(e){const t=new r.xQ,i=new re({capiService:e.capiService,alertService:e.alertService,sduiService:e.sduiService,monitoringService:e.monitoringService,setEmphasizedAlerts:e=>t.next(new Set(e)),logger:e.logger}),n=new R({feedState:i.feedState,resetEmphasizedAlerts:t,alertService:e.alertService,monitoringService:e.monitoringService,logger:e.logger}),s=new me({feedService:i,alertVisibilityManager:n});return{revisionEngine:se.wrap({singleCardFeedViewModel:s}),dispose:()=>{s.dispose(),n.dispose(),i.dispose()}}}!function(e){const t=n.k4();e.wrap=function(e){return t.wrap(e)},e.unwrap=function(e){return t.unwrap(e)}}(se||(se={}))},71078:(e,t,i)=>{function n(e){return"alertAdded"===e.kind}function r(e){return{kind:"alertAdded",alertId:e}}function s(e){return"alertRemoved"===e.kind}function o(e,t){return{kind:"alertRemoved",alertId:e,reason:t}}function a(e){return"alertCollectionReset"===e.kind}function l(){return{kind:"alertCollectionReset"}}i.d(t,{BG:()=>n,Jg:()=>a,Tm:()=>r,cT:()=>l,nq:()=>s,qQ:()=>o})},31384:(e,t,i)=>{i.d(t,{$C:()=>c,EF:()=>d,Gp:()=>v,I:()=>l,Ls:()=>g,au:()=>b,bn:()=>y,cu:()=>h,i1:()=>m,jk:()=>f,pS:()=>a,rd:()=>u,tg:()=>o});var n=i(57050),r=i(8125),s=i(2735);function o(e,t){return{kind:"error",source:"revision",name:"applyAlertsFailed",applyAlertsInfo:e,rawError:t}}function a(e){return"applyAlertsFailed"===e.name}function l(e,t){return{kind:"error",source:"revision",name:"removeAlertsFailed",removeAlertsInfo:e,rawError:t}}function c(e){return"removeAlertsFailed"===e.name}function u(e,t){return{kind:"error",source:"revision",name:"updateAlertsVisibilityFailed",alertsVisibilityInfo:e,rawError:t}}function d(e){return"updateAlertsVisibilityFailed"===e.name}function m(e,t){return{kind:"error",source:"revision",name:"setAlertsVisibilityFailed",alertsVisibilityInfo:e,rawError:t}}function p(e){return"setAlertsVisibilityFailed"===e.name}function h(e,t,i){return{kind:"error",source:"revision",name:"sduiPushAssistantFeedFailed",reason:e,feedId:t,cardId:i}}function g(e){return"sduiPushAssistantFeedFailed"===e.name}function f(e,t){return{kind:"error",source:"revision",name:"sduiDSLParseFailed",sduiRootId:e,rawError:t}}function v(e){return"sduiDSLParseFailed"===e.name}function y(e,t,i){return{kind:"error",source:"revision",name:"sduiUserActionFailed",componentId:e,userAction:t,rawError:i}}function b(e){var t,i,s,o,l;const u={kind:e.kind,source:e.source,name:String(e.name)};if(a(e)){const i=x(e.rawError);return JSON.stringify(Object.assign(Object.assign({},u),{applyAlertsInfo:e.applyAlertsInfo,rawErrorName:i.name,rawErrorMessage:i.message,rawErrorStack:null!==(t=i.stack)&&void 0!==t?t:""}))}if(c(e)){const t=x(e.rawError);return JSON.stringify(Object.assign(Object.assign({},u),{removeAlertsInfo:e.removeAlertsInfo,rawErrorName:t.name,rawErrorMessage:t.message,rawErrorStack:null!==(i=t.stack)&&void 0!==i?i:""}))}if((0,r.Kg)(d,p)(e)){const t=x(e.rawError);return JSON.stringify(Object.assign(Object.assign({},u),{alertsVisibilityInfo:e.alertsVisibilityInfo,rawErrorName:t.name,rawErrorMessage:t.message,rawErrorStack:null!==(s=t.stack)&&void 0!==s?s:""}))}if(v(e)){const t=x(e.rawError);return JSON.stringify(Object.assign(Object.assign({},u),{sduiRootId:e.sduiRootId,rawErrorName:t.name,rawErrorMessage:t.message,rawErrorStack:null!==(o=t.stack)&&void 0!==o?o:""}))}if(g(e))return JSON.stringify(Object.assign(Object.assign({},u),{reason:e.reason,feedId:e.feedId,cardId:e.cardId}));if(function(e){return"sduiUserActionFailed"===e.name}(e)){const t=x(e.rawError);return JSON.stringify(Object.assign(Object.assign({},u),{componentId:e.componentId,userAction:e.userAction,rawErrorName:t.name,rawErrorMessage:t.message,rawErrorStack:null!==(l=t.stack)&&void 0!==l?l:""}))}return(0,n.Rz)(e)}function x(e){return(0,s.x)(e)?e:{message:String(e),name:void 0,stack:void 0}}},91447:(e,t,i)=>{i.d(t,{$C:()=>s.$C,AE:()=>d,EF:()=>s.EF,Gp:()=>s.Gp,Ls:()=>s.Ls,SZ:()=>a.SZ,Sf:()=>l,X9:()=>o.X9,Zs:()=>o.Zs,dK:()=>o.dK,dh:()=>a.dh,lS:()=>c,pS:()=>s.pS,q_:()=>m,ti:()=>u});var n=i(57050),r=i(8125),s=i(31384),o=i(66374),a=i(94996);function l(e){return"revision"===e.source&&"error"===e.kind}function c(e){return"revision"===e.source&&"warning"===e.kind}function u(e){return"revision"===e.source&&"info"===e.kind}const d=(0,r.Kg)(l,c,u);function m(e){return l(e)?(0,s.au)(e):c(e)?(0,a.au)(e):u(e)?(0,o.au)(e):(0,n.Rz)(e)}},66374:(e,t,i)=>{i.d(t,{$S:()=>r,Np:()=>l,X9:()=>a,Zs:()=>c,au:()=>u,dK:()=>s,q6:()=>o});var n=i(57050);function r(e){return{kind:"info",source:"revision",name:"applyAlertsSuccessful",applyAlertsInfo:e}}function s(e){return"applyAlertsSuccessful"===e.name}function o(e){return{kind:"info",source:"revision",name:"removeAlertsSuccessful",removeAlertsInfo:e}}function a(e){return"removeAlertsSuccessful"===e.name}function l(e,t){return{kind:"info",source:"revision",name:"sduiPushAssistantFeedSuccessful",feedId:e,cardId:t}}function c(e){return"sduiPushAssistantFeedSuccessful"===e.name}function u(e){const t={kind:e.kind,source:e.source,name:String(e.name)};return s(e)?JSON.stringify(Object.assign(Object.assign({},t),{applyAlertsInfo:e.applyAlertsInfo})):a(e)?JSON.stringify(Object.assign(Object.assign({},t),{removeAlertsInfo:e.removeAlertsInfo})):c(e)?JSON.stringify(Object.assign(Object.assign({},t),{feedId:e.feedId,cardId:e.cardId})):(0,n.Rz)(e)}},94996:(e,t,i)=>{i.d(t,{SZ:()=>l,_d:()=>s,au:()=>c,cd:()=>a,dh:()=>o});var n=i(57050),r=i(8125);function s(){return{kind:"warning",source:"revision",name:"sduiFeedOnEmptyDSLActionsSkipped"}}function o(e){return"sduiFeedOnEmptyDSLActionsSkipped"===e.name}function a(){return{kind:"warning",source:"revision",name:"sduiFeedOnRemoveDSLActionsSkipped"}}function l(e){return"sduiFeedOnRemoveDSLActionsSkipped"===e.name}function c(e){return(0,r.Kg)(o,l)(e)?JSON.stringify({kind:e.kind,source:e.source,name:String(e.name)}):(0,n.Rz)(e)}},19125:(e,t,i)=>{function n(e){return"sduiItemAdd"===e.kind}function r(e,t){return{kind:"sduiItemAdd",sduiRootId:e,sdui:t}}function s(e){return"sduiItemUpdate"===e.kind}function o(e,t){return{kind:"sduiItemUpdate",sduiRootId:e,sdui:t}}function a(e){return"sduiItemRemove"===e.kind}function l(e){return{kind:"sduiItemRemove",sduiRootId:e}}function c(e){return"sduiItemCollectionReset"===e.kind}function u(){return{kind:"sduiItemCollectionReset"}}i.d(t,{FE:()=>o,H$:()=>c,K5:()=>r,Ul:()=>l,Y9:()=>s,Zw:()=>d,ex:()=>u,tC:()=>n,zi:()=>a});const d=(0,i(8125).Kg)(n,s,a,c)},15962:(e,t,i)=>{var n;i.d(t,{q:()=>n}),function(e){const t=[];e.notifyFeedUnmount=function(){t.forEach((e=>e()))},e.registerFeedUnmountHandler=function(e){return t.push(e),e},e.unregisterFeedUnmountHandler=function(e){const i=t.findIndex((t=>t===e));i>=0&&t.splice(i,1)}}(n||(n={}))},71761:(e,t,i)=>{i.r(t),i.d(t,{ActionArg:()=>f,ActionArgDef:()=>v,ActionArgDefRadioButtonGroup:()=>S,ActionArgDefRadioButtonGroupHint:()=>x,ActionArgDefString:()=>b,ActionArgDefStringHint:()=>y,ActionDef:()=>w,ActionDefGeneratesTextType:()=>k,ActionInfo:()=>C,AvailableVoiceProfile:()=>A,AvailableVoiceProfileSection:()=>E,AvailableVoiceProfileSectionTag:()=>I,AvailableVoiceProfileSectionTagState:()=>_,AvailableVoiceProfiles:()=>O,ClientMessage:()=>c,ClientMessageImplementations:()=>Ae,Context:()=>R,DocumentOverview:()=>T,Error:()=>U,ErrorKind:()=>P,GeneratedText:()=>B,GenerationMode:()=>N,Message:()=>z,MessageAction:()=>G,MessageChunk:()=>q,MessageError:()=>$,MessageGetContext:()=>F,MessageGetHistory:()=>K,MessageGetUserState:()=>H,MessageInterrupt:()=>V,MessageInvalidateContext:()=>j,MessageResult:()=>X,MessageResultChangesSummary:()=>Y,MessageSearchReferences:()=>L,MessageSearchReferencesResult:()=>Z,MessageSetContext:()=>W,MessageSetHistory:()=>ne,MessageSetHistoryCard:()=>ie,MessageSetHistoryCardTitle:()=>J,MessageSetHistoryCardTitleAction:()=>te,MessageSetHistoryCardTitleUserPrompt:()=>ee,MessageSetUserState:()=>Q,MessageSetVoice:()=>M,MessageSetVoiceProfile:()=>D,Metadata:()=>re,OuterContext:()=>oe,OuterContextItem:()=>se,PreviousText:()=>ae,PreviousTextHistory:()=>ce,PreviousTextRegular:()=>le,PreviousTextWriterExpert:()=>ue,ProtocolMessage:()=>u,Reference:()=>de,ReferencePrivacyLevel:()=>me,ReferencePrivacyLevelPublic:()=>pe,ReferencePrivacyLevelRestricted:()=>he,Root:()=>g,ServerMessage:()=>d,ServerMessageImplementations:()=>Oe,SpecialView:()=>ge,SpecialViewAiUsageAlert:()=>fe,StartMessage:()=>m,StartedMessage:()=>p,Style:()=>ve,Text:()=>ye,TextLike:()=>h,TextRange:()=>be,Toggle:()=>xe,UrlReference:()=>Se,Usage:()=>ke,UserState:()=>Ce,UserStateSettings:()=>we,Voice:()=>_e,VoiceProfileSettings:()=>Ee,VoiceProfileSettingsMyVoiceIsEnabledByDefault:()=>Ie,encoderSchemable:()=>Ne,extend:()=>Be,interpreter:()=>Ue,make:()=>Pe});var n=i(59312),r=i(50687),s=i(83257),o=i(18164),a=i(73915),l=i(57050),c=Pe((function(e){return Te(u(e),e.struct({}))(e)})),u=Pe((function(e){return e.struct({id:e.number})})),d=Pe((function(e){return Te(u(e),e.struct({}))(e)})),m=Pe((function(e){return e.intersect(e.partial({docIdIsTransient:e.boolean}))(e.struct({}))})),p=Pe((function(e){return e.struct({cheetahState:Ce(e)})})),h=Pe((function(e){return e.struct({plain:e.sensitiveString,delta:e.sensitiveDelta})})),g=Pe((function(e){return z(e)})),f=Pe((function(e){return e.struct({name:e.string,value:e.sensitiveString})})),v=Pe((function(e){var t;return e.sum("valueType")(((t={}).string=b(e),t.radioButtonGroup=S(e),t))})),y=Pe((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),b=Pe((function(e){return e.intersect(e.partial({hint:y(e)}))(e.struct({valueType:e.literal("string"),label:e.string,name:e.string}))})),x=Pe((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),S=Pe((function(e){return e.intersect(e.partial({hint:x(e)}))(e.struct({valueType:e.literal("radioButtonGroup"),label:e.string,name:e.string,radioButtonGroupValues:e.readonly(e.array(e.string))}))})),k=Re(r.cX),w=Pe((function(e){return e.intersect(e.partial({generatesTextType:k(e)}))(e.struct({id:e.string,iconUrl:e.string,group:e.string,label:e.string,searchTags:e.readonly(e.array(e.string)),args:e.readonly(e.array(v(e)))}))})),C=Pe((function(e){return e.intersect(e.partial({useReferences:e.readonly(e.array(Se(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.struct({contextId:e.string,triggerContextId:e.string,actionId:e.string,args:e.readonly(e.array(f(e)))})))})),_=Re(r.ES),I=Pe((function(e){return e.struct({name:e.string,state:_(e)})})),E=Pe((function(e){return e.struct({name:e.string,tags:e.readonly(e.array(I(e)))})})),A=Pe((function(e){return e.struct({name:e.string,summary:e.string,selected:e.boolean,sections:e.readonly(e.array(E(e)))})})),O=Pe((function(e){return e.readonly(e.array(A(e)))})),R=Pe((function(e){return e.intersect(e.partial({voiceProfileSettings:Ee(e)}))(e.intersect(e.partial({intent:e.sensitiveString}))(e.intersect(e.partial({documentOverview:T(e)}))(e.intersect(e.partial({specialView:ge(e)}))(e.intersect(e.partial({textScope:be(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({id:e.string,voice:_e(e),availableActions:e.readonly(e.array(w(e))),parentAction:C(e),stateBlob:e.string,promptAction:w(e),quickRewriteAction:w(e)})))))))})),T=Pe((function(e){return e.struct({title:e.string,summary:e.string})})),P=Re(r.oS),U=Pe((function(e){return e.struct({kind:P(e),title:e.string,text:e.string})})),B=Pe((function(e){return Te(h(e),e.struct({plain:e.sensitiveString,interrupted:e.boolean,renderDiff:e.boolean,delta:e.sensitiveDelta}))(e)})),N=Re(r.s2),z=Pe((function(e){var t;return Te(u(e),e.sum("action")(((t={})["cheetah:getContext"]=F(e),t["cheetah:invalidateContext"]=j(e),t["cheetah:action"]=G(e),t["cheetah:setVoice"]=M(e),t["cheetah:setVoiceProfile"]=D(e),t["cheetah:interrupt"]=V(e),t["cheetah:getUserState"]=H(e),t["cheetah:searchReferences"]=L(e),t["cheetah:getHistory"]=K(e),t["cheetah:error"]=$(e),t["cheetah:setContext"]=W(e),t["cheetah:searchReferencesResult"]=Z(e),t["cheetah:chunk"]=q(e),t["cheetah:result"]=X(e),t["cheetah:setUserState"]=Q(e),t["cheetah:setHistory"]=ne(e),t)))(e)})),F=Pe((function(e){return Te(c(e),e.intersect(e.partial({outerContext:oe(e)}))(e.intersect(e.partial({selectedRange:be(e)}))(e.intersect(e.partial({stateBlob:e.string}))(e.intersect(e.partial({previousText:ae(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:getContext"),rev:e.number,generationMode:N(e)})))))))(e)})),j=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:invalidateContext")}))(e)})),G=Pe((function(e){return Te(c(e),e.intersect(e.partial({useReferences:e.readonly(e.array(Se(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.intersect(e.partial({previousText:ae(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:action"),rev:e.number,contextId:e.string,triggerContextId:e.string,actionId:e.string,stateBlob:e.string,args:e.readonly(e.array(f(e)))}))))))(e)})),M=Pe((function(e){return Te(c(e),e.struct({action:e.literal("cheetah:setVoice"),voice:_e(e)}))(e)})),D=Pe((function(e){return Te(c(e),e.intersect(e.partial({role:e.string}))(e.intersect(e.partial({isEnabledByDefault:e.boolean}))(e.intersect(e.partial({profiles:O(e)}))(e.struct({action:e.literal("cheetah:setVoiceProfile")})))))(e)})),V=Pe((function(e){return Te(c(e),e.struct({action:e.literal("cheetah:interrupt"),promptId:e.number}))(e)})),H=Pe((function(e){return Te(c(e),e.struct({action:e.literal("cheetah:getUserState")}))(e)})),L=Pe((function(e){return Te(c(e),e.intersect(e.partial({url:e.string}))(e.struct({action:e.literal("cheetah:searchReferences")})))(e)})),K=Pe((function(e){return Te(c(e),e.struct({action:e.literal("cheetah:getHistory")}))(e)})),$=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:error"),promptId:e.number,error:U(e)}))(e)})),W=Pe((function(e){return Te(d(e),e.intersect(e.partial({progressMessage:e.string}))(e.struct({action:e.literal("cheetah:setContext"),promptId:e.number,context:R(e),usage:ke(e)})))(e)})),Z=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:searchReferencesResult"),promptId:e.number,references:e.readonly(e.array(de(e)))}))(e)})),q=Pe((function(e){return Te(d(e),e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:chunk"),promptId:e.number,token:e.sensitiveString})))(e)})),Y=Pe((function(e){return e.struct({title:e.string,description:e.readonly(e.array(e.string))})})),X=Pe((function(e){return Te(d(e),e.intersect(e.partial({metadata:re(e)}))(e.intersect(e.partial({context:R(e)}))(e.intersect(e.partial({error:U(e)}))(e.intersect(e.partial({text:B(e)}))(e.intersect(e.partial({withVoiceText:B(e)}))(e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.intersect(e.partial({references:e.readonly(e.array(de(e)))}))(e.intersect(e.partial({changesSummary:Y(e)}))(e.struct({action:e.literal("cheetah:result"),promptId:e.number,usage:ke(e)}))))))))))(e)})),Q=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:setUserState"),state:Ce(e)}))(e)})),J=Pe((function(e){var t;return e.sum("kind")(((t={}).userPrompt=ee(e),t.action=te(e),t))})),ee=Pe((function(e){return e.struct({kind:e.literal("userPrompt"),text:e.string})})),te=Pe((function(e){return e.struct({kind:e.literal("action"),iconUrl:e.string,label:e.string})})),ie=Pe((function(e){return e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.struct({id:e.string,text:ye(e),withVoiceText:ye(e),title:J(e),references:e.readonly(e.array(de(e)))}))})),ne=Pe((function(e){return Te(d(e),e.struct({action:e.literal("cheetah:setHistory"),cards:e.readonly(e.array(ie(e)))}))(e)})),re=Pe((function(e){return e.any})),se=Pe((function(e){return e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.struct({text:e.sensitiveString})))})),oe=Pe((function(e){return e.intersect(e.partial({pageIdHash:e.string}))(e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.intersect(e.partial({items:e.readonly(e.array(se(e)))}))(e.struct({})))))})),ae=Pe((function(e){var t;return e.sum("kind")(((t={}).regular=le(e),t.history=ce(e),t.writerExpert=ue(e),t))})),le=Pe((function(e){return e.struct({kind:e.literal("regular"),text:e.string})})),ce=Pe((function(e){return e.struct({kind:e.literal("history"),text:e.string})})),ue=Pe((function(e){return e.struct({kind:e.literal("writerExpert"),text:e.string,suggestionId:e.string,pname:e.string})})),de=Pe((function(e){return e.intersect(e.partial({url:e.string}))(e.struct({id:e.string,privacyLevel:me(e),title:e.string,iconUrl:e.string}))})),me=Pe((function(e){var t;return e.sum("kind")(((t={}).public=pe(e),t.restricted=he(e),t))})),pe=Pe((function(e){return e.struct({kind:e.literal("public")})})),he=Pe((function(e){return e.struct({kind:e.literal("restricted")})})),ge=Pe((function(e){var t;return e.sum("kind")(((t={}).aiUsageAlert=fe(e),t))})),fe=Pe((function(e){return e.struct({kind:e.literal("aiUsageAlert")})})),ve=Pe((function(e){return e.struct({button:xe(e),tones:e.readonly(e.array(xe(e))),maxTones:e.number})})),ye=Pe((function(e){return Te(h(e),e.struct({}))(e)})),be=Pe((function(e){return e.struct({start:e.number,end:e.number})})),xe=Pe((function(e){return e.struct({iconUrl:e.string,label:e.string,description:e.string})})),Se=Pe((function(e){return e.struct({url:e.string,referenceId:e.string})})),ke=Pe((function(e){return e.struct({promptsRemaining:e.number,promptsAllocated:e.number,refillDate:e.string})})),we=Pe((function(e){return e.struct({inlineQuickReplyEnabled:e.boolean,inlineRewriteEnabled:e.boolean})})),Ce=Pe((function(e){return e.intersect(e.partial({historyItems:e.number}))(e.struct({settings:we(e),usage:ke(e)}))})),_e=Pe((function(e){return e.intersect(e.partial({styles:e.readonly(e.array(ve(e)))}))(e.intersect(e.partial({selectedRole:e.string}))(e.intersect(e.partial({roles:e.readonly(e.array(e.string))}))(e.struct({selectedStyle:e.string,selectedTones:e.readonly(e.array(e.string)),needSetup:e.boolean}))))})),Ie=Pe((function(e){return e.struct({state:e.boolean,label:e.string})})),Ee=Pe((function(e){return e.struct({userName:e.string,myVoiceIsEnabledByDefault:Ie(e),title:e.string,subTitle:e.string,profiles:O(e)})})),Ae=Pe((function(e){var t;return e.sum("action")(((t={})["cheetah:getContext"]=F(e),t["cheetah:action"]=G(e),t["cheetah:setVoice"]=M(e),t["cheetah:setVoiceProfile"]=D(e),t["cheetah:interrupt"]=V(e),t["cheetah:getUserState"]=H(e),t["cheetah:searchReferences"]=L(e),t["cheetah:getHistory"]=K(e),t))})),Oe=Pe((function(e){var t;return e.sum("action")(((t={})["cheetah:invalidateContext"]=j(e),t["cheetah:error"]=$(e),t["cheetah:setContext"]=W(e),t["cheetah:searchReferencesResult"]=Z(e),t["cheetah:chunk"]=q(e),t["cheetah:result"]=X(e),t["cheetah:setUserState"]=Q(e),t["cheetah:setHistory"]=ne(e),t))}));function Re(e){var t=Object.keys(e).map((function(t){return e[t]})),i=t[0],r=t.slice(1);return Pe((function(e){return e.literal.apply(e,(0,n.__spreadArray)([i],r,!1))}))}function Te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pe((function(t){return e.reduce((function(e,i){return t.intersect(i)(e)}))}))}function Pe(e){return o.H(e)}var Ue=(0,l.MZ)(a.n);function Be(e){return function(t){return(0,n.__assign)((0,n.__assign)({},e),t)}}var Ne={URI:s.ov,literal:function(){return s.id()},string:s.id(),number:s.id(),boolean:s.id(),nullable:s.AG,type:s.dt,struct:s.n_,partial:s.r$,record:s.IM,array:s.IX,tuple:s.bc,intersect:s.wf,sum:s.Sm,lazy:function(e,t){return s.Vo(t)},readonly:s.OT}},50687:(e,t,i)=>{var n,r,s,o;i.d(t,{ES:()=>r,cX:()=>n,oS:()=>s,s2:()=>o}),function(e){e.Insertable="insertable",e.NonInsertable="non_insertable"}(n||(n={})),function(e){e.Active="active",e.Snoozed="snoozed"}(r||(r={})),function(e){e.Generic="generic",e.Overflow="overflow",e.PromptsLimitExceeded="promptsLimitExceeded",e.SensitiveContent="sensitiveContent",e.ServerOverloaded="serverOverloaded",e.UnsupportedLanguage="unsupportedLanguage"}(s||(s={})),function(e){e.Ideation="ideation",e.PushRewrite="pushRewrite",e.QuickReply="quickReply",e.QuickRewrite="quickRewrite",e.Rewrite="rewrite"}(o||(o={}))},45930:(e,t,i)=>{i.d(t,{X:()=>r});var n=i(22232),r=function(){function e(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!0),this._capacity=e,this._start=t,this._allowOverflow=i,this._nextId=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._nextId},enumerable:!1,configurable:!0}),e.prototype.newId=function(){var e=this._nextId;if(e>this._capacity){if(!this._allowOverflow)throw new n.ej("ids limit reached: "+this._capacity);this._nextId=e=0}return this._nextId++,e},e.prototype.reset=function(){this._nextId=this._start},e}()},56377:(e,t,i)=>{i.d(t,{L:()=>l});var n,r=i(59312),s=i(27378),o=i(12187),a=i(89894),l=function(e){var t=e.double,i=e.triple,n=e.small;return s.createElement("div",(0,r.__assign)({},(0,o.Sh)(d,!0===t&&p,!0===i&&g,!0===n&&f)))},c=.875,u="spacer",d=a.ux.joinClasses([u,a.ux.style({margin:0,minHeight:a.ux.rem(c),maxHeight:a.ux.rem(1),width:a.ux.percent(100),height:a.ux.rem(1)})]),m="spacerDouble",p=a.ux.joinClasses([m,a.ux.style({minHeight:a.ux.rem(1.75),maxHeight:a.ux.rem(2),height:a.ux.rem(2)})]),h="spacerTriple",g=a.ux.joinClasses([h,a.ux.style({minHeight:a.ux.rem(2.625),maxHeight:a.ux.rem(3),height:a.ux.rem(3)})]),f=a.ux.style({$nest:(n={},n["&.".concat(u)]={minHeight:a.ux.rem(.4375),maxHeight:a.ux.rem(.5),height:a.ux.rem(.5)},n["&.".concat(m)]={minHeight:a.ux.rem(c),maxHeight:a.ux.rem(1),height:a.ux.rem(1)},n["&.".concat(h)]={minHeight:a.ux.rem(1.3125),maxHeight:a.ux.rem(1.5),height:a.ux.rem(1.5)},n)})},24782:(e,t)=>{t.byteLength=function(e){var t=l(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,s=l(e),o=s[0],a=s[1],c=new r(function(e,t,i){return 3*(t+i)/4-i}(0,o,a)),u=0,d=a>0?o-4:o;for(i=0;i<d;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===a&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,c[u++]=255&t);1===a&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],o=16383,a=0,l=n-r;a<l;a+=o)s.push(c(e,a,a+o>l?l:a+o));1===r?(t=e[n-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)i[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function c(e,t,n){for(var r,s,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},30816:(e,t,i)=>{var n=i(24782),r=i(78898),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.INSPECT_MAX_BYTES=50;var o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,i){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return c(e,t,i)}function c(e,t,i){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var i=0|g(e,t),n=a(i),r=n.write(e,t);r!==i&&(n=n.slice(0,r));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(D(e,Uint8Array)){var t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(D(e,ArrayBuffer)||e&&D(e.buffer,ArrayBuffer))return p(e,t,i);if("undefined"!=typeof SharedArrayBuffer&&(D(e,SharedArrayBuffer)||e&&D(e.buffer,SharedArrayBuffer)))return p(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,i);var r=function(e){if(l.isBuffer(e)){var t=0|h(e.length),i=a(t);return 0===i.length||e.copy(i,0,0,t),i}if(void 0!==e.length)return"number"!=typeof e.length||V(e.length)?a(0):m(e);if("Buffer"===e.type&&Array.isArray(e.data))return m(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return u(e),a(e<0?0:0|h(e))}function m(e){for(var t=e.length<0?0:0|h(e.length),i=a(t),n=0;n<t;n+=1)i[n]=255&e[n];return i}function p(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),Object.setPrototypeOf(n,l.prototype),n}function h(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function g(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||D(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return G(e).length;default:if(r)return n?-1:j(e).length;t=(""+t).toLowerCase(),r=!0}}function f(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return A(this,t,i);case"latin1":case"binary":return O(this,t,i);case"base64":return _(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function y(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),V(i=+i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:b(e,t,i,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):b(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,i,n,r){var s,o=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,i/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var u=-1;for(s=i;s<a;s++)if(c(e,s)===c(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(i+l>a&&(i=a-l),s=i;s>=0;s--){for(var d=!0,m=0;m<l;m++)if(c(e,s+m)!==c(t,m)){d=!1;break}if(d)return s}return-1}function x(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(t.substr(2*o,2),16);if(V(a))return o;e[i+o]=a}return o}function S(e,t,i,n){return M(j(t,e.length-i),e,i,n)}function k(e,t,i,n){return M(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function w(e,t,i,n){return M(G(t),e,i,n)}function C(e,t,i,n){return M(function(e,t){for(var i,n,r,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(i=e.charCodeAt(o))>>8,r=i%256,s.push(r),s.push(n);return s}(t,e.length-i),e,i,n)}function _(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function I(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var s,o,a,l,c=e[r],u=null,d=c>239?4:c>223?3:c>191?2:1;if(r+d<=i)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(s=e[r+1]))&&(l=(31&c)<<6|63&s)>127&&(u=l);break;case 3:s=e[r+1],o=e[r+2],128==(192&s)&&128==(192&o)&&(l=(15&c)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:s=e[r+1],o=e[r+2],a=e[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(l=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=d}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);var i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=E));return i}(n)}l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,i){return c(e,t,i)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,i){return function(e,t,i){return u(e),e<=0?a(e):void 0!==t?"string"==typeof i?a(e).fill(t,i):a(e).fill(t):a(e)}(e,t,i)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(D(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),D(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,r=0,s=Math.min(i,n);r<s;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=l.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var s=e[i];if(D(s,Uint8Array))r+s.length>n.length?l.from(s).copy(n,r):Uint8Array.prototype.set.call(n,s,r);else{if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r)}r+=s.length}return n},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):f.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(e,t,i,n,r){if(D(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(t>>>=0),a=Math.min(s,o),c=this.slice(n,r),u=e.slice(t,i),d=0;d<a;++d)if(c[d]!==u[d]){s=c[d],o=u[d];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},l.prototype.indexOf=function(e,t,i){return y(this,e,t,i,!0)},l.prototype.lastIndexOf=function(e,t,i){return y(this,e,t,i,!1)},l.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return x(this,e,t,i);case"utf8":case"utf-8":return S(this,e,t,i);case"ascii":case"latin1":case"binary":return k(this,e,t,i);case"base64":return w(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function A(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function O(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function R(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var r="",s=t;s<i;++s)r+=H[e[s]];return r}function T(e,t,i){for(var n=e.slice(t,i),r="",s=0;s<n.length-1;s+=2)r+=String.fromCharCode(n[s]+256*n[s+1]);return r}function P(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,i,n,r,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function B(e,t,i,n,r,s){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function N(e,t,i,n,s){return t=+t,i>>>=0,s||B(e,0,i,4),r.write(e,t,i,n,23,4),i+4}function z(e,t,i,n,s){return t=+t,i>>>=0,s||B(e,0,i,8),r.write(e,t,i,n,52,8),i+8}l.prototype.slice=function(e,t){var i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var n=t,r=1,s=this[e+--n];n>0&&(r*=256);)s+=this[e+--n]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,i,n){(e=+e,t>>>=0,i>>>=0,n)||U(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,s=0;for(this[t]=255&e;++s<i&&(r*=256);)this[t+s]=e/r&255;return t+i},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,i,n){(e=+e,t>>>=0,i>>>=0,n)||U(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+i},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);U(this,e,t,i,r-1,-r)}var s=0,o=1,a=0;for(this[t]=255&e;++s<i&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i},l.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);U(this,e,t,i,r-1,-r)}var s=i-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i},l.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,i){return N(this,e,t,!0,i)},l.prototype.writeFloatBE=function(e,t,i){return N(this,e,t,!1,i)},l.prototype.writeDoubleLE=function(e,t,i){return z(this,e,t,!0,i)},l.prototype.writeDoubleBE=function(e,t,i){return z(this,e,t,!1,i)},l.prototype.copy=function(e,t,i,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r=n-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),r},l.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var r=e.charCodeAt(0);("utf8"===n&&r<128||"latin1"===n)&&(e=r)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var s;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var o=l.isBuffer(e)?e:l.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var F=/[^+/0-9A-Za-z-_]/g;function j(e,t){var i;t=t||1/0;for(var n=e.length,r=null,s=[],o=0;o<n;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function M(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}function D(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function V(e){return e!=e}var H=function(){for(var e="0123456789abcdef",t=new Array(256),i=0;i<16;++i)for(var n=16*i,r=0;r<16;++r)t[n+r]=e[i]+e[r];return t}()},13853:(e,t,i)=>{i.d(t,{$T:()=>_,AO:()=>a,DZ:()=>R,Eh:()=>l,G:()=>c,G0:()=>f,KX:()=>p,Lf:()=>x,Lx:()=>w,Od:()=>I,UI:()=>u,ZN:()=>s,e5:()=>b,hX:()=>h,jV:()=>v,nI:()=>E,oA:()=>A,oP:()=>S,ri:()=>C,t9:()=>g,tS:()=>m,tV:()=>y,u4:()=>k,xu:()=>O,yW:()=>d});var n=i(73975),r=i(57050);function s(e){return{show:function(t){var i="";return t.forEach((function(t){i+=e.show(t)+", "})),""!==i&&(i=i.substring(0,i.length-2)),"new Set(["+i+"])"}}}var o=new Set;function a(e){return function(t){var i=[];return t.forEach((function(e){return i.push(e)})),i.sort(e.compare)}}function l(e){var t=p(e);return(0,n.f7)((function(e,i){return t(e,i)&&t(i,e)}))}function c(e){return function(t){for(var i,n=t.values(),r=!1;!r&&!(i=n.next()).done;)r=e(i.value);return r}}function u(e){var t=g(e);return function(e){return function(i){var n=new Set;return i.forEach((function(i){var r=e(i);t(r,n)||n.add(r)})),n}}}function d(e){return(0,r.ff)(c((0,r.ff)(e)))}function m(e){var t=g(e);return function(e){return function(i){var n=new Set;return i.forEach((function(i){e(i).forEach((function(e){t(e,n)||n.add(e)}))})),n}}}function p(e){var t=g(e);return function(i,n){if(void 0===n){var r=p(e);return function(e){return r(e,i)}}return d((function(e){return t(e,n)}))(i)}}function h(e){return function(t){for(var i,n=t.values(),r=new Set;!(i=n.next()).done;){var s=i.value;e(s)&&r.add(s)}return r}}function g(e){return function(t,i){if(void 0===i){var n=g(e);return function(e){return n(t,e)}}for(var r,s=i.values(),o=!1;!o&&!(r=s.next()).done;)o=e.equals(t,r.value);return o}}function f(e){var t=g(e);return function(i,n){if(void 0===n){var r=f(e);return function(e){return r(i,e)}}if(i===o)return n;if(n===o)return i;var s=new Set(i);return n.forEach((function(e){t(e,s)||s.add(e)})),s}}function v(e){var t=g(e);return function(i,n){if(void 0===n){var r=v(e);return function(e){return r(e,i)}}if(i===o||n===o)return o;var s=new Set;return i.forEach((function(e){t(e,n)&&s.add(e)})),s}}function y(e,t){return function(i){return function(n){for(var r,s=n.values(),o=new Set,a=new Set,l=g(e),c=g(t);!(r=s.next()).done;){var u=i(r.value);switch(u._tag){case"Left":l(u.left,o)||o.add(u.left);break;case"Right":c(u.right,a)||a.add(u.right)}}return{left:o,right:a}}}}function b(e){var t=g(e);return function(i,n){if(void 0===n){var r=b(e);return function(e){return r(e,i)}}return h((function(e){return!t(e,n)}))(i)}}function x(e){return{concat:f(e),empty:o}}function S(e){return{concat:v(e)}}function k(e){var t=a(e);return function(e,i){return function(n){return t(n).reduce(i,e)}}}function w(e,t){var i=a(e);return function(e){return function(n){return i(n).reduce((function(i,n){return t.concat(i,e(n))}),t.empty)}}}function C(e){return new Set([e])}function _(e){var t=g(e);return function(e){return function(i){if(t(e)(i))return i;var n=new Set(i);return n.add(e),n}}}function I(e){return function(t){return function(i){return h((function(i){return!e.equals(t,i)}))(i)}}}function E(e){return function(t){for(var i=t.length,n=new Set,r=g(e),s=0;s<i;s++){var o=t[s];r(o,n)||n.add(o)}return n}}function A(e){return R(e)(r.yR)}function O(e,t){return function(i){var n=g(e),r=g(t),s=new Set,o=new Set;return i.forEach((function(e){switch(e._tag){case"Left":n(e.left,s)||s.add(e.left);break;case"Right":r(e.right,o)||o.add(e.right)}})),{left:s,right:o}}}function R(e){var t=g(e);return function(e){return function(i){var n=new Set;return i.forEach((function(i){var r=e(i);"Some"!==r._tag||t(r.value,n)||n.add(r.value)})),n}}}},78898:(e,t)=>{t.read=function(e,t,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,c=l>>1,u=-7,d=i?r-1:0,m=i?-1:1,p=e[t+d];for(d+=m,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+e[t+d],d+=m,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+d],d+=m,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=c}return(p?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,i,n,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,d=u>>1,m=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?m/l:m*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(t*l-1)*Math.pow(2,r),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;e[i+p]=255&a,p+=h,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[i+p]=255&o,p+=h,o/=256,c-=8);e[i+p-h]|=128*g}}}]);