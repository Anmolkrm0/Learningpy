import{a as ue,b as fe}from"./B3S7E6KC.js";import{a as W}from"./7WIRVMYB.js";import{a as ge}from"./OJNVQ3UZ.js";import{a as le,b as ce}from"./FSE6QFO2.js";import{a as xe,b as he}from"./BKBDUG45.js";import{a as N}from"./EWL5FLGU.js";import{a as T}from"./6MYXUAHL.js";import{a as G}from"./UKCA3OWL.js";import{a as v,f as D,v as $}from"./TPLPQCTH.js";import"./XS6LGTM5.js";import"./IA5SYYCH.js";import"./O7EBOFNZ.js";import"./6RQCUKHB.js";import"./CAIW4P6U.js";import"./U6WUZGPQ.js";import"./TXJVG63N.js";import{a as de}from"./XSN3FURQ.js";import"./QDB4CE2P.js";import"./ONY4XELL.js";import{a as te}from"./XYFFQRMZ.js";import{b as pe}from"./DYUK4WZS.js";import{I as b,_ as me,z as ne}from"./R7ESC43Z.js";import{c as F}from"./F7SGTV27.js";import"./5QWZ7UE4.js";import{d as De,i as Le,l as z}from"./FOUKVBQX.js";import"./NXGYST7J.js";import"./LP276KYG.js";import"./RO4X7EGV.js";import"./2N2SG5RC.js";import"./NNU75GHZ.js";import"./QJSKL7UD.js";import"./KXHDIDXQ.js";import{d as se,h as ie}from"./XYZAUIQ2.js";import{c as j}from"./QONG524O.js";import"./ES4G5FSE.js";import"./6UCR6JSM.js";import{a as E,c as re}from"./IPNS2UUO.js";import{d as B}from"./FRAG5SMK.js";import"./HYW7LR6S.js";import"./6ER2OOH3.js";import{a as r,b as oe,u as x}from"./DRCUZC3I.js";import"./RSO45DR6.js";import"./TY7U7FR6.js";import"./PF3XPTWR.js";import{n as ee}from"./MWTIYFYH.js";import{j as ae}from"./IQBPRLVE.js";import"./HEBGDMW5.js";import"./6LS5XNTR.js";import"./W2F53U5Z.js";import{h as P}from"./TYBXNNUH.js";import"./DUIWQHLB.js";import"./KG5SJQNS.js";import"./HQC5KEMG.js";import"./AAMCXCLO.js";import{c as w}from"./CAPNT4IP.js";import"./YN4XY6JW.js";import{M as R,a as k,n as L}from"./IPAGS25B.js";import"./3JX3VARJ.js";import{c as X,f as y}from"./PQ35KENF.js";var ye=X(H=>{"use strict";var Pe=oe();Object.defineProperty(H,"__esModule",{value:!0});H.default=void 0;var Ne=Pe(re()),We=ee(),He=(0,Ne.default)((0,We.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");H.default=He});var we=X(O=>{"use strict";var qe=oe();Object.defineProperty(O,"__esModule",{value:!0});O.default=void 0;var Ve=qe(re()),Je=ee(),Ye=(0,Ve.default)((0,Je.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"}),"Code");O.default=Ye});var m=y(k());var S=y(k());var Se=y(ye()),Ce=y(De());var Oe=["www.linkedin.com"],Ue=i=>{let{onEdit:e,onSave:s,editAble:d,message:n}=i,{t:o}=w(["common","client"]),[c,p]=(0,S.useState)("done"),h=(0,S.useMemo)(()=>n.extra.meta?.messageVisibleText||n.text,[n]);return S.default.createElement(r,{direction:"row",alignItems:"center",width:"100%",justifyContent:"flex-end"},S.default.createElement(T,{copyText:h,onCopy:()=>{i.onCopy?.(),Oe.includes(window.location.host)&&setTimeout(P,1)}}),c==="done"&&d&&S.default.createElement(G,{title:o("common:edit"),onClick:()=>{e(),p("edit")}},S.default.createElement(Se.default,{sx:{fontSize:16}})),c==="edit"&&d&&S.default.createElement(G,{title:o("common:save"),onClick:()=>{s(),p("done")}},S.default.createElement(Ce.default,{sx:{fontSize:16}})))},Ie=Ue;var C=y(k());var be=y(Le());var je=["www.linkedin.com"],Ge=i=>{let{t:e}=w(["common","client"]),{message:s,insertAble:d}=i,n=(0,C.useMemo)(()=>d,[d]),o=C.default.useRef(null),c=(0,C.useMemo)(()=>fe(s),[s]);return C.default.createElement(r,{direction:"row",alignItems:"center",spacing:1,ref:o},n&&C.default.createElement(B,{disableElevation:!0,size:"small",variant:"contained",title:"insert to draft",startIcon:C.default.createElement(be.default,null),onClick:()=>{}},e("client:sidebar__button__insert")),C.default.createElement(T,{className:"max-ai__actions__button--copy",copyText:c,onCopy:()=>{i.onCopy?.(),je.includes(window.location.host)&&setTimeout(P,1)}}),i.useChatGPTAble&&C.default.createElement(ue,{className:"max-ai__actions__button--use-max-ai",iconButton:!0,onBeforeShowContextMenu:()=>({template:c,target:o.current?.parentElement})}))},ke=Ge;var A=y(k());var $e=i=>{let{onRetry:e,message:s}=i,{t:d}=w(["common","client"]),{currentUserPlan:n,userInfo:o}=ne(),c=s.extra.systemMessageType||"normal";return(0,A.useEffect)(()=>{c==="needUpgrade"&&(n.name==="pro"||n.name==="elite")&&pe("[Pricing] Pro show pricing card",JSON.stringify({message:s.text,user:o,plan:n}),{uuid:"7a04bc02-6155-4253-bcdb-ade3db6de492"})},[n.name,c]),A.default.createElement(r,{direction:"row",alignItems:"center",flexWrap:"wrap",gap:1},c==="needUpgrade"&&A.default.createElement(B,{fullWidth:!0,sx:{height:48,fontSize:"16px",fontWeight:500},variant:"contained",color:"primary",target:"_blank",href:`${R}/pricing`,onClick:p=>{s.extra.systemMessageType==="needUpgrade"&&s.extra.permissionSceneType&&me("click",s.extra.permissionSceneType)}},d("client:sidebar__button__upgrade_to_pro")),c==="normal"&&s.parentMessageId&&A.default.createElement(B,{size:"small",variant:"outlined",color:"error",onClick:e,sx:{border:"1px solid rgba(244, 67, 54, 0.5)",color:"#f44336"}},d("client:sidebar__button__retry")))},Me=$e;var I=y(k());var ve=y(we());var Ze=({message:i})=>{let e=(0,I.useMemo)(()=>JSON.stringify(i,null,2),[i]);return I.default.createElement(W,null,I.default.createElement(E,{position:"absolute",top:16,left:16},I.default.createElement(ie,{title:I.default.createElement(r,null,I.default.createElement(T,{copyText:e}),I.default.createElement("pre",{style:{fontSize:"12px",maxHeight:"500px",overflowY:"auto"}},e))},I.default.createElement(ve.default,null))))},Te=Ze;var t=y(k());var f=y(k());var Ke=i=>{let{messageIsComplete:e}=i,{title:s,icon:d,value:n,valueType:o="text",status:c}=i.copilot,p=(0,f.useMemo)(()=>{if(!n)return null;switch(o){case"text":return f.default.createElement(v,{variant:"outlined",sx:{px:1}},f.default.createElement(x,{fontSize:14,color:"text.primary",noWrap:!0,maxWidth:256},String(n)));case"tags":{let h=[];return typeof n=="string"?h=n.split(","):Array.isArray(n)&&(h=n),f.default.createElement(r,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap"},h.map((g,u)=>f.default.createElement(v,{key:g,variant:"outlined",sx:{px:1}},f.default.createElement(x,{noWrap:!0,maxWidth:160,fontSize:14,color:"text.primary"},g))))}default:return null}},[n,o]);return f.default.createElement(r,{spacing:.5},f.default.createElement(r,{spacing:1,direction:"row",alignItems:"center"},f.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16},c==="loading"&&!e?f.default.createElement(F,{size:16}):f.default.createElement(z,{sx:{color:"primary.main",fontSize:16},icon:d})),f.default.createElement(x,{fontSize:16,color:"text.primary",noWrap:!0,sx:{p:0}},s)),n&&f.default.createElement(r,{spacing:1,direction:"row",alignItems:"center"},f.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16}),p))},Ae=Ke;var a=y(k());var Qe=i=>{let e=ge(),{sourceLinks:s,loading:d}=i,[n,o]=(0,a.useState)(!1),c=(0,a.useMemo)(()=>n?s:s.length>6?s.slice(0,5):s,[n,s]),p=(0,a.useMemo)(()=>n?[]:s.length>6?s.slice(5).map(g=>g.favicon).filter(Boolean):[],[n,s]),h=(0,a.useMemo)(()=>e==="xs"||e==="sm"?6:e==="md"?4:e==="lg"||e==="xl"?3:6,[e]);return a.default.createElement(D,{container:!0,spacing:1,sx:{ml:"-8px!important"}},d?Array(ae).fill("").map((g,u)=>a.default.createElement(D,{item:!0,xs:h,key:u},a.default.createElement(b,{variant:"rounded",width:"100%",height:60}))):a.default.createElement(a.default.Fragment,null,c.map((g,u)=>a.default.createElement(D,{item:!0,xs:h,key:g.title},a.default.createElement(v,{variant:"outlined"},a.default.createElement(j,{href:g.url,target:"_blank",underline:"none"},a.default.createElement(r,{p:1,spacing:.5},a.default.createElement(x,{fontSize:14,color:"text.primary",noWrap:!0,sx:{p:0}},g.title),a.default.createElement(r,{direction:"row",alignItems:"center",spacing:.5},a.default.createElement(E,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},a.default.createElement("img",{src:g.favicon,alt:g?.from,width:"100%",height:"100%"})),a.default.createElement(x,{fontSize:12,color:"text.secondary",noWrap:!0},g?.from),a.default.createElement(x,{fontSize:12,color:"text.secondary",flexShrink:0},"\xB7 ",u+1))))))),!n&&s.length>6&&a.default.createElement(D,{item:!0,xs:h,onClick:()=>{o(!0)}},a.default.createElement(v,{variant:"outlined"},a.default.createElement(j,{href:"#",underline:"none"},a.default.createElement(r,{p:1,spacing:1},a.default.createElement(r,{direction:"row",spacing:1},p.map((g,u)=>a.default.createElement(E,{key:u+g,width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},a.default.createElement("img",{src:g,width:"100%",height:"100%"})))),a.default.createElement(r,{direction:"row",alignItems:"center",spacing:.5},a.default.createElement(x,{fontSize:12,color:"text.secondary",flexShrink:0},"View ",p.length," more"))))))))},_e=Qe;var Xe=i=>class extends t.Component{constructor(s){super(s),this.state={hasError:!1}}componentDidCatch(s,d){this.setState({hasError:!0})}render(){return this.state.hasError?t.default.createElement(i,{...this.props,liteMode:!0}):t.default.createElement(i,{...this.props})}},q=i=>{let{fontSx:e}=i,{title:s,titleIcon:d,titleIconSize:n}=i.title;return t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},d&&t.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16},t.default.createElement(z,{sx:{color:"primary.main",fontSize:n||18},icon:d})),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18,...e}},s))},Re=i=>{let{message:e,isDarkMode:s,liteMode:d=!1}=i,n=e.originalMessage!==void 0&&!d,o=(0,t.useMemo)(()=>{let p={title:e.originalMessage?.metadata?.title,copilot:e.originalMessage?.metadata?.copilot,sources:e.originalMessage?.metadata?.sources,sourcesLoading:e.originalMessage?.metadata?.sources?.status==="loading",sourcesHasContent:!1,answer:e.text,content:e.originalMessage?.content,messageIsComplete:e.originalMessage?.metadata?.isComplete,deepDive:e.originalMessage?.metadata?.deepDive};return Object.keys(p?.sources||{}).length>1&&(p.sourcesHasContent=!0),e.originalMessage?.content?.text&&(p.answer=le(e.originalMessage.content.text,{noResponseTag:!0,noSummaryTag:!0})||e.text),p.answer=p.answer.replace(/^\s+/,""),p},[e]),c=(0,t.useMemo)(()=>!o.answer,[o.answer]);return t.default.createElement(t.default.Fragment,null,n?t.default.createElement(r,{spacing:2},o.title&&t.default.createElement(q,{title:o.title,fontSx:{fontWeight:"bold",fontSize:"28px",color:"text.primary"}}),o.copilot&&t.default.createElement(r,{spacing:1},o.copilot?.title&&t.default.createElement(q,{title:o.copilot.title}),t.default.createElement(r,{spacing:1},o.copilot.steps.map(p=>t.default.createElement(Ae,{messageIsComplete:o.messageIsComplete,copilot:p,key:p.title})))),o.sources&&o.sourcesHasContent&&t.default.createElement(r,{spacing:1},t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},o.sourcesLoading&&!o.messageIsComplete?t.default.createElement(F,{size:18}):t.default.createElement(he,{sx:{color:"primary.main",fontSize:20}}),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18}},"Sources")),t.default.createElement(_e,{sourceLinks:o.sources.links||[],loading:o.sourcesLoading})),o.content&&t.default.createElement(r,null,o.messageIsComplete?t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},o.content.title?.titleIcon?t.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16},t.default.createElement(z,{sx:{color:"primary.main",fontSize:o.content.title?.titleIconSize||18},icon:o.content.title?.titleIcon})):t.default.createElement(xe,{sx:{color:"primary.main",fontSize:20}}),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18,lineHeight:"20px"}},o.content.title?.title||"Answer")):t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},t.default.createElement(F,{size:18}),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18,lineHeight:"20px"}},"Writing")),c&&!o.messageIsComplete?t.default.createElement(r,null,t.default.createElement(b,{animation:"wave",height:10}),t.default.createElement(b,{animation:"wave",height:10}),t.default.createElement(b,{animation:"wave",height:10}),t.default.createElement(b,{animation:"wave",height:10}),t.default.createElement(b,{animation:"wave",height:10}),t.default.createElement(b,{animation:"wave",height:10})):t.default.createElement("div",{className:`markdown-body ${s?"markdown-body-dark":""}`},t.default.createElement(N,null,o.answer))),o.deepDive&&t.default.createElement(r,{spacing:1},o.deepDive.title&&t.default.createElement(q,{title:o.deepDive.title}),t.default.createElement("div",{className:`markdown-body ${s?"markdown-body-dark":""}`},t.default.createElement(N,null,o.deepDive.value)))):t.default.createElement("div",{className:`markdown-body ${s?"markdown-body-dark":""}`},t.default.createElement(N,null,o.answer)))},Ee=Xe(Re);var et=m.default.lazy(()=>import("./6KKZPPYT.js")),Be=i=>i.type==="system"?i.text:i?.extra?.meta?.messageVisibleText||i.text||"",tt=i=>{let{message:e,editAble:s,insertAble:d,replaceAble:n,useChatGPTAble:o,onSave:c,onCopy:p,onRetry:h,className:g}=i,{isDarkMode:u}=te(),[V,Fe]=(0,m.useState)(()=>Be(e)),[J,Y]=(0,m.useState)(!1),[Z,K]=(0,m.useState)(!1),_=(0,m.useRef)(null),ze=(0,m.useMemo)(()=>{let l=Z?{"& *":{userSelect:"text!important"}}:{"& *":{userSelect:"none!important"}};return e.type==="ai"?{borderRadius:"8px",borderBottomLeftRadius:0,color:u?"#FFFFFFDE":"rgba(0,0,0,0.87)",border:"1px solid",borderColor:u?"customColor.borderColor":"transparent",bgcolor:u?"rgba(255, 255, 255, 0.04)":"rgb(233,233,235)!important",...l}:e.type==="user"||e.type==="third"?{flexDirection:"row",justifyContent:"flex-start",bgcolor:()=>u?"#6B23C259 !important":"#F1E2FD !important",border:"1px solid",borderColor:u?"customColor.borderColor":"transparent",color:u?"#FFFFFFDE":"rgba(0,0,0,0.87)!important",maxWidth:"100%",width:"auto",borderRadius:"8px",borderBottomRightRadius:0,flexWrap:"wrap",ml:"auto",mr:"0",overflow:"hidden",p:1,...l}:e?.extra?.systemMessageType==="needUpgrade"?{borderRadius:"8px",bgcolor:"#333","& > div":{width:"100%",maxWidth:450,mx:"auto!important",bgcolor:"#333",padding:0,"& *":{color:"#FFFFFF!important"}},...l}:{borderRadius:"8px",border:{info:"1px solid #03a9f4!important",error:"1px solid rgb(239, 83, 80)!important",success:"1px solid #34A853!important"}[e?.extra?.status]||"1px solid #03a9f4!important",bgcolor:"background.paper",...l}},[e.type,Z,u]);(0,m.useEffect)(()=>{Fe(Be(e))},[e.text]);let Q=(0,m.useMemo)(()=>{if(e.type==="user"){let l=e?.extra?.meta?.attachments;if(l&&l.length)return l.filter(M=>M.uploadStatus==="success")}return[]},[e]);return m.default.createElement(r,{className:g,sx:{width:"100%",p:1,color:"text.primary",position:"relative","& .chat-message--text":{textAlign:"left",fontSize:"16px",lineHeight:1.4,fontWeight:400}},onCopy:l=>{l.preventDefault(),l.stopPropagation();let M=window.getSelection();if(M&&M.toString().trim()){let U=M.toString().trim();U&&navigator.clipboard.writeText(U)}},onMouseEnter:()=>{_.current&&clearTimeout(_.current),K(!0)},onMouseLeave:()=>{_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{K(!1);let l=window.getSelection();l&&l.toString().trim()&&l.focusNode&&l.focusNode.isSameNode(document.body)&&l.removeAllRanges()},500)},spacing:1,key:e.messageId},m.default.createElement(W,null,m.default.createElement(Te,{message:e})),m.default.createElement(r,{className:"chat-message--text",whiteSpace:"pre-wrap",width:"100%",spacing:1,p:1,sx:{wordBreak:"break-word",...ze}},m.default.createElement(de,null,e.type==="system"?m.default.createElement(se,{severity:e?.extra?.status||"info",sx:{p:1,"& .MuiAlert-message":{p:0},"& > div:first-child":{display:"none"},"& .markdown-body":{"& > p:first-child":{mt:0}}},icon:m.default.createElement(m.default.Fragment,null)},m.default.createElement("div",{className:`markdown-body ${u?"markdown-body-dark":""}`},m.default.createElement(et,null,V.replace(/^\s+/,"")))):m.default.createElement(r,{className:"chat-message--text",id:`${L}_chat_message_${e.messageId}`,contentEditable:J,whiteSpace:"pre-wrap",sx:{wordBreak:"break-word",borderColor:"primary.main",borderStyle:"solid",borderWidth:J?1:0}},e.type==="user"&&Q.length>0&&m.default.createElement(ce,{size:"small",direction:"row",disabledRemove:!0,sx:{mb:1},files:Q}),e.type==="user"&&V.replace(/^\s+/,""),(e.type==="third"||e.type==="ai")&&m.default.createElement(Ee,{isDarkMode:u,message:e}))),e.type==="user"&&m.default.createElement(Ie,{editAble:s,onCopy:p,message:e,onSave:()=>{Y(!1);let l=document.getElementById(`${L}_chat_message_${e.messageId}`);c&&c(l?.innerText||e.text||"")},onEdit:()=>{Y(!0),setTimeout(()=>{let l=document.getElementById(`${L}_chat_message_${e.messageId}`);l&&l.focus()},0)}}),e.type==="ai"&&m.default.createElement(ke,{insertAble:d,replaceAble:n,useChatGPTAble:o,onCopy:p,message:e}),e.type==="system"&&m.default.createElement(Me,{onRetry:()=>{e.parentMessageId&&h&&h(e.parentMessageId)},message:e})))},bo=tt;export{bo as default};
