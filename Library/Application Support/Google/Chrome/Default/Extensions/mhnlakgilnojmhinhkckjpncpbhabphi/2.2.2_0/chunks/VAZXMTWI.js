import{c as Ei,h as $n}from"./3ULVSIIZ.js";import{a as Va}from"./JMXOINXE.js";import{d as Vn}from"./VTSHHT45.js";import{T as Ft,g as Bt}from"./DY5NX2CV.js";import{e as Dt}from"./3XSPDXYF.js";import{a as Ya}from"./XPQQBCXB.js";import{c as xi,e as Ci,f as Da}from"./JOBG3ISB.js";import{a as Nr,d as La}from"./CQO467EU.js";import{a as Oa}from"./EYWU5WEI.js";import{a as Wp,d as ka,h as ur,i as zn,j as Na}from"./GQJKJJWP.js";import{b as Wn,c as Sa,d as Ea,e as wa,i as Ia,j as Pa,k as _a,l as Aa,m as Ra,p as Ma}from"./NDBRMG4E.js";import{c as qe}from"./QIXLAUXQ.js";import{c as Un,h as Ti}from"./6KDU3L24.js";import{a as cr}from"./OBYCD3QX.js";import{a as ye,b as Up,c as bi}from"./BXGPN2X7.js";import{d as Qt}from"./VMA5WMPP.js";import{D as Ca,a as W,b as vi,i as ba,o as Hp,q as Nt,r as Xe,u as $,v as xa,y as Ta}from"./SYZGD7UF.js";import{d as Ys,e as Ks,g as Mn,t as Xs}from"./QZNWBGPK.js";import{B as We,C as kn,D as ui,E as pe,b as jt,e as B,f as Yt,i as Ue,j as Re,l as Mr,m as Xt,x as js}from"./QZVUH6Z4.js";import{a as Js,b as Gn,da as za,e as Ba,ea as qa,f as Fa,k as zp,ka as ja,l as Vp,m as Gp,n as Ha,o as Ua,p as Si,q as Wa}from"./TN74TYZV.js";import{b as Qs,e as Dn,f as aa,g as hi,h as la,i as yi,j as ca,k as Bn,m as fa,n as ma,p as ga,q as ha,r as _e,s as ya,v as va,x as bt,y as Or}from"./JBQIPS5C.js";import{b as Ga,f as $a}from"./AN4BH4LP.js";import{a as Ht}from"./CVYR3XXR.js";import{a as ft}from"./M6G54ME7.js";import{d as kr,e as Fn,g as Lr,h as ua,i as pa,k as Hn,m as da}from"./DAZIVUKN.js";import{C as lr,L as Lt,M as dt,P as oa,S as ia,T as sa,Y as On,Z as Nn,a as ne,e as ue,f as Zs,h as ae,i as ea,j as pi,n as ar,o as di,p as fi,r as mi,s as gi,t as ta,v as Ln,y as ra,z as na}from"./OKNPJCGL.js";import{a as Ot,c as ve}from"./QPPETRF6.js";import{d as de}from"./OPO7MVAW.js";import{I as qs,J as He,K as ir,L as Kt,S as Rn,T as sr,U as vt,a as zs,c as Ce,d as Vs,e as Oe,f as ie,g as pt,p as An,q as Gs,r as $s,s as li,w as ci}from"./2XMGLZMD.js";import{a as z}from"./64D36THL.js";import{a as _n}from"./3JX3VARJ.js";import{c as Pn,d as Fp,e as ai,f as C}from"./PQ35KENF.js";var Ri=Pn(Zn=>{"use strict";var fd=vi();Object.defineProperty(Zn,"__esModule",{value:!0});Zn.default=void 0;var md=fd(bi()),gd=Re(),hd=(0,md.default)((0,gd.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}),"OpenInNew");Zn.default=hd});var Cl=Pn(eo=>{"use strict";var Ed=vi();Object.defineProperty(eo,"__esModule",{value:!0});eo.default=void 0;var wd=Ed(bi()),Id=Re(),Pd=(0,wd.default)((0,Id.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");eo.default=Pd});var es=Pn(vo=>{"use strict";var Xf=vi();Object.defineProperty(vo,"__esModule",{value:!0});vo.default=void 0;var Qf=Xf(bi()),Jf=Re(),Zf=(0,Qf.default)((0,Jf.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown");vo.default=Zf});var yp=Pn((Ms,ks)=>{(function(e,t){typeof Ms=="object"&&typeof ks<"u"?ks.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_relativeTime=t()})(Ms,function(){"use strict";return function(e,t,r){e=e||{};var n=t.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function i(l,a,c,u){return n.fromToBase(l,a,c,u)}r.en.relativeTime=o,n.fromToBase=function(l,a,c,u,p){for(var f,d,g,m=c.$locale().relativeTime||o,v=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],h=v.length,b=0;b<h;b+=1){var x=v[b];x.d&&(f=u?r(l).diff(c,x.d,!0):c.diff(l,x.d,!0));var w=(e.rounding||Math.round)(Math.abs(f));if(g=f>0,w<=x.r||!x.r){w<=1&&b>0&&(x=v[b-1]);var T=m[x.l];p&&(w=p(""+w)),d=typeof T=="string"?T.replace("%d",w):T(w,a,x.l,g);break}}if(a)return d;var P=g?m.future:m.past;return typeof P=="function"?P(d):P.replace("%s",d)},n.to=function(l,a){return i(l,a,this,!0)},n.from=function(l,a){return i(l,a,this)};var s=function(l){return l.$u?r.utc():r()};n.toNow=function(l){return this.to(s(this),l)},n.fromNow=function(l){return this.from(s(this),l)}}})});var Qa="https://chat.openai.com",qn="MaxAI.me",xt=(e,t,r,n)=>fetch(`${Qa}${r}`,{method:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:n===void 0?void 0:JSON.stringify(n)}),$p=async e=>{let{uuid:t}=e;try{let r=await Dr();return{success:!0,data:(await(await xt(r,"GET",`/backend-api/files/${t}/download`)).json())?.download_url}}catch{return{success:!1,data:""}}},qp=async e=>{let{conversationId:t,message_id:r,sandbox_path:n}=e,o=`https://chat.openai.com/c/${t}`;try{let i=await Dr(),l=await(await xt(i,"GET",`/backend-api/conversation/${t}/interpreter/download?message_id=${r}&sandbox_path=${n}`)).json();return l?.status==="error"?{success:!1,data:o,error:"File Expired"}:{success:!0,data:l?.download_url||o}}catch{return{success:!1,data:o,error:"Network Error"}}},jp=async e=>{try{let{token:t,offset:r=0,limit:n=100,order:o="updated"}=e;return(await(await xt(t,"GET",`/backend-api/conversations?offset=${r}&limit=${n}&order=${o}`)).json())?.items||[]}catch{return[]}},Ka=async({token:e,conversationId:t,messageId:r,input:n})=>{try{await xt(e,"POST","/backend-api/moderations",{conversation_id:t,message_id:r,input:n,model:"text-moderation-playground"})}catch{}},wi=async(e,t,r)=>{await xt(e,"PATCH",`/backend-api/conversation/${t}`,r)},Dr=async(e=!1)=>{let t=await fetch("https://chat.openai.com/api/auth/session");if(t.status===403&&!e)throw new Error("CLOUDFLARE");let r=await t.json().catch(()=>({}));if(!r.accessToken&&!e)throw new Error("UNAUTHORIZED");return r?.accessToken||""},Yp=async e=>["gpt-4","gpt-4-code-interpreter","gpt-4-browsing","gpt-4-plugins","gpt-4-mobile"].includes(e)?new Promise((r,n)=>{let o=ne(),i=!1;window.postMessage({event:"MAX_AI_CHAT_GPT_MESSAGE_KEY",type:"arkoseToken",data:{taskId:o}}),setTimeout(()=>{i||(n("Something went wrong, please try again. If this issue persists, contact us via email."),window.removeEventListener("message",s),window.location.reload())},20*1e3);let s=l=>{if(l?.data?.event==="MAX_AI_CHAT_GPT_MESSAGE_KEY"&&l?.data?.type==="arkoseTokenResponse"&&l?.data?.data?.taskId===o&&!i){i=!0;let a=l?.data?.data?.token||"";a?r(a):n("Something went wrong, please try again. If this issue persists, contact us via email."),window.removeEventListener("message",s)}};window.addEventListener("message",s)}):"",Ii=class{constructor(t){this.isCleaningCache=!1;this.token=t.token,this.model=t.model,this.lastChatGPTAnswerMessageId=ne(),this.id=ne(),this.conversationId=t.conversationId||void 0,this.conversationInfo={title:"",messages:[]}}async updateTitle(t){!this.conversationId||this.conversationInfo.title===t||(await wi(this.token,this.conversationId,{title:t}),this.conversationInfo.title=t)}async fetchHistoryAndConfig(){if(this.conversationId)try{let r=await(await xt(this.token,"GET",`/backend-api/conversation/${this.conversationId}`)).json();this.conversationInfo={title:r.title,messages:Js(r.current_node,r.mapping),raw:r},r.title!==qn&&await this.updateTitle(qn),this.lastChatGPTAnswerMessageId=r.current_node}catch{this.lastChatGPTAnswerMessageId=ne(),this.conversationId=void 0,this.conversationInfo={title:"",messages:[]}}}async generateAnswer(t,r=!1){let n=t.messageId||ne(),o=t.parentMessageId||this.lastChatGPTAnswerMessageId||ne(),i=!1,s="",l="",a=await bt("OPENAI"),c;try{c=await Yp(this.model)}catch(f){t.onEvent({type:"error",data:{message:f.message||"Network error.",detail:""}}),t.onEvent({type:"done"});return}let u={action:r?"variant":"next",messages:[{id:n,author:{role:"user"},content:{content_type:"text",parts:[t.prompt]}}],model:this.model,parent_message_id:o,timezone_offset_min:new Date().getTimezoneOffset(),history_and_training_disabled:!1};if(this.conversationId&&(u.conversation_id=this.conversationId),c&&(u.arkose_token=c),t.meta)if(t.meta?.attachments&&this.model==="gpt-4")try{u.messages[0].content.content_type="multimodal_text",u.messages[0].content.parts=t.meta.attachments.map(f=>({width:0,height:0,asset_pointer:`file-service://${f.id}`,size_bytes:f.size})).concat(u.messages[0].content.parts)}catch{}else u.messages[0].metadata=t.meta;a?.plugins&&!this.conversationId&&this.model==="gpt-4-plugins"&&(u.plugin_ids=a.plugins);let p=[];await Qs(`${Qa}/backend-api/conversation`,{provider:He.OPENAI,method:"POST",signal:t.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(Object.assign(u)),onMessage:async f=>{if(f==="[DONE]"){s&&this.conversationId&&l&&(this.updateTitle(qn),Ka({token:this.token,conversationId:this.conversationId,messageId:l,input:s}));let m=s;p.length>0&&(await Promise.all(p.map(async b=>await $p({uuid:b})))).forEach(b=>{b.success&&b.data&&(m=`![image](${b.data})
${m}`)});let v=m.match(/\[.*?\]\(.*?\)/g);this.conversationId&&v&&v.length>0?((await Promise.all(v.map(async b=>{let x=b.split("](");if(x.length!==2)return;let w=x[0].slice(1),T=x[1].slice(0,-1);if(!T.startsWith("sandbox:"))return;let P=await qp({conversationId:this.conversationId,message_id:l,sandbox_path:T.replace("sandbox:","")});if(P.success)return{original:b,new:`[${w}](${P.data})`}}))).forEach(b=>{b&&(m=m.replace(b.original,b.new))}),t.onEvent({type:"answer",data:{text:m,messageId:l,conversationId:this.conversationId,parentMessageId:n}}),setTimeout(()=>{t.onEvent({type:"done"})},100)):t.onEvent({type:"done"});return}let d;try{d=JSON.parse(f)}catch{return}let g=d.message?.content?.parts?.[0]||d.message?.content?.text||"";if(g.includes("<<ImageDisplayed>>")){let v=(d.message?.metadata?.aggregate_result?.messages?.[0]?.image_url).split("//")[1];if(p.find(h=>h===v))return;p.push(v)}g&&(s=g,l=d.message.id,this.conversationId=d.conversation_id,this.lastChatGPTAnswerMessageId=d.message.id,this.conversationId&&!i&&(i=!0,Ka({token:this.token,conversationId:this.conversationId,messageId:n,input:t.prompt})),t.onEvent({type:"answer",data:{text:g,messageId:d.message.id,conversationId:d.conversation_id,parentMessageId:n}}))}}).then().catch(f=>{try{if(f?.message==="BodyStreamBuffer was aborted"||f?.message==="The user aborted a request."){t.onEvent({type:"error",data:{message:"manual aborted request.",detail:""}});return}let d=JSON.parse(f.message||f);t.onEvent({type:"error",data:{message:d.message,detail:d.detail}})}catch{t.onEvent({type:"error",data:{message:"Network error.",detail:""}})}})}async close(){this.conversationId&&(await wi(this.token,this.conversationId,{is_visible:!1}),this.conversationInfo={title:"",messages:[]})}async removeCacheConversation(){if(!this.isCleaningCache&&this.token){let r=(await jp({token:this.token})).filter(o=>o.title===qn&&o.id!==this.conversationId);if(r.length===0)return;this.isCleaningCache=!0;let n=o=>new Promise(i=>setTimeout(i,o));for(let o=0;o<r.length;o++)try{await wi(this.token,r[o].id,{is_visible:!1}),await n(3e3)}catch{}this.isCleaningCache=!1}}},Xa=class{constructor(){this.conversations=[],this.abortFunctions={},this.plugins=[],this.token=void 0,this.models=[]}async fetchModels(t){if(this.models.length>0)return this.models;let r=await xt(t,"GET","/backend-api/settings/beta_features").then(async o=>{let i=await o.json();return{browsing:i?.browsing||!1,chat_preferences:i?.chat_preferences||!1,code_interpreter:i?.code_interpreter||!1,plugins:i?.plugins||!1}}).catch(()=>({browsing:!1,chat_preferences:!1,code_interpreter:!1,plugins:!1})),n=await xt(t,"GET","/backend-api/models").then(o=>o.json());return n?.models&&n.models.length>0&&(this.models=n.models.filter(o=>o.slug==="gpt-4-code-interpreter"?r.code_interpreter:o.slug==="gpt-4-browsing"?r.browsing:o.slug==="gpt-4-plugins"?r.plugins:!0)),this.models}async fetchPlugins(t){if(this.plugins.length>0)return this.plugins;let r=await xt(t,"GET","/backend-api/aip/p?offset=0&limit=100&is_installed=true").then(n=>n.json());return r?.items&&r.items.length>0&&(this.plugins=r.items),r.items}async getModelName(t,r){try{let n=await this.fetchModels(t);if(n?.length>0){if(r){let o=n.find(i=>i.slug===r);if(o)return o.slug}return n[0].slug}return"text-davinci-002-render-sha"}catch{return"text-davinci-002-render-sha"}}async getAllModels(){if(this.models.length>0)return this.models;try{let t=this.token||await Dr();return t&&(this.token=t),await this.fetchModels(t)}catch{return[]}}async getAllPlugins(){if(this.plugins.length>0)return this.plugins;try{let t=this.token||await Dr();return t&&(this.token=t),await this.fetchPlugins(t)}catch{return[]}}async createConversation(t,r){if(this.conversations.length>0)return this.conversations[0];try{let n=this.token||await Dr(),o=await this.getModelName(n,r),i=new Ii({token:n,model:o,conversationId:t});return this.conversations.push(i),i.removeCacheConversation(),await i.fetchHistoryAndConfig(),i}catch(n){n.message==="CLOUDFLARE"&&location.reload();return}}getConversation(t){return this.conversations.find(r=>r.id===t||r.conversationId===t)}getConversations(){return this.conversations}async closeConversation(t){try{let r=this.getConversation(t);return r&&(await r.close(),this.conversations=this.conversations.filter(n=>n.conversationId!==t)),!0}catch{return!1}}addAbortWithMessageId(t,r){this.abortFunctions[t]=r}removeAbortWithMessageId(t){delete this.abortFunctions[t]}abortWithMessageId(t){try{this.abortFunctions[t]&&(this.abortFunctions[t](),delete this.abortFunctions[t])}catch{}}removeCacheConversation(){return this.conversations?.[0]?.removeCacheConversation()}};Yt();var tl=C(z());var rl=C(Ot()),nl=C(Nt()),ol=C(Mr());var Ja=C(jt()),Za=C(Xt());function el(e){return(0,Za.default)("MuiDivider",e)}var Kp=(0,Ja.unstable_generateUtilityClasses)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),jn=Kp;var Pi=C(Re()),Xp=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],Qp=e=>{let{absolute:t,children:r,classes:n,flexItem:o,light:i,orientation:s,textAlign:l,variant:a}=e;return(0,nl.unstable_composeClasses)({root:["root",t&&"absolute",a,i&&"light",s==="vertical"&&"vertical",o&&"flexItem",r&&"withChildren",r&&s==="vertical"&&"withChildrenVertical",l==="right"&&s!=="vertical"&&"textAlignRight",l==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},el,n)},Jp=pe("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,r.orientation==="vertical"&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&r.orientation==="vertical"&&t.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&t.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>B({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:(0,ol.alpha)(e.palette.divider,.08)},t.variant==="inset"&&{marginLeft:72},t.variant==="middle"&&t.orientation==="horizontal"&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},t.variant==="middle"&&t.orientation==="vertical"&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},t.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({theme:e,ownerState:t})=>B({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}}),({theme:e,ownerState:t})=>B({},t.children&&t.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${(e.vars||e).palette.divider}`,transform:"translateX(0%)"}}),({ownerState:e})=>B({},e.textAlign==="right"&&e.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},e.textAlign==="left"&&e.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),Zp=pe("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.wrapper,r.orientation==="vertical"&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>B({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},t.orientation==="vertical"&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),ed=tl.forwardRef(function(t,r){let n=We({props:t,name:"MuiDivider"}),{absolute:o=!1,children:i,className:s,component:l=i?"div":"hr",flexItem:a=!1,light:c=!1,orientation:u="horizontal",role:p=l!=="hr"?"separator":void 0,textAlign:f="center",variant:d="fullWidth"}=n,g=Ue(n,Xp),m=B({},n,{absolute:o,component:l,flexItem:a,light:c,orientation:u,role:p,textAlign:f,variant:d}),v=Qp(m);return(0,Pi.jsx)(Jp,B({as:l,className:(0,rl.default)(v.root,s),role:p,ref:r,ownerState:m},g,{children:i?(0,Pi.jsx)(Zp,{className:v.wrapper,ownerState:m,children:i}):null}))}),_i=ed;Yt();var Kn=C(z());var ll=C(Ot()),cl=C(Nt());var il=C(jt()),sl=C(Xt());function al(e){return(0,sl.default)("MuiListItemIcon",e)}var td=(0,il.unstable_generateUtilityClasses)("MuiListItemIcon",["root","alignItemsFlexStart"]),Yn=td;var ul=C(Re()),rd=["className"],nd=e=>{let{alignItems:t,classes:r}=e;return(0,cl.unstable_composeClasses)({root:["root",t==="flex-start"&&"alignItemsFlexStart"]},al,r)},od=pe("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.alignItems==="flex-start"&&t.alignItemsFlexStart]}})(({theme:e,ownerState:t})=>B({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex"},t.alignItems==="flex-start"&&{marginTop:8})),id=Kn.forwardRef(function(t,r){let n=We({props:t,name:"MuiListItemIcon"}),{className:o}=n,i=Ue(n,rd),s=Kn.useContext(Nr),l=B({},n,{alignItems:s.alignItems}),a=nd(l);return(0,ul.jsx)(od,B({className:(0,ll.default)(a.root,o),ownerState:l,ref:r},i))}),sd=id;var Br=C(z());var Ut=Ce({key:"ChatGPTClientState",default:{loaded:!1,status:"needAuth",aborts:[]}}),pr=Ce({key:"ClientConversationMapState",default:{}});var Wt=Ce({key:"ChatGPTConversationState",default:{writingMessage:null,lastMessageId:"",model:"",loading:!1}}),pl=Ce({key:"SidebarPageState",default:{sidebarConversationType:"Chat"}});var ad=()=>{let[e,t]=ie(vt),r=Oe(pr),[n,o]=ie(pl);dt(()=>{let d=new URL(window.location.href),m=new URLSearchParams(d.search).get("conversationType");m&&f(m)});let i=n.sidebarConversationType,s=e.sidebarSettings?.common?.currentAIProvider,l=(0,Br.useMemo)(()=>{switch(i){case"Chat":return e.sidebarSettings?.chat?.conversationId;case"Search":return e.sidebarSettings?.search?.conversationId;case"Summary":return e.sidebarSettings?.summary?.conversationId;default:return""}},[i,e.sidebarSettings?.chat?.conversationId,e.sidebarSettings?.search?.conversationId,e.sidebarSettings?.summary?.conversationId]),a=(0,Br.useMemo)(()=>({Chat:r[e.sidebarSettings?.chat?.conversationId||""]?.messages||[],Search:r[e.sidebarSettings?.search?.conversationId||""]?.messages||[],Summary:r[e.sidebarSettings?.summary?.conversationId||""]?.messages||[]}),[l,e.sidebarSettings?.chat?.conversationId,e.sidebarSettings?.search?.conversationId,e.sidebarSettings?.summary?.conversationId,r]),c=(0,Br.useMemo)(()=>r[l||""],[l,r]),u=(0,Br.useMemo)(()=>a[i]||[],[i,a]),p=async d=>{await ya({sidebarSettings:d});let g=await _e();t(m=>({...m,sidebarSettings:g.sidebarSettings}))},f=d=>{o(g=>({...g,sidebarConversationType:d}))};return{sidebarSettings:e.sidebarSettings,currentSidebarConversationType:i,currentSidebarAIProvider:s,currentSidebarConversation:c,currentSidebarConversationId:l,currentSidebarConversationMessages:u,sidebarConversationTypeMessageMap:a,updateSidebarSettings:p,updateSidebarConversationType:f}},ze=ad;var Xn=Ce({key:"AuthState",default:{isLogin:!1}}),Qn=Ce({key:"AuthUserInfoState",default:{user:null,loading:!1}});var Os=C(z());var dl=(e,t)=>{if(!e)return[];if(typeof e[0]=="string"||typeof e[0]=="number")return e.map(o=>({label:String(o),value:String(o)}));let{labelKey:r="label",valueKey:n="value"}=t||{};return e.map(o=>({label:o[r],value:o[n],origin:o}))},fl=(e,t)=>{for(let r=e.length-1;r>=0;r--){let n=e[r];if(t(n))return n}},ld=(e,t,r=[])=>{Object.entries(e).forEach(([n,o])=>{let i=[...r,n];typeof o=="object"&&o!==null?ld(o,t,i):t(i,o)})};var bo=C(z());var j=C(z());var it=C(z());var ml=C(Wp());var cd=()=>{let{t:e}=ve(["common","client"]);return it.default.createElement(W,{minWidth:400,spacing:2,p:1},it.default.createElement(W,{boxSizing:"border-box",direction:"row",width:"100%",alignItems:"center",justifyContent:"space-between"},it.default.createElement(qe,{sx:{flexShrink:0,textDecoration:"none!important"},href:Kt,target:"_blank"},it.default.createElement(W,{direction:"row",alignItems:"center",gap:1},it.default.createElement(Wn,{sx:{fontSize:28,color:"inherit"}}),it.default.createElement($,{color:"text.primary",component:"h1",fontSize:20,fontWeight:800},e("client:sidebar__refresh_page__title"))))),it.default.createElement(ka,{severity:"info"},it.default.createElement($,{fontSize:14,color:"text.primary",textAlign:"left"},e("client:sidebar__refresh_page__description"))),it.default.createElement(Qt,{fullWidth:!0,color:"primary",variant:"contained",startIcon:it.default.createElement(ml.default,{sx:{fontSize:16,color:"inherit"}}),onClick:async()=>{window.location.reload()}},e("client:sidebar__refresh_page__button")))},gl=cd;var Ee=C(z());var Ai=C(z()),ud=[{beta:!1,label:"client:provider__bing_web_app__title",description:"",value:He.BING,authDescription:"client:provider__bing_web_app__auth_description",shortDescription:e=>e("client:provider__bing_web_app__short_description"),authButtonText:"client:provider__bing_web_app__auth_button_text",authOpenInNew:!1},{beta:!1,label:"client:provider__bard_web_app__title",description:"",value:He.BARD,authDescription:"client:provider__bard_web_app__auth_description",shortDescription:e=>e("client:provider__bard_web_app__short_description"),authButtonText:"client:provider__bard_web_app__auth_button_text",authOpenInNew:!1},{beta:!1,label:"client:provider__claude_web_app__title",value:He.CLAUDE,description:"",authDescription:"client:provider__claude_web_app__auth_description",shortDescription:e=>e("client:provider__claude_web_app__short_description"),authButtonText:"client:provider__claude_web_app__auth_button_text",authOpenInNew:!0},{beta:!1,label:"client:provider__chatgpt_web_app__title",description:"",value:He.OPENAI,authDescription:"client:provider__chatgpt_web_app__auth_description",shortDescription:e=>e("client:provider__chatgpt_web_app__short_description"),authButtonText:"client:provider__chatgpt_web_app__auth_button_text",authOpenInNew:!0},{beta:!1,label:"client:provider__openai_api__title",description:"",value:He.OPENAI_API,authDescription:"client:provider__openai_api__auth_description",shortDescription:e=>Ai.default.createElement("span",null,e("client:provider__openai_api__short_description1")," ",Ai.default.createElement(qe,{target:"_blank",href:"https://platform.openai.com/playground?mode=chat",rel:"noreferrer noopener nofollow",sx:{color:"inherit",display:"inline-flex",textDecorationColor:t=>t.palette.mode==="dark"?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)","&:hover":{textDecorationColor:t=>t.palette.mode==="dark"?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)"}}},e("client:provider__openai_api__short_description2")),e("client:provider__openai_api__short_description3")),authButtonText:"client:provider__openai_api__auth_button_text",authOpenInNew:!0},{beta:!1,label:"client:provider__claude__title",value:He.MAXAI_CLAUDE,description:"",authDescription:"client:provider__claude__auth_description",shortDescription:e=>e("client:provider__claude__short_description"),authButtonText:"client:provider__claude__auth_button_text",authOpenInNew:!1},{beta:!1,description:"",label:"client:provider__chatgpt__title",authDescription:"client:provider__chatgpt__auth_description",value:He.USE_CHAT_GPT_PLUS,shortDescription:e=>e("client:provider__chatgpt__short_description"),authButtonText:"client:provider__chatgpt__auth_button_text",authOpenInNew:!1}],Fr=ud;var st=C(z());var pd=e=>{let{aiProviderType:t,size:r=20,sx:n}=e;return st.default.createElement(st.default.Fragment,null,t==="USE_CHAT_GPT_PLUS"&&st.default.createElement(Sa,{sx:{...n,fontSize:r}}),t==="OPENAI_API"&&st.default.createElement(wa,{sx:{...n,fontSize:r,color:o=>o.palette.mode==="dark"?"#fff":"rgba(0,0,0,1)"}}),t==="OPENAI"&&st.default.createElement(Ea,{sx:{...n,fontSize:r}}),t==="BARD"&&st.default.createElement(Pa,{sx:{...n,fontSize:r}}),t==="BING"&&st.default.createElement(Ia,{sx:{...n,fontSize:r}}),t==="CLAUDE"&&st.default.createElement(Aa,{sx:{...n,fontSize:r,color:o=>o.palette.mode==="dark"?"#fff":"rgba(0,0,0,1)"}}),t==="MAXAI_CLAUDE"&&st.default.createElement(_a,{sx:{...n,fontSize:r}}),t==="POE"&&st.default.createElement(Ma,{sx:{...n,fontSize:r}}))},Tt=pd;var fe=C(z());var Qe=C(z());var dd=e=>{let{aiProviderOption:t,children:r,sx:n,boxSx:o,authMode:i}=e,{t:s}=ve(["common","client"]),l={USE_CHAT_GPT_PLUS:"chatgpt",OPENAI:"chatgpt_web_app",OPENAI_API:"openai_api",BARD:"bard_web_app",BING:"bing_web_app",POE:"poe",CLAUDE:"claude_web_app",MAXAI_CLAUDE:"claude"};return Qe.default.createElement(W,{alignItems:"center",justifyContent:"space-between",sx:{height:"100%",...n}},Qe.default.createElement(W,{p:1,spacing:1,width:"100%",sx:{textAlign:"left"}},Qe.default.createElement(W,{direction:"row",spacing:1},Qe.default.createElement(Tt,{aiProviderType:t.value,size:24}),Qe.default.createElement($,{fontSize:"16px",fontWeight:600,color:"text.primary"},s(t.label))),i&&Qe.default.createElement($,{fontSize:"14px",color:"text.secondary",fontWeight:400},s(t.authDescription)),Qe.default.createElement($,{fontSize:"14px",color:"text.secondary",fontWeight:400},t.shortDescription(s)),Qe.default.createElement(ye,{display:"flex"},Qe.default.createElement(qe,{href:`${Kt}/get-started?provider=${l[t.value]}#ai-provider`,target:"_blank",underline:"always",sx:{display:"inline-flex",textDecorationColor:a=>a.palette.mode==="dark"?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)","&:hover":{textDecorationColor:a=>a.palette.mode==="dark"?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)"}}},Qe.default.createElement($,{fontSize:"14px",color:"text.secondary",fontWeight:400,component:"span"},s("common:learn_more"))))),Qe.default.createElement(W,{sx:{width:"100%",p:1,...o}},r))},Jn=dd;var Mi=C(Ri());var hl=new ae,yd=e=>{let{aiProviderOption:t}=e,{t:r}=ve(["common","client"]),n=Oe(Ut),[o,i]=(0,fe.useState)(!1);return(0,fe.useEffect)(()=>{let s=null;return(n.status==="loading"||n.status==="complete")&&(s=setTimeout(()=>{i(!0)},10*1e3)),()=>{s&&(i(!1),clearTimeout(s))}},[n.status]),fe.default.createElement(Jn,{authMode:!0,aiProviderOption:t,boxSx:{p:0}},(n.status==="loading"||n.status==="complete")&&fe.default.createElement(W,null,t.value===He.OPENAI&&fe.default.createElement(zn,{placement:"bottom",arrow:!0,open:!0,PopperProps:{sx:{maxWidth:"237px",zIndex:"2147483632!important"}},title:o&&fe.default.createElement(ye,{sx:{cursor:"pointer",textAlign:"center","&:hover":{textDecoration:"underline"}},onClick:()=>{hl.postMessage({event:"Client_authChatGPTProvider",data:{provider:He.OPENAI}})}},fe.default.createElement($,{component:"span",textAlign:"center",fontSize:"14px",fontWeight:400},r("client:provider__chatgpt_web_app__waiting_tooltip1")),fe.default.createElement($,{component:"span",textAlign:"center",fontSize:"14px",fontWeight:400,sx:{textDecoration:"underline"}},r("client:provider__chatgpt_web_app__waiting_tooltip2")),fe.default.createElement(Mi.default,{sx:{fontSize:14,position:"relative",top:3}}),fe.default.createElement($,{component:"span",textAlign:"center",fontSize:"14px",fontWeight:400},r("client:provider__chatgpt_web_app__waiting_tooltip3")))},fe.default.createElement(W,{justifyContent:"center",alignItems:"center",height:"100%",sx:{height:"40px"}},fe.default.createElement($,{fontSize:"18px",fontWeight:700},r("client:provider__chatgpt_web_app__connecting"))))),n.status==="needAuth"&&fe.default.createElement(W,{spacing:2},fe.default.createElement(Na,{TooltipProps:{arrow:!0,placement:"bottom",PopperProps:{sx:{maxWidth:"237px",zIndex:"2147483632!important"}}},sx:{fontSize:"14px",fontWeight:400,width:"100%",px:"0",py:"6px",height:"40px"},title:t.value===He.OPENAI&&fe.default.createElement(ye,{sx:{display:"inline"}},fe.default.createElement($,{component:"span",fontSize:14,textAlign:"left"},r("client:provider__chatgpt_web_app__stable_mode_tooltip1")),fe.default.createElement(qe,{fontSize:14,color:"#fff",sx:{textDecorationColor:"#fff"},href:"#",onClick:async()=>{await Hn({key:"options",query:"#/chatgpt-stable-mode"})}},r("client:provider__chatgpt_web_app__stable_mode_tooltip2")),fe.default.createElement($,{component:"span",fontSize:14,textAlign:"left"},r("client:provider__chatgpt_web_app__stable_mode_tooltip3"))),onClick:async()=>{await hl.postMessage({event:"Client_authChatGPTProvider",data:{provider:t.value}})},variant:"contained",disableElevation:!0,fullWidth:!0},r(t.authButtonText),t.authOpenInNew&&fe.default.createElement(Mi.default,{sx:{fontSize:"16px",ml:"4px"}}))))},yl=yd;var er=C(z());var se=C(z());Yt();var zt=C(z());var ki=C(Ot()),Tl=C(Nt()),Hr=C(Mr());var vl=C(jt()),bl=C(Xt());function xl(e){return(0,bl.default)("MuiMenuItem",e)}var vd=(0,vl.unstable_generateUtilityClasses)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Jt=vd;var Li=C(Re()),bd=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],xd=(e,t)=>{let{ownerState:r}=e;return[t.root,r.dense&&t.dense,r.divider&&t.divider,!r.disableGutters&&t.gutters]},Td=e=>{let{disabled:t,dense:r,divider:n,disableGutters:o,selected:i,classes:s}=e,a=(0,Tl.unstable_composeClasses)({root:["root",r&&"dense",t&&"disabled",!o&&"gutters",n&&"divider",i&&"selected"]},xl,s);return B({},s,a)},Cd=pe(Ca,{shouldForwardProp:e=>kn(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:xd})(({theme:e,ownerState:t})=>B({},e.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!t.disableGutters&&{paddingLeft:16,paddingRight:16},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Jt.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,Hr.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Jt.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:(0,Hr.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${Jt.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:(0,Hr.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,Hr.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${Jt.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Jt.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${jn.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${jn.inset}`]:{marginLeft:52},[`& .${Ci.root}`]:{marginTop:0,marginBottom:0},[`& .${Ci.inset}`]:{paddingLeft:36},[`& .${Yn.root}`]:{minWidth:36}},!t.dense&&{[e.breakpoints.up("sm")]:{minHeight:"auto"}},t.dense&&B({minHeight:32,paddingTop:4,paddingBottom:4},e.typography.body2,{[`& .${Yn.root} svg`]:{fontSize:"1.25rem"}}))),Sd=zt.forwardRef(function(t,r){let n=We({props:t,name:"MuiMenuItem"}),{autoFocus:o=!1,component:i="li",dense:s=!1,divider:l=!1,disableGutters:a=!1,focusVisibleClassName:c,role:u="menuitem",tabIndex:p,className:f}=n,d=Ue(n,bd),g=zt.useContext(Nr),m=zt.useMemo(()=>({dense:s||g.dense||!1,disableGutters:a}),[g.dense,s,a]),v=zt.useRef(null);Oa(()=>{o&&v.current&&v.current.focus()},[o]);let h=B({},n,{dense:m.dense,divider:l,disableGutters:a}),b=Td(n),x=xa(v,r),w;return n.disabled||(w=p!==void 0?p:-1),(0,Li.jsx)(Nr.Provider,{value:m,children:(0,Li.jsx)(Cd,B({ref:x,role:u,tabIndex:w,component:i,focusVisibleClassName:(0,ki.default)(b.focusVisible,c),className:(0,ki.default)(b.root,f)},d,{ownerState:h,classes:b}))})}),Ct=Sd;var ge=C(z());var Sl=C(Cl());var Ur=C(z());var _d=({emptyText:e})=>{let{t}=ve(["common"]);return Ur.default.createElement(W,{alignItems:"center"},Ur.default.createElement(W,{width:"56px",height:"56px",justifyContent:"center",alignItems:"center",borderRadius:4,sx:{bgcolor:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, .04)":"rgba(0, 0, 0, .04)"}},Ur.default.createElement(Sl.default,{width:24,height:24})),Ur.default.createElement($,{variant:"body1"},e||t("common:no_options")))},El=_d;var oe=C(z());var Wr={};Fp(Wr,{default:()=>to.default});var to=C(ba());ai(Wr,C(ba()));var St=C(z());var Yy=(e,t,r)=>{let o={textSelectPopupButton:[{type:"RENDER_TEMPLATE",parameters:{template:t}}],inputAssistantComposeReplyButton:[{type:"RENDER_TEMPLATE",parameters:{template:t}}],inputAssistantComposeNewButton:[{type:"RENDER_TEMPLATE",parameters:{template:t}}],inputAssistantRefineDraftButton:[{type:"RENDER_TEMPLATE",parameters:{template:t}}]}[e];return r?(o.push({type:"INSERT_USER_INPUT",parameters:{template:"{{LAST_ACTION_OUTPUT}}"}}),o.push({type:"ASK_CHATGPT",parameters:{template:"{{LAST_ACTION_OUTPUT}}"}})):o.push({type:"INSERT_USER_INPUT",parameters:{template:"{{LAST_ACTION_OUTPUT}}"}}),o},Ky=["SELECTED_TEXT","AI_RESPONSE_LANGUAGE","CURRENT_WEBSITE_DOMAIN"],Xy=e=>{switch(e){case"LAST_ACTION_OUTPUT":return{description:"feature_card__prompts__prompt_template__variable_last_action_output__description",examples:[]};case"USER_INPUT":return{description:"feature_card__prompts__prompt_template__variable_user_input__description",examples:[]};case"SELECTED_TEXT":return{description:"feature_card__prompts__prompt_template__variable_selected_text__description",examples:["feature_card__prompts__prompt_template__variable_selected_text__example1","feature_card__prompts__prompt_template__variable_selected_text__example2"]};case"AI_RESPONSE_LANGUAGE":return{description:"feature_card__prompts__prompt_template__variable_ai_response_language__description",examples:["feature_card__prompts__prompt_template__variable_ai_response_language__example1","feature_card__prompts__prompt_template__variable_ai_response_language__example2"]};case"GMAIL_EMAIL_CONTEXT":return{description:"feature_card__prompts__prompt_template__variable_gmail_email_context__description",examples:[]};case"GMAIL_DRAFT_CONTEXT":return{description:"feature_card__prompts__prompt_template__variable_gmail_draft_context__description",examples:[]};case"CURRENT_WEBSITE_DOMAIN":return{description:"feature_card__prompts__prompt_template__variable_current_website_domain__description",examples:["feature_card__prompts__prompt_template__variable_current_website_domain__example1","feature_card__prompts__prompt_template__variable_current_website_domain__example2"]};default:return{description:"",examples:[]}}};var Qy=e=>{let t=e;return t?.includes("524")&&(t="Network error: 524"),t?.includes("502")&&(t="Network error: 502"),t};var zr=async(e,t)=>{try{let n=await new ae().postMessage({event:"Client_proxyFetchAPI",data:{url:e,options:t}});return{success:n.success,data:n.data,error:n.message}}catch(r){return{success:!1,data:null,error:r?.message||r}}},Jy=async(e,t,r={})=>{try{let n=new ae,o=await Gn(),i=await Ht();r.body=JSON.stringify(t),r.headers||(r.headers={"Content-Type":"application/json",Authorization:`Bearer ${i}`,fp:`${o}`}),r.method||(r.method="POST"),ir&&!e.startsWith(ir)&&(e=ir+e);let s=await n.postMessage({event:"Client_proxyFetchAPI",data:{url:e,options:r}});return{success:s.success,data:s.data,error:s.message}}catch(n){return{success:!1,data:null,error:n?.message||n}}};var Ad=e=>{let{youtubeLink:t,borderRadius:r=16,cover:n,sx:o}=e,[i,s]=(0,St.useState)(!1),[l,a]=(0,St.useState)(!1),c=(0,St.useMemo)(()=>n?i&&l:!0,[n,i,l]);return dt(()=>{zr("https://www.youtube.com/t/terms",{parse:"text"}).then(u=>{u.success&&s(!0)}).catch(u=>{})}),St.default.createElement(ye,{className:"video-container",sx:{"&.video-container":{position:"relative",paddingBottom:"56.25%",height:0},"&.video-container iframe":{borderRadius:r+"px",position:"absolute",top:0,left:0,width:"100%",height:"100%"},"&.video-container img":{borderRadius:r+"px",position:"absolute",top:0,left:0,width:"100%",objectFit:"contain",height:"100%"},...o}},!c&&n&&St.default.createElement("img",{src:n,alt:"Youtube video cover"}),St.default.createElement("iframe",{title:"YouTube video player",width:"560",height:"315",src:t,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>{a(!0)},style:{visibility:c?"visible":"hidden",width:c?"100%":"0!important",height:c?"100%":"0!important"}}))},wl=Ad;var Je=C(z());Yt();var Ll=C(z()),Ol=C(Ot());var dr=C(Mr()),Nl=C(Nt());var Il=C(jt()),Pl=C(Xt());function _l(e){return(0,Pl.default)("MuiSkeleton",e)}var Rd=(0,Il.unstable_generateUtilityClasses)("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]),Md=Rd;var Dl=C(Re()),kd=["animation","className","component","height","style","variant","width"],ro=e=>e,Al,Rl,Ml,kl,Ld=e=>{let{classes:t,variant:r,animation:n,hasChildren:o,width:i,height:s}=e;return(0,Nl.unstable_composeClasses)({root:["root",r,n,o&&"withChildren",o&&!i&&"fitContent",o&&!s&&"heightAuto"]},_l,t)},Od=(0,dr.keyframes)(Al||(Al=ro`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),Nd=(0,dr.keyframes)(Rl||(Rl=ro`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),Dd=pe("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],r.animation!==!1&&t[r.animation],r.hasChildren&&t.withChildren,r.hasChildren&&!r.width&&t.fitContent,r.hasChildren&&!r.height&&t.heightAuto]}})(({theme:e,ownerState:t})=>{let r=Ys(e.shape.borderRadius)||"px",n=Ks(e.shape.borderRadius);return B({display:"block",backgroundColor:e.vars?e.vars.palette.Skeleton.bg:(0,Xs.alpha)(e.palette.text.primary,e.palette.mode==="light"?.11:.13),height:"1.2em"},t.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${n}${r}/${Math.round(n/.6*10)/10}${r}`,"&:empty:before":{content:'"\\00a0"'}},t.variant==="circular"&&{borderRadius:"50%"},t.variant==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius},t.hasChildren&&{"& > *":{visibility:"hidden"}},t.hasChildren&&!t.width&&{maxWidth:"fit-content"},t.hasChildren&&!t.height&&{height:"auto"})},({ownerState:e})=>e.animation==="pulse"&&(0,dr.css)(Ml||(Ml=ro`
      animation: ${0} 1.5s ease-in-out 0.5s infinite;
    `),Od),({ownerState:e,theme:t})=>e.animation==="wave"&&(0,dr.css)(kl||(kl=ro`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 1.6s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),Nd,(t.vars||t).palette.action.hover)),Bd=Ll.forwardRef(function(t,r){let n=We({props:t,name:"MuiSkeleton"}),{animation:o="pulse",className:i,component:s="span",height:l,style:a,variant:c="text",width:u}=n,p=Ue(n,kd),f=B({},n,{animation:o,component:s,variant:c,hasChildren:!!p.children}),d=Ld(f);return(0,Dl.jsx)(Dd,B({as:s,ref:r,className:(0,Ol.default)(d.root,i),ownerState:f},p,{style:B({width:u,height:l},a)}))}),Oi=Bd;function mt(e){for(let t of e){let r=document.querySelector(t);if(r)return r}}var vv=e=>{let{containerId:t,presetContainerElement:r,shadowContainerId:n,presetShadowContainerElement:o,webComponent:i=!0}=e,s="customElements"in window,l=document.createElement(s&&i?`maxai-custom-element-${ne()}`:"div");t&&(l.id=t),r&&r(l);let a=l.attachShadow({mode:"open"}),c=document.createElement("style");t&&(c.id=`${t}-emotion-style`);let u=document.createElement("div");return n&&(u.id=n),o&&o(u),a.appendChild(c),a.appendChild(u),{container:l,shadowContainer:u,emotionRoot:c}};function Bl(e,t){t.parentNode.insertBefore(e,t.nextSibling)}var Ni={google:{ref:"google",verifier:()=>location.hostname.startsWith("www.google")&&location.pathname.startsWith("/search"),inputQueryFinder:()=>mt(["input[name='q']","textarea[type='search']"])?.value||"",sidebarContainerFinder:()=>{let e=document.querySelector("#rcnt");if(e){let t=e.querySelector("div#rhs[role=complementary]");if(t)return t;let r=e.querySelector("div#rhs");if(r)return r;let n=Fd(),o=e.querySelector("#center_col");return o?Bl(n,o):e.appendChild(n),n}},isDarkMode:()=>!!document.querySelector("meta[content=dark]")},bing:{ref:"bing",verifier:()=>location.hostname.includes(".bing.")&&location.pathname.startsWith("/search"),sidebarContainerFinder:()=>document.querySelector("aside > ol#b_context"),inputQueryFinder:()=>{let e=mt(["#sp_requery a","input[name=q]","input.b_searchbox","textarea.b_searchbox"]);return e?.value||e?.textContent||""},customStyle:{margin:"0 -20px 20px"},isDarkMode:()=>!1},baidu:{ref:"baidu",verifier:()=>location.hostname.startsWith("www.baidu"),sidebarContainerFinder:()=>document.querySelector("div#content_right"),inputQueryFinder:()=>{let e=window.bds;return e?.comm?.query?e.comm.query:mt(["input[name=wd]"])?.value||""},watchRouteChange(e){let t=document.getElementById("wrapper_wrapper");new MutationObserver(function(n){for(let o of n)if(o.type==="childList"){for(let i of o.addedNodes)if("id"in i&&i.id==="container"){e();return}}}).observe(t,{childList:!0})},isDarkMode:()=>!1},duckduckgo:{ref:"duckduckgo",verifier:()=>location.hostname==="duckduckgo.com"&&location.pathname==="/",sidebarContainerFinder:()=>document.querySelector("section.js-react-sidebar[data-area=sidebar]"),inputQueryFinder:()=>{let e=mt(["div[data-testid=spelling-message] p a","input#search_form_input"]);return e?.value||e?.textContent||""},isDarkMode:()=>!!document.querySelector("html.dark-header")},yahoo:{ref:"yahoo",verifier:()=>location.hostname.includes("search.yahoo")&&location.pathname.startsWith("/search"),sidebarContainerFinder:()=>document.querySelector("div#results div#right"),inputQueryFinder:()=>mt(["input[name=p]"])?.value||"",isDarkMode:()=>!1},naver:{ref:"naver",verifier:()=>location.hostname.includes("search.naver")&&location.pathname.startsWith("/search"),sidebarContainerFinder:()=>document.querySelector("div#sub_pack"),inputQueryFinder:()=>{let e=mt(["div.dsc_area strong.source","input[name=query]"]);return e?.value||e?.textContent||""},customStyle:{margin:"0 30px 20px 16px"},isDarkMode:()=>!1},yandex:{ref:"yandex",verifier:()=>location.host.includes("yandex")&&location.pathname.startsWith("/search"),sidebarContainerFinder:()=>document.querySelector("div.main__content div#search-result-aside"),inputQueryFinder:()=>mt(["input.HeaderDesktopForm-Input[name=text]"])?.value||"",isDarkMode:()=>!!document.querySelector("meta[name=color-scheme][content=dark]")},sogou:{ref:"sogou",verifier:()=>location.host.includes("sogou")&&(location.pathname.startsWith("/web")||location.pathname.startsWith("/sogou")),sidebarContainerFinder:()=>document.querySelector("div#wrapper div#right"),inputQueryFinder:()=>mt(["input#upquery[name=query]"])?.value||"",isDarkMode:()=>!1},brave:{ref:"brave",verifier:()=>location.host.includes("search.brave")&&location.pathname.startsWith("/search"),sidebarContainerFinder:()=>document.querySelector("aside.sidebar"),inputQueryFinder:()=>{let e=mt(["div.altered-query-text a","input[id=searchbox]"]);return e?.value||e?.textContent||""},isDarkMode:()=>!!document.querySelector("img.theme--dark")}};function Tv(){let e=null,t=Object.keys(Ni);for(let r=0;r<t.length;r++){let n=t[r],o=Ni[n].verifier;if(o()){e=n;break}}return{siteName:e,config:e?Ni[e]:null}}function Fd(){let e=document.createElement("div");return e.setAttribute("role","complementary"),e.setAttribute("id","rhs"),e.setAttribute("data-by","webchatgpt"),new URLSearchParams(location.search).get("tbm")==="nws"&&(e.style.marginLeft="30px"),e}function Fl(){return document.querySelector(`#${Ba}`)?.shadowRoot?.querySelector(`#${Fa}`)}function Iv(e){return e.endsWith("?")||e.endsWith("\uFF1F")||e.endsWith("\u061F")||e.endsWith("\u2E2E")}function Pv(e,t){switch(e){case"bing":case"yandex":{t.style.display="inline-flex",t.style.flexDirection="column";break}case"google":case"baidu":case"duckduckgo":case"yahoo":case"naver":case"sogou":case"brave":{t.style.display="flex",t.style.flexDirection="column";break}default:break}}var _v=async(e,t,{onMessage:r,onError:n})=>new Promise(o=>{let i=e.messageId,s=On(async(a,c)=>{if(a==="Client_askChatGPTQuestionResponse"&&c.taskId===i)return c.error?n?.(c.error):c?.data?.text&&r?.(c.data),c.done?(o(!0),s(),{success:!0,message:"ok",data:{}}):{success:!0,message:"ok",data:{}}});new ae({runtime:"client"}).postMessage({event:"SWAI_askAIQuestion",data:{taskId:i,question:e,options:t}})});var Hd=({src:e,alt:t,height:r})=>{let[n,o]=(0,Je.useState)(null),[i,s]=(0,Je.useState)(!0),l=(0,Je.useRef)(ne());return(0,Je.useEffect)(()=>{let a=()=>{let f=new Image;f.src=e,f.onload=()=>{o(e),s(!1)}},c=new IntersectionObserver(f=>{f.forEach(d=>{d.isIntersecting&&(a(),c.unobserve(d.target))})}),u=`#lazy-image-${l.current}`,p=kr()?.querySelector(u)||Fn()?.querySelector(u)||Fl()?.querySelector(u)||document.querySelector(u);return p&&c.observe(p),()=>{p&&c.unobserve(p)}},[e]),Je.default.createElement(Je.default.Fragment,null,i?Je.default.createElement(Oi,{id:`lazy-image-${l.current}`,variant:"rectangular",height:r}):Je.default.createElement("img",{src:n,alt:t,height:r}))},Hl=Hd;var Ul=C(Vp()),Wl=C(zp()),zl=(e,t="MaxAI")=>Ul.default.encrypt(JSON.stringify(e),t).toString(),Vl=e=>(0,Wl.default)(e).toString();var Vi=C(_n());var no=C(_n());var Gl=()=>{let e=typeof window<"u"?window.location.href:"";return e?["onedrive.live.com/edit.aspx","icloud.com/mail","navigator-lxa.mail.com/mail"].find(t=>e.includes(t)):!1},Wv=()=>{let e=document.documentElement,t=typeof window<"u"?window.location.href:"";t&&On(async(r,n,o)=>{switch(r){case"Iframe_ListenGetPageContent":{let{taskId:i}=n,s="";return t.includes("word-edit.officeapps.live.com/we/wordeditorframe.aspx")&&(s=e.querySelector("#PageContentContainer")?.innerText||""),t.includes("icloud-sandbox.com/applications/mail2-message")&&(s=e.querySelector(".mail-message-defaults")?.innerText||""),t.includes("mail.com/mail/client/mailbody")&&(s=e?.ownerDocument?.body?.innerText||""),s=s.trim(),s?(await new ae().postMessage({event:"Iframe_sendPageContent",data:{taskId:i,pageContent:s}}),{success:!0,data:"",message:""}):{success:!1,data:"",message:"no page content"}}}})},$l=()=>new Promise(async e=>{let t=new ae,r=ne();(await t.postMessage({event:"Client_getIframePageContent",data:{taskId:r}})).success||e("");let o=!1,i=s=>{if(s.id===ci&&s.event==="Client_ListenGetIframePageContentResponse"&&s.data.taskId===r){if(o)return;o=!0,e(s.data.pageContent),no.default.runtime.onMessage.removeListener(i)}};no.default.runtime.onMessage.addListener(i),setTimeout(()=>{o||(o=!0,e(""),no.default.runtime.onMessage.removeListener(i))},1e4)});var Ud=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/i,oo=class{static async fetchTranscript(t){try{let r=this.retrieveVideoId(t);if(!r)return[];let n=await zr("https://www.youtube.com/watch?v="+r,{parse:"text"});if(!n.success)return[];let i=n.data.split('"captions":');if(i.length<2)return[];let s=JSON.parse(i[1].split(',"videoDetails')[0].replace(/\n/,"")).playerCaptionsTracklistRenderer.captionTracks,l=Array.from(s).map(p=>p.name.simpleText),a="English",u=Array.from(l).sort((p,f)=>p===a?-1:f===a||p.includes(a)?1:f.includes(a)?-1:0).map(p=>{let f=s.find(d=>d.name.simpleText===p).baseUrl;return{language:p,link:f}});for(let p=0;p<u.length;p++){let f=u[p],d=await zr(f.link,{parse:"text"});if(d.success){let g=d.data,m=this.parseXml(g);if(m.length)return m}}return[]}catch{return[]}}static async transcriptFormat(t,r=4096){let n=`${t.map(o=>`${o.start} ${o.text}
`).join("")}`;return await Dn(n,r)}static retrieveVideoId(t){if(t.length===11)return t;let r=t.match(Ud);return r&&r.length?r[1]:""}static parseXml(t){let o=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("text"),i=[];for(let s=0;s<o.length;s++){let l=o[s],a=l.getAttribute("start"),c=l.getAttribute("dur")||"",u=l.textContent;a&&u&&i.push({start:a,duration:c,text:u})}return i}};var rc=C(Gp());function Wd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e}function Hi(e,t){return Array(t+1).join(e)}function zd(e){return e.replace(/^\n*/,"")}function Vd(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}var Gd=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function Ui(e){return Wi(e,Gd)}var Yl=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function Kl(e){return Wi(e,Yl)}function $d(e){return Ql(e,Yl)}var Xl=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function qd(e){return Wi(e,Xl)}function jd(e){return Ql(e,Xl)}function Wi(e,t){return t.indexOf(e.nodeName)>=0}function Ql(e,t){return e.getElementsByTagName&&t.some(function(r){return e.getElementsByTagName(r).length})}var Me={};Me.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}};Me.lineBreak={filter:"br",replacement:function(e,t,r){return r.br+`
`}};Me.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,r){var n=Number(t.nodeName.charAt(1));if(r.headingStyle==="setext"&&n<3){var o=Hi(n===1?"=":"-",e.length);return`

`+e+`
`+o+`

`}else return`

`+Hi("#",n)+" "+e+`

`}};Me.blockquote={filter:"blockquote",replacement:function(e){return e=e.replace(/^\n+|\n+$/g,""),e=e.replace(/^/gm,"> "),`

`+e+`

`}};Me.list={filter:["ul","ol"],replacement:function(e,t){var r=t.parentNode;return r.nodeName==="LI"&&r.lastElementChild===t?`
`+e:`

`+e+`

`}};Me.listItem={filter:"li",replacement:function(e,t,r){e=e.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var n=r.bulletListMarker+"   ",o=t.parentNode;if(o.nodeName==="OL"){var i=o.getAttribute("start"),s=Array.prototype.indexOf.call(o.children,t);n=(i?Number(i)+s:s+1)+".  "}return n+e+(t.nextSibling&&!/\n$/.test(e)?`
`:"")}};Me.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Me.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){for(var n=t.firstChild.getAttribute("class")||"",o=(n.match(/language-(\S+)/)||[null,""])[1],i=t.firstChild.textContent,s=r.fence.charAt(0),l=3,a=new RegExp("^"+s+"{3,}","gm"),c;c=a.exec(i);)c[0].length>=l&&(l=c[0].length+1);var u=Hi(s,l);return`

`+u+o+`
`+i.replace(/\n$/,"")+`
`+u+`

`}};Me.horizontalRule={filter:"hr",replacement:function(e,t,r){return`

`+r.hr+`

`}};Me.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var r=t.getAttribute("href"),n=io(t.getAttribute("title"));return n&&(n=' "'+n+'"'),"["+e+"]("+r+n+")"}};Me.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,r){var n=t.getAttribute("href"),o=io(t.getAttribute("title"));o&&(o=' "'+o+'"');var i,s;switch(r.linkReferenceStyle){case"collapsed":i="["+e+"][]",s="["+e+"]: "+n+o;break;case"shortcut":i="["+e+"]",s="["+e+"]: "+n+o;break;default:var l=this.references.length+1;i="["+e+"]["+l+"]",s="["+l+"]: "+n+o}return this.references.push(s),i},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};Me.emphasis={filter:["em","i"],replacement:function(e,t,r){return e.trim()?r.emDelimiter+e+r.emDelimiter:""}};Me.strong={filter:["strong","b"],replacement:function(e,t,r){return e.trim()?r.strongDelimiter+e+r.strongDelimiter:""}};Me.code={filter:function(e){var t=e.previousSibling||e.nextSibling,r=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!r},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",r="`",n=e.match(/`+/gm)||[];n.indexOf(r)!==-1;)r=r+"`";return r+t+e+t+r}};Me.image={filter:"img",replacement:function(e,t){var r=io(t.getAttribute("alt")),n=t.getAttribute("src")||"",o=io(t.getAttribute("title")),i=o?' "'+o+'"':"";return n?"!["+r+"]("+n+i+")":""}};function io(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function Jl(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}Jl.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=Di(this.array,e,this.options))||(t=Di(this._keep,e,this.options))||(t=Di(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function Di(e,t,r){for(var n=0;n<e.length;n++){var o=e[n];if(Yd(o,t,r))return o}}function Yd(e,t,r){var n=e.filter;if(typeof n=="string"){if(n===t.nodeName.toLowerCase())return!0}else if(Array.isArray(n)){if(n.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof n=="function"){if(n.call(e,t,r))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function Kd(e){var t=e.element,r=e.isBlock,n=e.isVoid,o=e.isPre||function(p){return p.nodeName==="PRE"};if(!(!t.firstChild||o(t))){for(var i=null,s=!1,l=null,a=ql(l,t,o);a!==t;){if(a.nodeType===3||a.nodeType===4){var c=a.data.replace(/[ \r\n\t]+/g," ");if((!i||/ $/.test(i.data))&&!s&&c[0]===" "&&(c=c.substr(1)),!c){a=Bi(a);continue}a.data=c,i=a}else if(a.nodeType===1)r(a)||a.nodeName==="BR"?(i&&(i.data=i.data.replace(/ $/,"")),i=null,s=!1):n(a)||o(a)?(i=null,s=!0):i&&(s=!1);else{a=Bi(a);continue}var u=ql(l,a,o);l=a,a=u}i&&(i.data=i.data.replace(/ $/,""),i.data||Bi(i))}}function Bi(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function ql(e,t,r){return e&&e.parentNode===t||r(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var Zl=typeof window<"u"?window:{};function Xd(){var e=Zl.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function Qd(){var e=function(){};return Jd()?e.prototype.parseFromString=function(t){var r=new window.ActiveXObject("htmlfile");return r.designMode="on",r.open(),r.write(t),r.close(),r}:e.prototype.parseFromString=function(t){var r=document.implementation.createHTMLDocument("");return r.open(),r.write(t),r.close(),r},e}function Jd(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{window.ActiveXObject&&(e=!0)}return e}var Zd=Xd()?Zl.DOMParser:Qd();function ef(e,t){var r;if(typeof e=="string"){var n=tf().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");r=n.getElementById("turndown-root")}else r=e.cloneNode(!0);return Kd({element:r,isBlock:Ui,isVoid:Kl,isPre:t.preformattedCode?rf:null}),r}var Fi;function tf(){return Fi=Fi||new Zd,Fi}function rf(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function nf(e,t){return e.isBlock=Ui(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=of(e),e.flankingWhitespace=sf(e,t),e}function of(e){return!Kl(e)&&!qd(e)&&/^\s*$/i.test(e.textContent)&&!$d(e)&&!jd(e)}function sf(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var r=af(e.textContent);return r.leadingAscii&&jl("left",e,t)&&(r.leading=r.leadingNonAscii),r.trailingAscii&&jl("right",e,t)&&(r.trailing=r.trailingNonAscii),{leading:r.leading,trailing:r.trailing}}function af(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function jl(e,t,r){var n,o,i;return e==="left"?(n=t.previousSibling,o=/ $/):(n=t.nextSibling,o=/^ /),n&&(n.nodeType===3?i=o.test(n.nodeValue):r.preformattedCode&&n.nodeName==="CODE"?i=!1:n.nodeType===1&&!Ui(n)&&(i=o.test(n.textContent))),i}var lf=Array.prototype.reduce,cf=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function so(e){if(!(this instanceof so))return new so(e);var t={rules:Me,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(r,n){return n.isBlock?`

`:""},keepReplacement:function(r,n){return n.isBlock?`

`+n.outerHTML+`

`:n.outerHTML},defaultReplacement:function(r,n){return n.isBlock?`

`+r+`

`:r}};this.options=Wd({},t,e),this.rules=new Jl(this.options)}so.prototype={turndown:function(e){if(!df(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=ec.call(this,new ef(e,this.options));return uf.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return cf.reduce(function(t,r){return t.replace(r[0],r[1])},e)}};function ec(e){var t=this;return lf.call(e.childNodes,function(r,n){n=new nf(n,t.options);var o="";return n.nodeType===3?o=n.isCode?n.nodeValue:t.escape(n.nodeValue):n.nodeType===1&&(o=pf.call(t,n)),tc(r,o)},"")}function uf(e){var t=this;return this.rules.forEach(function(r){typeof r.append=="function"&&(e=tc(e,r.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function pf(e){var t=this.rules.forNode(e),r=ec.call(this,e),n=e.flankingWhitespace;return(n.leading||n.trailing)&&(r=r.trim()),n.leading+t.replacement(r,e,this.options)+n.trailing}function tc(e,t){var r=Vd(e),n=zd(t),o=Math.max(e.length-r.length,t.length-n.length),i=`

`.substring(0,o);return r+i+n}function df(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}var ao=so;var ff=async()=>{try{let e=document.cloneNode(!0),r=new rc.Readability(e).parse();if(!r||!r?.content)return document.body.innerText||"";let o=new ao().turndown(r?.content||"");return`# ${r?.title}

${o}
`}catch{return""}},zi=ff;var fr=e=>{if(!e)return"";let t=e.cloneNode(!0);Array.from(t.querySelectorAll("br")).forEach(o=>{o.replaceWith(`

`)});let r=[];return de()==="mail.google.com"&&(r.push(...Array.from(t.querySelectorAll(".adL"))),r.push(...Array.from(t.querySelectorAll(".adm")).map(o=>o.parentElement)),r.push(...Array.from(t.querySelectorAll(".gmail_quote"))),r.push(...Array.from(t.querySelectorAll(".iX")))),t.querySelectorAll("div[id]").forEach(o=>{if(o.id.includes("mail-quote")){r.push(o);return}if(o.id.includes("RplyFwdMsg")){r.push(o.nextElementSibling),r.push(o);return}}),t.querySelectorAll("div[class]").forEach(o=>{if(o.className.includes("gmail_quote")){r.push(o);return}}),t.querySelectorAll("blockquote").forEach(o=>{r.push(o)}),r.forEach(o=>{try{o.remove()}catch{}}),t.innerText};var mf=[{website:"mail.google.com",traffic:4.57},{website:"mail.yahoo.com",traffic:1.79},{website:"outlook.live.com",traffic:1.63},{website:"outlook.office.com",traffic:1.63},{website:"outlook.office365.com",traffic:1.63},{website:"navigator-lxa.mail.com",traffic:1.51},{website:"mail.proton.me",traffic:.54},{website:"icloud.com",traffic:.51},{website:"mail.zoho.com",traffic:.45},{website:"mail.qq.com",traffic:.37},{website:"wx.mail.qq.com",traffic:.36}],gf=mf.map(e=>e.website),nc=()=>{let e=de();return gf.includes(e)?e==="icloud.com"?window.location.href.includes("icloud.com/mail"):e==="outlook.live.com"?window.location.href.includes("outlook.live.com/mail"):e==="outlook.office.com"?window.location.href.includes("outlook.office.com/mail"):e==="outlook.office365.com"?window.location.href.includes("outlook.office365.com"):!0:!1},eb=async e=>{let t=document.querySelector(e),r=de(),n="",o=document.documentElement;if(r==="mail.google.com"&&(document.querySelectorAll('table[role="presentation"]').forEach(i=>{i.contains(t)&&(o=i)}),n='div[role="textbox"]'),r==="outlook.office.com"||r==="outlook.live.com"||r==="outlook.office365.com"){let s=t.parentElement,l=null,a=0;for(;!l&&a<20;)s=s?.parentElement,l=s?.querySelector('div[role="textbox"][textprediction]')||s?.querySelector('div[id] > div[role="textbox"]')||null,a++;return l?fr(l):""}try{if(n){let i=o.querySelector(n);return fr(i)}return""}catch{return""}},Vr=class{constructor(){this.emails=[]}addSender(t){this.sender=t}addReceiver(t){this.receiver=t}addEmail(t,r){this.sender&&this.receiver&&(t===this.sender?.email?this.emails.push({from:this.sender,to:this.receiver,...r}):this.emails.push({from:this.receiver,to:this.sender,...r}))}sortEmails(){this.emails.sort((t,r)=>new Date(t.date).getTime()-new Date(r.date).getTime())}formatText(){return this.emails.map((t,r)=>`## Email #${r+1}
**From:** ${t.from.name}<${t.from.email}>
**To:** ${t.to.name}<${t.to.email}>
**Date:** ${t.date}
**Subject:** ${t.subject}

${t.content}

---
`).join(`
`).replace(/\n{2,}/g,`

`)}},hf=e=>{if(document.createEvent){let t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1),e.dispatchEvent(t)}else typeof e.onclick=="function"&&e.onclick()},tb=async e=>{let t=c=>new Promise(u=>setTimeout(u,c)),r=de(),n=/[\w.-]+@[\w.-]+\.[A-Za-z]{2,}/g,o=!1,i="",s="body",l=e&&document.querySelector(e)||null;if(r==="mail.google.com"){let c=document.querySelector('div[role="list"]');if(c){let u=new Vr,p=c.querySelector('span[role="button"][aria-expanded][tabindex="-1"]');p&&(p.click(),await t(3e3));let f=[];Array.from(c.querySelectorAll('div[role="listitem"]')).find(g=>g.contains(l)?(f.push(g),!0):(f.push(g),!1));for(let g=0;g<f.length;g++)if(f[g].querySelectorAll("table span[email]").length>=2){let m=Array.from(f[g].querySelectorAll("table span[email]")),v="";document.querySelectorAll('a[aria-label][role="button"]').forEach(x=>{x?.getAttribute("aria-label")?.includes("@gmail.com")&&(v=x?.getAttribute("aria-label")?.match(n)?.[0]||"")});let h=m.find(x=>x.getAttribute("email")===v),b=m.find(x=>x.getAttribute("email")!==v);u.addSender({email:h?.getAttribute("email")||"",name:h?.getAttribute("name")||""}),u.addReceiver({email:b?.getAttribute("email")||"",name:b?.getAttribute("name")||""});break}let d=document.querySelector("h2[data-thread-perm-id]")?.textContent||document.title;return f.forEach(g=>{let m=g.querySelector("div[data-message-id]")||g.querySelector("div[data-legacy-message-id]"),v=g.querySelector('span[tabindex="-1"][alt]')?.textContent||"",h=g.querySelector("h3 span[email]")?.getAttribute("email")||g.querySelector("span[email]")?.getAttribute("email");if(h)if(m){let b=fr(g.querySelector("div[id][jslog] > div[id]"));u.addEmail(h,{content:b,date:v,subject:d})}else{let b=g.querySelector('div[role="gridcell"] span')?.textContent||"";u.addEmail(h,{content:b,date:v,subject:d})}}),u.formatText()}else s='div[role="list"]'}if(r==="outlook.office.com"||r==="outlook.live.com"||r==="outlook.office365.com")try{let c=document.querySelector('#ReadingPaneContainerId div[role="heading"][aria-level="2"]')?.textContent||document.title;document.querySelector('div[role="button"][aria-label="See more messages"]')?.click();let p=document.querySelector('div[data-app-section="ConversationContainer"]');if(p&&p.contains(l)){let h=new Vr,b=[],x=Array.from(p.querySelectorAll("& > div > div")),w=x.find(N=>N.contains(l))?.querySelector('div[data-testid="SentReceivedSavedTime"]')?.textContent||"";x.forEach(N=>{let k=N.querySelector('div[data-testid="SentReceivedSavedTime"]')?.textContent||"";new Date(k).getTime()<=new Date(w).getTime()&&b.push(N),N.querySelectorAll("& > div > div").forEach(y=>hf(y))});let T=document.querySelector("#meInitialsButton");for(;!document.querySelector("#mectrl_currentAccount_primary");)T.click(),await t(2e3);let P=document.querySelector("#mectrl_currentAccount_primary")?.textContent||"",D=document.querySelector("#mectrl_currentAccount_secondary")?.textContent||"";for(let N=0;N<b.length;N++){let k=Array.from(b[N].querySelectorAll("span[data-lpc-hover-target-id]")),E=b[N].querySelector('div[data-testid="RecipientWell"]');if(!E||k.length===0)continue;let y=b[N].querySelector('div[data-testid="SentReceivedSavedTime"]')?.textContent||"",_=fr(b[N].querySelector("#UniqueMessageBody")||b[N].querySelector('div[role="document"]'));k.find(A=>{let I=A.textContent||"",M=I.match(n)?.[0];if(!M&&I===h.sender?.name?M=h.sender.email:!M&&I===h.receiver?.name&&(M=h.receiver.email),M){let H=!1;E?.contains(A)&&(H=!0);let V=I.replace(` <${M}>`,"");if(V&&M){if((!h.receiver||!h.sender)&&(H?(h.addReceiver({name:V,email:M}),h.addSender({name:P,email:D})):(h.addSender({name:V,email:M}),h.addReceiver({name:P,email:D}))),H){let R=h.sender?.email===M?h.receiver.email:h.sender.email;h.addEmail(R,{date:y,subject:c,content:_})}else h.addEmail(M,{date:y,subject:c,content:_});return!0}}return!1})}if(h.sortEmails(),h.emails.length>0)return h.formatText();s='div[data-app-section="ConversationContainer"]'}let f=h=>{let b=h,x=0;for(;!b.querySelector("#divRplyFwdMsg")&&!b.querySelector("#divRplyFwdMsg")&&x<10;)x++,b=b.parentElement;let w=b.cloneNode(!0),T=new Vr,P=w.querySelector("#divRplyFwdMsg")||w.querySelector("#RplyFwdMsg"),D=P?.nextElementSibling;if(P&&D){let N=Array.from(P.querySelector("font")?.childNodes||[]).filter(k=>!k.tagName);if(N.length===4){let k=N[0].textContent?.match(n)?.[0],E=N[0].textContent?.replace(` <${k}>`,""),y=N[2].textContent?.match(n)?.[0],_=N[2].textContent?.replace(` <${y}>`,""),A=N[1].textContent||"",I=N[3].textContent||"";if(k&&E&&y&&_&&A&&I){T.addSender({email:k,name:E}),T.addReceiver({email:y,name:_}),P.remove();let M=fr(D);return T.addEmail(k,{date:A,subject:I,content:M}),T.formatText()}}}return""},d=document.querySelector('div[role="dialog"] div[role="textbox"][textprediction]')||document.querySelector('div[role="dialog"] div[id] > div[role="textbox"]'),g=Array.from(document.querySelectorAll('div[role="dialog"]')).find(h=>h.contains(d));if(g&&g.contains(l)){let h=f(d);if(h)return h;s="#ReadingPaneContainerId"}let m=document.querySelector('#ReadingPaneContainerId div[id] > div[role="textbox"]');if(document.querySelector("#ReadingPaneContainerId")?.contains(l)){let h=f(m);if(h)return h;s="#ReadingPaneContainerId"}}catch{s='div[data-app-section="ConversationContainer"]'}r==="mail.yahoo.com"&&(s='div[data-test-id="message-group-view-scroller"]'),r==="wx.mail.qq.com"&&(s="div.container"),r==="mail.proton.me"&&(document.querySelectorAll("div.scroll-inner .message-header").forEach(c=>{o=!0,c.click()}),i="iframe[sandbox]",s="div#proton-root"),r==="mail.zoho.com"&&(document.querySelectorAll("div.zmPVContent .zmTMailList .zmMHdrSumContent").forEach(c=>{o=!0,c.click()}),s="div.zmPVContent"),o&&await t(3e3);let a=[document.documentElement];i&&(a=Array.from(document.querySelectorAll(i)));try{return(await Promise.all(a.map(async u=>{let p=u?.contentDocument||u?.ownerDocument||document;if(!p?.querySelector)return"";let f=p.querySelector(s);return f?f.innerText:await zi()}))).join("")}catch{return await zi()}};var yf={PAGE_SUMMARY:{id:"f734efe5-c63e-490e-a0f1-ae5a248e0f16",parent:"root",droppable:!1,text:"Summarize page",data:{editable:!1,type:"shortcuts",actions:[{type:"GET_READABILITY_CONTENTS_OF_WEBPAGE",parameters:{}},{type:"SET_VARIABLE",parameters:{VariableName:"READABILITY_CONTENTS"}},{type:"ANALYZE_CHAT_FILE",parameters:{AnalyzeChatFileImmediateUpdateConversation:!1,AnalyzeChatFileName:"PageSummaryContent.txt"}},{type:"ASK_CHATGPT",parameters:{template:`Ignore all previous instructions. You are a highly proficient researcher that can read and write properly and fluently, and can extract all important information from any text. Your task is to summarize and extract all key takeaways of the context text delimited by triple backticks in all relevant aspects.

The context text is sourced from the main content of the webpage at {{CURRENT_WEBPAGE_URL}}.

Output a summary and a list of key takeaways respectively.
The summary should be a one-liner in at most 100 words.
The key takeaways should be in up to seven bulletpoints, the fewer the better.

---

Use the following format:
## \u{1F310} {{CURRENT_WEBPAGE_TITLE}}

### Summary
<summary of the text>

### Key Takeaways
<list of key takeaways>

---

You must add these two lines at the bottom of the response:
### Deep Dive
Ask AI anything about the page...

Respond in {{AI_RESPONSE_LANGUAGE}}.`}},{type:"SET_VARIABLE",parameters:{VariableName:"SUMMARY_CONTENTS"}},{type:"CREATE_WEBSITE_CONTEXT",parameters:{CreateWebsiteContextConfig:{summary:"{{SUMMARY_CONTENTS}}",meta:{readability:"{{READABILITY_CONTENTS}}"}}}}],visibility:{isWhitelistMode:!1,whitelist:[],blacklist:[]}}},DEFAULT_EMAIL_SUMMARY:{id:"8ed1bf33-efc9-4714-8b21-09ceede3e2a8",parent:"root",droppable:!1,text:"Summarize email",data:{editable:!1,type:"shortcuts",actions:[{type:"GET_EMAIL_CONTENTS_OF_WEBPAGE",parameters:{}},{type:"SET_VARIABLE",parameters:{VariableName:"READABILITY_CONTENTS"}},{type:"ANALYZE_CHAT_FILE",parameters:{AnalyzeChatFileImmediateUpdateConversation:!1,AnalyzeChatFileName:"EmailSummaryContent.txt"}},{type:"ASK_CHATGPT",parameters:{template:`Ignore all previous instructions. You are a highly proficient researcher that can read and write properly and fluently, and can extract all important information from any text. Your task is to summarize and extract all key takeaways and action items of the context text delimited by triple backticks in all relevant aspects. 

The context text comprises email messages from an email thread you received or sent on {{CURRENT_WEBSITE_DOMAIN}}.

Output a summary, a list of key takeaways, and a list of action items respectively.
The summary should be a one-liner in at most 100 words. 
The key takeaways should be in up to seven bulletpoints, the fewer the better.
When extracting the action items, identify only the action items that need the reader to take action, and exclude action items requiring action from anyone other than the reader. Output the action items in bulletpoints, and pick a good matching emoji for every bullet point.

---

Use the following format:
## \u{1F4E7} {{CURRENT_WEBPAGE_TITLE}}

### Summary
<summary of the text>

### Key Takeaways
<list of key takeaways>

### Action Items
<list of action items>

---

You must add these two lines at the bottom of the response:
### Deep Dive
Ask AI anything about the email...

Respond in {{AI_RESPONSE_LANGUAGE}}.`}},{type:"SET_VARIABLE",parameters:{VariableName:"SUMMARY_CONTENTS"}},{type:"CREATE_WEBSITE_CONTEXT",parameters:{CreateWebsiteContextConfig:{summary:"{{SUMMARY_CONTENTS}}",meta:{readability:"{{READABILITY_CONTENTS}}"}}}}],visibility:{isWhitelistMode:!1,whitelist:[],blacklist:[]}}},PDF_CRX_SUMMARY:{id:"0c8c8bd7-1072-4fb7-9fad-cf6447b33896",parent:"root",droppable:!1,text:"Summarize PDF",data:{editable:!1,type:"shortcuts",actions:[{type:"GET_PDF_CONTENTS_OF_CRX",parameters:{}},{type:"SET_VARIABLE",parameters:{VariableName:"READABILITY_CONTENTS"}},{type:"ANALYZE_CHAT_FILE",parameters:{AnalyzeChatFileImmediateUpdateConversation:!1,AnalyzeChatFileName:"PDFSummaryContent.txt"}},{type:"ASK_CHATGPT",parameters:{template:`Ignore all previous instructions. You are a highly proficient researcher that can read and write properly and fluently, and can extract all important information from any text. Your task is to summarize and extract all key takeaways of the context text delimited by triple backticks in all relevant aspects. 

The context text originates from the main content of a PDF viewed on the browser at {{CURRENT_WEBPAGE_URL}}.

Output a summary and a list of key takeaways respectively.
The summary should be a one-liner in at most 100 words.
The key takeaways should be in up to seven bulletpoints, the fewer the better.

---

Use the following format:
## \u{1F4C4} {{CURRENT_WEBPAGE_TITLE}}

### Summary
<summary of the text>

### Key Takeaways
<list of key takeaways>

---

You must add these two lines at the bottom of the response:
### Deep Dive
Ask AI anything about the PDF...

Respond in {{AI_RESPONSE_LANGUAGE}}.`}},{type:"SET_VARIABLE",parameters:{VariableName:"SUMMARY_CONTENTS"}},{type:"CREATE_WEBSITE_CONTEXT",parameters:{CreateWebsiteContextConfig:{summary:"{{SUMMARY_CONTENTS}}",meta:{readability:"{{READABILITY_CONTENTS}}"}}}}],visibility:{isWhitelistMode:!1,whitelist:[],blacklist:[]}}},YOUTUBE_VIDEO_SUMMARY:{id:"215bf574-3a68-4ac8-8fff-ccdd19150cb9",parent:"root",droppable:!1,text:"Summarize video",data:{editable:!1,type:"shortcuts",actions:[{type:"GET_YOUTUBE_TRANSCRIPT_OF_URL",parameters:{}},{type:"ANALYZE_CHAT_FILE",parameters:{AnalyzeChatFileName:"YouTubeSummaryContent.txt",AnalyzeChatFileImmediateUpdateConversation:!1}},{type:"SET_VARIABLE",parameters:{VariableName:"READABILITY_CONTENTS"}},{type:"ASK_CHATGPT",parameters:{template:`Ignore all previous instructions. You are a highly proficient researcher that can read and write properly and fluently, and can extract all important information from any text. Your task is to summarize and extract all key takeaways of the context text delimited by triple backticks in all relevant aspects. 

The context text is the transcript of a video from {{CURRENT_WEBPAGE_URL}}.

Output a summary and a list of key takeaways respectively.
The summary should be a one-liner in at most 100 words.
The key takeaways should be in up to seven bulletpoints, the fewer the better.

---

Use the following format:
## \u{1F4FA} {{CURRENT_WEBPAGE_TITLE}}

### Summary
<summary of the text>

### Key Takeaways
<list of key takeaways>

---

You must add these two lines at the bottom of the response:
### Deep Dive
Ask AI anything about the video...

Respond in {{AI_RESPONSE_LANGUAGE}}.`}},{type:"SET_VARIABLE",parameters:{VariableName:"SUMMARY_CONTENTS"}},{type:"CREATE_WEBSITE_CONTEXT",parameters:{CreateWebsiteContextConfig:{summary:"{{SUMMARY_CONTENTS}}",meta:{readability:"{{READABILITY_CONTENTS}}"}}}}],visibility:{isWhitelistMode:!1,whitelist:[],blacklist:[]}}}},ub=e=>{let t=ue(yf[e]);return(t.data.actions||[]).map(r=>(r.type==="ASK_CHATGPT"&&(r.parameters.AskChatGPTActionMeta={contextMenu:ue(t)}),r))},vf=()=>window.location.href,oc=()=>Vl(vf()),lo=()=>{if(de()==="youtube.com"&&oo.retrieveVideoId(window.location.href))return"YOUTUBE_VIDEO_SUMMARY";let e=new URL(location.href),t=`${Vi.default.runtime.id}/pages/pdf/web/viewer.html`;return e.href.includes(t)?"PDF_CRX_SUMMARY":nc()?"DEFAULT_EMAIL_SUMMARY":"PAGE_SUMMARY"},pb=async()=>{let e="";return Gl()?e=await $l():bf()&&(e=await xf()),e=e.trim(),e},bf=()=>{let e=de();return["docs.google.com"].find(t=>t===e)},xf=async()=>de()==="docs.google.com"?new Promise(t=>{let r=ne(),n=document.createElement("script");n.type="module",n.src=Vi.default.runtime.getURL("pages/googleDoc/index.js"),n.setAttribute("data-event-id",r),n.id="MAXAI_GOOGLE_DOC_CONTENT_SCRIPT",document.body.appendChild(n);let o=!1;window.addEventListener(`${r}res`,i=>{o||(o=!0,t(i.detail))},{once:!0}),setTimeout(()=>{o||(o=!0,t(""))},1e4)}):"";var mr=ar(async(e,t)=>{try{let r=t;if(t==="PAGE_SUMMARY")switch(lo()){case"PDF_CRX_SUMMARY":r+="(PDF)";break;case"PAGE_SUMMARY":r+="(DEFAULT)";break;case"YOUTUBE_VIDEO_SUMMARY":r+="(YOUTUBE)";break;case"DEFAULT_EMAIL_SUMMARY":r+="(EMAIL)";break;default:break}await new ae().postMessage({event:"Client_emitPricingHooks",data:{action:e,name:r}})}catch{}},1e3);var Gr=C(z());var Tf=()=>{let[e]=ie(Rn),[t,r]=(0,Gr.useState)(!1),[n,o]=(0,Gr.useState)(!1),[i,s]=ie(Xn);return dt(()=>{o(!0),Ht().then(l=>{l&&s(a=>({...a,isLogin:!0})),r(!0),o(!1)}).catch(()=>{r(!0),o(!1)})}),Lt(()=>{Ht().then(l=>{s(l?a=>({...a,isLogin:!0}):a=>({...a,isLogin:!1}))})}),(0,Gr.useEffect)(()=>{e.open&&Ht().then(l=>{s(l?a=>({...a,isLogin:!0}):a=>({...a,isLogin:!1}))})},[e.open]),{isLogin:i.isLogin,loaded:t,loading:n}};var Gi=C(z());var $i=e=>{let{t}=ve(["common","client"]);return(0,Gi.useMemo)(()=>{let r=Si(e);return{title:r.title(t),description:r.description(t),ctaButtonText:r.ctaButtonText(t),ctaButtonLink:r.ctaButtonLink,ctaButtonOnClick:r.ctaButtonOnClick,imageUrl:r.imageUrl,videoUrl:r.videoUrl,sceneType:e}},[e,t])},ic=()=>{let{t:e}=ve(["common","client"]);return(0,Gi.useMemo)(()=>{let t={};return Ha.forEach(r=>{let n=Si(r),o={title:n.title(e),description:n.description(e),ctaButtonText:n.ctaButtonText(e),ctaButtonLink:n.ctaButtonLink,ctaButtonOnClick:n.ctaButtonOnClick,imageUrl:n.imageUrl,videoUrl:n.videoUrl,sceneType:r};t[r]=o}),t},[e])};var Cf=e=>{let{sceneType:t,allowedRoles:r,onPermission:n,BoxProps:o,TooltipProps:i,children:s}=e,l=$i(t),[a,c]=(0,oe.useState)(void 0),u=(0,oe.useMemo)(()=>a||l,[l,a]),{currentUserPlan:p}=$r(),[f,d]=(0,oe.useState)(!1),g=(0,oe.useRef)(ne());return(0,oe.useEffect)(()=>{let v=h=>{h.detail.id!==g.current&&d(h.detail.open)};return window.addEventListener("maxAIPermissionWrapperCustomEvent",v),()=>{window.removeEventListener("maxAIPermissionWrapperCustomEvent",v)}},[]),(0,oe.useMemo)(()=>!!(r.find(v=>v===p.name)||r.find(v=>v==="new_user")&&p?.isNewUser),[p,r])?oe.default.createElement(oe.default.Fragment,null,s):oe.default.createElement(zn,{arrow:!0,open:f,PopperProps:{sx:{"& > div":{maxWidth:316,p:1}},...i?.PopperProps},title:oe.default.createElement(to.default,{mouseEvent:"onMouseDown",onClickAway:()=>{d(!1)}},oe.default.createElement(W,{spacing:1,component:"div",width:300},u.videoUrl&&oe.default.createElement(wl,{borderRadius:4,cover:u.imageUrl,youtubeLink:u.videoUrl}),!u.videoUrl&&u.imageUrl&&oe.default.createElement(ye,{sx:{width:"100%",height:"auto",borderRadius:"4px",overflow:"hidden","& img":{width:"100%",height:"auto"}}},oe.default.createElement(Hl,{height:140,src:u.imageUrl,alt:`${u.title} img`})),oe.default.createElement($,{fontSize:"14px",fontWeight:600,textAlign:"left",color:"rgba(255,255,255,.87)"},u.title),oe.default.createElement($,{fontSize:"12px",fontWeight:400,textAlign:"left",color:"rgba(255,255,255,.87)"},u.description),u.ctaButtonText&&oe.default.createElement(qe,{target:"_blank",href:u.ctaButtonLink,onClick:v=>{v.preventDefault(),window.open(u.ctaButtonLink,"_blank"),u.ctaButtonOnClick?.(v),d(!1),mr("click",l.sceneType)}},oe.default.createElement(Qt,{fullWidth:!0,variant:"contained"},u.ctaButtonText)))),...i},oe.default.createElement(ye,{...o},oe.default.createElement(ye,null,oe.default.Children.map(s,v=>{if(oe.default.isValidElement(v)){let h={...v.props,...v.props.onClick&&{onClick:async(b,...x)=>{let w=!1;if(b?.stopPropagation?.(),b?.preventDefault?.(),n){let{success:P,cardSettings:D}=await n(p,l,[b,...x]);c({...l,...D}),w=P}let T=new CustomEvent("maxAIPermissionWrapperCustomEvent",{detail:{id:g.current,open:!1}});window.dispatchEvent(T),d(!w),w?v.props?.onClick?.(b,...x):mr("show",l.sceneType)}},...v.props.onChange&&{onChange:async(b,...x)=>{let w=!1;if(b?.stopPropagation?.(),b?.preventDefault?.(),n){let{success:P,cardSettings:D}=await n(p,l,[b,...x]);c({...l,...D}),w=P}let T=new CustomEvent("maxAIPermissionWrapperCustomEvent",{detail:{id:g.current,open:!1}});window.dispatchEvent(T),d(!w),w?v.props?.onChange?.(b,...x):mr("show",l.sceneType)}}};return oe.default.cloneElement(v,h)}return v}))))},co=Cf;var qi=(e,t)=>{let r=0,n=e.find((o,i)=>o.value===t?(r=i,!0):!1);return[t,n,r]},ji=({defaultValue:e,emptyText:t,options:r,renderLabel:n,labelProp:o,MenuProps:i,sx:s,placeholder:l,onChange:a,loading:c=!1,renderFooter:u,renderHeader:p,label:f,labelSx:d,onPermission:g,displayLoading:m=!0,...v})=>{let[h,b]=(0,ge.useState)(e||""),[x,w]=ge.default.useState(!1),T=()=>{w(!1)},P=()=>{w(!0)},D=(0,ge.useMemo)(()=>!da(r)&&!c,[r,c]),N=(E,y,_)=>n?n(E,y||{},_):ge.default.createElement(Da,{sx:{fontSize:"14px",color:"text.primary"}},ge.default.createElement($,{sx:{fontSize:"14px",color:"text.primary"},component:"span"},y.label));(0,ge.useEffect)(()=>{!h&&e&&b(e)},[e]),(0,ge.useEffect)(()=>{r.length&&!c&&h&&(r.find(y=>y.value===h)||b(""))},[r,h,c]);let k=(0,ge.useMemo)(()=>r.map((E,y)=>E.origin.permission?ge.default.createElement(co,{key:y,sceneType:E.origin.permission.sceneType,allowedRoles:E.origin.permission.roles,onPermission:g},ge.default.createElement(Ct,{sx:{...o},selected:E.value===v.value,disabled:E.origin.disabled,value:E.value,onClick:_=>{E.origin.disabled&&(_.stopPropagation(),_.preventDefault()),b(E.value),a&&a(...qi(r,E.value)),T()}},N(E.value,E,y))):ge.default.createElement(Ct,{sx:{...o},key:y,disabled:E.origin.disabled,value:E.value,onClick:_=>{E.origin.disabled&&(_.stopPropagation(),_.preventDefault())}},N(E.value,E,y))),[r,v.value,N]);return ge.default.createElement(Dt,null,f&&ge.default.createElement(Bt,{id:"demo-simple-select-label",sx:{fontSize:"14px",color:"text.primary",...d}},f),ge.default.createElement(Ft,{open:x,onClose:T,onOpen:P,label:f,sx:{width:220,lineHeight:"40px",padding:"8px 12px",height:40,fontSize:"14px","& > .use-chat-gpt-ai--MuiSelect-select":{padding:0,"& > div":{margin:0}},...s},value:h,onChange:(E,y)=>{y.props.disabled||(b(E.target.value),a&&a(...qi(r,E.target.value)))},renderValue:E=>!E&&l||r.length===0?ge.default.createElement("em",null,l):N(...qi(r,E)),MenuProps:i,displayEmpty:!0,...v},c&&m&&ge.default.createElement(Vn,{size:16,loading:c}),!D&&p,!D&&k,!D&&u,D&&ge.default.createElement(El,{emptyText:t})))};var Ve=C(z());var Yi=C(z());var Sf=()=>{let[e,t]=ie(vt),r=e.sidebarSettings?.common?.currentAIProvider,n=(0,Yi.useMemo)(()=>{if(e.thirdProviderSettings&&r&&e.thirdProviderSettings[r])return e.thirdProviderSettings?.[r]},[r,e.thirdProviderSettings]);return{fetchThirdProviderSettings:async s=>{try{return await bt(s)}catch{return}},saveThirdProviderSettings:async(s,l)=>{await Or(s,l)&&t(await _e())},currentThirdProviderSettings:n}},sc=e=>{let[t,r]=ie(vt);return[(0,Yi.useMemo)(()=>t.thirdProviderSettings?.[e],[t.thirdProviderSettings,e]),async i=>{await Or(e,i)&&r(await _e())}]},uo=Sf;var Ef=()=>{let[e]=ie(vt),t=e.sidebarSettings?.common?.currentAIProvider,[r,n]=(0,Ve.useState)(!1),{currentThirdProviderSettings:o,saveThirdProviderSettings:i}=uo(),[s,l]=(0,Ve.useState)([]);(0,Ve.useEffect)(()=>{t==="OPENAI"&&za().then(g=>{l(g)})},[t]);let a=(0,Ve.useMemo)(()=>({OPENAI:(e.thirdProviderSettings?.OPENAI?.modelOptions||[]).map(g=>{let m;return g.slug==="gpt-4-code-interpreter"?m={accept:"",acceptTooltip:h=>h("client:provider__chatgpt_web_app__upload__accept_tooltip"),maxFileSize:-1,maxCount:1}:g.slug==="gpt-4"&&(m={accept:"image/webp,.webp,image/png,.png,image/gif,.gif,image/jpeg,.jpg,.jpeg",acceptTooltip:h=>h("client:provider__chatgpt_web_app__upload__accept_tooltip"),maxFileSize:-1,maxCount:1}),{title:g.title,value:g.slug,titleTag:g.tags?.find(h=>h.toLowerCase().includes("beta"))||g.tags?.find(h=>h.toLowerCase().includes("mobile"))||"",maxTokens:g.max_tokens,tags:g.tags||[],descriptions:[{label:h=>h("client:provider__model__tooltip_card__label__max_token"),value:h=>`${aa(g.max_tokens,0)} ${h("client:provider__model__tooltip_card__label__max_token__suffix")}`},{label:h=>h("client:provider__model__tooltip_card__label__description"),value:h=>{let b=g.description,x=`provider__chatgpt_web_app__${g.slug}__description`.replace(/-/g,"_"),w=`client:${x}`;return h(w)!==x?h(w):b}}],disabled:s.length>0?!s.includes(g.slug):!1,uploadFileConfig:m}}).reverse(),USE_CHAT_GPT_PLUS:Ln(ue(Bn)),BARD:ca,BING:la,OPENAI_API:Ln(ue(ma)),CLAUDE:yi,POE:ga,MAXAI_CLAUDE:Ln(ue(ha))}),[s,e.thirdProviderSettings?.OPENAI?.modelOptions]),c=(0,Ve.useMemo)(()=>{let g=[];return t&&(g=a[t]),g},[t,a]),u=(0,Ve.useMemo)(()=>o?.model||"",[t,o]),p=(0,Ve.useMemo)(()=>Fr.find(g=>g.value===t),[t]),f=(0,Ve.useMemo)(()=>c.find(g=>g.value===u),[u,c]),d=(0,Ve.useCallback)(async g=>{try{t&&c.find(m=>m.value===g)&&(n(!0),await i(t,{model:g}))}catch{}finally{n(!1)}},[t,c]);return(0,Ve.useEffect)(()=>{t==="CLAUDE"&&o?.model==="a2"&&d(yi[0].value)},[u,t]),{aiProvider:e.sidebarSettings?.common?.currentAIProvider,aiProviderModel:u,currentAIProviderDetail:p,currentAIProviderModelDetail:f,aiProviderModels:c,updateAIProviderModel:d,loading:r,AI_PROVIDER_MODEL_MAP:a}},po=Ef;var ac=C(z());var qr=async e=>{try{let r=await new ae().postMessage({event:"Client_getLiteConversation",data:{conversationId:e}});return r.success?r.data:void 0}catch{return}},wf=()=>{let[,e]=ie(pr),{currentSidebarConversationId:t}=ze();Nn(async(r,n,o)=>{switch(r){case"Client_listenUpdateConversationMessages":{let{conversation:i,conversationId:s}=n;return i?.id?e(l=>({...l,[i.id]:i})):s&&!i&&e(l=>{let a=ue(l);return delete a[s],a}),{success:!0}}break}}),(0,ac.useEffect)(()=>{t&&qr(t).then(r=>{r&&e(n=>({...n,[r.id]:r}))})},[t])},zx=wf;var lc=async e=>{let t=await _e(),r=t.sidebarSettings?.common?.currentAIProvider,n={AIProvider:r,AIModel:t.thirdProviderSettings?.[r]?.model||""};return e==="OPENAI_API"&&(n.systemPrompt=fa),n};var jr=new ae({runtime:"client"}),Vt=()=>{let[,e]=ie(Wt),t=pt(pr),{currentSidebarConversationType:r,currentSidebarConversationId:n,updateSidebarSettings:o}=ze(),{AI_PROVIDER_MODEL_MAP:i,updateAIProviderModel:s}=po();return{cleanConversation:async()=>{await jr.postMessage({event:"Client_removeChatGPTConversation",data:{conversationId:n}}),r==="Chat"?await o({chat:{conversationId:""}}):r==="Summary"?await o({summary:{conversationId:""}}):r==="Search"&&await o({search:{conversationId:""}}),t(f=>{let d=ue(f);return delete d[n||""],d}),e({model:"",writingMessage:null,loading:!1})},createConversation:async f=>{let d="",g=f||r;if(g==="Chat"){let m=(await _e()).sidebarSettings?.chat?.conversationId;if(m&&await qr(m))return m;let v=await _e(),h=v.sidebarSettings?.common?.currentAIProvider,b=v.thirdProviderSettings?.[h]?.model||"",x=(i?.[h]||[]).find(T=>T?.value===b)?.maxTokens||4096,w=await jr.postMessage({event:"Client_createChatGPTConversation",data:{initConversationData:{type:"Chat",meta:{maxTokens:x,...await lc(h)}}}});w.success&&(d=w.data.conversationId,await o({chat:{conversationId:d}}))}else if(g==="Summary"){if(d=oc(),d&&await qr(d))return d;await jr.postMessage({event:"Client_createChatGPTConversation",data:{initConversationData:{id:d,type:"Summary",meta:gi({AIProvider:"USE_CHAT_GPT_PLUS",AIModel:"gpt-3.5-turbo",maxTokens:16384,pageSummaryType:lo()})}}}),await o({summary:{conversationId:d}})}else if(g==="Search"){let m=(await _e()).sidebarSettings?.search?.conversationId;if(m&&await qr(m))return m;let v=await jr.postMessage({event:"Client_createChatGPTConversation",data:{initConversationData:{type:"Search",meta:gi({AIProvider:"USE_CHAT_GPT_PLUS",AIModel:"gpt-3.5-turbo",maxTokens:16384})}}});v.success&&(d=v.data.conversationId,await o({search:{conversationId:d}}))}return d},changeConversation:async f=>f&&n!==f?(await new ae().postMessage({event:"Client_changeConversation",data:{conversationId:f}})).success:!0,updateConversation:async(f,d)=>{await cc(d||n||"",f)},switchBackgroundChatSystemAIProvider:async(f,d)=>{let g=await jr.postMessage({event:"Client_switchAIProvider",data:{provider:f}});return g.success&&d&&await s(d),g.success}}};var fo=C(z()),uc=e=>{let t=(0,fo.useRef)();return(0,fo.useEffect)(()=>{t.current=e},[e]),t.current};var If=()=>{let{t:e}=ve(["common","client"]),{aiProviderModel:t,aiProviderModels:r,loading:n,updateAIProviderModel:o,aiProvider:i}=po(),s=uc(i),{cleanConversation:l,createConversation:a}=Vt(),{currentSidebarConversationType:c}=ze(),u=(0,se.useMemo)(()=>dl(r,{labelKey:"title",valueKey:"value"}),[r]),p=(0,se.useCallback)(async d=>{await o(d),c==="Chat"&&(await l(),await new Promise(g=>setTimeout(g,0)),await a())},[c,a,l,o]),f=(0,se.useRef)(p);return(0,se.useEffect)(()=>{f.current=p},[p]),(0,se.useEffect)(()=>{if(t&&r.length>0){let d=r.every(m=>m.value!==t),g=r.find(m=>m.value===t)?.disabled;if(d||g){for(let m=r.length-1;m>=0;m--)if(!r[m].disabled){p(r[m].value).then().catch();break}}}},[r,t]),(0,se.useEffect)(()=>{_e().then(d=>{if(s&&i&&s!==i){let g=d.thirdProviderSettings?.[i]?.model;g&&f.current(g)}})},[i]),se.default.createElement(ji,{displayLoading:!1,MenuProps:{elevation:0,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},MenuListProps:{sx:{border:"1px solid",borderColor:"customColor.borderColor"}}},onPermission:async()=>(i==="USE_CHAT_GPT_PLUS"&&await p(Bn[0].value),{success:!1}),sx:{width:"100%"},size:"small",loading:n,label:e("common:model"),labelSx:{fontSize:16},options:u,value:t,onChange:async d=>{await p(d)},labelProp:{p:0,pointerEvents:"auto!important"},renderValue:d=>{let g=u.find(m=>m.value===d);return se.default.createElement(W,{sx:{padding:"6px 0"},direction:"row",alignItems:"center",spacing:1},se.default.createElement($,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},e(g?.label||"client:provider__model__selector__placeholder")))},renderLabel:(d,g)=>{let m=g.origin;return se.default.createElement(ur,{placement:"left",PopperProps:{sx:{zIndex:2147483620}},componentsProps:{tooltip:{sx:{border:"1px solid rgb(224,224,224)",bgcolor:"background.paper",p:1}}},title:se.default.createElement(W,{spacing:1,width:"160px"},se.default.createElement(W,{textAlign:"left",width:"100%",spacing:2},m.disabled&&se.default.createElement($,{fontSize:"14px",color:"text.primary",textAlign:"left",fontWeight:700},e("client:provider__model__selector__disabled__description")),se.default.createElement($,{fontSize:"14px",color:"text.primary",textAlign:"left",fontWeight:"bold"},m?.title)),m.tags.length>0&&se.default.createElement(W,{direction:"row",flexWrap:"wrap",gap:"4px"},m.tags.map(v=>se.default.createElement(Ei,{sx:{fontSize:"12px",height:"18px",textTransform:"capitalize",flexShrink:0,"& > span":{px:"6px"}},key:v,label:v,color:"primary",size:"small",variant:"outlined"}))),m.descriptions.map((v,h)=>se.default.createElement(W,{spacing:.5,key:h},se.default.createElement($,{fontSize:"12px",color:"text.secondary",textAlign:"left"},v.label(e),":"),se.default.createElement($,{fontSize:"12px",color:"text.primary",textAlign:"left"},v.value(e)))))},se.default.createElement(W,{sx:{padding:"6px 16px"},width:"100%",direction:"row",alignItems:"center",spacing:1,onClick:v=>{m.disabled&&(v.stopPropagation(),v.preventDefault())}},se.default.createElement($,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},e(m.title||"client:provider__model__selector__placeholder")),m.titleTag&&se.default.createElement(Ei,{sx:{ml:1,textTransform:"capitalize",fontSize:"14px",flexShrink:0},label:m.titleTag,color:"primary",size:"small",variant:"outlined"})))}})},pc=If;var at=C(z());Yt();var Yr=C(z());var yo=C(Ot());var Ne=C(Nt()),xc=C(Hp()),Zt=C(Mr());var dc=C(Nt()),Pf=e=>!e||!(0,dc.isHostComponent)(e),fc=Pf;var ho=C(z());var go=C(Ot());var mc=C(jt()),gc=C(Xt());function hc(e){return(0,gc.default)("MuiSlider",e)}var _f=(0,mc.unstable_generateUtilityClasses)("MuiSlider",["root","active","colorPrimary","colorSecondary","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Ge=_f;var mo=C(Re()),yc=C(Re()),Af=e=>{let{open:t}=e;return{offset:(0,go.default)(t&&Ge.valueLabelOpen),circle:Ge.valueLabelCircle,label:Ge.valueLabelLabel}};function Ki(e){let{children:t,className:r,value:n}=e,o=Af(e);return t?ho.cloneElement(t,{className:(0,go.default)(t.props.className)},(0,yc.jsxs)(ho.Fragment,{children:[t.props.children,(0,mo.jsx)("span",{className:(0,go.default)(o.offset,r),"aria-hidden":!0,children:(0,mo.jsx)("span",{className:o.circle,children:(0,mo.jsx)("span",{className:o.label,children:n})})})]})):null}var Et=C(Re()),Xi=C(Re()),Rf=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"],vc=(e,t,r)=>(e-t)*100/(r-t);function bc(e){return e}var Mf=pe("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[`color${Xe(r.color)}`],r.size!=="medium"&&t[`size${Xe(r.size)}`],r.marked&&t.marked,r.orientation==="vertical"&&t.vertical,r.track==="inverted"&&t.trackInverted,r.track===!1&&t.trackFalse]}})(({theme:e,ownerState:t})=>B({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:(e.vars||e).palette[t.color].main,WebkitTapHighlightColor:"transparent"},t.orientation==="horizontal"&&B({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},t.size==="small"&&{height:2},t.marked&&{marginBottom:20}),t.orientation==="vertical"&&B({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},t.size==="small"&&{width:2},t.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},[`&.${Ge.disabled}`]:{pointerEvents:"none",cursor:"default",color:(e.vars||e).palette.grey[400]},[`&.${Ge.dragging}`]:{[`& .${Ge.thumb}, & .${Ge.track}`]:{transition:"none"}}}));var kf=pe("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(e,t)=>t.rail})(({ownerState:e})=>B({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},e.orientation==="horizontal"&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},e.orientation==="vertical"&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},e.track==="inverted"&&{opacity:1}));var Lf=pe("span",{name:"MuiSlider",slot:"Track",overridesResolver:(e,t)=>t.track})(({theme:e,ownerState:t})=>{let r=e.palette.mode==="light"?(0,Zt.lighten)(e.palette[t.color].main,.62):(0,Zt.darken)(e.palette[t.color].main,.5);return B({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:e.transitions.create(["left","width","bottom","height"],{duration:e.transitions.duration.shortest})},t.size==="small"&&{border:"none"},t.orientation==="horizontal"&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},t.orientation==="vertical"&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},t.track===!1&&{display:"none"},t.track==="inverted"&&{backgroundColor:e.vars?e.vars.palette.Slider[`${t.color}Track`]:r,borderColor:e.vars?e.vars.palette.Slider[`${t.color}Track`]:r})});var Of=pe("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.thumb,t[`thumbColor${Xe(r.color)}`],r.size!=="medium"&&t[`thumbSize${Xe(r.size)}`]]}})(({theme:e,ownerState:t})=>B({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow","left","bottom"],{duration:e.transitions.duration.shortest})},t.size==="small"&&{width:12,height:12},t.orientation==="horizontal"&&{top:"50%",transform:"translate(-50%, -50%)"},t.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":B({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(e.vars||e).shadows[2]},t.size==="small"&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&:hover, &.${Ge.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.16)`:(0,Zt.alpha)(e.palette[t.color].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${Ge.active}`]:{boxShadow:`0px 0px 0px 14px ${e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.16)`:(0,Zt.alpha)(e.palette[t.color].main,.16)}`},[`&.${Ge.disabled}`]:{"&:hover":{boxShadow:"none"}}}));var Nf=pe(Ki,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(e,t)=>t.valueLabel})(({theme:e,ownerState:t})=>B({[`&.${Ge.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"},zIndex:1,whiteSpace:"nowrap"},e.typography.body2,{fontWeight:500,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),transform:"translateY(-100%) scale(0)",position:"absolute",backgroundColor:(e.vars||e).palette.grey[600],borderRadius:2,color:(e.vars||e).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},t.orientation==="horizontal"&&{top:"-10px",transformOrigin:"bottom center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},t.orientation==="vertical"&&{right:"30px",top:"24px",transformOrigin:"right center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",right:"-20%",top:"25%"}},t.size==="small"&&{fontSize:e.typography.pxToRem(12),padding:"0.25rem 0.5rem"}));var Df=pe("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>ui(e)&&e!=="markActive",overridesResolver:(e,t)=>{let{markActive:r}=e;return[t.mark,r&&t.markActive]}})(({theme:e,ownerState:t,markActive:r})=>B({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},t.orientation==="horizontal"&&{top:"50%",transform:"translate(-1px, -50%)"},t.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 1px)"},r&&{backgroundColor:(e.vars||e).palette.background.paper,opacity:.8}));var Bf=pe("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>ui(e)&&e!=="markLabelActive",overridesResolver:(e,t)=>t.markLabel})(({theme:e,ownerState:t,markLabelActive:r})=>B({},e.typography.body2,{color:(e.vars||e).palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},t.orientation==="horizontal"&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},t.orientation==="vertical"&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},r&&{color:(e.vars||e).palette.text.primary}));var Ff=e=>{let{disabled:t,dragging:r,marked:n,orientation:o,track:i,classes:s,color:l,size:a}=e,c={root:["root",t&&"disabled",r&&"dragging",n&&"marked",o==="vertical"&&"vertical",i==="inverted"&&"trackInverted",i===!1&&"trackFalse",l&&`color${Xe(l)}`,a&&`size${Xe(a)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",a&&`thumbSize${Xe(a)}`,l&&`thumbColor${Xe(l)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return(0,Ne.unstable_composeClasses)(c,hc,s)},Hf=({children:e})=>e,Uf=Yr.forwardRef(function(t,r){var n,o,i,s,l,a,c,u,p,f,d,g,m,v,h,b,x,w,T,P,D,N,k,E;let y=We({props:t,name:"MuiSlider"}),A=Mn().direction==="rtl",{"aria-label":I,"aria-valuetext":M,"aria-labelledby":H,component:V="span",components:R={},componentsProps:F={},color:L="primary",classes:U,className:Q,disableSwap:K=!1,disabled:J=!1,getAriaLabel:re,getAriaValueText:O,marks:te=!1,max:Y=100,min:Z=0,orientation:Le="horizontal",size:G="medium",step:Ie=1,scale:xe=bc,slotProps:ee,slots:q,track:Pe="normal",valueLabelDisplay:Ae="off",valueLabelFormat:rt=bc}=y,Rr=Ue(y,Rf),le=B({},y,{isRtl:A,max:Y,min:Z,classes:U,disabled:J,disableSwap:K,orientation:Le,marks:te,color:L,size:G,step:Ie,scale:xe,track:Pe,valueLabelDisplay:Ae,valueLabelFormat:rt}),{axisProps:ce,getRootProps:me,getHiddenInputProps:Rt,getThumbProps:Fe,open:Mt,active:kt,axis:wn,focusedThumbIndex:Yo,range:Ds,dragging:Ip,marks:Ko,values:nt,trackOffset:Pp,trackLeap:_p}=(0,xc.useSlider)(B({},le,{ref:r}));le.marked=Ko.length>0&&Ko.some(he=>he.label),le.dragging=Ip,le.focusedThumbIndex=Yo;let ot=Ff(le),Xo=(n=(o=q?.root)!=null?o:R.Root)!=null?n:Mf,Bs=(i=(s=q?.rail)!=null?s:R.Rail)!=null?i:kf,Fs=(l=(a=q?.track)!=null?a:R.Track)!=null?l:Lf,Hs=(c=(u=q?.thumb)!=null?u:R.Thumb)!=null?c:Of,Us=(p=(f=q?.valueLabel)!=null?f:R.ValueLabel)!=null?p:Nf,Qo=(d=(g=q?.mark)!=null?g:R.Mark)!=null?d:Df,Jo=(m=(v=q?.markLabel)!=null?v:R.MarkLabel)!=null?m:Bf,Ws=(h=(b=q?.input)!=null?b:R.Input)!=null?h:"input",Zo=(x=ee?.root)!=null?x:F.root,Ap=(w=ee?.rail)!=null?w:F.rail,ei=(T=ee?.track)!=null?T:F.track,ti=(P=ee?.thumb)!=null?P:F.thumb,ri=(D=ee?.valueLabel)!=null?D:F.valueLabel,Rp=(N=ee?.mark)!=null?N:F.mark,Mp=(k=ee?.markLabel)!=null?k:F.markLabel,kp=(E=ee?.input)!=null?E:F.input,Lp=(0,Ne.useSlotProps)({elementType:Xo,getSlotProps:me,externalSlotProps:Zo,externalForwardedProps:Rr,additionalProps:B({},fc(Xo)&&{as:V}),ownerState:B({},le,Zo?.ownerState),className:[ot.root,Q]}),Op=(0,Ne.useSlotProps)({elementType:Bs,externalSlotProps:Ap,ownerState:le,className:ot.rail}),Np=(0,Ne.useSlotProps)({elementType:Fs,externalSlotProps:ei,additionalProps:{style:B({},ce[wn].offset(Pp),ce[wn].leap(_p))},ownerState:B({},le,ei?.ownerState),className:ot.track}),ni=(0,Ne.useSlotProps)({elementType:Hs,getSlotProps:Fe,externalSlotProps:ti,ownerState:B({},le,ti?.ownerState)}),Dp=(0,Ne.useSlotProps)({elementType:Us,externalSlotProps:ri,ownerState:B({},le,ri?.ownerState),className:ot.valueLabel}),oi=(0,Ne.useSlotProps)({elementType:Qo,externalSlotProps:Rp,ownerState:le,className:ot.mark}),ii=(0,Ne.useSlotProps)({elementType:Jo,externalSlotProps:Mp,ownerState:le}),Bp=(0,Ne.useSlotProps)({elementType:Ws,getSlotProps:Rt,externalSlotProps:kp,ownerState:le});return(0,Xi.jsxs)(Xo,B({},Lp,{children:[(0,Et.jsx)(Bs,B({},Op)),(0,Et.jsx)(Fs,B({},Np)),Ko.filter(he=>he.value>=Z&&he.value<=Y).map((he,Te)=>{let si=vc(he.value,Z,Y),In=ce[wn].offset(si),yt;return Pe===!1?yt=nt.indexOf(he.value)!==-1:yt=Pe==="normal"&&(Ds?he.value>=nt[0]&&he.value<=nt[nt.length-1]:he.value<=nt[0])||Pe==="inverted"&&(Ds?he.value<=nt[0]||he.value>=nt[nt.length-1]:he.value>=nt[0]),(0,Xi.jsxs)(Yr.Fragment,{children:[(0,Et.jsx)(Qo,B({"data-index":Te},oi,!(0,Ne.isHostComponent)(Qo)&&{markActive:yt},{style:B({},In,oi.style),className:(0,yo.default)(oi.className,yt&&ot.markActive)})),he.label!=null?(0,Et.jsx)(Jo,B({"aria-hidden":!0,"data-index":Te},ii,!(0,Ne.isHostComponent)(Jo)&&{markLabelActive:yt},{style:B({},In,ii.style),className:(0,yo.default)(ot.markLabel,ii.className,yt&&ot.markLabelActive),children:he.label})):null]},Te)}),nt.map((he,Te)=>{let si=vc(he,Z,Y),In=ce[wn].offset(si),yt=Ae==="off"?Hf:Us;return(0,Et.jsx)(Yr.Fragment,{children:(0,Et.jsx)(yt,B({},!(0,Ne.isHostComponent)(yt)&&{valueLabelFormat:rt,valueLabelDisplay:Ae,value:typeof rt=="function"?rt(xe(he),Te):rt,index:Te,open:Mt===Te||kt===Te||Ae==="on",disabled:J},Dp,{children:(0,Et.jsx)(Hs,B({"data-index":Te,"data-focusvisible":Yo===Te},ni,{className:(0,yo.default)(ot.thumb,ni.className,kt===Te&&ot.active,Yo===Te&&ot.focusVisible),style:B({},In,{pointerEvents:K&&kt!==Te?"none":void 0},ni.style),children:(0,Et.jsx)(Ws,B({"data-index":Te,"aria-label":re?re(Te):I,"aria-valuenow":xe(he),"aria-labelledby":H,"aria-valuetext":O?O(xe(he),Te):M,value:nt[Te]},Bp))}))}))},Te)})]}))}),Qi=Uf;var Wf=e=>{let{provider:t,authSceneType:r}=e,{t:n}=ve(["common","client"]),{saveThirdProviderSettings:o,currentThirdProviderSettings:i}=uo(),[s,l]=at.default.useState(1),a=at.default.useRef(!1);(0,at.useEffect)(()=>{a.current||(a.current=!0,l(i.temperature))},[i.temperature]);let c=ar(async u=>{(await bt(t))?.temperature!==u&&await o(t,{temperature:u})},200);return(0,at.useEffect)(()=>{c(s)},[s]),at.default.createElement(Dt,{fullWidth:!0},at.default.createElement(Bt,{id:"max-ai__ai-provider-temperature-select-label"},`${n("client:provider__temperature__label")}: ${i.temperature}`),at.default.createElement(Ft,{sx:{"& > div":{p:"8px !important"},"& > svg":{display:"none"}},open:!1,id:"max-ai__ai-provider-temperature-select-label",value:s,label:`${n("client:provider__temperature__label")}: ${s}`,renderValue:u=>at.default.createElement(co,{sceneType:r||"MAXAI_CHATGPT_TEMPERATURE",allowedRoles:r?["pro","pro_gift","new_user"]:["free","pro","pro_gift","new_user"],BoxProps:{sx:{"& > div":{display:"flex",flexDirection:"column",width:"100%"}}},onPermission:async p=>p.name==="free"?(l(1),{success:!1}):{success:!0}},at.default.createElement(Qi,{size:"small",marks:[{value:0,label:n("client:provider__temperature__precise__title")},{value:1,label:n("client:provider__temperature__balanced__title")},{value:2,label:n("client:provider__temperature__creative__title")}],min:0,max:2,step:.1,value:s,onChange:async(p,f)=>{l(f)},sx:{width:"100%",mx:"auto",mb:0,"& .use-chat-gpt-ai--MuiSlider-markLabel":{color:"text.primary",fontSize:"12px",fontWeight:"400"},"& > span[aria-hidden]":{top:"20px"},'& > span[aria-hidden][data-index="0"]':{left:"21px!important"},'& > span[aria-hidden][data-index="2"]':{left:"calc(100% - 22px) !important"}}}))}))},Ji=Wf;var X=C(z());Yt();var Xr=C(z());var Rc=C(Ot());var Mc=C(Nt()),kc=C(Mr());var eC=C(z());var Tc=C(Re()),Cc=cr((0,Tc.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");var nC=C(z());var Sc=C(Re()),Ec=cr((0,Sc.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");var sC=C(z());var wc=C(Re()),Ic=cr((0,wc.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var Pc=C(jt()),_c=C(Xt());function Ac(e){return(0,_c.default)("MuiCheckbox",e)}var zf=(0,Pc.unstable_generateUtilityClasses)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]),Kr=zf;var Qr=C(Re()),Vf=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Gf=e=>{let{classes:t,indeterminate:r,color:n}=e,o={root:["root",r&&"indeterminate",`color${Xe(n)}`]},i=(0,Mc.unstable_composeClasses)(o,Ac,t);return B({},t,i)},$f=pe(Va,{shouldForwardProp:e=>kn(e)||e==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,r.color!=="default"&&t[`color${Xe(r.color)}`]]}})(({theme:e,ownerState:t})=>B({color:(e.vars||e).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${t.color==="default"?e.vars.palette.action.activeChannel:e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,kc.alpha)(t.color==="default"?e.palette.action.active:e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${Kr.checked}, &.${Kr.indeterminate}`]:{color:(e.vars||e).palette[t.color].main},[`&.${Kr.disabled}`]:{color:(e.vars||e).palette.action.disabled}})),qf=(0,Qr.jsx)(Ec,{}),jf=(0,Qr.jsx)(Cc,{}),Yf=(0,Qr.jsx)(Ic,{}),Kf=Xr.forwardRef(function(t,r){var n,o;let i=We({props:t,name:"MuiCheckbox"}),{checkedIcon:s=qf,color:l="primary",icon:a=jf,indeterminate:c=!1,indeterminateIcon:u=Yf,inputProps:p,size:f="medium",className:d}=i,g=Ue(i,Vf),m=c?u:a,v=c?u:s,h=B({},i,{color:l,indeterminate:c,size:f}),b=Gf(h);return(0,Qr.jsx)($f,B({type:"checkbox",inputProps:B({"data-indeterminate":c},p),icon:Xr.cloneElement(m,{fontSize:(n=m.props.fontSize)!=null?n:f}),checkedIcon:Xr.cloneElement(v,{fontSize:(o=v.props.fontSize)!=null?o:f}),ownerState:h,ref:r,className:(0,Rc.default)(b.root,d)},g,{classes:b}))}),Zi=Kf;var Lc=C(es()),Oc=C(Ri());var em=()=>X.default.createElement(Lc.default,{sx:{color:"text.secondary",fontSize:"16px",position:"absolute",right:"8px",top:"calc(50% - 8px)"}}),Nc=()=>{let{currentSidebarConversationMessages:e}=ze(),[t,r]=(0,X.useState)(!1),[n,o]=sc("OPENAI"),i=(0,X.useMemo)(()=>n?.plugins||[],[n]),s=(0,X.useMemo)(()=>n?.pluginOptions&&n?.model==="gpt-4-plugins"?lr(n.pluginOptions,"id").filter(a=>a.user_settings.is_installed):[],[n]);(0,X.useEffect)(()=>{if(n?.model==="gpt-4-plugins"){let a=i.filter(c=>s.find(u=>u.id===c));a.length!==i.length&&o({plugins:a})}},[s,i,n?.model]);let l=()=>{r(!0),setTimeout(()=>{r(!1)},1e3)};return X.default.createElement(X.default.Fragment,null,s.length>0?X.default.createElement(Dt,{size:"small",sx:{height:40,maxWidth:400},fullWidth:!0},X.default.createElement(Bt,{sx:{fontSize:"16px"},id:"ChatGPTPluginsSelectorLabel"},X.default.createElement("span",{style:{fontSize:"16px"}},i.length>0?"Plugins":"No plugins enabled")),X.default.createElement(Ft,{sx:{height:40,p:0},value:n?.plugins||[],multiple:!0,disabled:e.length>0,MenuProps:{anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},elevation:0,MenuListProps:{sx:{padding:0,width:320,maxHeight:"300px",overflowY:"auto","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{width:"6px",borderRadius:"3px",backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{borderRadius:"3px",backgroundColor:"rgba(0,0,0,0.2)"},position:"relative",border:"1px solid",borderColor:"customColor.borderColor"}}},onChange:async a=>{if(a.target.value.length>3){l();return}let c=a.target.value;await o({plugins:c})},renderValue:a=>X.default.createElement(W,{direction:"row",alignItems:"center",width:320,spacing:.5},a.length>0?a.map(c=>{let u=s.find(d=>d.id===c),p=u?.manifest?.name_for_human||u?.manifest?.name_for_model||u?.namespace,f=u?.manifest?.logo_url;return u&&f?X.default.createElement("img",{key:u.id,width:16,height:16,alt:p,src:f}):null}):X.default.createElement($,{textAlign:"left",noWrap:!0,fontSize:"14px",color:"text.primary"},"No plugins enabled")),IconComponent:em,labelId:"ChatGPTPluginsSelectorLabel",label:"Model"},X.default.createElement(ye,{component:"div",className:t?"error":"",sx:{display:"flex",alignItems:"center",p:1,bgcolor:"background.paper",position:"sticky",top:0,zIndex:1,justifyContent:"center",fontSize:"14px",color:"text.primary","&.error":{backgroundColor:"error.light",color:"error.dark"}}},i.length,"/3 Enabled"),s.map(a=>{let c=a.manifest?.name_for_human||a.manifest?.name_for_model||a.namespace,u=a.manifest?.description_for_human||a.manifest?.description_for_model||"";return X.default.createElement(Ct,{key:a.id,value:a.id,sx:{p:0}},X.default.createElement(ur,{placement:"left",componentsProps:{tooltip:{sx:{border:"1px solid rgb(245,245,245)",bgcolor:"background.paper",p:1}}},title:X.default.createElement(W,{width:"320px"},a.manifest?.logo_url&&X.default.createElement("img",{width:70,height:70,alt:c+" logo",src:a.manifest.logo_url,style:{flexShrink:0}}),X.default.createElement(W,{width:"100%",direction:"row",alignItems:"center",spacing:1,my:2},X.default.createElement($,{fontSize:"14px",color:"text.primary",textAlign:"left"},c)),X.default.createElement($,{fontSize:"12px",color:"text.secondary",textAlign:"left"},u))},X.default.createElement(W,{width:320,sx:{padding:"0 16px"},direction:"row",alignItems:"center",spacing:1},a.manifest?.logo_url&&X.default.createElement("img",{width:24,height:24,alt:c+" logo",src:a.manifest.logo_url,style:{flexShrink:0}}),X.default.createElement($,{flex:1,width:0,textAlign:"left",noWrap:!0,fontSize:"14px",color:"text.primary"},c),X.default.createElement(Zi,{sx:{flexShrink:0},checked:n?.plugins?.includes(a.id)}))))}),X.default.createElement(Ct,{value:"",onClick:a=>{a.preventDefault(),a.stopPropagation()},sx:{p:"0!important"}},X.default.createElement(W,{width:320,sx:{padding:"12px 30px 12px 16px"},direction:"row",alignItems:"center",spacing:1,onClick:async a=>{a.preventDefault(),a.stopPropagation(),await Hn({key:"chatgpt"})}},X.default.createElement($,{flex:1,width:0,textAlign:"left",noWrap:!0,fontSize:"14px",color:"text.primary"},"Plugin store"),X.default.createElement(Oc.default,{sx:{color:"text.primary",fontSize:"16px"}}))))):null)};var Se=C(z());var Dc=C(es());var tm=()=>Se.default.createElement(Dc.default,{sx:{color:"text.secondary",fontSize:"16px",position:"absolute",right:"8px",top:"calc(50% - 8px)"}}),rm=()=>{let{t:e}=ve(["common","client"]),{cleanConversation:t}=Vt(),{loading:r}=Oe(Wt),[n,o]=(0,Se.useState)("balanced");return dt(()=>{bt("BING").then(i=>{i?.conversationStyle&&o(i.conversationStyle)})}),Lt(()=>{bt("BING").then(i=>{i?.conversationStyle&&o(i.conversationStyle)})}),Se.default.createElement(Dt,{size:"small",sx:{height:40}},Se.default.createElement(Bt,{sx:{fontSize:"16px"},id:"BingConversationStyleSelectorLabel"},Se.default.createElement("span",{style:{fontSize:"16px"}},e("client:provider__bing_web_app__conversation_style__title"))),Se.default.createElement(Ft,{disabled:r,MenuProps:{elevation:0,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},MenuListProps:{sx:{border:"1px solid",borderColor:"customColor.borderColor"}}},sx:{fontSize:"14px","& > fieldset":{"& > legend":{span:{width:110}}}},IconComponent:tm,labelId:"BingConversationStyleSelectorLabel",label:e("client:provider__bing_web_app__conversation_style__title"),value:n,onChange:async i=>{try{await Or("BING",{conversationStyle:i.target.value}),await t(),o(i.target.value)}catch{}},renderValue:i=>{let s=hi.find(l=>l.value===i);return Se.default.createElement(W,{direction:"row",width:160,alignItems:"center",spacing:1},Se.default.createElement($,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s?.label?e(s.label):"Select conversation style"))}},hi.map(i=>Se.default.createElement(Ct,{value:i.value,key:i?.value,sx:{p:0}},Se.default.createElement(ur,{placement:"left",componentsProps:{tooltip:{sx:{border:"1px solid rgb(245,245,245)",bgcolor:"background.paper",p:1}}},title:Se.default.createElement(W,{spacing:1,width:"160px"},Se.default.createElement(W,{direction:"row",width:"100%",alignItems:"center",spacing:1},Se.default.createElement($,{fontSize:"14px",color:"text.primary",textAlign:"left"},e(i.label))),Se.default.createElement($,{fontSize:"12px",color:"text.primary",textAlign:"left"},e(i.description)))},Se.default.createElement(W,{width:160,sx:{padding:"6px 16px"},direction:"row",alignItems:"center",spacing:1},Se.default.createElement($,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},i?.label?e(i.label):"Select conversation style")))))))},Bc=rm;var nm=e=>{let{aiProviderOption:t}=e;return er.default.createElement(Jn,{aiProviderOption:t,boxSx:{gap:"8px","& > .use-chat-gpt-ai--MuiFormControl-root + .use-chat-gpt-ai--MuiFormControl-root":{mt:"8px"}}},t.value==="OPENAI_API"&&er.default.createElement(Ji,{provider:"OPENAI_API"}),t.value==="USE_CHAT_GPT_PLUS"&&er.default.createElement(Ji,{provider:"USE_CHAT_GPT_PLUS",authSceneType:"MAXAI_CHATGPT_TEMPERATURE"}),t.value==="OPENAI"&&er.default.createElement(Nc,null),t.value==="BING"&&er.default.createElement(Bc,null),er.default.createElement(pc,null))},Fc=nm;var om=e=>{let{sx:t,iconSize:r=20,closeAble:n,onClose:o}=e,{t:i}=ve(["common","client"]),{loading:s}=Oe(Wt),l=Oe(Ut),{currentSidebarAIProvider:a,updateSidebarSettings:c}=ze(),{switchBackgroundChatSystemAIProvider:u}=Vt(),p=(0,Ee.useMemo)(()=>s,[s]),f=(0,Ee.useMemo)(()=>Fr.find(d=>d.value===a),[a]);return Ee.default.createElement(ye,{id:n?"MaxAIProviderSelectorCard":"",component:"div",sx:{borderRadius:"4px",border:"1px solid #EBEBEB",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)",width:434,display:"flex",alignItems:"stretch",justifyContent:"center",flexDirection:"row",...t}},Ee.default.createElement(W,{sx:{p:1,width:248,flexShrink:0,borderRight:"1px solid #EBEBEB",alignItems:"stretch",boxSizing:"border-box"}},Ee.default.createElement(Vn,{loadingText:i(s?"client:floating_menu__input__running_placeholder":"common:loading"),loading:p,size:24,sx:{width:248}},f&&l.status!=="success"&&Ee.default.createElement(yl,{aiProviderOption:f}),f&&l.status==="success"&&Ee.default.createElement(Fc,{aiProviderOption:f}))),Ee.default.createElement(W,{sx:{width:0,flex:1}},Ee.default.createElement(La,{component:"nav",sx:{py:0,pt:1}},Fr.map(d=>Ee.default.createElement(xi,{id:`max-ai__ai-provider-selector__${d.value}`,className:`max-ai__ai-provider-selector__item ${d.value===a?"selected":""}`,onClick:async()=>{d.value!==a&&await c({chat:{conversationId:""},common:{currentAIProvider:d.value}}),await u(d.value)},selected:d.value===a,disabled:p,key:d.value},Ee.default.createElement(W,{spacing:1,alignItems:"center",direction:"row"},Ee.default.createElement(Tt,{aiProviderType:d.value,size:r}),Ee.default.createElement($,{component:"span",fontSize:"14px",fontWeight:400,color:"text.primary",textAlign:"left"},i(d.label))))),Ee.default.createElement(xi,{disabled:!n,onClick:o},Ee.default.createElement(W,{sx:{minHeight:"28px"},width:"100%",spacing:1,alignItems:"center",direction:"row",justifyContent:"end"},n&&Ee.default.createElement($n,{icon:"Close",sx:{fontSize:"24px"}}))))))},Hc=om;var im=()=>{let[e]=ie(Xn),t=pt(sr),[r,n]=ie(Ut),{status:o}=r,[i,s]=(0,bo.useState)(o);return(0,bo.useEffect)(()=>{i!==o&&o==="success"&&$a().then(t),s(o)},[o]),Lt(()=>{Zs().then(l=>{l||n(a=>({...a,status:"needReload"}))})}),o==="needReload"?j.default.createElement(ye,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:2147483631,display:"flex",justifyContent:"center",alignItems:"center","& + *":{filter:"blur(5px)"}}},j.default.createElement(W,{spacing:2,width:"calc(100% - 16px)"},j.default.createElement(Un,{sx:{maxWidth:"414px",mx:"auto!important",width:"100%",bgcolor:"background.paper"}},j.default.createElement(gl,null)))):e.isLogin?o==="success"?null:j.default.createElement(ye,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:2147483631,display:"flex",justifyContent:"center","& + *":{filter:"blur(5px)"}}},j.default.createElement(Un,{sx:{position:"absolute",right:8,bottom:125,bgcolor:"background.paper",display:"flex",flexDirection:"column"}},j.default.createElement(Hc,null))):j.default.createElement(ye,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:2147483631,display:"flex",justifyContent:"center",alignItems:"center","& + *":{filter:"blur(5px)"}}},j.default.createElement(W,{width:"calc(100% - 16px)"},j.default.createElement(W,{spacing:1.5,p:3,pb:2,sx:{maxWidth:"414px",mx:"auto!important",borderRadius:"4px 4px 0 0",width:"100%",bgcolor:l=>l.palette.mode==="dark"?"#4f4f4f":"#F5F6F7"}},j.default.createElement(W,{direction:"row",alignItems:"center",justifyContent:"center",width:"100%",spacing:1},j.default.createElement(Wn,{sx:{fontSize:"24px"}}),j.default.createElement($,{fontSize:"24px",fontWeight:700,color:"text.secondary",textAlign:"center"},"Use AI Anywhere Online")),j.default.createElement(W,{direction:"row",sx:{alignItems:"center",justifyContent:"center",gap:3}},j.default.createElement(W,{direction:"row",alignItems:"center",spacing:1},j.default.createElement(Tt,{aiProviderType:"USE_CHAT_GPT_PLUS",size:20}),j.default.createElement($,{component:"span",fontSize:"16px",color:"text.secondary"},"ChatGPT")),j.default.createElement(W,{direction:"row",alignItems:"center",spacing:1},j.default.createElement(Tt,{aiProviderType:"MAXAI_CLAUDE",size:20}),j.default.createElement($,{component:"span",fontSize:"16px",color:"text.secondary"},"Claude")),j.default.createElement(W,{direction:"row",alignItems:"center",spacing:1},j.default.createElement(Tt,{aiProviderType:"BARD",size:20}),j.default.createElement($,{component:"span",fontSize:"16px",color:"text.secondary"},"Bard")),j.default.createElement(W,{direction:"row",alignItems:"center",spacing:1},j.default.createElement(Tt,{aiProviderType:"BING",size:20}),j.default.createElement($,{component:"span",fontSize:"16px",color:"text.secondary"},"Bing")))),j.default.createElement(Un,{sx:{maxWidth:"414px",mx:"auto!important",width:"100%",p:2,bgcolor:"background.paper",borderRadius:"0 0 4px 4px"}},j.default.createElement(W,{alignItems:"flex-start",height:"100%",spacing:2},j.default.createElement(W,{direction:"row",alignItems:"center",justifyContent:"center",width:"100%",spacing:1},j.default.createElement($,{fontSize:"24px",fontWeight:700,color:"text.primary",textAlign:"center"},"Please sign in to continue")),j.default.createElement(qe,{href:Kt+"/login?auto=true",target:"_blank",sx:{width:"100%"}},j.default.createElement(Qt,{fullWidth:!0,disableElevation:!0,variant:"contained",sx:{height:48,color:"#fff",border:"none",bgcolor:"#4285F4",fontSize:14,"&:hover":{bgcolor:"#366dc9"}}},j.default.createElement(W,{direction:"row",spacing:2,alignItems:"center"},j.default.createElement(W,{sx:{width:"32px",height:"32px",borderRadius:"50%",bgcolor:"#fff"},justifyContent:"center",alignItems:"center"},j.default.createElement(Ra,{sx:{fontSize:"24px"}})),j.default.createElement("span",null,"Continue with Google")))),j.default.createElement(_i,{sx:{width:"100%"}},"OR"),j.default.createElement(qe,{href:Kt+"/login-email",target:"_blank",sx:{width:"100%"}},j.default.createElement(Qt,{fullWidth:!0,disableElevation:!0,variant:"outlined",sx:{height:48,textIndent:"16px",fontSize:14}},j.default.createElement(W,{direction:"row",spacing:2,alignItems:"center",sx:{color:"primary.main"}},j.default.createElement($n,{icon:"Email",sx:{fontSize:"24px"}}),j.default.createElement("span",null,"Continue with Email"))))))))};var jc=C(z());Yt();var wt=C(z()),Vc=C(Ot());var Gc=C(Nt());var $c=C(Up());var Uc=C(jt()),Wc=C(Xt());function zc(e){return(0,Wc.default)("MuiCollapse",e)}var sm=(0,Uc.unstable_generateUtilityClasses)("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]),am=sm;var Jr=C(Re()),lm=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],cm=e=>{let{orientation:t,classes:r}=e,n={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return(0,Gc.unstable_composeClasses)(n,zc,r)},um=pe("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.orientation],r.state==="entered"&&t.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&t.hidden]}})(({theme:e,ownerState:t})=>B({height:0,overflow:"hidden",transition:e.transitions.create("height")},t.orientation==="horizontal"&&{height:"auto",width:0,transition:e.transitions.create("width")},t.state==="entered"&&B({height:"auto",overflow:"visible"},t.orientation==="horizontal"&&{width:"auto"}),t.state==="exited"&&!t.in&&t.collapsedSize==="0px"&&{visibility:"hidden"})),pm=pe("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>B({display:"flex",width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),dm=pe("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})(({ownerState:e})=>B({width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),qc=wt.forwardRef(function(t,r){let n=We({props:t,name:"MuiCollapse"}),{addEndListener:o,children:i,className:s,collapsedSize:l="0px",component:a,easing:c,in:u,onEnter:p,onEntered:f,onEntering:d,onExit:g,onExited:m,onExiting:v,orientation:h="vertical",style:b,timeout:x=js.standard,TransitionComponent:w=Ta}=n,T=Ue(n,lm),P=B({},n,{orientation:h,collapsedSize:l}),D=cm(P),N=Mn(),k=wt.useRef(),E=wt.useRef(null),y=wt.useRef(),_=typeof l=="number"?`${l}px`:l,A=h==="horizontal",I=A?"width":"height";wt.useEffect(()=>()=>{clearTimeout(k.current)},[]);let M=wt.useRef(null),H=(0,$c.useForkRef)(r,M),V=O=>te=>{if(O){let Y=M.current;te===void 0?O(Y):O(Y,te)}},R=()=>E.current?E.current[A?"clientWidth":"clientHeight"]:0,F=V((O,te)=>{E.current&&A&&(E.current.style.position="absolute"),O.style[I]=_,p&&p(O,te)}),L=V((O,te)=>{let Y=R();E.current&&A&&(E.current.style.position="");let{duration:Z,easing:Le}=Ti({style:b,timeout:x,easing:c},{mode:"enter"});if(x==="auto"){let G=N.transitions.getAutoHeightDuration(Y);O.style.transitionDuration=`${G}ms`,y.current=G}else O.style.transitionDuration=typeof Z=="string"?Z:`${Z}ms`;O.style[I]=`${Y}px`,O.style.transitionTimingFunction=Le,d&&d(O,te)}),U=V((O,te)=>{O.style[I]="auto",f&&f(O,te)}),Q=V(O=>{O.style[I]=`${R()}px`,g&&g(O)}),K=V(m),J=V(O=>{let te=R(),{duration:Y,easing:Z}=Ti({style:b,timeout:x,easing:c},{mode:"exit"});if(x==="auto"){let Le=N.transitions.getAutoHeightDuration(te);O.style.transitionDuration=`${Le}ms`,y.current=Le}else O.style.transitionDuration=typeof Y=="string"?Y:`${Y}ms`;O.style[I]=_,O.style.transitionTimingFunction=Z,v&&v(O)});return(0,Jr.jsx)(w,B({in:u,onEnter:F,onEntered:U,onEntering:L,onExit:Q,onExited:K,onExiting:J,addEndListener:O=>{x==="auto"&&(k.current=setTimeout(O,y.current||0)),o&&o(M.current,O)},nodeRef:M,timeout:x==="auto"?null:x},T,{children:(O,te)=>(0,Jr.jsx)(um,B({as:a,className:(0,Vc.default)(D.root,s,{entered:D.entered,exited:!u&&_==="0px"&&D.hidden}[O]),style:B({[A?"minWidth":"minHeight"]:_},b),ownerState:B({},P,{state:O}),ref:H},te,{children:(0,Jr.jsx)(pm,{ownerState:B({},P,{state:O}),className:D.wrapper,ref:E,children:(0,Jr.jsx)(dm,{ownerState:B({},P,{state:O}),className:D.wrapperInner,children:i})})}))}))});qc.muiSupportAuto=!0;var fm=qc;var xn=C(z());var bE=Ce({key:"ContextMenuSettingsState",default:{closeBeforeRefresh:!1}}),Yc=Ce({key:"RangyCoreState",default:{loaded:!1,rangy:null}}),xo=Ce({key:"RangyState",default:{show:!1,tempSelection:null,currentSelection:null}}),Kc=Ce({key:"FloatingDropdownMenuState",default:{open:!1,rootRect:null}}),xE=Ce({key:"FloatingDropdownMenuLastFocusRangeState",default:{range:null,selectionText:null}}),TE=Ce({key:"FloatingDropdownMenuSystemItemsState",default:{selectContextMenuId:null,lastOutput:""}}),mm=Ce({key:"FloatingDropdownMenuSelectedItemState",default:{hoverContextMenuIdMap:{},selectedContextMenuId:null,lastHoverContextMenuId:null}}),CE=Vs({key:"FloatingDropdownMenuItemsSelector",get:({get:e})=>{let t=e(mm).hoverContextMenuIdMap;return Object.values(t).filter(r=>r)}}),SE=Ce({key:"FloatingContextMenuDraftState",default:{lastAIMessageId:""}});var gr=C(z());var ts=()=>{let[e,t]=ie(Yc),[r,n]=ie(xo),o=(p=!1)=>{n(f=>(document.querySelector("#rangeBorderBox")?.remove(),{show:!1,tempSelection:null,currentSelection:p?null:f.currentSelection}))},i=p=>{t({loaded:!0,rangy:p})},s=()=>{n(p=>({...p,show:!0}))},l=p=>{n(f=>({...f,tempSelection:p}))},a=async p=>{p.selectionText=await Dn(p.selectionText||"",12e3),n(f=>({...f,currentSelection:p}))},c=(0,gr.useRef)(r.tempSelection);(0,gr.useEffect)(()=>{c.current=r.tempSelection},[r.tempSelection]);let u=(0,gr.useRef)(r.currentSelection);return(0,gr.useEffect)(()=>{u.current=r.currentSelection},[r.currentSelection]),{showRangy:s,hideRangy:o,rangy:e.rangy,initRangyCore:i,saveCurrentSelection:a,saveTempSelection:l,show:r.show,tempSelection:r.tempSelection,currentSelection:r.currentSelection,tempSelectionRef:c,currentSelectionRef:u}};var rs=C(z());var vn=C(z());var S=C(z()),Ir=C(z());var Gt=Math.min,De=Math.max,en=Math.round,tn=Math.floor,It=e=>({x:e,y:e}),hm={left:"right",right:"left",bottom:"top",top:"bottom"},ym={start:"end",end:"start"};function ns(e,t,r){return De(e,Gt(t,r))}function hr(e,t){return typeof e=="function"?e(t):e}function Pt(e){return e.split("-")[0]}function yr(e){return e.split("-")[1]}function os(e){return e==="x"?"y":"x"}function is(e){return e==="y"?"height":"width"}function vr(e){return["top","bottom"].includes(Pt(e))?"y":"x"}function ss(e){return os(vr(e))}function Xc(e,t,r){r===void 0&&(r=!1);let n=yr(e),o=ss(e),i=is(o),s=o==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=Zr(s)),[s,Zr(s)]}function Qc(e){let t=Zr(e);return[To(e),t,To(t)]}function To(e){return e.replace(/start|end/g,t=>ym[t])}function vm(e,t,r){let n=["left","right"],o=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return r?t?o:n:t?n:o;case"left":case"right":return t?i:s;default:return[]}}function Jc(e,t,r,n){let o=yr(e),i=vm(Pt(e),r==="start",n);return o&&(i=i.map(s=>s+"-"+o),t&&(i=i.concat(i.map(To)))),i}function Zr(e){return e.replace(/left|right|bottom|top/g,t=>hm[t])}function bm(e){return{top:0,right:0,bottom:0,left:0,...e}}function Zc(e){return typeof e!="number"?bm(e):{top:e,right:e,bottom:e,left:e}}function tr(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function eu(e,t,r){let{reference:n,floating:o}=e,i=vr(t),s=ss(t),l=is(s),a=Pt(t),c=i==="y",u=n.x+n.width/2-o.width/2,p=n.y+n.height/2-o.height/2,f=n[l]/2-o[l]/2,d;switch(a){case"top":d={x:u,y:n.y-o.height};break;case"bottom":d={x:u,y:n.y+n.height};break;case"right":d={x:n.x+n.width,y:p};break;case"left":d={x:n.x-o.width,y:p};break;default:d={x:n.x,y:n.y}}switch(yr(t)){case"start":d[s]-=f*(r&&c?-1:1);break;case"end":d[s]+=f*(r&&c?-1:1);break}return d}var tu=async(e,t,r)=>{let{placement:n="bottom",strategy:o="absolute",middleware:i=[],platform:s}=r,l=i.filter(Boolean),a=await(s.isRTL==null?void 0:s.isRTL(t)),c=await s.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:p}=eu(c,n,a),f=n,d={},g=0;for(let m=0;m<l.length;m++){let{name:v,fn:h}=l[m],{x:b,y:x,data:w,reset:T}=await h({x:u,y:p,initialPlacement:n,placement:f,strategy:o,middlewareData:d,rects:c,platform:s,elements:{reference:e,floating:t}});if(u=b??u,p=x??p,d={...d,[v]:{...d[v],...w}},T&&g<=50){g++,typeof T=="object"&&(T.placement&&(f=T.placement),T.rects&&(c=T.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:o}):T.rects),{x:u,y:p}=eu(c,f,a)),m=-1;continue}}return{x:u,y:p,placement:f,strategy:o,middlewareData:d}};async function rr(e,t){var r;t===void 0&&(t={});let{x:n,y:o,platform:i,rects:s,elements:l,strategy:a}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:p="floating",altBoundary:f=!1,padding:d=0}=hr(t,e),g=Zc(d),v=l[f?p==="floating"?"reference":"floating":p],h=tr(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(v)))==null||r?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:c,rootBoundary:u,strategy:a})),b=p==="floating"?{...s.floating,x:n,y:o}:s.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),w=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},T=tr(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:x,strategy:a}):b);return{top:(h.top-T.top+g.top)/w.y,bottom:(T.bottom-h.bottom+g.bottom)/w.y,left:(h.left-T.left+g.left)/w.x,right:(T.right-h.right+g.right)/w.x}}var rn=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;let{placement:o,middlewareData:i,rects:s,initialPlacement:l,platform:a,elements:c}=t,{mainAxis:u=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...v}=hr(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};let h=Pt(o),b=Pt(l)===l,x=await(a.isRTL==null?void 0:a.isRTL(c.floating)),w=f||(b||!m?[Zr(l)]:Qc(l));!f&&g!=="none"&&w.push(...Jc(l,m,g,x));let T=[l,...w],P=await rr(t,v),D=[],N=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&D.push(P[h]),p){let _=Xc(o,s,x);D.push(P[_[0]],P[_[1]])}if(N=[...N,{placement:o,overflows:D}],!D.every(_=>_<=0)){var k,E;let _=(((k=i.flip)==null?void 0:k.index)||0)+1,A=T[_];if(A)return{data:{index:_,overflows:N},reset:{placement:A}};let I=(E=N.filter(M=>M.overflows[0]<=0).sort((M,H)=>M.overflows[1]-H.overflows[1])[0])==null?void 0:E.placement;if(!I)switch(d){case"bestFit":{var y;let M=(y=N.map(H=>[H.placement,H.overflows.filter(V=>V>0).reduce((V,R)=>V+R,0)]).sort((H,V)=>H[1]-V[1])[0])==null?void 0:y[0];M&&(I=M);break}case"initialPlacement":I=l;break}if(o!==I)return{reset:{placement:I}}}return{}}}};async function xm(e,t){let{placement:r,platform:n,elements:o}=e,i=await(n.isRTL==null?void 0:n.isRTL(o.floating)),s=Pt(r),l=yr(r),a=vr(r)==="y",c=["left","top"].includes(s)?-1:1,u=i&&a?-1:1,p=hr(t,e),{mainAxis:f,crossAxis:d,alignmentAxis:g}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return l&&typeof g=="number"&&(d=l==="end"?g*-1:g),a?{x:d*u,y:f*c}:{x:f*c,y:d*u}}var br=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){let{x:r,y:n}=t,o=await xm(t,e);return{x:r+o.x,y:n+o.y,data:o}}}},nn=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){let{x:r,y:n,placement:o}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:l={fn:v=>{let{x:h,y:b}=v;return{x:h,y:b}}},...a}=hr(e,t),c={x:r,y:n},u=await rr(t,a),p=vr(Pt(o)),f=os(p),d=c[f],g=c[p];if(i){let v=f==="y"?"top":"left",h=f==="y"?"bottom":"right",b=d+u[v],x=d-u[h];d=ns(b,d,x)}if(s){let v=p==="y"?"top":"left",h=p==="y"?"bottom":"right",b=g+u[v],x=g-u[h];g=ns(b,g,x)}let m=l.fn({...t,[f]:d,[p]:g});return{...m,data:{x:m.x-r,y:m.y-n}}}}};var on=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){let{placement:r,rects:n,platform:o,elements:i}=t,{apply:s=()=>{},...l}=hr(e,t),a=await rr(t,l),c=Pt(r),u=yr(r),p=vr(r)==="y",{width:f,height:d}=n.floating,g,m;c==="top"||c==="bottom"?(g=c,m=u===(await(o.isRTL==null?void 0:o.isRTL(i.floating))?"start":"end")?"left":"right"):(m=c,g=u==="end"?"top":"bottom");let v=d-a[g],h=f-a[m],b=!t.middlewareData.shift,x=v,w=h;if(p){let P=f-a.left-a.right;w=u||b?Gt(h,P):P}else{let P=d-a.top-a.bottom;x=u||b?Gt(v,P):P}if(b&&!u){let P=De(a.left,0),D=De(a.right,0),N=De(a.top,0),k=De(a.bottom,0);p?w=f-2*(P!==0||D!==0?P+D:De(a.left,a.right)):x=d-2*(N!==0||k!==0?N+k:De(a.top,a.bottom))}await s({...t,availableWidth:w,availableHeight:x});let T=await o.getDimensions(i.floating);return f!==T.width||d!==T.height?{reset:{rects:!0}}:{}}}};function _t(e){return nu(e)?(e.nodeName||"").toLowerCase():"#document"}function $e(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function gt(e){var t;return(t=(nu(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function nu(e){return e instanceof Node||e instanceof $e(e).Node}function ht(e){return e instanceof Element||e instanceof $e(e).Element}function lt(e){return e instanceof HTMLElement||e instanceof $e(e).HTMLElement}function ru(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof $e(e).ShadowRoot}function xr(e){let{overflow:t,overflowX:r,overflowY:n,display:o}=Ye(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(o)}function ou(e){return["table","td","th"].includes(_t(e))}function Co(e){let t=So(),r=Ye(e);return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function iu(e){let t=nr(e);for(;lt(t)&&!sn(t);){if(Co(t))return t;t=nr(t)}return null}function So(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function sn(e){return["html","body","#document"].includes(_t(e))}function Ye(e){return $e(e).getComputedStyle(e)}function an(e){return ht(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function nr(e){if(_t(e)==="html")return e;let t=e.assignedSlot||e.parentNode||ru(e)&&e.host||gt(e);return ru(t)?t.host:t}function su(e){let t=nr(e);return sn(t)?e.ownerDocument?e.ownerDocument.body:e.body:lt(t)&&xr(t)?t:su(t)}function je(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);let o=su(e),i=o===((n=e.ownerDocument)==null?void 0:n.body),s=$e(o);return i?t.concat(s,s.visualViewport||[],xr(o)?o:[],s.frameElement&&r?je(s.frameElement):[]):t.concat(o,je(o))}function fu(e){let t=Ye(e),r=parseFloat(t.width)||0,n=parseFloat(t.height)||0,o=lt(e),i=o?e.offsetWidth:r,s=o?e.offsetHeight:n,l=en(r)!==i||en(n)!==s;return l&&(r=i,n=s),{width:r,height:n,$:l}}function as(e){return ht(e)?e:e.contextElement}function Tr(e){let t=as(e);if(!lt(t))return It(1);let r=t.getBoundingClientRect(),{width:n,height:o,$:i}=fu(t),s=(i?en(r.width):r.width)/n,l=(i?en(r.height):r.height)/o;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}var Cm=It(0);function mu(e){let t=$e(e);return!So()||!t.visualViewport?Cm:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Sm(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==$e(e)?!1:t}function or(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);let o=e.getBoundingClientRect(),i=as(e),s=It(1);t&&(n?ht(n)&&(s=Tr(n)):s=Tr(e));let l=Sm(i,r,n)?mu(i):It(0),a=(o.left+l.x)/s.x,c=(o.top+l.y)/s.y,u=o.width/s.x,p=o.height/s.y;if(i){let f=$e(i),d=n&&ht(n)?$e(n):n,g=f.frameElement;for(;g&&n&&d!==f;){let m=Tr(g),v=g.getBoundingClientRect(),h=Ye(g),b=v.left+(g.clientLeft+parseFloat(h.paddingLeft))*m.x,x=v.top+(g.clientTop+parseFloat(h.paddingTop))*m.y;a*=m.x,c*=m.y,u*=m.x,p*=m.y,a+=b,c+=x,g=$e(g).frameElement}}return tr({width:u,height:p,x:a,y:c})}function Em(e){let{rect:t,offsetParent:r,strategy:n}=e,o=lt(r),i=gt(r);if(r===i)return t;let s={scrollLeft:0,scrollTop:0},l=It(1),a=It(0);if((o||!o&&n!=="fixed")&&((_t(r)!=="body"||xr(i))&&(s=an(r)),lt(r))){let c=or(r);l=Tr(r),a.x=c.x+r.clientLeft,a.y=c.y+r.clientTop}return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-s.scrollLeft*l.x+a.x,y:t.y*l.y-s.scrollTop*l.y+a.y}}function wm(e){return Array.from(e.getClientRects())}function gu(e){return or(gt(e)).left+an(e).scrollLeft}function Im(e){let t=gt(e),r=an(e),n=e.ownerDocument.body,o=De(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=De(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),s=-r.scrollLeft+gu(e),l=-r.scrollTop;return Ye(n).direction==="rtl"&&(s+=De(t.clientWidth,n.clientWidth)-o),{width:o,height:i,x:s,y:l}}function Pm(e,t){let r=$e(e),n=gt(e),o=r.visualViewport,i=n.clientWidth,s=n.clientHeight,l=0,a=0;if(o){i=o.width,s=o.height;let c=So();(!c||c&&t==="fixed")&&(l=o.offsetLeft,a=o.offsetTop)}return{width:i,height:s,x:l,y:a}}function _m(e,t){let r=or(e,!0,t==="fixed"),n=r.top+e.clientTop,o=r.left+e.clientLeft,i=lt(e)?Tr(e):It(1),s=e.clientWidth*i.x,l=e.clientHeight*i.y,a=o*i.x,c=n*i.y;return{width:s,height:l,x:a,y:c}}function au(e,t,r){let n;if(t==="viewport")n=Pm(e,r);else if(t==="document")n=Im(gt(e));else if(ht(t))n=_m(t,r);else{let o=mu(e);n={...t,x:t.x-o.x,y:t.y-o.y}}return tr(n)}function hu(e,t){let r=nr(e);return r===t||!ht(r)||sn(r)?!1:Ye(r).position==="fixed"||hu(r,t)}function Am(e,t){let r=t.get(e);if(r)return r;let n=je(e,[],!1).filter(l=>ht(l)&&_t(l)!=="body"),o=null,i=Ye(e).position==="fixed",s=i?nr(e):e;for(;ht(s)&&!sn(s);){let l=Ye(s),a=Co(s);!a&&l.position==="fixed"&&(o=null),(i?!a&&!o:!a&&l.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||xr(s)&&!a&&hu(e,s))?n=n.filter(u=>u!==s):o=l,s=nr(s)}return t.set(e,n),n}function Rm(e){let{element:t,boundary:r,rootBoundary:n,strategy:o}=e,s=[...r==="clippingAncestors"?Am(t,this._c):[].concat(r),n],l=s[0],a=s.reduce((c,u)=>{let p=au(t,u,o);return c.top=De(p.top,c.top),c.right=Gt(p.right,c.right),c.bottom=Gt(p.bottom,c.bottom),c.left=De(p.left,c.left),c},au(t,l,o));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function Mm(e){return fu(e)}function km(e,t,r){let n=lt(t),o=gt(t),i=r==="fixed",s=or(e,!0,i,t),l={scrollLeft:0,scrollTop:0},a=It(0);if(n||!n&&!i)if((_t(t)!=="body"||xr(o))&&(l=an(t)),n){let c=or(t,!0,i,t);a.x=c.x+t.clientLeft,a.y=c.y+t.clientTop}else o&&(a.x=gu(o));return{x:s.left+l.scrollLeft-a.x,y:s.top+l.scrollTop-a.y,width:s.width,height:s.height}}function lu(e,t){return!lt(e)||Ye(e).position==="fixed"?null:t?t(e):e.offsetParent}function yu(e,t){let r=$e(e);if(!lt(e))return r;let n=lu(e,t);for(;n&&ou(n)&&Ye(n).position==="static";)n=lu(n,t);return n&&(_t(n)==="html"||_t(n)==="body"&&Ye(n).position==="static"&&!Co(n))?r:n||iu(e)||r}var Lm=async function(e){let{reference:t,floating:r,strategy:n}=e,o=this.getOffsetParent||yu,i=this.getDimensions;return{reference:km(t,await o(r),n),floating:{x:0,y:0,...await i(r)}}};function Om(e){return Ye(e).direction==="rtl"}var Eo={convertOffsetParentRelativeRectToViewportRelativeRect:Em,getDocumentElement:gt,getClippingRect:Rm,getOffsetParent:yu,getElementRects:Lm,getClientRects:wm,getDimensions:Mm,getScale:Tr,isElement:ht,isRTL:Om};function Nm(e,t){let r=null,n,o=gt(e);function i(){clearTimeout(n),r&&r.disconnect(),r=null}function s(l,a){l===void 0&&(l=!1),a===void 0&&(a=1),i();let{left:c,top:u,width:p,height:f}=e.getBoundingClientRect();if(l||t(),!p||!f)return;let d=tn(u),g=tn(o.clientWidth-(c+p)),m=tn(o.clientHeight-(u+f)),v=tn(c),b={rootMargin:-d+"px "+-g+"px "+-m+"px "+-v+"px",threshold:De(0,Gt(1,a))||1},x=!0;function w(T){let P=T[0].intersectionRatio;if(P!==a){if(!x)return s();P?s(!1,P):n=setTimeout(()=>{s(!1,1e-7)},100)}x=!1}try{r=new IntersectionObserver(w,{...b,root:o.ownerDocument})}catch{r=new IntersectionObserver(w,b)}r.observe(e)}return s(!0),i}function vu(e,t,r,n){n===void 0&&(n={});let{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:a=!1}=n,c=as(e),u=o||i?[...c?je(c):[],...je(t)]:[];u.forEach(h=>{o&&h.addEventListener("scroll",r,{passive:!0}),i&&h.addEventListener("resize",r)});let p=c&&l?Nm(c,r):null,f=-1,d=null;s&&(d=new ResizeObserver(h=>{let[b]=h;b&&b.target===c&&d&&(d.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{d&&d.observe(t)})),r()}),c&&!a&&d.observe(c),d.observe(t));let g,m=a?or(e):null;a&&v();function v(){let h=or(e);m&&(h.x!==m.x||h.y!==m.y||h.width!==m.width||h.height!==m.height)&&r(),m=h,g=requestAnimationFrame(v)}return r(),()=>{u.forEach(h=>{o&&h.removeEventListener("scroll",r),i&&h.removeEventListener("resize",r)}),p&&p(),d&&d.disconnect(),d=null,a&&cancelAnimationFrame(g)}}var wo=(e,t,r)=>{let n=new Map,o={platform:Eo,...r},i={...o.platform,_c:n};return tu(e,t,{...o,platform:i})};var be=C(z()),_o=C(z()),xu=C(zs());var Io=typeof document<"u"?_o.useLayoutEffect:_o.useEffect;function Po(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!Po(e[n],t[n]))return!1;return!0}if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[n]))return!1;for(n=r;n--!==0;){let i=o[n];if(!(i==="_owner"&&e.$$typeof)&&!Po(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function bu(e){let t=be.useRef(e);return Io(()=>{t.current=e}),t}function Tu(e){e===void 0&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:o,whileElementsMounted:i,open:s}=e,[l,a]=be.useState({x:null,y:null,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[c,u]=be.useState(n);Po(c,n)||u(n);let p=be.useRef(null),f=be.useRef(null),d=be.useRef(l),g=bu(i),m=bu(o),[v,h]=be.useState(null),[b,x]=be.useState(null),w=be.useCallback(E=>{p.current!==E&&(p.current=E,h(E))},[]),T=be.useCallback(E=>{f.current!==E&&(f.current=E,x(E))},[]),P=be.useCallback(()=>{if(!p.current||!f.current)return;let E={placement:t,strategy:r,middleware:c};m.current&&(E.platform=m.current),wo(p.current,f.current,E).then(y=>{let _={...y,isPositioned:!0};D.current&&!Po(d.current,_)&&(d.current=_,xu.flushSync(()=>{a(_)}))})},[c,t,r,m]);Io(()=>{s===!1&&d.current.isPositioned&&(d.current.isPositioned=!1,a(E=>({...E,isPositioned:!1})))},[s]);let D=be.useRef(!1);Io(()=>(D.current=!0,()=>{D.current=!1}),[]),Io(()=>{if(v&&b){if(g.current)return g.current(v,b,P);P()}},[v,b,P,g]);let N=be.useMemo(()=>({reference:p,floating:f,setReference:w,setFloating:T}),[w,T]),k=be.useMemo(()=>({reference:v,floating:b}),[v,b]);return be.useMemo(()=>({...l,update:P,refs:N,elements:k,reference:w,floating:T}),[l,P,N,k,w,T])}var Dm=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Cr=new WeakMap,Ao=new WeakMap,Ro={},ls=0,Cu=function(e){return e&&(e.host||Cu(e.parentNode))},Bm=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=Cu(r);return n&&e.contains(n)?n:null}).filter(function(r){return!!r})},Fm=function(e,t,r,n){var o=Bm(t,Array.isArray(e)?e:[e]);Ro[r]||(Ro[r]=new WeakMap);var i=Ro[r],s=[],l=new Set,a=new Set(o),c=function(p){!p||l.has(p)||(l.add(p),c(p.parentNode))};o.forEach(c);var u=function(p){!p||a.has(p)||Array.prototype.forEach.call(p.children,function(f){if(l.has(f))u(f);else{var d=f.getAttribute(n),g=d!==null&&d!=="false",m=(Cr.get(f)||0)+1,v=(i.get(f)||0)+1;Cr.set(f,m),i.set(f,v),s.push(f),m===1&&g&&Ao.set(f,!0),v===1&&f.setAttribute(r,"true"),g||f.setAttribute(n,"true")}})};return u(t),l.clear(),ls++,function(){s.forEach(function(p){var f=Cr.get(p)-1,d=i.get(p)-1;Cr.set(p,f),i.set(p,d),f||(Ao.has(p)||p.removeAttribute(n),Ao.delete(p)),d||p.removeAttribute(r)}),ls--,ls||(Cr=new WeakMap,Cr=new WeakMap,Ao=new WeakMap,Ro={})}},Su=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),o=t||Dm(e);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live]"))),Fm(n,o,r,"aria-hidden")):function(){return null}};var Hm=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],cs=Hm.join(","),Iu=typeof Element>"u",ln=Iu?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Mo=!Iu&&Element.prototype.getRootNode?function(e){var t;return e==null||(t=e.getRootNode)===null||t===void 0?void 0:t.call(e)}:function(e){return e?.ownerDocument},ko=function e(t,r){var n;r===void 0&&(r=!0);var o=t==null||(n=t.getAttribute)===null||n===void 0?void 0:n.call(t,"inert"),i=o===""||o==="true",s=i||r&&t&&e(t.parentNode);return s},Um=function(t){var r,n=t==null||(r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"contenteditable");return n===""||n==="true"},Wm=function(t,r,n){if(ko(t))return[];var o=Array.prototype.slice.apply(t.querySelectorAll(cs));return r&&ln.call(t,cs)&&o.unshift(t),o=o.filter(n),o},zm=function e(t,r,n){for(var o=[],i=Array.from(t);i.length;){var s=i.shift();if(!ko(s,!1))if(s.tagName==="SLOT"){var l=s.assignedElements(),a=l.length?l:s.children,c=e(a,!0,n);n.flatten?o.push.apply(o,c):o.push({scopeParent:s,candidates:c})}else{var u=ln.call(s,cs);u&&n.filter(s)&&(r||!t.includes(s))&&o.push(s);var p=s.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(s),f=!ko(p,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(s));if(p&&f){var d=e(p===!0?s.children:p.children,!0,n);n.flatten?o.push.apply(o,d):o.push({scopeParent:s,candidates:d})}else i.unshift.apply(i,s.children)}}return o},Pu=function(t){return!isNaN(parseInt(t.getAttribute("tabindex"),10))},_u=function(t){if(!t)throw new Error("No node provided");return t.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||Um(t))&&!Pu(t)?0:t.tabIndex},Vm=function(t,r){var n=_u(t);return n<0&&r&&!Pu(t)?0:n},Gm=function(t,r){return t.tabIndex===r.tabIndex?t.documentOrder-r.documentOrder:t.tabIndex-r.tabIndex},Au=function(t){return t.tagName==="INPUT"},$m=function(t){return Au(t)&&t.type==="hidden"},qm=function(t){var r=t.tagName==="DETAILS"&&Array.prototype.slice.apply(t.children).some(function(n){return n.tagName==="SUMMARY"});return r},jm=function(t,r){for(var n=0;n<t.length;n++)if(t[n].checked&&t[n].form===r)return t[n]},Ym=function(t){if(!t.name)return!0;var r=t.form||Mo(t),n=function(l){return r.querySelectorAll('input[type="radio"][name="'+l+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=n(window.CSS.escape(t.name));else try{o=n(t.name)}catch{return!1}var i=jm(o,t.form);return!i||i===t},Km=function(t){return Au(t)&&t.type==="radio"},Xm=function(t){return Km(t)&&!Ym(t)},Qm=function(t){var r,n=t&&Mo(t),o=(r=n)===null||r===void 0?void 0:r.host,i=!1;if(n&&n!==t){var s,l,a;for(i=!!((s=o)!==null&&s!==void 0&&(l=s.ownerDocument)!==null&&l!==void 0&&l.contains(o)||t!=null&&(a=t.ownerDocument)!==null&&a!==void 0&&a.contains(t));!i&&o;){var c,u,p;n=Mo(o),o=(c=n)===null||c===void 0?void 0:c.host,i=!!((u=o)!==null&&u!==void 0&&(p=u.ownerDocument)!==null&&p!==void 0&&p.contains(o))}}return i},Eu=function(t){var r=t.getBoundingClientRect(),n=r.width,o=r.height;return n===0&&o===0},Jm=function(t,r){var n=r.displayCheck,o=r.getShadowRoot;if(getComputedStyle(t).visibility==="hidden")return!0;var i=ln.call(t,"details>summary:first-of-type"),s=i?t.parentElement:t;if(ln.call(s,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="legacy-full"){if(typeof o=="function"){for(var l=t;t;){var a=t.parentElement,c=Mo(t);if(a&&!a.shadowRoot&&o(a)===!0)return Eu(t);t.assignedSlot?t=t.assignedSlot:!a&&c!==t.ownerDocument?t=c.host:t=a}t=l}if(Qm(t))return!t.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return Eu(t);return!1},Zm=function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var r=t.parentElement;r;){if(r.tagName==="FIELDSET"&&r.disabled){for(var n=0;n<r.children.length;n++){var o=r.children.item(n);if(o.tagName==="LEGEND")return ln.call(r,"fieldset[disabled] *")?!0:!o.contains(t)}return!0}r=r.parentElement}return!1},eg=function(t,r){return!(r.disabled||ko(r)||$m(r)||Jm(r,t)||qm(r)||Zm(r))},wu=function(t,r){return!(Xm(r)||_u(r)<0||!eg(t,r))},tg=function(t){var r=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(r)||r>=0)},rg=function e(t){var r=[],n=[];return t.forEach(function(o,i){var s=!!o.scopeParent,l=s?o.scopeParent:o,a=Vm(l,s),c=s?e(o.candidates):l;a===0?s?r.push.apply(r,c):r.push(l):n.push({documentOrder:i,tabIndex:a,item:o,isScope:s,content:c})}),n.sort(Gm).reduce(function(o,i){return i.isScope?o.push.apply(o,i.content):o.push(i.content),o},[]).concat(r)},cn=function(t,r){r=r||{};var n;return r.getShadowRoot?n=zm([t],r.includeContainer,{filter:wu.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:tg}):n=Wm(t,r.includeContainer,wu.bind(null,r)),rg(n)};var fn=C(zs());function Oo(){return Oo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oo.apply(this,arguments)}var we=typeof document<"u"?Ir.useLayoutEffect:Ir.useEffect,us=!1,ng=0,Ru=()=>"floating-ui-"+ng++;function og(){let[e,t]=S.useState(()=>us?Ru():void 0);return we(()=>{e==null&&t(Ru())},[]),S.useEffect(()=>{us||(us=!0)},[]),e}var ig=S["useId".toString()],No=ig||og;function Hu(){let e=new Map;return{emit(t,r){var n;(n=e.get(t))==null||n.forEach(o=>o(r))},on(t,r){e.set(t,[...e.get(t)||[],r])},off(t,r){e.set(t,(e.get(t)||[]).filter(n=>n!==r))}}}var Uu=S.createContext(null),Wu=S.createContext(null),mn=()=>{var e;return((e=S.useContext(Uu))==null?void 0:e.id)||null},Pr=()=>S.useContext(Wu),rw=e=>{let t=No(),r=Pr(),n=mn(),o=e||n;return we(()=>{let i={id:t,parentId:o};return r?.addNode(i),()=>{r?.removeNode(i)}},[r,t,o]),t},nw=e=>{let{children:t,id:r}=e,n=mn();return S.createElement(Uu.Provider,{value:S.useMemo(()=>({id:r,parentId:n}),[r,n])},t)},ow=e=>{let{children:t}=e,r=S.useRef([]),n=S.useCallback(s=>{r.current=[...r.current,s]},[]),o=S.useCallback(s=>{r.current=r.current.filter(l=>l!==s)},[]),i=S.useState(()=>Hu())[0];return S.createElement(Wu.Provider,{value:S.useMemo(()=>({nodesRef:r,addNode:n,removeNode:o,events:i}),[r,n,o,i])},t)};function tt(e){return e?.ownerDocument||document}function zu(){let e=navigator.userAgentData;return e!=null&&e.platform?e.platform:navigator.platform}function sg(){let e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:r,version:n}=t;return r+"/"+n}).join(" "):navigator.userAgent}function vs(e){return tt(e).defaultView||window}function ct(e){return e?e instanceof vs(e).Element:!1}function Sr(e){return e?e instanceof vs(e).HTMLElement:!1}function ag(e){if(typeof ShadowRoot>"u")return!1;let t=vs(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Vu(e){if(e.mozInputSource===0&&e.isTrusted)return!0;let t=/Android/i;return(t.test(zu())||t.test(sg()))&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function Gu(e){return e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType!=="mouse"||e.width<1&&e.height<1&&e.pressure===0&&e.detail===0}function hs(){return/apple/i.test(navigator.vendor)}function $u(){return zu().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function Do(e,t){let r=["mouse","pen"];return t||r.push("",void 0),r.includes(e)}function qt(e){let t=(0,Ir.useRef)(e);return we(()=>{t.current=e}),t}var Mu="data-floating-ui-safe-polygon";function ps(e,t,r){return r&&!Do(r)?0:typeof e=="number"?e:e?.[t]}var iw=function(e,t){let{enabled:r=!0,delay:n=0,handleClose:o=null,mouseOnly:i=!1,restMs:s=0,move:l=!0}=t===void 0?{}:t,{open:a,onOpenChange:c,dataRef:u,events:p,elements:{domReference:f,floating:d},refs:g}=e,m=Pr(),v=mn(),h=qt(o),b=qt(n),x=S.useRef(),w=S.useRef(),T=S.useRef(),P=S.useRef(),D=S.useRef(!0),N=S.useRef(!1),k=S.useRef(()=>{}),E=S.useCallback(()=>{var I;let M=(I=u.current.openEvent)==null?void 0:I.type;return M?.includes("mouse")&&M!=="mousedown"},[u]);S.useEffect(()=>{if(!r)return;function I(){clearTimeout(w.current),clearTimeout(P.current),D.current=!0}return p.on("dismiss",I),()=>{p.off("dismiss",I)}},[r,p]),S.useEffect(()=>{if(!r||!h.current||!a)return;function I(){E()&&c(!1)}let M=tt(d).documentElement;return M.addEventListener("mouseleave",I),()=>{M.removeEventListener("mouseleave",I)}},[d,a,c,r,h,u,E]);let y=S.useCallback(function(I){I===void 0&&(I=!0);let M=ps(b.current,"close",x.current);M&&!T.current?(clearTimeout(w.current),w.current=setTimeout(()=>c(!1),M)):I&&(clearTimeout(w.current),c(!1))},[b,c]),_=S.useCallback(()=>{k.current(),T.current=void 0},[]),A=S.useCallback(()=>{if(N.current){let I=tt(g.floating.current).body;I.style.pointerEvents="",I.removeAttribute(Mu),N.current=!1}},[g]);return S.useEffect(()=>{if(!r)return;function I(){return u.current.openEvent?["click","mousedown"].includes(u.current.openEvent.type):!1}function M(R){if(clearTimeout(w.current),D.current=!1,i&&!Do(x.current)||s>0&&ps(b.current,"open")===0)return;u.current.openEvent=R;let F=ps(b.current,"open",x.current);F?w.current=setTimeout(()=>{c(!0)},F):c(!0)}function H(R){if(I())return;k.current();let F=tt(d);if(clearTimeout(P.current),h.current){a||clearTimeout(w.current),T.current=h.current({...e,tree:m,x:R.clientX,y:R.clientY,onClose(){A(),_(),y()}});let L=T.current;F.addEventListener("mousemove",L),k.current=()=>{F.removeEventListener("mousemove",L)};return}y()}function V(R){I()||h.current==null||h.current({...e,tree:m,x:R.clientX,y:R.clientY,onClose(){A(),_(),y()}})(R)}if(ct(f)){let R=f;return a&&R.addEventListener("mouseleave",V),d?.addEventListener("mouseleave",V),l&&R.addEventListener("mousemove",M,{once:!0}),R.addEventListener("mouseenter",M),R.addEventListener("mouseleave",H),()=>{a&&R.removeEventListener("mouseleave",V),d?.removeEventListener("mouseleave",V),l&&R.removeEventListener("mousemove",M),R.removeEventListener("mouseenter",M),R.removeEventListener("mouseleave",H)}}},[f,d,r,e,i,s,l,y,_,A,c,a,m,b,h,u]),we(()=>{var I;if(r&&a&&(I=h.current)!=null&&I.__options.blockPointerEvents&&E()){let V=tt(d).body;if(V.setAttribute(Mu,""),V.style.pointerEvents="none",N.current=!0,ct(f)&&d){var M,H;let R=f,F=m==null||(M=m.nodesRef.current.find(L=>L.id===v))==null||(H=M.context)==null?void 0:H.elements.floating;return F&&(F.style.pointerEvents=""),R.style.pointerEvents="auto",d.style.pointerEvents="auto",()=>{R.style.pointerEvents="",d.style.pointerEvents=""}}}},[r,a,v,d,f,m,h,u,E]),we(()=>{a||(x.current=void 0,_(),A())},[a,_,A]),S.useEffect(()=>()=>{_(),clearTimeout(w.current),clearTimeout(P.current),A()},[r,_,A]),S.useMemo(()=>{if(!r)return{};function I(M){x.current=M.pointerType}return{reference:{onPointerDown:I,onPointerEnter:I,onMouseMove(){a||s===0||(clearTimeout(P.current),P.current=setTimeout(()=>{D.current||c(!0)},s))}},floating:{onMouseEnter(){clearTimeout(w.current)},onMouseLeave(){p.emit("dismiss",{type:"mouseLeave",data:{returnFocus:!1}}),y(!1)}}}},[p,r,s,a,c,y])};function Er(e){let t=e.activeElement;for(;((r=t)==null||(n=r.shadowRoot)==null?void 0:n.activeElement)!=null;){var r,n;t=t.shadowRoot.activeElement}return t}function et(e,t){if(!e||!t)return!1;let r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&ag(r)){let n=t;do{if(n&&e===n)return!0;n=n.parentNode||n.host}while(n)}return!1}var ku=0;function $t(e,t){t===void 0&&(t={});let{preventScroll:r=!1,cancelPrevious:n=!0,sync:o=!1}=t;n&&cancelAnimationFrame(ku);let i=()=>e?.focus({preventScroll:r});o?i():ku=requestAnimationFrame(i)}function lg(e,t){var r;let n=[],o=(r=e.find(i=>i.id===t))==null?void 0:r.parentId;for(;o;){let i=e.find(s=>s.id===o);o=i?.parentId,i&&(n=n.concat(i))}return n}function pn(e,t){let r=e.filter(o=>{var i;return o.parentId===t&&((i=o.context)==null?void 0:i.open)})||[],n=r;for(;n.length;)n=e.filter(o=>{var i;return(i=n)==null?void 0:i.some(s=>{var l;return o.parentId===s.id&&((l=o.context)==null?void 0:l.open)})})||[],r=r.concat(n);return r}function Ho(e){return"composedPath"in e?e.composedPath()[0]:e.target}var cg="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function qu(e){return Sr(e)&&e.matches(cg)}function Ze(e){e.preventDefault(),e.stopPropagation()}var Bo=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function ju(e,t){let r=cn(e,Bo());t==="prev"&&r.reverse();let n=r.indexOf(Er(tt(e)));return r.slice(n+1)[0]}function Yu(){return ju(document.body,"next")}function Ku(){return ju(document.body,"prev")}function dn(e,t){let r=t||e.currentTarget,n=e.relatedTarget;return!n||!et(r,n)}function ug(e){cn(e,Bo()).forEach(r=>{r.dataset.tabindex=r.getAttribute("tabindex")||"",r.setAttribute("tabindex","-1")})}function pg(e){e.querySelectorAll("[data-tabindex]").forEach(r=>{let n=r.dataset.tabindex;delete r.dataset.tabindex,n?r.setAttribute("tabindex",n):r.removeAttribute("tabindex")})}var dg=S["useInsertionEffect".toString()],fg=dg||(e=>e());function gn(e){let t=S.useRef(()=>{});return fg(()=>{t.current=e}),S.useCallback(function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t.current==null?void 0:t.current(...n)},[])}var bs={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0},ys,xs;function Lu(e){e.key==="Tab"&&(ys=e.target,clearTimeout(xs))}function mg(e){let t=ys===e.relatedTarget;return ys=e.relatedTarget,clearTimeout(xs),t}var Fo=S.forwardRef(function(t,r){let n=gn(t.onFocus),[o,i]=S.useState();return we(()=>(hs()&&i("button"),document.addEventListener("keydown",Lu),()=>{document.removeEventListener("keydown",Lu)}),[]),S.createElement("span",Oo({},t,{ref:r,tabIndex:0,role:o,"aria-hidden":o?void 0:!0,"data-floating-ui-focus-guard":"",style:bs,onFocus:s=>{hs()&&$u()&&!mg(s)?(s.persist(),xs=window.setTimeout(()=>{n(s)},50)):n(s)}}))}),Xu=S.createContext(null),gg=function(e){let{id:t,enabled:r=!0}=e===void 0?{}:e,[n,o]=S.useState(null),i=No(),s=Qu();return we(()=>{if(!r)return;let l=t?document.getElementById(t):null;if(l)l.setAttribute("data-floating-ui-portal",""),o(l);else{let a=document.createElement("div");t!==""&&(a.id=t||i),a.setAttribute("data-floating-ui-portal",""),o(a);let c=s?.portalNode||document.body;return c.appendChild(a),()=>{c.removeChild(a)}}},[t,s,i,r]),n},sw=e=>{let{children:t,id:r,root:n=null,preserveTabOrder:o=!0}=e,i=gg({id:r,enabled:!n}),[s,l]=S.useState(null),a=S.useRef(null),c=S.useRef(null),u=S.useRef(null),p=S.useRef(null),f=!!s&&!s.modal&&!!(n||i)&&o;return S.useEffect(()=>{if(!i||!o||s!=null&&s.modal)return;function d(g){i&&dn(g)&&(g.type==="focusin"?pg:ug)(i)}return i.addEventListener("focusin",d,!0),i.addEventListener("focusout",d,!0),()=>{i.removeEventListener("focusin",d,!0),i.removeEventListener("focusout",d,!0)}},[i,o,s?.modal]),S.createElement(Xu.Provider,{value:S.useMemo(()=>({preserveTabOrder:o,beforeOutsideRef:a,afterOutsideRef:c,beforeInsideRef:u,afterInsideRef:p,portalNode:i,setFocusManagerState:l}),[o,i])},f&&i&&S.createElement(Fo,{"data-type":"outside",ref:a,onFocus:d=>{if(dn(d,i)){var g;(g=u.current)==null||g.focus()}else{let m=Ku()||s?.refs.domReference.current;m?.focus()}}}),f&&i&&S.createElement("span",{"aria-owns":i.id,style:bs}),n?(0,fn.createPortal)(t,n):i?(0,fn.createPortal)(t,i):null,f&&i&&S.createElement(Fo,{"data-type":"outside",ref:c,onFocus:d=>{if(dn(d,i)){var g;(g=p.current)==null||g.focus()}else{let m=Yu()||s?.refs.domReference.current;m?.focus(),s?.closeOnFocusOut&&s?.onOpenChange(!1)}}}))},Qu=()=>S.useContext(Xu),hg=S.forwardRef(function(t,r){return S.createElement("button",Oo({},t,{type:"button",ref:r,tabIndex:-1,style:bs}))});function aw(e){let{context:t,children:r,order:n=["content"],guards:o=!0,initialFocus:i=0,returnFocus:s=!0,modal:l=!0,visuallyHiddenDismiss:a=!1,closeOnFocusOut:c=!0}=e,{refs:u,nodeId:p,onOpenChange:f,events:d,dataRef:g,elements:{domReference:m,floating:v}}=t,h=qt(n),b=Pr(),x=Qu(),[w,T]=S.useState(null),P=typeof i=="number"&&i<0,D=S.useRef(null),N=S.useRef(null),k=S.useRef(!1),E=S.useRef(null),y=S.useRef(!1),_=x!=null,A=m&&m.getAttribute("role")==="combobox"&&qu(m),I=S.useCallback(function(R){return R===void 0&&(R=v),R?cn(R,Bo()):[]},[v]),M=S.useCallback(R=>{let F=I(R);return h.current.map(L=>m&&L==="reference"?m:v&&L==="floating"?v:F).filter(Boolean).flat()},[m,v,h,I]);S.useEffect(()=>{if(!l)return;function R(L){if(L.key==="Tab"){I().length===0&&!A&&Ze(L);let U=M(),Q=Ho(L);h.current[0]==="reference"&&Q===m&&(Ze(L),L.shiftKey?$t(U[U.length-1]):$t(U[1])),h.current[1]==="floating"&&Q===v&&L.shiftKey&&(Ze(L),$t(U[0]))}}let F=tt(v);return F.addEventListener("keydown",R),()=>{F.removeEventListener("keydown",R)}},[m,v,l,h,u,A,I,M]),S.useEffect(()=>{if(!c)return;function R(){y.current=!0,setTimeout(()=>{y.current=!1})}function F(L){let U=L.relatedTarget,Q=!(et(m,U)||et(v,U)||et(U,v)||et(x?.portalNode,U)||U!=null&&U.hasAttribute("data-floating-ui-focus-guard")||b&&(pn(b.nodesRef.current,p).find(K=>{var J,re;return et((J=K.context)==null?void 0:J.elements.floating,U)||et((re=K.context)==null?void 0:re.elements.domReference,U)})||lg(b.nodesRef.current,p).find(K=>{var J,re;return((J=K.context)==null?void 0:J.elements.floating)===U||((re=K.context)==null?void 0:re.elements.domReference)===U})));U&&Q&&!y.current&&U!==E.current&&(k.current=!0,setTimeout(()=>f(!1)))}if(v&&Sr(m))return m.addEventListener("focusout",F),m.addEventListener("pointerdown",R),!l&&v.addEventListener("focusout",F),()=>{m.removeEventListener("focusout",F),m.removeEventListener("pointerdown",R),!l&&v.removeEventListener("focusout",F)}},[m,v,l,p,b,x,f,c]),S.useEffect(()=>{var R;let F=Array.from((x==null||(R=x.portalNode)==null?void 0:R.querySelectorAll("[data-floating-ui-portal]"))||[]);function L(){return[D.current,N.current].filter(Boolean)}if(v&&l){let U=[v,...F,...L()],Q=Su(h.current.includes("reference")||A?U.concat(m||[]):U);return()=>{Q()}}},[m,v,l,h,x,A]),S.useEffect(()=>{if(l&&!o&&v){let R=[],F=Bo(),L=cn(tt(v).body,F),U=M(),Q=L.filter(K=>!U.includes(K));return Q.forEach((K,J)=>{R[J]=K.getAttribute("tabindex"),K.setAttribute("tabindex","-1")}),()=>{Q.forEach((K,J)=>{let re=R[J];re==null?K.removeAttribute("tabindex"):K.setAttribute("tabindex",re)})}}},[v,l,o,M]),we(()=>{if(!v)return;let R=tt(v),F=s,L=!1,U=Er(R),Q=g.current;E.current=U;let K=M(v),J=(typeof i=="number"?K[i]:i.current)||v;!P&&$t(J,{preventScroll:J===v});function re(O){if(O.type==="escapeKey"&&u.domReference.current&&(E.current=u.domReference.current),["referencePress","escapeKey"].includes(O.type))return;let te=O.data.returnFocus;typeof te=="object"?(F=!0,L=te.preventScroll):F=te}return d.on("dismiss",re),()=>{if(d.off("dismiss",re),et(v,Er(R))&&u.domReference.current&&(E.current=u.domReference.current),F&&Sr(E.current)&&!k.current)if(!u.domReference.current||y.current)$t(E.current,{cancelPrevious:!1,preventScroll:L});else{var O;Q.__syncReturnFocus=!0,(O=E.current)==null||O.focus({preventScroll:L}),setTimeout(()=>{delete Q.__syncReturnFocus})}}},[v,M,i,s,g,u,d,P]),we(()=>{if(x)return x.setFocusManagerState({...t,modal:l,closeOnFocusOut:c}),()=>{x.setFocusManagerState(null)}},[x,l,c,t]),we(()=>{if(P||!v)return;function R(){T(I().length)}if(R(),typeof MutationObserver=="function"){let F=new MutationObserver(R);return F.observe(v,{childList:!0,subtree:!0}),()=>{F.disconnect()}}},[v,I,P,u]);let H=o&&(_||l)&&!A;function V(R){return a&&l?S.createElement(hg,{ref:R==="start"?D:N,onClick:()=>f(!1)},typeof a=="string"?a:"Dismiss"):null}return S.createElement(S.Fragment,null,H&&S.createElement(Fo,{"data-type":"inside",ref:x?.beforeInsideRef,onFocus:R=>{if(l){let L=M();$t(n[0]==="reference"?L[0]:L[L.length-1])}else if(x!=null&&x.preserveTabOrder&&x.portalNode)if(k.current=!1,dn(R,x.portalNode)){let L=Yu()||m;L?.focus()}else{var F;(F=x.beforeOutsideRef.current)==null||F.focus()}}}),A?null:V("start"),S.cloneElement(r,w===0||n.includes("floating")?{tabIndex:0}:{}),V("end"),H&&S.createElement(Fo,{"data-type":"inside",ref:x?.afterInsideRef,onFocus:R=>{if(l)$t(M()[0]);else if(x!=null&&x.preserveTabOrder&&x.portalNode)if(k.current=!0,dn(R,x.portalNode)){let L=Ku()||m;L?.focus()}else{var F;(F=x.afterOutsideRef.current)==null||F.focus()}}}))}function Ou(e){return Sr(e.target)&&e.target.tagName==="BUTTON"}function Nu(e){return qu(e)}var lw=function(e,t){let{open:r,onOpenChange:n,dataRef:o,elements:{domReference:i}}=e,{enabled:s=!0,event:l="click",toggle:a=!0,ignoreMouse:c=!1,keyboardHandlers:u=!0}=t===void 0?{}:t,p=S.useRef();return S.useMemo(()=>s?{reference:{onPointerDown(f){p.current=f.pointerType},onMouseDown(f){f.button===0&&(Do(p.current,!0)&&c||l!=="click"&&(r?a&&(!o.current.openEvent||o.current.openEvent.type==="mousedown")&&n(!1):(f.preventDefault(),n(!0)),o.current.openEvent=f.nativeEvent))},onClick(f){if(!o.current.__syncReturnFocus){if(l==="mousedown"&&p.current){p.current=void 0;return}Do(p.current,!0)&&c||(r?a&&(!o.current.openEvent||o.current.openEvent.type==="click")&&n(!1):n(!0),o.current.openEvent=f.nativeEvent)}},onKeyDown(f){p.current=void 0,u&&(Ou(f)||(f.key===" "&&!Nu(i)&&f.preventDefault(),f.key==="Enter"&&(r?a&&n(!1):n(!0))))},onKeyUp(f){u&&(Ou(f)||Nu(i)||f.key===" "&&(r?a&&n(!1):n(!0)))}}}:{},[s,o,l,c,u,i,a,r,n])};function ds(e,t){if(t==null)return!1;if("composedPath"in e)return e.composedPath().includes(t);let r=e;return r.target!=null&&t.contains(r.target)}var yg={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},vg={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},bg=function(e){var t,r;return e===void 0&&(e=!0),{escapeKeyBubbles:typeof e=="boolean"?e:(t=e.escapeKey)!=null?t:!0,outsidePressBubbles:typeof e=="boolean"?e:(r=e.outsidePress)!=null?r:!0}},cw=function(e,t){let{open:r,onOpenChange:n,events:o,nodeId:i,elements:{reference:s,domReference:l,floating:a},dataRef:c}=e,{enabled:u=!0,escapeKey:p=!0,outsidePress:f=!0,outsidePressEvent:d="pointerdown",referencePress:g=!1,referencePressEvent:m="pointerdown",ancestorScroll:v=!1,bubbles:h=!0}=t===void 0?{}:t,b=Pr(),x=mn()!=null,w=gn(typeof f=="function"?f:()=>!1),T=typeof f=="function"?w:f,P=S.useRef(!1),{escapeKeyBubbles:D,outsidePressBubbles:N}=bg(h);return S.useEffect(()=>{if(!r||!u)return;c.current.__escapeKeyBubbles=D,c.current.__outsidePressBubbles=N;function k(I){if(I.key==="Escape"){let M=b?pn(b.nodesRef.current,i):[];if(M.length>0){let H=!0;if(M.forEach(V=>{var R;if((R=V.context)!=null&&R.open&&!V.context.dataRef.current.__escapeKeyBubbles){H=!1;return}}),!H)return}o.emit("dismiss",{type:"escapeKey",data:{returnFocus:{preventScroll:!1}}}),n(!1)}}function E(I){let M=P.current;if(P.current=!1,M||typeof T=="function"&&!T(I))return;let H=Ho(I);if(Sr(H)&&a){let F=a.ownerDocument.defaultView||window,L=H.scrollWidth>H.clientWidth,U=H.scrollHeight>H.clientHeight,Q=U&&I.offsetX>H.clientWidth;if(U&&F.getComputedStyle(H).direction==="rtl"&&(Q=I.offsetX<=H.offsetWidth-H.clientWidth),Q||L&&I.offsetY>H.clientHeight)return}let V=b&&pn(b.nodesRef.current,i).some(F=>{var L;return ds(I,(L=F.context)==null?void 0:L.elements.floating)});if(ds(I,a)||ds(I,l)||V)return;let R=b?pn(b.nodesRef.current,i):[];if(R.length>0){let F=!0;if(R.forEach(L=>{var U;if((U=L.context)!=null&&U.open&&!L.context.dataRef.current.__outsidePressBubbles){F=!1;return}}),!F)return}o.emit("dismiss",{type:"outsidePress",data:{returnFocus:x?{preventScroll:!0}:Vu(I)||Gu(I)}}),n(!1)}function y(){n(!1)}let _=tt(a);p&&_.addEventListener("keydown",k),T&&_.addEventListener(d,E);let A=[];return v&&(ct(l)&&(A=je(l)),ct(a)&&(A=A.concat(je(a))),!ct(s)&&s&&s.contextElement&&(A=A.concat(je(s.contextElement)))),A=A.filter(I=>{var M;return I!==((M=_.defaultView)==null?void 0:M.visualViewport)}),A.forEach(I=>{I.addEventListener("scroll",y,{passive:!0})}),()=>{p&&_.removeEventListener("keydown",k),T&&_.removeEventListener(d,E),A.forEach(I=>{I.removeEventListener("scroll",y)})}},[c,a,l,s,p,T,d,o,b,i,r,n,v,u,D,N,x]),S.useEffect(()=>{P.current=!1},[T,d]),S.useMemo(()=>u?{reference:{[yg[m]]:()=>{g&&(o.emit("dismiss",{type:"referencePress",data:{returnFocus:!1}}),n(!1))}},floating:{[vg[d]]:()=>{P.current=!0}}}:{},[u,o,g,d,m,n])};var Du=!1,Ts="ArrowUp",Uo="ArrowDown",wr="ArrowLeft",hn="ArrowRight";function Lo(e,t,r){return Math.floor(e/t)!==r}function un(e,t){return t<0||t>=e.current.length}function ke(e,t){let{startingIndex:r=-1,decrement:n=!1,disabledIndices:o,amount:i=1}=t===void 0?{}:t,s=e.current,l=r;do{var a,c;l=l+(n?-i:i)}while(l>=0&&l<=s.length-1&&(o?o.includes(l):s[l]==null||(a=s[l])!=null&&a.hasAttribute("disabled")||((c=s[l])==null?void 0:c.getAttribute("aria-disabled"))==="true"));return l}function Wo(e,t,r){switch(e){case"vertical":return t;case"horizontal":return r;default:return t||r}}function Bu(e,t){return Wo(t,e===Ts||e===Uo,e===wr||e===hn)}function fs(e,t,r){return Wo(t,e===Uo,r?e===wr:e===hn)||e==="Enter"||e==" "||e===""}function xg(e,t,r){return Wo(t,r?e===wr:e===hn,e===Uo)}function Tg(e,t,r){return Wo(t,r?e===hn:e===wr,e===Ts)}function ms(e,t){return ke(e,{disabledIndices:t})}function Fu(e,t){return ke(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}var uw=function(e,t){let{open:r,onOpenChange:n,refs:o,elements:{domReference:i}}=e,{listRef:s,activeIndex:l,onNavigate:a=()=>{},enabled:c=!0,selectedIndex:u=null,allowEscape:p=!1,loop:f=!1,nested:d=!1,rtl:g=!1,virtual:m=!1,focusItemOnOpen:v="auto",focusItemOnHover:h=!0,openOnArrowKeyDown:b=!0,disabledIndices:x=void 0,orientation:w="vertical",cols:T=1,scrollItemIntoView:P=!0}=t===void 0?{listRef:{current:[]},activeIndex:null,onNavigate:()=>{}}:t,D=mn(),N=Pr(),k=gn(a),E=S.useRef(v),y=S.useRef(u??-1),_=S.useRef(null),A=S.useRef(!0),I=S.useRef(k),M=S.useRef(r),H=S.useRef(!1),V=S.useRef(!1),R=qt(x),F=qt(r),L=qt(P),[U,Q]=S.useState(),K=S.useCallback(function(O,te,Y){Y===void 0&&(Y=!1);let Z=O.current[te.current];m?Q(Z?.id):$t(Z,{preventScroll:!0,sync:$u()&&hs()?Du||H.current:!1}),requestAnimationFrame(()=>{let Le=L.current;Le&&Z&&(Y||!A.current)&&(Z.scrollIntoView==null||Z.scrollIntoView(typeof Le=="boolean"?{block:"nearest",inline:"nearest"}:Le))})},[m,L]);we(()=>{document.createElement("div").focus({get preventScroll(){return Du=!0,!1}})},[]),we(()=>{c&&(r?E.current&&u!=null&&(V.current=!0,k(u)):M.current&&(y.current=-1,I.current(null)))},[c,r,u,k]),we(()=>{if(c&&r)if(l==null){if(H.current=!1,u!=null)return;M.current&&(y.current=-1,K(s,y)),!M.current&&E.current&&(_.current!=null||E.current===!0&&_.current==null)&&(y.current=_.current==null||fs(_.current,w,g)||d?ms(s,R.current):Fu(s,R.current),k(y.current))}else un(s,l)||(y.current=l,K(s,y,V.current),V.current=!1)},[c,r,l,u,d,s,w,g,k,K,R]),we(()=>{if(c&&M.current&&!r){var O,te;let Y=N==null||(O=N.nodesRef.current.find(Z=>Z.id===D))==null||(te=O.context)==null?void 0:te.elements.floating;Y&&!et(Y,Er(tt(Y)))&&Y.focus({preventScroll:!0})}},[c,r,N,D]),we(()=>{_.current=null,I.current=k,M.current=r});let J=l!=null,re=S.useMemo(()=>{function O(Y){if(!r)return;let Z=s.current.indexOf(Y);Z!==-1&&k(Z)}return{onFocus(Y){let{currentTarget:Z}=Y;O(Z)},onClick:Y=>{let{currentTarget:Z}=Y;return Z.focus({preventScroll:!0})},...h&&{onMouseMove(Y){let{currentTarget:Z}=Y;O(Z)},onPointerLeave(){if(A.current&&(y.current=-1,K(s,y),(0,fn.flushSync)(()=>k(null)),!m)){var Y;(Y=o.floating.current)==null||Y.focus({preventScroll:!0})}}}}},[r,o,K,h,s,k,m]);return S.useMemo(()=>{if(!c)return{};let O=R.current;function te(G){if(A.current=!1,H.current=!0,!F.current&&G.currentTarget===o.floating.current)return;if(d&&Tg(G.key,w,g)){Ze(G),n(!1),Sr(i)&&i.focus();return}let Ie=y.current,xe=ms(s,O),ee=Fu(s,O);if(G.key==="Home"&&(y.current=xe,k(y.current)),G.key==="End"&&(y.current=ee,k(y.current)),T>1){let q=y.current;if(G.key===Ts){if(Ze(G),q===-1)y.current=ee;else if(y.current=ke(s,{startingIndex:q,amount:T,decrement:!0,disabledIndices:O}),f&&(q-T<xe||y.current<0)){let Pe=q%T,Ae=ee%T,rt=ee-(Ae-Pe);Ae===Pe?y.current=ee:y.current=Ae>Pe?rt:rt-T}un(s,y.current)&&(y.current=q),k(y.current)}if(G.key===Uo&&(Ze(G),q===-1?y.current=xe:(y.current=ke(s,{startingIndex:q,amount:T,disabledIndices:O}),f&&q+T>ee&&(y.current=ke(s,{startingIndex:q%T-T,amount:T,disabledIndices:O}))),un(s,y.current)&&(y.current=q),k(y.current)),w==="both"){let Pe=Math.floor(q/T);G.key===hn&&(Ze(G),q%T!==T-1?(y.current=ke(s,{startingIndex:q,disabledIndices:O}),f&&Lo(y.current,T,Pe)&&(y.current=ke(s,{startingIndex:q-q%T-1,disabledIndices:O}))):f&&(y.current=ke(s,{startingIndex:q-q%T-1,disabledIndices:O})),Lo(y.current,T,Pe)&&(y.current=q)),G.key===wr&&(Ze(G),q%T!==0?(y.current=ke(s,{startingIndex:q,disabledIndices:O,decrement:!0}),f&&Lo(y.current,T,Pe)&&(y.current=ke(s,{startingIndex:q+(T-q%T),decrement:!0,disabledIndices:O}))):f&&(y.current=ke(s,{startingIndex:q+(T-q%T),decrement:!0,disabledIndices:O})),Lo(y.current,T,Pe)&&(y.current=q));let Ae=Math.floor(ee/T)===Pe;un(s,y.current)&&(f&&Ae?y.current=G.key===wr?ee:ke(s,{startingIndex:q-q%T-1,disabledIndices:O}):y.current=q),k(y.current);return}}if(Bu(G.key,w)){if(Ze(G),r&&!m&&Er(G.currentTarget.ownerDocument)===G.currentTarget){y.current=fs(G.key,w,g)?xe:ee,k(y.current);return}fs(G.key,w,g)?f?y.current=Ie>=ee?p&&Ie!==s.current.length?-1:xe:ke(s,{startingIndex:Ie,disabledIndices:O}):y.current=Math.min(ee,ke(s,{startingIndex:Ie,disabledIndices:O})):f?y.current=Ie<=xe?p&&Ie!==-1?s.current.length:ee:ke(s,{startingIndex:Ie,decrement:!0,disabledIndices:O}):y.current=Math.max(xe,ke(s,{startingIndex:Ie,decrement:!0,disabledIndices:O})),un(s,y.current)?k(null):k(y.current)}}function Y(G){v==="auto"&&Vu(G.nativeEvent)&&(E.current=!0)}function Z(G){E.current=v,v==="auto"&&Gu(G.nativeEvent)&&(E.current=!0)}let Le=m&&r&&J&&{"aria-activedescendant":U};return{reference:{...Le,onKeyDown(G){A.current=!1;let Ie=G.key.indexOf("Arrow")===0;if(m&&r)return te(G);if(!r&&!b&&Ie)return;if((Ie||G.key==="Enter"||G.key===" "||G.key==="")&&(_.current=G.key),d){xg(G.key,w,g)&&(Ze(G),r?(y.current=ms(s,O),k(y.current)):n(!0));return}Bu(G.key,w)&&(u!=null&&(y.current=u),Ze(G),!r&&b?n(!0):te(G),r&&k(y.current))},onFocus(){r&&k(null)},onPointerDown:Z,onMouseDown:Y,onClick:Y},floating:{"aria-orientation":w==="both"?void 0:w,...Le,onKeyDown:te,onPointerMove(){A.current=!0}},item:re}},[i,o,U,R,F,s,c,w,g,m,r,J,d,u,b,p,T,f,v,k,n,re])};function pw(e){return S.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})},e)}var dw=function(e,t){let{open:r}=e,{enabled:n=!0,role:o="dialog"}=t===void 0?{}:t,i=No(),s=No();return S.useMemo(()=>{let l={id:i,role:o};return n?o==="tooltip"?{reference:{"aria-describedby":r?i:void 0},floating:l}:{reference:{"aria-expanded":r?"true":"false","aria-haspopup":o==="alertdialog"?"dialog":o,"aria-controls":r?i:void 0,...o==="listbox"&&{role:"combobox"},...o==="menu"&&{id:s}},floating:{...l,...o==="menu"&&{"aria-labelledby":s}}}:{}},[n,o,r,i,s])};var fw=function(e,t){var r;let{open:n,dataRef:o,refs:i}=e,{listRef:s,activeIndex:l,onMatch:a=()=>{},enabled:c=!0,findMatch:u=null,resetMs:p=1e3,ignoreKeys:f=[],selectedIndex:d=null}=t===void 0?{listRef:{current:[]},activeIndex:null}:t,g=S.useRef(),m=S.useRef(""),v=S.useRef((r=d??l)!=null?r:-1),h=S.useRef(null),b=gn(a),x=qt(u),w=qt(f);return we(()=>{n&&(clearTimeout(g.current),h.current=null,m.current="")},[n]),we(()=>{if(n&&m.current===""){var T;v.current=(T=d??l)!=null?T:-1}},[n,d,l]),S.useMemo(()=>{if(!c)return{};function T(P){var D;let N=Ho(P.nativeEvent);if(ct(N)&&(Er(tt(N))!==P.currentTarget?(D=i.floating.current)!=null&&D.contains(N)&&N.closest('[role="dialog"],[role="menu"],[role="listbox"],[role="tree"],[role="grid"]')!==P.currentTarget:!P.currentTarget.contains(N)))return;m.current.length>0&&m.current[0]!==" "&&(o.current.typing=!0,P.key===" "&&Ze(P));let k=s.current;if(k==null||w.current.includes(P.key)||P.key.length!==1||P.ctrlKey||P.metaKey||P.altKey)return;k.every(M=>{var H,V;return M?((H=M[0])==null?void 0:H.toLocaleLowerCase())!==((V=M[1])==null?void 0:V.toLocaleLowerCase()):!0})&&m.current===P.key&&(m.current="",v.current=h.current),m.current+=P.key,clearTimeout(g.current),g.current=setTimeout(()=>{m.current="",v.current=h.current,o.current.typing=!1},p);let y=v.current,_=[...k.slice((y||0)+1),...k.slice(0,(y||0)+1)],A=x.current?x.current(_,m.current):_.find(M=>M?.toLocaleLowerCase().indexOf(m.current.toLocaleLowerCase())===0),I=A?k.indexOf(A):-1;I!==-1&&(b(I),h.current=I)}return{reference:{onKeyDown:T},floating:{onKeyDown:T}}},[c,o,s,p,w,x,b,i])};function Cg(e,t){let[r,n]=e,o=!1,i=t.length;for(let s=0,l=i-1;s<i;l=s++){let[a,c]=t[s]||[0,0],[u,p]=t[l]||[0,0];c>=n!=p>=n&&r<=(u-a)*(n-c)/(p-c)+a&&(o=!o)}return o}function Sg(e,t){return e[0]>=t.x&&e[0]<=t.x+t.width&&e[1]>=t.y&&e[1]<=t.y+t.height}function mw(e){let{restMs:t=0,buffer:r=.5,blockPointerEvents:n=!1}=e===void 0?{}:e,o,i=!1,s=!1,l=a=>{let{x:c,y:u,placement:p,elements:f,onClose:d,nodeId:g,tree:m}=a;return function(h){function b(){clearTimeout(o),d()}if(clearTimeout(o),!f.domReference||!f.floating||p==null||c==null||u==null)return;let{clientX:x,clientY:w}=h,T=[x,w],P=Ho(h),D=h.type==="mouseleave",N=et(f.floating,P),k=et(f.domReference,P),E=f.domReference.getBoundingClientRect(),y=f.floating.getBoundingClientRect(),_=p.split("-")[0],A=c>y.right-y.width/2,I=u>y.bottom-y.height/2,M=Sg(T,E);if(N&&(s=!0,!D))return;if(k&&(s=!1),k&&!D){s=!0;return}if(D&&ct(h.relatedTarget)&&et(f.floating,h.relatedTarget)||m&&pn(m.nodesRef.current,g).some(F=>{let{context:L}=F;return L?.open}))return;if(_==="top"&&u>=E.bottom-1||_==="bottom"&&u<=E.top+1||_==="left"&&c>=E.right-1||_==="right"&&c<=E.left+1)return b();let H=[];switch(_){case"top":H=[[y.left,E.top+1],[y.left,y.bottom-1],[y.right,y.bottom-1],[y.right,E.top+1]],i=x>=y.left&&x<=y.right&&w>=y.top&&w<=E.top+1;break;case"bottom":H=[[y.left,y.top+1],[y.left,E.bottom-1],[y.right,E.bottom-1],[y.right,y.top+1]],i=x>=y.left&&x<=y.right&&w>=E.bottom-1&&w<=y.bottom;break;case"left":H=[[y.right-1,y.bottom],[y.right-1,y.top],[E.left+1,y.top],[E.left+1,y.bottom]],i=x>=y.left&&x<=E.left+1&&w>=y.top&&w<=y.bottom;break;case"right":H=[[E.right-1,y.bottom],[E.right-1,y.top],[y.left+1,y.top],[y.left+1,y.bottom]],i=x>=E.right-1&&x<=y.right&&w>=y.top&&w<=y.bottom;break}function V(F){let[L,U]=F,Q=y.width>E.width,K=y.height>E.height;switch(_){case"top":{let J=[Q?L+r/2:A?L+r*4:L-r*4,U+r+1],re=[Q?L-r/2:A?L+r*4:L-r*4,U+r+1],O=[[y.left,A||Q?y.bottom-r:y.top],[y.right,A?Q?y.bottom-r:y.top:y.bottom-r]];return[J,re,...O]}case"bottom":{let J=[Q?L+r/2:A?L+r*4:L-r*4,U-r],re=[Q?L-r/2:A?L+r*4:L-r*4,U-r],O=[[y.left,A||Q?y.top+r:y.bottom],[y.right,A?Q?y.top+r:y.bottom:y.top+r]];return[J,re,...O]}case"left":{let J=[L+r+1,K?U+r/2:I?U+r*4:U-r*4],re=[L+r+1,K?U-r/2:I?U+r*4:U-r*4];return[...[[I||K?y.right-r:y.left,y.top],[I?K?y.right-r:y.left:y.right-r,y.bottom]],J,re]}case"right":{let J=[L-r,K?U+r/2:I?U+r*4:U-r*4],re=[L-r,K?U-r/2:I?U+r*4:U-r*4],O=[[I||K?y.left+r:y.right,y.top],[I?K?y.left+r:y.right:y.left+r,y.bottom]];return[J,re,...O]}}}let R=i?H:V([c,u]);if(!i){if(s&&!M)return b();Cg([x,w],R)?t&&!s&&(o=setTimeout(b,t)):b()}}};return l.__options={blockPointerEvents:n},l}function gw(e){e===void 0&&(e={});let{open:t=!1,onOpenChange:r,nodeId:n}=e,o=Tu(e),i=Pr(),s=S.useRef(null),l=S.useRef({}),a=S.useState(()=>Hu())[0],[c,u]=S.useState(null),p=S.useCallback(h=>{let b=ct(h)?{getBoundingClientRect:()=>h.getBoundingClientRect(),contextElement:h}:h;o.refs.setReference(b)},[o.refs]),f=S.useCallback(h=>{(ct(h)||h===null)&&(s.current=h,u(h)),(ct(o.refs.reference.current)||o.refs.reference.current===null||h!==null&&!ct(h))&&o.refs.setReference(h)},[o.refs]),d=S.useMemo(()=>({...o.refs,setReference:f,setPositionReference:p,domReference:s}),[o.refs,f,p]),g=S.useMemo(()=>({...o.elements,domReference:c}),[o.elements,c]),m=gn(r),v=S.useMemo(()=>({...o,refs:d,elements:g,dataRef:l,nodeId:n,events:a,open:t,onOpenChange:m}),[o,n,a,t,m,d,g]);return we(()=>{let h=i?.nodesRef.current.find(b=>b.id===n);h&&(h.context=v)}),S.useMemo(()=>({...o,context:v,refs:d,reference:f,positionReference:p}),[o,d,v,f,p])}function gs(e,t,r){let n=new Map;return{...r==="floating"&&{tabIndex:-1},...e,...t.map(o=>o?o[r]:null).concat(e).reduce((o,i)=>(i&&Object.entries(i).forEach(s=>{let[l,a]=s;if(l.indexOf("on")===0){if(n.has(l)||n.set(l,[]),typeof a=="function"){var c;(c=n.get(l))==null||c.push(a),o[l]=function(){for(var u,p=arguments.length,f=new Array(p),d=0;d<p;d++)f[d]=arguments[d];(u=n.get(l))==null||u.forEach(g=>g(...f))}}}else o[l]=a}),o),{})}}var hw=function(e){e===void 0&&(e=[]);let t=e,r=S.useCallback(i=>gs(i,e,"reference"),t),n=S.useCallback(i=>gs(i,e,"floating"),t),o=S.useCallback(i=>gs(i,e,"item"),e.map(i=>i?.item));return S.useMemo(()=>({getReferenceProps:r,getFloatingProps:n,getItemProps:o}),[r,n,o])};var Be={REPLACE_SELECTION:"397f0c89-596c-4433-be95-02faeccee083",INSERT_BELOW:"d0b0b2a0-0b7e-4b1e-9b0e-5b7b6b2b4b2b",INSERT:"5fd6256c-f03c-4520-8df4-64b248247216",CONTINUE_WRITING:"207d0f63-7905-479f-9962-1e3ebd0b65ee",INSERT_ABOVE:"1f755cfe-cc56-4a73-9cc4-d2baf2c39624",TRY_AGAIN:"6b9f9cb4-b1b1-4897-9156-903dbc52b2a1",DISCARD:"82dc6fe3-da3d-437c-aa0e-268e4f602787",MAKE_LONGER:"2bd23d4b-6f6b-491c-a42f-f6c24a3b075d",MAKE_SHORTER:"44ea14bf-e81d-4e24-9627-b2ce9b1546dd",COPY:"8fcccd1e-eb6e-419e-8c79-d8bc7c10e72c"},_r=[{id:Be.REPLACE_SELECTION,text:"Replace selection",parent:"root",droppable:!1,data:{type:"shortcuts",editable:!1,icon:"Done"},children:[]},{id:Be.INSERT,text:"Insert",parent:"root",droppable:!1,data:{type:"shortcuts",editable:!1,icon:"NoteRight"},children:[]},{id:Be.INSERT_BELOW,text:"Insert below",parent:"root",droppable:!1,data:{type:"shortcuts",editable:!1,icon:"NoteDown"},children:[]},{id:Be.CONTINUE_WRITING,text:"Continue writing",parent:"root",droppable:!1,data:{type:"shortcuts",editable:!1,icon:"DefaultIcon",actions:[{type:"FETCH_ACTIONS",parameters:{template:"c0f7a642-9e34-4b1f-a2ee-1c4c5e93fa23"}}]},children:[]},{id:Be.COPY,text:"Copy",parent:"root",droppable:!1,data:{type:"shortcuts",editable:!1,icon:"Copy"},children:[]},{id:Be.TRY_AGAIN,text:"Try again",parent:"root",droppable:!1,data:{icon:"Replay",type:"shortcuts",editable:!1},children:[]},{id:Be.DISCARD,text:"Discard",parent:"root",droppable:!1,data:{icon:"Delete",type:"shortcuts",editable:!1},children:[]}];var Ju=new ft("ChatBoxInputMediator"),Cs=class{constructor(){this.inputValue="";this.subscribers=[]}subscribe(t){this.subscribers.push(t)}unsubscribe(t){this.subscribers=this.subscribers.filter(r=>r!==t)}updateInputValue(t,r){Ju.info("updateInputValue",t),this.inputValue=t,this.notifySubscribers(r)}getInputValue(){return this.inputValue}notifySubscribers(t){this.subscribers.forEach(r=>{r(this.inputValue,t)})}},Ss=class{constructor(){this.inputValue="";this.subscribers=[]}subscribe(t){this.subscribers.push(t)}unsubscribe(t){this.subscribers=this.subscribers.filter(r=>r!==t)}updateInputValue(t,r){Ju.info("updateInputValue",t),this.inputValue=t,this.notifySubscribers(r)}getInputValue(){return this.inputValue}notifySubscribers(t){this.subscribers.forEach(r=>{r(this.inputValue,t)})}},Es=class e{static{this.mediators={chatBoxInputMediator:new Cs,floatingMenuInputMediator:new Ss}}static getMediator(t){return e.mediators[t]}},yn=e=>Es.getMediator(e);var Zu=e=>{let t=[],r=fi(e,"parent"),n=o=>{o.children=r[o.id]||[],o.children.length>0&&di(o.children,n)};return di(r.root,o=>{n(o),t.push(o)}),t},ep=(e,t)=>!(e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom),Eg=(e,t)=>e.left<=t.right&&e.right>=t.left&&e.top<=t.bottom&&e.bottom>=t.top,wg=(e,t,r)=>!Eg(e,t)&&ep(t,r),Mw=(e,t=220,r=400,n={offset:8,directions:["bottom","top","right","left"]})=>{let{offset:o=16,directions:i}=n,s={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight},l=i||["bottom","top","right","left"],a=[];l.map(u=>{switch(u){case"bottom":a.push({left:e.left,right:e.left+t,top:e.bottom+o,bottom:e.bottom+o+r,direction:u});break;case"top":a.push({left:e.left,right:e.left+t,top:e.top-o-r,bottom:e.top-o,direction:u});break;case"left":a.push({left:e.left-o-t,right:e.left-o,top:e.top,bottom:e.top+r,direction:u}),a.push({left:e.left-o-t,right:e.left-o,top:s.bottom-r-o,bottom:s.bottom-o,direction:u});break;case"right":a.push({left:e.right+o,right:e.right+o+t,top:e.top,bottom:e.top+r,direction:u}),a.push({left:e.right+o,right:e.right+o+t,top:s.bottom-r-o,bottom:s.bottom-o,direction:u});break;default:break}});let c=a.find((u,p)=>!wg(e,u,s));return c?{x:c.left-62,y:c.top}:{x:o,y:o}},Ke=e=>({left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top,x:e.x||e.left,y:e.y||e.top}),ws=(e,t=.8)=>{let{width:r,height:n}=e,o={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight,x:0,y:0};return r*n>o.width*o.height*t?{x:o.width/2,y:o.height/2,left:o.width/2,right:o.width/2,top:o.height/2,bottom:o.height/2,width:0,height:0}:e},tp=(e,t,r)=>{let o=t.toLowerCase().trim().split(/\s+/).filter(Boolean),i=ue(e.filter(a=>{let{data:{searchText:c}}=a,u=r?.[a.id]||c;if(!u)return!1;let p=u.split(/\s/),f=!0;for(let d of o){let g=p.findIndex(m=>m.includes(d));if(g===-1){f=!1;break}p.splice(g,1)}return f})),s=[],l=fi(lr(i,"id"),"parent");return Object.keys(l).forEach(a=>{let c=l[a].filter(u=>u.data.type!=="group");if(c.length>0)if(a==="root"){s.push(...c);return}else{let u=e.find(p=>p.id===a);u&&s.push({...u,children:c})}}),s};var kw=[rn({fallbackPlacements:["top-start","right","left"]}),on(),nn({crossAxis:!0,padding:16}),br(e=>{if(e.placement.indexOf("bottom")>-1){let t={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight+window.scrollY};return ep({top:e.y,left:e.x,bottom:e.y+e.rects.floating.height+50,right:e.rects.floating.width+e.x},t)?e.rects.reference.y-e.y-e.rects.floating.height-8:8}else return 8})];var Is=()=>{let e=Fn()?.querySelector(`#${$s}`);return e&&e.getAttribute("aria-hidden")==="false"},Lw=e=>Object.values(Be).find(t=>t===e)!==void 0,Ow=e=>Object.values(_r).find(t=>t.id===e),Nw=e=>{let t;return Object.keys(Be).forEach(r=>{Be[r]===e&&(t=r)}),t},rp=()=>{let e=yn("floatingMenuInputMediator").getInputValue();if(!e)return;let t=3*1e3,r=setInterval(()=>{let o=kr()?.querySelector(`#${An}`);o&&(clearInterval(r),yn("chatBoxInputMediator").updateInputValue(e),setTimeout(()=>{o?.focus()},100))},50);setTimeout(()=>{clearInterval(r)},t)};var Ig=(e,t,r=!0)=>{let n=Ga(e),{favoriteContextMenuGroup:o}=ja(e),{contextMenuSearchTextWithCurrentLanguage:i}=oa(),s=(0,vn.useRef)([]),l=(0,vn.useMemo)(()=>{let c=lr(ue(n?.contextMenu||[]),"id");s.current=c;let u=Zu(c);return u=ra(u,p=>p.data.editable?n?.contextMenuPosition==="end"?0:2:1),o&&r&&u.unshift(o),u},[n,o]);return{contextMenuList:(0,vn.useMemo)(()=>t?.trim()?tp(s.current,t,i):l,[l,e,t,r]),originContextMenuList:n?.contextMenu||[]}};var Vo=C(z());var ap=C(z());var $w=(e,t)=>new Promise(r=>setTimeout(()=>{if(t){let o=window.innerHeight/10;t.scrollIntoView(!1),window.scrollBy(0,o)}r(!0)},e)),qw=(e,t,r=20)=>{let n=t,o=0;for(;o<r&&!n.querySelector(e);)n=n?.parentElement,o++;return n.querySelector(e)||null},np=(e,t,r=20)=>{try{let n=t,o=0;for(;o<r&&!n?.matches(e);)n=n?.parentElement,o++;return n?.matches(e)?n:null}catch{return null}};var Pg=()=>{let e=de();return!!(e&&e==="mail.google.com")},bn=class e{static{this.rangeMap=new Map}static setRange(t,r){r&&e.rangeMap.set(t,r)}static getRange(t){return e.rangeMap.get(t)}static removeAllRange(){e.rangeMap.clear()}},op=(e,t)=>{bn.setRange(e,t)},ip=e=>bn.getRange(e)||null,_g=()=>{bn.removeAllRange()},lp=async()=>(await navigator.permissions.query({name:"clipboard-write"})).state==="granted",cp=e=>{let t=0,r=e.ownerDocument||e.document,n=r.defaultView||r.parentWindow,o;if(typeof n.getSelection<"u"&&(o=n.getSelection(),o.rangeCount>0)){let i=n.getSelection().getRangeAt(0),s=i.cloneRange();s.selectNodeContents(e),s.setEnd(i.endContainer,i.endOffset),t=s.toString().length}return t},Ag=e=>{let t=0,r=0,n,o,i,s,l,a=e.ownerDocument||e.document;return typeof e.selectionStart=="number"&&typeof e.selectionEnd=="number"?(t=e.selectionStart,r=e.selectionEnd):(o=a.selection.createRange(),o&&o.parentElement()==e&&(s=e.value.length,n=e.value.replace(/\r\n/g,`
`),i=e.createTextRange(),i.moveToBookmark(o.getBookmark()),l=e.createTextRange(),l.collapse(!1),i.compareEndPoints("StartToEnd",l)>-1?t=r=s:(t=-i.moveStart("character",-s),t+=n.slice(0,t).split(`
`).length-1,i.compareEndPoints("EndToEnd",l)>-1?r=s:(r=-i.moveEnd("character",-s),r+=n.slice(0,r).split(`
`).length-1)))),{start:t,end:r}},up=e=>{let t=e||document;if(t){if(t.getSelection)return String(t.getSelection())?.replace(/\u200B/g,"");if(t.selection)return t.selection.createRange().text?.replace(/\u200B/g,"");if(window.getSelection)return String(window.getSelection())?.replace(/\u200B/g,"")}return""},_s=e=>{try{if(e){let t=e.ownerDocument||e.document,r=t.defaultView||t.parentWindow,n,o=`usechatgpt-start-marker-${ne()}`,i=`usechatgpt-end-marker-${ne()}`,s="";if(typeof t.getSelection<"u"&&(n=t.getSelection()||r.getSelection(),n.rangeCount>0)){fp();let l=r.getSelection().getRangeAt(0).cloneRange();if(e.tagName==="INPUT"||e.tagName==="TEXTAREA"){let a=e,{start:c,end:u}=Ag(a);e.setAttribute("data-usechatgpt-start-offset",c.toString()),e.setAttribute("data-usechatgpt-end-offset",u.toString()),e.setAttribute("data-usechatgpt-marker","usechatgpt-marker"),e.setAttribute("data-usechatgpt-marker-start-id",o),e.setAttribute("data-usechatgpt-marker-end-id",i);let p=a.value.substring(c,u).trim().replace(/\u200B/g,""),f=(p||a.value.substring(0,c).trim()||a.value.trim()||"").replace(/\u200B/g,"");return{startMarkerId:o,endMarkerId:i,selectionText:f,editableElementSelectionText:p}}else{let a=(n.toString()||l.toString()).trim().replace(/\u200B/g,""),c=l.cloneRange();c.selectNodeContents(e),c.setEnd(l.endContainer,l.endOffset);let u=c.toString().trim().replace(/\u200B/g,""),p=(a||u||e.innerText.trim()||"").replace(/\u200B/g,"");document.activeElement?.tagName!=="IFRAME"&&l.startContainer?.tagName==="BODY"&&l.startContainer?.isSameNode(l.endContainer)&&(p="");let f=de();if(!Pg())return op(o,l.cloneRange()),op(i,l.cloneRange()),{startMarkerId:o,endMarkerId:i,selectionText:p,editableElementSelectionText:a};let d=l.cloneRange();d.collapse(!0);let g=t.createElement("span");g.id=o,g.style.lineHeight="0",g.style.display="none",g.textContent=s,g.setAttribute("data-usechatgpt-marker","usechatgpt-marker"),g.setAttribute("contenteditable","false"),g.setAttribute("data-usechatgpt-marker-start-id",o),d.insertNode(g),d=l.cloneRange(),d.collapse(!1);let m=t.createElement("span");return m.id=i,m.style.lineHeight="0",m.style.display="none",m.textContent=s,m.setAttribute("data-usechatgpt-marker","usechatgpt-marker"),m.setAttribute("contenteditable","false"),m.setAttribute("data-usechatgpt-marker-end-id",i),d.insertNode(m),{startMarkerId:o,endMarkerId:i,selectionText:p,editableElementSelectionText:a}}}}}catch{}return{startMarkerId:"",endMarkerId:"",selectionText:"",editableElementSelectionText:""}},pp=e=>{let t=de(),r="",n="";try{if(e){let o=e.ownerDocument||e.document,i=o.defaultView||o.parentWindow,s;if(typeof i.getSelection<"u"&&(s=i.getSelection(),s.rangeCount>0)){let l=null;switch(t){case"notion.so":{l=o.querySelector(".notion-page-content")||o.querySelector('[data-content-editable-root="true"]');let a=i.getSelection().focusNode;if(l&&a){let c=document.createRange();c.selectNode(l);let u=c.cloneRange();u.setEndBefore(a);let p=u.toString().trim().replace(/\u200B/g,"");if(p)return{editableElementSelectionText:a.innerText.toString().trim().replace(/\u200B/g,""),selectionText:p}}}break;case"larksuite.com":{l=o.querySelector(".page-block-children")||o.querySelector(".page-block")||o.querySelector(".root-block");let a=i.getSelection().focusNode;if(a&&l){let c=np(".ace-line",a?.parentElement,5);if(c){let u=document.createRange();u.selectNode(l);let p=u.cloneRange();p.setEndBefore(c);let f=p.toString().trim().replace(/\u200B/g,"");if(f)return{editableElementSelectionText:c.innerText.toString().trim().replace(/\u200B/g,""),selectionText:f}}}}break;case"writer.zoho.com":if(l=document.querySelector("#editorpane"),l){let a=l.querySelectorAll(".overlay"),c=[];if(a.length>0){a.forEach(p=>{let f=p.parentElement?.querySelector(".zw-line-content");f&&(c.find(d=>d===f)||c.push(f))});let u=c.map(p=>p.innerText).join("").trim().replace(/\u200B/g,"");u&&(r=u)}else{let u=l.querySelector(".cursor");if(u){let p=document.createRange();p.selectNode(l);let f=p.cloneRange();f.setEndBefore(u),i.getSelection()?.removeAllRanges(),i.getSelection()?.addRange(f);let d=i.getSelection()?.toString().trim().replace(/\u200B/g,"");if(d)return n=d,{editableElementSelectionText:r,selectionText:n}}}}break;default:{let a=3,c=e.parentElement;for(;a>0&&c;){let u=Ar(c);if(u.isEditableElement&&u.editableElement)if(u.editableElement?.innerText){l=u.editableElement;break}else u.editableElement?.parentElement&&(c=u.editableElement.parentElement,a--);else break}}break}return l?(document.createRange().selectNode(l),n=i.getSelection()?.toString().trim().replace(/\u200B/g,"")||l.innerText,{selectionText:n,editableElementSelectionText:r}):{selectionText:n,editableElementSelectionText:r}}}}catch{}return{selectionText:n,editableElementSelectionText:r}},Rg=(e,t,r)=>{let n=e.ownerDocument||document;if(e.focus(),e.setSelectionRange(t,r),e.tagName==="TEXTAREA"){let o=e,i=getComputedStyle(o),s=o.value.match(/\w/)?.[0]||"M",l=i.fontSize,a=i.fontFamily,c=n.createElement("span");c.style.fontSize=l,c.style.fontFamily=a,c.style.position="absolute",c.style.top="-9999px",c.style.left="-9999px",c.innerText=s,n.body.appendChild(c);let u=c.offsetWidth;c.remove();let p=Math.floor(o.getBoundingClientRect().width/u)||30,f=o.value.substring(0,r),d=na(f.split(/\n/).map(m=>{let v=Math.ceil(m.length/p);return Math.max(v,1)})),g=o.clientHeight/o.rows;o.scrollTop=g*d}else if(e.tagName==="INPUT"){let o=e;o.scrollLeft=o.scrollWidth}},dp=async(e,t,r,n)=>{let o=null,i=document.querySelector(`[data-usechatgpt-marker-start-id="${e}"`),s=document.querySelector(`[data-usechatgpt-marker-end-id="${t}"`),l=null;if(!(!i&&!s&&(l=ip(e)||ip(t),!l))){if(i&&(i.tagName==="INPUT"||i.tagName==="TEXTAREA")){let a=i;o=a;let c=a?.ownerDocument||document,u=Number(a.getAttribute("data-usechatgpt-start-offset")),p=Number(a.getAttribute("data-usechatgpt-end-offset"));if(mi(u)&&mi(p)){a.tagName==="TEXTAREA"?r=r.replace(/\n+/,`
`):(r=r.replace(/\n+/," "),r=r.replace(/\s+/," "));let f="",d="",g="";n==="REPLACE_SELECTION"?(d=a.value.substring(0,u),g=a.value.substring(p,a.value.length)):n==="INSERT_BELOW"?(d=a.value.substring(0,p),g=a.value.substring(p,a.value.length),!d.endsWith(`
`)&&a.tagName==="TEXTAREA"?r=`
`+r:!d.endsWith(" ")&&a.tagName==="INPUT"&&(r=" "+r)):n==="INSERT_ABOVE"?(d=a.value.substring(0,u),g=a.value.substring(u,a.value.length),!g.startsWith(`
`)&&a.tagName==="TEXTAREA"?r=r+`
`:!g.startsWith(" ")&&a.tagName==="INPUT"&&(r=r+" ")):n==="INSERT"&&(d=a.value.substring(0,p),g=a.value.substring(p,a.value.length)),f=d+r+g;try{await lp()?(await navigator.clipboard.writeText(f),a.focus(),a.select(),c.execCommand("paste",!1,"")):(a.focus(),a.select(),c.execCommand("insertText",!1,f))}catch{a.focus(),a.select(),c.execCommand("insertText",!1,f)}Rg(a,d.length,d.length+r.length)}}else if(l){n==="INSERT_BELOW"?r=(`
`+r).replace(/^\n+/,`
`):n==="INSERT_ABOVE"&&(r=(r+`
`).replace(/\n+$/,`
`));try{let a=l.cloneRange();n==="REPLACE_SELECTION"||(n==="INSERT"||n==="INSERT_BELOW"?(a.setStart(l.endContainer,l.endOffset),a.setEnd(l.endContainer,l.endOffset)):n==="INSERT_ABOVE"&&(a.setStart(l.startContainer,l.startOffset),a.setEnd(l.startContainer,l.startOffset))),await sp(a,r)}catch{}}else if(i&&s){let{editableElement:a}=Ar(i);if(!a)return;o=a;let c=a.ownerDocument||document,u=c.createRange();if(u.selectNode(a),u.setStartAfter(i),u.setEndBefore(s),n==="INSERT_BELOW"?(r=(`
`+r).replace(/^\n+/,`
`),u.setStart(u.endContainer,u.endOffset)):n==="INSERT_ABOVE"?(r=(r+`
`).replace(/\n+$/,`
`),u.setEnd(u.startContainer,u.startOffset)):n==="REPLACE_SELECTION"||n==="INSERT"&&(r=r.replace(/^\n+/,""),u.setStart(u.endContainer,u.endOffset)),i.parentElement&&s.parentElement&&i.parentElement.isSameNode(s.parentElement)){let m=u.startOffset,v=u.endOffset,h=i.parentElement;i.remove(),s.remove();let b=!0;for(let x=0;x<h.childNodes.length;x++)if(h.childNodes[x].nodeType!==Node.TEXT_NODE){b=!1;break}if(b){let x=u.toString(),w=c.createTextNode(h.innerText);if(h.innerHTML="",h.appendChild(w),x.length>0){let T=Math.max(h.innerText.indexOf(x),0),P=T+x.length;u.setStart(h.childNodes[0],T),u.setEnd(h.childNodes[0],P)}else if(m===v){let T=h.childNodes[0];if(!T)return;v===0?(u.setStart(T,0),u.setEnd(T,0)):(u.setStart(T,T.nodeValue?.length||0),u.setEnd(T,T.nodeValue?.length||0))}}}let p=()=>{c.getSelection()?.removeAllRanges(),n==="INSERT_BELOW"||n==="INSERT"?(u.setStart(u.endContainer,u.endOffset),u.setEnd(u.endContainer,u.endOffset)):n==="INSERT_ABOVE"&&(u.setStart(u.startContainer,u.startOffset),u.setEnd(u.startContainer,u.startOffset)),c.getSelection()?.addRange(u)},f=()=>{a&&a.focus()},d=(m,v)=>{let h=u.cloneRange();n==="REPLACE_SELECTION"&&h.deleteContents(),c.getSelection()?.removeAllRanges(),c.getSelection()?.addRange(h);let{separator:b=`

`,tagName:x="div",className:w="",cssText:T="",onSeparator:P}=v||{};m.split(b).reverse().forEach((D,N,k)=>{let E=c.createElement(x);if(w&&(E.className=w),T&&(E.style.cssText=T),E.innerText=D,h.insertNode(E),P&&k[N+1]){let y=P(D);h.insertNode(y)}}),c.getSelection()?.removeAllRanges(),c.getSelection()?.addRange(h)};switch(de()){case"mail.google.com":f(),p(),d(r,{cssText:"white-space: pre-wrap;",onSeparator:()=>{let m=c.createElement("div"),v=c.createElement("br");return m.appendChild(v),m}});break;default:f(),p(),await sp(u,r)}if(o){let m=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0});i.dispatchEvent(m)}}fp(),_g()}},fp=()=>{typeof document>"u"||document.querySelectorAll("[data-usechatgpt-marker]").forEach(e=>{if(e.tagName==="SPAN"||e?.id.includes("usechatgpt-marker")){e.remove();return}e.removeAttribute("data-usechatgpt-marker"),e.removeAttribute("data-usechatgpt-start-offset"),e.removeAttribute("data-usechatgpt-end-offset"),e.removeAttribute("data-usechatgpt-marker-start-id"),e.removeAttribute("data-usechatgpt-marker-end-id")})},iI=()=>{typeof document>"u"||document.getSelection()?.removeAllRanges()},Ar=(e,t=10)=>{if(!e)return{isEditableElement:!1,editableElement:null};let r=e,n=null,o=t;for(;r&&o>0;){if(zo(r)){n=r;break}r=r.parentElement,o--}return n?{isEditableElement:!0,editableElement:n}:{isEditableElement:!1,editableElement:null}},sI=(e,t)=>{let r=e,n=up(),o="",{isEditableElement:i,editableElement:s}=Ar(r),l="",a="",c=0;i&&s&&(c=cp(s));let u=Ke(r.getBoundingClientRect()),p=null;try{let d=window.getSelection()?.getRangeAt(0)?.getBoundingClientRect();d&&(p=Ke(d),i&&d.width+d.height===0&&(p=Ke(e.getBoundingClientRect())))}catch{}if(!p){let d={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight,x:0,y:0};p={x:d.width/2,y:d.height/2,left:d.width/2,right:d.width/2,top:d.height/2,bottom:d.height/2,width:0,height:0}}return{isEmbedPage:!1,virtual:!1,tagName:r.tagName,eventType:"mouseup",target:r,isEditableElement:i,selectionText:n,selectionHTML:n,selectionRect:p,caretOffset:c,startMarkerId:l,endMarkerId:a,editableElementSelectionText:o,editableElementSelectionHTML:o,targetRect:u,...t}},aI=(e=!0)=>{let t,r;if(document.selection)return t=document.selection.createRange(),t.collapse(e),t.parentElement();{let n=window.getSelection();if(n?.getRangeAt?n?.rangeCount>0&&(t=n.getRangeAt(0)):(t=document.createRange(),t.setStart(n?.anchorNode,n?.anchorOffset),t.setEnd(n?.focusNode,n?.focusOffset),t.collapsed!==n?.isCollapsed&&(t.setStart(n?.focusNode,n?.focusOffset),t.setEnd(n?.anchorNode,n?.anchorOffset))),t){r=t[e?"startContainer":"endContainer"];let o=r.nodeType===3?r.parentNode:r;if(o.tagName==="BODY"||o.tagName==="HTML"||o.tagName==="IFRAME")return;if(zo(o))return o;if(o.querySelector){let l=o.querySelector('[contenteditable="true"]');if(l&&zo(l))return l;let a=o.querySelector("input,textarea");if(a&&zo(a))return a}let{editableElement:i,isEditableElement:s}=Ar(o);return s?i:void 0}}};var zo=e=>{if(!e?.tagName)return!1;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.getAttribute?.("contenteditable")==="true"){let t=e.getAttribute("type"),r=e.getAttribute("readonly"),n=e.getAttribute("aria-readonly"),o=e.getAttribute("disabled"),i=e.getAttribute("aria-disabled");return!(t&&["password","file","checkbox","radio","submit","reset","button","image","hidden"].includes(t)||r==="true"||o==="true"||n==="true"||i==="true"||r===""||o===""||e.id===An||e.id===Gs)}return!1},sp=async(e,t)=>{let r=e.cloneRange(),n=e.cloneRange(),o=(e.startContainer||e.endContainer)?.ownerDocument||document;if(!(!o||o.getElementById(li)))try{let i=o.getSelection(),s=t,l=o.createElement("div");if(l.id=li,l.setAttribute("contenteditable","true"),l.style.cssText="width: 1px;height: 1px;position: fixed;top: 0px;left:0px;overflow: hidden; z-index: -1;",o.body.appendChild(l),l.addEventListener("paste",p=>{p.stopPropagation()},!0),l.addEventListener("copy",p=>{p.stopPropagation(),s=o?.getSelection()?.toString()||s},!0),await lp()){await navigator.clipboard.writeText(t),l.focus();let p=o.createRange();p.selectNodeContents(l),i?.removeAllRanges(),i?.addRange(p),o.execCommand("paste",!1,"")}else{l.focus();let p=o.createRange();p.selectNodeContents(l),i?.removeAllRanges(),i?.addRange(p),o.execCommand("insertText",!1,t)}try{l.focus();let p=o.createRange();p.selectNodeContents(l),i?.removeAllRanges(),i?.addRange(p),o.execCommand("copy",!1,"")}catch{let f=l.innerText.trim();try{let d=new ao;d.addRule("pre",{filter:"pre",replacement:function(m,v){return"```\n"+v.textContent+"\n```"}});let g=d.turndown(l);await navigator.clipboard.writeText(g||f)}catch{await navigator.clipboard.writeText(f)}}finally{l.remove()}let a=o.getSelection(),{editableElement:c}=Ar(r.startContainer||r.endContainer),u=de();if(a&&r){["discord.com"].includes(de())&&await navigator.clipboard.writeText(s),a.removeAllRanges(),a.addRange(r);let p=f=>new Promise(d=>setTimeout(d,f));i?.removeAllRanges(),i?.addRange(n),await p(0),["evernote.com","web.whatsapp.com","outlook.live.com","outlook.office.com"].includes(u)||window.location.href.startsWith("https://www.youtube.com/shorts")?(i?.toString().trim()&&o.execCommand("Delete",!1,""),o.execCommand("insertText",!1,s)):o.execCommand("paste",!1,""),n.collapse(!1),i?.collapseToEnd()}}catch{}},Mg=e=>{try{let t=e.target,n=(t.ownerDocument||t.document).getSelection();if(n&&n.rangeCount>0){let o=n.getRangeAt(0),i=o.startContainer||o.endContainer;if(i&&i.nodeType===3)i=i.parentNode;else if(i.childNodes.length>0&&o.startOffset===o.endOffset&&o.startOffset>=0){let c=o.startContainer,u=o.startOffset,p=c.childNodes[u];p.isSameNode(document.getElementById("max-ai-rich-text-editor-placeholder"))?p.nextSibling&&(i=p.nextSibling):p&&(i=p)}let s=i?.tagName?.toLowerCase(),l=de();l="";let a="1";switch(l){case"notion.so":break;case"larksuite.com":if(s==="span"&&i.getAttribute("data-string")==="true"){if(i?.parentElement?.parentElement?.getAttribute("data-placeholder"))break;a=i.innerText}break;case"mail.google.com":break;case"outlook.live.com":case"outlook.office.com":case"outlook.office365.com":{let c=de(),u=!1,p=i;if(location.href.startsWith(`https://${c}/mail/`)){s==="br"&&(u=!0,i?.parentElement?.parentElement&&(p=i.parentElement.parentElement)),(s==="span"||s==="div")&&i.childNodes.length===1&&i.childNodes[0].nodeName.toLowerCase()==="br"&&(u=!0,p=i.parentElement);let f=p.getAttribute("role"),d=p.getAttribute("contenteditable");f==="textbox"&&d==="true"&&(u?a="":a=i.innerText)}}break;case"writer.zoho.com":{let c=document.querySelector("#editorpane")?.querySelector(".cursor");if(!c)break;i=c.parentElement,c?.previousElementSibling&&(i=c.previousElementSibling,a=i.innerText)}break;default:break}return{richTextEditorLineText:a.trim().replace(/\u200B/g,""),richTextEditorLineTextElement:i}}return{richTextEditorLineText:"1",richTextEditorLineTextElement:null}}catch{return{richTextEditorLineText:"1",richTextEditorLineTextElement:null}}},kg=(e,t)=>{if(!t){Ps();return}let r=window.getComputedStyle(e),n=r.getPropertyValue("font-size"),o=r.getPropertyValue("color"),i=r.getPropertyValue("font-family"),s=r.getPropertyValue("font-weight"),l=r.getPropertyValue("font-style");Ps();let a=document.createElement("span");a.id="max-ai-rich-text-editor-placeholder",a.style.fontSize=n,a.style.color=o,a.style.fontFamily=i,a.style.fontWeight=s,a.style.fontStyle=l,a.style.zIndex="999999999",a.style.pointerEvents="none",a.style.opacity="0.5",a.style.position="relative",a.style.display="inline",a.style.whiteSpace="nowrap",a.setAttribute("data-placeholder",t);let c=de();if(c==="larksuite.com")a.style.lineHeight="18px";else if(c==="writer.zoho.com"){let u=e?.parentElement?.parentElement?.getAttribute("data-textformat");try{let p=JSON.parse(u||"{}").size||12;a.style.fontSize=`${Number(p)}pt`}catch{a.style.fontSize="12pt"}e.insertBefore(a,e.firstChild);return}e.tagName.toLowerCase()==="br"?e.parentElement?.insertBefore(a,e):e.appendChild(a)},Ps=()=>{document.getElementById("max-ai-rich-text-editor-placeholder")?.remove()},lI=()=>{let{chatBoxShortCutKey:e,floatingMenuShortCutKey:t}=Ya(),r=Oe(sr);(0,ap.useEffect)(()=>{let n=a=>{let{richTextEditorLineText:c,richTextEditorLineTextElement:u}=Mg(a);if(!c&&u){let p=t&&r.userSettings?.shortcutHintEnable?`Press '${t}' for AI`:"";kg(u,p)}else Ps()},o=a=>{n(a)},i=a=>{},s=a=>{n(a)},l=a=>{n(a)};return document.addEventListener("focus",l,!0),document.addEventListener("keyup",o,!0),document.addEventListener("keydown",i,!0),document.addEventListener("mouseup",s,!0),()=>{document.removeEventListener("focus",l,!0),document.removeEventListener("keyup",o,!0),document.removeEventListener("keydown",i,!0),document.removeEventListener("mouseup",s,!0)}},[e,t,r.userSettings?.shortcutHintEnable])};var cI=e=>{let t=document.querySelectorAll("iframe"),r=[],n=[];return t.forEach(o=>{if(o.getAttribute("sandbox")){if(o.getAttribute("sandbox")?.includes("allow-scripts"))return;o.contentDocument&&o.contentWindow&&r.push(o)}}),r.forEach(o=>{let i=o?.contentDocument,s=o?.contentWindow;if(!i||!s)return;let l=[],a=null,c=p=>{try{let f=a||p.target,d=up(i),g="",{isEditableElement:m,editableElement:v}=Ar(f),h="",b="",x=0;if(m&&v){x=cp(v);let y=_s(v);h=y.startMarkerId,b=y.endMarkerId,d=y.selectionText,g=y.editableElementSelectionText}a=null;let w=Ke(i.body.getBoundingClientRect()),T=Ke(f.getBoundingClientRect()),P=s.getSelection()?.getRangeAt(0)?.getBoundingClientRect(),D=null;if(f.tagName==="INPUT"||f.tagName==="TEXTAREA"){let y=Math.max(T.left,0),_=Math.max(T.top,0),A=(i.documentElement.clientWidth||i.body.clientWidth||i.body.offsetWidth)-y,I=i.documentElement.clientHeight||i.body.clientHeight||i.body.offsetHeight,M=Math.max(T.left,0),H=Math.max(T.left,0),V=Math.min(_,I),R=Math.min(_,I),F=Math.min(T.left>0?T.width:T.width+T.left,A),L=Math.min(T.top>0?T.height:T.height+T.top,I);D={left:M,x:H,top:V,y:R,width:F,height:L,right:Math.max(Math.min(T.width,A),A),bottom:Math.min(T.bottom,I)},D.height=Math.min(I-D.top,D.height)}else if(P){let y=Math.max(P.left,0),_=Math.max(P.top,0),A=(i.documentElement.clientWidth||i.body.clientWidth||i.body.offsetWidth)-y,I=i.documentElement.clientHeight||i.body.clientHeight||i.body.offsetHeight,M=Math.max(P.left,0),H=Math.max(P.left,0),V=Math.min(_,I),R=Math.min(_,I);D={left:M,x:H,top:V,y:R,width:Math.min(P.width,A),height:Math.min(P.height,I),right:Math.max(Math.min(P.right,A),A),bottom:Math.min(P.bottom,I)},D.height=Math.min(I-D.top,D.height)}let N=[l[0]-window.screenLeft,l[1]-window.screenTop],k=Ke(o.getBoundingClientRect()),E={virtual:!0,iframeId:"",tagName:f.tagName,id:f.id,className:f.className,windowRect:Ke(w),targetRect:Ke(T),selectionRect:P?Ke(P):void 0,iframeSelectionRect:D?Ke(D):void 0,iframePosition:N,selectionText:d||"",selectionHTML:d||"",editableElementSelectionText:g,editableElementSelectionHTML:g,eventType:p.type==="mouseup"?"mouseup":"keyup",isEmbedPage:!1,isEditableElement:m,caretOffset:x,startMarkerId:h,endMarkerId:b};E.selectionRect.top+=k.top,E.selectionRect.left+=k.left,E.selectionRect.right+=k.left,E.selectionRect.bottom+=k.top,e(E)}catch{}},u=p=>{let f=p.target;(f.tagName==="INPUT"||f.tagName==="TEXTAREA")&&(a=f),l=[p.screenX,p.screenY]};i.addEventListener("mousedown",u),i.addEventListener("mouseup",c),i.addEventListener("keyup",c),n.push(()=>{i.removeEventListener("mousedown",u),i.removeEventListener("mouseup",c),i.removeEventListener("keyup",c)})}),()=>{n.forEach(o=>{o()})}};var mp=new ft("ContextMenu/useFloatingContextMenu"),As=()=>{let e=pt(Rn),{saveCurrentSelection:t,show:r,hideRangy:n,tempSelection:o}=ts(),[i,s]=ie(Kc),l=(0,Vo.useMemo)(()=>i.open,[i.open]),a=(0,Vo.useCallback)((f,d,g)=>{let m=f;if(!Is()&&m&&(m?.selectionText||m?.isEditableElement)){if(mp.info("open",m),m.isEditableElement&&m.target){let h=_s(m.target),b=ue(m);if(b.editableElementSelectionText=h.editableElementSelectionText,b.editableElementSelectionHTML=h.editableElementSelectionText,b.selectionText=h.selectionText,!b.editableElementSelectionText&&!b.selectionText){let x=pp(m.target);h.selectionText=x.selectionText,h.editableElementSelectionText=x.editableElementSelectionText,mp.info(`Get special host selection text: 
`,x.editableElementSelectionText||x.selectionText)}h&&(b.startMarkerId=h.startMarkerId,b.endMarkerId=h.endMarkerId,b.selectionText=h.selectionText,b.editableElementSelectionText=h.editableElementSelectionText,m=b)}if(d&&(m={...m,...d}),!m?.isEditableElement&&m.selectionText||m?.editableElementSelectionText||g){t({selectionText:m.editableElementSelectionText||m.selectionText||"",selectionHTML:m.editableElementSelectionText||m.selectionText||"",selectionRect:m.selectionRect,activeElement:m.target,selectionInputAble:m.isEditableElement,selectionElement:m}),n(),s({open:!0,rootRect:ws(m.selectionRect)});return}}let v=Is();if(v&&rp(),n(),s({open:!1,rootRect:null}),v){Lr(),e(h=>({...h,open:!0}));return}pa()?(ua(),e(h=>({...h,open:!1}))):(Lr(),e(h=>({...h,open:!0})))},[]),c=(f,d)=>{let g=Ke(f.getBoundingClientRect()),m={selectionText:d,selectionHTML:d,selectionRect:ws(g),isEditableElement:!1,target:f,editableElementSelectionText:"",editableElementSelectionHTML:""};a(m)};return{isFloatingMenuVisible:l,showFloatingContextMenu:()=>{r&&!i.open&&o&&a(o.selectionElement,{},!0)},hideFloatingContextMenu:()=>{s({open:!1,rootRect:null})},haveSelection:r,floatingDropdownMenuOpen:i.open,showFloatingContextMenuWithElement:c,showFloatingContextMenuWithVirtualElement:a}};var gp=C(z());var Lg=()=>{let{currentSelection:e}=Oe(xo);return(0,gp.useMemo)(()=>e?.selectionElement?.editableElementSelectionText?_r.filter(t=>![Be.INSERT].includes(t.id)):_r.filter(t=>![Be.REPLACE_SELECTION,Be.INSERT_BELOW].includes(t.id)),[e])};var hp=new ft("InitChatGPT"),Og=()=>{let e=pt(Ut),t=pt(sr),r=pt(vt),{showFloatingContextMenu:n}=As(),o=(0,xn.useRef)(n);(0,xn.useEffect)(()=>{o.current=n},[n]),Nn(async(i,s,l)=>{switch(hp.info("message",i,s),i){case"Client_ChatGPTStatusUpdate":return hp.info("useInitChatGPTClient listener",s.status),e(a=>s.status!=="success"?(a.aborts.forEach(c=>c()),{loaded:!1,status:s.status,aborts:[]}):{loaded:!0,status:s.status,aborts:a.aborts}),{success:!0,message:"",data:{}};case"Client_listenOpenChatMessageBox":break;case"Client_updateAppSettings":return t(await qa()),r(await _e()),{success:!0,data:{},message:""};case"Client_listenUpdateIframeInput":return s.startMarkerId&&s.endMarkerId&&await dp(s.startMarkerId,s.endMarkerId,s.value,s.type),{success:!0,data:{},message:""};default:break}}),(0,xn.useEffect)(()=>{let i=async()=>{let a=await s.postMessage({event:"Client_checkChatGPTStatus"});a.success&&a.data.status&&e(c=>a.data.status!=="success"?(c.aborts.forEach(u=>u()),{loaded:!1,status:a.data.status,aborts:[]}):{loaded:!0,status:a.data.status,aborts:c.aborts})},s=new ae({runtime:"client"}),l=async()=>{await i()};return s.postMessage({event:"Client_checkChatGPTStatus"}),i(),window.addEventListener("focus",l),()=>{window.removeEventListener("focus",l),s?.destroy()}},[])};var ut=C(z());var Go=C(pi()),Sn=C(_n());var Cn="chatgpt-request-time-record",Tn="chatgpt-request-count-record",Ng=2,Dg=1e3*60*5,$o=async e=>(await Sn.default.storage.local.get(e))[e],qo=e=>{Sn.default.storage.local.remove(e)},Bg=async(e=Date.now(),t=!1)=>{await $o(Cn)&&!t||await Sn.default.storage.local.set({[Cn]:e})},En=async(e,t)=>{try{let r=await $o(Tn)||{},o=(await _e()).sidebarSettings?.common?.currentAIProvider,i=(0,Go.default)().format("YYYY-MM-DD");if(Object.keys(r).forEach(a=>{Object.prototype.hasOwnProperty.call(r[a],"prompt_cnt")||delete r[a]}),(!r[i]||!Object.prototype.hasOwnProperty.call(r[i],"prompt_cnt"))&&(r[i]={error_cnt:0,success_cnt:0,total_cnt:0,prompt_cnt:{}}),e==="error")r[i].error_cnt+=1;else if(e==="success")r[i].success_cnt+=1;else if(e==="total")r[i].total_cnt+=1;else if(e==="prompt"&&t){let{name:a,host:c,id:u}=t;r[i].prompt_cnt[u]||(r[i].prompt_cnt[u]={name:a,ai_provider_cnt:{}}),o&&(r[i].prompt_cnt[u].ai_provider_cnt[o]||(r[i].prompt_cnt[u].ai_provider_cnt[o]={}),r[i].prompt_cnt[u].ai_provider_cnt[o][c]||(r[i].prompt_cnt[u].ai_provider_cnt[o][c]={total_cnt:0}),r[i].prompt_cnt[u].ai_provider_cnt[o][c].total_cnt+=1)}Bg(Date.now()),await Sn.default.storage.local.set({[Tn]:r});let s=ta(r),{ON_BOARDING_RECORD_FIRST_MESSAGE:l}=await sa();l?Object.keys(s).length>=Ng?Rs():Fg():(Rs(),await ia("ON_BOARDING_RECORD_FIRST_MESSAGE",!0))}catch{qo(Cn),qo(Tn)}},Fg=ar(()=>{Rs()},Dg),Rs=async()=>{try{if(document.hidden)return;let e=await Gn(),t=await $o(Cn),r=await $o(Tn);if(!r)return;let n=0,o=0;if(Object.keys(r).forEach(s=>{r[s].total_cnt>0&&(n+=1,o+=r[s].total_cnt)}),n===0||o===0)return;let i=await Ht();if(t&&r&&i){let s=zl(r);fetch(`${ir}/user/log`,{method:"POST",body:JSON.stringify({start_timestamp:(0,Go.default)(t).unix(),end_timestamp:(0,Go.default)().unix(),info_object:s}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`,fp:`${e}`}}).then(async l=>{try{let a=await l.json();qo(Cn),qo(Tn)}catch{}})}}catch{}};var xp=C(pi()),Tp=C(yp());var Cp=C(_n());xp.default.extend(Tp.default);var vp=new ae({runtime:"client"}),bp=new ft("UseMessageWithChatGPT"),Hg=e=>{let{currentSidebarConversationMessages:t,currentSidebarConversationType:r,currentSidebarConversationId:n,sidebarSettings:o}=ze(),i=(0,ut.useRef)(n),s=(0,ut.useRef)(o),{createConversation:l,cleanConversation:a,updateConversation:c}=Vt(),u=ic(),{currentUserPlan:p}=$r(),f=(0,ut.useRef)(e||""),[d,g]=ie(Wt),m=(0,ut.useRef)(d);(0,ut.useEffect)(()=>{m.current=d},[d]);let v=()=>({conversationRef:m,currentConversationIdRef:i,currentSidebarSettingsRef:s}),h=async()=>{k(""),await a()},b=async(_,A,I)=>{let{onStart:M,onProcess:H,onEnd:V}=I||{},R=de(),F=A?.meta?.contextMenu,L=null,U=async ce=>L?(await At("add",ce,0,[Wa(u[L.sceneType])]),mr("show",L.sceneType),Lr(),{success:!1,answer:"",error:""}):null;if(p.name==="free"&&F?.id&&!p.isNewUser){let ce=new URL(location.href),me=`${Cp.default.runtime.id}/pages/pdf/web/viewer.html`;ce.href.includes(me)&&r==="Chat"&&(L=u.PDF_AI_VIEWER)}let Q={Chat:"chat",Summary:"summary_chat",Search:"search_chat"}[r],{data:K}=await vp.postMessage({event:"Client_logCallApiRequest",data:{name:F?.text||Q,id:F?.id||Q,host:R}});K&&(L=u.TOTAL_CHAT_DAILY_LIMIT);let{question:J,messageId:re,parentMessageId:O}=_,{regenerate:te=!1,includeHistory:Y=!1,maxHistoryMessageCnt:Z=0,retry:Le=!1}=A||{};if(!J||d.loading)return{success:!1,answer:"",error:""};g(ce=>({...ce,loading:!0}));let G=await l();bp.info("createConversation",G);let Ie=Z;if(!Z&&Y){let ce=0;for(let me=t.length-1;me>=0;me--){let Rt=t[me];if(Rt.type==="user"&&Rt.extra?.includeHistory===!1){ce++;break}ce++}Ie=ce}let xe=re||ne(),ee=O||"",q=await ea(),Pe={type:"user",messageId:xe,parentMessageId:ee,text:J,extra:{includeHistory:Y,regenerate:te,maxHistoryMessageCnt:Ie,meta:{...A?.meta,attachments:q}}};g(ce=>({...ce,lastMessageId:xe,loading:!0})),A?.userMessageVisible!==!1&&await At("add",G,0,[Pe]),M&&await M(Pe.text);let Ae=[],rt=!1,Rr=!1,le="";try{let ce=await U(G);if(ce)return ce;await En("total"),await En("prompt",{name:F?.text||"chat",id:F?.id||"chat",host:R});let me=null,Rt="";return await va({conversationId:G,question:Y?J:qs+J,messageId:xe,parentMessageId:ee},{retry:Le,includeHistory:Y,regenerate:te,meta:A?.meta,maxHistoryMessageCnt:Ie},{onMessage:async Fe=>{let Mt={messageId:Fe.messageId||ne(),parentMessageId:Fe.parentMessageId||ne(),text:Fe.text||"",type:"ai",originalMessage:Fe.originalMessage};H&&await H(ue(Mt)),me=ue(Mt),Fe.conversationId&&(Rt=Fe.conversationId),A?.aiMessageVisible!==!1&&g(kt=>({...kt,loading:!0,writingMessage:Mt}))},onError:async Fe=>{Rr=!0,me?.messageId&&(me?.originalMessage?.metadata&&(me.originalMessage.metadata.isComplete=!0),Ae.push(me));let Mt=typeof Fe=="string"&&Fe?.trim()==="403";if(Fe==="Conversation not found"||Mt){await a();return}if(le=Fe?.message||Fe||"Error detected. Please try again.",typeof le!="string"&&(le="Network error. Please try again."),le==="manual aborted request.")rt=!0;else{if(En("error"),Mt&&(le="Log into ChatGPT web app and pass Cloudflare check. We recommend enabling our new [ChatGPT Stable Mode](key=options&query=#chatgpt-stable-mode) to avoid frequent interruptions and network errors."),le.startsWith("Too many requests in 1 hour")&&(le=`Too many requests in 1 hour. Try again later, or use our new AI provider for free by selecting "MaxAI.me" from the AI Provider options at the top of the sidebar.
                ![switch-provider](https://www.maxai.me/assets/chrome-extension/switch-provider.png)`),Ua(le)){L=u[le];let kt=await U(G);if(kt)return kt}Ae.push({type:"system",messageId:ne(),parentMessageId:xe,text:le,extra:{status:"error"}})}}}),!Rr&&me&&me?.messageId&&me?.text?(me?.originalMessage?.metadata&&(me.originalMessage.metadata.isComplete=!0),await En("success"),Rt&&await c({meta:{AIConversationId:Rt}},G),Ae.push(me),Promise.resolve({success:!0,answer:me?.text||"",error:""})):Promise.resolve({success:rt,answer:me?.text||"",error:le})}catch(ce){return bp.error("send question error",ce),Promise.resolve({success:!1,answer:"",error:ce.message||ce})}finally{V&&await V(Rr,Ae?.[0]),k(""),g(ce=>({...ce,writingMessage:null,loading:!1})),A?.aiMessageVisible!==!1&&await At("add",G,0,Ae)}},x=async _=>{let A=t.find(I=>I.messageId===_);A&&(g(I=>({...I,loading:!0})),await b({question:A.text,messageId:ne(),parentMessageId:A.messageId},{retry:!0,regenerate:!1,includeHistory:!0}))},w=(0,ut.useCallback)(async()=>{let _=null;for(let A=t.length-1;A>=0;A--){let I=t[A];if(I.type==="user"){_=I;break}}return _?b({question:_.text,messageId:_.messageId,parentMessageId:_.parentMessageId},{regenerate:!0,includeHistory:Object.prototype.hasOwnProperty.call(_.extra,"includeHistory")?_.extra.includeHistory:!0,meta:_.extra.meta}):null},[t,b]),T=async()=>{(d.writingMessage?.parentMessageId||d.lastMessageId)&&await vp.postMessage({event:"Client_abortAskChatGPTQuestion",data:{messageId:d.lastMessageId}})},P=async(_,A)=>{(A||n)&&await At("add",A||n||"",0,[_])},D=async(_,A)=>{A&&_.messageId&&await At("update",A,0,[_])},N=async(_,A)=>{(A||n)&&await At("delete",A||n||"",_,[])},k=_=>{yn("chatBoxInputMediator").updateInputValue(_)},E=()=>{g(_=>({..._,loading:!0}))},y=()=>{g(_=>({..._,loading:!1}))};return(0,ut.useEffect)(()=>{e&&(f.current=e)},[e]),(0,ut.useEffect)(()=>{s.current=ue(o),i.current=n},[o,n]),{sendQuestion:b,currentSidebarConversationMessages:t,resetConversation:h,conversation:d,retryMessage:x,reGenerate:w,stopGenerateMessage:T,pushMessage:P,updateMessage:D,deleteMessage:N,updateConversation:c,getSidebarRef:v,showLoading:E,hideLoading:y}};var At=async(e,t,r,n)=>{try{return(await new ae().postMessage({event:"Client_modifyMessages",data:{conversationId:t,action:e,deleteCount:r,newMessages:n}})).success}catch{return!1}},cc=async(e,t)=>{try{return(await new ae().postMessage({event:"Client_updateConversation",data:{conversationId:e,updateConversationData:t}})).success}catch{return!1}};var jo=C(z());var Ls=new ae,Sp=new ft("Features/Auth/UseChatGPTPlusChat"),Ep="You have successfully upgraded to MaxAI Pro. Enjoy unlimited usage!",Ug=(e=!0)=>{let[t,r]=ie(Qn),{currentSidebarConversationMessages:n,currentSidebarConversationId:o}=ze(),i=(0,jo.useRef)(!1),s=async()=>{try{r(c=>({...c,loading:!0}));let a=await Ls.postMessage({event:"Client_getUseChatGPTUserInfo",data:{}});return a.success&&a.data?.email?(r({user:a.data,loading:!1}),!0):!1}catch(a){return Sp.error(a),!1}finally{r(a=>({...a,loading:!1}))}},l=async()=>{try{r(u=>({...u,loading:!0}));let a=ue(t.user);if(!a){let u=await Ls.postMessage({event:"Client_getUseChatGPTUserInfo",data:{}});u.success&&u.data?.email&&(a=u.data)}if(!a)return!1;let c=await Ls.postMessage({event:"Client_getUseChatGPTUserSubscriptionInfo",data:{}});if(c.success&&c.data?.name){let u=c.data;u&&r(p=>{let f=ue(p.user);return f||(f=ue(a)),f?(f.role?.name&&f.role.name!==u.name&&u.name!=="free"&&(i.current=!0),{user:{...f,role:u},loading:!1}):{user:null,loading:!1}})}return!1}catch(a){return Sp.error(a),!1}finally{r(a=>({...a,loading:!1}))}};return(0,jo.useEffect)(()=>{i.current&&o&&!fl(n,a=>a.text===Ep)&&At("add",o,0,[{messageId:ne(),type:"system",parentMessageId:void 0,text:Ep,extra:{status:"success"}}])},[o,n]),dt(()=>{e&&s()}),Lt(()=>{e&&s()}),{userInfo:t,syncUserInfo:s,syncUserSubscriptionInfo:l}},wp=Ug;var Ns=C(pi()),$r=()=>{let{user:e,loading:t}=Oe(Qn),{syncUserInfo:r,syncUserSubscriptionInfo:n}=wp(!1),o=(0,Os.useMemo)(()=>{if(e?.chatgpt_expires_at){let s=new Date(e.chatgpt_expires_at),l=new Date,a=s.getTime()-l.getTime(),c=Math.ceil(a/(1e3*3600*24)),u=Math.floor(c/7),p=Math.ceil(c%7),f="";return p>0&&(f="& "+p+" day"+(p>1?"s":"")),u<1?c<=0?a<0?"0":"1 day":c<2?`${c} day`:`${c} days`:u<2?`${u} week ${f}`:`${u} weeks ${f}`}return 0},[e]);return{currentUserPlan:(0,Os.useMemo)(()=>{let s=e?.role?.name||"free";e?.roles?.length&&e.roles.find(c=>c.name==="pro")&&(s="pro");let l=!1;if(e?.chatgpt_expires_at&&s==="free"&&new Date(e.chatgpt_expires_at).getTime()>new Date().getTime()&&(s="pro_gift"),s==="free"&&e?.created_at){let a=(0,Ns.default)(e?.created_at);(0,Ns.default)().utc().diff(a,"day")<=-1e5&&(s="new_user",l=!0)}return{name:s,isNewUser:l}},[e]),quotaLeftText:o,userInfo:e,loading:t,syncUserInfo:r,syncUserSubscriptionInfo:n}};export{Xa as a,Ut as b,pr as c,Wt as d,Tt as e,Ri as f,el as g,jn as h,_i as i,al as j,Yn as k,sd as l,xl as m,Jt as n,Ct as o,fl as p,ld as q,At as r,cc as s,ze as t,wp as u,$r as v,Wr as w,to as x,Yy as y,Ky as z,Xy as A,Qy as B,zr as C,Jy as D,wl as E,_l as F,Md as G,Oi as H,vv as I,Tv as J,Fd as K,Iv as L,Pv as M,_v as N,Hl as O,Vl as P,Wv as Q,oo as R,zi as S,eb as T,tb as U,ub as V,oc as W,lo as X,pb as Y,mr as Z,Tf as _,ic as $,co as aa,po as ba,qr as ca,zx as da,Vt as ea,uc as fa,fc as ga,hc as ha,Ge as ia,Mf as ja,kf as ka,Lf as la,Of as ma,Nf as na,Df as oa,Bf as pa,Qi as qa,Ac as ra,Kr as sa,Zi as ta,Hc as ua,im as va,zc as wa,am as xa,fm as ya,bE as za,Kc as Aa,xE as Ba,TE as Ca,mm as Da,CE as Ea,SE as Fa,ts as Ga,rn as Ha,br as Ia,nn as Ja,vu as Ka,mn as La,Pr as Ma,rw as Na,nw as Oa,ow as Pa,iw as Qa,sw as Ra,aw as Sa,lw as Ta,cw as Ua,uw as Va,pw as Wa,dw as Xa,fw as Ya,mw as Za,gw as _a,hw as $a,yn as ab,ep as bb,Mw as cb,Ke as db,ws as eb,tp as fb,kw as gb,Is as hb,Lw as ib,Ow as jb,Nw as kb,rp as lb,Ig as mb,$w as nb,qw as ob,np as pb,cp as qb,up as rb,_s as sb,dp as tb,fp as ub,iI as vb,Ar as wb,sI as xb,aI as yb,lI as zb,cI as Ab,As as Bb,Lg as Cb,Og as Db,Hg as Eb};
/*! Bundled license information:

tabbable/dist/index.esm.js:
  (*!
  * tabbable 6.2.0
  * @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
  *)
*/
