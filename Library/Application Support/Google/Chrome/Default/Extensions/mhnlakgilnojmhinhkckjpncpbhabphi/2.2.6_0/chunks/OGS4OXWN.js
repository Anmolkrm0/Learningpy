import{a as fe}from"./R35Y4FGS.js";import{a as $}from"./QZ23CPMF.js";import{a as he,b as xe}from"./Y7ZOV6ME.js";import{f as L,h as J}from"./VAS4PCUJ.js";import"./OSV5JMC2.js";import"./ZUWCFVRF.js";import"./T2YD2R72.js";import"./F4S2AKS2.js";import"./TIRSHFYS.js";import"./2NTQRJQ3.js";import"./VJNOAMPH.js";import"./NUZWRSAO.js";import"./HR7WARS2.js";import"./ONATV5KI.js";import{a as de,b as ue}from"./EROUPKJY.js";import{a as O}from"./MVKHRVHS.js";import{a as T}from"./XYIK3P35.js";import{a as V}from"./E6U3QE4M.js";import"./74YJRG2J.js";import"./G3IATVC5.js";import"./CUWLSLUX.js";import{c as v}from"./RRTVKSFA.js";import{a as ge}from"./5VWP6KQN.js";import{a as oe}from"./FQZG6QUR.js";import{b as ce}from"./Y6THN5ER.js";import{I,_ as pe,u as ae,w as le}from"./23ILEKZA.js";import{d as ze,e as De,h as D}from"./METTGTCP.js";import"./QIHLYNAE.js";import{c as z}from"./73NF2E6V.js";import"./SEKP7NXC.js";import"./M4X5NUTB.js";import"./PYRZ6TFK.js";import"./DO4CXWXW.js";import"./PUYMQPES.js";import"./L33QHTPD.js";import"./EYWU5WEI.js";import{d as ie,h as ne}from"./P7VLDM2I.js";import"./2QCSFEQC.js";import{c as q}from"./6H35IRQ7.js";import"./PCLCAKLN.js";import"./RHP6532S.js";import{a as B,c as se}from"./JDS4AO4H.js";import"./2KVDDCLD.js";import{d as F}from"./QTLMWVML.js";import{a as r,b as re,u as x}from"./YVUFJA4Y.js";import"./H3PWEBSP.js";import"./QZNWBGPK.js";import{j as te}from"./QZVUH6Z4.js";import"./6NCLE6FY.js";import{i as me}from"./KU7PEBHX.js";import"./6LS5XNTR.js";import"./M5CWZYY7.js";import"./WFA6RKIT.js";import"./7MSGA26Z.js";import"./6SOYJAV3.js";import"./HNMZHSJ3.js";import{h as N}from"./L3MECM4T.js";import"./A4GQANVG.js";import{c as w}from"./QPPETRF6.js";import"./FMBKOUBC.js";import{L as ee,m as W}from"./622PSJQZ.js";import{a as k}from"./64D36THL.js";import"./3JX3VARJ.js";import{c as R,f as y}from"./PQ35KENF.js";var ye=R(H=>{"use strict";var Le=re();Object.defineProperty(H,"__esModule",{value:!0});H.default=void 0;var Pe=Le(se()),We=te(),Ne=(0,Pe.default)((0,We.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");H.default=Ne});var we=R(U=>{"use strict";var Ge=re();Object.defineProperty(U,"__esModule",{value:!0});U.default=void 0;var qe=Ge(se()),Ve=te(),Je=(0,qe.default)((0,Ve.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"}),"Code");U.default=Je});var l=y(k());var S=y(k());var Se=y(ye()),Ce=y(ze());var Oe=["www.linkedin.com"],$e=i=>{let{onEdit:e,onSave:s,editAble:c,message:a}=i,{t:o}=w(["common","client"]),[g,m]=(0,S.useState)("done"),h=(0,S.useMemo)(()=>a.extra.meta?.messageVisibleText||a.text,[a]);return S.default.createElement(r,{direction:"row",alignItems:"center",width:"100%",justifyContent:"flex-end"},S.default.createElement(T,{copyText:h,onCopy:()=>{i.onCopy?.(),Oe.includes(window.location.host)&&setTimeout(N,1)}}),g==="done"&&c&&S.default.createElement(V,{title:o("common:edit"),onClick:()=>{e(),m("edit")}},S.default.createElement(Se.default,{sx:{fontSize:16}})),g==="edit"&&c&&S.default.createElement(V,{title:o("common:save"),onClick:()=>{s(),m("done")}},S.default.createElement(Ce.default,{sx:{fontSize:16}})))},be=$e;var C=y(k());var Ie=y(De());var He=["www.linkedin.com"],Ue=i=>{let{t:e}=w(["common","client"]),{message:s,insertAble:c}=i,a=(0,C.useMemo)(()=>c,[c]),o=C.default.useRef(null),g=(0,C.useMemo)(()=>{let m=s.originalMessage;if(m){let h=m.metadata?.shareType||"normal",p=s.originalMessage?.content?.text||s.text;switch(h){case"normal":break;case"summary":m.metadata?.sourceWebpage?.title&&m.metadata.sourceWebpage.url&&(p=`${m.metadata.sourceWebpage.title}

`+p,p=`${p}

Source:
${m.metadata.sourceWebpage.url}`),p=p.replace(/####\s?([^\n]+)/g,"$1:");break;case"search":if(m?.metadata?.sources?.links){p=p.replace(/\[\[(\d+)\]\([^)]+\)\]/g,"[$1]");let u=m.metadata.sources.links,_=`

Citations:`;u.length>0&&u.forEach((j,P)=>{_+=`
[${P+1}] ${j.url}`}),p+=_}break;default:break}return p}else return s.text},[s]);return C.default.createElement(r,{direction:"row",alignItems:"center",spacing:1,ref:o},a&&C.default.createElement(F,{disableElevation:!0,size:"small",variant:"contained",title:"insert to draft",startIcon:C.default.createElement(Ie.default,null),onClick:()=>{}},e("client:sidebar__button__insert")),C.default.createElement(T,{className:"max-ai__actions__button--copy",copyText:g,onCopy:()=>{i.onCopy?.(),He.includes(window.location.host)&&setTimeout(N,1)}}),i.useChatGPTAble&&C.default.createElement(fe,{className:"max-ai__actions__button--use-max-ai",iconButton:!0,onBeforeShowContextMenu:()=>({template:g,target:o.current?.parentElement})}))},ke=Ue;var A=y(k());var je=i=>{let{onRetry:e,message:s}=i,{t:c}=w(["common","client"]),{currentUserPlan:a,userInfo:o}=le(),g=s.extra.systemMessageType||"normal";return(0,A.useEffect)(()=>{g==="needUpgrade"&&a.name==="pro"&&ce("[Pricing] Pro show pricing card",JSON.stringify({message:s.text,user:o,plan:a}),{uuid:"7a04bc02-6155-4253-bcdb-ade3db6de492"})},[a.name,g]),A.default.createElement(r,{direction:"row",alignItems:"center",flexWrap:"wrap",gap:1},g==="needUpgrade"&&A.default.createElement(F,{fullWidth:!0,sx:{height:48,fontSize:"16px",fontWeight:500},variant:"contained",color:"primary",target:"_blank",href:`${ee}/pricing`,onClick:m=>{s.extra.systemMessageType==="needUpgrade"&&s.extra.permissionSceneType&&pe("click",s.extra.permissionSceneType)}},c("client:sidebar__button__upgrade_to_pro")),g==="normal"&&s.parentMessageId&&A.default.createElement(F,{size:"small",variant:"outlined",color:"error",onClick:e,sx:{border:"1px solid rgba(244, 67, 54, 0.5)",color:"#f44336"}},c("client:sidebar__button__retry")))},Me=je;var b=y(k());var ve=y(we());var Ye=({message:i})=>{let e=(0,b.useMemo)(()=>JSON.stringify(i,null,2),[i]);return b.default.createElement($,null,b.default.createElement(B,{position:"absolute",top:16,left:16},b.default.createElement(ne,{title:b.default.createElement(r,null,b.default.createElement(T,{copyText:e}),b.default.createElement("pre",{style:{fontSize:"12px",maxHeight:"500px",overflowY:"auto"}},e))},b.default.createElement(ve.default,null))))},Te=Ye;var t=y(k());var f=y(k());var Ze=i=>{let{messageIsComplete:e}=i,{title:s,icon:c,value:a,valueType:o="text",status:g}=i.copilot,m=(0,f.useMemo)(()=>{if(!a)return null;switch(o){case"text":return f.default.createElement(v,{variant:"outlined",sx:{px:1}},f.default.createElement(x,{fontSize:14,color:"text.primary",noWrap:!0,maxWidth:256},String(a)));case"tags":{let h=[];return typeof a=="string"?h=a.split(","):Array.isArray(a)&&(h=a),f.default.createElement(r,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap"},h.map((p,u)=>f.default.createElement(v,{key:p,variant:"outlined",sx:{px:1}},f.default.createElement(x,{noWrap:!0,maxWidth:160,fontSize:14,color:"text.primary"},p))))}default:return null}},[a,o]);return f.default.createElement(r,{spacing:.5},f.default.createElement(r,{spacing:1,direction:"row",alignItems:"center"},f.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16},g==="loading"&&!e?f.default.createElement(z,{size:16}):f.default.createElement(D,{sx:{color:"primary.main",fontSize:16},icon:c})),f.default.createElement(x,{fontSize:16,color:"text.primary",noWrap:!0,sx:{p:0}},s)),a&&f.default.createElement(r,{spacing:1,direction:"row",alignItems:"center"},f.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16}),m))},Ae=Ze;var n=y(k());var Ke=i=>{let{sidebarBreakpoints:e}=ae(),{sourceLinks:s,loading:c}=i,[a,o]=(0,n.useState)(!1),g=(0,n.useMemo)(()=>a?s:s.length>6?s.slice(0,5):s,[a,s]),m=(0,n.useMemo)(()=>a?[]:s.length>6?s.slice(5).map(p=>p.favicon).filter(Boolean):[],[a,s]),h=(0,n.useMemo)(()=>e==="xs"||e==="sm"?6:e==="md"?4:e==="lg"||e==="xl"?3:6,[e]);return n.default.createElement(L,{container:!0,spacing:1,sx:{ml:"-8px!important"}},c?Array(me).fill("").map((p,u)=>n.default.createElement(L,{item:!0,xs:h,key:u},n.default.createElement(I,{variant:"rounded",width:"100%",height:60}))):n.default.createElement(n.default.Fragment,null,g.map((p,u)=>n.default.createElement(L,{item:!0,xs:h,key:p.title},n.default.createElement(v,{variant:"outlined"},n.default.createElement(q,{href:p.url,target:"_blank",underline:"none"},n.default.createElement(r,{p:1,spacing:.5},n.default.createElement(x,{fontSize:14,color:"text.primary",noWrap:!0,sx:{p:0}},p.title),n.default.createElement(r,{direction:"row",alignItems:"center",spacing:.5},n.default.createElement(B,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},n.default.createElement("img",{src:p.favicon,alt:p?.from,width:"100%",height:"100%"})),n.default.createElement(x,{fontSize:12,color:"text.secondary",noWrap:!0},p?.from),n.default.createElement(x,{fontSize:12,color:"text.secondary",flexShrink:0},"\xB7 ",u+1))))))),!a&&s.length>6&&n.default.createElement(L,{item:!0,xs:h,onClick:()=>{o(!0)}},n.default.createElement(v,{variant:"outlined"},n.default.createElement(q,{href:"#",underline:"none"},n.default.createElement(r,{p:1,spacing:1},n.default.createElement(r,{direction:"row",spacing:1},m.map((p,u)=>n.default.createElement(B,{key:u+p,width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},n.default.createElement("img",{src:p,width:"100%",height:"100%"})))),n.default.createElement(r,{direction:"row",alignItems:"center",spacing:.5},n.default.createElement(x,{fontSize:12,color:"text.secondary",flexShrink:0},"View ",m.length," more"))))))))},_e=Ke;var Qe=i=>class extends t.Component{constructor(s){super(s),this.state={hasError:!1}}componentDidCatch(s,c){this.setState({hasError:!0})}render(){return this.state.hasError?t.default.createElement(i,{...this.props,liteMode:!0}):t.default.createElement(i,{...this.props})}},Y=i=>{let{fontSx:e}=i,{title:s,titleIcon:c,titleIconSize:a}=i.title;return t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},c&&t.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16},t.default.createElement(D,{sx:{color:"primary.main",fontSize:a||18},icon:c})),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18,...e}},s))},Xe=i=>{let{message:e,isDarkMode:s,liteMode:c=!1}=i,a=e.originalMessage!==void 0&&!c,o=(0,t.useMemo)(()=>{let m={title:e.originalMessage?.metadata?.title,copilot:e.originalMessage?.metadata?.copilot,sources:e.originalMessage?.metadata?.sources,sourcesLoading:e.originalMessage?.metadata?.sources?.status==="loading",answer:e.text,content:e.originalMessage?.content,messageIsComplete:e.originalMessage?.metadata?.isComplete,deepDive:e.originalMessage?.metadata?.deepDive};return e.originalMessage?.content?.text&&(m.answer=de(e.originalMessage.content.text,{noResponseTag:!0,noSummaryTag:!0})||e.text),m.answer=m.answer.replace(/^\s+/,""),m},[e]),g=(0,t.useMemo)(()=>!o.answer,[o.answer]);return t.default.createElement(t.default.Fragment,null,a?t.default.createElement(r,{spacing:2},o.title&&t.default.createElement(Y,{title:o.title,fontSx:{fontWeight:"bold",fontSize:"28px",color:"text.primary"}}),o.copilot&&t.default.createElement(r,{spacing:1},o.copilot?.title&&t.default.createElement(Y,{title:o.copilot.title}),t.default.createElement(r,{spacing:1},o.copilot.steps.map(m=>t.default.createElement(Ae,{messageIsComplete:o.messageIsComplete,copilot:m,key:m.title})))),o.sources&&t.default.createElement(r,{spacing:1},t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},o.sourcesLoading&&!o.messageIsComplete?t.default.createElement(z,{size:18}):t.default.createElement(xe,{sx:{color:"primary.main",fontSize:20}}),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18}},"Sources")),t.default.createElement(_e,{sourceLinks:o.sources.links||[],loading:o.sourcesLoading})),o.content&&t.default.createElement(r,null,o.messageIsComplete?t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},o.content.title?.titleIcon?t.default.createElement(r,{alignItems:"center",justifyContent:"center",width:16,height:16},t.default.createElement(D,{sx:{color:"primary.main",fontSize:o.content.title?.titleIconSize||18},icon:o.content.title?.titleIcon})):t.default.createElement(he,{sx:{color:"primary.main",fontSize:20}}),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18,lineHeight:"20px"}},o.content.title?.title||"Answer")):t.default.createElement(r,{direction:"row",alignItems:"center",spacing:1},t.default.createElement(z,{size:18}),t.default.createElement(x,{sx:{color:"primary.main",fontSize:18,lineHeight:"20px"}},"Writing")),g&&!o.messageIsComplete?t.default.createElement(r,null,t.default.createElement(I,{animation:"wave",height:10}),t.default.createElement(I,{animation:"wave",height:10}),t.default.createElement(I,{animation:"wave",height:10}),t.default.createElement(I,{animation:"wave",height:10}),t.default.createElement(I,{animation:"wave",height:10}),t.default.createElement(I,{animation:"wave",height:10})):t.default.createElement("div",{className:`markdown-body ${s?"markdown-body-dark":""}`},t.default.createElement(O,null,o.answer))),o.deepDive&&t.default.createElement(r,{spacing:1},o.deepDive.title&&t.default.createElement(Y,{title:o.deepDive.title}),t.default.createElement("div",{className:`markdown-body ${s?"markdown-body-dark":""}`},t.default.createElement(O,null,o.deepDive.value)))):t.default.createElement("div",{className:`markdown-body ${s?"markdown-body-dark":""}`},t.default.createElement(O,null,o.answer)))},Ee=Qe(Xe);var Re=l.default.lazy(()=>import("./75G4F6VL.js")),Be=i=>i.type==="system"?i.text:i?.extra?.meta?.messageVisibleText||i.text||"",et=i=>{let{message:e,editAble:s,insertAble:c,replaceAble:a,useChatGPTAble:o,onSave:g,onCopy:m,onRetry:h,className:p}=i,{isDarkMode:u}=oe(),[_,j]=(0,l.useState)(()=>Be(e)),[P,Z]=(0,l.useState)(!1),[K,Q]=(0,l.useState)(!1),E=(0,l.useRef)(null),Fe=(0,l.useMemo)(()=>{let d=K?{"& *":{userSelect:"text!important"}}:{"& *":{userSelect:"none!important"}};return e.type==="ai"?{borderRadius:"8px",borderBottomLeftRadius:0,color:u?"#FFFFFFDE":"rgba(0,0,0,0.87)",border:"1px solid",borderColor:u?"customColor.borderColor":"transparent",bgcolor:u?"rgba(255, 255, 255, 0.04)":"rgb(233,233,235)!important",...d}:e.type==="user"||e.type==="third"?{flexDirection:"row",justifyContent:"flex-start",bgcolor:()=>u?"#6B23C259 !important":"#F1E2FD !important",border:"1px solid",borderColor:u?"customColor.borderColor":"transparent",color:u?"#FFFFFFDE":"rgba(0,0,0,0.87)!important",maxWidth:"100%",width:"auto",borderRadius:"8px",borderBottomRightRadius:0,flexWrap:"wrap",ml:"auto",mr:"0",overflow:"hidden",p:1,...d}:e?.extra?.systemMessageType==="needUpgrade"?{borderRadius:"8px",bgcolor:"#333","& > div":{maxWidth:450,bgcolor:"#333",padding:0,"& *":{color:"#FFFFFF!important"}},...d}:{borderRadius:"8px",border:{info:"1px solid #03a9f4!important",error:"1px solid rgb(239, 83, 80)!important",success:"1px solid #34A853!important"}[e?.extra?.status]||"1px solid #03a9f4!important",bgcolor:"background.paper",...d}},[e.type,K,u]);(0,l.useEffect)(()=>{j(Be(e))},[e.text]);let X=(0,l.useMemo)(()=>{if(e.type==="user"){let d=e?.extra?.meta?.attachments;if(d&&d.length)return d.filter(M=>M.uploadStatus==="success")}return[]},[e]);return l.default.createElement(r,{className:p,sx:{width:"100%",p:1,color:"text.primary",position:"relative","& .chat-message--text":{textAlign:"left",fontSize:"16px",lineHeight:1.4,fontWeight:400}},onCopy:d=>{d.preventDefault(),d.stopPropagation();let M=window.getSelection();if(M&&M.toString().trim()){let G=M.toString().trim();G&&navigator.clipboard.writeText(G)}},onMouseEnter:()=>{E.current&&clearTimeout(E.current),Q(!0)},onMouseLeave:()=>{E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{Q(!1);let d=window.getSelection();d&&d.toString().trim()&&d.focusNode&&d.focusNode.isSameNode(document.body)&&d.removeAllRanges()},500)},spacing:1,key:e.messageId},l.default.createElement($,null,l.default.createElement(Te,{message:e})),l.default.createElement(r,{className:"chat-message--text",whiteSpace:"pre-wrap",width:"100%",spacing:1,p:1,sx:{wordBreak:"break-word",...Fe}},l.default.createElement(ge,null,e.type==="system"?l.default.createElement(ie,{severity:e?.extra?.status||"info",sx:{p:1,"& .MuiAlert-message":{p:0},"& > div:first-child":{display:"none"},"& .markdown-body":{"& > p:first-child":{mt:0}}},icon:l.default.createElement(l.default.Fragment,null)},l.default.createElement("div",{className:`markdown-body ${u?"markdown-body-dark":""}`},l.default.createElement(Re,null,_.replace(/^\s+/,"")))):l.default.createElement(r,{className:"chat-message--text",id:`${W}_chat_message_${e.messageId}`,contentEditable:P,whiteSpace:"pre-wrap",sx:{wordBreak:"break-word",borderColor:"primary.main",borderStyle:"solid",borderWidth:P?1:0}},e.type==="user"&&X.length>0&&l.default.createElement(ue,{size:"small",direction:"row",disabledRemove:!0,sx:{mb:1},files:X}),e.type==="user"&&_.replace(/^\s+/,""),(e.type==="third"||e.type==="ai")&&l.default.createElement(Ee,{isDarkMode:u,message:e}))),e.type==="user"&&l.default.createElement(be,{editAble:s,onCopy:m,message:e,onSave:()=>{Z(!1);let d=document.getElementById(`${W}_chat_message_${e.messageId}`);g&&g(d?.innerText||e.text||"")},onEdit:()=>{Z(!0),setTimeout(()=>{let d=document.getElementById(`${W}_chat_message_${e.messageId}`);d&&d.focus()},0)}}),e.type==="ai"&&l.default.createElement(ke,{insertAble:c,replaceAble:a,useChatGPTAble:o,onCopy:m,message:e}),e.type==="system"&&l.default.createElement(Me,{onRetry:()=>{e.parentMessageId&&h&&h(e.parentMessageId)},message:e})))},Co=et;export{Co as default};
